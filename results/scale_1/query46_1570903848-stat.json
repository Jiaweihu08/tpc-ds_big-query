{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"33366","creationTime":"1570903850639","totalBytesProcessed":"183137218","startTime":"1570903850837","query":{"totalSlotMs":"33366","queryPlan":[{"readMsMax":"8","computeMsMax":"37","waitMsAvg":"1","id":"0","endMs":"1570903851199","waitMsMax":"1","startMs":"1570903851073","waitRatioMax":0.0002889338341519792,"readRatioAvg":0.0023114706732158337,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.01069055186362323,"writeMsAvg":"77","status":"COMPLETE","writeMsMax":"77","computeMsAvg":"37","shuffleOutputBytesSpilled":"0","writeRatioMax":0.022247905229702398,"readMsAvg":"8","waitRatioAvg":0.0002889338341519792,"completedParallelInputs":"1","computeRatioMax":0.01069055186362323,"name":"S00: Input","shuffleOutputBytes":"1128381","recordsWritten":"50000","readRatioMax":0.0023114706732158337,"steps":[{"kind":"READ","substeps":["$20:ca_address_sk, $21:ca_city","FROM customer_address"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage00_output","BY HASH($20)"]}],"writeRatioAvg":0.022247905229702398},{"readMsMax":"18","computeMsMax":"9","waitMsAvg":"17","id":"1","endMs":"1570903852419","waitMsMax":"17","startMs":"1570903851116","waitRatioMax":0.004911875180583647,"readRatioAvg":0.005200809014735626,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.002600404507367813,"writeMsAvg":"1228","status":"COMPLETE","writeMsMax":"1228","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.35481074833863047,"readMsAvg":"18","waitRatioAvg":0.004911875180583647,"completedParallelInputs":"1","computeRatioMax":0.002600404507367813,"name":"S01: Input","shuffleOutputBytes":"16200","recordsWritten":"1800","readRatioMax":0.005200809014735626,"steps":[{"kind":"READ","substeps":["$30:hd_demo_sk, $31:hd_dep_count, $32:hd_vehicle_count","FROM household_demographics","WHERE or(equal($31, 6), equal($32, 0))"]},{"kind":"WRITE","substeps":["$30","TO __stage01_output","BY HASH($30)"]}],"writeRatioAvg":0.35481074833863047},{"readMsMax":"15","computeMsMax":"9","waitMsAvg":"2","id":"2","endMs":"1570903851265","waitMsMax":"2","startMs":"1570903851177","waitRatioMax":0.0005778676683039584,"readRatioAvg":0.004334007512279688,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.002600404507367813,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0017336030049118752,"readMsAvg":"15","waitRatioAvg":0.0005778676683039584,"completedParallelInputs":"1","computeRatioMax":0.002600404507367813,"name":"S02: Input","shuffleOutputBytes":"108","recordsWritten":"12","readRatioMax":0.004334007512279688,"steps":[{"kind":"READ","substeps":["$50:s_store_sk, $51:s_city","FROM store","WHERE in($51, 'Midway', 'Fairview', 'Fairview', 'Fairview', 'Fairview')"]},{"kind":"WRITE","substeps":["$50","TO __stage02_output","BY HASH($50)"]}],"writeRatioAvg":0.0017336030049118752},{"readMsMax":"11","computeMsMax":"7","waitMsAvg":"2","id":"3","endMs":"1570903851400","waitMsMax":"2","startMs":"1570903851200","waitRatioMax":0.0005778676683039584,"readRatioAvg":0.003178272175671771,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0020225368390638545,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005489742848887605,"readMsAvg":"11","waitRatioAvg":0.0005778676683039584,"completedParallelInputs":"1","computeRatioMax":0.0020225368390638545,"name":"S03: Input","shuffleOutputBytes":"2826","recordsWritten":"314","readRatioMax":0.003178272175671771,"steps":[{"kind":"READ","substeps":["$60:d_date_sk, $61:d_year, $62:d_dow","FROM date_dim","WHERE and(in($62, 6, 0), in($61, 2000, 2001, 2002))"]},{"kind":"WRITE","substeps":["$60","TO __stage03_output","BY HASH($60)"]}],"writeRatioAvg":0.005489742848887605},{"readMsMax":"40","computeMsMax":"3461","inputStages":["0","1","2","3"],"waitMsAvg":"1","id":"6","endMs":"1570903854337","waitMsMax":"1","startMs":"1570903852527","waitRatioMax":0.0002889338341519792,"readRatioAvg":0.011557353366079168,"parallelInputs":"1","recordsRead":"2933304","computeRatioAvg":1,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"3461","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001444669170759896,"readMsAvg":"40","waitRatioAvg":0.0002889338341519792,"completedParallelInputs":"1","computeRatioMax":1,"name":"S06: Join+","shuffleOutputBytes":"616901","recordsWritten":"10641","readRatioMax":0.011557353366079168,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_hdemo_sk, $43:ss_addr_sk, $44:ss_store_sk, $45:ss_ticket_number, $46:ss_coupon_amt, $47:ss_net_profit","FROM store_sales"]},{"kind":"READ","substeps":["$60","FROM __stage03_output"]},{"kind":"READ","substeps":["$50","FROM __stage02_output"]},{"kind":"READ","substeps":["$30","FROM __stage01_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $150 := $142, $151 := $140, $152 := $141, $153 := $145","$80 := SUM($143)","$81 := SUM($144)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $131 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $111 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $93 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $60"]},{"kind":"WRITE","substeps":["$153, $151, $152, $150, $80, $81","TO __stage06_output","BY HASH($150, $151, $152, $153)"]}],"writeRatioAvg":0.001444669170759896},{"readMsMax":"10","computeMsMax":"49","waitMsAvg":"2","id":"7","endMs":"1570903855267","waitMsMax":"2","startMs":"1570903854911","waitRatioMax":0.0005778676683039584,"readRatioAvg":0.002889338341519792,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.014157757873446981,"writeMsAvg":"120","status":"COMPLETE","writeMsMax":"120","computeMsAvg":"49","shuffleOutputBytesSpilled":"0","writeRatioMax":0.034672060098237506,"readMsAvg":"10","waitRatioAvg":0.0005778676683039584,"completedParallelInputs":"1","computeRatioMax":0.014157757873446981,"name":"S07: Input","shuffleOutputBytes":"1128381","recordsWritten":"50000","readRatioMax":0.002889338341519792,"steps":[{"kind":"READ","substeps":["$1:ca_address_sk, $2:ca_city","FROM customer_address"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage07_output","BY HASH($1)"]}],"writeRatioAvg":0.034672060098237506},{"readMsMax":"0","computeMsMax":"36","inputStages":["6"],"waitMsAvg":"1","id":"9","endMs":"1570903855347","waitMsMax":"1","startMs":"1570903855035","waitRatioMax":0.0002889338341519792,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"10641","computeRatioAvg":0.010401618029471251,"writeMsAvg":"102","status":"COMPLETE","writeMsMax":"102","computeMsAvg":"36","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02947125108350188,"readMsAvg":"0","waitRatioAvg":0.0002889338341519792,"completedParallelInputs":"1","computeRatioMax":0.010401618029471251,"name":"S09: Aggregate","shuffleOutputBytes":"508817","recordsWritten":"10270","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$153, $151, $152, $150, $80, $81","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $160 := $150, $161 := $151, $162 := $152, $163 := $153","$70 := SUM($80)","$71 := SUM($81)"]},{"kind":"WRITE","substeps":["$70, $71, $160, $161, $163","TO __stage09_output","BY HASH($161)"]}],"writeRatioAvg":0.02947125108350188},{"readMsMax":"0","computeMsMax":"9","inputStages":["9"],"waitMsAvg":"3","id":"10","endMs":"1570903855721","waitMsMax":"5","startMs":"1570903855412","waitRatioMax":0.001444669170759896,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"10270","computeRatioAvg":0.0011557353366079169,"writeMsAvg":"168","status":"COMPLETE","writeMsMax":"220","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.06356544351343542,"readMsAvg":"0","waitRatioAvg":0.0008668015024559376,"completedParallelInputs":"100","computeRatioMax":0.002600404507367813,"name":"S0A: Coalesce","shuffleOutputBytes":"508817","recordsWritten":"10270","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage09_output"]}],"writeRatioAvg":0.048540884137532506},{"readMsMax":"10","computeMsMax":"94","inputStages":["7","10"],"waitMsAvg":"5","id":"11","endMs":"1570903855797","waitMsMax":"5","startMs":"1570903855416","waitRatioMax":0.001444669170759896,"readRatioAvg":0.002889338341519792,"parallelInputs":"1","recordsRead":"160270","computeRatioAvg":0.027159780410286046,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"94","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0017336030049118752,"readMsAvg":"10","waitRatioAvg":0.001444669170759896,"completedParallelInputs":"1","computeRatioMax":0.027159780410286046,"name":"S0B: Join+","shuffleOutputBytes":"5641","recordsWritten":"100","readRatioMax":0.002889338341519792,"steps":[{"kind":"READ","substeps":["$10:c_customer_sk, $11:c_current_addr_sk, $12:c_first_name, $13:c_last_name","FROM customer"]},{"kind":"READ","substeps":["$70, $71, $160, $161, $163","FROM __stage0A_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage07_output"]},{"kind":"SORT","substeps":["$181 ASC, $180 ASC, $186 ASC, $182 ASC, $183 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["not_equal($186, $182)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $174 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $10 = $161"]},{"kind":"WRITE","substeps":["$190, $191, $192, $193, $194, $195, $196","TO __stage0B_output"]}],"writeRatioAvg":0.0017336030049118752},{"readMsMax":"0","computeMsMax":"5","inputStages":["11"],"waitMsAvg":"5","id":"12","endMs":"1570903855831","waitMsMax":"5","startMs":"1570903855556","waitRatioMax":0.001444669170759896,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.001444669170759896,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0017336030049118752,"readMsAvg":"0","waitRatioAvg":0.001444669170759896,"completedParallelInputs":"1","computeRatioMax":0.001444669170759896,"name":"S0C: Output","shuffleOutputBytes":"5641","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$190, $191, $192, $193, $194, $195, $196","FROM __stage0B_output"]},{"kind":"SORT","substeps":["$192 ASC, $191 ASC, $190 ASC, $193 ASC, $194 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$200, $201, $202, $203, $204, $205, $206","TO __stage0C_output"]}],"writeRatioAvg":0.0017336030049118752}],"estimatedBytesProcessed":"183137218","timeline":[{"totalSlotMs":"1306","activeUnits":"2","completedUnits":"3","elapsedMs":"738","pendingUnits":"2"},{"totalSlotMs":"4676","activeUnits":"1","completedUnits":"4","elapsedMs":"2084","pendingUnits":"1"},{"totalSlotMs":"9479","activeUnits":"101","completedUnits":"7","elapsedMs":"4582","pendingUnits":"102"},{"totalSlotMs":"33366","activeUnits":"101","completedUnits":"109","elapsedMs":"5247","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"183500800","totalPartitionsProcessed":"0","totalBytesProcessed":"183137218","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"}]},"endTime":"1570903856124"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query46_1570903848"},"etag":"tlQM8ZeI/O1wC3SsZCJdHg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query46_1570903848?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon292bdcafbe46f8a70b98ff263378c205e39947f3","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query46\nSELECT c_last_name, \n c_first_name, \n ca_city, \n bought_city, \n ss_ticket_number, \n amt, \n profit \nFROM (SELECT ss_ticket_number, \n ss_customer_sk, \n ca_city bought_city, \n Sum(ss_coupon_amt) amt, \n Sum(ss_net_profit) profit \n FROM store_sales, \n date_dim, \n store, \n household_demographics, \n customer_address \n WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk \n AND store_sales.ss_store_sk = store.s_store_sk \n AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk \n AND store_sales.ss_addr_sk = customer_address.ca_address_sk \n AND ( household_demographics.hd_dep_count = 6 \n OR household_demographics.hd_vehicle_count = 0 ) \n AND date_dim.d_dow IN ( 6, 0 ) \n AND date_dim.d_year IN ( 2000, 2000 + 1, 2000 + 2 ) \n AND store.s_city IN ( 'Midway', 'Fairview', 'Fairview', \n 'Fairview', \n 'Fairview' ) \n GROUP BY ss_ticket_number, \n ss_customer_sk, \n ss_addr_sk, \n ca_city) dn, \n customer, \n customer_address current_addr \nWHERE ss_customer_sk = c_customer_sk \n AND customer.c_current_addr_sk = current_addr.ca_address_sk \n AND current_addr.ca_city <> bought_city \nORDER BY c_last_name, \n c_first_name, \n ca_city, \n bought_city, \n ss_ticket_number\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query46_1570903848","user_email":"nithish.sankaranarayanan@ulb.be"}
