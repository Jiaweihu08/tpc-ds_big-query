{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"161514","creationTime":"1570903455731","totalBytesProcessed":"120586011","startTime":"1570903455938","query":{"totalSlotMs":"161514","queryPlan":[{"readMsMax":"12","computeMsMax":"15","waitMsAvg":"15","id":"0","endMs":"1570903456335","waitMsMax":"15","startMs":"1570903456162","waitRatioMax":0.0025969529085872575,"readRatioAvg":0.002077562326869806,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0025969529085872575,"writeMsAvg":"64","status":"COMPLETE","writeMsMax":"64","computeMsAvg":"15","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0110803324099723,"readMsAvg":"12","waitRatioAvg":0.0025969529085872575,"completedParallelInputs":"1","computeRatioMax":0.0025969529085872575,"name":"S00: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.002077562326869806,"steps":[{"kind":"READ","substeps":["$110:d_date_sk, $111:d_year","FROM date_dim","WHERE equal($111, 2001)"]},{"kind":"WRITE","substeps":["$110, $111","TO __stage00_output","BY HASH($110)"]}],"writeRatioAvg":0.0110803324099723},{"readMsMax":"174","computeMsMax":"303","waitMsAvg":"25","id":"2","endMs":"1570903457270","waitMsMax":"25","startMs":"1570903456257","waitRatioMax":0.00432825484764543,"readRatioAvg":0.03012465373961219,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.0524584487534626,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"303","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0031163434903047093,"readMsAvg":"174","waitRatioAvg":0.00432825484764543,"completedParallelInputs":"1","computeRatioMax":0.0524584487534626,"name":"S02: Input","shuffleOutputBytes":"10274387","recordsWritten":"100000","readRatioMax":0.03012465373961219,"steps":[{"kind":"READ","substeps":["$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address","FROM customer"]},{"kind":"WRITE","substeps":["$90, $91, $92, $93, $94, $95, $96, $97","TO __stage02_output","BY HASH($90)"]}],"writeRatioAvg":0.0031163434903047093},{"readMsMax":"14","computeMsMax":"9","waitMsAvg":"31","id":"3","endMs":"1570903456496","waitMsMax":"31","startMs":"1570903456287","waitRatioMax":0.005367036011080332,"readRatioAvg":0.0024238227146814403,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0015581717451523547,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001038781163434903,"readMsAvg":"14","waitRatioAvg":0.005367036011080332,"completedParallelInputs":"1","computeRatioMax":0.0015581717451523547,"name":"S03: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0024238227146814403,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_year","FROM date_dim","WHERE equal($81, 2001)"]},{"kind":"WRITE","substeps":["$80, $81","TO __stage03_output","BY HASH($80)"]}],"writeRatioAvg":0.001038781163434903},{"readMsMax":"35","computeMsMax":"1038","waitMsAvg":"43","id":"4","endMs":"1570903456945","waitMsMax":"43","startMs":"1570903456321","waitRatioMax":0.0074445983379501385,"readRatioAvg":0.006059556786703601,"parallelInputs":"1","recordsRead":"720759","computeRatioAvg":0.17970914127423823,"writeMsAvg":"46","status":"COMPLETE","writeMsMax":"46","computeMsAvg":"1038","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00796398891966759,"readMsAvg":"35","waitRatioAvg":0.0074445983379501385,"completedParallelInputs":"1","computeRatioMax":0.17970914127423823,"name":"S04: Input","shuffleOutputBytes":"25938840","recordsWritten":"720582","readRatioMax":0.006059556786703601,"steps":[{"kind":"READ","substeps":["$70:ws_sold_date_sk, $71:ws_bill_customer_sk, $72:ws_ext_discount_amt, $73:ws_ext_list_price","FROM web_sales"]},{"kind":"WRITE","substeps":["$70, $71, $72, $73","TO __stage04_output","BY HASH($71)"]}],"writeRatioAvg":0.00796398891966759},{"readMsMax":"11","computeMsMax":"10","waitMsAvg":"49","id":"6","endMs":"1570903456474","waitMsMax":"49","startMs":"1570903456377","waitRatioMax":0.008483379501385042,"readRatioAvg":0.001904432132963989,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0017313019390581717,"writeMsAvg":"59","status":"COMPLETE","writeMsMax":"59","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010214681440443213,"readMsAvg":"11","waitRatioAvg":0.008483379501385042,"completedParallelInputs":"1","computeRatioMax":0.0017313019390581717,"name":"S06: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.001904432132963989,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year","FROM date_dim","WHERE equal($51, 2002)"]},{"kind":"WRITE","substeps":["$50, $51","TO __stage06_output","BY HASH($50)"]}],"writeRatioAvg":0.010214681440443213},{"readMsMax":"29","computeMsMax":"305","waitMsAvg":"15","id":"8","endMs":"1570903456834","waitMsMax":"15","startMs":"1570903456448","waitRatioMax":0.0025969529085872575,"readRatioAvg":0.005020775623268698,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.05280470914127424,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"305","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0031163434903047093,"readMsAvg":"29","waitRatioAvg":0.0025969529085872575,"completedParallelInputs":"1","computeRatioMax":0.05280470914127424,"name":"S08: Input","shuffleOutputBytes":"10274387","recordsWritten":"100000","readRatioMax":0.005020775623268698,"steps":[{"kind":"READ","substeps":["$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address","FROM customer"]},{"kind":"WRITE","substeps":["$30, $31, $32, $33, $34, $35, $36, $37","TO __stage08_output","BY HASH($30)"]}],"writeRatioAvg":0.0031163434903047093},{"readMsMax":"13","computeMsMax":"8","waitMsAvg":"16","id":"9","endMs":"1570903456548","waitMsMax":"16","startMs":"1570903456473","waitRatioMax":0.002770083102493075,"readRatioAvg":0.0022506925207756235,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0013850415512465374,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0012119113573407201,"readMsAvg":"13","waitRatioAvg":0.002770083102493075,"completedParallelInputs":"1","computeRatioMax":0.0013850415512465374,"name":"S09: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0022506925207756235,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_year","FROM date_dim","WHERE equal($21, 2002)"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage09_output","BY HASH($20)"]}],"writeRatioAvg":0.0012119113573407201},{"readMsMax":"30","computeMsMax":"920","waitMsAvg":"2","id":"10","endMs":"1570903457013","waitMsMax":"2","startMs":"1570903456475","waitRatioMax":0.00034626038781163435,"readRatioAvg":0.005193905817174515,"parallelInputs":"1","recordsRead":"720759","computeRatioAvg":0.1592797783933518,"writeMsAvg":"51","status":"COMPLETE","writeMsMax":"51","computeMsAvg":"920","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008829639889196677,"readMsAvg":"30","waitRatioAvg":0.00034626038781163435,"completedParallelInputs":"1","computeRatioMax":0.1592797783933518,"name":"S0A: Input","shuffleOutputBytes":"25938840","recordsWritten":"720582","readRatioMax":0.005193905817174515,"steps":[{"kind":"READ","substeps":["$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_list_price","FROM web_sales"]},{"kind":"WRITE","substeps":["$10, $11, $12, $13","TO __stage0A_output","BY HASH($11)"]}],"writeRatioAvg":0.008829639889196677},{"readMsMax":"35","computeMsMax":"5776","inputStages":["6","8"],"waitMsAvg":"1","id":"12","endMs":"1570903459922","waitMsMax":"1","startMs":"1570903456955","waitRatioMax":0.00017313019390581717,"readRatioAvg":0.006059556786703601,"parallelInputs":"1","recordsRead":"2981543","computeRatioAvg":1,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"5776","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004155124653739612,"readMsAvg":"35","waitRatioAvg":0.00017313019390581717,"completedParallelInputs":"1","computeRatioMax":1,"name":"S0C: Join+","shuffleOutputBytes":"4275248","recordsWritten":"38235","readRatioMax":0.006059556786703601,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_ext_discount_amt, $43:ss_ext_list_price","FROM store_sales"]},{"kind":"READ","substeps":["$30, $31, $32, $33, $34, $35, $36, $37","FROM __stage08_output"]},{"kind":"READ","substeps":["$50, $51","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $320 := $310, $321 := $311, $322 := $312, $323 := $313, $324 := $314, $325 := $315, $326 := $316, $327 := $319","$180 := SUM($210)"]},{"kind":"COMPUTE","substeps":["$210 := subtract($318, $317)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $297 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $41 = $30"]},{"kind":"WRITE","substeps":["$320, $321, $322, $323, $324, $325, $326, $327, $180","TO __stage0C_output","BY HASH($320, $321, $322, $323, $324, $325, $326, $327)"]}],"writeRatioAvg":0.004155124653739612},{"readMsMax":"0","computeMsMax":"22","inputStages":["4"],"waitMsAvg":"1","id":"13","endMs":"1570903457340","waitMsMax":"6","startMs":"1570903457096","waitRatioMax":0.001038781163434903,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"720582","computeRatioAvg":0.002077562326869806,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"84","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.014542936288088643,"readMsAvg":"0","waitRatioAvg":0.00017313019390581717,"completedParallelInputs":"100","computeRatioMax":0.003808864265927978,"name":"S0D: Coalesce","shuffleOutputBytes":"25938840","recordsWritten":"720582","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage04_output"]}],"writeRatioAvg":0.003289473684210526},{"readMsMax":"27","computeMsMax":"849","inputStages":["3","13"],"waitMsAvg":"4","id":"14","endMs":"1570903457794","waitMsMax":"4","startMs":"1570903457118","waitRatioMax":0.0006925207756232687,"readRatioAvg":0.004674515235457063,"parallelInputs":"1","recordsRead":"820947","computeRatioAvg":0.14698753462603878,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"849","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003808864265927978,"readMsAvg":"27","waitRatioAvg":0.0006925207756232687,"completedParallelInputs":"1","computeRatioMax":0.14698753462603878,"name":"S0E: Join+","shuffleOutputBytes":"1252858","recordsWritten":"11213","readRatioMax":0.004674515235457063,"steps":[{"kind":"READ","substeps":["$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address","FROM customer"]},{"kind":"READ","substeps":["$70, $71, $72, $73","FROM __stage0D_output"]},{"kind":"READ","substeps":["$80, $81","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $380 := $370, $381 := $371, $382 := $372, $383 := $373, $384 := $374, $385 := $375, $386 := $376, $387 := $379","$190 := SUM($220)"]},{"kind":"COMPUTE","substeps":["$220 := subtract($378, $377)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $357 = $80"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $60 = $71"]},{"kind":"WRITE","substeps":["$380, $381, $382, $383, $384, $385, $386, $387, $190","TO __stage0E_output","BY HASH($380, $381, $382, $383, $384, $385, $386, $387)"]}],"writeRatioAvg":0.003808864265927978},{"readMsMax":"0","computeMsMax":"17","inputStages":["10"],"waitMsAvg":"2","id":"15","endMs":"1570903457482","waitMsMax":"5","startMs":"1570903457179","waitRatioMax":0.0008656509695290858,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"720582","computeRatioAvg":0.002077562326869806,"writeMsAvg":"67","status":"COMPLETE","writeMsMax":"219","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03791551246537396,"readMsAvg":"0","waitRatioAvg":0.00034626038781163435,"completedParallelInputs":"100","computeRatioMax":0.002943213296398892,"name":"S0F: Coalesce","shuffleOutputBytes":"25938840","recordsWritten":"720582","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0A_output"]}],"writeRatioAvg":0.011599722991689751},{"readMsMax":"22","computeMsMax":"798","inputStages":["9","15"],"waitMsAvg":"1","id":"16","endMs":"1570903458522","waitMsMax":"1","startMs":"1570903457233","waitRatioMax":0.00017313019390581717,"readRatioAvg":0.003808864265927978,"parallelInputs":"1","recordsRead":"820947","computeRatioAvg":0.13815789473684212,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"798","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003289473684210526,"readMsAvg":"22","waitRatioAvg":0.00017313019390581717,"completedParallelInputs":"1","computeRatioMax":0.13815789473684212,"name":"S10: Join+","shuffleOutputBytes":"1259715","recordsWritten":"11269","readRatioMax":0.003808864265927978,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address","FROM customer"]},{"kind":"READ","substeps":["$10, $11, $12, $13","FROM __stage0F_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $440 := $430, $441 := $431, $442 := $432, $443 := $433, $444 := $434, $445 := $435, $446 := $436, $447 := $439","$150 := SUM($170)"]},{"kind":"COMPUTE","substeps":["$170 := subtract($438, $437)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $417 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $11"]},{"kind":"WRITE","substeps":["$440, $441, $442, $443, $444, $445, $446, $447, $150","TO __stage10_output","BY HASH($440, $441, $442, $443, $444, $445, $446, $447)"]}],"writeRatioAvg":0.003289473684210526},{"readMsMax":"83","computeMsMax":"5683","inputStages":["0","2"],"waitMsAvg":"1","id":"17","endMs":"1570903460794","waitMsMax":"1","startMs":"1570903457408","waitRatioMax":0.00017313019390581717,"readRatioAvg":0.014369806094182825,"parallelInputs":"1","recordsRead":"2981543","computeRatioAvg":0.983898891966759,"writeMsAvg":"65","status":"COMPLETE","writeMsMax":"65","computeMsAvg":"5683","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011253462603878116,"readMsAvg":"83","waitRatioAvg":0.00017313019390581717,"completedParallelInputs":"1","computeRatioMax":0.983898891966759,"name":"S11: Join+","shuffleOutputBytes":"4227524","recordsWritten":"37826","readRatioMax":0.014369806094182825,"steps":[{"kind":"READ","substeps":["$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_list_price","FROM store_sales"]},{"kind":"READ","substeps":["$90, $91, $92, $93, $94, $95, $96, $97","FROM __stage02_output"]},{"kind":"READ","substeps":["$110, $111","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263, $274 := $264, $275 := $265, $276 := $266, $277 := $269","$200 := SUM($230)"]},{"kind":"COMPUTE","substeps":["$230 := subtract($268, $267)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $247 = $110"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $101 = $90"]},{"kind":"WRITE","substeps":["$270, $271, $272, $273, $274, $275, $276, $277, $200","TO __stage11_output","BY HASH($270, $271, $272, $273, $274, $275, $276, $277)"]}],"writeRatioAvg":0.011253462603878116},{"readMsMax":"0","computeMsMax":"42","inputStages":["16"],"waitMsAvg":"8","id":"18","endMs":"1570903461845","waitMsMax":"8","startMs":"1570903461641","waitRatioMax":0.0013850415512465374,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"11269","computeRatioAvg":0.007271468144044321,"writeMsAvg":"92","status":"COMPLETE","writeMsMax":"92","computeMsAvg":"42","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01592797783933518,"readMsAvg":"0","waitRatioAvg":0.0013850415512465374,"completedParallelInputs":"1","computeRatioMax":0.007271468144044321,"name":"S12: Aggregate","shuffleOutputBytes":"338070","recordsWritten":"11269","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$440, $441, $442, $443, $444, $445, $446, $447, $150","FROM __stage10_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $450 := $440, $451 := $441, $452 := $442, $453 := $443, $454 := $444, $455 := $445, $456 := $446, $457 := $447","$120 := SUM($150)"]},{"kind":"WRITE","substeps":["$120, $450","TO __stage12_output","BY HASH($450)"]}],"writeRatioAvg":0.01592797783933518},{"readMsMax":"0","computeMsMax":"48","inputStages":["14"],"waitMsAvg":"1","id":"19","endMs":"1570903461968","waitMsMax":"1","startMs":"1570903461771","waitRatioMax":0.00017313019390581717,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"11213","computeRatioAvg":0.008310249307479225,"writeMsAvg":"51","status":"COMPLETE","writeMsMax":"51","computeMsAvg":"48","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008829639889196677,"readMsAvg":"0","waitRatioAvg":0.00017313019390581717,"completedParallelInputs":"1","computeRatioMax":0.008310249307479225,"name":"S13: Aggregate+","shuffleOutputBytes":"336390","recordsWritten":"11213","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$380, $381, $382, $383, $384, $385, $386, $387, $190","FROM __stage0E_output"]},{"kind":"FILTER","substeps":["greater($140, 0)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384, $395 := $385, $396 := $386, $397 := $387","$140 := SUM($190)"]},{"kind":"WRITE","substeps":["$140, $390","TO __stage13_output","BY HASH($390)"]}],"writeRatioAvg":0.008829639889196677},{"readMsMax":"0","computeMsMax":"201","inputStages":["12"],"waitMsAvg":"1","id":"20","endMs":"1570903462121","waitMsMax":"1","startMs":"1570903461895","waitRatioMax":0.00017313019390581717,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"38235","computeRatioAvg":0.03479916897506925,"writeMsAvg":"50","status":"COMPLETE","writeMsMax":"50","computeMsAvg":"201","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00865650969529086,"readMsAvg":"0","waitRatioAvg":0.00017313019390581717,"completedParallelInputs":"1","computeRatioMax":0.03479916897506925,"name":"S14: Aggregate","shuffleOutputBytes":"2467631","recordsWritten":"38235","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$320, $321, $322, $323, $324, $325, $326, $327, $180","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $330 := $320, $331 := $321, $332 := $322, $333 := $323, $334 := $324, $335 := $325, $336 := $326, $337 := $327","$130 := SUM($180)"]},{"kind":"WRITE","substeps":["$130, $330, $331, $332, $334","TO __stage14_output","BY HASH($330)"]}],"writeRatioAvg":0.00865650969529086},{"readMsMax":"0","computeMsMax":"10","inputStages":["20"],"waitMsAvg":"3","id":"22","endMs":"1570903462674","waitMsMax":"9","startMs":"1570903462150","waitRatioMax":0.0015581717451523547,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"38235","computeRatioAvg":0.001038781163434903,"writeMsAvg":"272","status":"COMPLETE","writeMsMax":"410","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.07098337950138504,"readMsAvg":"0","waitRatioAvg":0.0005193905817174516,"completedParallelInputs":"100","computeRatioMax":0.0017313019390581717,"name":"S16: Coalesce","shuffleOutputBytes":"2467631","recordsWritten":"38235","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage14_output"]}],"writeRatioAvg":0.04709141274238227},{"readMsMax":"0","computeMsMax":"9","inputStages":["19"],"waitMsAvg":"9","id":"23","endMs":"1570903462662","waitMsMax":"10","startMs":"1570903462150","waitRatioMax":0.0017313019390581717,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"11213","computeRatioAvg":0.0008656509695290858,"writeMsAvg":"265","status":"COMPLETE","writeMsMax":"380","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.06578947368421052,"readMsAvg":"0","waitRatioAvg":0.0015581717451523547,"completedParallelInputs":"100","computeRatioMax":0.0015581717451523547,"name":"S17: Coalesce","shuffleOutputBytes":"336390","recordsWritten":"11213","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage13_output"]}],"writeRatioAvg":0.04587950138504155},{"readMsMax":"0","computeMsMax":"11","inputStages":["18"],"waitMsAvg":"10","id":"24","endMs":"1570903462910","waitMsMax":"13","startMs":"1570903462150","waitRatioMax":0.0022506925207756235,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"11269","computeRatioAvg":0.0008656509695290858,"writeMsAvg":"173","status":"COMPLETE","writeMsMax":"350","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.06059556786703601,"readMsAvg":"0","waitRatioAvg":0.0017313019390581717,"completedParallelInputs":"100","computeRatioMax":0.001904432132963989,"name":"S18: Coalesce","shuffleOutputBytes":"338070","recordsWritten":"11269","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage12_output"]}],"writeRatioAvg":0.02995152354570637},{"readMsMax":"0","computeMsMax":"208","inputStages":["17","24","23","22"],"waitMsAvg":"12","id":"25","endMs":"1570903462994","waitMsMax":"12","startMs":"1570903462164","waitRatioMax":0.002077562326869806,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"98543","computeRatioAvg":0.036011080332409975,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"208","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0013850415512465374,"readMsAvg":"0","waitRatioAvg":0.002077562326869806,"completedParallelInputs":"1","computeRatioMax":0.036011080332409975,"name":"S19: Join+","shuffleOutputBytes":"5586","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$270, $271, $272, $273, $274, $275, $276, $277, $200","FROM __stage11_output"]},{"kind":"READ","substeps":["$130, $330, $331, $332, $334","FROM __stage16_output"]},{"kind":"READ","substeps":["$140, $390","FROM __stage17_output"]},{"kind":"READ","substeps":["$120, $450","FROM __stage18_output"]},{"kind":"SORT","substeps":["$460 ASC, $461 ASC, $462 ASC, $463 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["greater(case_no_value(greater($465, 0), divide($467, $465), 0), case_no_value(greater($466, 0), divide($464, $466), 0))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $404 = $450"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $340 = $390"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $280 = $330"]},{"kind":"FILTER","substeps":["greater($160, 0)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $280 := $270, $281 := $271, $282 := $272, $283 := $273, $284 := $274, $285 := $275, $286 := $276, $287 := $277","$160 := SUM($200)"]},{"kind":"WRITE","substeps":["$470, $471, $472, $473","TO __stage19_output"]}],"writeRatioAvg":0.0013850415512465374},{"readMsMax":"0","computeMsMax":"8","inputStages":["25"],"waitMsAvg":"6","id":"26","endMs":"1570903463151","waitMsMax":"6","startMs":"1570903462320","waitRatioMax":0.001038781163434903,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0013850415512465374,"writeMsAvg":"36","status":"COMPLETE","writeMsMax":"36","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006232686980609419,"readMsAvg":"0","waitRatioAvg":0.001038781163434903,"completedParallelInputs":"1","computeRatioMax":0.0013850415512465374,"name":"S1A: Output","shuffleOutputBytes":"5586","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$470, $471, $472, $473","FROM __stage19_output"]},{"kind":"SORT","substeps":["$470 ASC, $471 ASC, $472 ASC, $473 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$480, $481, $482, $483","TO __stage1A_output"]}],"writeRatioAvg":0.006232686980609419}],"estimatedBytesProcessed":"120586011","timeline":[{"totalSlotMs":"1987","activeUnits":"8","completedUnits":"4","elapsedMs":"717","pendingUnits":"8"},{"totalSlotMs":"46710","activeUnits":"97","completedUnits":"209","elapsedMs":"1903","pendingUnits":"3"},{"totalSlotMs":"50384","activeUnits":"2","completedUnits":"210","elapsedMs":"3089","pendingUnits":"2"},{"totalSlotMs":"54729","activeUnits":"1","completedUnits":"212","elapsedMs":"5361","pendingUnits":"0"},{"totalSlotMs":"152418","activeUnits":"55","completedUnits":"474","elapsedMs":"6725","pendingUnits":"43"},{"totalSlotMs":"161514","activeUnits":"0","completedUnits":"517","elapsedMs":"7497","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"120586240","totalPartitionsProcessed":"0","totalBytesProcessed":"120586011","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_1"}]},"endTime":"1570903463471"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query11_1570903453"},"etag":"e2QdxIuLpDXrKfuHq3+8LQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query11_1570903453?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anone2ffef80c40c9bc9c61bb6f91774cfc04feb5c6a","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query11\nWITH year_total \n AS (SELECT c_customer_id customer_id, \n c_first_name customer_first_name \n , \n c_last_name \n customer_last_name, \n c_preferred_cust_flag \n customer_preferred_cust_flag \n , \n c_birth_country \n customer_birth_country, \n c_login customer_login, \n c_email_address \n customer_email_address, \n d_year dyear, \n Sum(ss_ext_list_price - ss_ext_discount_amt) year_total, \n 's' sale_type \n FROM customer, \n store_sales, \n date_dim \n WHERE c_customer_sk = ss_customer_sk \n AND ss_sold_date_sk = d_date_sk \n GROUP BY c_customer_id, \n c_first_name, \n c_last_name, \n c_preferred_cust_flag, \n c_birth_country, \n c_login, \n c_email_address, \n d_year \n UNION ALL \n SELECT c_customer_id customer_id, \n c_first_name customer_first_name \n , \n c_last_name \n customer_last_name, \n c_preferred_cust_flag \n customer_preferred_cust_flag \n , \n c_birth_country \n customer_birth_country, \n c_login customer_login, \n c_email_address \n customer_email_address, \n d_year dyear, \n Sum(ws_ext_list_price - ws_ext_discount_amt) year_total, \n 'w' sale_type \n FROM customer, \n web_sales, \n date_dim \n WHERE c_customer_sk = ws_bill_customer_sk \n AND ws_sold_date_sk = d_date_sk \n GROUP BY c_customer_id, \n c_first_name, \n c_last_name, \n c_preferred_cust_flag, \n c_birth_country, \n c_login, \n c_email_address, \n d_year) \nSELECT t_s_secyear.customer_id, \n t_s_secyear.customer_first_name, \n t_s_secyear.customer_last_name, \n t_s_secyear.customer_birth_country \nFROM year_total t_s_firstyear, \n year_total t_s_secyear, \n year_total t_w_firstyear, \n year_total t_w_secyear \nWHERE t_s_secyear.customer_id = t_s_firstyear.customer_id \n AND t_s_firstyear.customer_id = t_w_secyear.customer_id \n AND t_s_firstyear.customer_id = t_w_firstyear.customer_id \n AND t_s_firstyear.sale_type = 's' \n AND t_w_firstyear.sale_type = 'w' \n AND t_s_secyear.sale_type = 's' \n AND t_w_secyear.sale_type = 'w' \n AND t_s_firstyear.dyear = 2001 \n AND t_s_secyear.dyear = 2001 + 1 \n AND t_w_firstyear.dyear = 2001 \n AND t_w_secyear.dyear = 2001 + 1 \n AND t_s_firstyear.year_total > 0 \n AND t_w_firstyear.year_total > 0 \n AND CASE \n WHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / \n t_w_firstyear.year_total \n ELSE 0.0 \n END > CASE \n WHEN t_s_firstyear.year_total > 0 THEN \n t_s_secyear.year_total / \n t_s_firstyear.year_total \n ELSE 0.0 \n END \nORDER BY t_s_secyear.customer_id, \n t_s_secyear.customer_first_name, \n t_s_secyear.customer_last_name, \n t_s_secyear.customer_birth_country\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query11_1570903453","user_email":"nithish.sankaranarayanan@ulb.be"}
