{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"27850","creationTime":"1570904295333","totalBytesProcessed":"24324192","startTime":"1570904295522","query":{"totalSlotMs":"27850","queryPlan":[{"readMsMax":"51","computeMsMax":"168","waitMsAvg":"1","id":"0","endMs":"1570904296370","waitMsMax":"1","startMs":"1570904295703","waitRatioMax":0.0030211480362537764,"readRatioAvg":0.1540785498489426,"parallelInputs":"1","recordsRead":"288116","computeRatioAvg":0.5075528700906344,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"168","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08157099697885196,"readMsAvg":"51","waitRatioAvg":0.0030211480362537764,"completedParallelInputs":"1","computeRatioMax":0.5075528700906344,"name":"S00: Input","shuffleOutputBytes":"2501820","recordsWritten":"277980","readRatioMax":0.1540785498489426,"steps":[{"kind":"READ","substeps":["$1:sr_cdemo_sk","FROM store_returns"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.08157099697885196},{"readMsMax":"23","computeMsMax":"7","waitMsAvg":"23","id":"1","endMs":"1570904295845","waitMsMax":"23","startMs":"1570904295742","waitRatioMax":0.06948640483383686,"readRatioAvg":0.06948640483383686,"parallelInputs":"1","recordsRead":"20","computeRatioAvg":0.021148036253776436,"writeMsAvg":"56","status":"COMPLETE","writeMsMax":"56","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.1691842900302115,"readMsAvg":"23","waitRatioAvg":0.06948640483383686,"completedParallelInputs":"1","computeRatioMax":0.021148036253776436,"name":"S01: Input","shuffleOutputBytes":"36","recordsWritten":"4","readRatioMax":0.06948640483383686,"steps":[{"kind":"READ","substeps":["$20:ib_income_band_sk, $21:ib_lower_bound, $22:ib_upper_bound","FROM income_band","WHERE and(greater_or_equal($21, 54986), less_or_equal($22, 104986))"]},{"kind":"WRITE","substeps":["$20","TO __stage01_output","BY HASH($20)"]}],"writeRatioAvg":0.1691842900302115},{"readMsMax":"53","computeMsMax":"11","waitMsAvg":"1","id":"2","endMs":"1570904295878","waitMsMax":"1","startMs":"1570904295803","waitRatioMax":0.0030211480362537764,"readRatioAvg":0.16012084592145015,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.03323262839879154,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.021148036253776436,"readMsAvg":"53","waitRatioAvg":0.0030211480362537764,"completedParallelInputs":"1","computeRatioMax":0.03323262839879154,"name":"S02: Input","shuffleOutputBytes":"129600","recordsWritten":"7200","readRatioMax":0.16012084592145015,"steps":[{"kind":"READ","substeps":["$10:hd_demo_sk, $11:hd_income_band_sk","FROM household_demographics"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage02_output","BY HASH($10)"]}],"writeRatioAvg":0.021148036253776436},{"readMsMax":"13","computeMsMax":"9","waitMsAvg":"7","id":"4","endMs":"1570904296004","waitMsMax":"7","startMs":"1570904295846","waitRatioMax":0.021148036253776436,"readRatioAvg":0.03927492447129909,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.027190332326283987,"writeMsAvg":"89","status":"COMPLETE","writeMsMax":"89","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.2688821752265861,"readMsAvg":"13","waitRatioAvg":0.021148036253776436,"completedParallelInputs":"1","computeRatioMax":0.027190332326283987,"name":"S04: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.03927492447129909,"steps":[{"kind":"READ","substeps":["$50:ca_address_sk, $51:ca_city","FROM customer_address","WHERE equal($51, 'Green Acres')"]},{"kind":"WRITE","substeps":["$50","TO __stage04_output","BY HASH($50)"]}],"writeRatioAvg":0.2688821752265861},{"readMsMax":"15","computeMsMax":"57","inputStages":["4"],"waitMsAvg":"1","id":"6","endMs":"1570904296155","waitMsMax":"1","startMs":"1570904296084","waitRatioMax":0.0030211480362537764,"readRatioAvg":0.045317220543806644,"parallelInputs":"1","recordsRead":"100366","computeRatioAvg":0.17220543806646527,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"57","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01812688821752266,"readMsAvg":"15","waitRatioAvg":0.0030211480362537764,"completedParallelInputs":"1","computeRatioMax":0.17220543806646527,"name":"S06: Join","shuffleOutputBytes":"41150","recordsWritten":"681","readRatioMax":0.045317220543806644,"steps":[{"kind":"READ","substeps":["$40:c_customer_id, $41:c_current_cdemo_sk, $42:c_current_hdemo_sk, $43:c_current_addr_sk, $44:c_first_name, $45:c_last_name","FROM customer"]},{"kind":"READ","substeps":["$50","FROM __stage04_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $43 = $50"]},{"kind":"WRITE","substeps":["$70, $71, $72, $73, $74","TO __stage06_output","BY HASH($71)"]}],"writeRatioAvg":0.01812688821752266},{"readMsMax":"0","computeMsMax":"12","inputStages":["6"],"waitMsAvg":"1","id":"7","endMs":"1570904296429","waitMsMax":"3","startMs":"1570904296176","waitRatioMax":0.00906344410876133,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"681","computeRatioAvg":0.01812688821752266,"writeMsAvg":"40","status":"COMPLETE","writeMsMax":"62","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.18731117824773413,"readMsAvg":"0","waitRatioAvg":0.0030211480362537764,"completedParallelInputs":"100","computeRatioMax":0.03625377643504532,"name":"S07: Coalesce","shuffleOutputBytes":"41150","recordsWritten":"681","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage06_output"]}],"writeRatioAvg":0.12084592145015106},{"readMsMax":"24","computeMsMax":"331","inputStages":["0","1","2","7"],"waitMsAvg":"1","id":"9","endMs":"1570904296666","waitMsMax":"1","startMs":"1570904296432","waitRatioMax":0.0030211480362537764,"readRatioAvg":0.07250755287009064,"parallelInputs":"1","recordsRead":"2206665","computeRatioAvg":1,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"331","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012084592145015106,"readMsAvg":"24","waitRatioAvg":0.0030211480362537764,"completedParallelInputs":"1","computeRatioMax":1,"name":"S09: Join+","shuffleOutputBytes":"818","recordsWritten":"21","readRatioMax":0.07250755287009064,"steps":[{"kind":"READ","substeps":["$30:cd_demo_sk","FROM customer_demographics"]},{"kind":"READ","substeps":["$70, $71, $72, $73, $74","FROM __stage07_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage02_output"]},{"kind":"READ","substeps":["$20","FROM __stage01_output"]},{"kind":"READ","substeps":["$1","FROM __stage00_output"]},{"kind":"COMPUTE","substeps":["$60 := concat($122, concat(', ', $121))"]},{"kind":"SORT","substeps":["$110 ASC","LIMIT 100"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $100 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $94 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $81 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $30 = $71"]},{"kind":"WRITE","substeps":["$120, $60","TO __stage09_output"]}],"writeRatioAvg":0.012084592145015106},{"readMsMax":"0","computeMsMax":"5","inputStages":["9"],"waitMsAvg":"2","id":"10","endMs":"1570904296704","waitMsMax":"2","startMs":"1570904296526","waitRatioMax":0.006042296072507553,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"21","computeRatioAvg":0.015105740181268883,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.030211480362537766,"readMsAvg":"0","waitRatioAvg":0.006042296072507553,"completedParallelInputs":"1","computeRatioMax":0.015105740181268883,"name":"S0A: Output","shuffleOutputBytes":"818","recordsWritten":"21","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$120, $60","FROM __stage09_output"]},{"kind":"SORT","substeps":["$120 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$130, $131","TO __stage0A_output"]}],"writeRatioAvg":0.030211480362537766}],"estimatedBytesProcessed":"24324192","timeline":[{"totalSlotMs":"1596","activeUnits":"101","completedUnits":"4","elapsedMs":"683","pendingUnits":"102"},{"totalSlotMs":"27850","activeUnits":"0","completedUnits":"107","elapsedMs":"1374","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"62914560","totalPartitionsProcessed":"0","totalBytesProcessed":"24324192","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"customer_demographics","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"income_band","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_1"}]},"endTime":"1570904296938"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query84_1570904293"},"etag":"bqHTrByjd2AT2eT7fwTdfw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query84_1570904293?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonab37920b709f4160aacbf9c8e9a9a9d1fcdbda80","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query84\nSELECT c_customer_id AS customer_id, \n Concat(c_last_name, Concat(', ', c_first_name)) AS customername \nFROM customer, \n customer_address, \n customer_demographics, \n household_demographics, \n income_band, \n store_returns \nWHERE ca_city = 'Green Acres' \n AND c_current_addr_sk = ca_address_sk \n AND ib_lower_bound >= 54986 \n AND ib_upper_bound <= 54986 + 50000 \n AND ib_income_band_sk = hd_income_band_sk \n AND cd_demo_sk = c_current_cdemo_sk \n AND hd_demo_sk = c_current_hdemo_sk \n AND sr_cdemo_sk = cd_demo_sk \nORDER BY c_customer_id\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query84_1570904293","user_email":"nithish.sankaranarayanan@ulb.be"}
