{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"5594","creationTime":"1570904357756","totalBytesProcessed":"121196312","startTime":"1570904357898","query":{"totalSlotMs":"5594","queryPlan":[{"readMsMax":"39","computeMsMax":"4","waitMsAvg":"2","id":"0","endMs":"1570904358089","waitMsMax":"2","startMs":"1570904358035","waitRatioMax":0.0004748338081671415,"readRatioAvg":0.009259259259259259,"parallelInputs":"1","recordsRead":"35","computeRatioAvg":0.000949667616334283,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"3","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007122507122507123,"readMsAvg":"39","waitRatioAvg":0.0004748338081671415,"completedParallelInputs":"1","computeRatioMax":0.000949667616334283,"name":"S00: Input","shuffleOutputBytes":"0","recordsWritten":"0","readRatioMax":0.009259259259259259,"steps":[{"kind":"READ","substeps":["$20:r_reason_sk, $21:r_reason_desc","FROM reason","WHERE equal($21, 'reason 38')"]},{"kind":"WRITE","substeps":["$20","TO __stage00_output","BY HASH($20)"]}],"writeRatioAvg":0.0007122507122507123},{"readMsMax":"19","computeMsMax":"315","waitMsAvg":"26","id":"1","endMs":"1570904358844","waitMsMax":"26","startMs":"1570904358075","waitRatioMax":0.006172839506172839,"readRatioAvg":0.004510921177587844,"parallelInputs":"1","recordsRead":"288116","computeRatioAvg":0.07478632478632478,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"315","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004748338081671415,"readMsAvg":"19","waitRatioAvg":0.006172839506172839,"completedParallelInputs":"1","computeRatioMax":0.07478632478632478,"name":"S01: Input","shuffleOutputBytes":"10209688","recordsWritten":"288116","readRatioMax":0.004510921177587844,"steps":[{"kind":"READ","substeps":["$10:sr_item_sk, $11:sr_reason_sk, $12:sr_ticket_number, $13:sr_return_quantity","FROM store_returns"]},{"kind":"WRITE","substeps":["$10, $11, $12, $13","TO __stage01_output","BY HASH($10, $12)"]}],"writeRatioAvg":0.004748338081671415},{"readMsMax":"38","computeMsMax":"4212","inputStages":["0","1"],"waitMsAvg":"2","id":"2","endMs":"1570904361216","waitMsMax":"2","startMs":"1570904359013","waitRatioMax":0.0004748338081671415,"readRatioAvg":0.009021842355175688,"parallelInputs":"1","recordsRead":"3169294","computeRatioAvg":1,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"4212","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0011870845204178537,"readMsAvg":"38","waitRatioAvg":0.0004748338081671415,"completedParallelInputs":"1","computeRatioMax":1,"name":"S02: Join+","shuffleOutputBytes":"0","recordsWritten":"0","readRatioMax":0.009021842355175688,"steps":[{"kind":"READ","substeps":["$1:ss_item_sk, $2:ss_customer_sk, $3:ss_ticket_number, $4:ss_quantity, $5:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$10, $11, $12, $13","FROM __stage01_output"]},{"kind":"READ","substeps":["$20","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $80 := $70","$40 := SUM($50)"]},{"kind":"COMPUTE","substeps":["$50 := case_no_value(not(is_null($73)), multiply(CAST(subtract($71, $73) AS DOUBLE), $72), multiply(CAST($71 AS DOUBLE), $72))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $63 = $20"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $1 = $10, $3 = $12"]},{"kind":"WRITE","substeps":["$80, $40","TO __stage02_output","BY HASH($80)"]}],"writeRatioAvg":0.0011870845204178537},{"readMsMax":"0","computeMsMax":"3","inputStages":["2"],"waitMsAvg":"3","id":"3","endMs":"1570904361734","waitMsMax":"3","startMs":"1570904361577","waitRatioMax":0.0007122507122507123,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"0","computeRatioAvg":0.0007122507122507123,"writeMsAvg":"147","status":"COMPLETE","writeMsMax":"147","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0349002849002849,"readMsAvg":"0","waitRatioAvg":0.0007122507122507123,"completedParallelInputs":"1","computeRatioMax":0.0007122507122507123,"name":"S03: Sort+","shuffleOutputBytes":"0","recordsWritten":"0","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$80, $40","FROM __stage02_output"]},{"kind":"SORT","substeps":["$30 ASC, $90 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $90 := $80","$30 := SUM($40)"]},{"kind":"WRITE","substeps":["$100, $101","TO __stage03_output"]}],"writeRatioAvg":0.0349002849002849},{"readMsMax":"0","computeMsMax":"6","inputStages":["3"],"waitMsAvg":"1","id":"4","endMs":"1570904361753","waitMsMax":"1","startMs":"1570904361694","waitRatioMax":0.00023741690408357076,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"0","computeRatioAvg":0.0014245014245014246,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.000949667616334283,"readMsAvg":"0","waitRatioAvg":0.00023741690408357076,"completedParallelInputs":"1","computeRatioMax":0.0014245014245014246,"name":"S04: Output","shuffleOutputBytes":"0","recordsWritten":"0","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$100, $101","FROM __stage03_output"]},{"kind":"SORT","substeps":["$101 ASC, $100 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$110, $111","TO __stage04_output"]}],"writeRatioAvg":0.000949667616334283}],"estimatedBytesProcessed":"121196312","timeline":[{"totalSlotMs":"590","activeUnits":"1","completedUnits":"1","elapsedMs":"637","pendingUnits":"1"},{"totalSlotMs":"1662","activeUnits":"1","completedUnits":"2","elapsedMs":"1448","pendingUnits":"1"},{"totalSlotMs":"5594","activeUnits":"2","completedUnits":"5","elapsedMs":"4028","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"121634816","totalPartitionsProcessed":"0","totalBytesProcessed":"121196312","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"reason","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"}]},"endTime":"1570904361957"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query93_1570904355"},"etag":"u/NUHBtRR1DTdz8cqT20qQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query93_1570904355?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anond75569fb0f706d8f94efe55215abb510a3b62110","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query93\nSELECT ss_customer_sk, \n Sum(act_sales) sumsales \nFROM (SELECT ss_item_sk, \n ss_ticket_number, \n ss_customer_sk, \n CASE \n WHEN sr_return_quantity IS NOT NULL THEN \n ( ss_quantity - sr_return_quantity ) benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup ss_sales_price \n ELSE ( ss_quantity benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup ss_sales_price ) \n END act_sales \n FROM store_sales \n LEFT OUTER JOIN store_returns \n ON ( sr_item_sk = ss_item_sk \n AND sr_ticket_number = ss_ticket_number ), \n reason \n WHERE sr_reason_sk = r_reason_sk \n AND r_reason_desc = 'reason 38') t \nGROUP BY ss_customer_sk \nORDER BY sumsales, \n ss_customer_sk\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query93_1570904355","user_email":"nithish.sankaranarayanan@ulb.be"}
