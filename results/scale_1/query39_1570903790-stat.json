{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"27837","creationTime":"1570903792744","totalBytesProcessed":"373042043","startTime":"1570903792883","query":{"totalSlotMs":"27837","queryPlan":[{"readMsMax":"11","computeMsMax":"10","waitMsAvg":"1","id":"0","endMs":"1570903793110","waitMsMax":"1","startMs":"1570903793032","waitRatioMax":0.00021021652301870928,"readRatioAvg":0.002312381753205802,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0021021652301870925,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0016817321841496743,"readMsAvg":"11","waitRatioAvg":0.00021021652301870928,"completedParallelInputs":"1","computeRatioMax":0.0021021652301870925,"name":"S00: Input","shuffleOutputBytes":"504","recordsWritten":"28","readRatioMax":0.002312381753205802,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $32:d_moy, $31:d_year","FROM date_dim","WHERE and(equal($31, 2002), equal($32, 2))"]},{"kind":"WRITE","substeps":["$30, $32","TO __stage00_output","BY HASH($30)"]}],"writeRatioAvg":0.0016817321841496743},{"readMsMax":"12","computeMsMax":"8","waitMsAvg":"24","id":"1","endMs":"1570903793479","waitMsMax":"24","startMs":"1570903793071","waitRatioMax":0.005045196552449022,"readRatioAvg":0.002522598276224511,"parallelInputs":"1","recordsRead":"5","computeRatioAvg":0.0016817321841496743,"writeMsAvg":"201","status":"COMPLETE","writeMsMax":"201","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04225352112676056,"readMsAvg":"12","waitRatioAvg":0.005045196552449022,"completedParallelInputs":"1","computeRatioMax":0.0016817321841496743,"name":"S01: Input","shuffleOutputBytes":"151","recordsWritten":"5","readRatioMax":0.002522598276224511,"steps":[{"kind":"READ","substeps":["$20:w_warehouse_sk, $21:w_warehouse_name","FROM warehouse"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage01_output","BY HASH($20)"]}],"writeRatioAvg":0.04225352112676056},{"readMsMax":"7","computeMsMax":"18","waitMsAvg":"46","id":"2","endMs":"1570903793374","waitMsMax":"46","startMs":"1570903793110","waitRatioMax":0.009669960058860626,"readRatioAvg":0.001471515661130965,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.0037838974143367668,"writeMsAvg":"190","status":"COMPLETE","writeMsMax":"190","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.039941139373554764,"readMsAvg":"7","waitRatioAvg":0.009669960058860626,"completedParallelInputs":"1","computeRatioMax":0.0037838974143367668,"name":"S02: Input","shuffleOutputBytes":"162000","recordsWritten":"18000","readRatioMax":0.001471515661130965,"steps":[{"kind":"READ","substeps":["$70:i_item_sk","FROM item"]},{"kind":"WRITE","substeps":["$70","TO __stage02_output","BY HASH($70)"]}],"writeRatioAvg":0.039941139373554764},{"readMsMax":"11","computeMsMax":"14","waitMsAvg":"1","id":"4","endMs":"1570903793566","waitMsMax":"1","startMs":"1570903793210","waitRatioMax":0.00021021652301870928,"readRatioAvg":0.002312381753205802,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.00294303132226193,"writeMsAvg":"152","status":"COMPLETE","writeMsMax":"152","computeMsAvg":"14","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03195291149884381,"readMsAvg":"11","waitRatioAvg":0.00021021652301870928,"completedParallelInputs":"1","computeRatioMax":0.00294303132226193,"name":"S04: Input","shuffleOutputBytes":"558","recordsWritten":"31","readRatioMax":0.002312381753205802,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $12:d_moy, $11:d_year","FROM date_dim","WHERE and(equal($11, 2002), equal($12, 1))"]},{"kind":"WRITE","substeps":["$10, $12","TO __stage04_output","BY HASH($10)"]}],"writeRatioAvg":0.03195291149884381},{"readMsMax":"8","computeMsMax":"6","waitMsAvg":"1","id":"5","endMs":"1570903793437","waitMsMax":"1","startMs":"1570903793230","waitRatioMax":0.00021021652301870928,"readRatioAvg":0.0016817321841496743,"parallelInputs":"1","recordsRead":"5","computeRatioAvg":0.0012612991381122556,"writeMsAvg":"190","status":"COMPLETE","writeMsMax":"190","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.039941139373554764,"readMsAvg":"8","waitRatioAvg":0.00021021652301870928,"completedParallelInputs":"1","computeRatioMax":0.0012612991381122556,"name":"S05: Input","shuffleOutputBytes":"151","recordsWritten":"5","readRatioMax":0.0016817321841496743,"steps":[{"kind":"READ","substeps":["$1:w_warehouse_sk, $2:w_warehouse_name","FROM warehouse"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage05_output","BY HASH($1)"]}],"writeRatioAvg":0.039941139373554764},{"readMsMax":"6","computeMsMax":"15","waitMsAvg":"2","id":"6","endMs":"1570903793566","waitMsMax":"2","startMs":"1570903793351","waitRatioMax":0.00042043304603741857,"readRatioAvg":0.0012612991381122556,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.003153247845280639,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"15","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0037838974143367668,"readMsAvg":"6","waitRatioAvg":0.00042043304603741857,"completedParallelInputs":"1","computeRatioMax":0.003153247845280639,"name":"S06: Input","shuffleOutputBytes":"162000","recordsWritten":"18000","readRatioMax":0.0012612991381122556,"steps":[{"kind":"READ","substeps":["$50:i_item_sk","FROM item"]},{"kind":"WRITE","substeps":["$50","TO __stage06_output","BY HASH($50)"]}],"writeRatioAvg":0.0037838974143367668},{"readMsMax":"23","computeMsMax":"4757","inputStages":["0","1","2"],"waitMsAvg":"1","id":"9","endMs":"1570903796243","waitMsMax":"1","startMs":"1570903793527","waitRatioMax":0.00021021652301870928,"readRatioAvg":0.004834980029430313,"parallelInputs":"1","recordsRead":"11763033","computeRatioAvg":1,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"4757","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003994113937355476,"readMsAvg":"23","waitRatioAvg":0.00021021652301870928,"completedParallelInputs":"1","computeRatioMax":1,"name":"S09: Join+","shuffleOutputBytes":"4014000","recordsWritten":"45000","readRatioMax":0.004834980029430313,"steps":[{"kind":"READ","substeps":["$60:inv_date_sk, $61:inv_item_sk, $62:inv_warehouse_sk, $63:inv_quantity_on_hand","FROM inventory"]},{"kind":"READ","substeps":["$70","FROM __stage02_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage01_output"]},{"kind":"READ","substeps":["$30, $32","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $260 := $251, $261 := $250, $262 := $253, $263 := $254","$130 := VAR_POP($150)","$131 := SHARD_AVG($252)"]},{"kind":"COMPUTE","substeps":["$150 := CAST($252 AS DOUBLE)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $230 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $221 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $61 = $70"]},{"kind":"WRITE","substeps":["$261, $260, $263, $262, $130, $131","TO __stage09_output","BY HASH($260, $261, $262, $263)"]}],"writeRatioAvg":0.003994113937355476},{"readMsMax":"18","computeMsMax":"4415","inputStages":["4","5","6"],"waitMsAvg":"1","id":"11","endMs":"1570903796061","waitMsMax":"1","startMs":"1570903793775","waitRatioMax":0.00021021652301870928,"readRatioAvg":0.0037838974143367668,"parallelInputs":"1","recordsRead":"11763036","computeRatioAvg":0.9281059491276015,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"4415","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004414546983392895,"readMsAvg":"18","waitRatioAvg":0.00021021652301870928,"completedParallelInputs":"1","computeRatioMax":0.9281059491276015,"name":"S0B: Join+","shuffleOutputBytes":"4014000","recordsWritten":"45000","readRatioMax":0.0037838974143367668,"steps":[{"kind":"READ","substeps":["$40:inv_date_sk, $41:inv_item_sk, $42:inv_warehouse_sk, $43:inv_quantity_on_hand","FROM inventory"]},{"kind":"READ","substeps":["$50","FROM __stage06_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage05_output"]},{"kind":"READ","substeps":["$10, $12","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $200 := $191, $201 := $190, $202 := $193, $203 := $194","$120 := VAR_POP($140)","$121 := SHARD_AVG($192)"]},{"kind":"COMPUTE","substeps":["$140 := CAST($192 AS DOUBLE)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $170 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $161 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $41 = $50"]},{"kind":"WRITE","substeps":["$201, $200, $203, $202, $120, $121","TO __stage0B_output","BY HASH($200, $201, $202, $203)"]}],"writeRatioAvg":0.004414546983392895},{"readMsMax":"0","computeMsMax":"102","inputStages":["9"],"waitMsAvg":"1","id":"12","endMs":"1570903796898","waitMsMax":"1","startMs":"1570903796821","waitRatioMax":0.00021021652301870928,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"45000","computeRatioAvg":0.021442085347908344,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"102","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001471515661130965,"readMsAvg":"0","waitRatioAvg":0.00021021652301870928,"completedParallelInputs":"1","computeRatioMax":0.021442085347908344,"name":"S0C: Aggregate+","shuffleOutputBytes":"142875","recordsWritten":"3175","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$261, $260, $263, $262, $130, $131","FROM __stage09_output"]},{"kind":"COMPUTE","substeps":["$90 := case_with_value($111, 0, NULL, divide($110, $111))"]},{"kind":"FILTER","substeps":["greater(case_with_value($111, 0, 0, divide($110, $111)), 1)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263","$110 := ROOT_STDDEV_SAMP($130)","$111 := ROOT_AVG($131)"]},{"kind":"WRITE","substeps":["$90, $111, $271, $272, $273","TO __stage0C_output","BY HASH($272, $271)"]}],"writeRatioAvg":0.001471515661130965},{"readMsMax":"0","computeMsMax":"7","inputStages":["12"],"waitMsAvg":"1","id":"14","endMs":"1570903797158","waitMsMax":"3","startMs":"1570903796911","waitRatioMax":0.0006306495690561278,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"3175","computeRatioAvg":0.0008408660920748371,"writeMsAvg":"145","status":"COMPLETE","writeMsMax":"210","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.044145469833928946,"readMsAvg":"0","waitRatioAvg":0.00021021652301870928,"completedParallelInputs":"100","computeRatioMax":0.001471515661130965,"name":"S0E: Coalesce","shuffleOutputBytes":"142875","recordsWritten":"3175","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0C_output"]}],"writeRatioAvg":0.030481395837712845},{"readMsMax":"0","computeMsMax":"107","inputStages":["11","14"],"waitMsAvg":"1","id":"15","endMs":"1570903798115","waitMsMax":"1","startMs":"1570903797033","waitRatioMax":0.00021021652301870928,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"48175","computeRatioAvg":0.02249316796300189,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"107","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0010510826150935463,"readMsAvg":"0","waitRatioAvg":0.00021021652301870928,"completedParallelInputs":"1","computeRatioMax":0.02249316796300189,"name":"S0F: Join+","shuffleOutputBytes":"13770","recordsWritten":"153","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$201, $200, $203, $202, $120, $121","FROM __stage0B_output"]},{"kind":"READ","substeps":["$90, $111, $271, $272, $273","FROM __stage0E_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $212 = $272, $211 = $271"]},{"kind":"COMPUTE","substeps":["$80 := case_with_value($101, 0, NULL, divide($100, $101))"]},{"kind":"FILTER","substeps":["greater(case_with_value($101, 0, 0, divide($100, $101)), 1)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203","$100 := ROOT_STDDEV_SAMP($120)","$101 := ROOT_AVG($121)"]},{"kind":"WRITE","substeps":["$280, $281, $285, $286, $282, $287, $283, $288, $284, $289","TO __stage0F_output"]}],"writeRatioAvg":0.0010510826150935463},{"readMsMax":"0","computeMsMax":"5","inputStages":["15"],"waitMsAvg":"1","id":"16","endMs":"1570903798502","waitMsMax":"1","startMs":"1570903798430","waitRatioMax":0.00021021652301870928,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"153","computeRatioAvg":0.0010510826150935463,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0035736808913180576,"readMsAvg":"0","waitRatioAvg":0.00021021652301870928,"completedParallelInputs":"1","computeRatioMax":0.0010510826150935463,"name":"S10: Output","shuffleOutputBytes":"13770","recordsWritten":"153","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$280, $281, $285, $286, $282, $287, $283, $288, $284, $289","FROM __stage0F_output"]},{"kind":"SORT","substeps":["$280 ASC, $282 ASC, $281 ASC, $284 ASC, $283 ASC, $286 ASC, $289 ASC, $288 ASC"]},{"kind":"WRITE","substeps":["$290, $291, $292, $293, $294, $295, $296, $297, $298, $299","TO __stage10_output"]}],"writeRatioAvg":0.0035736808913180576}],"estimatedBytesProcessed":"373042043","timeline":[{"totalSlotMs":"705","activeUnits":"4","completedUnits":"4","elapsedMs":"651","pendingUnits":"4"},{"totalSlotMs":"1504","activeUnits":"2","completedUnits":"6","elapsedMs":"1185","pendingUnits":"2"},{"totalSlotMs":"26933","activeUnits":"1","completedUnits":"109","elapsedMs":"4439","pendingUnits":"1"},{"totalSlotMs":"27837","activeUnits":"1","completedUnits":"111","elapsedMs":"5805","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"373293056","totalPartitionsProcessed":"0","totalBytesProcessed":"373042043","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"warehouse","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"inventory","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"}]},"endTime":"1570903798716"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query39_1570903790"},"etag":"BrKxTgncFJA0d0XJpFHJgA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query39_1570903790?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonfa56f0b8e11eec59b9d59c161537fe386284f4ed","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query39\nWITH inv \n AS (SELECT w_warehouse_name, \n w_warehouse_sk, \n i_item_sk, \n d_moy, \n stdev, \n mean, \n CASE mean \n WHEN 0 THEN NULL \n ELSE stdev / mean \n END cov \n FROM (SELECT w_warehouse_name, \n w_warehouse_sk, \n i_item_sk, \n d_moy, \n Stddev_samp(inv_quantity_on_hand) stdev, \n Avg(inv_quantity_on_hand) mean \n FROM inventory, \n item, \n warehouse, \n date_dim \n WHERE inv_item_sk = i_item_sk \n AND inv_warehouse_sk = w_warehouse_sk \n AND inv_date_sk = d_date_sk \n AND d_year = 2002 \n GROUP BY w_warehouse_name, \n w_warehouse_sk, \n i_item_sk, \n d_moy) foo \n WHERE CASE mean \n WHEN 0 THEN 0 \n ELSE stdev / mean \n END > 1) \nSELECT inv1.w_warehouse_sk, \n inv1.i_item_sk, \n inv1.d_moy, \n inv1.mean, \n inv1.cov, \n inv2.w_warehouse_sk AS w_warehouse_sk_2, \n inv2.i_item_sk AS i_item_sk_2, \n inv2.d_moy AS d_moy_2, \n inv2.mean AS mean_2, \n inv2.cov AS cov_2 \nFROM inv inv1, \n inv inv2 \nWHERE inv1.i_item_sk = inv2.i_item_sk \n AND inv1.w_warehouse_sk = inv2.w_warehouse_sk \n AND inv1.d_moy = 1 \n AND inv2.d_moy = 1 + 1 \nORDER BY inv1.w_warehouse_sk, \n inv1.i_item_sk, \n inv1.d_moy, \n inv1.mean, \n inv1.cov, \n inv2.d_moy, \n inv2.mean, \n inv2.cov; "},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query39_1570903790","user_email":"nithish.sankaranarayanan@ulb.be"}
