{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"52418","creationTime":"1570903777986","totalBytesProcessed":"82826745","startTime":"1570903778224","query":{"totalSlotMs":"52418","queryPlan":[{"readMsMax":"15","computeMsMax":"123","waitMsAvg":"2","id":"0","endMs":"1570903778598","waitMsMax":"2","startMs":"1570903778436","waitRatioMax":0.000974184120798831,"readRatioAvg":0.007306380905991232,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.059912323429128105,"writeMsAvg":"38","status":"COMPLETE","writeMsMax":"38","computeMsAvg":"123","shuffleOutputBytesSpilled":"0","writeRatioMax":0.018509498295177788,"readMsAvg":"15","waitRatioAvg":0.000974184120798831,"completedParallelInputs":"1","computeRatioMax":0.059912323429128105,"name":"S00: Input","shuffleOutputBytes":"3027711","recordsWritten":"100000","readRatioMax":0.007306380905991232,"steps":[{"kind":"READ","substeps":["$20:c_customer_sk, $21:c_first_name, $22:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$20, $21, $22","TO __stage00_output","BY HASH($20)"]}],"writeRatioAvg":0.018509498295177788},{"readMsMax":"14","computeMsMax":"10","waitMsAvg":"28","id":"1","endMs":"1570903778683","waitMsMax":"28","startMs":"1570903778479","waitRatioMax":0.013638577691183634,"readRatioAvg":0.006819288845591817,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004870920603994155,"writeMsAvg":"176","status":"COMPLETE","writeMsMax":"176","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08572820263029712,"readMsAvg":"14","waitRatioAvg":0.013638577691183634,"completedParallelInputs":"1","computeRatioMax":0.004870920603994155,"name":"S01: Input","shuffleOutputBytes":"8760","recordsWritten":"365","readRatioMax":0.006819288845591817,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_date, $82:d_month_seq","FROM date_dim","WHERE between($82, 1188, 1199)"]},{"kind":"WRITE","substeps":["$80, $81","TO __stage01_output","BY HASH($80)"]}],"writeRatioAvg":0.08572820263029712},{"readMsMax":"12","computeMsMax":"118","waitMsAvg":"16","id":"3","endMs":"1570903779298","waitMsMax":"16","startMs":"1570903778589","waitRatioMax":0.007793472966390648,"readRatioAvg":0.0058451047247929854,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.05747686312713103,"writeMsAvg":"13","status":"COMPLETE","writeMsMax":"13","computeMsAvg":"118","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0063321967851924016,"readMsAvg":"12","waitRatioAvg":0.007793472966390648,"completedParallelInputs":"1","computeRatioMax":0.05747686312713103,"name":"S03: Input","shuffleOutputBytes":"3027711","recordsWritten":"100000","readRatioMax":0.0058451047247929854,"steps":[{"kind":"READ","substeps":["$10:c_customer_sk, $11:c_first_name, $12:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage03_output","BY HASH($10)"]}],"writeRatioAvg":0.0063321967851924016},{"readMsMax":"8","computeMsMax":"12","waitMsAvg":"6","id":"4","endMs":"1570903778691","waitMsMax":"6","startMs":"1570903778598","waitRatioMax":0.0029225523623964927,"readRatioAvg":0.003896736483195324,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0058451047247929854,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009254749147588894,"readMsAvg":"8","waitRatioAvg":0.0029225523623964927,"completedParallelInputs":"1","computeRatioMax":0.0058451047247929854,"name":"S04: Input","shuffleOutputBytes":"8760","recordsWritten":"365","readRatioMax":0.003896736483195324,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_date, $72:d_month_seq","FROM date_dim","WHERE between($72, 1188, 1199)"]},{"kind":"WRITE","substeps":["$70, $71","TO __stage04_output","BY HASH($70)"]}],"writeRatioAvg":0.009254749147588894},{"readMsMax":"17","computeMsMax":"10","waitMsAvg":"1","id":"7","endMs":"1570903778865","waitMsMax":"1","startMs":"1570903778641","waitRatioMax":0.0004870920603994155,"readRatioAvg":0.008280565026790063,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004870920603994155,"writeMsAvg":"190","status":"COMPLETE","writeMsMax":"190","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.09254749147588895,"readMsAvg":"17","waitRatioAvg":0.0004870920603994155,"completedParallelInputs":"1","computeRatioMax":0.004870920603994155,"name":"S07: Input","shuffleOutputBytes":"8760","recordsWritten":"365","readRatioMax":0.008280565026790063,"steps":[{"kind":"READ","substeps":["$60:d_date_sk, $61:d_date, $62:d_month_seq","FROM date_dim","WHERE between($62, 1188, 1199)"]},{"kind":"WRITE","substeps":["$60, $61","TO __stage07_output","BY HASH($60)"]}],"writeRatioAvg":0.09254749147588895},{"readMsMax":"31","computeMsMax":"1363","inputStages":["0","1"],"waitMsAvg":"1","id":"9","endMs":"1570903779520","waitMsMax":"1","startMs":"1570903778774","waitRatioMax":0.0004870920603994155,"readRatioAvg":0.01509985387238188,"parallelInputs":"1","recordsRead":"1537807","computeRatioAvg":0.6639064783244033,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"1363","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009254749147588894,"readMsAvg":"31","waitRatioAvg":0.0004870920603994155,"completedParallelInputs":"1","computeRatioMax":0.6639064783244033,"name":"S09: Join+","shuffleOutputBytes":"1149371","recordsWritten":"31557","readRatioMax":0.01509985387238188,"steps":[{"kind":"READ","substeps":["$50:cs_sold_date_sk, $51:cs_bill_customer_sk","FROM catalog_sales"]},{"kind":"READ","substeps":["$80, $81","FROM __stage01_output"]},{"kind":"READ","substeps":["$20, $21, $22","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $170 := $162, $171 := $161, $172 := $160"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $150 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $50 = $80"]},{"kind":"WRITE","substeps":["$171, $170, $172","TO __stage09_output","BY HASH($170, $171, $172)"]}],"writeRatioAvg":0.009254749147588894},{"readMsMax":"16","computeMsMax":"241","inputStages":["7"],"waitMsAvg":"1","id":"11","endMs":"1570903779171","waitMsMax":"1","startMs":"1570903778994","waitRatioMax":0.0004870920603994155,"readRatioAvg":0.007793472966390648,"parallelInputs":"1","recordsRead":"721124","computeRatioAvg":0.11738918655625913,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"241","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010228933268387726,"readMsAvg":"16","waitRatioAvg":0.0004870920603994155,"completedParallelInputs":"1","computeRatioMax":0.11738918655625913,"name":"S0B: Join","shuffleOutputBytes":"3417576","recordsWritten":"142399","readRatioMax":0.007793472966390648,"steps":[{"kind":"READ","substeps":["$30:ws_sold_date_sk, $31:ws_bill_customer_sk","FROM web_sales"]},{"kind":"READ","substeps":["$60, $61","FROM __stage07_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $30 = $60"]},{"kind":"WRITE","substeps":["$200, $201","TO __stage0B_output","BY HASH($200)"]}],"writeRatioAvg":0.010228933268387726},{"readMsMax":"0","computeMsMax":"13","inputStages":["11"],"waitMsAvg":"1","id":"12","endMs":"1570903779445","waitMsMax":"2","startMs":"1570903779214","waitRatioMax":0.000974184120798831,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"142399","computeRatioAvg":0.0029225523623964927,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"33","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01607403799318071,"readMsAvg":"0","waitRatioAvg":0.0004870920603994155,"completedParallelInputs":"100","computeRatioMax":0.0063321967851924016,"name":"S0C: Coalesce","shuffleOutputBytes":"3417576","recordsWritten":"142399","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0B_output"]}],"writeRatioAvg":0.008280565026790063},{"readMsMax":"53","computeMsMax":"182","inputStages":["12"],"waitMsAvg":"1","id":"13","endMs":"1570903783756","waitMsMax":"1","startMs":"1570903780361","waitRatioMax":0.0004870920603994155,"readRatioAvg":0.025815879201169022,"parallelInputs":"1","recordsRead":"242399","computeRatioAvg":0.08865075499269362,"writeMsAvg":"30","status":"COMPLETE","writeMsMax":"30","computeMsAvg":"182","shuffleOutputBytesSpilled":"0","writeRatioMax":0.014612761811982464,"readMsAvg":"53","waitRatioAvg":0.0004870920603994155,"completedParallelInputs":"1","computeRatioMax":0.08865075499269362,"name":"S0D: Join+","shuffleOutputBytes":"429900","recordsWritten":"11825","readRatioMax":0.025815879201169022,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_first_name, $3:c_last_name","FROM customer"]},{"kind":"READ","substeps":["$200, $201","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $220 := $212, $221 := $211, $222 := $210"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $200"]},{"kind":"WRITE","substeps":["$221, $220, $222","TO __stage0D_output","BY HASH($220, $221, $222)"]}],"writeRatioAvg":0.014612761811982464},{"readMsMax":"19","computeMsMax":"2053","inputStages":["3","4"],"waitMsAvg":"1","id":"14","endMs":"1570903781592","waitMsMax":"1","startMs":"1570903780385","waitRatioMax":0.0004870920603994155,"readRatioAvg":0.009254749147588894,"parallelInputs":"1","recordsRead":"2981543","computeRatioAvg":1,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"2053","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01071602532878714,"readMsAvg":"19","waitRatioAvg":0.0004870920603994155,"completedParallelInputs":"1","computeRatioMax":1,"name":"S0E: Join+","shuffleOutputBytes":"1731911","recordsWritten":"47462","readRatioMax":0.009254749147588894,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_customer_sk","FROM store_sales"]},{"kind":"READ","substeps":["$70, $71","FROM __stage04_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $130 := $122, $131 := $121, $132 := $120"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $110 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $70"]},{"kind":"WRITE","substeps":["$131, $130, $132","TO __stage0E_output","BY HASH($130, $131, $132)"]}],"writeRatioAvg":0.01071602532878714},{"readMsMax":"0","computeMsMax":"33","inputStages":["13"],"waitMsAvg":"2","id":"15","endMs":"1570903784611","waitMsMax":"2","startMs":"1570903784532","waitRatioMax":0.000974184120798831,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"11825","computeRatioAvg":0.01607403799318071,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"25","computeMsAvg":"33","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012177301509985387,"readMsAvg":"0","waitRatioAvg":0.000974184120798831,"completedParallelInputs":"1","computeRatioMax":0.01607403799318071,"name":"S0F: Aggregate","shuffleOutputBytes":"416160","recordsWritten":"11265","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$221, $220, $222","FROM __stage0D_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $220, $231 := $221, $232 := $222"]},{"kind":"WRITE","substeps":["$230, $231, $232","TO __stage0F_output","BY HASH($230, $231, $232)"]}],"writeRatioAvg":0.012177301509985387},{"readMsMax":"0","computeMsMax":"74","inputStages":["9"],"waitMsAvg":"1","id":"16","endMs":"1570903784634","waitMsMax":"1","startMs":"1570903784553","waitRatioMax":0.0004870920603994155,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"31557","computeRatioAvg":0.03604481246955674,"writeMsAvg":"30","status":"COMPLETE","writeMsMax":"30","computeMsAvg":"74","shuffleOutputBytesSpilled":"0","writeRatioMax":0.014612761811982464,"readMsAvg":"0","waitRatioAvg":0.0004870920603994155,"completedParallelInputs":"1","computeRatioMax":0.03604481246955674,"name":"S10: Aggregate","shuffleOutputBytes":"1113227","recordsWritten":"30117","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$171, $170, $172","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $170, $181 := $171, $182 := $172"]},{"kind":"WRITE","substeps":["$180, $181, $182","TO __stage10_output","BY HASH($180, $181, $182)"]}],"writeRatioAvg":0.014612761811982464},{"readMsMax":"0","computeMsMax":"9","inputStages":["16"],"waitMsAvg":"2","id":"18","endMs":"1570903784931","waitMsMax":"6","startMs":"1570903784644","waitRatioMax":0.0029225523623964927,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"30117","computeRatioAvg":0.0024354603019970775,"writeMsAvg":"54","status":"COMPLETE","writeMsMax":"75","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03653190452995616,"readMsAvg":"0","waitRatioAvg":0.000974184120798831,"completedParallelInputs":"100","computeRatioMax":0.00438382854359474,"name":"S12: Coalesce","shuffleOutputBytes":"1113227","recordsWritten":"30117","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage10_output"]}],"writeRatioAvg":0.026302971261568435},{"readMsMax":"0","computeMsMax":"10","inputStages":["15"],"waitMsAvg":"5","id":"19","endMs":"1570903784938","waitMsMax":"8","startMs":"1570903784644","waitRatioMax":0.003896736483195324,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"11265","computeRatioAvg":0.0029225523623964927,"writeMsAvg":"48","status":"COMPLETE","writeMsMax":"70","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.034096444227959086,"readMsAvg":"0","waitRatioAvg":0.0024354603019970775,"completedParallelInputs":"100","computeRatioMax":0.004870920603994155,"name":"S13: Coalesce","shuffleOutputBytes":"416160","recordsWritten":"11265","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0F_output"]}],"writeRatioAvg":0.023380418899171942},{"readMsMax":"0","computeMsMax":"123","inputStages":["14","19","18"],"waitMsAvg":"9","id":"20","endMs":"1570903785083","waitMsMax":"9","startMs":"1570903784653","waitRatioMax":0.00438382854359474,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"88844","computeRatioAvg":0.059912323429128105,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"123","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00438382854359474,"readMsAvg":"0","waitRatioAvg":0.00438382854359474,"completedParallelInputs":"1","computeRatioMax":0.059912323429128105,"name":"S14: Join+","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$131, $130, $132","FROM __stage0E_output"]},{"kind":"READ","substeps":["$180, $181, $182","FROM __stage12_output"]},{"kind":"READ","substeps":["$230, $231, $232","FROM __stage13_output"]},{"kind":"AGGREGATE","substeps":["$100 := COUNT_STAR()"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $191 = $230, $190 = $231, $192 = $232"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $140 = $180, $141 = $181, $142 = $182"]},{"kind":"AGGREGATE","substeps":["GROUP BY $140 := $130, $141 := $131, $142 := $132"]},{"kind":"WRITE","substeps":["$100","TO __stage14_output"]}],"writeRatioAvg":0.00438382854359474},{"readMsMax":"0","computeMsMax":"5","inputStages":["20"],"waitMsAvg":"2","id":"21","endMs":"1570903785150","waitMsMax":"2","startMs":"1570903784683","waitRatioMax":0.000974184120798831,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.0024354603019970775,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00438382854359474,"readMsAvg":"0","waitRatioAvg":0.000974184120798831,"completedParallelInputs":"1","computeRatioMax":0.0024354603019970775,"name":"S15: Output","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$100","FROM __stage14_output"]},{"kind":"LIMIT","substeps":["100"]},{"kind":"AGGREGATE","substeps":["$90 := SUM_OF_COUNTS($100)"]},{"kind":"WRITE","substeps":["$90","TO __stage15_output"]}],"writeRatioAvg":0.00438382854359474}],"estimatedBytesProcessed":"82826745","timeline":[{"totalSlotMs":"1234","activeUnits":"4","completedUnits":"4","elapsedMs":"715","pendingUnits":"5"},{"totalSlotMs":"15568","activeUnits":"2","completedUnits":"108","elapsedMs":"1800","pendingUnits":"1"},{"totalSlotMs":"16402","activeUnits":"2","completedUnits":"107","elapsedMs":"2641","pendingUnits":"2"},{"totalSlotMs":"18911","activeUnits":"1","completedUnits":"108","elapsedMs":"3871","pendingUnits":"1"},{"totalSlotMs":"51948","activeUnits":"2","completedUnits":"311","elapsedMs":"6810","pendingUnits":"2"},{"totalSlotMs":"52418","activeUnits":"2","completedUnits":"313","elapsedMs":"7370","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"82837504","totalPartitionsProcessed":"0","totalBytesProcessed":"82826745","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_1"}]},"endTime":"1570903785634"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query38_1570903776"},"etag":"AXVAn5F4EDBcS5mL+Ss8Gg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query38_1570903776?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonb80de1ded9e348e7d5d68c203dfa6f0c13cc5246","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query38\nWITH g1 AS (\n SELECT DISTINCT c_last_name, \n c_first_name, \n d_date \n FROM store_sales, \n date_dim, \n customer \n WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk \n AND store_sales.ss_customer_sk = customer.c_customer_sk \n AND d_month_seq BETWEEN 1188 AND 1188 + 11 \n), g2 AS (\n SELECT DISTINCT c_last_name, \n c_first_name, \n d_date \n FROM catalog_sales, \n date_dim, \n customer \n WHERE catalog_sales.cs_sold_date_sk = date_dim.d_date_sk \n AND catalog_sales.cs_bill_customer_sk = customer.c_customer_sk \n AND d_month_seq BETWEEN 1188 AND 1188 + 11 \n), g3 AS (\n SELECT DISTINCT c_last_name, \n c_first_name, \n d_date \n FROM web_sales, \n date_dim, \n customer \n WHERE web_sales.ws_sold_date_sk = date_dim.d_date_sk \n AND web_sales.ws_bill_customer_sk = customer.c_customer_sk \n AND d_month_seq BETWEEN 1188 AND 1188 + 11\n)\nSELECT Count(*) \nFROM g1 \nJOIN g2 ON g1.c_last_name = g2.c_last_name AND g1.c_first_name = g2.c_first_name AND g1.d_date = g2.d_date\nJOIN g3 ON g1.c_last_name = g3.c_last_name AND g1.c_first_name = g3.c_first_name AND g1.d_date = g3.d_date\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query38_1570903776","user_email":"nithish.sankaranarayanan@ulb.be"}
