{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"1742","creationTime":"1570904217055","totalBytesProcessed":"160013136","startTime":"1570904217219","query":{"totalSlotMs":"1742","queryPlan":[{"readMsMax":"14","computeMsMax":"61","waitMsAvg":"1","id":"0","endMs":"1570904217589","waitMsMax":"1","startMs":"1570904217366","waitRatioMax":0.0023752969121140144,"readRatioAvg":0.0332541567695962,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.14489311163895488,"writeMsAvg":"170","status":"COMPLETE","writeMsMax":"170","computeMsAvg":"61","shuffleOutputBytesSpilled":"0","writeRatioMax":0.40380047505938244,"readMsAvg":"14","waitRatioAvg":0.0023752969121140144,"completedParallelInputs":"1","computeRatioMax":0.14489311163895488,"name":"S00: Input","shuffleOutputBytes":"1972323","recordsWritten":"73049","readRatioMax":0.0332541567695962,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_year, $22:d_qoy","FROM date_dim"]},{"kind":"WRITE","substeps":["$20, $21, $22","TO __stage00_output","BY HASH($20)"]}],"writeRatioAvg":0.40380047505938244},{"readMsMax":"8","computeMsMax":"17","waitMsAvg":"2","id":"1","endMs":"1570904217550","waitMsMax":"2","startMs":"1570904217456","waitRatioMax":0.004750593824228029,"readRatioAvg":0.019002375296912115,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.040380047505938245,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"17","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05463182897862233,"readMsAvg":"8","waitRatioAvg":0.004750593824228029,"completedParallelInputs":"1","computeRatioMax":0.040380047505938245,"name":"S01: Input","shuffleOutputBytes":"357892","recordsWritten":"18000","readRatioMax":0.019002375296912115,"steps":[{"kind":"READ","substeps":["$50:i_item_sk, $51:i_category","FROM item"]},{"kind":"WRITE","substeps":["$50, $51","TO __stage01_output","BY HASH($50)"]}],"writeRatioAvg":0.05463182897862233},{"readMsMax":"12","computeMsMax":"61","waitMsAvg":"51","id":"3","endMs":"1570904217607","waitMsMax":"51","startMs":"1570904217541","waitRatioMax":0.12114014251781473,"readRatioAvg":0.028503562945368172,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.14489311163895488,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"12","computeMsAvg":"61","shuffleOutputBytesSpilled":"0","writeRatioMax":0.028503562945368172,"readMsAvg":"12","waitRatioAvg":0.12114014251781473,"completedParallelInputs":"1","computeRatioMax":0.14489311163895488,"name":"S03: Input","shuffleOutputBytes":"1972323","recordsWritten":"73049","readRatioMax":0.028503562945368172,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $11:d_year, $12:d_qoy","FROM date_dim"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage03_output","BY HASH($10)"]}],"writeRatioAvg":0.028503562945368172},{"readMsMax":"5","computeMsMax":"17","waitMsAvg":"42","id":"4","endMs":"1570904217606","waitMsMax":"42","startMs":"1570904217550","waitRatioMax":0.0997624703087886,"readRatioAvg":0.011876484560570071,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.040380047505938245,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"25","computeMsAvg":"17","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05938242280285035,"readMsAvg":"5","waitRatioAvg":0.0997624703087886,"completedParallelInputs":"1","computeRatioMax":0.040380047505938245,"name":"S04: Input","shuffleOutputBytes":"357892","recordsWritten":"18000","readRatioMax":0.011876484560570071,"steps":[{"kind":"READ","substeps":["$40:i_item_sk, $41:i_category","FROM item"]},{"kind":"WRITE","substeps":["$40, $41","TO __stage04_output","BY HASH($40)"]}],"writeRatioAvg":0.05938242280285035},{"readMsMax":"8","computeMsMax":"56","waitMsAvg":"35","id":"6","endMs":"1570904217778","waitMsMax":"35","startMs":"1570904217585","waitRatioMax":0.0831353919239905,"readRatioAvg":0.019002375296912115,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.1330166270783848,"writeMsAvg":"148","status":"COMPLETE","writeMsMax":"148","computeMsAvg":"56","shuffleOutputBytesSpilled":"0","writeRatioMax":0.3515439429928741,"readMsAvg":"8","waitRatioAvg":0.0831353919239905,"completedParallelInputs":"1","computeRatioMax":0.1330166270783848,"name":"S06: Input","shuffleOutputBytes":"1972323","recordsWritten":"73049","readRatioMax":0.019002375296912115,"steps":[{"kind":"READ","substeps":["$1:d_date_sk, $2:d_year, $3:d_qoy","FROM date_dim"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage06_output","BY HASH($1)"]}],"writeRatioAvg":0.3515439429928741},{"readMsMax":"8","computeMsMax":"20","waitMsAvg":"19","id":"7","endMs":"1570904217754","waitMsMax":"19","startMs":"1570904217585","waitRatioMax":0.04513064133016627,"readRatioAvg":0.019002375296912115,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.047505938242280284,"writeMsAvg":"144","status":"COMPLETE","writeMsMax":"144","computeMsAvg":"20","shuffleOutputBytesSpilled":"0","writeRatioMax":0.342042755344418,"readMsAvg":"8","waitRatioAvg":0.04513064133016627,"completedParallelInputs":"1","computeRatioMax":0.047505938242280284,"name":"S07: Input","shuffleOutputBytes":"357892","recordsWritten":"18000","readRatioMax":0.019002375296912115,"steps":[{"kind":"READ","substeps":["$30:i_item_sk, $31:i_category","FROM item"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage07_output","BY HASH($30)"]}],"writeRatioAvg":0.342042755344418},{"readMsMax":"40","computeMsMax":"421","inputStages":["0","1","7","3","4","6"],"waitMsAvg":"1","id":"12","endMs":"1570904218116","waitMsMax":"1","startMs":"1570904217821","waitRatioMax":0.0023752969121140144,"readRatioAvg":0.07125890736342043,"parallelInputs":"3","recordsRead":"5312526","computeRatioAvg":0.503562945368171,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"212","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009501187648456057,"readMsAvg":"30","waitRatioAvg":0.0023752969121140144,"completedParallelInputs":"3","computeRatioMax":1,"name":"S0C: Join+","shuffleOutputBytes":"37898","recordsWritten":"507","readRatioMax":0.09501187648456057,"steps":[{"kind":"READ","substeps":["$60:ss_sold_date_sk, $61:ss_item_sk, $63:ss_ext_sales_price, $62:ss_hdemo_sk","FROM store_sales","WHERE is_null($62)"]},{"kind":"READ","substeps":["$30, $31","FROM __stage07_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage06_output"]},{"kind":"READ","substeps":["$70:ws_sold_date_sk, $71:ws_item_sk, $73:ws_ext_sales_price, $72:ws_ship_hdemo_sk","FROM web_sales","WHERE is_null($72)"]},{"kind":"READ","substeps":["$40, $41","FROM __stage04_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage03_output"]},{"kind":"READ","substeps":["$80:cs_sold_date_sk, $82:cs_item_sk, $83:cs_ext_sales_price, $81:cs_warehouse_sk","FROM catalog_sales","WHERE is_null($81)"]},{"kind":"READ","substeps":["$50, $51","FROM __stage01_output"]},{"kind":"READ","substeps":["$20, $21, $22","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $210 := $110, $211 := $111, $212 := $112, $213 := $113, $214 := $114","$100 := COUNT_STAR()","$101 := SUM($115)"]},{"kind":"COMPUTE","substeps":["$120 := 'store'","$121 := 'ss_hdemo_sk'"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $150 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $61 = $30"]},{"kind":"COMPUTE","substeps":["$130 := 'web'","$131 := 'ws_ship_hdemo_sk'"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $170 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $71 = $40"]},{"kind":"COMPUTE","substeps":["$140 := 'catalog'","$141 := 'cs_warehouse_sk'"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $190 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $82 = $50"]},{"kind":"WRITE","substeps":["$100, $101, $210, $211, $212, $213, $214","TO __stage0C_output","BY HASH($210, $211, $212, $213, $214)"]}],"writeRatioAvg":0.009501187648456057},{"readMsMax":"0","computeMsMax":"4","inputStages":["12"],"waitMsAvg":"1","id":"13","endMs":"1570904218159","waitMsMax":"1","startMs":"1570904218147","waitRatioMax":0.0023752969121140144,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"507","computeRatioAvg":0.009501187648456057,"writeMsAvg":"2","status":"COMPLETE","writeMsMax":"2","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004750593824228029,"readMsAvg":"0","waitRatioAvg":0.0023752969121140144,"completedParallelInputs":"1","computeRatioMax":0.009501187648456057,"name":"S0D: Sort+","shuffleOutputBytes":"7829","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$100, $101, $210, $211, $212, $213, $214","FROM __stage0C_output"]},{"kind":"SORT","substeps":["$220 ASC, $221 ASC, $222 ASC, $223 ASC, $224 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $220 := $210, $221 := $211, $222 := $212, $223 := $213, $224 := $214","$90 := SUM_OF_COUNTS($100)","$91 := SUM($101)"]},{"kind":"WRITE","substeps":["$230, $231, $232, $233, $234, $235, $236","TO __stage0D_output"]}],"writeRatioAvg":0.004750593824228029},{"readMsMax":"0","computeMsMax":"7","inputStages":["13"],"waitMsAvg":"1","id":"14","endMs":"1570904218288","waitMsMax":"1","startMs":"1570904218208","waitRatioMax":0.0023752969121140144,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0166270783847981,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.057007125890736345,"readMsAvg":"0","waitRatioAvg":0.0023752969121140144,"completedParallelInputs":"1","computeRatioMax":0.0166270783847981,"name":"S0E: Output","shuffleOutputBytes":"7829","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$230, $231, $232, $233, $234, $235, $236","FROM __stage0D_output"]},{"kind":"SORT","substeps":["$232 ASC, $233 ASC, $234 ASC, $235 ASC, $236 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$240, $241, $242, $243, $244, $245, $246","TO __stage0E_output"]}],"writeRatioAvg":0.057007125890736345}],"estimatedBytesProcessed":"160013136","timeline":[{"totalSlotMs":"1011","activeUnits":"3","completedUnits":"6","elapsedMs":"649","pendingUnits":"3"},{"totalSlotMs":"1742","activeUnits":"3","completedUnits":"11","elapsedMs":"1233","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"160432128","totalPartitionsProcessed":"0","totalBytesProcessed":"160013136","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"}]},"endTime":"1570904218478"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query76_1570904215"},"etag":"eCC3C5OzmfrgLYE0RLtXUA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query76_1570904215?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon1f3448ee75623a1a5747a7126468b46ba1fcef57","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query76\nSELECT channel, \n col_name, \n d_year, \n d_qoy, \n i_category, \n Count(*) sales_cnt, \n Sum(ext_sales_price) sales_amt \nFROM (SELECT 'store' AS channel, \n 'ss_hdemo_sk' col_name, \n d_year, \n d_qoy, \n i_category, \n ss_ext_sales_price ext_sales_price \n FROM store_sales, \n item, \n date_dim \n WHERE ss_hdemo_sk IS NULL \n AND ss_sold_date_sk = d_date_sk \n AND ss_item_sk = i_item_sk \n UNION ALL \n SELECT 'web' AS channel, \n 'ws_ship_hdemo_sk' col_name, \n d_year, \n d_qoy, \n i_category, \n ws_ext_sales_price ext_sales_price \n FROM web_sales, \n item, \n date_dim \n WHERE ws_ship_hdemo_sk IS NULL \n AND ws_sold_date_sk = d_date_sk \n AND ws_item_sk = i_item_sk \n UNION ALL \n SELECT 'catalog' AS channel, \n 'cs_warehouse_sk' col_name, \n d_year, \n d_qoy, \n i_category, \n cs_ext_sales_price ext_sales_price \n FROM catalog_sales, \n item, \n date_dim \n WHERE cs_warehouse_sk IS NULL \n AND cs_sold_date_sk = d_date_sk \n AND cs_item_sk = i_item_sk) foo \nGROUP BY channel, \n col_name, \n d_year, \n d_qoy, \n i_category \nORDER BY channel, \n col_name, \n d_year, \n d_qoy, \n i_category\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query76_1570904215","user_email":"nithish.sankaranarayanan@ulb.be"}
