{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"3877","creationTime":"1570903569953","totalBytesProcessed":"116338344","startTime":"1570903570090","query":{"totalSlotMs":"3877","queryPlan":[{"readMsMax":"19","computeMsMax":"10","waitMsAvg":"1","id":"0","endMs":"1570903570722","waitMsMax":"1","startMs":"1570903570484","waitRatioMax":0.0005402485143165856,"readRatioAvg":0.010264721772015126,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.005402485143165856,"writeMsAvg":"34","status":"COMPLETE","writeMsMax":"34","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.018368449486763912,"readMsAvg":"19","waitRatioAvg":0.0005402485143165856,"completedParallelInputs":"1","computeRatioMax":0.005402485143165856,"name":"S00: Input","shuffleOutputBytes":"228","recordsWritten":"12","readRatioMax":0.010264721772015126,"steps":[{"kind":"READ","substeps":["$1:s_store_sk, $2:s_zip","FROM store"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.018368449486763912},{"readMsMax":"12","computeMsMax":"41","waitMsAvg":"3","id":"1","endMs":"1570903570740","waitMsMax":"3","startMs":"1570903570525","waitRatioMax":0.0016207455429497568,"readRatioAvg":0.006482982171799027,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.02215018908698001,"writeMsAvg":"166","status":"COMPLETE","writeMsMax":"166","computeMsAvg":"41","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08968125337655321,"readMsAvg":"12","waitRatioAvg":0.0016207455429497568,"completedParallelInputs":"1","computeRatioMax":0.02215018908698001,"name":"S01: Input","shuffleOutputBytes":"936383","recordsWritten":"50000","readRatioMax":0.006482982171799027,"steps":[{"kind":"READ","substeps":["$10:ca_address_sk, $11:ca_zip","FROM customer_address"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.08968125337655321},{"readMsMax":"15","computeMsMax":"86","waitMsAvg":"1","id":"2","endMs":"1570903570724","waitMsMax":"1","startMs":"1570903570594","waitRatioMax":0.0005402485143165856,"readRatioAvg":0.008103727714748784,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.046461372231226365,"writeMsAvg":"47","status":"COMPLETE","writeMsMax":"47","computeMsAvg":"86","shuffleOutputBytesSpilled":"0","writeRatioMax":0.025391680172879523,"readMsAvg":"15","waitRatioAvg":0.0005402485143165856,"completedParallelInputs":"1","computeRatioMax":0.046461372231226365,"name":"S02: Input","shuffleOutputBytes":"1800000","recordsWritten":"100000","readRatioMax":0.008103727714748784,"steps":[{"kind":"READ","substeps":["$20:c_customer_sk, $21:c_current_addr_sk","FROM customer"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.025391680172879523},{"readMsMax":"9","computeMsMax":"13","waitMsAvg":"27","id":"3","endMs":"1570903570861","waitMsMax":"27","startMs":"1570903570639","waitRatioMax":0.014586709886547812,"readRatioAvg":0.004862236628849271,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.007023230686115613,"writeMsAvg":"57","status":"COMPLETE","writeMsMax":"57","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03079416531604538,"readMsAvg":"9","waitRatioAvg":0.014586709886547812,"completedParallelInputs":"1","computeRatioMax":0.007023230686115613,"name":"S03: Input","shuffleOutputBytes":"10023","recordsWritten":"155","readRatioMax":0.004862236628849271,"steps":[{"kind":"READ","substeps":["$40:i_item_sk, $41:i_brand_id, $42:i_brand, $43:i_manufact_id, $44:i_manufact, $45:i_manager_id","FROM item","WHERE equal($45, 38)"]},{"kind":"WRITE","substeps":["$40, $41, $42, $43, $44","TO __stage03_output","BY HASH($40)"]}],"writeRatioAvg":0.03079416531604538},{"readMsMax":"10","computeMsMax":"13","waitMsAvg":"12","id":"5","endMs":"1570903570983","waitMsMax":"12","startMs":"1570903570722","waitRatioMax":0.006482982171799027,"readRatioAvg":0.005402485143165856,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.007023230686115613,"writeMsAvg":"61","status":"COMPLETE","writeMsMax":"61","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.032955159373311727,"readMsAvg":"10","waitRatioAvg":0.006482982171799027,"completedParallelInputs":"1","computeRatioMax":0.007023230686115613,"name":"S05: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.005402485143165856,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year, $52:d_moy","FROM date_dim","WHERE and(equal($52, 12), equal($51, 1998))"]},{"kind":"WRITE","substeps":["$50","TO __stage05_output","BY HASH($50)"]}],"writeRatioAvg":0.032955159373311727},{"readMsMax":"30","computeMsMax":"1851","inputStages":["0","1","2","3","5"],"waitMsAvg":"9","id":"6","endMs":"1570903572148","waitMsMax":"9","startMs":"1570903571057","waitRatioMax":0.004862236628849271,"readRatioAvg":0.01620745542949757,"parallelInputs":"1","recordsRead":"3031376","computeRatioAvg":1,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"1851","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0037817396002160996,"readMsAvg":"30","waitRatioAvg":0.004862236628849271,"completedParallelInputs":"1","computeRatioMax":1,"name":"S06: Join+","shuffleOutputBytes":"5181","recordsWritten":"80","readRatioMax":0.01620745542949757,"steps":[{"kind":"READ","substeps":["$30:ss_sold_date_sk, $31:ss_item_sk, $32:ss_customer_sk, $33:ss_store_sk, $34:ss_ext_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$50","FROM __stage05_output"]},{"kind":"READ","substeps":["$40, $41, $42, $43, $44","FROM __stage03_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage01_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $130 := $123, $131 := $122, $132 := $124, $133 := $125","$70 := SUM($121)"]},{"kind":"FILTER","substeps":["not_equal(substr($120, 1, 5), substr($126, 1, 5))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $110 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $106 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $90 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $80 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $30 = $50"]},{"kind":"WRITE","substeps":["$131, $130, $132, $133, $70","TO __stage06_output","BY HASH($130, $131, $132, $133)"]}],"writeRatioAvg":0.0037817396002160996},{"readMsMax":"0","computeMsMax":"6","inputStages":["6"],"waitMsAvg":"3","id":"7","endMs":"1570903572362","waitMsMax":"3","startMs":"1570903572252","waitRatioMax":0.0016207455429497568,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"80","computeRatioAvg":0.0032414910858995136,"writeMsAvg":"59","status":"COMPLETE","writeMsMax":"59","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.031874662344678555,"readMsAvg":"0","waitRatioAvg":0.0016207455429497568,"completedParallelInputs":"1","computeRatioMax":0.0032414910858995136,"name":"S07: Sort+","shuffleOutputBytes":"5181","recordsWritten":"80","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$131, $130, $132, $133, $70","FROM __stage06_output"]},{"kind":"SORT","substeps":["$60 DESC, $140 ASC, $141 ASC, $142 ASC, $143 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $140 := $130, $141 := $131, $142 := $132, $143 := $133","$60 := SUM($70)"]},{"kind":"WRITE","substeps":["$150, $151, $152, $153, $154","TO __stage07_output"]}],"writeRatioAvg":0.031874662344678555},{"readMsMax":"0","computeMsMax":"7","inputStages":["7"],"waitMsAvg":"3","id":"8","endMs":"1570903572372","waitMsMax":"3","startMs":"1570903572308","waitRatioMax":0.0016207455429497568,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"80","computeRatioAvg":0.0037817396002160996,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002701242571582928,"readMsAvg":"0","waitRatioAvg":0.0016207455429497568,"completedParallelInputs":"1","computeRatioMax":0.0037817396002160996,"name":"S08: Output","shuffleOutputBytes":"5181","recordsWritten":"80","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$150, $151, $152, $153, $154","FROM __stage07_output"]},{"kind":"SORT","substeps":["$154 DESC, $151 ASC, $150 ASC, $152 ASC, $153 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$160, $161, $162, $163, $164","TO __stage08_output"]}],"writeRatioAvg":0.002701242571582928}],"estimatedBytesProcessed":"116338344","timeline":[{"totalSlotMs":"1563","activeUnits":"1","completedUnits":"5","elapsedMs":"894","pendingUnits":"1"},{"totalSlotMs":"3877","activeUnits":"1","completedUnits":"8","elapsedMs":"2425","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"116391936","totalPartitionsProcessed":"0","totalBytesProcessed":"116338344","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"}]},"endTime":"1570903572541"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query19_1570903567"},"etag":"XjPg7Cx1vaIEIHvqu1UwRw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query19_1570903567?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon6877cdc222d9c6ba8186f7c93918ee28e3b9ff15","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query19\nSELECT i_brand_id brand_id, \n i_brand brand, \n i_manufact_id, \n i_manufact, \n Sum(ss_ext_sales_price) ext_price \nFROM date_dim, \n store_sales, \n item, \n customer, \n customer_address, \n store \nWHERE d_date_sk = ss_sold_date_sk \n AND ss_item_sk = i_item_sk \n AND i_manager_id = 38 \n AND d_moy = 12 \n AND d_year = 1998 \n AND ss_customer_sk = c_customer_sk \n AND c_current_addr_sk = ca_address_sk \n AND Substr(ca_zip, 1, 5) <> Substr(s_zip, 1, 5) \n AND ss_store_sk = s_store_sk \nGROUP BY i_brand, \n i_brand_id, \n i_manufact_id, \n i_manufact \nORDER BY ext_price DESC, \n i_brand, \n i_brand_id, \n i_manufact_id, \n i_manufact\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query19_1570903567","user_email":"nithish.sankaranarayanan@ulb.be"}
