{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"14435","creationTime":"1570904191951","totalBytesProcessed":"116232282","startTime":"1570904192065","query":{"totalSlotMs":"14435","queryPlan":[{"readMsMax":"24","computeMsMax":"8","waitMsAvg":"2","id":"0","endMs":"1570904192272","waitMsMax":"2","startMs":"1570904192220","waitRatioMax":0.0013097576948264572,"readRatioAvg":0.015717092337917484,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.005239030779305829,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0032743942370661427,"readMsAvg":"24","waitRatioAvg":0.0013097576948264572,"completedParallelInputs":"1","computeRatioMax":0.005239030779305829,"name":"S00: Input","shuffleOutputBytes":"9360","recordsWritten":"1040","readRatioMax":0.015717092337917484,"steps":[{"kind":"READ","substeps":["$10:hd_demo_sk, $11:hd_buy_potential, $12:hd_dep_count, $13:hd_vehicle_count","FROM household_demographics","WHERE and(or(equal($11, '>10000'), equal($11, '0-500')), greater($13, 0), ...)"]},{"kind":"WRITE","substeps":["$10","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.0032743942370661427},{"readMsMax":"30","computeMsMax":"13","waitMsAvg":"1","id":"1","endMs":"1570904192387","waitMsMax":"1","startMs":"1570904192321","waitRatioMax":0.0006548788474132286,"readRatioAvg":0.019646365422396856,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.008513425016371971,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0045841519318926,"readMsAvg":"30","waitRatioAvg":0.0006548788474132286,"completedParallelInputs":"1","computeRatioMax":0.008513425016371971,"name":"S01: Input","shuffleOutputBytes":"108","recordsWritten":"12","readRatioMax":0.019646365422396856,"steps":[{"kind":"READ","substeps":["$30:s_store_sk, $31:s_county","FROM store","WHERE in($31, 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County')"]},{"kind":"WRITE","substeps":["$30","TO __stage01_output","BY HASH($30)"]}],"writeRatioAvg":0.0045841519318926},{"readMsMax":"12","computeMsMax":"11","waitMsAvg":"1","id":"2","endMs":"1570904192414","waitMsMax":"1","startMs":"1570904192340","waitRatioMax":0.0006548788474132286,"readRatioAvg":0.007858546168958742,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.007203667321545514,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0032743942370661427,"readMsAvg":"12","waitRatioAvg":0.0006548788474132286,"completedParallelInputs":"1","computeRatioMax":0.007203667321545514,"name":"S02: Input","shuffleOutputBytes":"648","recordsWritten":"72","readRatioMax":0.007858546168958742,"steps":[{"kind":"READ","substeps":["$40:d_date_sk, $41:d_year, $42:d_dom","FROM date_dim","WHERE and(between($42, 1, 2), in($41, 2000, 2001, 2002))"]},{"kind":"WRITE","substeps":["$40","TO __stage02_output","BY HASH($40)"]}],"writeRatioAvg":0.0032743942370661427},{"readMsMax":"31","computeMsMax":"1527","inputStages":["0","1","2"],"waitMsAvg":"1","id":"4","endMs":"1570904193238","waitMsMax":"1","startMs":"1570904192467","waitRatioMax":0.0006548788474132286,"readRatioAvg":0.020301244269810084,"parallelInputs":"1","recordsRead":"2882302","computeRatioAvg":1,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"1527","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0026195153896529143,"readMsAvg":"31","waitRatioAvg":0.0006548788474132286,"completedParallelInputs":"1","computeRatioMax":1,"name":"S04: Join+","shuffleOutputBytes":"38501","recordsWritten":"1455","readRatioMax":0.020301244269810084,"steps":[{"kind":"READ","substeps":["$20:ss_sold_date_sk, $21:ss_customer_sk, $22:ss_hdemo_sk, $23:ss_store_sk, $24:ss_ticket_number","FROM store_sales"]},{"kind":"READ","substeps":["$40","FROM __stage02_output"]},{"kind":"READ","substeps":["$30","FROM __stage01_output"]},{"kind":"READ","substeps":["$10","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $100 := $91, $101 := $90","$60 := COUNT_STAR()"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $81 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $72 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $40"]},{"kind":"WRITE","substeps":["$101, $100, $60","TO __stage04_output","BY HASH($100, $101)"]}],"writeRatioAvg":0.0026195153896529143},{"readMsMax":"0","computeMsMax":"6","inputStages":["4"],"waitMsAvg":"1","id":"6","endMs":"1570904193444","waitMsMax":"1","startMs":"1570904193393","waitRatioMax":0.0006548788474132286,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1455","computeRatioAvg":0.003929273084479371,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.015717092337917484,"readMsAvg":"0","waitRatioAvg":0.0006548788474132286,"completedParallelInputs":"1","computeRatioMax":0.003929273084479371,"name":"S06: Aggregate+","shuffleOutputBytes":"27","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$101, $100, $60","FROM __stage04_output"]},{"kind":"FILTER","substeps":["between($50, 1, 5)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $110 := $100, $111 := $101","$50 := SUM_OF_COUNTS($60)"]},{"kind":"WRITE","substeps":["$50, $110, $111","TO __stage06_output","BY HASH($111)"]}],"writeRatioAvg":0.015717092337917484},{"readMsMax":"0","computeMsMax":"9","inputStages":["6"],"waitMsAvg":"1","id":"7","endMs":"1570904193685","waitMsMax":"7","startMs":"1570904193452","waitRatioMax":0.0045841519318926,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1","computeRatioAvg":0.0032743942370661427,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"53","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03470857891290111,"readMsAvg":"0","waitRatioAvg":0.0006548788474132286,"completedParallelInputs":"100","computeRatioMax":0.005893909626719057,"name":"S07: Coalesce","shuffleOutputBytes":"27","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage06_output"]}],"writeRatioAvg":0.015062213490504257},{"readMsMax":"11","computeMsMax":"33","inputStages":["7"],"waitMsAvg":"1","id":"8","endMs":"1570904193720","waitMsMax":"1","startMs":"1570904193472","waitRatioMax":0.0006548788474132286,"readRatioAvg":0.007203667321545514,"parallelInputs":"1","recordsRead":"100001","computeRatioAvg":0.021611001964636542,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"3","computeMsAvg":"33","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0019646365422396855,"readMsAvg":"11","waitRatioAvg":0.0006548788474132286,"completedParallelInputs":"1","computeRatioMax":0.021611001964636542,"name":"S08: Join","shuffleOutputBytes":"55","recordsWritten":"1","readRatioMax":0.007203667321545514,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_salutation, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag","FROM customer"]},{"kind":"READ","substeps":["$50, $110, $111","FROM __stage07_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $111"]},{"kind":"WRITE","substeps":["$122, $123, $124, $125, $120, $121","TO __stage08_output"]}],"writeRatioAvg":0.0019646365422396855},{"readMsMax":"0","computeMsMax":"9","inputStages":["8"],"waitMsAvg":"3","id":"9","endMs":"1570904193832","waitMsMax":"3","startMs":"1570904193773","waitRatioMax":0.0019646365422396855,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.005893909626719057,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"16","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010478061558611657,"readMsAvg":"0","waitRatioAvg":0.0019646365422396855,"completedParallelInputs":"1","computeRatioMax":0.005893909626719057,"name":"S09: Output","shuffleOutputBytes":"55","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$122, $123, $124, $125, $120, $121","FROM __stage08_output"]},{"kind":"SORT","substeps":["$121 DESC, $124 ASC"]},{"kind":"WRITE","substeps":["$130, $131, $132, $133, $134, $135","TO __stage09_output"]}],"writeRatioAvg":0.010478061558611657}],"estimatedBytesProcessed":"116232282","timeline":[{"totalSlotMs":"661","activeUnits":"1","completedUnits":"3","elapsedMs":"655","pendingUnits":"1"},{"totalSlotMs":"14435","activeUnits":"0","completedUnits":"107","elapsedMs":"2021","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"116391936","totalPartitionsProcessed":"0","totalBytesProcessed":"116232282","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"}]},"endTime":"1570904194107"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query73_1570904190"},"etag":"6rv80dc2mz6zY9UEha1fWQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query73_1570904190?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon10010eec1888c20ba2cecf6ffd651c0600c2c805","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query73\nSELECT c_last_name, \n c_first_name, \n c_salutation, \n c_preferred_cust_flag, \n ss_ticket_number, \n cnt \nFROM (SELECT ss_ticket_number, \n ss_customer_sk, \n Count(*) cnt \n FROM store_sales, \n date_dim, \n store, \n household_demographics \n WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk \n AND store_sales.ss_store_sk = store.s_store_sk \n AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk \n AND date_dim.d_dom BETWEEN 1 AND 2 \n AND ( household_demographics.hd_buy_potential = '>10000' \n OR household_demographics.hd_buy_potential = '0-500' ) \n AND household_demographics.hd_vehicle_count > 0 \n AND CASE \n WHEN household_demographics.hd_vehicle_count > 0 THEN \n household_demographics.hd_dep_count / \n household_demographics.hd_vehicle_count \n ELSE NULL \n END > 1 \n AND date_dim.d_year IN ( 2000, 2000 + 1, 2000 + 2 ) \n AND store.s_county IN ( 'Williamson County', 'Williamson County', \n 'Williamson County', \n 'Williamson County' \n ) \n GROUP BY ss_ticket_number, \n ss_customer_sk) dj, \n customer \nWHERE ss_customer_sk = c_customer_sk \n AND cnt BETWEEN 1 AND 5 \nORDER BY cnt DESC, \n c_last_name ASC; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query73_1570904190","user_email":"nithish.sankaranarayanan@ulb.be"}
