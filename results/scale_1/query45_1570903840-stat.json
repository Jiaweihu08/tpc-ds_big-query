{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"15312","creationTime":"1570903842894","totalBytesProcessed":"27814629","startTime":"1570903843093","query":{"totalSlotMs":"15312","queryPlan":[{"readMsMax":"12","computeMsMax":"9","waitMsAvg":"1","id":"0","endMs":"1570903843450","waitMsMax":"1","startMs":"1570903843406","waitRatioMax":0.0014814814814814814,"readRatioAvg":0.017777777777777778,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.013333333333333334,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01037037037037037,"readMsAvg":"12","waitRatioAvg":0.0014814814814814814,"completedParallelInputs":"1","computeRatioMax":0.013333333333333334,"name":"S00: Input","shuffleOutputBytes":"300","recordsWritten":"10","readRatioMax":0.017777777777777778,"steps":[{"kind":"READ","substeps":["$21:i_item_id, $20:i_item_sk","FROM item","WHERE in($20, 2, 3, 5, 7, 11, 13, 17, 19, 23, 29)"]},{"kind":"COMPUTE","substeps":["$160 := 1"]},{"kind":"WRITE","substeps":["$21, $160","TO __stage00_output","BY HASH($21)"]}],"writeRatioAvg":0.01037037037037037},{"readMsMax":"6","computeMsMax":"24","waitMsAvg":"27","id":"1","endMs":"1570903843542","waitMsMax":"27","startMs":"1570903843448","waitRatioMax":0.04,"readRatioAvg":0.008888888888888889,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.035555555555555556,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"24","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02962962962962963,"readMsAvg":"6","waitRatioAvg":0.04,"completedParallelInputs":"1","computeRatioMax":0.035555555555555556,"name":"S01: Input","shuffleOutputBytes":"540000","recordsWritten":"18000","readRatioMax":0.008888888888888889,"steps":[{"kind":"READ","substeps":["$10:i_item_sk, $11:i_item_id","FROM item"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.02962962962962963},{"readMsMax":"12","computeMsMax":"7","waitMsAvg":"15","id":"2","endMs":"1570903843508","waitMsMax":"15","startMs":"1570903843451","waitRatioMax":0.022222222222222223,"readRatioAvg":0.017777777777777778,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.01037037037037037,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03111111111111111,"readMsAvg":"12","waitRatioAvg":0.022222222222222223,"completedParallelInputs":"1","computeRatioMax":0.01037037037037037,"name":"S02: Input","shuffleOutputBytes":"819","recordsWritten":"91","readRatioMax":0.017777777777777778,"steps":[{"kind":"READ","substeps":["$40:d_date_sk, $41:d_year, $42:d_qoy","FROM date_dim","WHERE and(equal($42, 1), equal($41, 2000))"]},{"kind":"WRITE","substeps":["$40","TO __stage02_output","BY HASH($40)"]}],"writeRatioAvg":0.03111111111111111},{"readMsMax":"8","computeMsMax":"48","waitMsAvg":"41","id":"3","endMs":"1570903843682","waitMsMax":"41","startMs":"1570903843491","waitRatioMax":0.06074074074074074,"readRatioAvg":0.011851851851851851,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.07111111111111111,"writeMsAvg":"153","status":"COMPLETE","writeMsMax":"153","computeMsAvg":"48","shuffleOutputBytesSpilled":"0","writeRatioMax":0.22666666666666666,"readMsAvg":"8","waitRatioAvg":0.06074074074074074,"completedParallelInputs":"1","computeRatioMax":0.07111111111111111,"name":"S03: Input","shuffleOutputBytes":"1277449","recordsWritten":"50000","readRatioMax":0.011851851851851851,"steps":[{"kind":"READ","substeps":["$30:ca_address_sk, $31:ca_state, $32:ca_zip","FROM customer_address"]},{"kind":"WRITE","substeps":["$30, $31, $32","TO __stage03_output","BY HASH($30)"]}],"writeRatioAvg":0.22666666666666666},{"readMsMax":"14","computeMsMax":"83","waitMsAvg":"21","id":"4","endMs":"1570903843691","waitMsMax":"21","startMs":"1570903843492","waitRatioMax":0.03111111111111111,"readRatioAvg":0.02074074074074074,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.12296296296296297,"writeMsAvg":"122","status":"COMPLETE","writeMsMax":"122","computeMsAvg":"83","shuffleOutputBytesSpilled":"0","writeRatioMax":0.18074074074074073,"readMsAvg":"14","waitRatioAvg":0.03111111111111111,"completedParallelInputs":"1","computeRatioMax":0.12296296296296297,"name":"S04: Input","shuffleOutputBytes":"1800000","recordsWritten":"100000","readRatioMax":0.02074074074074074,"steps":[{"kind":"READ","substeps":["$60:c_customer_sk, $61:c_current_addr_sk","FROM customer"]},{"kind":"WRITE","substeps":["$60, $61","TO __stage04_output","BY HASH($60)"]}],"writeRatioAvg":0.18074074074074073},{"readMsMax":"10","computeMsMax":"10","waitMsAvg":"1","id":"6","endMs":"1570903843677","waitMsMax":"1","startMs":"1570903843493","waitRatioMax":0.0014814814814814814,"readRatioAvg":0.014814814814814815,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.014814814814814815,"writeMsAvg":"165","status":"COMPLETE","writeMsMax":"165","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.24444444444444444,"readMsAvg":"10","waitRatioAvg":0.0014814814814814814,"completedParallelInputs":"1","computeRatioMax":0.014814814814814815,"name":"S06: Input","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.014814814814814815,"steps":[{"kind":"READ","substeps":["$2:i_item_id, $1:i_item_sk","FROM item","WHERE in($1, 2, 3, 5, 7, 11, 13, 17, 19, 23, 29)"]},{"kind":"AGGREGATE","substeps":["$110 := SUM($130)"]},{"kind":"COMPUTE","substeps":["$130 := if(is_null($2), 1, 0)"]},{"kind":"WRITE","substeps":["$110","TO __stage06_output"]}],"writeRatioAvg":0.24444444444444444},{"readMsMax":"0","computeMsMax":"6","inputStages":["6"],"waitMsAvg":"1","id":"7","endMs":"1570903843694","waitMsMax":"1","startMs":"1570903843492","waitRatioMax":0.0014814814814814814,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.008888888888888889,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008888888888888889,"readMsAvg":"0","waitRatioAvg":0.0014814814814814814,"completedParallelInputs":"1","computeRatioMax":0.008888888888888889,"name":"S07: Aggregate","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["$90 := SUM($110)"]},{"kind":"WRITE","substeps":["$90","TO __stage07_output"]}],"writeRatioAvg":0.008888888888888889},{"readMsMax":"0","computeMsMax":"20","inputStages":["0"],"waitMsAvg":"2","id":"8","endMs":"1570903843849","waitMsMax":"7","startMs":"1570903843696","waitRatioMax":0.01037037037037037,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"10","computeRatioAvg":0.007407407407407408,"writeMsAvg":"49","status":"COMPLETE","writeMsMax":"60","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08888888888888889,"readMsAvg":"0","waitRatioAvg":0.002962962962962963,"completedParallelInputs":"100","computeRatioMax":0.02962962962962963,"name":"S08: Coalesce","shuffleOutputBytes":"300","recordsWritten":"10","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage00_output"]}],"writeRatioAvg":0.0725925925925926},{"readMsMax":"19","computeMsMax":"675","inputStages":["8","1","2","3","4"],"waitMsAvg":"1","id":"9","endMs":"1570903844176","waitMsMax":"1","startMs":"1570903843728","waitRatioMax":0.0014814814814814814,"readRatioAvg":0.028148148148148148,"parallelInputs":"1","recordsRead":"888860","computeRatioAvg":1,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"675","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03111111111111111,"readMsAvg":"19","waitRatioAvg":0.0014814814814814814,"completedParallelInputs":"1","computeRatioMax":1,"name":"S09: Join+","shuffleOutputBytes":"1876907","recordsWritten":"22597","readRatioMax":0.028148148148148148,"steps":[{"kind":"READ","substeps":["$50:ws_sold_date_sk, $51:ws_item_sk, $52:ws_bill_customer_sk, $53:ws_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$60, $61","FROM __stage04_output"]},{"kind":"READ","substeps":["$30, $31, $32","FROM __stage03_output"]},{"kind":"READ","substeps":["$40","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage01_output"]},{"kind":"READ","substeps":["$21, $160","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $224","$120 := ANY_VALUE($140)","$121 := ANY_VALUE($220)","$122 := ANY_VALUE($221)","$123 := ANY_VALUE($222)","$124 := ANY_VALUE($223)"]},{"kind":"COMPUTE","substeps":["$140 := not(is_null($225))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $213 = $21"]},{"kind":"COMPUTE","substeps":["$150 := UNIQUE_ROW_ID()"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $202 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $180 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $173 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $52 = $60"]},{"kind":"WRITE","substeps":["$120, $121, $122, $123, $124, $230","TO __stage09_output","BY HASH($230)"]}],"writeRatioAvg":0.03111111111111111},{"readMsMax":"0","computeMsMax":"58","inputStages":["7","9"],"waitMsAvg":"1","id":"10","endMs":"1570903844466","waitMsMax":"1","startMs":"1570903844410","waitRatioMax":0.0014814814814814814,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"22598","computeRatioAvg":0.08592592592592592,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"58","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008888888888888889,"readMsAvg":"0","waitRatioAvg":0.0014814814814814814,"completedParallelInputs":"1","computeRatioMax":0.08592592592592592,"name":"S0A: Aggregate+","shuffleOutputBytes":"546","recordsWritten":"21","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$90","FROM __stage07_output"]},{"kind":"READ","substeps":["$120, $121, $122, $123, $124, $230","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $250 := $103, $251 := $102","$80 := SUM($104)"]},{"kind":"FILTER","substeps":["or(in(substr($103, 1, 5), '85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792'), ...)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230","$100 := ANY_VALUE($120)","$101 := ANY_VALUE($121)","$102 := ANY_VALUE($122)","$103 := ANY_VALUE($123)","$104 := ANY_VALUE($124)"]},{"kind":"WRITE","substeps":["$80, $251, $250","TO __stage0A_output","BY HASH($250, $251)"]}],"writeRatioAvg":0.008888888888888889},{"readMsMax":"0","computeMsMax":"6","inputStages":["10"],"waitMsAvg":"1","id":"11","endMs":"1570903844561","waitMsMax":"1","startMs":"1570903844471","waitRatioMax":0.0014814814814814814,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"21","computeRatioAvg":0.008888888888888889,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"28","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04148148148148148,"readMsAvg":"0","waitRatioAvg":0.0014814814814814814,"completedParallelInputs":"1","computeRatioMax":0.008888888888888889,"name":"S0B: Sort+","shuffleOutputBytes":"546","recordsWritten":"21","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$80, $251, $250","FROM __stage0A_output"]},{"kind":"SORT","substeps":["$260 ASC, $261 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $260 := $250, $261 := $251","$70 := SUM($80)"]},{"kind":"WRITE","substeps":["$270, $271, $272","TO __stage0B_output"]}],"writeRatioAvg":0.04148148148148148},{"readMsMax":"0","computeMsMax":"5","inputStages":["11"],"waitMsAvg":"1","id":"12","endMs":"1570903844578","waitMsMax":"1","startMs":"1570903844490","waitRatioMax":0.0014814814814814814,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"21","computeRatioAvg":0.007407407407407408,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01037037037037037,"readMsAvg":"0","waitRatioAvg":0.0014814814814814814,"completedParallelInputs":"1","computeRatioMax":0.007407407407407408,"name":"S0C: Output","shuffleOutputBytes":"546","recordsWritten":"21","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$270, $271, $272","FROM __stage0B_output"]},{"kind":"SORT","substeps":["$272 ASC, $271 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$280, $281, $282","TO __stage0C_output"]}],"writeRatioAvg":0.01037037037037037}],"estimatedBytesProcessed":"27814629","timeline":[{"totalSlotMs":"14281","activeUnits":"1","completedUnits":"107","elapsedMs":"815","pendingUnits":"1"},{"totalSlotMs":"15312","activeUnits":"1","completedUnits":"111","elapsedMs":"1654","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"52428800","totalPartitionsProcessed":"0","totalBytesProcessed":"27814629","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"}]},"endTime":"1570903844779"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query45_1570903840"},"etag":"623MVqdmrS35r06JmJxLtw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query45_1570903840?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon37b79a8e60a72160239ac2c69da8f44b0dd267c5","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query45\nSELECT ca_zip, \n ca_state, \n Sum(ws_sales_price) \nFROM web_sales, \n customer, \n customer_address, \n date_dim, \n item \nWHERE ws_bill_customer_sk = c_customer_sk \n AND c_current_addr_sk = ca_address_sk \n AND ws_item_sk = i_item_sk \n AND ( Substr(ca_zip, 1, 5) IN ( '85669', '86197', '88274', '83405', \n '86475', '85392', '85460', '80348', \n '81792' ) \n OR i_item_id IN (SELECT i_item_id \n FROM item \n WHERE i_item_sk IN ( 2, 3, 5, 7, \n 11, 13, 17, 19, \n 23, 29 )) ) \n AND ws_sold_date_sk = d_date_sk \n AND d_qoy = 1 \n AND d_year = 2000 \nGROUP BY ca_zip, \n ca_state \nORDER BY ca_zip, \n ca_state\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query45_1570903840","user_email":"nithish.sankaranarayanan@ulb.be"}
