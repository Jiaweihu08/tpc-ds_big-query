{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"6429","creationTime":"1570904119864","totalBytesProcessed":"205152490","startTime":"1570904119996","query":{"totalSlotMs":"6429","queryPlan":[{"readMsMax":"9","computeMsMax":"38","waitMsAvg":"1","id":"0","endMs":"1570904120234","waitMsMax":"1","startMs":"1570904120176","waitRatioMax":0.000259000259000259,"readRatioAvg":0.002331002331002331,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.009842009842009843,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"38","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002331002331002331,"readMsAvg":"9","waitRatioAvg":0.000259000259000259,"completedParallelInputs":"1","computeRatioMax":0.009842009842009843,"name":"S00: Input","shuffleOutputBytes":"1128381","recordsWritten":"50000","readRatioMax":0.002331002331002331,"steps":[{"kind":"READ","substeps":["$20:ca_address_sk, $21:ca_city","FROM customer_address"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage00_output","BY HASH($20)"]}],"writeRatioAvg":0.002331002331002331},{"readMsMax":"39","computeMsMax":"11","waitMsAvg":"9","id":"1","endMs":"1570904127795","waitMsMax":"9","startMs":"1570904127640","waitRatioMax":0.002331002331002331,"readRatioAvg":0.010101010101010102,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.002849002849002849,"writeMsAvg":"53","status":"COMPLETE","writeMsMax":"53","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013727013727013727,"readMsAvg":"39","waitRatioAvg":0.002331002331002331,"completedParallelInputs":"1","computeRatioMax":0.002849002849002849,"name":"S01: Input","shuffleOutputBytes":"16200","recordsWritten":"1800","readRatioMax":0.010101010101010102,"steps":[{"kind":"READ","substeps":["$30:hd_demo_sk, $31:hd_dep_count, $32:hd_vehicle_count","FROM household_demographics","WHERE or(equal($31, 8), equal($32, 3))"]},{"kind":"WRITE","substeps":["$30","TO __stage01_output","BY HASH($30)"]}],"writeRatioAvg":0.013727013727013727},{"readMsMax":"37","computeMsMax":"8","waitMsAvg":"7","id":"2","endMs":"1570904127806","waitMsMax":"7","startMs":"1570904127656","waitRatioMax":0.001813001813001813,"readRatioAvg":0.009583009583009583,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.002072002072002072,"writeMsAvg":"61","status":"COMPLETE","writeMsMax":"61","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.015799015799015798,"readMsAvg":"37","waitRatioAvg":0.001813001813001813,"completedParallelInputs":"1","computeRatioMax":0.002072002072002072,"name":"S02: Input","shuffleOutputBytes":"108","recordsWritten":"12","readRatioMax":0.009583009583009583,"steps":[{"kind":"READ","substeps":["$50:s_store_sk, $51:s_city","FROM store","WHERE in($51, 'Fairview', 'Midway')"]},{"kind":"WRITE","substeps":["$50","TO __stage02_output","BY HASH($50)"]}],"writeRatioAvg":0.015799015799015798},{"readMsMax":"11","computeMsMax":"6","waitMsAvg":"2","id":"3","endMs":"1570904127817","waitMsMax":"2","startMs":"1570904127744","waitRatioMax":0.000518000518000518,"readRatioAvg":0.002849002849002849,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.001554001554001554,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001813001813001813,"readMsAvg":"11","waitRatioAvg":0.000518000518000518,"completedParallelInputs":"1","computeRatioMax":0.001554001554001554,"name":"S03: Input","shuffleOutputBytes":"648","recordsWritten":"72","readRatioMax":0.002849002849002849,"steps":[{"kind":"READ","substeps":["$60:d_date_sk, $61:d_year, $62:d_dom","FROM date_dim","WHERE and(between($62, 1, 2), in($61, 1998, 1999, 2000))"]},{"kind":"WRITE","substeps":["$60","TO __stage03_output","BY HASH($60)"]}],"writeRatioAvg":0.001813001813001813},{"readMsMax":"486","computeMsMax":"3861","inputStages":["0","1","2","3"],"waitMsAvg":"3","id":"5","endMs":"1570904130649","waitMsMax":"3","startMs":"1570904127869","waitRatioMax":0.000777000777000777,"readRatioAvg":0.1258741258741259,"parallelInputs":"1","recordsRead":"2933062","computeRatioAvg":1,"writeMsAvg":"107","status":"COMPLETE","writeMsMax":"107","computeMsAvg":"3861","shuffleOutputBytesSpilled":"0","writeRatioMax":0.027713027713027714,"readMsAvg":"486","waitRatioAvg":0.000777000777000777,"completedParallelInputs":"1","computeRatioMax":1,"name":"S05: Join+","shuffleOutputBytes":"155006","recordsWritten":"2319","readRatioMax":0.1258741258741259,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_hdemo_sk, $43:ss_addr_sk, $44:ss_store_sk, $45:ss_ticket_number, $46:ss_ext_sales_price, $47:ss_ext_list_price, $48:ss_ext_tax","FROM store_sales"]},{"kind":"READ","substeps":["$60","FROM __stage03_output"]},{"kind":"READ","substeps":["$50","FROM __stage02_output"]},{"kind":"READ","substeps":["$30","FROM __stage01_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $150 := $142, $151 := $140, $152 := $141, $153 := $146","$80 := SUM($143)","$81 := SUM($144)","$82 := SUM($145)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $131 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $111 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $93 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $60"]},{"kind":"WRITE","substeps":["$153, $151, $152, $150, $80, $81, $82","TO __stage05_output","BY HASH($150, $151, $152, $153)"]}],"writeRatioAvg":0.027713027713027714},{"readMsMax":"9","computeMsMax":"39","waitMsAvg":"1","id":"6","endMs":"1570904131754","waitMsMax":"1","startMs":"1570904131071","waitRatioMax":0.000259000259000259,"readRatioAvg":0.002331002331002331,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.010101010101010102,"writeMsAvg":"647","status":"COMPLETE","writeMsMax":"647","computeMsAvg":"39","shuffleOutputBytesSpilled":"0","writeRatioMax":0.16757316757316756,"readMsAvg":"9","waitRatioAvg":0.000259000259000259,"completedParallelInputs":"1","computeRatioMax":0.010101010101010102,"name":"S06: Input","shuffleOutputBytes":"1128381","recordsWritten":"50000","readRatioMax":0.002331002331002331,"steps":[{"kind":"READ","substeps":["$1:ca_address_sk, $2:ca_city","FROM customer_address"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage06_output","BY HASH($1)"]}],"writeRatioAvg":0.16757316757316756},{"readMsMax":"12","computeMsMax":"146","waitMsAvg":"12","id":"7","endMs":"1570904131918","waitMsMax":"12","startMs":"1570904131185","waitRatioMax":0.003108003108003108,"readRatioAvg":0.003108003108003108,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.03781403781403781,"writeMsAvg":"497","status":"COMPLETE","writeMsMax":"497","computeMsAvg":"146","shuffleOutputBytesSpilled":"0","writeRatioMax":0.12872312872312872,"readMsAvg":"12","waitRatioAvg":0.003108003108003108,"completedParallelInputs":"1","computeRatioMax":0.03781403781403781,"name":"S07: Input","shuffleOutputBytes":"3927711","recordsWritten":"100000","readRatioMax":0.003108003108003108,"steps":[{"kind":"READ","substeps":["$10:c_customer_sk, $11:c_current_addr_sk, $12:c_first_name, $13:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$10, $11, $12, $13","TO __stage07_output","BY HASH($10)"]}],"writeRatioAvg":0.12872312872312872},{"readMsMax":"0","computeMsMax":"103","inputStages":["5","6","7"],"waitMsAvg":"10","id":"9","endMs":"1570904132053","waitMsMax":"10","startMs":"1570904131970","waitRatioMax":0.00259000259000259,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"152319","computeRatioAvg":0.026677026677026677,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"103","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001036001036001036,"readMsAvg":"0","waitRatioAvg":0.00259000259000259,"completedParallelInputs":"1","computeRatioMax":0.026677026677026677,"name":"S09: Join+","shuffleOutputBytes":"7433","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$153, $151, $152, $150, $80, $81, $82","FROM __stage05_output"]},{"kind":"READ","substeps":["$10, $11, $12, $13","FROM __stage07_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage06_output"]},{"kind":"SORT","substeps":["$181 ASC, $183 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["not_equal($187, $182)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $175 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $161 = $10"]},{"kind":"AGGREGATE","substeps":["GROUP BY $160 := $150, $161 := $151, $162 := $152, $163 := $153","$70 := SUM($80)","$71 := SUM($81)","$72 := SUM($82)"]},{"kind":"WRITE","substeps":["$190, $191, $192, $193, $194, $195, $196, $197","TO __stage09_output"]}],"writeRatioAvg":0.001036001036001036},{"readMsMax":"0","computeMsMax":"6","inputStages":["9"],"waitMsAvg":"22","id":"10","endMs":"1570904132074","waitMsMax":"22","startMs":"1570904132006","waitRatioMax":0.005698005698005698,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.001554001554001554,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001554001554001554,"readMsAvg":"0","waitRatioAvg":0.005698005698005698,"completedParallelInputs":"1","computeRatioMax":0.001554001554001554,"name":"S0A: Output","shuffleOutputBytes":"7433","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$190, $191, $192, $193, $194, $195, $196, $197","FROM __stage09_output"]},{"kind":"SORT","substeps":["$192 ASC, $194 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$200, $201, $202, $203, $204, $205, $206, $207","TO __stage0A_output"]}],"writeRatioAvg":0.001554001554001554}],"estimatedBytesProcessed":"205152490","timeline":[{"totalSlotMs":"67","activeUnits":"0","completedUnits":"1","elapsedMs":"681","pendingUnits":"1"},{"totalSlotMs":"485","activeUnits":"1","completedUnits":"4","elapsedMs":"8145","pendingUnits":"1"},{"totalSlotMs":"5136","activeUnits":"3","completedUnits":"5","elapsedMs":"11691","pendingUnits":"3"},{"totalSlotMs":"6429","activeUnits":"3","completedUnits":"9","elapsedMs":"12235","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"205520896","totalPartitionsProcessed":"0","totalBytesProcessed":"205152490","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"}]},"endTime":"1570904132256"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query68_1570904118"},"etag":"l3AlO36yrBo4aVxZJ1SdJQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query68_1570904118?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon9b354005cfb03de0a723a8a600c1e8d2646e39f7","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query68\nSELECT c_last_name, \n c_first_name, \n ca_city, \n bought_city, \n ss_ticket_number, \n extended_price, \n extended_tax, \n list_price \nFROM (SELECT ss_ticket_number, \n ss_customer_sk, \n ca_city bought_city, \n Sum(ss_ext_sales_price) extended_price, \n Sum(ss_ext_list_price) list_price, \n Sum(ss_ext_tax) extended_tax \n FROM store_sales, \n date_dim, \n store, \n household_demographics, \n customer_address \n WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk \n AND store_sales.ss_store_sk = store.s_store_sk \n AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk \n AND store_sales.ss_addr_sk = customer_address.ca_address_sk \n AND date_dim.d_dom BETWEEN 1 AND 2 \n AND ( household_demographics.hd_dep_count = 8 \n OR household_demographics.hd_vehicle_count = 3 ) \n AND date_dim.d_year IN ( 1998, 1998 + 1, 1998 + 2 ) \n AND store.s_city IN ( 'Fairview', 'Midway' ) \n GROUP BY ss_ticket_number, \n ss_customer_sk, \n ss_addr_sk, \n ca_city) dn, \n customer, \n customer_address current_addr \nWHERE ss_customer_sk = c_customer_sk \n AND customer.c_current_addr_sk = current_addr.ca_address_sk \n AND current_addr.ca_city <> bought_city \nORDER BY c_last_name, \n ss_ticket_number\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query68_1570904118","user_email":"nithish.sankaranarayanan@ulb.be"}
