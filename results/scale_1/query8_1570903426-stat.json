{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"10594","creationTime":"1570903428111","totalBytesProcessed":"69620103","startTime":"1570903428255","query":{"totalSlotMs":"10594","queryPlan":[{"readMsMax":"13","computeMsMax":"40","waitMsAvg":"25","id":"1","endMs":"1570903428551","waitMsMax":"25","startMs":"1570903428453","waitRatioMax":0.03506311360448808,"readRatioAvg":0.0182328190743338,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.056100981767180924,"writeMsAvg":"44","status":"COMPLETE","writeMsMax":"44","computeMsAvg":"40","shuffleOutputBytesSpilled":"0","writeRatioMax":0.061711079943899017,"readMsAvg":"13","waitRatioAvg":0.03506311360448808,"completedParallelInputs":"1","computeRatioMax":0.056100981767180924,"name":"S01: Input","shuffleOutputBytes":"936383","recordsWritten":"50000","readRatioMax":0.0182328190743338,"steps":[{"kind":"READ","substeps":["$30:ca_address_sk, $31:ca_zip","FROM customer_address"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage01_output","BY HASH($30)"]}],"writeRatioAvg":0.061711079943899017},{"readMsMax":"10","computeMsMax":"55","inputStages":["1"],"waitMsAvg":"1","id":"2","endMs":"1570903428638","waitMsMax":"1","startMs":"1570903428583","waitRatioMax":0.001402524544179523,"readRatioAvg":0.014025245441795231,"parallelInputs":"1","recordsRead":"150000","computeRatioAvg":0.07713884992987377,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"55","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008415147265077139,"readMsAvg":"10","waitRatioAvg":0.001402524544179523,"completedParallelInputs":"1","computeRatioMax":0.07713884992987377,"name":"S02: Join+","shuffleOutputBytes":"60487","recordsWritten":"3184","readRatioMax":0.014025245441795231,"steps":[{"kind":"READ","substeps":["$40:c_current_addr_sk, $41:c_preferred_cust_flag","FROM customer","WHERE equal($41, 'Y')"]},{"kind":"READ","substeps":["$30, $31","FROM __stage01_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $150 := $110","$100 := COUNT_STAR()"]},{"kind":"COMPUTE","substeps":["$110 := substr($140, 1, 5)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $30"]},{"kind":"WRITE","substeps":["$100, $150","TO __stage02_output","BY HASH($150)"]}],"writeRatioAvg":0.008415147265077139},{"readMsMax":"0","computeMsMax":"9","inputStages":["2"],"waitMsAvg":"2","id":"3","endMs":"1570903428792","waitMsMax":"2","startMs":"1570903428738","waitRatioMax":0.002805049088359046,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"3184","computeRatioAvg":0.012622720897615708,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"25","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03506311360448808,"readMsAvg":"0","waitRatioAvg":0.002805049088359046,"completedParallelInputs":"1","computeRatioMax":0.012622720897615708,"name":"S03: Aggregate+","shuffleOutputBytes":"6538","recordsWritten":"934","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$100, $150","FROM __stage02_output"]},{"kind":"COMPUTE","substeps":["$80 := substr($160, 1, 2)"]},{"kind":"FILTER","substeps":["greater($90, 10)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $160 := $150","$90 := SUM_OF_COUNTS($100)"]},{"kind":"WRITE","substeps":["$80","TO __stage03_output","BY HASH($80)"]}],"writeRatioAvg":0.03506311360448808},{"readMsMax":"57","computeMsMax":"8","waitMsAvg":"3","id":"4","endMs":"1570903428839","waitMsMax":"3","startMs":"1570903428763","waitRatioMax":0.004207573632538569,"readRatioAvg":0.07994389901823282,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.011220196353436185,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008415147265077139,"readMsAvg":"57","waitRatioAvg":0.004207573632538569,"completedParallelInputs":"1","computeRatioMax":0.011220196353436185,"name":"S04: Input","shuffleOutputBytes":"333","recordsWritten":"12","readRatioMax":0.07994389901823282,"steps":[{"kind":"READ","substeps":["$1:s_store_sk, $2:s_store_name, $3:s_zip","FROM store"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage04_output","BY HASH($1)"]}],"writeRatioAvg":0.008415147265077139},{"readMsMax":"9","computeMsMax":"8","waitMsAvg":"1","id":"5","endMs":"1570903428879","waitMsMax":"1","startMs":"1570903428785","waitRatioMax":0.001402524544179523,"readRatioAvg":0.012622720897615708,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.011220196353436185,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.029453015427769985,"readMsAvg":"9","waitRatioAvg":0.001402524544179523,"completedParallelInputs":"1","computeRatioMax":0.011220196353436185,"name":"S05: Input","shuffleOutputBytes":"819","recordsWritten":"91","readRatioMax":0.012622720897615708,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_year, $22:d_qoy","FROM date_dim","WHERE and(equal($22, 2), equal($21, 2000))"]},{"kind":"WRITE","substeps":["$20","TO __stage05_output","BY HASH($20)"]}],"writeRatioAvg":0.029453015427769985},{"readMsMax":"0","computeMsMax":"9","inputStages":["3"],"waitMsAvg":"2","id":"7","endMs":"1570903429098","waitMsMax":"5","startMs":"1570903428910","waitRatioMax":0.0070126227208976155,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"934","computeRatioAvg":0.0070126227208976155,"writeMsAvg":"78","status":"COMPLETE","writeMsMax":"166","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.23281907433380084,"readMsAvg":"0","waitRatioAvg":0.002805049088359046,"completedParallelInputs":"100","computeRatioMax":0.012622720897615708,"name":"S07: Coalesce","shuffleOutputBytes":"6538","recordsWritten":"934","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage03_output"]}],"writeRatioAvg":0.1093969144460028},{"readMsMax":"23","computeMsMax":"713","inputStages":["7","4","5"],"waitMsAvg":"1","id":"8","endMs":"1570903429597","waitMsMax":"1","startMs":"1570903428969","waitRatioMax":0.001402524544179523,"readRatioAvg":0.03225806451612903,"parallelInputs":"1","recordsRead":"2882215","computeRatioAvg":1,"writeMsAvg":"138","status":"COMPLETE","writeMsMax":"138","computeMsAvg":"713","shuffleOutputBytesSpilled":"0","writeRatioMax":0.1935483870967742,"readMsAvg":"23","waitRatioAvg":0.001402524544179523,"completedParallelInputs":"1","computeRatioMax":1,"name":"S08: Join+","shuffleOutputBytes":"108","recordsWritten":"6","readRatioMax":0.03225806451612903,"steps":[{"kind":"READ","substeps":["$10:ss_sold_date_sk, $11:ss_store_sk, $12:ss_net_profit","FROM store_sales"]},{"kind":"READ","substeps":["$20","FROM __stage05_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage04_output"]},{"kind":"READ","substeps":["$80","FROM __stage07_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $170","$60 := SUM($171)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $70 = $80"]},{"kind":"COMPUTE","substeps":["$70 := substr($132, 1, 2)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $120 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $10 = $20"]},{"kind":"WRITE","substeps":["$180, $60","TO __stage08_output","BY HASH($180)"]}],"writeRatioAvg":0.1935483870967742},{"readMsMax":"0","computeMsMax":"3","inputStages":["8"],"waitMsAvg":"4","id":"9","endMs":"1570903429956","waitMsMax":"4","startMs":"1570903429761","waitRatioMax":0.005610098176718092,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"6","computeRatioAvg":0.004207573632538569,"writeMsAvg":"186","status":"COMPLETE","writeMsMax":"186","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.2608695652173913,"readMsAvg":"0","waitRatioAvg":0.005610098176718092,"completedParallelInputs":"1","computeRatioMax":0.004207573632538569,"name":"S09: Sort+","shuffleOutputBytes":"108","recordsWritten":"6","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$180, $60","FROM __stage08_output"]},{"kind":"SORT","substeps":["$190 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $180","$50 := SUM($60)"]},{"kind":"WRITE","substeps":["$200, $201","TO __stage09_output"]}],"writeRatioAvg":0.2608695652173913},{"readMsMax":"0","computeMsMax":"4","inputStages":["9"],"waitMsAvg":"3","id":"10","endMs":"1570903429977","waitMsMax":"3","startMs":"1570903429844","waitRatioMax":0.004207573632538569,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"6","computeRatioAvg":0.005610098176718092,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009817671809256662,"readMsAvg":"0","waitRatioAvg":0.004207573632538569,"completedParallelInputs":"1","computeRatioMax":0.005610098176718092,"name":"S0A: Output","shuffleOutputBytes":"108","recordsWritten":"6","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$200, $201","FROM __stage09_output"]},{"kind":"SORT","substeps":["$200 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$210, $211","TO __stage0A_output"]}],"writeRatioAvg":0.009817671809256662}],"estimatedBytesProcessed":"69620103","timeline":[{"totalSlotMs":"283","activeUnits":"99","completedUnits":"5","elapsedMs":"658","pendingUnits":"101"},{"totalSlotMs":"10594","activeUnits":"1","completedUnits":"108","elapsedMs":"1868","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"70254592","totalPartitionsProcessed":"0","totalBytesProcessed":"69620103","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"}]},"endTime":"1570903430153"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query8_1570903426"},"etag":"PvgFP7kEe6jePzXDzsMpng==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query8_1570903426?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonfd11f8d0073d23d6f6ee7ba40854b7768d9bd1a6","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query8\nWITH ca_zips AS (\n SELECT Substr(ca_zip, 1, 5) AS ca_zip \n FROM customer_address \n WHERE Substr(ca_zip, 1, 5) IN ( '67436', '26121', '38443', \n '63157', \n '68856', '19485', '86425', \n '26741', \n '70991', '60899', '63573', \n '47556', \n '56193', '93314', '87827', \n '62017', \n '85067', '95390', '48091', \n '10261', \n '81845', '41790', '42853', \n '24675', \n '12840', '60065', '84430', \n '57451', \n '24021', '91735', '75335', \n '71935', \n '34482', '56943', '70695', \n '52147', \n '56251', '28411', '86653', \n '23005', \n '22478', '29031', '34398', \n '15365', \n '42460', '33337', '59433', \n '73943', \n '72477', '74081', '74430', \n '64605', \n '39006', '11226', '49057', \n '97308', \n '42663', '18187', '19768', \n '43454', \n '32147', '76637', '51975', \n '11181', \n '45630', '33129', '45995', \n '64386', \n '55522', '26697', '20963', \n '35154', \n '64587', '49752', '66386', \n '30586', \n '59286', '13177', '66646', \n '84195', \n '74316', '36853', '32927', \n '12469', \n '11904', '36269', '17724', \n '55346', \n '12595', '53988', '65439', \n '28015', \n '63268', '73590', '29216', \n '82575', \n '69267', '13805', '91678', \n '79460', \n '94152', '14961', '15419', \n '48277', \n '62588', '55493', '28360', \n '14152', \n '55225', '18007', '53705', \n '56573', \n '80245', '71769', '57348', \n '36845', \n '13039', '17270', '22363', \n '83474', \n '25294', '43269', '77666', \n '15488', \n '99146', '64441', '43338', \n '38736', \n '62754', '48556', '86057', \n '23090', \n '38114', '66061', '18910', \n '84385', \n '23600', '19975', '27883', \n '65719', \n '19933', '32085', '49731', \n '40473', \n '27190', '46192', '23949', \n '44738', \n '12436', '64794', '68741', \n '15333', \n '24282', '49085', '31844', \n '71156', \n '48441', '17100', '98207', \n '44982', \n '20277', '71496', '96299', \n '37583', \n '22206', '89174', '30589', \n '61924', \n '53079', '10976', '13104', \n '42794', \n '54772', '15809', '56434', \n '39975', \n '13874', '30753', '77598', \n '78229', \n '59478', '12345', '55547', \n '57422', \n '42600', '79444', '29074', \n '29752', \n '21676', '32096', '43044', \n '39383', \n '37296', '36295', '63077', \n '16572', \n '31275', '18701', '40197', \n '48242', \n '27219', '49865', '84175', \n '30446', \n '25165', '13807', '72142', \n '70499', \n '70464', '71429', '18111', \n '70857', \n '29545', '36425', '52706', \n '36194', \n '42963', '75068', '47921', \n '74763', \n '90990', '89456', '62073', \n '88397', \n '73963', '75885', '62657', \n '12530', \n '81146', '57434', '25099', \n '41429', \n '98441', '48713', '52552', \n '31667', \n '14072', '13903', '44709', \n '85429', \n '58017', '38295', '44875', \n '73541', \n '30091', '12707', '23762', \n '62258', \n '33247', '78722', '77431', \n '14510', \n '35656', '72428', '92082', \n '35267', \n '43759', '24354', '90952', \n '11512', \n '21242', '22579', '56114', \n '32339', \n '52282', '41791', '24484', \n '95020', \n '28408', '99710', '11899', \n '43344', \n '72915', '27644', '62708', \n '74479', \n '17177', '32619', '12351', \n '91339', \n '31169', '57081', '53522', \n '16712', \n '34419', '71779', '44187', \n '46206', \n '96099', '61910', '53664', \n '12295', \n '31837', '33096', '10813', \n '63048', \n '31732', '79118', '73084', \n '72783', \n '84952', '46965', '77956', \n '39815', \n '32311', '75329', '48156', \n '30826', \n '49661', '13736', '92076', \n '74865', \n '88149', '92397', '52777', \n '68453', \n '32012', '21222', '52721', \n '24626', \n '18210', '42177', '91791', \n '75251', \n '82075', '44372', '45542', \n '20609', \n '60115', '17362', '22750', \n '90434', \n '31852', '54071', '33762', \n '14705', \n '40718', '56433', '30996', \n '40657', \n '49056', '23585', '66455', \n '41021', \n '74736', '72151', '37007', \n '21729', \n '60177', '84558', '59027', \n '93855', \n '60022', '86443', '19541', \n '86886', \n '30532', '39062', '48532', \n '34713', \n '52077', '22564', '64638', \n '15273', \n '31677', '36138', '62367', \n '60261', \n '80213', '42818', '25113', \n '72378', \n '69802', '69096', '55443', \n '28820', \n '13848', '78258', '37490', \n '30556', \n '77380', '28447', '44550', \n '26791', \n '70609', '82182', '33306', \n '43224', \n '22322', '86959', '68519', \n '14308', \n '46501', '81131', '34056', \n '61991', \n '19896', '87804', '65774', \n '92564' )\n), common_zips AS (\n SELECT ca_zip \n FROM (SELECT Substr(ca_zip, 1, 5) ca_zip, \n Count(*) cnt \n FROM customer_address, \n customer \n WHERE ca_address_sk = c_current_addr_sk \n AND c_preferred_cust_flag = 'Y' \n GROUP BY ca_zip \n HAVING Count(*) > 10)\n),\nchosen_zips AS (\n SELECT ca_zip\n FROM ca_zips \n WHERE ca_zip IN (SELECT ca_zip FROM common_zips)\n)\nSELECT s_store_name, \n Sum(ss_net_profit) \nFROM store_sales, \n date_dim, \n store, \n common_zips\nWHERE ss_store_sk = s_store_sk \n AND ss_sold_date_sk = d_date_sk \n AND d_qoy = 2 \n AND d_year = 2000 \n AND ( Substr(s_zip, 1, 2) = Substr(ca_zip, 1, 2) ) \nGROUP BY s_store_name \nORDER BY s_store_name\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query8_1570903426","user_email":"nithish.sankaranarayanan@ulb.be"}
