{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"86975","creationTime":"1570903978461","totalBytesProcessed":"121271292","startTime":"1570903978606","query":{"totalSlotMs":"86975","queryPlan":[{"readMsMax":"12","computeMsMax":"11","waitMsAvg":"1","id":"0","endMs":"1570903978782","waitMsMax":"1","startMs":"1570903978727","waitRatioMax":0.0004108463434675431,"readRatioAvg":0.0049301561216105174,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0045193097781429745,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009038619556285949,"readMsAvg":"12","waitRatioAvg":0.0004108463434675431,"completedParallelInputs":"1","computeRatioMax":0.0045193097781429745,"name":"S00: Input","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.0049301561216105174,"steps":[{"kind":"READ","substeps":["$121:d_week_seq, $120:d_date","FROM date_dim","WHERE equal($120, '2002-02-25')"]},{"kind":"AGGREGATE","substeps":["$240 := ANY_AND_CHECK($121)"]},{"kind":"WRITE","substeps":["$240","TO __stage00_output"]}],"writeRatioAvg":0.009038619556285949},{"readMsMax":"14","computeMsMax":"10","waitMsAvg":"42","id":"1","endMs":"1570903978839","waitMsMax":"42","startMs":"1570903978768","waitRatioMax":0.01725554642563681,"readRatioAvg":0.005751848808545604,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004108463434675432,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002875924404272802,"readMsAvg":"14","waitRatioAvg":0.01725554642563681,"completedParallelInputs":"1","computeRatioMax":0.004108463434675432,"name":"S01: Input","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.005751848808545604,"steps":[{"kind":"READ","substeps":["$91:d_week_seq, $90:d_date","FROM date_dim","WHERE equal($90, '2002-02-25')"]},{"kind":"AGGREGATE","substeps":["$230 := ANY_AND_CHECK($91)"]},{"kind":"WRITE","substeps":["$230","TO __stage01_output"]}],"writeRatioAvg":0.002875924404272802},{"readMsMax":"17","computeMsMax":"10","waitMsAvg":"48","id":"2","endMs":"1570903978853","waitMsMax":"48","startMs":"1570903978775","waitRatioMax":0.01972062448644207,"readRatioAvg":0.006984387838948234,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004108463434675432,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002054231717337716,"readMsAvg":"17","waitRatioAvg":0.01972062448644207,"completedParallelInputs":"1","computeRatioMax":0.004108463434675432,"name":"S02: Input","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.006984387838948234,"steps":[{"kind":"READ","substeps":["$21:d_week_seq, $20:d_date","FROM date_dim","WHERE equal($20, '2002-02-25')"]},{"kind":"AGGREGATE","substeps":["$220 := ANY_AND_CHECK($21)"]},{"kind":"WRITE","substeps":["$220","TO __stage02_output"]}],"writeRatioAvg":0.002054231717337716},{"readMsMax":"14","computeMsMax":"20","waitMsAvg":"11","id":"3","endMs":"1570903979030","waitMsMax":"11","startMs":"1570903978818","waitRatioMax":0.0045193097781429745,"readRatioAvg":0.005751848808545604,"parallelInputs":"1","recordsRead":"73050","computeRatioAvg":0.008216926869350863,"writeMsAvg":"175","status":"COMPLETE","writeMsMax":"175","computeMsAvg":"20","shuffleOutputBytesSpilled":"0","writeRatioMax":0.07189811010682005,"readMsAvg":"14","waitRatioAvg":0.0045193097781429745,"completedParallelInputs":"1","computeRatioMax":0.008216926869350863,"name":"S03: Input","shuffleOutputBytes":"105","recordsWritten":"7","readRatioMax":0.005751848808545604,"steps":[{"kind":"READ","substeps":["$240","FROM __stage00_output"]},{"kind":"READ","substeps":["$80:d_date, $81:d_week_seq","FROM date_dim"]},{"kind":"FILTER","substeps":["equal($81, $240)"]},{"kind":"WRITE","substeps":["$80","TO __stage03_output","BY HASH($80)"]}],"writeRatioAvg":0.07189811010682005},{"readMsMax":"11","computeMsMax":"64","waitMsAvg":"2","id":"4","endMs":"1570903979293","waitMsMax":"2","startMs":"1570903978907","waitRatioMax":0.0008216926869350862,"readRatioAvg":0.0045193097781429745,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.02629416598192276,"writeMsAvg":"153","status":"COMPLETE","writeMsMax":"153","computeMsAvg":"64","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0628594905505341,"readMsAvg":"11","waitRatioAvg":0.0008216926869350862,"completedParallelInputs":"1","computeRatioMax":0.02629416598192276,"name":"S04: Input","shuffleOutputBytes":"1753176","recordsWritten":"73049","readRatioMax":0.0045193097781429745,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_date","FROM date_dim"]},{"kind":"WRITE","substeps":["$70, $71","TO __stage04_output","BY HASH($70)"]}],"writeRatioAvg":0.0628594905505341},{"readMsMax":"14","computeMsMax":"26","waitMsAvg":"1","id":"5","endMs":"1570903979154","waitMsMax":"1","startMs":"1570903978926","waitRatioMax":0.0004108463434675431,"readRatioAvg":0.005751848808545604,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.010682004930156122,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"25","computeMsAvg":"26","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010271158586688579,"readMsAvg":"14","waitRatioAvg":0.0004108463434675431,"completedParallelInputs":"1","computeRatioMax":0.010682004930156122,"name":"S05: Input","shuffleOutputBytes":"540000","recordsWritten":"18000","readRatioMax":0.005751848808545604,"steps":[{"kind":"READ","substeps":["$140:i_item_sk, $141:i_item_id","FROM item"]},{"kind":"WRITE","substeps":["$140, $141","TO __stage05_output","BY HASH($140)"]}],"writeRatioAvg":0.010271158586688579},{"readMsMax":"14","computeMsMax":"24","waitMsAvg":"1","id":"7","endMs":"1570903979096","waitMsMax":"1","startMs":"1570903978962","waitRatioMax":0.0004108463434675431,"readRatioAvg":0.005751848808545604,"parallelInputs":"1","recordsRead":"73050","computeRatioAvg":0.009860312243221035,"writeMsAvg":"45","status":"COMPLETE","writeMsMax":"45","computeMsAvg":"24","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01848808545603944,"readMsAvg":"14","waitRatioAvg":0.0004108463434675431,"completedParallelInputs":"1","computeRatioMax":0.009860312243221035,"name":"S07: Input","shuffleOutputBytes":"105","recordsWritten":"7","readRatioMax":0.005751848808545604,"steps":[{"kind":"READ","substeps":["$230","FROM __stage01_output"]},{"kind":"READ","substeps":["$60:d_date, $61:d_week_seq","FROM date_dim"]},{"kind":"FILTER","substeps":["equal($61, $230)"]},{"kind":"WRITE","substeps":["$60","TO __stage07_output","BY HASH($60)"]}],"writeRatioAvg":0.01848808545603944},{"readMsMax":"14","computeMsMax":"54","waitMsAvg":"1","id":"8","endMs":"1570903979090","waitMsMax":"1","startMs":"1570903979032","waitRatioMax":0.0004108463434675431,"readRatioAvg":0.005751848808545604,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.02218570254724733,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"54","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004108463434675432,"readMsAvg":"14","waitRatioAvg":0.0004108463434675431,"completedParallelInputs":"1","computeRatioMax":0.02218570254724733,"name":"S08: Input","shuffleOutputBytes":"1753176","recordsWritten":"73049","readRatioMax":0.005751848808545604,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_date","FROM date_dim"]},{"kind":"WRITE","substeps":["$50, $51","TO __stage08_output","BY HASH($50)"]}],"writeRatioAvg":0.004108463434675432},{"readMsMax":"16","computeMsMax":"23","waitMsAvg":"1","id":"9","endMs":"1570903979111","waitMsMax":"1","startMs":"1570903979052","waitRatioMax":0.0004108463434675431,"readRatioAvg":0.00657354149548069,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.009449465899753493,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"23","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009038619556285949,"readMsAvg":"16","waitRatioAvg":0.0004108463434675431,"completedParallelInputs":"1","computeRatioMax":0.009449465899753493,"name":"S09: Input","shuffleOutputBytes":"540000","recordsWritten":"18000","readRatioMax":0.00657354149548069,"steps":[{"kind":"READ","substeps":["$110:i_item_sk, $111:i_item_id","FROM item"]},{"kind":"WRITE","substeps":["$110, $111","TO __stage09_output","BY HASH($110)"]}],"writeRatioAvg":0.009038619556285949},{"readMsMax":"18","computeMsMax":"19","waitMsAvg":"1","id":"11","endMs":"1570903979132","waitMsMax":"1","startMs":"1570903979084","waitRatioMax":0.0004108463434675431,"readRatioAvg":0.007395234182415777,"parallelInputs":"1","recordsRead":"73050","computeRatioAvg":0.0078060805258833195,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002054231717337716,"readMsAvg":"18","waitRatioAvg":0.0004108463434675431,"completedParallelInputs":"1","computeRatioMax":0.0078060805258833195,"name":"S0B: Input","shuffleOutputBytes":"105","recordsWritten":"7","readRatioMax":0.007395234182415777,"steps":[{"kind":"READ","substeps":["$220","FROM __stage02_output"]},{"kind":"READ","substeps":["$10:d_date, $11:d_week_seq","FROM date_dim"]},{"kind":"FILTER","substeps":["equal($11, $220)"]},{"kind":"WRITE","substeps":["$10","TO __stage0B_output","BY HASH($10)"]}],"writeRatioAvg":0.002054231717337716},{"readMsMax":"12","computeMsMax":"50","waitMsAvg":"1","id":"12","endMs":"1570903979154","waitMsMax":"1","startMs":"1570903979100","waitRatioMax":0.0004108463434675431,"readRatioAvg":0.0049301561216105174,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.020542317173377157,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"50","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0045193097781429745,"readMsAvg":"12","waitRatioAvg":0.0004108463434675431,"completedParallelInputs":"1","computeRatioMax":0.020542317173377157,"name":"S0C: Input","shuffleOutputBytes":"1753176","recordsWritten":"73049","readRatioMax":0.0049301561216105174,"steps":[{"kind":"READ","substeps":["$1:d_date_sk, $2:d_date","FROM date_dim"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage0C_output","BY HASH($1)"]}],"writeRatioAvg":0.0045193097781429745},{"readMsMax":"7","computeMsMax":"24","waitMsAvg":"1","id":"13","endMs":"1570903979331","waitMsMax":"1","startMs":"1570903979116","waitRatioMax":0.0004108463434675431,"readRatioAvg":0.002875924404272802,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.009860312243221035,"writeMsAvg":"190","status":"COMPLETE","writeMsMax":"190","computeMsAvg":"24","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0780608052588332,"readMsAvg":"7","waitRatioAvg":0.0004108463434675431,"completedParallelInputs":"1","computeRatioMax":0.009860312243221035,"name":"S0D: Input","shuffleOutputBytes":"540000","recordsWritten":"18000","readRatioMax":0.002875924404272802,"steps":[{"kind":"READ","substeps":["$40:i_item_sk, $41:i_item_id","FROM item"]},{"kind":"WRITE","substeps":["$40, $41","TO __stage0D_output","BY HASH($40)"]}],"writeRatioAvg":0.0780608052588332},{"readMsMax":"0","computeMsMax":"7","inputStages":["7"],"waitMsAvg":"2","id":"15","endMs":"1570903979352","waitMsMax":"5","startMs":"1570903979135","waitRatioMax":0.002054231717337716,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"7","computeRatioAvg":0.0016433853738701725,"writeMsAvg":"167","status":"COMPLETE","writeMsMax":"197","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.080936729663106,"readMsAvg":"0","waitRatioAvg":0.0008216926869350862,"completedParallelInputs":"100","computeRatioMax":0.002875924404272802,"name":"S0F: Coalesce","shuffleOutputBytes":"105","recordsWritten":"7","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage07_output"]}],"writeRatioAvg":0.0686113393590797},{"readMsMax":"32","computeMsMax":"2434","inputStages":["1","15","8","9"],"waitMsAvg":"3","id":"16","endMs":"1570903980565","waitMsMax":"3","startMs":"1570903979229","waitRatioMax":0.0012325390304026294,"readRatioAvg":0.01314708299096138,"parallelInputs":"1","recordsRead":"2972235","computeRatioAvg":1,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"2434","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0016433853738701725,"readMsAvg":"32","waitRatioAvg":0.0012325390304026294,"completedParallelInputs":"1","computeRatioMax":1,"name":"S10: Join+","shuffleOutputBytes":"138394","recordsWritten":"4635","readRatioMax":0.01314708299096138,"steps":[{"kind":"READ","substeps":["$230","FROM __stage01_output"]},{"kind":"READ","substeps":["$100:ss_sold_date_sk, $101:ss_item_sk, $102:ss_ext_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$110, $111","FROM __stage09_output"]},{"kind":"READ","substeps":["$50, $51","FROM __stage08_output"]},{"kind":"READ","substeps":["$60","FROM __stage0F_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $280 := $271","$200 := SUM($270)"]},{"kind":"JOIN","substeps":["SEMI HASH JOIN EACH WITH ALL ON $262 = $60"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $250 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $101 = $110"]},{"kind":"WRITE","substeps":["$280, $200","TO __stage10_output","BY HASH($280)"]}],"writeRatioAvg":0.0016433853738701725},{"readMsMax":"0","computeMsMax":"8","inputStages":["3"],"waitMsAvg":"1","id":"18","endMs":"1570903979541","waitMsMax":"3","startMs":"1570903979309","waitRatioMax":0.0012325390304026294,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"7","computeRatioAvg":0.002054231717337716,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"33","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013557929334428924,"readMsAvg":"0","waitRatioAvg":0.0004108463434675431,"completedParallelInputs":"100","computeRatioMax":0.003286770747740345,"name":"S12: Coalesce","shuffleOutputBytes":"105","recordsWritten":"7","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage03_output"]}],"writeRatioAvg":0.007395234182415777},{"readMsMax":"30","computeMsMax":"1395","inputStages":["0","18","4","5"],"waitMsAvg":"1","id":"19","endMs":"1570903980229","waitMsMax":"1","startMs":"1570903979329","waitRatioMax":0.0004108463434675431,"readRatioAvg":0.012325390304026294,"parallelInputs":"1","recordsRead":"1528499","computeRatioAvg":0.5731306491372227,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"1395","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0045193097781429745,"readMsAvg":"30","waitRatioAvg":0.0004108463434675431,"completedParallelInputs":"1","computeRatioMax":0.5731306491372227,"name":"S13: Join+","shuffleOutputBytes":"81284","recordsWritten":"2710","readRatioMax":0.012325390304026294,"steps":[{"kind":"READ","substeps":["$240","FROM __stage00_output"]},{"kind":"READ","substeps":["$130:cs_sold_date_sk, $131:cs_item_sk, $132:cs_ext_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$140, $141","FROM __stage05_output"]},{"kind":"READ","substeps":["$70, $71","FROM __stage04_output"]},{"kind":"READ","substeps":["$80","FROM __stage12_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $330 := $321","$210 := SUM($320)"]},{"kind":"JOIN","substeps":["SEMI HASH JOIN EACH WITH ALL ON $312 = $80"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $300 = $70"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $131 = $140"]},{"kind":"WRITE","substeps":["$330, $210","TO __stage13_output","BY HASH($330)"]}],"writeRatioAvg":0.0045193097781429745},{"readMsMax":"0","computeMsMax":"41","inputStages":["11"],"waitMsAvg":"1","id":"20","endMs":"1570903979722","waitMsMax":"4","startMs":"1570903979349","waitRatioMax":0.0016433853738701725,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"7","computeRatioAvg":0.0016433853738701725,"writeMsAvg":"134","status":"COMPLETE","writeMsMax":"200","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08216926869350863,"readMsAvg":"0","waitRatioAvg":0.0004108463434675431,"completedParallelInputs":"100","computeRatioMax":0.01684470008216927,"name":"S14: Coalesce","shuffleOutputBytes":"105","recordsWritten":"7","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0B_output"]}],"writeRatioAvg":0.05505341002465078},{"readMsMax":"24","computeMsMax":"544","inputStages":["2","20","12","13"],"waitMsAvg":"3","id":"21","endMs":"1570903980230","waitMsMax":"3","startMs":"1570903979416","waitRatioMax":0.0012325390304026294,"readRatioAvg":0.009860312243221035,"parallelInputs":"1","recordsRead":"811816","computeRatioAvg":0.22350041084634348,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"544","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0024650780608052587,"readMsAvg":"24","waitRatioAvg":0.0012325390304026294,"completedParallelInputs":"1","computeRatioMax":0.22350041084634348,"name":"S15: Join+","shuffleOutputBytes":"46170","recordsWritten":"1539","readRatioMax":0.009860312243221035,"steps":[{"kind":"READ","substeps":["$220","FROM __stage02_output"]},{"kind":"READ","substeps":["$30:ws_sold_date_sk, $31:ws_item_sk, $32:ws_ext_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$40, $41","FROM __stage0D_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage0C_output"]},{"kind":"READ","substeps":["$10","FROM __stage14_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $390 := $381","$190 := SUM($380)"]},{"kind":"JOIN","substeps":["SEMI HASH JOIN EACH WITH ALL ON $372 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $360 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $31 = $40"]},{"kind":"WRITE","substeps":["$390, $190","TO __stage15_output","BY HASH($390)"]}],"writeRatioAvg":0.0024650780608052587},{"readMsMax":"0","computeMsMax":"11","inputStages":["21"],"waitMsAvg":"1","id":"22","endMs":"1570903980837","waitMsMax":"1","startMs":"1570903980649","waitRatioMax":0.0004108463434675431,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1539","computeRatioAvg":0.0045193097781429745,"writeMsAvg":"166","status":"COMPLETE","writeMsMax":"166","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.06820049301561217,"readMsAvg":"0","waitRatioAvg":0.0004108463434675431,"completedParallelInputs":"1","computeRatioMax":0.0045193097781429745,"name":"S16: Aggregate","shuffleOutputBytes":"46170","recordsWritten":"1539","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$390, $190","FROM __stage15_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $400 := $390","$160 := SUM($190)"]},{"kind":"WRITE","substeps":["$160, $400","TO __stage16_output","BY HASH($400)"]}],"writeRatioAvg":0.06820049301561217},{"readMsMax":"0","computeMsMax":"14","inputStages":["16"],"waitMsAvg":"1","id":"24","endMs":"1570903980835","waitMsMax":"1","startMs":"1570903980768","waitRatioMax":0.0004108463434675431,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"4635","computeRatioAvg":0.005751848808545604,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"14","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0045193097781429745,"readMsAvg":"0","waitRatioAvg":0.0004108463434675431,"completedParallelInputs":"1","computeRatioMax":0.005751848808545604,"name":"S18: Aggregate","shuffleOutputBytes":"138394","recordsWritten":"4635","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$280, $200","FROM __stage10_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $290 := $280","$170 := SUM($200)"]},{"kind":"WRITE","substeps":["$170, $290","TO __stage18_output","BY HASH($290)"]}],"writeRatioAvg":0.0045193097781429745},{"readMsMax":"0","computeMsMax":"9","inputStages":["24"],"waitMsAvg":"2","id":"25","endMs":"1570903980952","waitMsMax":"5","startMs":"1570903980842","waitRatioMax":0.002054231717337716,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"4635","computeRatioAvg":0.002054231717337716,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"52","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.021364009860312245,"readMsAvg":"0","waitRatioAvg":0.0008216926869350862,"completedParallelInputs":"100","computeRatioMax":0.0036976170912078883,"name":"S19: Coalesce","shuffleOutputBytes":"138394","recordsWritten":"4635","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage18_output"]}],"writeRatioAvg":0.008216926869350863},{"readMsMax":"0","computeMsMax":"11","inputStages":["22"],"waitMsAvg":"2","id":"27","endMs":"1570903981120","waitMsMax":"6","startMs":"1570903980873","waitRatioMax":0.0024650780608052587,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1539","computeRatioAvg":0.0024650780608052587,"writeMsAvg":"31","status":"COMPLETE","writeMsMax":"58","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0238290879211175,"readMsAvg":"0","waitRatioAvg":0.0008216926869350862,"completedParallelInputs":"100","computeRatioMax":0.0045193097781429745,"name":"S1B: Coalesce","shuffleOutputBytes":"46170","recordsWritten":"1539","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage16_output"]}],"writeRatioAvg":0.012736236647493838},{"readMsMax":"0","computeMsMax":"11","inputStages":["19","27","25"],"waitMsAvg":"5","id":"28","endMs":"1570903981133","waitMsMax":"5","startMs":"1570903980877","waitRatioMax":0.002054231717337716,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"8884","computeRatioAvg":0.0045193097781429745,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0016433853738701725,"readMsAvg":"0","waitRatioAvg":0.002054231717337716,"completedParallelInputs":"1","computeRatioMax":0.0045193097781429745,"name":"S1C: Join+","shuffleOutputBytes":"0","recordsWritten":"0","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$330, $210","FROM __stage13_output"]},{"kind":"READ","substeps":["$170, $290","FROM __stage19_output"]},{"kind":"READ","substeps":["$160, $400","FROM __stage1B_output"]},{"kind":"COMPUTE","substeps":["$150 := multiply(divide(divide($422, add(add($422, $423), $421)), 3), 100)","$151 := multiply(divide(divide($423, add(add($422, $423), $421)), 3), 100)","$152 := multiply(divide(divide($421, add(add($422, $423), $421)), 3), 100)","$153 := divide(add(add($422, $423), $421), 3)"]},{"kind":"SORT","substeps":["$410 ASC, $411 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["and(between($411, multiply(0.9, $413), multiply(1.1, $413)), between($412, multiply(0.9, $413), multiply(1.1, $413)), ...)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $350 = $400"]},{"kind":"FILTER","substeps":["and(between($351, multiply(0.9, $352), multiply(1.1, $352)), between($352, multiply(0.9, $351), multiply(1.1, $351)))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $340 = $290"]},{"kind":"AGGREGATE","substeps":["GROUP BY $340 := $330","$180 := SUM($210)"]},{"kind":"WRITE","substeps":["$420, $150, $151, $152, $153, $421, $422, $423","TO __stage1C_output"]}],"writeRatioAvg":0.0016433853738701725},{"readMsMax":"0","computeMsMax":"4","inputStages":["28"],"waitMsAvg":"1","id":"29","endMs":"1570903981170","waitMsMax":"1","startMs":"1570903980897","waitRatioMax":0.0004108463434675431,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"0","computeRatioAvg":0.0016433853738701725,"writeMsAvg":"13","status":"COMPLETE","writeMsMax":"13","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005341002465078061,"readMsAvg":"0","waitRatioAvg":0.0004108463434675431,"completedParallelInputs":"1","computeRatioMax":0.0016433853738701725,"name":"S1D: Output","shuffleOutputBytes":"0","recordsWritten":"0","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$420, $150, $151, $152, $153, $421, $422, $423","FROM __stage1C_output"]},{"kind":"SORT","substeps":["$420 ASC, $422 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$430, $431, $432, $433, $434, $435, $436, $437","TO __stage1D_output"]}],"writeRatioAvg":0.005341002465078061}],"estimatedBytesProcessed":"121271292","timeline":[{"totalSlotMs":"2212","activeUnits":"103","completedUnits":"10","elapsedMs":"622","pendingUnits":"104"},{"totalSlotMs":"53975","activeUnits":"3","completedUnits":"312","elapsedMs":"1124","pendingUnits":"3"},{"totalSlotMs":"86975","activeUnits":"2","completedUnits":"519","elapsedMs":"2803","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"121634816","totalPartitionsProcessed":"0","totalBytesProcessed":"121271292","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"}]},"endTime":"1570903981444"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query58_1570903976"},"etag":"wi4osuCEWbneLzSUZkBvDQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query58_1570903976?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon1b57fcdcbbd12dedc7ccded6fb1f4fd084420951","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query58\nWITH ss_items \n AS (SELECT i_item_id item_id, \n Sum(ss_ext_sales_price) ss_item_rev \n FROM store_sales, \n item, \n date_dim \n WHERE ss_item_sk = i_item_sk \n AND d_date IN (SELECT d_date \n FROM date_dim \n WHERE d_week_seq = (SELECT d_week_seq \n FROM date_dim \n WHERE d_date = '2002-02-25' \n )) \n AND ss_sold_date_sk = d_date_sk \n GROUP BY i_item_id), \n cs_items \n AS (SELECT i_item_id item_id, \n Sum(cs_ext_sales_price) cs_item_rev \n FROM catalog_sales, \n item, \n date_dim \n WHERE cs_item_sk = i_item_sk \n AND d_date IN (SELECT d_date \n FROM date_dim \n WHERE d_week_seq = (SELECT d_week_seq \n FROM date_dim \n WHERE d_date = '2002-02-25' \n )) \n AND cs_sold_date_sk = d_date_sk \n GROUP BY i_item_id), \n ws_items \n AS (SELECT i_item_id item_id, \n Sum(ws_ext_sales_price) ws_item_rev \n FROM web_sales, \n item, \n date_dim \n WHERE ws_item_sk = i_item_sk \n AND d_date IN (SELECT d_date \n FROM date_dim \n WHERE d_week_seq = (SELECT d_week_seq \n FROM date_dim \n WHERE d_date = '2002-02-25' \n )) \n AND ws_sold_date_sk = d_date_sk \n GROUP BY i_item_id) \nSELECT ss_items.item_id, \n ss_item_rev, \n ss_item_rev / ( ss_item_rev + cs_item_rev + ws_item_rev ) / 3 benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup \n 100 ss_dev, \n cs_item_rev, \n cs_item_rev / ( ss_item_rev + cs_item_rev + ws_item_rev ) / 3 benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup \n 100 cs_dev, \n ws_item_rev, \n ws_item_rev / ( ss_item_rev + cs_item_rev + ws_item_rev ) / 3 benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup \n 100 ws_dev, \n ( ss_item_rev + cs_item_rev + ws_item_rev ) / 3 \n average \nFROM ss_items, \n cs_items, \n ws_items \nWHERE ss_items.item_id = cs_items.item_id \n AND ss_items.item_id = ws_items.item_id \n AND ss_item_rev BETWEEN 0.9 benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup cs_item_rev AND 1.1 benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup cs_item_rev \n AND ss_item_rev BETWEEN 0.9 benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup ws_item_rev AND 1.1 benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup ws_item_rev \n AND cs_item_rev BETWEEN 0.9 benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup ss_item_rev AND 1.1 benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup ss_item_rev \n AND cs_item_rev BETWEEN 0.9 benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup ws_item_rev AND 1.1 benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup ws_item_rev \n AND ws_item_rev BETWEEN 0.9 benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup ss_item_rev AND 1.1 benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup ss_item_rev \n AND ws_item_rev BETWEEN 0.9 benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup cs_item_rev AND 1.1 benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup cs_item_rev \nORDER BY item_id, \n ss_item_rev\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query58_1570903976","user_email":"nithish.sankaranarayanan@ulb.be"}
