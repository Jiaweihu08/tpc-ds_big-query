{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"99632","creationTime":"1570903689740","totalBytesProcessed":"195305604","startTime":"1570903689888","query":{"totalSlotMs":"99632","queryPlan":[{"readMsMax":"51","computeMsMax":"64","waitMsAvg":"1","id":"0","endMs":"1570903690452","waitMsMax":"1","startMs":"1570903690183","waitRatioMax":0.00020798668885191348,"readRatioAvg":0.010607321131447587,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.013311148086522463,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"28","computeMsAvg":"64","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005823627287853577,"readMsAvg":"51","waitRatioAvg":0.00020798668885191348,"completedParallelInputs":"1","computeRatioMax":0.013311148086522463,"name":"S00: Input","shuffleOutputBytes":"2418607","recordsWritten":"18000","readRatioMax":0.010607321131447587,"steps":[{"kind":"READ","substeps":["$1:i_item_sk, $2:i_item_id, $3:i_item_desc","FROM item"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.005823627287853577},{"readMsMax":"23","computeMsMax":"12","waitMsAvg":"21","id":"1","endMs":"1570903690462","waitMsMax":"21","startMs":"1570903690224","waitRatioMax":0.004367720465890183,"readRatioAvg":0.00478369384359401,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.0024958402662229617,"writeMsAvg":"55","status":"COMPLETE","writeMsMax":"55","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011439267886855242,"readMsAvg":"23","waitRatioAvg":0.004367720465890183,"completedParallelInputs":"1","computeRatioMax":0.0024958402662229617,"name":"S01: Input","shuffleOutputBytes":"465","recordsWritten":"12","readRatioMax":0.00478369384359401,"steps":[{"kind":"READ","substeps":["$10:s_store_sk, $11:s_store_id, $12:s_store_name","FROM store"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.011439267886855242},{"readMsMax":"13","computeMsMax":"11","waitMsAvg":"1","id":"2","endMs":"1570903690484","waitMsMax":"1","startMs":"1570903690292","waitRatioMax":0.00020798668885191348,"readRatioAvg":0.0027038269550748754,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0022878535773710484,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0016638935108153079,"readMsAvg":"13","waitRatioAvg":0.00020798668885191348,"completedParallelInputs":"1","computeRatioMax":0.0022878535773710484,"name":"S02: Input","shuffleOutputBytes":"9864","recordsWritten":"1096","readRatioMax":0.0027038269550748754,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_year","FROM date_dim","WHERE in($21, 1998, 1999, 2000)"]},{"kind":"WRITE","substeps":["$20","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.0016638935108153079},{"readMsMax":"11","computeMsMax":"7","waitMsAvg":"26","id":"3","endMs":"1570903690456","waitMsMax":"26","startMs":"1570903690335","waitRatioMax":0.005407653910149751,"readRatioAvg":0.0022878535773710484,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0014559068219633944,"writeMsAvg":"53","status":"COMPLETE","writeMsMax":"53","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011023294509151415,"readMsAvg":"11","waitRatioAvg":0.005407653910149751,"completedParallelInputs":"1","computeRatioMax":0.0014559068219633944,"name":"S03: Input","shuffleOutputBytes":"1098","recordsWritten":"122","readRatioMax":0.0022878535773710484,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_year, $32:d_moy","FROM date_dim","WHERE and(between($32, 4, 7), equal($31, 1998))"]},{"kind":"WRITE","substeps":["$30","TO __stage03_output","BY HASH($30)"]}],"writeRatioAvg":0.011023294509151415},{"readMsMax":"13","computeMsMax":"11","waitMsAvg":"3","id":"4","endMs":"1570903690597","waitMsMax":"3","startMs":"1570903690391","waitRatioMax":0.0006239600665557404,"readRatioAvg":0.0027038269550748754,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0022878535773710484,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0016638935108153079,"readMsAvg":"13","waitRatioAvg":0.0006239600665557404,"completedParallelInputs":"1","computeRatioMax":0.0022878535773710484,"name":"S04: Input","shuffleOutputBytes":"270","recordsWritten":"30","readRatioMax":0.0027038269550748754,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year, $52:d_moy","FROM date_dim","WHERE and(equal($52, 4), equal($51, 1998))"]},{"kind":"WRITE","substeps":["$50","TO __stage04_output","BY HASH($50)"]}],"writeRatioAvg":0.0016638935108153079},{"readMsMax":"45","computeMsMax":"2435","waitMsAvg":"30","id":"5","endMs":"1570903691839","waitMsMax":"30","startMs":"1570903690439","waitRatioMax":0.006239600665557404,"readRatioAvg":0.009359400998336107,"parallelInputs":"1","recordsRead":"1437442","computeRatioAvg":0.5064475873544093,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"2435","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006031613976705491,"readMsAvg":"45","waitRatioAvg":0.006239600665557404,"completedParallelInputs":"1","computeRatioMax":0.5064475873544093,"name":"S05: Input","shuffleOutputBytes":"51431876","recordsWritten":"1430285","readRatioMax":0.009359400998336107,"steps":[{"kind":"READ","substeps":["$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_quantity","FROM catalog_sales"]},{"kind":"WRITE","substeps":["$40, $41, $42, $43","TO __stage05_output","BY HASH($41, $42)"]}],"writeRatioAvg":0.006031613976705491},{"readMsMax":"29","computeMsMax":"525","waitMsAvg":"1","id":"6","endMs":"1570903691260","waitMsMax":"1","startMs":"1570903690509","waitRatioMax":0.00020798668885191348,"readRatioAvg":0.006031613976705491,"parallelInputs":"1","recordsRead":"288116","computeRatioAvg":0.10919301164725458,"writeMsAvg":"278","status":"COMPLETE","writeMsMax":"278","computeMsAvg":"525","shuffleOutputBytesSpilled":"0","writeRatioMax":0.057820299500831944,"readMsAvg":"29","waitRatioAvg":0.00020798668885191348,"completedParallelInputs":"1","computeRatioMax":0.10919301164725458,"name":"S06: Input","shuffleOutputBytes":"12423245","recordsWritten":"277857","readRatioMax":0.006031613976705491,"steps":[{"kind":"READ","substeps":["$70:sr_returned_date_sk, $71:sr_item_sk, $72:sr_customer_sk, $73:sr_ticket_number, $74:sr_return_quantity","FROM store_returns"]},{"kind":"WRITE","substeps":["$70, $71, $72, $73, $74","TO __stage06_output","BY HASH($72, $71, $73)"]}],"writeRatioAvg":0.057820299500831944},{"readMsMax":"0","computeMsMax":"25","inputStages":["5"],"waitMsAvg":"2","id":"9","endMs":"1570903692838","waitMsMax":"4","startMs":"1570903691881","waitRatioMax":0.0008319467554076539,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1430285","computeRatioAvg":0.003535773710482529,"writeMsAvg":"163","status":"COMPLETE","writeMsMax":"207","computeMsAvg":"17","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04305324459234609,"readMsAvg":"0","waitRatioAvg":0.00041597337770382697,"completedParallelInputs":"100","computeRatioMax":0.005199667221297837,"name":"S09: Coalesce","shuffleOutputBytes":"51431876","recordsWritten":"1430285","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage05_output"]}],"writeRatioAvg":0.033901830282861894},{"readMsMax":"46","computeMsMax":"4808","inputStages":["0","1","2","3","4","9","6"],"waitMsAvg":"1","id":"10","endMs":"1570903699943","waitMsMax":"1","startMs":"1570903691994","waitRatioMax":0.00020798668885191348,"readRatioAvg":0.00956738768718802,"parallelInputs":"1","recordsRead":"4608580","computeRatioAvg":1,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"4808","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0012479201331114808,"readMsAvg":"46","waitRatioAvg":0.00020798668885191348,"completedParallelInputs":"1","computeRatioMax":1,"name":"S0A: Join+","shuffleOutputBytes":"216","recordsWritten":"1","readRatioMax":0.00956738768718802,"steps":[{"kind":"READ","substeps":["$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_customer_sk, $63:ss_store_sk, $64:ss_ticket_number, $65:ss_quantity","FROM store_sales"]},{"kind":"READ","substeps":["$70, $71, $72, $73, $74","FROM __stage06_output"]},{"kind":"READ","substeps":["$40, $41, $42, $43","FROM __stage09_output"]},{"kind":"READ","substeps":["$50","FROM __stage04_output"]},{"kind":"READ","substeps":["$30","FROM __stage03_output"]},{"kind":"READ","substeps":["$20","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage01_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $185, $191 := $186, $192 := $180, $193 := $181","$90 := SHARD_AVG($183)","$91 := SHARD_AVG($184)","$92 := SHARD_AVG($182)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $171 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $162 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $150 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $135 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $110 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $106 = $41, $105 = $42"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $62 = $72, $61 = $71, $64 = $73"]},{"kind":"WRITE","substeps":["$190, $191, $192, $193, $90, $91, $92","TO __stage0A_output","BY HASH($190, $191, $192, $193)"]}],"writeRatioAvg":0.0012479201331114808},{"readMsMax":"0","computeMsMax":"7","inputStages":["10"],"waitMsAvg":"2","id":"11","endMs":"1570903700742","waitMsMax":"2","startMs":"1570903700618","waitRatioMax":0.00041597337770382697,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.0014559068219633944,"writeMsAvg":"104","status":"COMPLETE","writeMsMax":"104","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.021630615640599003,"readMsAvg":"0","waitRatioAvg":0.00041597337770382697,"completedParallelInputs":"1","computeRatioMax":0.0014559068219633944,"name":"S0B: Sort+","shuffleOutputBytes":"195","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$190, $191, $192, $193, $90, $91, $92","FROM __stage0A_output"]},{"kind":"SORT","substeps":["$200 ASC, $201 ASC, $202 ASC, $203 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $200 := $190, $201 := $191, $202 := $192, $203 := $193","$80 := ROOT_AVG($90)","$81 := ROOT_AVG($91)","$82 := ROOT_AVG($92)"]},{"kind":"WRITE","substeps":["$210, $211, $212, $213, $214, $215, $216","TO __stage0B_output"]}],"writeRatioAvg":0.021630615640599003},{"readMsMax":"0","computeMsMax":"6","inputStages":["11"],"waitMsAvg":"2","id":"12","endMs":"1570903700778","waitMsMax":"2","startMs":"1570903700714","waitRatioMax":0.00041597337770382697,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.0012479201331114808,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0016638935108153079,"readMsAvg":"0","waitRatioAvg":0.00041597337770382697,"completedParallelInputs":"1","computeRatioMax":0.0012479201331114808,"name":"S0C: Output","shuffleOutputBytes":"195","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$210, $211, $212, $213, $214, $215, $216","FROM __stage0B_output"]},{"kind":"SORT","substeps":["$210 ASC, $211 ASC, $212 ASC, $213 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$220, $221, $222, $223, $224, $225, $226","TO __stage0C_output"]}],"writeRatioAvg":0.0016638935108153079}],"estimatedBytesProcessed":"195305604","timeline":[{"totalSlotMs":"1144","activeUnits":"3","completedUnits":"5","elapsedMs":"796","pendingUnits":"3"},{"totalSlotMs":"31900","activeUnits":"97","completedUnits":"11","elapsedMs":"2453","pendingUnits":"97"},{"totalSlotMs":"91689","activeUnits":"1","completedUnits":"107","elapsedMs":"3210","pendingUnits":"1"},{"totalSlotMs":"99632","activeUnits":"0","completedUnits":"110","elapsedMs":"11026","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"196083712","totalPartitionsProcessed":"0","totalBytesProcessed":"195305604","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"}]},"endTime":"1570903700938"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query29_1570903687"},"etag":"dRN2aChIF+EbugFqKutB3Q==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query29_1570903687?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon393c2902a5bbddc05b57bd51539ddd453b62f05e","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query29\nSELECT i_item_id, \n i_item_desc, \n s_store_id, \n s_store_name, \n Avg(ss_quantity) AS store_sales_quantity, \n Avg(sr_return_quantity) AS store_returns_quantity, \n Avg(cs_quantity) AS catalog_sales_quantity \nFROM store_sales, \n store_returns, \n catalog_sales, \n date_dim d1, \n date_dim d2, \n date_dim d3, \n store, \n item \nWHERE d1.d_moy = 4 \n AND d1.d_year = 1998 \n AND d1.d_date_sk = ss_sold_date_sk \n AND i_item_sk = ss_item_sk \n AND s_store_sk = ss_store_sk \n AND ss_customer_sk = sr_customer_sk \n AND ss_item_sk = sr_item_sk \n AND ss_ticket_number = sr_ticket_number \n AND sr_returned_date_sk = d2.d_date_sk \n AND d2.d_moy BETWEEN 4 AND 4 + 3 \n AND d2.d_year = 1998 \n AND sr_customer_sk = cs_bill_customer_sk \n AND sr_item_sk = cs_item_sk \n AND cs_sold_date_sk = d3.d_date_sk \n AND d3.d_year IN ( 1998, 1998 + 1, 1998 + 2 ) \nGROUP BY i_item_id, \n i_item_desc, \n s_store_id, \n s_store_name \nORDER BY i_item_id, \n i_item_desc, \n s_store_id, \n s_store_name\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query29_1570903687","user_email":"nithish.sankaranarayanan@ulb.be"}
