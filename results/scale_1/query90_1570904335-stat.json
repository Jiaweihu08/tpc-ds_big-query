{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"1514","creationTime":"1570904336823","totalBytesProcessed":"18792416","startTime":"1570904336968","query":{"totalSlotMs":"1514","queryPlan":[{"readMsMax":"49","computeMsMax":"5","waitMsAvg":"3","id":"0","endMs":"1570904337178","waitMsMax":"3","startMs":"1570904337113","waitRatioMax":0.01507537688442211,"readRatioAvg":0.24623115577889448,"parallelInputs":"1","recordsRead":"60","computeRatioAvg":0.02512562814070352,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.020100502512562814,"readMsAvg":"49","waitRatioAvg":0.01507537688442211,"completedParallelInputs":"1","computeRatioMax":0.02512562814070352,"name":"S00: Input","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.24623115577889448,"steps":[{"kind":"READ","substeps":["$10:wp_web_page_sk, $11:wp_char_count","FROM web_page","WHERE between($11, 5000, 5200)"]},{"kind":"WRITE","substeps":["$10","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.020100502512562814},{"readMsMax":"7","computeMsMax":"9","waitMsAvg":"26","id":"1","endMs":"1570904337335","waitMsMax":"26","startMs":"1570904337157","waitRatioMax":0.1306532663316583,"readRatioAvg":0.035175879396984924,"parallelInputs":"1","recordsRead":"86400","computeRatioAvg":0.04522613065326633,"writeMsAvg":"160","status":"COMPLETE","writeMsMax":"160","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.8040201005025126,"readMsAvg":"7","waitRatioAvg":0.1306532663316583,"completedParallelInputs":"1","computeRatioMax":0.04522613065326633,"name":"S01: Input","shuffleOutputBytes":"64800","recordsWritten":"7200","readRatioMax":0.035175879396984924,"steps":[{"kind":"READ","substeps":["$50:t_time_sk, $51:t_hour","FROM time_dim","WHERE between($51, 20, 21)"]},{"kind":"WRITE","substeps":["$50","TO __stage01_output","BY HASH($50)"]}],"writeRatioAvg":0.8040201005025126},{"readMsMax":"8","computeMsMax":"8","waitMsAvg":"33","id":"2","endMs":"1570904337395","waitMsMax":"33","startMs":"1570904337179","waitRatioMax":0.1658291457286432,"readRatioAvg":0.04020100502512563,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.04020100502512563,"writeMsAvg":"199","status":"COMPLETE","writeMsMax":"199","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":1,"readMsAvg":"8","waitRatioAvg":0.1658291457286432,"completedParallelInputs":"1","computeRatioMax":0.04020100502512563,"name":"S02: Input","shuffleOutputBytes":"6480","recordsWritten":"720","readRatioMax":0.04020100502512563,"steps":[{"kind":"READ","substeps":["$70:hd_demo_sk, $71:hd_dep_count","FROM household_demographics","WHERE equal($71, 8)"]},{"kind":"WRITE","substeps":["$70","TO __stage02_output","BY HASH($70)"]}],"writeRatioAvg":1},{"readMsMax":"4","computeMsMax":"9","waitMsAvg":"2","id":"4","endMs":"1570904337331","waitMsMax":"2","startMs":"1570904337259","waitRatioMax":0.010050251256281407,"readRatioAvg":0.020100502512562814,"parallelInputs":"1","recordsRead":"60","computeRatioAvg":0.04522613065326633,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"16","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08040201005025126,"readMsAvg":"4","waitRatioAvg":0.010050251256281407,"completedParallelInputs":"1","computeRatioMax":0.04522613065326633,"name":"S04: Input","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.020100502512562814,"steps":[{"kind":"READ","substeps":["$1:wp_web_page_sk, $2:wp_char_count","FROM web_page","WHERE between($2, 5000, 5200)"]},{"kind":"WRITE","substeps":["$1","TO __stage04_output","BY HASH($1)"]}],"writeRatioAvg":0.08040201005025126},{"readMsMax":"7","computeMsMax":"10","waitMsAvg":"5","id":"5","endMs":"1570904337387","waitMsMax":"5","startMs":"1570904337280","waitRatioMax":0.02512562814070352,"readRatioAvg":0.035175879396984924,"parallelInputs":"1","recordsRead":"86400","computeRatioAvg":0.05025125628140704,"writeMsAvg":"88","status":"COMPLETE","writeMsMax":"88","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.44221105527638194,"readMsAvg":"7","waitRatioAvg":0.02512562814070352,"completedParallelInputs":"1","computeRatioMax":0.05025125628140704,"name":"S05: Input","shuffleOutputBytes":"64800","recordsWritten":"7200","readRatioMax":0.035175879396984924,"steps":[{"kind":"READ","substeps":["$30:t_time_sk, $31:t_hour","FROM time_dim","WHERE between($31, 12, 13)"]},{"kind":"WRITE","substeps":["$30","TO __stage05_output","BY HASH($30)"]}],"writeRatioAvg":0.44221105527638194},{"readMsMax":"9","computeMsMax":"6","waitMsAvg":"1","id":"6","endMs":"1570904337346","waitMsMax":"1","startMs":"1570904337295","waitRatioMax":0.005025125628140704,"readRatioAvg":0.04522613065326633,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.03015075376884422,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.10050251256281408,"readMsAvg":"9","waitRatioAvg":0.005025125628140704,"completedParallelInputs":"1","computeRatioMax":0.03015075376884422,"name":"S06: Input","shuffleOutputBytes":"6480","recordsWritten":"720","readRatioMax":0.04522613065326633,"steps":[{"kind":"READ","substeps":["$60:hd_demo_sk, $61:hd_dep_count","FROM household_demographics","WHERE equal($61, 8)"]},{"kind":"WRITE","substeps":["$60","TO __stage06_output","BY HASH($60)"]}],"writeRatioAvg":0.10050251256281408},{"readMsMax":"26","computeMsMax":"138","inputStages":["4","5","6"],"waitMsAvg":"10","id":"9","endMs":"1570904337549","waitMsMax":"10","startMs":"1570904337421","waitRatioMax":0.05025125628140704,"readRatioAvg":0.1306532663316583,"parallelInputs":"1","recordsRead":"728680","computeRatioAvg":0.6934673366834171,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"3","computeMsAvg":"138","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01507537688442211,"readMsAvg":"26","waitRatioAvg":0.05025125628140704,"completedParallelInputs":"1","computeRatioMax":0.6934673366834171,"name":"S09: Join+","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.1306532663316583,"steps":[{"kind":"READ","substeps":["$20:ws_sold_time_sk, $21:ws_ship_hdemo_sk, $22:ws_web_page_sk","FROM web_sales"]},{"kind":"READ","substeps":["$60","FROM __stage06_output"]},{"kind":"READ","substeps":["$30","FROM __stage05_output"]},{"kind":"READ","substeps":["$1","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["$110 := COUNT_STAR()"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $140 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $130 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $21 = $60"]},{"kind":"WRITE","substeps":["$110","TO __stage09_output"]}],"writeRatioAvg":0.01507537688442211},{"readMsMax":"0","computeMsMax":"3","inputStages":["9"],"waitMsAvg":"19","id":"10","endMs":"1570904337582","waitMsMax":"19","startMs":"1570904337431","waitRatioMax":0.09547738693467336,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.01507537688442211,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02512562814070352,"readMsAvg":"0","waitRatioAvg":0.09547738693467336,"completedParallelInputs":"1","computeRatioMax":0.01507537688442211,"name":"S0A: Aggregate","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["$90 := SUM_OF_COUNTS($110)"]},{"kind":"WRITE","substeps":["$90","TO __stage0A_output"]}],"writeRatioAvg":0.02512562814070352},{"readMsMax":"19","computeMsMax":"176","inputStages":["0","1","2"],"waitMsAvg":"18","id":"11","endMs":"1570904337567","waitMsMax":"18","startMs":"1570904337431","waitRatioMax":0.09045226130653267,"readRatioAvg":0.09547738693467336,"parallelInputs":"1","recordsRead":"728680","computeRatioAvg":0.8844221105527639,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"176","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02512562814070352,"readMsAvg":"19","waitRatioAvg":0.09045226130653267,"completedParallelInputs":"1","computeRatioMax":0.8844221105527639,"name":"S0B: Join+","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.09547738693467336,"steps":[{"kind":"READ","substeps":["$40:ws_sold_time_sk, $41:ws_ship_hdemo_sk, $42:ws_web_page_sk","FROM web_sales"]},{"kind":"READ","substeps":["$70","FROM __stage02_output"]},{"kind":"READ","substeps":["$50","FROM __stage01_output"]},{"kind":"READ","substeps":["$10","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["$120 := COUNT_STAR()"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $170 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $160 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $41 = $70"]},{"kind":"WRITE","substeps":["$120","TO __stage0B_output"]}],"writeRatioAvg":0.02512562814070352},{"readMsMax":"0","computeMsMax":"3","inputStages":["11"],"waitMsAvg":"17","id":"12","endMs":"1570904337640","waitMsMax":"17","startMs":"1570904337431","waitRatioMax":0.08542713567839195,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.01507537688442211,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03015075376884422,"readMsAvg":"0","waitRatioAvg":0.08542713567839195,"completedParallelInputs":"1","computeRatioMax":0.01507537688442211,"name":"S0C: Aggregate","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$120","FROM __stage0B_output"]},{"kind":"AGGREGATE","substeps":["$100 := SUM_OF_COUNTS($120)"]},{"kind":"WRITE","substeps":["$100","TO __stage0C_output"]}],"writeRatioAvg":0.03015075376884422},{"readMsMax":"0","computeMsMax":"5","inputStages":["10","12"],"waitMsAvg":"4","id":"13","endMs":"1570904337761","waitMsMax":"4","startMs":"1570904337711","waitRatioMax":0.020100502512562814,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2","computeRatioAvg":0.02512562814070352,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.10050251256281408,"readMsAvg":"0","waitRatioAvg":0.020100502512562814,"completedParallelInputs":"1","computeRatioMax":0.02512562814070352,"name":"S0D: Output","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$90","FROM __stage0A_output"]},{"kind":"READ","substeps":["$100","FROM __stage0C_output"]},{"kind":"SORT","substeps":["$80 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$80 := divide(CAST($180 AS DOUBLE), CAST($181 AS DOUBLE))"]},{"kind":"JOIN","substeps":["CROSS ALL WITH ALL "]},{"kind":"WRITE","substeps":["$190","TO __stage0D_output"]}],"writeRatioAvg":0.10050251256281408}],"estimatedBytesProcessed":"18792416","timeline":[{"totalSlotMs":"1363","activeUnits":"1","completedUnits":"9","elapsedMs":"647","pendingUnits":"1"},{"totalSlotMs":"1514","activeUnits":"1","completedUnits":"11","elapsedMs":"948","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"41943040","totalPartitionsProcessed":"0","totalBytesProcessed":"18792416","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"time_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_page","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_1"}]},"endTime":"1570904337943"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query90_1570904335"},"etag":"YO6o85HpI9gd78jRpTVOoA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query90_1570904335?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon4b51dadd51afec35a1a6f90865072d4360573979","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"\n-- query90\nSELECT amc / pmc AS am_pm_ratio \nFROM (SELECT Count(*) amc \n FROM web_sales, \n household_demographics, \n time_dim, \n web_page \n WHERE ws_sold_time_sk = time_dim.t_time_sk \n AND ws_ship_hdemo_sk = household_demographics.hd_demo_sk \n AND ws_web_page_sk = web_page.wp_web_page_sk \n AND time_dim.t_hour BETWEEN 12 AND 12 + 1 \n AND household_demographics.hd_dep_count = 8 \n AND web_page.wp_char_count BETWEEN 5000 AND 5200) at1, \n (SELECT Count(*) pmc \n FROM web_sales, \n household_demographics, \n time_dim, \n web_page \n WHERE ws_sold_time_sk = time_dim.t_time_sk \n AND ws_ship_hdemo_sk = household_demographics.hd_demo_sk \n AND ws_web_page_sk = web_page.wp_web_page_sk \n AND time_dim.t_hour BETWEEN 20 AND 20 + 1 \n AND household_demographics.hd_dep_count = 8 \n AND web_page.wp_char_count BETWEEN 5000 AND 5200) pt \nORDER BY am_pm_ratio\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query90_1570904335","user_email":"nithish.sankaranarayanan@ulb.be"}
