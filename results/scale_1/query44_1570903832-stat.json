{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"22219","creationTime":"1570903834615","totalBytesProcessed":"89587223","startTime":"1570903834793","query":{"totalSlotMs":"22219","queryPlan":[{"readMsMax":"67","computeMsMax":"55","waitMsAvg":"4","id":"0","endMs":"1570903835157","waitMsMax":"4","startMs":"1570903834997","waitRatioMax":0.015873015873015872,"readRatioAvg":0.26587301587301587,"parallelInputs":"1","recordsRead":"2881178","computeRatioAvg":0.21825396825396826,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"55","shuffleOutputBytesSpilled":"0","writeRatioMax":0.027777777777777776,"readMsAvg":"67","waitRatioAvg":0.015873015873015872,"completedParallelInputs":"1","computeRatioMax":0.21825396825396826,"name":"S00: Input","shuffleOutputBytes":"26","recordsWritten":"1","readRatioMax":0.26587301587301587,"steps":[{"kind":"READ","substeps":["$51:ss_store_sk, $52:ss_net_profit, $50:ss_cdemo_sk","FROM store_sales","WHERE and(equal($51, 4), is_null($50))"]},{"kind":"AGGREGATE","substeps":["GROUP BY $250 := $51","$170 := SHARD_AVG($52)"]},{"kind":"WRITE","substeps":["$250, $170","TO __stage00_output","BY HASH($250)"]}],"writeRatioAvg":0.027777777777777776},{"readMsMax":"60","computeMsMax":"48","waitMsAvg":"2","id":"1","endMs":"1570903835170","waitMsMax":"2","startMs":"1570903835033","waitRatioMax":0.007936507936507936,"readRatioAvg":0.23809523809523808,"parallelInputs":"1","recordsRead":"2881178","computeRatioAvg":0.19047619047619047,"writeMsAvg":"35","status":"COMPLETE","writeMsMax":"35","computeMsAvg":"48","shuffleOutputBytesSpilled":"0","writeRatioMax":0.1388888888888889,"readMsAvg":"60","waitRatioAvg":0.007936507936507936,"completedParallelInputs":"1","computeRatioMax":0.19047619047619047,"name":"S01: Input","shuffleOutputBytes":"26","recordsWritten":"1","readRatioMax":0.23809523809523808,"steps":[{"kind":"READ","substeps":["$41:ss_store_sk, $42:ss_net_profit, $40:ss_cdemo_sk","FROM store_sales","WHERE and(equal($41, 4), is_null($40))"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $41","$160 := SHARD_AVG($42)"]},{"kind":"WRITE","substeps":["$180, $160","TO __stage01_output","BY HASH($180)"]}],"writeRatioAvg":0.1388888888888889},{"readMsMax":"55","computeMsMax":"237","waitMsAvg":"1","id":"2","endMs":"1570903835321","waitMsMax":"1","startMs":"1570903835124","waitRatioMax":0.003968253968253968,"readRatioAvg":0.21825396825396826,"parallelInputs":"1","recordsRead":"2881178","computeRatioAvg":0.9404761904761905,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"237","shuffleOutputBytesSpilled":"0","writeRatioMax":0.023809523809523808,"readMsAvg":"55","waitRatioAvg":0.003968253968253968,"completedParallelInputs":"1","computeRatioMax":0.9404761904761905,"name":"S02: Input","shuffleOutputBytes":"450000","recordsWritten":"18000","readRatioMax":0.21825396825396826,"steps":[{"kind":"READ","substeps":["$30:ss_item_sk, $32:ss_net_profit, $31:ss_store_sk","FROM store_sales","WHERE equal($31, 4)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $280 := $30","$130 := SHARD_AVG($32)"]},{"kind":"WRITE","substeps":["$280, $130","TO __stage02_output","BY HASH($280)"]}],"writeRatioAvg":0.023809523809523808},{"readMsMax":"44","computeMsMax":"252","waitMsAvg":"3","id":"3","endMs":"1570903835364","waitMsMax":"3","startMs":"1570903835157","waitRatioMax":0.011904761904761904,"readRatioAvg":0.1746031746031746,"parallelInputs":"1","recordsRead":"2881178","computeRatioAvg":1,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"252","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08333333333333333,"readMsAvg":"44","waitRatioAvg":0.011904761904761904,"completedParallelInputs":"1","computeRatioMax":1,"name":"S03: Input","shuffleOutputBytes":"450000","recordsWritten":"18000","readRatioMax":0.1746031746031746,"steps":[{"kind":"READ","substeps":["$20:ss_item_sk, $22:ss_net_profit, $21:ss_store_sk","FROM store_sales","WHERE equal($21, 4)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $210 := $20","$120 := SHARD_AVG($22)"]},{"kind":"WRITE","substeps":["$210, $120","TO __stage03_output","BY HASH($210)"]}],"writeRatioAvg":0.08333333333333333},{"readMsMax":"0","computeMsMax":"6","inputStages":["0"],"waitMsAvg":"30","id":"4","endMs":"1570903835286","waitMsMax":"30","startMs":"1570903835206","waitRatioMax":0.11904761904761904,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.023809523809523808,"writeMsAvg":"57","status":"COMPLETE","writeMsMax":"57","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.2261904761904762,"readMsAvg":"0","waitRatioAvg":0.11904761904761904,"completedParallelInputs":"1","computeRatioMax":0.023809523809523808,"name":"S04: Aggregate+","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$250, $170","FROM __stage00_output"]},{"kind":"LIMIT","substeps":["2"]},{"kind":"AGGREGATE","substeps":["GROUP BY $260 := $250","$150 := ROOT_AVG($170)"]},{"kind":"WRITE","substeps":["$150","TO __stage04_output"]}],"writeRatioAvg":0.2261904761904762},{"readMsMax":"0","computeMsMax":"2","inputStages":["4"],"waitMsAvg":"31","id":"5","endMs":"1570903835333","waitMsMax":"31","startMs":"1570903835206","waitRatioMax":0.12301587301587301,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.007936507936507936,"writeMsAvg":"30","status":"COMPLETE","writeMsMax":"30","computeMsAvg":"2","shuffleOutputBytesSpilled":"0","writeRatioMax":0.11904761904761904,"readMsAvg":"0","waitRatioAvg":0.12301587301587301,"completedParallelInputs":"1","computeRatioMax":0.007936507936507936,"name":"S05: Aggregate","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$150","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["$100 := ANY_AND_CHECK($150)"]},{"kind":"WRITE","substeps":["$100","TO __stage05_output"]}],"writeRatioAvg":0.11904761904761904},{"readMsMax":"0","computeMsMax":"3","inputStages":["1"],"waitMsAvg":"23","id":"6","endMs":"1570903835283","waitMsMax":"23","startMs":"1570903835206","waitRatioMax":0.09126984126984126,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.011904761904761904,"writeMsAvg":"54","status":"COMPLETE","writeMsMax":"54","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.21428571428571427,"readMsAvg":"0","waitRatioAvg":0.09126984126984126,"completedParallelInputs":"1","computeRatioMax":0.011904761904761904,"name":"S06: Aggregate+","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$180, $160","FROM __stage01_output"]},{"kind":"LIMIT","substeps":["2"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $180","$140 := ROOT_AVG($160)"]},{"kind":"WRITE","substeps":["$140","TO __stage06_output"]}],"writeRatioAvg":0.21428571428571427},{"readMsMax":"0","computeMsMax":"3","inputStages":["6"],"waitMsAvg":"22","id":"7","endMs":"1570903835303","waitMsMax":"22","startMs":"1570903835207","waitRatioMax":0.0873015873015873,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.011904761904761904,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"3","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011904761904761904,"readMsAvg":"0","waitRatioAvg":0.0873015873015873,"completedParallelInputs":"1","computeRatioMax":0.011904761904761904,"name":"S07: Aggregate","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$140","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["$80 := ANY_AND_CHECK($140)"]},{"kind":"WRITE","substeps":["$80","TO __stage07_output"]}],"writeRatioAvg":0.011904761904761904},{"readMsMax":"0","computeMsMax":"24","inputStages":["5","2"],"waitMsAvg":"1","id":"8","endMs":"1570903835414","waitMsMax":"1","startMs":"1570903835340","waitRatioMax":0.003968253968253968,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"18001","computeRatioAvg":0.09523809523809523,"writeMsAvg":"43","status":"COMPLETE","writeMsMax":"43","computeMsAvg":"24","shuffleOutputBytesSpilled":"0","writeRatioMax":0.17063492063492064,"readMsAvg":"0","waitRatioAvg":0.003968253968253968,"completedParallelInputs":"1","computeRatioMax":0.09523809523809523,"name":"S08: Aggregate+","shuffleOutputBytes":"125982","recordsWritten":"6999","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$100","FROM __stage05_output"]},{"kind":"READ","substeps":["$280, $130","FROM __stage02_output"]},{"kind":"FILTER","substeps":["greater($110, multiply(0.9, $100))"]},{"kind":"AGGREGATE","substeps":["GROUP BY $290 := $280","$110 := ROOT_AVG($130)"]},{"kind":"WRITE","substeps":["$290, $110","TO __stage08_output"]}],"writeRatioAvg":0.17063492063492064},{"readMsMax":"0","computeMsMax":"27","inputStages":["7","3"],"waitMsAvg":"1","id":"9","endMs":"1570903835457","waitMsMax":"1","startMs":"1570903835373","waitRatioMax":0.003968253968253968,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"18001","computeRatioAvg":0.10714285714285714,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"27","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04365079365079365,"readMsAvg":"0","waitRatioAvg":0.003968253968253968,"completedParallelInputs":"1","computeRatioMax":0.10714285714285714,"name":"S09: Aggregate+","shuffleOutputBytes":"125982","recordsWritten":"6999","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$80","FROM __stage07_output"]},{"kind":"READ","substeps":["$210, $120","FROM __stage03_output"]},{"kind":"FILTER","substeps":["greater($90, multiply(0.9, $80))"]},{"kind":"AGGREGATE","substeps":["GROUP BY $220 := $210","$90 := ROOT_AVG($120)"]},{"kind":"WRITE","substeps":["$220, $90","TO __stage09_output"]}],"writeRatioAvg":0.04365079365079365},{"readMsMax":"10","computeMsMax":"25","waitMsAvg":"1","id":"10","endMs":"1570903835495","waitMsMax":"1","startMs":"1570903835402","waitRatioMax":0.003968253968253968,"readRatioAvg":0.03968253968253968,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.0992063492063492,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"25","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03968253968253968,"readMsAvg":"10","waitRatioAvg":0.003968253968253968,"completedParallelInputs":"1","computeRatioMax":0.0992063492063492,"name":"S0A: Input","shuffleOutputBytes":"575651","recordsWritten":"18000","readRatioMax":0.03968253968253968,"steps":[{"kind":"READ","substeps":["$1:i_item_sk, $2:i_product_name","FROM item"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage0A_output","BY HASH($1)"]}],"writeRatioAvg":0.03968253968253968},{"readMsMax":"9","computeMsMax":"21","waitMsAvg":"1","id":"11","endMs":"1570903835507","waitMsMax":"1","startMs":"1570903835428","waitRatioMax":0.003968253968253968,"readRatioAvg":0.03571428571428571,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.08333333333333333,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"12","computeMsAvg":"21","shuffleOutputBytesSpilled":"0","writeRatioMax":0.047619047619047616,"readMsAvg":"9","waitRatioAvg":0.003968253968253968,"completedParallelInputs":"1","computeRatioMax":0.08333333333333333,"name":"S0B: Input","shuffleOutputBytes":"575651","recordsWritten":"18000","readRatioMax":0.03571428571428571,"steps":[{"kind":"READ","substeps":["$10:i_item_sk, $11:i_product_name","FROM item"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage0B_output","BY HASH($10)"]}],"writeRatioAvg":0.047619047619047616},{"readMsMax":"0","computeMsMax":"19","inputStages":["9"],"waitMsAvg":"1","id":"13","endMs":"1570903835614","waitMsMax":"1","startMs":"1570903835479","waitRatioMax":0.003968253968253968,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"6999","computeRatioAvg":0.07539682539682539,"writeMsAvg":"99","status":"COMPLETE","writeMsMax":"99","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.39285714285714285,"readMsAvg":"0","waitRatioAvg":0.003968253968253968,"completedParallelInputs":"1","computeRatioMax":0.07539682539682539,"name":"S0D: Sort+","shuffleOutputBytes":"180","recordsWritten":"10","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$220, $90","FROM __stage09_output"]},{"kind":"FILTER","substeps":["less($60, 11)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$60 := RANK() OVER (ORDER BY $231 ASC)"]},{"kind":"SORT","substeps":["$90 ASC"]},{"kind":"WRITE","substeps":["$60, $240","TO __stage0D_output","BY HASH($60)"]}],"writeRatioAvg":0.39285714285714285},{"readMsMax":"0","computeMsMax":"8","inputStages":["13"],"waitMsAvg":"1","id":"14","endMs":"1570903835862","waitMsMax":"2","startMs":"1570903835622","waitRatioMax":0.007936507936507936,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"10","computeRatioAvg":0.01984126984126984,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"47","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.1865079365079365,"readMsAvg":"0","waitRatioAvg":0.003968253968253968,"completedParallelInputs":"100","computeRatioMax":0.031746031746031744,"name":"S0E: Coalesce","shuffleOutputBytes":"180","recordsWritten":"10","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0D_output"]}],"writeRatioAvg":0.09126984126984126},{"readMsMax":"0","computeMsMax":"33","inputStages":["8","10","11","14"],"waitMsAvg":"3","id":"15","endMs":"1570903835922","waitMsMax":"3","startMs":"1570903835625","waitRatioMax":0.011904761904761904,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"43009","computeRatioAvg":0.13095238095238096,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"33","shuffleOutputBytesSpilled":"0","writeRatioMax":0.031746031746031744,"readMsAvg":"0","waitRatioAvg":0.011904761904761904,"completedParallelInputs":"1","computeRatioMax":0.13095238095238096,"name":"S0F: Join+","shuffleOutputBytes":"558","recordsWritten":"10","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$290, $110","FROM __stage08_output"]},{"kind":"READ","substeps":["$60, $240","FROM __stage0E_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage0B_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage0A_output"]},{"kind":"SORT","substeps":["$341 ASC","LIMIT 100"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $330 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $320 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $70 = $60"]},{"kind":"FILTER","substeps":["less($70, 11)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$70 := RANK() OVER (ORDER BY $301 DESC)"]},{"kind":"SORT","substeps":["$110 DESC"]},{"kind":"WRITE","substeps":["$350, $351, $352","TO __stage0F_output"]}],"writeRatioAvg":0.031746031746031744},{"readMsMax":"0","computeMsMax":"5","inputStages":["15"],"waitMsAvg":"1","id":"16","endMs":"1570903835953","waitMsMax":"1","startMs":"1570903835649","waitRatioMax":0.003968253968253968,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"10","computeRatioAvg":0.01984126984126984,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01984126984126984,"readMsAvg":"0","waitRatioAvg":0.003968253968253968,"completedParallelInputs":"1","computeRatioMax":0.01984126984126984,"name":"S10: Output","shuffleOutputBytes":"558","recordsWritten":"10","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$350, $351, $352","FROM __stage0F_output"]},{"kind":"SORT","substeps":["$352 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$360, $361, $362","TO __stage10_output"]}],"writeRatioAvg":0.01984126984126984}],"estimatedBytesProcessed":"89587223","timeline":[{"totalSlotMs":"1465","activeUnits":"3","completedUnits":"11","elapsedMs":"707","pendingUnits":"3"},{"totalSlotMs":"22219","activeUnits":"3","completedUnits":"115","elapsedMs":"1354","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"90177536","totalPartitionsProcessed":"0","totalBytesProcessed":"89587223","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"}]},"endTime":"1570903836188"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query44_1570903832"},"etag":"EiXFUA1QsseKrRp/HP7wfw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query44_1570903832?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonddd6d35726f7b749c35e1ebe183eb7f71a662521","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query44\nSELECT asceding.rnk, \n i1.i_product_name best_performing, \n i2.i_product_name worst_performing \nFROM (SELECT benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup \n FROM (SELECT item_sk, \n Rank() \n OVER ( \n ORDER BY rank_col ASC) rnk \n FROM (SELECT ss_item_sk item_sk, \n Avg(ss_net_profit) rank_col \n FROM store_sales ss1 \n WHERE ss_store_sk = 4 \n GROUP BY ss_item_sk \n HAVING Avg(ss_net_profit) > 0.9 benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup \n (SELECT Avg(ss_net_profit) \n rank_col \n FROM store_sales \n WHERE ss_store_sk = 4 \n AND ss_cdemo_sk IS \n NULL \n GROUP BY ss_store_sk))V1) \n V11 \n WHERE rnk < 11) asceding, \n (SELECT benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup \n FROM (SELECT item_sk, \n Rank() \n OVER ( \n ORDER BY rank_col DESC) rnk \n FROM (SELECT ss_item_sk item_sk, \n Avg(ss_net_profit) rank_col \n FROM store_sales ss1 \n WHERE ss_store_sk = 4 \n GROUP BY ss_item_sk \n HAVING Avg(ss_net_profit) > 0.9 benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup \n (SELECT Avg(ss_net_profit) \n rank_col \n FROM store_sales \n WHERE ss_store_sk = 4 \n AND ss_cdemo_sk IS \n NULL \n GROUP BY ss_store_sk))V2) \n V21 \n WHERE rnk < 11) descending, \n item i1, \n item i2 \nWHERE asceding.rnk = descending.rnk \n AND i1.i_item_sk = asceding.item_sk \n AND i2.i_item_sk = descending.item_sk \nORDER BY asceding.rnk\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query44_1570903832","user_email":"nithish.sankaranarayanan@ulb.be"}
