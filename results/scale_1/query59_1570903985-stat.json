{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"18110","creationTime":"1570903987781","totalBytesProcessed":"68462450","startTime":"1570903987974","query":{"totalSlotMs":"18110","queryPlan":[{"readMsMax":"18","computeMsMax":"63","waitMsAvg":"1","id":"0","endMs":"1570903988264","waitMsMax":"1","startMs":"1570903988195","waitRatioMax":0.0002443195699975568,"readRatioAvg":0.004397752259956022,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.015392132909846078,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"63","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002443195699975568,"readMsAvg":"18","waitRatioAvg":0.0002443195699975568,"completedParallelInputs":"1","computeRatioMax":0.015392132909846078,"name":"S00: Input","shuffleOutputBytes":"2201906","recordsWritten":"73049","readRatioMax":0.004397752259956022,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_week_seq, $72:d_day_name","FROM date_dim"]},{"kind":"WRITE","substeps":["$70, $71, $72","TO __stage00_output","BY HASH($70)"]}],"writeRatioAvg":0.002443195699975568},{"readMsMax":"9","computeMsMax":"52","waitMsAvg":"38","id":"2","endMs":"1570903988319","waitMsMax":"38","startMs":"1570903988264","waitRatioMax":0.009284143659907158,"readRatioAvg":0.002198876129978011,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.012704617639872955,"writeMsAvg":"15","status":"COMPLETE","writeMsMax":"15","computeMsAvg":"52","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003664793549963352,"readMsAvg":"9","waitRatioAvg":0.009284143659907158,"completedParallelInputs":"1","computeRatioMax":0.012704617639872955,"name":"S02: Input","shuffleOutputBytes":"2201906","recordsWritten":"73049","readRatioMax":0.002198876129978011,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_week_seq, $52:d_day_name","FROM date_dim"]},{"kind":"WRITE","substeps":["$50, $51, $52","TO __stage02_output","BY HASH($50)"]}],"writeRatioAvg":0.003664793549963352},{"readMsMax":"25","computeMsMax":"4093","inputStages":["0"],"waitMsAvg":"1","id":"4","endMs":"1570903990580","waitMsMax":"1","startMs":"1570903988283","waitRatioMax":0.0002443195699975568,"readRatioAvg":0.00610798924993892,"parallelInputs":"1","recordsRead":"2954227","computeRatioAvg":1,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"4093","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001221597849987784,"readMsAvg":"25","waitRatioAvg":0.0002443195699975568,"completedParallelInputs":"1","computeRatioMax":1,"name":"S04: Join+","shuffleOutputBytes":"145842","recordsWritten":"1834","readRatioMax":0.00610798924993892,"steps":[{"kind":"READ","substeps":["$60:ss_sold_date_sk, $61:ss_store_sk, $62:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$70, $71, $72","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $222, $231 := $220","$140 := SUM($156)","$141 := SUM($155)","$142 := SUM($154)","$143 := SUM($153)","$144 := SUM($152)","$145 := SUM($151)","$146 := SUM($150)"]},{"kind":"COMPUTE","substeps":["$150 := case_no_value(equal($223, 'Saturday'), $221, NULL)","$151 := case_no_value(equal($223, 'Friday'), $221, NULL)","$152 := case_no_value(equal($223, 'Thursday'), $221, NULL)","$153 := case_no_value(equal($223, 'Wednesday'), $221, NULL)","$154 := case_no_value(equal($223, 'Tuesday'), $221, NULL)","$155 := case_no_value(equal($223, 'Monday'), $221, NULL)","$156 := case_no_value(equal($223, 'Sunday'), $221, NULL)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $60 = $70"]},{"kind":"WRITE","substeps":["$231, $230, $140, $141, $142, $143, $144, $145, $146","TO __stage04_output","BY HASH($230, $231)"]}],"writeRatioAvg":0.001221597849987784},{"readMsMax":"24","computeMsMax":"3621","inputStages":["2"],"waitMsAvg":"1","id":"5","endMs":"1570903990266","waitMsMax":"1","startMs":"1570903988424","waitRatioMax":0.0002443195699975568,"readRatioAvg":0.005863669679941363,"parallelInputs":"1","recordsRead":"2954227","computeRatioAvg":0.8846811629611532,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"3621","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0014659174199853407,"readMsAvg":"24","waitRatioAvg":0.0002443195699975568,"completedParallelInputs":"1","computeRatioMax":0.8846811629611532,"name":"S05: Join+","shuffleOutputBytes":"145842","recordsWritten":"1834","readRatioMax":0.005863669679941363,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_store_sk, $42:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$50, $51, $52","FROM __stage02_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $170 := $162, $171 := $160","$120 := SUM($136)","$121 := SUM($135)","$122 := SUM($134)","$123 := SUM($133)","$124 := SUM($132)","$125 := SUM($131)","$126 := SUM($130)"]},{"kind":"COMPUTE","substeps":["$130 := case_no_value(equal($163, 'Saturday'), $161, NULL)","$131 := case_no_value(equal($163, 'Friday'), $161, NULL)","$132 := case_no_value(equal($163, 'Thursday'), $161, NULL)","$133 := case_no_value(equal($163, 'Wednesday'), $161, NULL)","$134 := case_no_value(equal($163, 'Tuesday'), $161, NULL)","$135 := case_no_value(equal($163, 'Monday'), $161, NULL)","$136 := case_no_value(equal($163, 'Sunday'), $161, NULL)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $50"]},{"kind":"WRITE","substeps":["$171, $170, $120, $121, $122, $123, $124, $125, $126","TO __stage05_output","BY HASH($170, $171)"]}],"writeRatioAvg":0.0014659174199853407},{"readMsMax":"7","computeMsMax":"10","waitMsAvg":"1","id":"6","endMs":"1570903991343","waitMsMax":"1","startMs":"1570903991254","waitRatioMax":0.0002443195699975568,"readRatioAvg":0.0017102369899828977,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.002443195699975568,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004642071829953579,"readMsAvg":"7","waitRatioAvg":0.0002443195699975568,"completedParallelInputs":"1","computeRatioMax":0.002443195699975568,"name":"S06: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.0017102369899828977,"steps":[{"kind":"READ","substeps":["$31:d_week_seq, $30:d_month_seq","FROM date_dim","WHERE between($30, 1208, 1219)"]},{"kind":"WRITE","substeps":["$31","TO __stage06_output","BY HASH($31)"]}],"writeRatioAvg":0.004642071829953579},{"readMsMax":"27","computeMsMax":"6","waitMsAvg":"1","id":"7","endMs":"1570903991309","waitMsMax":"1","startMs":"1570903991268","waitRatioMax":0.0002443195699975568,"readRatioAvg":0.006596628389934034,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.0014659174199853407,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001221597849987784,"readMsAvg":"27","waitRatioAvg":0.0002443195699975568,"completedParallelInputs":"1","computeRatioMax":0.0014659174199853407,"name":"S07: Input","shuffleOutputBytes":"360","recordsWritten":"12","readRatioMax":0.006596628389934034,"steps":[{"kind":"READ","substeps":["$20:s_store_sk, $21:s_store_id","FROM store"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage07_output","BY HASH($20)"]}],"writeRatioAvg":0.001221597849987784},{"readMsMax":"9","computeMsMax":"9","waitMsAvg":"1","id":"9","endMs":"1570903991346","waitMsMax":"1","startMs":"1570903991295","waitRatioMax":0.0002443195699975568,"readRatioAvg":0.002198876129978011,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.002198876129978011,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004642071829953579,"readMsAvg":"9","waitRatioAvg":0.0002443195699975568,"completedParallelInputs":"1","computeRatioMax":0.002198876129978011,"name":"S09: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.002198876129978011,"steps":[{"kind":"READ","substeps":["$11:d_week_seq, $10:d_month_seq","FROM date_dim","WHERE between($10, 1196, 1207)"]},{"kind":"WRITE","substeps":["$11","TO __stage09_output","BY HASH($11)"]}],"writeRatioAvg":0.004642071829953579},{"readMsMax":"10","computeMsMax":"6","waitMsAvg":"1","id":"10","endMs":"1570903991356","waitMsMax":"1","startMs":"1570903991314","waitRatioMax":0.0002443195699975568,"readRatioAvg":0.002443195699975568,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.0014659174199853407,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002198876129978011,"readMsAvg":"10","waitRatioAvg":0.0002443195699975568,"completedParallelInputs":"1","computeRatioMax":0.0014659174199853407,"name":"S0A: Input","shuffleOutputBytes":"465","recordsWritten":"12","readRatioMax":0.002443195699975568,"steps":[{"kind":"READ","substeps":["$1:s_store_sk, $2:s_store_id, $3:s_store_name","FROM store"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage0A_output","BY HASH($1)"]}],"writeRatioAvg":0.002198876129978011},{"readMsMax":"0","computeMsMax":"14","inputStages":["5","9","10"],"waitMsAvg":"2","id":"14","endMs":"1570903991571","waitMsMax":"2","startMs":"1570903991387","waitRatioMax":0.0004886391399951136,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2212","computeRatioAvg":0.0034204739799657954,"writeMsAvg":"157","status":"COMPLETE","writeMsMax":"157","computeMsAvg":"14","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03835817248961642,"readMsAvg":"0","waitRatioAvg":0.0004886391399951136,"completedParallelInputs":"1","computeRatioMax":0.0034204739799657954,"name":"S0E: Join+","shuffleOutputBytes":"223992","recordsWritten":"2196","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$171, $170, $120, $121, $122, $123, $124, $125, $126","FROM __stage05_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage0A_output"]},{"kind":"READ","substeps":["$11","FROM __stage09_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $190 = $11"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $181 = $1"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $170, $181 := $171","$100 := SUM($120)","$101 := SUM($121)","$102 := SUM($122)","$103 := SUM($123)","$104 := SUM($124)","$105 := SUM($125)","$106 := SUM($126)"]},{"kind":"WRITE","substeps":["$210, $211, $212, $213, $214, $215, $216, $217, $218, $219","TO __stage0E_output","BY HASH($210, $212)"]}],"writeRatioAvg":0.03835817248961642},{"readMsMax":"0","computeMsMax":"9","inputStages":["14"],"waitMsAvg":"3","id":"15","endMs":"1570903991690","waitMsMax":"7","startMs":"1570903991590","waitRatioMax":0.0017102369899828977,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2196","computeRatioAvg":0.001221597849987784,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006596628389934034,"readMsAvg":"0","waitRatioAvg":0.0007329587099926704,"completedParallelInputs":"100","computeRatioMax":0.002198876129978011,"name":"S0F: Coalesce","shuffleOutputBytes":"223992","recordsWritten":"2196","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0E_output"]}],"writeRatioAvg":0.004153432689958466},{"readMsMax":"0","computeMsMax":"20","inputStages":["4","6","7","15"],"waitMsAvg":"10","id":"16","endMs":"1570903991750","waitMsMax":"10","startMs":"1570903991600","waitRatioMax":0.002443195699975568,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"4407","computeRatioAvg":0.004886391399951136,"writeMsAvg":"14","status":"COMPLETE","writeMsMax":"14","computeMsAvg":"20","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0034204739799657954,"readMsAvg":"0","waitRatioAvg":0.002443195699975568,"completedParallelInputs":"1","computeRatioMax":0.004886391399951136,"name":"S10: Join+","shuffleOutputBytes":"10200","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$231, $230, $140, $141, $142, $143, $144, $145, $146","FROM __stage04_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage07_output"]},{"kind":"READ","substeps":["$31","FROM __stage06_output"]},{"kind":"READ","substeps":["$210, $211, $212, $213, $214, $215, $216, $217, $218, $219","FROM __stage0F_output"]},{"kind":"COMPUTE","substeps":["$80 := divide($303, $310)","$81 := divide($304, $311)","$82 := divide($305, $312)","$83 := divide($306, $313)","$84 := divide($307, $314)","$85 := divide($308, $315)","$86 := divide($309, $316)"]},{"kind":"SORT","substeps":["$281 ASC, $280 ASC, $282 ASC","LIMIT 100"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $270 = $210, $90 = $212"]},{"kind":"COMPUTE","substeps":["$90 := subtract($271, 52)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $250 = $31"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $241 = $20"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230, $241 := $231","$110 := SUM($140)","$111 := SUM($141)","$112 := SUM($142)","$113 := SUM($143)","$114 := SUM($144)","$115 := SUM($145)","$116 := SUM($146)"]},{"kind":"WRITE","substeps":["$300, $301, $302, $80, $81, $82, $83, $84, $85, $86","TO __stage10_output"]}],"writeRatioAvg":0.0034204739799657954},{"readMsMax":"0","computeMsMax":"6","inputStages":["16"],"waitMsAvg":"1","id":"17","endMs":"1570903991773","waitMsMax":"1","startMs":"1570903991606","waitRatioMax":0.0002443195699975568,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0014659174199853407,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001221597849987784,"readMsAvg":"0","waitRatioAvg":0.0002443195699975568,"completedParallelInputs":"1","computeRatioMax":0.0014659174199853407,"name":"S11: Output","shuffleOutputBytes":"10200","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$300, $301, $302, $80, $81, $82, $83, $84, $85, $86","FROM __stage10_output"]},{"kind":"SORT","substeps":["$301 ASC, $300 ASC, $302 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$320, $321, $322, $323, $324, $325, $326, $327, $328, $329","TO __stage11_output"]}],"writeRatioAvg":0.001221597849987784}],"estimatedBytesProcessed":"68462450","timeline":[{"totalSlotMs":"1423","activeUnits":"2","completedUnits":"2","elapsedMs":"723","pendingUnits":"2"},{"totalSlotMs":"17974","activeUnits":"1","completedUnits":"110","elapsedMs":"3781","pendingUnits":"1"},{"totalSlotMs":"18110","activeUnits":"1","completedUnits":"111","elapsedMs":"11333","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"69206016","totalPartitionsProcessed":"0","totalBytesProcessed":"68462450","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"}]},"endTime":"1570903999343"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query59_1570903985"},"etag":"3RQGGDomCNB5jLakCvE/OQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query59_1570903985?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonc7fdb17d914beb5a83d2ba147ff0ea3a20728008","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query59\nWITH wss \n AS (SELECT d_week_seq, \n ss_store_sk, \n Sum(CASE \n WHEN ( d_day_name = 'Sunday' ) THEN ss_sales_price \n ELSE NULL \n END) sun_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Monday' ) THEN ss_sales_price \n ELSE NULL \n END) mon_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Tuesday' ) THEN ss_sales_price \n ELSE NULL \n END) tue_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Wednesday' ) THEN ss_sales_price \n ELSE NULL \n END) wed_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Thursday' ) THEN ss_sales_price \n ELSE NULL \n END) thu_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Friday' ) THEN ss_sales_price \n ELSE NULL \n END) fri_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Saturday' ) THEN ss_sales_price \n ELSE NULL \n END) sat_sales \n FROM store_sales, \n date_dim \n WHERE d_date_sk = ss_sold_date_sk \n GROUP BY d_week_seq, \n ss_store_sk) \nSELECT s_store_name1, \n s_store_id1, \n d_week_seq1, \n sun_sales1 / sun_sales2, \n mon_sales1 / mon_sales2, \n tue_sales1 / tue_sales2, \n wed_sales1 / wed_sales2, \n thu_sales1 / thu_sales2, \n fri_sales1 / fri_sales2, \n sat_sales1 / sat_sales2 \nFROM (SELECT s_store_name s_store_name1, \n wss.d_week_seq d_week_seq1, \n s_store_id s_store_id1, \n sun_sales sun_sales1, \n mon_sales mon_sales1, \n tue_sales tue_sales1, \n wed_sales wed_sales1, \n thu_sales thu_sales1, \n fri_sales fri_sales1, \n sat_sales sat_sales1 \n FROM wss, \n store, \n date_dim d \n WHERE d.d_week_seq = wss.d_week_seq \n AND ss_store_sk = s_store_sk \n AND d_month_seq BETWEEN 1196 AND 1196 + 11) y, \n (SELECT s_store_name s_store_name2, \n wss.d_week_seq d_week_seq2, \n s_store_id s_store_id2, \n sun_sales sun_sales2, \n mon_sales mon_sales2, \n tue_sales tue_sales2, \n wed_sales wed_sales2, \n thu_sales thu_sales2, \n fri_sales fri_sales2, \n sat_sales sat_sales2 \n FROM wss, \n store, \n date_dim d \n WHERE d.d_week_seq = wss.d_week_seq \n AND ss_store_sk = s_store_sk \n AND d_month_seq BETWEEN 1196 + 12 AND 1196 + 23) x \nWHERE s_store_id1 = s_store_id2 \n AND d_week_seq1 = d_week_seq2 - 52 \nORDER BY s_store_name1, \n s_store_id1, \n d_week_seq1\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query59_1570903985","user_email":"nithish.sankaranarayanan@ulb.be"}
