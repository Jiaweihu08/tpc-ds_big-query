{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"2326","creationTime":"1570903827575","totalBytesProcessed":"67878154","startTime":"1570903827754","query":{"totalSlotMs":"2326","queryPlan":[{"readMsMax":"17","computeMsMax":"11","waitMsAvg":"6","id":"0","endMs":"1570903828045","waitMsMax":"6","startMs":"1570903827953","waitRatioMax":0.004477611940298508,"readRatioAvg":0.012686567164179104,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.008208955223880597,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006716417910447761,"readMsAvg":"17","waitRatioAvg":0.004477611940298508,"completedParallelInputs":"1","computeRatioMax":0.008208955223880597,"name":"S00: Input","shuffleOutputBytes":"465","recordsWritten":"12","readRatioMax":0.012686567164179104,"steps":[{"kind":"READ","substeps":["$10:s_store_sk, $11:s_store_id, $12:s_store_name, $13:s_gmt_offset","FROM store","WHERE equal($13, -5)"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.006716417910447761},{"readMsMax":"12","computeMsMax":"6","waitMsAvg":"44","id":"2","endMs":"1570903828116","waitMsMax":"44","startMs":"1570903828036","waitRatioMax":0.03283582089552239,"readRatioAvg":0.008955223880597015,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004477611940298508,"writeMsAvg":"47","status":"COMPLETE","writeMsMax":"47","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03507462686567164,"readMsAvg":"12","waitRatioAvg":0.03283582089552239,"completedParallelInputs":"1","computeRatioMax":0.004477611940298508,"name":"S02: Input","shuffleOutputBytes":"7717","recordsWritten":"365","readRatioMax":0.008955223880597015,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $22:d_day_name, $21:d_year","FROM date_dim","WHERE equal($21, 2002)"]},{"kind":"WRITE","substeps":["$20, $22","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.03507462686567164},{"readMsMax":"27","computeMsMax":"1340","inputStages":["0","2"],"waitMsAvg":"1","id":"3","endMs":"1570903828874","waitMsMax":"1","startMs":"1570903828138","waitRatioMax":0.0007462686567164179,"readRatioAvg":0.020149253731343283,"parallelInputs":"1","recordsRead":"2881555","computeRatioAvg":1,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"1340","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004477611940298508,"readMsAvg":"27","waitRatioAvg":0.0007462686567164179,"completedParallelInputs":"1","computeRatioMax":1,"name":"S03: Join+","shuffleOutputBytes":"558","recordsWritten":"6","readRatioMax":0.020149253731343283,"steps":[{"kind":"READ","substeps":["$1:ss_sold_date_sk, $2:ss_store_sk, $3:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$20, $22","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $90 := $83, $91 := $82","$40 := SUM($56)","$41 := SUM($55)","$42 := SUM($54)","$43 := SUM($53)","$44 := SUM($52)","$45 := SUM($51)","$46 := SUM($50)"]},{"kind":"COMPUTE","substeps":["$50 := case_no_value(equal($81, 'Saturday'), $80, NULL)","$51 := case_no_value(equal($81, 'Friday'), $80, NULL)","$52 := case_no_value(equal($81, 'Thursday'), $80, NULL)","$53 := case_no_value(equal($81, 'Wednesday'), $80, NULL)","$54 := case_no_value(equal($81, 'Tuesday'), $80, NULL)","$55 := case_no_value(equal($81, 'Monday'), $80, NULL)","$56 := case_no_value(equal($81, 'Sunday'), $80, NULL)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $71 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $20"]},{"kind":"WRITE","substeps":["$91, $90, $40, $41, $42, $43, $44, $45, $46","TO __stage03_output","BY HASH($90, $91)"]}],"writeRatioAvg":0.004477611940298508},{"readMsMax":"0","computeMsMax":"6","inputStages":["3"],"waitMsAvg":"1","id":"4","endMs":"1570903829076","waitMsMax":"1","startMs":"1570903829003","waitRatioMax":0.0007462686567164179,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"6","computeRatioAvg":0.004477611940298508,"writeMsAvg":"15","status":"COMPLETE","writeMsMax":"15","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011194029850746268,"readMsAvg":"0","waitRatioAvg":0.0007462686567164179,"completedParallelInputs":"1","computeRatioMax":0.004477611940298508,"name":"S04: Sort+","shuffleOutputBytes":"558","recordsWritten":"6","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$91, $90, $40, $41, $42, $43, $44, $45, $46","FROM __stage03_output"]},{"kind":"SORT","substeps":["$100 ASC, $101 ASC, $30 ASC, $31 ASC, $32 ASC, $33 ASC, $34 ASC, $35 ASC, $36 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $100 := $90, $101 := $91","$30 := SUM($40)","$31 := SUM($41)","$32 := SUM($42)","$33 := SUM($43)","$34 := SUM($44)","$35 := SUM($45)","$36 := SUM($46)"]},{"kind":"WRITE","substeps":["$110, $111, $112, $113, $114, $115, $116, $117, $118","TO __stage04_output"]}],"writeRatioAvg":0.011194029850746268},{"readMsMax":"0","computeMsMax":"5","inputStages":["4"],"waitMsAvg":"1","id":"5","endMs":"1570903829088","waitMsMax":"1","startMs":"1570903829021","waitRatioMax":0.0007462686567164179,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"6","computeRatioAvg":0.0037313432835820895,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004477611940298508,"readMsAvg":"0","waitRatioAvg":0.0007462686567164179,"completedParallelInputs":"1","computeRatioMax":0.0037313432835820895,"name":"S05: Output","shuffleOutputBytes":"558","recordsWritten":"6","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110, $111, $112, $113, $114, $115, $116, $117, $118","FROM __stage04_output"]},{"kind":"SORT","substeps":["$111 ASC, $110 ASC, $112 ASC, $113 ASC, $114 ASC, $115 ASC, $116 ASC, $117 ASC, $118 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$120, $121, $122, $123, $124, $125, $126, $127, $128","TO __stage05_output"]}],"writeRatioAvg":0.004477611940298508}],"estimatedBytesProcessed":"67878154","timeline":[{"totalSlotMs":"214","activeUnits":"1","completedUnits":"2","elapsedMs":"700","pendingUnits":"1"},{"totalSlotMs":"2326","activeUnits":"1","completedUnits":"5","elapsedMs":"1512","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"68157440","totalPartitionsProcessed":"0","totalBytesProcessed":"67878154","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"}]},"endTime":"1570903829306"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query43_1570903825"},"etag":"kS8FMZMJ5rb5MQR6mXCRpA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query43_1570903825?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonc3f110757aa6bfe02c3700c53a76003987c9e634","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query43\nSELECT s_store_name, \n s_store_id, \n Sum(CASE \n WHEN ( d_day_name = 'Sunday' ) THEN ss_sales_price \n ELSE NULL \n END) sun_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Monday' ) THEN ss_sales_price \n ELSE NULL \n END) mon_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Tuesday' ) THEN ss_sales_price \n ELSE NULL \n END) tue_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Wednesday' ) THEN ss_sales_price \n ELSE NULL \n END) wed_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Thursday' ) THEN ss_sales_price \n ELSE NULL \n END) thu_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Friday' ) THEN ss_sales_price \n ELSE NULL \n END) fri_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Saturday' ) THEN ss_sales_price \n ELSE NULL \n END) sat_sales \nFROM date_dim, \n store_sales, \n store \nWHERE d_date_sk = ss_sold_date_sk \n AND s_store_sk = ss_store_sk \n AND s_gmt_offset = -5 \n AND d_year = 2002 \nGROUP BY s_store_name, \n s_store_id \nORDER BY s_store_name, \n s_store_id, \n sun_sales, \n mon_sales, \n tue_sales, \n wed_sales, \n thu_sales, \n fri_sales, \n sat_sales\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query43_1570903825","user_email":"nithish.sankaranarayanan@ulb.be"}
