{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"11427","creationTime":"1570904390744","totalBytesProcessed":"102628312","startTime":"1570904390865","query":{"totalSlotMs":"11427","queryPlan":[{"readMsMax":"13","computeMsMax":"10","waitMsAvg":"1","id":"0","endMs":"1570904391020","waitMsMax":"1","startMs":"1570904390975","waitRatioMax":0.00035739814152966406,"readRatioAvg":0.004646175839885632,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0035739814152966403,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0025017869907076485,"readMsAvg":"13","waitRatioAvg":0.00035739814152966406,"completedParallelInputs":"1","computeRatioMax":0.0035739814152966403,"name":"S00: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.004646175839885632,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_month_seq","FROM date_dim","WHERE between($31, 1196, 1207)"]},{"kind":"WRITE","substeps":["$30","TO __stage00_output","BY HASH($30)"]}],"writeRatioAvg":0.0025017869907076485},{"readMsMax":"10","computeMsMax":"12","waitMsAvg":"15","id":"2","endMs":"1570904391100","waitMsMax":"15","startMs":"1570904391020","waitRatioMax":0.005360972122944961,"readRatioAvg":0.0035739814152966403,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004288777698355968,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0025017869907076485,"readMsAvg":"10","waitRatioAvg":0.005360972122944961,"completedParallelInputs":"1","computeRatioMax":0.004288777698355968,"name":"S02: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.0035739814152966403,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_month_seq","FROM date_dim","WHERE between($21, 1196, 1207)"]},{"kind":"WRITE","substeps":["$20","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.0025017869907076485},{"readMsMax":"40","computeMsMax":"1402","inputStages":["0"],"waitMsAvg":"19","id":"4","endMs":"1570904391812","waitMsMax":"19","startMs":"1570904391059","waitRatioMax":0.006790564689063617,"readRatioAvg":0.014295925661186561,"parallelInputs":"1","recordsRead":"1437808","computeRatioAvg":0.501072194424589,"writeMsAvg":"14","status":"COMPLETE","writeMsMax":"14","computeMsAvg":"1402","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005003573981415297,"readMsAvg":"40","waitRatioAvg":0.006790564689063617,"completedParallelInputs":"1","computeRatioMax":0.501072194424589,"name":"S04: Join+","shuffleOutputBytes":"5160184","recordsWritten":"286984","readRatioMax":0.014295925661186561,"steps":[{"kind":"READ","substeps":["$10:cs_sold_date_sk, $11:cs_bill_customer_sk, $12:cs_item_sk","FROM catalog_sales"]},{"kind":"READ","substeps":["$30","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $110 := $100, $111 := $101"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $10 = $30"]},{"kind":"WRITE","substeps":["$110, $111","TO __stage04_output","BY HASH($110, $111)"]}],"writeRatioAvg":0.005003573981415297},{"readMsMax":"25","computeMsMax":"2798","inputStages":["2"],"waitMsAvg":"0","id":"5","endMs":"1570904392581","waitMsMax":"0","startMs":"1570904391122","waitRatioMax":0,"readRatioAvg":0.008934953538241601,"parallelInputs":"1","recordsRead":"2881544","computeRatioAvg":1,"writeMsAvg":"39","status":"COMPLETE","writeMsMax":"39","computeMsAvg":"2798","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013938527519656898,"readMsAvg":"25","waitRatioAvg":0,"completedParallelInputs":"1","computeRatioMax":1,"name":"S05: Join+","shuffleOutputBytes":"9822712","recordsWritten":"549144","readRatioMax":0.008934953538241601,"steps":[{"kind":"READ","substeps":["$1:ss_sold_date_sk, $2:ss_item_sk, $3:ss_customer_sk","FROM store_sales"]},{"kind":"READ","substeps":["$20","FROM __stage02_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $80 := $71, $81 := $70"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $20"]},{"kind":"WRITE","substeps":["$81, $80","TO __stage05_output","BY HASH($80, $81)"]}],"writeRatioAvg":0.013938527519656898},{"readMsMax":"0","computeMsMax":"549","inputStages":["4"],"waitMsAvg":"1","id":"6","endMs":"1570904393321","waitMsMax":"1","startMs":"1570904392914","waitRatioMax":0.00035739814152966406,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"286984","computeRatioAvg":0.19621157969978556,"writeMsAvg":"98","status":"COMPLETE","writeMsMax":"98","computeMsAvg":"549","shuffleOutputBytesSpilled":"0","writeRatioMax":0.035025017869907075,"readMsAvg":"0","waitRatioAvg":0.00035739814152966406,"completedParallelInputs":"1","computeRatioMax":0.19621157969978556,"name":"S06: Aggregate","shuffleOutputBytes":"5160184","recordsWritten":"286984","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110, $111","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $120 := $110, $121 := $111"]},{"kind":"WRITE","substeps":["$120, $121","TO __stage06_output","BY HASH($120, $121)"]}],"writeRatioAvg":0.035025017869907075},{"readMsMax":"0","computeMsMax":"1277","inputStages":["5"],"waitMsAvg":"1","id":"7","endMs":"1570904393653","waitMsMax":"1","startMs":"1570904392931","waitRatioMax":0.00035739814152966406,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"549144","computeRatioAvg":0.45639742673338096,"writeMsAvg":"54","status":"COMPLETE","writeMsMax":"54","computeMsAvg":"1277","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01929949964260186,"readMsAvg":"0","waitRatioAvg":0.00035739814152966406,"completedParallelInputs":"1","computeRatioMax":0.45639742673338096,"name":"S07: Aggregate","shuffleOutputBytes":"9822712","recordsWritten":"549144","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$81, $80","FROM __stage05_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $90 := $80, $91 := $81"]},{"kind":"WRITE","substeps":["$90, $91","TO __stage07_output","BY HASH($90, $91)"]}],"writeRatioAvg":0.01929949964260186},{"readMsMax":"0","computeMsMax":"19","inputStages":["6","7"],"waitMsAvg":"1","id":"8","endMs":"1570904393814","waitMsMax":"3","startMs":"1570904393715","waitRatioMax":0.001072194424588992,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"836128","computeRatioAvg":0.004646175839885632,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007505360972122945,"readMsAvg":"0","waitRatioAvg":0.00035739814152966406,"completedParallelInputs":"100","computeRatioMax":0.006790564689063617,"name":"S08: Join+","shuffleOutputBytes":"2700","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$90, $91","FROM __stage07_output"]},{"kind":"READ","substeps":["$120, $121","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["$50 := SUM($62)","$51 := SUM($61)","$52 := SUM($60)"]},{"kind":"COMPUTE","substeps":["$60 := case_no_value(and(not(is_null($130)), not(is_null($131))), 1, 0)","$61 := case_no_value(and(is_null($130), not(is_null($131))), 1, 0)","$62 := case_no_value(and(not(is_null($130)), is_null($131)), 1, 0)"]},{"kind":"JOIN","substeps":["FULL OUTER HASH JOIN EACH WITH EACH ON $90 = $120, $91 = $121"]},{"kind":"WRITE","substeps":["$50, $51, $52","TO __stage08_output"]}],"writeRatioAvg":0.0025017869907076485},{"readMsMax":"0","computeMsMax":"7","inputStages":["8"],"waitMsAvg":"1","id":"9","endMs":"1570904393830","waitMsMax":"1","startMs":"1570904393739","waitRatioMax":0.00035739814152966406,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0025017869907076485,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0017869907076483202,"readMsAvg":"0","waitRatioAvg":0.00035739814152966406,"completedParallelInputs":"1","computeRatioMax":0.0025017869907076485,"name":"S09: Output","shuffleOutputBytes":"25","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$50, $51, $52","FROM __stage08_output"]},{"kind":"LIMIT","substeps":["100"]},{"kind":"AGGREGATE","substeps":["$40 := SUM($50)","$41 := SUM($51)","$42 := SUM($52)"]},{"kind":"WRITE","substeps":["$40, $41, $42","TO __stage09_output"]}],"writeRatioAvg":0.0017869907076483202}],"estimatedBytesProcessed":"102628312","timeline":[{"totalSlotMs":"492","activeUnits":"2","completedUnits":"2","elapsedMs":"610","pendingUnits":"2"},{"totalSlotMs":"3863","activeUnits":"2","completedUnits":"4","elapsedMs":"2217","pendingUnits":"2"},{"totalSlotMs":"11427","activeUnits":"1","completedUnits":"107","elapsedMs":"3131","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"102760448","totalPartitionsProcessed":"0","totalBytesProcessed":"102628312","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"}]},"endTime":"1570904394026"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query97_1570904389"},"etag":"8JYOCkMAMAwFoARJSata5w==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query97_1570904389?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon2b83e87f114cf6fdc47ce324151b797767d729b1","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"\n-- query97\nWITH ssci \n AS (SELECT ss_customer_sk customer_sk, \n ss_item_sk item_sk \n FROM store_sales, \n date_dim \n WHERE ss_sold_date_sk = d_date_sk \n AND d_month_seq BETWEEN 1196 AND 1196 + 11 \n GROUP BY ss_customer_sk, \n ss_item_sk), \n csci \n AS (SELECT cs_bill_customer_sk customer_sk, \n cs_item_sk item_sk \n FROM catalog_sales, \n date_dim \n WHERE cs_sold_date_sk = d_date_sk \n AND d_month_seq BETWEEN 1196 AND 1196 + 11 \n GROUP BY cs_bill_customer_sk, \n cs_item_sk) \nSELECT Sum(CASE \n WHEN ssci.customer_sk IS NOT NULL \n AND csci.customer_sk IS NULL THEN 1 \n ELSE 0 \n END) store_only, \n Sum(CASE \n WHEN ssci.customer_sk IS NULL \n AND csci.customer_sk IS NOT NULL THEN 1 \n ELSE 0 \n END) catalog_only, \n Sum(CASE \n WHEN ssci.customer_sk IS NOT NULL \n AND csci.customer_sk IS NOT NULL THEN 1 \n ELSE 0 \n END) store_and_catalog \nFROM ssci \n FULL OUTER JOIN csci \n ON ( ssci.customer_sk = csci.customer_sk \n AND ssci.item_sk = csci.item_sk )\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query97_1570904389","user_email":"nithish.sankaranarayanan@ulb.be"}
