{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"24048","creationTime":"1570903874320","totalBytesProcessed":"199937977","startTime":"1570903874507","query":{"totalSlotMs":"24048","queryPlan":[{"readMsMax":"13","computeMsMax":"8","waitMsAvg":"1","id":"0","endMs":"1570903874777","waitMsMax":"1","startMs":"1570903874690","waitRatioMax":0.000429553264604811,"readRatioAvg":0.005584192439862543,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.003436426116838488,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003006872852233677,"readMsAvg":"13","waitRatioAvg":0.000429553264604811,"completedParallelInputs":"1","computeRatioMax":0.003436426116838488,"name":"S00: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.005584192439862543,"steps":[{"kind":"READ","substeps":["$1:d_date_sk, $2:d_year","FROM date_dim","WHERE equal($2, 1999)"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.003006872852233677},{"readMsMax":"11","computeMsMax":"15","waitMsAvg":"24","id":"1","endMs":"1570903874908","waitMsMax":"24","startMs":"1570903874729","waitRatioMax":0.010309278350515464,"readRatioAvg":0.004725085910652921,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.006443298969072165,"writeMsAvg":"154","status":"COMPLETE","writeMsMax":"154","computeMsAvg":"15","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0661512027491409,"readMsAvg":"11","waitRatioAvg":0.010309278350515464,"completedParallelInputs":"1","computeRatioMax":0.006443298969072165,"name":"S01: Input","shuffleOutputBytes":"213984","recordsWritten":"13374","readRatioMax":0.004725085910652921,"steps":[{"kind":"READ","substeps":["$10:ca_address_sk, $11:ca_state, $12:ca_country","FROM customer_address","WHERE and(equal($12, 'United States'), or(in($11, 'TX', 'NE', 'MO'), in($11, 'CO', 'TN', 'ND'), in($11, 'OK', 'PA', 'CA')))"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.0661512027491409},{"readMsMax":"51","computeMsMax":"569","waitMsAvg":"48","id":"2","endMs":"1570903875221","waitMsMax":"48","startMs":"1570903874772","waitRatioMax":0.020618556701030927,"readRatioAvg":0.02190721649484536,"parallelInputs":"1","recordsRead":"1920800","computeRatioAvg":0.24441580756013745,"writeMsAvg":"89","status":"COMPLETE","writeMsMax":"89","computeMsAvg":"569","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03823024054982818,"readMsAvg":"51","waitRatioAvg":0.020618556701030927,"completedParallelInputs":"1","computeRatioMax":0.24441580756013745,"name":"S02: Input","shuffleOutputBytes":"15640800","recordsWritten":"493920","readRatioMax":0.02190721649484536,"steps":[{"kind":"READ","substeps":["$30:cd_demo_sk, $31:cd_marital_status, $32:cd_education_status","FROM customer_demographics","WHERE and(or(equal($31, 'W'), equal($31, 'M'), equal($31, 'D')), ...)"]},{"kind":"WRITE","substeps":["$30, $31, $32","TO __stage02_output","BY HASH($30)"]}],"writeRatioAvg":0.03823024054982818},{"readMsMax":"46","computeMsMax":"6","waitMsAvg":"4","id":"3","endMs":"1570903874881","waitMsMax":"4","startMs":"1570903874815","waitRatioMax":0.001718213058419244,"readRatioAvg":0.019759450171821305,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.002577319587628866,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003006872852233677,"readMsAvg":"46","waitRatioAvg":0.001718213058419244,"completedParallelInputs":"1","computeRatioMax":0.002577319587628866,"name":"S03: Input","shuffleOutputBytes":"108","recordsWritten":"12","readRatioMax":0.019759450171821305,"steps":[{"kind":"READ","substeps":["$20:s_store_sk","FROM store"]},{"kind":"WRITE","substeps":["$20","TO __stage03_output","BY HASH($20)"]}],"writeRatioAvg":0.003006872852233677},{"readMsMax":"0","computeMsMax":"14","inputStages":["2"],"waitMsAvg":"1","id":"6","endMs":"1570903875375","waitMsMax":"4","startMs":"1570903875228","waitRatioMax":0.001718213058419244,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"493920","computeRatioAvg":0.003865979381443299,"writeMsAvg":"67","status":"COMPLETE","writeMsMax":"98","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04209621993127148,"readMsAvg":"0","waitRatioAvg":0.000429553264604811,"completedParallelInputs":"100","computeRatioMax":0.006013745704467354,"name":"S06: Coalesce","shuffleOutputBytes":"15640800","recordsWritten":"493920","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage02_output"]}],"writeRatioAvg":0.028780068728522335},{"readMsMax":"33","computeMsMax":"2328","inputStages":["0","1","6","3"],"waitMsAvg":"4","id":"7","endMs":"1570903876528","waitMsMax":"4","startMs":"1570903875235","waitRatioMax":0.001718213058419244,"readRatioAvg":0.014175257731958763,"parallelInputs":"1","recordsRead":"3388849","computeRatioAvg":1,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"3","computeMsAvg":"2328","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001288659793814433,"readMsAvg":"33","waitRatioAvg":0.001718213058419244,"completedParallelInputs":"1","computeRatioMax":1,"name":"S07: Join+","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.014175257731958763,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_cdemo_sk, $42:ss_addr_sk, $43:ss_store_sk, $44:ss_quantity, $45:ss_sales_price, $46:ss_net_profit","FROM store_sales","WHERE and(or(between($45, 100, 150), between($45, 50, 100), between($45, 150, 200)), ...)"]},{"kind":"READ","substeps":["$20","FROM __stage03_output"]},{"kind":"READ","substeps":["$30, $31, $32","FROM __stage06_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage01_output"]},{"kind":"READ","substeps":["$1","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["$60 := SUM($120)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $110 = $1"]},{"kind":"FILTER","substeps":["or(and(in($113, 'TX', 'NE', 'MO'), between($112, 0, 2000)), and(in($113, 'CO', 'TN', 'ND'), between($112, 150, 3000)), ...)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $91 = $10"]},{"kind":"FILTER","substeps":["or(and(equal($95, 'W'), equal($96, 'Secondary'), between($93, 100, 150)), ...)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $71 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $43 = $20"]},{"kind":"WRITE","substeps":["$60","TO __stage07_output"]}],"writeRatioAvg":0.001288659793814433},{"readMsMax":"0","computeMsMax":"5","inputStages":["7"],"waitMsAvg":"1","id":"8","endMs":"1570903876654","waitMsMax":"1","startMs":"1570903875265","waitRatioMax":0.000429553264604811,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.002147766323024055,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003436426116838488,"readMsAvg":"0","waitRatioAvg":0.000429553264604811,"completedParallelInputs":"1","computeRatioMax":0.002147766323024055,"name":"S08: Output","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$60","FROM __stage07_output"]},{"kind":"AGGREGATE","substeps":["$50 := SUM($60)"]},{"kind":"WRITE","substeps":["$50","TO __stage08_output"]}],"writeRatioAvg":0.003436426116838488}],"estimatedBytesProcessed":"199937977","timeline":[{"totalSlotMs":"1371","activeUnits":"2","completedUnits":"3","elapsedMs":"684","pendingUnits":"2"},{"totalSlotMs":"19437","activeUnits":"2","completedUnits":"104","elapsedMs":"1217","pendingUnits":"2"},{"totalSlotMs":"24048","activeUnits":"0","completedUnits":"106","elapsedMs":"2747","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"200278016","totalPartitionsProcessed":"0","totalBytesProcessed":"199937977","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"customer_demographics","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"}]},"endTime":"1570903877289"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query48_1570903872"},"etag":"M1RGiw/H0YhA1blJoVQgjQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query48_1570903872?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon5aaed8f0f9ec5eeb1770d9279f05f0763f967910","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query48\nSELECT Sum (ss_quantity) \nFROM store_sales, \n store, \n customer_demographics, \n customer_address, \n date_dim \nWHERE s_store_sk = ss_store_sk \n AND ss_sold_date_sk = d_date_sk \n AND d_year = 1999 \n AND ( ( cd_demo_sk = ss_cdemo_sk \n AND cd_marital_status = 'W' \n AND cd_education_status = 'Secondary' \n AND ss_sales_price BETWEEN 100.00 AND 150.00 ) \n OR ( cd_demo_sk = ss_cdemo_sk \n AND cd_marital_status = 'M' \n AND cd_education_status = 'Advanced Degree' \n AND ss_sales_price BETWEEN 50.00 AND 100.00 ) \n OR ( cd_demo_sk = ss_cdemo_sk \n AND cd_marital_status = 'D' \n AND cd_education_status = '2 yr Degree' \n AND ss_sales_price BETWEEN 150.00 AND 200.00 ) ) \n AND ( ( ss_addr_sk = ca_address_sk \n AND ca_country = 'United States' \n AND ca_state IN ( 'TX', 'NE', 'MO' ) \n AND ss_net_profit BETWEEN 0 AND 2000 ) \n OR ( ss_addr_sk = ca_address_sk \n AND ca_country = 'United States' \n AND ca_state IN ( 'CO', 'TN', 'ND' ) \n AND ss_net_profit BETWEEN 150 AND 3000 ) \n OR ( ss_addr_sk = ca_address_sk \n AND ca_country = 'United States' \n AND ca_state IN ( 'OK', 'PA', 'CA' ) \n AND ss_net_profit BETWEEN 50 AND 25000 ) ); \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query48_1570903872","user_email":"nithish.sankaranarayanan@ulb.be"}
