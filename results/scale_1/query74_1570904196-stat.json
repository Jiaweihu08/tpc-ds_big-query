{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"75199","creationTime":"1570904198474","totalBytesProcessed":"88644405","startTime":"1570904198681","query":{"totalSlotMs":"75199","queryPlan":[{"readMsMax":"27","computeMsMax":"13","waitMsAvg":"1","id":"0","endMs":"1570904199079","waitMsMax":"1","startMs":"1570904198871","waitRatioMax":0.0001976284584980237,"readRatioAvg":0.005335968379446641,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.002569169960474308,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002173913043478261,"readMsAvg":"27","waitRatioAvg":0.0001976284584980237,"completedParallelInputs":"1","computeRatioMax":0.002569169960474308,"name":"S00: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.005335968379446641,"steps":[{"kind":"READ","substeps":["$110:d_date_sk, $111:d_year","FROM date_dim","WHERE and(in($111, 1999, 2000), equal($111, 1999))"]},{"kind":"WRITE","substeps":["$110, $111","TO __stage00_output","BY HASH($110)"]}],"writeRatioAvg":0.002173913043478261},{"readMsMax":"24","computeMsMax":"162","waitMsAvg":"1","id":"2","endMs":"1570904199698","waitMsMax":"1","startMs":"1570904199000","waitRatioMax":0.0001976284584980237,"readRatioAvg":0.0047430830039525695,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.032015810276679844,"writeMsAvg":"14","status":"COMPLETE","writeMsMax":"14","computeMsAvg":"162","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002766798418972332,"readMsAvg":"24","waitRatioAvg":0.0001976284584980237,"completedParallelInputs":"1","computeRatioMax":0.032015810276679844,"name":"S02: Input","shuffleOutputBytes":"5127711","recordsWritten":"100000","readRatioMax":0.0047430830039525695,"steps":[{"kind":"READ","substeps":["$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$90, $91, $92, $93","TO __stage02_output","BY HASH($90)"]}],"writeRatioAvg":0.002766798418972332},{"readMsMax":"8","computeMsMax":"6","waitMsAvg":"20","id":"3","endMs":"1570904199244","waitMsMax":"20","startMs":"1570904199043","waitRatioMax":0.003952569169960474,"readRatioAvg":0.0015810276679841897,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0011857707509881424,"writeMsAvg":"182","status":"COMPLETE","writeMsMax":"182","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03596837944664032,"readMsAvg":"8","waitRatioAvg":0.003952569169960474,"completedParallelInputs":"1","computeRatioMax":0.0011857707509881424,"name":"S03: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0015810276679841897,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_year","FROM date_dim","WHERE and(in($81, 1999, 2000), equal($81, 1999))"]},{"kind":"WRITE","substeps":["$80, $81","TO __stage03_output","BY HASH($80)"]}],"writeRatioAvg":0.03596837944664032},{"readMsMax":"45","computeMsMax":"859","waitMsAvg":"41","id":"4","endMs":"1570904199751","waitMsMax":"41","startMs":"1570904199079","waitRatioMax":0.008102766798418972,"readRatioAvg":0.008893280632411068,"parallelInputs":"1","recordsRead":"720759","computeRatioAvg":0.16976284584980236,"writeMsAvg":"193","status":"COMPLETE","writeMsMax":"193","computeMsAvg":"859","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03814229249011858,"readMsAvg":"45","waitRatioAvg":0.008102766798418972,"completedParallelInputs":"1","computeRatioMax":0.16976284584980236,"name":"S04: Input","shuffleOutputBytes":"19454226","recordsWritten":"720582","readRatioMax":0.008893280632411068,"steps":[{"kind":"READ","substeps":["$70:ws_sold_date_sk, $71:ws_bill_customer_sk, $72:ws_net_paid","FROM web_sales"]},{"kind":"WRITE","substeps":["$70, $71, $72","TO __stage04_output","BY HASH($71)"]}],"writeRatioAvg":0.03814229249011858},{"readMsMax":"13","computeMsMax":"7","waitMsAvg":"3","id":"6","endMs":"1570904199200","waitMsMax":"3","startMs":"1570904199144","waitRatioMax":0.0005928853754940712,"readRatioAvg":0.002569169960474308,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.001383399209486166,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003952569169960474,"readMsAvg":"13","waitRatioAvg":0.0005928853754940712,"completedParallelInputs":"1","computeRatioMax":0.001383399209486166,"name":"S06: Input","shuffleOutputBytes":"6588","recordsWritten":"366","readRatioMax":0.002569169960474308,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year","FROM date_dim","WHERE and(in($51, 1999, 2000), equal($51, 2000))"]},{"kind":"WRITE","substeps":["$50, $51","TO __stage06_output","BY HASH($50)"]}],"writeRatioAvg":0.003952569169960474},{"readMsMax":"22","computeMsMax":"106","waitMsAvg":"13","id":"8","endMs":"1570904199713","waitMsMax":"13","startMs":"1570904199462","waitRatioMax":0.002569169960474308,"readRatioAvg":0.004347826086956522,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.020948616600790514,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"12","computeMsAvg":"106","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0023715415019762848,"readMsAvg":"22","waitRatioAvg":0.002569169960474308,"completedParallelInputs":"1","computeRatioMax":0.020948616600790514,"name":"S08: Input","shuffleOutputBytes":"5127711","recordsWritten":"100000","readRatioMax":0.004347826086956522,"steps":[{"kind":"READ","substeps":["$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$30, $31, $32, $33","TO __stage08_output","BY HASH($30)"]}],"writeRatioAvg":0.0023715415019762848},{"readMsMax":"9","computeMsMax":"9","waitMsAvg":"12","id":"9","endMs":"1570904199647","waitMsMax":"12","startMs":"1570904199484","waitRatioMax":0.0023715415019762848,"readRatioAvg":0.0017786561264822134,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0017786561264822134,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0017786561264822134,"readMsAvg":"9","waitRatioAvg":0.0023715415019762848,"completedParallelInputs":"1","computeRatioMax":0.0017786561264822134,"name":"S09: Input","shuffleOutputBytes":"6588","recordsWritten":"366","readRatioMax":0.0017786561264822134,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_year","FROM date_dim","WHERE and(in($21, 1999, 2000), equal($21, 2000))"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage09_output","BY HASH($20)"]}],"writeRatioAvg":0.0017786561264822134},{"readMsMax":"31","computeMsMax":"167","waitMsAvg":"17","id":"11","endMs":"1570904199851","waitMsMax":"17","startMs":"1570904199520","waitRatioMax":0.0033596837944664033,"readRatioAvg":0.006126482213438735,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.03300395256916996,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"167","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004545454545454545,"readMsAvg":"31","waitRatioAvg":0.0033596837944664033,"completedParallelInputs":"1","computeRatioMax":0.03300395256916996,"name":"S0B: Input","shuffleOutputBytes":"5127711","recordsWritten":"100000","readRatioMax":0.006126482213438735,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$1, $2, $3, $4","TO __stage0B_output","BY HASH($1)"]}],"writeRatioAvg":0.004545454545454545},{"readMsMax":"25","computeMsMax":"3771","inputStages":["0","2"],"waitMsAvg":"8","id":"12","endMs":"1570904202070","waitMsMax":"8","startMs":"1570904199925","waitRatioMax":0.0015810276679841897,"readRatioAvg":0.004940711462450593,"parallelInputs":"1","recordsRead":"2981543","computeRatioAvg":0.7452569169960475,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"3771","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004347826086956522,"readMsAvg":"25","waitRatioAvg":0.0015810276679841897,"completedParallelInputs":"1","computeRatioMax":0.7452569169960475,"name":"S0C: Join+","shuffleOutputBytes":"2301990","recordsWritten":"38193","readRatioMax":0.004940711462450593,"steps":[{"kind":"READ","substeps":["$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_net_paid","FROM store_sales"]},{"kind":"READ","substeps":["$90, $91, $92, $93","FROM __stage02_output"]},{"kind":"READ","substeps":["$110, $111","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $220 := $210, $221 := $211, $222 := $212, $223 := $214","$190 := SUM($213)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $203 = $110"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $101 = $90"]},{"kind":"WRITE","substeps":["$220, $221, $222, $223, $190","TO __stage0C_output","BY HASH($220, $221, $222, $223)"]}],"writeRatioAvg":0.004347826086956522},{"readMsMax":"51","computeMsMax":"5060","inputStages":["6","8"],"waitMsAvg":"9","id":"13","endMs":"1570904202642","waitMsMax":"9","startMs":"1570904199956","waitRatioMax":0.0017786561264822134,"readRatioAvg":0.01007905138339921,"parallelInputs":"1","recordsRead":"2981544","computeRatioAvg":1,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"25","computeMsAvg":"5060","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004940711462450593,"readMsAvg":"51","waitRatioAvg":0.0017786561264822134,"completedParallelInputs":"1","computeRatioMax":1,"name":"S0D: Join+","shuffleOutputBytes":"2302201","recordsWritten":"38197","readRatioMax":0.01007905138339921,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_net_paid","FROM store_sales"]},{"kind":"READ","substeps":["$30, $31, $32, $33","FROM __stage08_output"]},{"kind":"READ","substeps":["$50, $51","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $260 := $250, $261 := $251, $262 := $252, $263 := $254","$170 := SUM($253)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $243 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $41 = $30"]},{"kind":"WRITE","substeps":["$260, $261, $262, $263, $170","TO __stage0D_output","BY HASH($260, $261, $262, $263)"]}],"writeRatioAvg":0.004940711462450593},{"readMsMax":"0","computeMsMax":"14","inputStages":["4"],"waitMsAvg":"21","id":"14","endMs":"1570904200560","waitMsMax":"24","startMs":"1570904199964","waitRatioMax":0.0047430830039525695,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"720582","computeRatioAvg":0.0017786561264822134,"writeMsAvg":"88","status":"COMPLETE","writeMsMax":"217","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04288537549407115,"readMsAvg":"0","waitRatioAvg":0.004150197628458498,"completedParallelInputs":"100","computeRatioMax":0.002766798418972332,"name":"S0E: Coalesce","shuffleOutputBytes":"19454226","recordsWritten":"720582","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage04_output"]}],"writeRatioAvg":0.017391304347826087},{"readMsMax":"18","computeMsMax":"745","inputStages":["3","14"],"waitMsAvg":"4","id":"15","endMs":"1570904200806","waitMsMax":"4","startMs":"1570904199982","waitRatioMax":0.0007905138339920949,"readRatioAvg":0.0035573122529644267,"parallelInputs":"1","recordsRead":"820947","computeRatioAvg":0.14723320158102768,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"745","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004545454545454545,"readMsAvg":"18","waitRatioAvg":0.0007905138339920949,"completedParallelInputs":"1","computeRatioMax":0.14723320158102768,"name":"S0F: Join+","shuffleOutputBytes":"675769","recordsWritten":"11208","readRatioMax":0.0035573122529644267,"steps":[{"kind":"READ","substeps":["$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name","FROM customer"]},{"kind":"READ","substeps":["$70, $71, $72","FROM __stage0E_output"]},{"kind":"READ","substeps":["$80, $81","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $310 := $300, $311 := $301, $312 := $302, $313 := $304","$180 := SUM($303)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $293 = $80"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $60 = $71"]},{"kind":"WRITE","substeps":["$310, $311, $312, $313, $180","TO __stage0F_output","BY HASH($310, $311, $312, $313)"]}],"writeRatioAvg":0.004545454545454545},{"readMsMax":"24","computeMsMax":"443","inputStages":["9","11"],"waitMsAvg":"3","id":"16","endMs":"1570904200354","waitMsMax":"3","startMs":"1570904200073","waitRatioMax":0.0005928853754940712,"readRatioAvg":0.0047430830039525695,"parallelInputs":"1","recordsRead":"821125","computeRatioAvg":0.0875494071146245,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"443","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0035573122529644267,"readMsAvg":"24","waitRatioAvg":0.0005928853754940712,"completedParallelInputs":"1","computeRatioMax":0.0875494071146245,"name":"S10: Join+","shuffleOutputBytes":"688775","recordsWritten":"11431","readRatioMax":0.0047430830039525695,"steps":[{"kind":"READ","substeps":["$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_net_paid","FROM web_sales"]},{"kind":"READ","substeps":["$1, $2, $3, $4","FROM __stage0B_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $360 := $350, $361 := $351, $362 := $352, $363 := $354","$150 := SUM($353)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $343 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $11 = $1"]},{"kind":"WRITE","substeps":["$360, $361, $362, $363, $150","TO __stage10_output","BY HASH($360, $361, $362, $363)"]}],"writeRatioAvg":0.0035573122529644267},{"readMsMax":"0","computeMsMax":"39","inputStages":["16"],"waitMsAvg":"3","id":"17","endMs":"1570904203495","waitMsMax":"3","startMs":"1570904203081","waitRatioMax":0.0005928853754940712,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"11431","computeRatioAvg":0.007707509881422925,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"39","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0047430830039525695,"readMsAvg":"0","waitRatioAvg":0.0005928853754940712,"completedParallelInputs":"1","computeRatioMax":0.007707509881422925,"name":"S11: Aggregate","shuffleOutputBytes":"342930","recordsWritten":"11431","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$360, $361, $362, $363, $150","FROM __stage10_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $370 := $360, $371 := $361, $372 := $362, $373 := $363","$120 := SUM($150)"]},{"kind":"WRITE","substeps":["$120, $370","TO __stage11_output","BY HASH($370)"]}],"writeRatioAvg":0.0047430830039525695},{"readMsMax":"0","computeMsMax":"23","inputStages":["15"],"waitMsAvg":"2","id":"18","endMs":"1570904203274","waitMsMax":"2","startMs":"1570904203103","waitRatioMax":0.0003952569169960474,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"11208","computeRatioAvg":0.004545454545454545,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"23","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007905138339920949,"readMsAvg":"0","waitRatioAvg":0.0003952569169960474,"completedParallelInputs":"1","computeRatioMax":0.004545454545454545,"name":"S12: Aggregate+","shuffleOutputBytes":"336240","recordsWritten":"11208","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$310, $311, $312, $313, $180","FROM __stage0F_output"]},{"kind":"FILTER","substeps":["greater($140, 0)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $320 := $310, $321 := $311, $322 := $312, $323 := $313","$140 := SUM($180)"]},{"kind":"WRITE","substeps":["$140, $320","TO __stage12_output","BY HASH($320)"]}],"writeRatioAvg":0.0007905138339920949},{"readMsMax":"0","computeMsMax":"115","inputStages":["13"],"waitMsAvg":"3","id":"19","endMs":"1570904203397","waitMsMax":"3","startMs":"1570904203126","waitRatioMax":0.0005928853754940712,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"38197","computeRatioAvg":0.022727272727272728,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"28","computeMsAvg":"115","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005533596837944664,"readMsAvg":"0","waitRatioAvg":0.0005928853754940712,"completedParallelInputs":"1","computeRatioMax":0.022727272727272728,"name":"S13: Aggregate","shuffleOutputBytes":"1958428","recordsWritten":"38197","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$260, $261, $262, $263, $170","FROM __stage0D_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263","$130 := SUM($170)"]},{"kind":"WRITE","substeps":["$130, $270, $271, $272","TO __stage13_output","BY HASH($270)"]}],"writeRatioAvg":0.005533596837944664},{"readMsMax":"0","computeMsMax":"13","inputStages":["19"],"waitMsAvg":"2","id":"21","endMs":"1570904204036","waitMsMax":"7","startMs":"1570904203917","waitRatioMax":0.001383399209486166,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"38197","computeRatioAvg":0.0011857707509881424,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"48","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009486166007905139,"readMsAvg":"0","waitRatioAvg":0.0003952569169960474,"completedParallelInputs":"100","computeRatioMax":0.002569169960474308,"name":"S15: Coalesce","shuffleOutputBytes":"1958428","recordsWritten":"38197","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage13_output"]}],"writeRatioAvg":0.005731225296442688},{"readMsMax":"0","computeMsMax":"9","inputStages":["18"],"waitMsAvg":"6","id":"22","endMs":"1570904204044","waitMsMax":"8","startMs":"1570904203918","waitRatioMax":0.0015810276679841897,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"11208","computeRatioAvg":0.0009881422924901185,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"52","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010276679841897233,"readMsAvg":"0","waitRatioAvg":0.0011857707509881424,"completedParallelInputs":"100","computeRatioMax":0.0017786561264822134,"name":"S16: Coalesce","shuffleOutputBytes":"336240","recordsWritten":"11208","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage12_output"]}],"writeRatioAvg":0.004940711462450593},{"readMsMax":"0","computeMsMax":"10","inputStages":["17"],"waitMsAvg":"13","id":"24","endMs":"1570904204202","waitMsMax":"15","startMs":"1570904203964","waitRatioMax":0.0029644268774703555,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"11431","computeRatioAvg":0.0009881422924901185,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"38","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007509881422924901,"readMsAvg":"0","waitRatioAvg":0.002569169960474308,"completedParallelInputs":"100","computeRatioMax":0.001976284584980237,"name":"S18: Coalesce","shuffleOutputBytes":"342930","recordsWritten":"11431","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage11_output"]}],"writeRatioAvg":0.004347826086956522},{"readMsMax":"0","computeMsMax":"124","inputStages":["12","24","22","21"],"waitMsAvg":"15","id":"25","endMs":"1570904204244","waitMsMax":"15","startMs":"1570904203977","waitRatioMax":0.0029644268774703555,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"99029","computeRatioAvg":0.02450592885375494,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"124","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007905138339920949,"readMsAvg":"0","waitRatioAvg":0.0029644268774703555,"completedParallelInputs":"1","computeRatioMax":0.02450592885375494,"name":"S19: Join+","shuffleOutputBytes":"3790","recordsWritten":"90","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$220, $221, $222, $223, $190","FROM __stage0C_output"]},{"kind":"READ","substeps":["$130, $270, $271, $272","FROM __stage15_output"]},{"kind":"READ","substeps":["$140, $320","FROM __stage16_output"]},{"kind":"READ","substeps":["$120, $370","FROM __stage18_output"]},{"kind":"SORT","substeps":["$380 ASC, $381 ASC, $382 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["greater(case_no_value(greater($384, 0), divide($386, $384), NULL), case_no_value(greater($385, 0), divide($383, $385), NULL))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $333 = $370"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $280 = $320"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $230 = $270"]},{"kind":"FILTER","substeps":["greater($160, 0)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $220, $231 := $221, $232 := $222, $233 := $223","$160 := SUM($190)"]},{"kind":"WRITE","substeps":["$390, $391, $392","TO __stage19_output"]}],"writeRatioAvg":0.0007905138339920949},{"readMsMax":"0","computeMsMax":"7","inputStages":["25"],"waitMsAvg":"4","id":"26","endMs":"1570904204330","waitMsMax":"4","startMs":"1570904203994","waitRatioMax":0.0007905138339920949,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"90","computeRatioAvg":0.001383399209486166,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0011857707509881424,"readMsAvg":"0","waitRatioAvg":0.0007905138339920949,"completedParallelInputs":"1","computeRatioMax":0.001383399209486166,"name":"S1A: Output","shuffleOutputBytes":"3790","recordsWritten":"90","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$390, $391, $392","FROM __stage19_output"]},{"kind":"SORT","substeps":["$390 ASC, $391 ASC, $392 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$400, $401, $402","TO __stage1A_output"]}],"writeRatioAvg":0.0011857707509881424}],"estimatedBytesProcessed":"88644405","timeline":[{"totalSlotMs":"1069","activeUnits":"5","completedUnits":"3","elapsedMs":"693","pendingUnits":"6"},{"totalSlotMs":"35557","activeUnits":"5","completedUnits":"108","elapsedMs":"1792","pendingUnits":"4"},{"totalSlotMs":"38275","activeUnits":"2","completedUnits":"110","elapsedMs":"2384","pendingUnits":"2"},{"totalSlotMs":"43000","activeUnits":"3","completedUnits":"112","elapsedMs":"4466","pendingUnits":"4"},{"totalSlotMs":"75199","activeUnits":"0","completedUnits":"417","elapsedMs":"5904","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"89128960","totalPartitionsProcessed":"0","totalBytesProcessed":"88644405","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_1"}]},"endTime":"1570904204615"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query74_1570904196"},"etag":"QTvh99M0lmLipty2sXTGHg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query74_1570904196?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon17db6e2f3af6b29f11ee903cacad997e038ec31f","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query74\nWITH year_total \n AS (SELECT c_customer_id customer_id, \n c_first_name customer_first_name, \n c_last_name customer_last_name, \n d_year AS year1, \n Sum(ss_net_paid) year_total, \n 's' sale_type \n FROM customer, \n store_sales, \n date_dim \n WHERE c_customer_sk = ss_customer_sk \n AND ss_sold_date_sk = d_date_sk \n AND d_year IN ( 1999, 1999 + 1 ) \n GROUP BY c_customer_id, \n c_first_name, \n c_last_name, \n d_year \n UNION ALL \n SELECT c_customer_id customer_id, \n c_first_name customer_first_name, \n c_last_name customer_last_name, \n d_year AS year1, \n Sum(ws_net_paid) year_total, \n 'w' sale_type \n FROM customer, \n web_sales, \n date_dim \n WHERE c_customer_sk = ws_bill_customer_sk \n AND ws_sold_date_sk = d_date_sk \n AND d_year IN ( 1999, 1999 + 1 ) \n GROUP BY c_customer_id, \n c_first_name, \n c_last_name, \n d_year) \nSELECT t_s_secyear.customer_id, \n t_s_secyear.customer_first_name, \n t_s_secyear.customer_last_name \nFROM year_total t_s_firstyear, \n year_total t_s_secyear, \n year_total t_w_firstyear, \n year_total t_w_secyear \nWHERE t_s_secyear.customer_id = t_s_firstyear.customer_id \n AND t_s_firstyear.customer_id = t_w_secyear.customer_id \n AND t_s_firstyear.customer_id = t_w_firstyear.customer_id \n AND t_s_firstyear.sale_type = 's' \n AND t_w_firstyear.sale_type = 'w' \n AND t_s_secyear.sale_type = 's' \n AND t_w_secyear.sale_type = 'w' \n AND t_s_firstyear.year1 = 1999 \n AND t_s_secyear.year1 = 1999 + 1 \n AND t_w_firstyear.year1 = 1999 \n AND t_w_secyear.year1 = 1999 + 1 \n AND t_s_firstyear.year_total > 0 \n AND t_w_firstyear.year_total > 0 \n AND CASE \n WHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / \n t_w_firstyear.year_total \n ELSE NULL \n END > CASE \n WHEN t_s_firstyear.year_total > 0 THEN \n t_s_secyear.year_total / \n t_s_firstyear.year_total \n ELSE NULL \n END \nORDER BY 1, \n 2, \n 3\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query74_1570904196","user_email":"nithish.sankaranarayanan@ulb.be"}
