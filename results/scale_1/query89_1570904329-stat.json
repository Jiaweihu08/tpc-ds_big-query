{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"2002","creationTime":"1570904330442","totalBytesProcessed":"91631879","startTime":"1570904330563","query":{"totalSlotMs":"2002","queryPlan":[{"readMsMax":"10","computeMsMax":"11","waitMsAvg":"1","id":"0","endMs":"1570904330898","waitMsMax":"1","startMs":"1570904330669","waitRatioMax":0.0009182736455463728,"readRatioAvg":0.009182736455463728,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.010101010101010102,"writeMsAvg":"197","status":"COMPLETE","writeMsMax":"197","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.18089990817263543,"readMsAvg":"10","waitRatioAvg":0.0009182736455463728,"completedParallelInputs":"1","computeRatioMax":0.010101010101010102,"name":"S00: Input","shuffleOutputBytes":"357","recordsWritten":"12","readRatioMax":0.009182736455463728,"steps":[{"kind":"READ","substeps":["$1:s_store_sk, $2:s_store_name, $3:s_company_name","FROM store"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.18089990817263543},{"readMsMax":"8","computeMsMax":"8","waitMsAvg":"1","id":"1","endMs":"1570904330846","waitMsMax":"1","startMs":"1570904330758","waitRatioMax":0.0009182736455463728,"readRatioAvg":0.0073461891643709825,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0073461891643709825,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.015610651974288337,"readMsAvg":"8","waitRatioAvg":0.0009182736455463728,"completedParallelInputs":"1","computeRatioMax":0.0073461891643709825,"name":"S01: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0073461891643709825,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $22:d_moy, $21:d_year","FROM date_dim","WHERE in($21, 2002)"]},{"kind":"WRITE","substeps":["$20, $22","TO __stage01_output","BY HASH($20)"]}],"writeRatioAvg":0.015610651974288337},{"readMsMax":"9","computeMsMax":"18","waitMsAvg":"49","id":"3","endMs":"1570904330890","waitMsMax":"49","startMs":"1570904330844","waitRatioMax":0.04499540863177227,"readRatioAvg":0.008264462809917356,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.01652892561983471,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008264462809917356,"readMsAvg":"9","waitRatioAvg":0.04499540863177227,"completedParallelInputs":"1","computeRatioMax":0.01652892561983471,"name":"S03: Input","shuffleOutputBytes":"89453","recordsWritten":"1711","readRatioMax":0.008264462809917356,"steps":[{"kind":"READ","substeps":["$30:i_item_sk, $31:i_brand, $32:i_class, $33:i_category","FROM item","WHERE or(and(in($33, 'Home', 'Men', 'Sports'), in($32, 'paint', 'accessories', 'fitness')), ...)"]},{"kind":"WRITE","substeps":["$30, $31, $32, $33","TO __stage03_output","BY HASH($30)"]}],"writeRatioAvg":0.008264462809917356},{"readMsMax":"32","computeMsMax":"1089","inputStages":["0","1","3"],"waitMsAvg":"1","id":"5","endMs":"1570904331591","waitMsMax":"1","startMs":"1570904330925","waitRatioMax":0.0009182736455463728,"readRatioAvg":0.02938475665748393,"parallelInputs":"1","recordsRead":"2883266","computeRatioAvg":1,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"3","computeMsAvg":"1089","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0027548209366391185,"readMsAvg":"32","waitRatioAvg":0.0009182736455463728,"completedParallelInputs":"1","computeRatioMax":1,"name":"S05: Join+","shuffleOutputBytes":"194473","recordsWritten":"2368","readRatioMax":0.02938475665748393,"steps":[{"kind":"READ","substeps":["$10:ss_sold_date_sk, $11:ss_item_sk, $12:ss_store_sk, $13:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$30, $31, $32, $33","FROM __stage03_output"]},{"kind":"READ","substeps":["$20, $22","FROM __stage01_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $110 := $104, $111 := $103, $112 := $102, $113 := $105, $114 := $106, $115 := $101","$70 := SUM($100)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $90 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $83 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $11 = $30"]},{"kind":"WRITE","substeps":["$113, $114, $115, $112, $111, $110, $70","TO __stage05_output","BY HASH($110, $111, $112, $113, $114, $115)"]}],"writeRatioAvg":0.0027548209366391185},{"readMsMax":"0","computeMsMax":"13","inputStages":["5"],"waitMsAvg":"1","id":"6","endMs":"1570904331762","waitMsMax":"1","startMs":"1570904331727","waitRatioMax":0.0009182736455463728,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2368","computeRatioAvg":0.011937557392102846,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005509641873278237,"readMsAvg":"0","waitRatioAvg":0.0009182736455463728,"completedParallelInputs":"1","computeRatioMax":0.011937557392102846,"name":"S06: Aggregate","shuffleOutputBytes":"194473","recordsWritten":"2368","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$113, $114, $115, $112, $111, $110, $70","FROM __stage05_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $120 := $110, $121 := $111, $122 := $112, $123 := $113, $124 := $114, $125 := $115","$60 := SUM($70)"]},{"kind":"WRITE","substeps":["$123, $124, $125, $122, $121, $120, $60","TO __stage06_output","BY HASH($120, $122, $123, $124)"]}],"writeRatioAvg":0.005509641873278237},{"readMsMax":"0","computeMsMax":"14","inputStages":["6"],"waitMsAvg":"1","id":"7","endMs":"1570904331968","waitMsMax":"1","startMs":"1570904331777","waitRatioMax":0.0009182736455463728,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2368","computeRatioAvg":0.012855831037649219,"writeMsAvg":"110","status":"COMPLETE","writeMsMax":"110","computeMsAvg":"14","shuffleOutputBytesSpilled":"0","writeRatioMax":0.10101010101010101,"readMsAvg":"0","waitRatioAvg":0.0009182736455463728,"completedParallelInputs":"1","computeRatioMax":0.012855831037649219,"name":"S07: Sort+","shuffleOutputBytes":"10033","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$123, $124, $125, $122, $121, $120, $60","FROM __stage06_output"]},{"kind":"SORT","substeps":["$40 ASC, $140 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$40 := subtract($146, $50)"]},{"kind":"FILTER","substeps":["greater(case_no_value(not_equal($50, 0), divide(abs(subtract($146, $50)), $50), NULL), 0.1)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$50 := AVG($136) OVER (PARTITION BY $135, $133, $130, $131 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)"]},{"kind":"SORT","substeps":["$120 ASC, $122 ASC, $123 ASC, $124 ASC"]},{"kind":"WRITE","substeps":["$150, $151, $152, $153, $154, $155, $156, $157, $158","TO __stage07_output"]}],"writeRatioAvg":0.10101010101010101},{"readMsMax":"0","computeMsMax":"7","inputStages":["7"],"waitMsAvg":"1","id":"8","endMs":"1570904332005","waitMsMax":"1","startMs":"1570904331797","waitRatioMax":0.0009182736455463728,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.006427915518824609,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004591368227731864,"readMsAvg":"0","waitRatioAvg":0.0009182736455463728,"completedParallelInputs":"1","computeRatioMax":0.006427915518824609,"name":"S08: Output","shuffleOutputBytes":"9133","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$150, $151, $152, $153, $154, $155, $156, $157, $158","FROM __stage07_output"]},{"kind":"SORT","substeps":["$156 ASC, $150 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$160, $161, $162, $163, $164, $165, $166, $167","TO __stage08_output"]}],"writeRatioAvg":0.004591368227731864}],"estimatedBytesProcessed":"91631879","timeline":[{"totalSlotMs":"301","activeUnits":"1","completedUnits":"3","elapsedMs":"608","pendingUnits":"1"},{"totalSlotMs":"2002","activeUnits":"1","completedUnits":"7","elapsedMs":"1664","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"92274688","totalPartitionsProcessed":"0","totalBytesProcessed":"91631879","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"}]},"endTime":"1570904332252"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query89_1570904329"},"etag":"2tML20JBFUmprqTWSNrbyg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query89_1570904329?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonda5380a15ebd935e2af23663469e352668c4a816","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query89\nSELECT benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup \nFROM (SELECT i_category, \n i_class, \n i_brand, \n s_store_name, \n s_company_name, \n d_moy, \n Sum(ss_sales_price) sum_sales, \n Avg(Sum(ss_sales_price)) \n OVER ( \n partition BY i_category, i_brand, s_store_name, s_company_name \n ) \n avg_monthly_sales \n FROM item, \n store_sales, \n date_dim, \n store \n WHERE ss_item_sk = i_item_sk \n AND ss_sold_date_sk = d_date_sk \n AND ss_store_sk = s_store_sk \n AND d_year IN ( 2002 ) \n AND ( ( i_category IN ( 'Home', 'Men', 'Sports' ) \n AND i_class IN ( 'paint', 'accessories', 'fitness' ) ) \n OR ( i_category IN ( 'Shoes', 'Jewelry', 'Women' ) \n AND i_class IN ( 'mens', 'pendants', 'swimwear' ) ) ) \n GROUP BY i_category, \n i_class, \n i_brand, \n s_store_name, \n s_company_name, \n d_moy) tmp1 \nWHERE CASE \n WHEN ( avg_monthly_sales <> 0 ) THEN ( \n Abs(sum_sales - avg_monthly_sales) / avg_monthly_sales ) \n ELSE NULL \n END > 0.1 \nORDER BY sum_sales - avg_monthly_sales, \n s_store_name\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query89_1570904329","user_email":"nithish.sankaranarayanan@ulb.be"}
