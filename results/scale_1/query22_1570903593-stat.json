{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"7811","creationTime":"1570903595890","totalBytesProcessed":"373461293","startTime":"1570903596072","query":{"totalSlotMs":"7811","queryPlan":[{"readMsMax":"5","computeMsMax":"9","waitMsAvg":"3","id":"0","endMs":"1570903596396","waitMsMax":"3","startMs":"1570903596237","waitRatioMax":0.0005645464809936018,"readRatioAvg":0.000940910801656003,"parallelInputs":"1","recordsRead":"5","computeRatioAvg":0.0016936394429808055,"writeMsAvg":"88","status":"COMPLETE","writeMsMax":"88","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.016560030109145654,"readMsAvg":"5","waitRatioAvg":0.0005645464809936018,"completedParallelInputs":"1","computeRatioMax":0.0016936394429808055,"name":"S00: Input","shuffleOutputBytes":"45","recordsWritten":"5","readRatioMax":0.000940910801656003,"steps":[{"kind":"READ","substeps":["$1:w_warehouse_sk","FROM warehouse"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.016560030109145654},{"readMsMax":"33","computeMsMax":"36","waitMsAvg":"23","id":"1","endMs":"1570903596408","waitMsMax":"23","startMs":"1570903596279","waitRatioMax":0.0043281896876176135,"readRatioAvg":0.0062100112909296195,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.006774557771923222,"writeMsAvg":"55","status":"COMPLETE","writeMsMax":"55","computeMsAvg":"36","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010350018818216034,"readMsAvg":"33","waitRatioAvg":0.0043281896876176135,"completedParallelInputs":"1","computeRatioMax":0.006774557771923222,"name":"S01: Input","shuffleOutputBytes":"1381383","recordsWritten":"18000","readRatioMax":0.0062100112909296195,"steps":[{"kind":"READ","substeps":["$10:i_item_sk, $11:i_brand, $12:i_class, $13:i_category, $14:i_product_name","FROM item"]},{"kind":"WRITE","substeps":["$10, $11, $12, $13, $14","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.010350018818216034},{"readMsMax":"8","computeMsMax":"7","waitMsAvg":"1","id":"2","endMs":"1570903596520","waitMsMax":"1","startMs":"1570903596340","waitRatioMax":0.0001881821603312006,"readRatioAvg":0.0015054572826496049,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0013172751223184042,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005080918328942416,"readMsAvg":"8","waitRatioAvg":0.0001881821603312006,"completedParallelInputs":"1","computeRatioMax":0.0013172751223184042,"name":"S02: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.0015054572826496049,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_month_seq","FROM date_dim","WHERE between($31, 1205, 1216)"]},{"kind":"WRITE","substeps":["$30","TO __stage02_output","BY HASH($30)"]}],"writeRatioAvg":0.005080918328942416},{"readMsMax":"24","computeMsMax":"5314","inputStages":["0","1","2"],"waitMsAvg":"1","id":"4","endMs":"1570903599204","waitMsMax":"1","startMs":"1570903596559","waitRatioMax":0.0001881821603312006,"readRatioAvg":0.004516371847948814,"parallelInputs":"1","recordsRead":"11763370","computeRatioAvg":1,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"5314","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003387278885961611,"readMsAvg":"24","waitRatioAvg":0.0001881821603312006,"completedParallelInputs":"1","computeRatioMax":1,"name":"S04: Join+","shuffleOutputBytes":"1015102","recordsWritten":"11999","readRatioMax":0.004516371847948814,"steps":[{"kind":"READ","substeps":["$20:inv_date_sk, $21:inv_item_sk, $22:inv_warehouse_sk, $23:inv_quantity_on_hand","FROM inventory"]},{"kind":"READ","substeps":["$30","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11, $12, $13, $14","FROM __stage01_output"]},{"kind":"READ","substeps":["$1","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $90 := $83, $91 := $80, $92 := $81, $93 := $82","$50 := SHARD_AVG($84)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $70 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $60 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $30"]},{"kind":"WRITE","substeps":["$91, $92, $93, $90, $50","TO __stage04_output","BY HASH($90, $91, $92, $93)"]}],"writeRatioAvg":0.003387278885961611},{"readMsMax":"0","computeMsMax":"26","inputStages":["4"],"waitMsAvg":"1","id":"5","endMs":"1570903601293","waitMsMax":"1","startMs":"1570903599635","waitRatioMax":0.0001881821603312006,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"11999","computeRatioAvg":0.004892736168611215,"writeMsAvg":"1637","status":"COMPLETE","writeMsMax":"1637","computeMsAvg":"26","shuffleOutputBytesSpilled":"0","writeRatioMax":0.3080541964621754,"readMsAvg":"0","waitRatioAvg":0.0001881821603312006,"completedParallelInputs":"1","computeRatioMax":0.004892736168611215,"name":"S05: Sort+","shuffleOutputBytes":"7630","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$91, $92, $93, $90, $50","FROM __stage04_output"]},{"kind":"SORT","substeps":["$40 ASC, $100 ASC, $101 ASC, $102 ASC, $103 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $100 := $90, $101 := $91, $102 := $92, $103 := $93","$40 := ROOT_AVG($50)"]},{"kind":"WRITE","substeps":["$110, $111, $112, $113, $114","TO __stage05_output"]}],"writeRatioAvg":0.3080541964621754},{"readMsMax":"0","computeMsMax":"6","inputStages":["5"],"waitMsAvg":"6","id":"6","endMs":"1570903601342","waitMsMax":"6","startMs":"1570903599717","waitRatioMax":0.0011290929619872036,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0011290929619872036,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0011290929619872036,"readMsAvg":"0","waitRatioAvg":0.0011290929619872036,"completedParallelInputs":"1","computeRatioMax":0.0011290929619872036,"name":"S06: Output","shuffleOutputBytes":"7630","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110, $111, $112, $113, $114","FROM __stage05_output"]},{"kind":"SORT","substeps":["$114 ASC, $113 ASC, $110 ASC, $111 ASC, $112 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$120, $121, $122, $123, $124","TO __stage06_output"]}],"writeRatioAvg":0.0011290929619872036}],"estimatedBytesProcessed":"373461293","timeline":[{"totalSlotMs":"581","activeUnits":"1","completedUnits":"3","elapsedMs":"667","pendingUnits":"1"},{"totalSlotMs":"6031","activeUnits":"2","completedUnits":"4","elapsedMs":"4147","pendingUnits":"2"},{"totalSlotMs":"7811","activeUnits":"2","completedUnits":"6","elapsedMs":"5734","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"374341632","totalPartitionsProcessed":"0","totalBytesProcessed":"373461293","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"warehouse","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"inventory","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"}]},"endTime":"1570903601850"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query22_1570903593"},"etag":"G3q/niXQdceUFM3WAF93ig==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query22_1570903593?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon9ed5cc45d1d2d7ae6a8a3427711ce6379bfd232c","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query22\nSELECT i_product_name, \n i_brand, \n i_class, \n i_category, \n Avg(inv_quantity_on_hand) qoh \nFROM inventory, \n date_dim, \n item, \n warehouse \nWHERE inv_date_sk = d_date_sk \n AND inv_item_sk = i_item_sk \n AND inv_warehouse_sk = w_warehouse_sk \n AND d_month_seq BETWEEN 1205 AND 1205 + 11 \nGROUP BY i_product_name, i_brand, i_class, i_category \nORDER BY qoh, \n i_product_name, \n i_brand, \n i_class, \n i_category\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query22_1570903593","user_email":"nithish.sankaranarayanan@ulb.be"}
