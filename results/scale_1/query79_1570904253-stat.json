{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"13022","creationTime":"1570904255204","totalBytesProcessed":"181405919","startTime":"1570904255315","query":{"totalSlotMs":"13022","queryPlan":[{"readMsMax":"23","computeMsMax":"9","waitMsAvg":"2","id":"0","endMs":"1570904255560","waitMsMax":"2","startMs":"1570904255503","waitRatioMax":0.0006240249609984399,"readRatioAvg":0.007176287051482059,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.0028081123244929796,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0024960998439937598,"readMsAvg":"23","waitRatioAvg":0.0006240249609984399,"completedParallelInputs":"1","computeRatioMax":0.0028081123244929796,"name":"S00: Input","shuffleOutputBytes":"6480","recordsWritten":"720","readRatioMax":0.007176287051482059,"steps":[{"kind":"READ","substeps":["$10:hd_demo_sk, $11:hd_dep_count, $12:hd_vehicle_count","FROM household_demographics","WHERE or(equal($11, 8), greater($12, 4))"]},{"kind":"WRITE","substeps":["$10","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.0024960998439937598},{"readMsMax":"49","computeMsMax":"5","waitMsAvg":"17","id":"1","endMs":"1570904255611","waitMsMax":"17","startMs":"1570904255544","waitRatioMax":0.005304212168486739,"readRatioAvg":0.015288611544461778,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.0015600624024961,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00187207488299532,"readMsAvg":"49","waitRatioAvg":0.005304212168486739,"completedParallelInputs":"1","computeRatioMax":0.0015600624024961,"name":"S01: Input","shuffleOutputBytes":"230","recordsWritten":"11","readRatioMax":0.015288611544461778,"steps":[{"kind":"READ","substeps":["$30:s_store_sk, $32:s_city, $31:s_number_employees","FROM store","WHERE between($31, 200, 295)"]},{"kind":"WRITE","substeps":["$30, $32","TO __stage01_output","BY HASH($30)"]}],"writeRatioAvg":0.00187207488299532},{"readMsMax":"26","computeMsMax":"8","waitMsAvg":"20","id":"2","endMs":"1570904255606","waitMsMax":"20","startMs":"1570904255560","waitRatioMax":0.0062402496099844,"readRatioAvg":0.008112324492979718,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0024960998439937598,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00187207488299532,"readMsAvg":"26","waitRatioAvg":0.0062402496099844,"completedParallelInputs":"1","computeRatioMax":0.0024960998439937598,"name":"S02: Input","shuffleOutputBytes":"1413","recordsWritten":"157","readRatioMax":0.008112324492979718,"steps":[{"kind":"READ","substeps":["$40:d_date_sk, $41:d_year, $42:d_dow","FROM date_dim","WHERE and(equal($42, 1), in($41, 2000, 2001, 2002))"]},{"kind":"WRITE","substeps":["$40","TO __stage02_output","BY HASH($40)"]}],"writeRatioAvg":0.00187207488299532},{"readMsMax":"49","computeMsMax":"3205","inputStages":["0","1","2"],"waitMsAvg":"1","id":"5","endMs":"1570904257602","waitMsMax":"1","startMs":"1570904255648","waitRatioMax":0.00031201248049921997,"readRatioAvg":0.015288611544461778,"parallelInputs":"1","recordsRead":"2882066","computeRatioAvg":1,"writeMsAvg":"14","status":"COMPLETE","writeMsMax":"14","computeMsAvg":"3205","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00436817472698908,"readMsAvg":"49","waitRatioAvg":0.00031201248049921997,"completedParallelInputs":"1","computeRatioMax":1,"name":"S05: Join+","shuffleOutputBytes":"105326","recordsWritten":"1914","readRatioMax":0.015288611544461778,"steps":[{"kind":"READ","substeps":["$20:ss_sold_date_sk, $21:ss_customer_sk, $22:ss_hdemo_sk, $23:ss_addr_sk, $24:ss_store_sk, $25:ss_ticket_number, $26:ss_coupon_amt, $27:ss_net_profit","FROM store_sales"]},{"kind":"READ","substeps":["$40","FROM __stage02_output"]},{"kind":"READ","substeps":["$30, $32","FROM __stage01_output"]},{"kind":"READ","substeps":["$10","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $120 := $112, $121 := $110, $122 := $111, $123 := $115","$70 := SUM($113)","$71 := SUM($114)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $91 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $83 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $40"]},{"kind":"WRITE","substeps":["$121, $122, $120, $123, $70, $71","TO __stage05_output","BY HASH($120, $121, $122, $123)"]}],"writeRatioAvg":0.00436817472698908},{"readMsMax":"0","computeMsMax":"10","inputStages":["5"],"waitMsAvg":"1","id":"7","endMs":"1570904258174","waitMsMax":"1","startMs":"1570904258095","waitRatioMax":0.00031201248049921997,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1914","computeRatioAvg":0.0031201248049922,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"12","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00374414976599064,"readMsAvg":"0","waitRatioAvg":0.00031201248049921997,"completedParallelInputs":"1","computeRatioMax":0.0031201248049922,"name":"S07: Aggregate","shuffleOutputBytes":"85069","recordsWritten":"1787","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$121, $122, $120, $123, $70, $71","FROM __stage05_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $130 := $120, $131 := $121, $132 := $122, $133 := $123","$60 := SUM($70)","$61 := SUM($71)"]},{"kind":"WRITE","substeps":["$60, $61, $130, $131, $133","TO __stage07_output","BY HASH($131)"]}],"writeRatioAvg":0.00374414976599064},{"readMsMax":"0","computeMsMax":"10","inputStages":["7"],"waitMsAvg":"1","id":"8","endMs":"1570904258335","waitMsMax":"3","startMs":"1570904258185","waitRatioMax":0.00093603744149766,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1787","computeRatioAvg":0.0015600624024961,"writeMsAvg":"57","status":"COMPLETE","writeMsMax":"81","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02527301092043682,"readMsAvg":"0","waitRatioAvg":0.00031201248049921997,"completedParallelInputs":"100","computeRatioMax":0.0031201248049922,"name":"S08: Coalesce","shuffleOutputBytes":"85069","recordsWritten":"1787","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage07_output"]}],"writeRatioAvg":0.017784711388455537},{"readMsMax":"9","computeMsMax":"40","inputStages":["8"],"waitMsAvg":"3","id":"9","endMs":"1570904258495","waitMsMax":"3","startMs":"1570904258188","waitRatioMax":0.00093603744149766,"readRatioAvg":0.0028081123244929796,"parallelInputs":"1","recordsRead":"101787","computeRatioAvg":0.0124804992199688,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"40","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00218408736349454,"readMsAvg":"9","waitRatioAvg":0.00093603744149766,"completedParallelInputs":"1","computeRatioMax":0.0124804992199688,"name":"S09: Join+","shuffleOutputBytes":"4992","recordsWritten":"100","readRatioMax":0.0028081123244929796,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_first_name, $3:c_last_name","FROM customer"]},{"kind":"READ","substeps":["$60, $61, $130, $131, $133","FROM __stage08_output"]},{"kind":"SORT","substeps":["$145 ASC, $144 ASC, $50 ASC, $143 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$50 := substr($141, 1, 30)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $131"]},{"kind":"WRITE","substeps":["$150, $151, $152, $153, $154, $155","TO __stage09_output"]}],"writeRatioAvg":0.00218408736349454},{"readMsMax":"0","computeMsMax":"6","inputStages":["9"],"waitMsAvg":"1","id":"10","endMs":"1570904258518","waitMsMax":"1","startMs":"1570904258235","waitRatioMax":0.00031201248049921997,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.00187207488299532,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00187207488299532,"readMsAvg":"0","waitRatioAvg":0.00031201248049921997,"completedParallelInputs":"1","computeRatioMax":0.00187207488299532,"name":"S0A: Output","shuffleOutputBytes":"4992","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$150, $151, $152, $153, $154, $155","FROM __stage09_output"]},{"kind":"SORT","substeps":["$151 ASC, $150 ASC, $153 ASC, $155 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$160, $161, $162, $163, $164, $165","TO __stage0A_output"]}],"writeRatioAvg":0.00187207488299532}],"estimatedBytesProcessed":"181405919","timeline":[{"totalSlotMs":"105","activeUnits":"1","completedUnits":"3","elapsedMs":"688","pendingUnits":"1"},{"totalSlotMs":"13022","activeUnits":"2","completedUnits":"107","elapsedMs":"3382","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"182452224","totalPartitionsProcessed":"0","totalBytesProcessed":"181405919","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"}]},"endTime":"1570904258720"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query79_1570904253"},"etag":"6mJ+8x9aBtCz9r9Od/3z3g==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query79_1570904253?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anone458949e7ab017e6bb249b437db6f842daac73b4","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query79\nSELECT c_last_name, \n c_first_name, \n Substr(s_city, 1, 30), \n ss_ticket_number, \n amt, \n profit \nFROM (SELECT ss_ticket_number, \n ss_customer_sk, \n store.s_city, \n Sum(ss_coupon_amt) amt, \n Sum(ss_net_profit) profit \n FROM store_sales, \n date_dim, \n store, \n household_demographics \n WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk \n AND store_sales.ss_store_sk = store.s_store_sk \n AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk \n AND ( household_demographics.hd_dep_count = 8 \n OR household_demographics.hd_vehicle_count > 4 ) \n AND date_dim.d_dow = 1 \n AND date_dim.d_year IN ( 2000, 2000 + 1, 2000 + 2 ) \n AND store.s_number_employees BETWEEN 200 AND 295 \n GROUP BY ss_ticket_number, \n ss_customer_sk, \n ss_addr_sk, \n store.s_city) ms, \n customer \nWHERE ss_customer_sk = c_customer_sk \nORDER BY c_last_name, \n c_first_name, \n Substr(s_city, 1, 30), \n profit\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query79_1570904253","user_email":"nithish.sankaranarayanan@ulb.be"}
