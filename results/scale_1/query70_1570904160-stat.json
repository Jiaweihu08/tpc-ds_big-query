{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"10857","creationTime":"1570904161510","totalBytesProcessed":"67206484","startTime":"1570904161632","query":{"totalSlotMs":"10857","queryPlan":[{"readMsMax":"11","computeMsMax":"7","waitMsAvg":"1","id":"0","endMs":"1570904162001","waitMsMax":"1","startMs":"1570904161793","waitRatioMax":0.001098901098901099,"readRatioAvg":0.012087912087912088,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.007692307692307693,"writeMsAvg":"187","status":"COMPLETE","writeMsMax":"187","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.20549450549450549,"readMsAvg":"11","waitRatioAvg":0.001098901098901099,"completedParallelInputs":"1","computeRatioMax":0.007692307692307693,"name":"S00: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.012087912087912088,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_month_seq","FROM date_dim","WHERE between($51, 1200, 1211)"]},{"kind":"WRITE","substeps":["$50","TO __stage00_output","BY HASH($50)"]}],"writeRatioAvg":0.20549450549450549},{"readMsMax":"28","computeMsMax":"8","waitMsAvg":"1","id":"1","endMs":"1570904161964","waitMsMax":"1","startMs":"1570904161866","waitRatioMax":0.001098901098901099,"readRatioAvg":0.03076923076923077,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.008791208791208791,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008791208791208791,"readMsAvg":"28","waitRatioAvg":0.001098901098901099,"completedParallelInputs":"1","computeRatioMax":0.008791208791208791,"name":"S01: Input","shuffleOutputBytes":"192","recordsWritten":"12","readRatioMax":0.03076923076923077,"steps":[{"kind":"READ","substeps":["$40:s_store_sk, $41:s_state","FROM store"]},{"kind":"WRITE","substeps":["$40, $41","TO __stage01_output","BY HASH($40)"]}],"writeRatioAvg":0.008791208791208791},{"readMsMax":"30","computeMsMax":"910","inputStages":["0","1"],"waitMsAvg":"1","id":"4","endMs":"1570904162587","waitMsMax":"1","startMs":"1570904162035","waitRatioMax":0.001098901098901099,"readRatioAvg":0.03296703296703297,"parallelInputs":"1","recordsRead":"2881556","computeRatioAvg":1,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"910","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004395604395604396,"readMsAvg":"30","waitRatioAvg":0.001098901098901099,"completedParallelInputs":"1","computeRatioMax":1,"name":"S04: Join+","shuffleOutputBytes":"16","recordsWritten":"1","readRatioMax":0.03296703296703297,"steps":[{"kind":"READ","substeps":["$30:ss_sold_date_sk, $31:ss_store_sk, $32:ss_net_profit","FROM store_sales"]},{"kind":"READ","substeps":["$40, $41","FROM __stage01_output"]},{"kind":"READ","substeps":["$50","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $160 := $151","$110 := SUM($150)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $140 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $31 = $40"]},{"kind":"WRITE","substeps":["$160, $110","TO __stage04_output","BY HASH($160)"]}],"writeRatioAvg":0.004395604395604396},{"readMsMax":"0","computeMsMax":"6","inputStages":["4"],"waitMsAvg":"1","id":"5","endMs":"1570904162853","waitMsMax":"1","startMs":"1570904162824","waitRatioMax":0.001098901098901099,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.006593406593406593,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008791208791208791,"readMsAvg":"0","waitRatioAvg":0.001098901098901099,"completedParallelInputs":"1","computeRatioMax":0.006593406593406593,"name":"S05: Aggregate","shuffleOutputBytes":"16","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$160, $110","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $170 := $160","$100 := SUM($110)"]},{"kind":"WRITE","substeps":["$170, $100","TO __stage05_output","BY HASH($170)"]}],"writeRatioAvg":0.008791208791208791},{"readMsMax":"0","computeMsMax":"6","inputStages":["5"],"waitMsAvg":"1","id":"6","endMs":"1570904163059","waitMsMax":"1","startMs":"1570904162936","waitRatioMax":0.001098901098901099,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.006593406593406593,"writeMsAvg":"108","status":"COMPLETE","writeMsMax":"108","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.11868131868131868,"readMsAvg":"0","waitRatioAvg":0.001098901098901099,"completedParallelInputs":"1","computeRatioMax":0.006593406593406593,"name":"S06: Sort+","shuffleOutputBytes":"7","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$170, $100","FROM __stage05_output"]},{"kind":"FILTER","substeps":["less_or_equal($90, 5)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$90 := RANK() OVER (PARTITION BY $180 ORDER BY $181 DESC)"]},{"kind":"SORT","substeps":["$170 ASC, $100 DESC"]},{"kind":"WRITE","substeps":["$190","TO __stage06_output","BY HASH($190)"]}],"writeRatioAvg":0.11868131868131868},{"readMsMax":"9","computeMsMax":"5","waitMsAvg":"1","id":"7","endMs":"1570904163173","waitMsMax":"1","startMs":"1570904162959","waitRatioMax":0.001098901098901099,"readRatioAvg":0.00989010989010989,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.005494505494505495,"writeMsAvg":"194","status":"COMPLETE","writeMsMax":"194","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.21318681318681318,"readMsAvg":"9","waitRatioAvg":0.001098901098901099,"completedParallelInputs":"1","computeRatioMax":0.005494505494505495,"name":"S07: Input","shuffleOutputBytes":"456","recordsWritten":"12","readRatioMax":0.00989010989010989,"steps":[{"kind":"READ","substeps":["$1:s_store_sk, $2:s_county, $3:s_state","FROM store"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage07_output","BY HASH($1)"]}],"writeRatioAvg":0.21318681318681318},{"readMsMax":"7","computeMsMax":"8","waitMsAvg":"6","id":"8","endMs":"1570904163124","waitMsMax":"6","startMs":"1570904163052","waitRatioMax":0.006593406593406593,"readRatioAvg":0.007692307692307693,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.008791208791208791,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006593406593406593,"readMsAvg":"7","waitRatioAvg":0.006593406593406593,"completedParallelInputs":"1","computeRatioMax":0.008791208791208791,"name":"S08: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.007692307692307693,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_month_seq","FROM date_dim","WHERE between($21, 1200, 1211)"]},{"kind":"WRITE","substeps":["$20","TO __stage08_output","BY HASH($20)"]}],"writeRatioAvg":0.006593406593406593},{"readMsMax":"0","computeMsMax":"9","inputStages":["6"],"waitMsAvg":"2","id":"11","endMs":"1570904163282","waitMsMax":"5","startMs":"1570904163181","waitRatioMax":0.005494505494505495,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1","computeRatioAvg":0.005494505494505495,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"52","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05714285714285714,"readMsAvg":"0","waitRatioAvg":0.002197802197802198,"completedParallelInputs":"100","computeRatioMax":0.00989010989010989,"name":"S0B: Coalesce","shuffleOutputBytes":"7","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage06_output"]}],"writeRatioAvg":0.02197802197802198},{"readMsMax":"36","computeMsMax":"812","inputStages":["11","7","8"],"waitMsAvg":"2","id":"12","endMs":"1570904163675","waitMsMax":"2","startMs":"1570904163207","waitRatioMax":0.002197802197802198,"readRatioAvg":0.03956043956043956,"parallelInputs":"1","recordsRead":"2881557","computeRatioAvg":0.8923076923076924,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"812","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006593406593406593,"readMsAvg":"36","waitRatioAvg":0.002197802197802198,"completedParallelInputs":"1","computeRatioMax":0.8923076923076924,"name":"S0C: Join+","shuffleOutputBytes":"38","recordsWritten":"1","readRatioMax":0.03956043956043956,"steps":[{"kind":"READ","substeps":["$10:ss_sold_date_sk, $11:ss_store_sk, $12:ss_net_profit","FROM store_sales"]},{"kind":"READ","substeps":["$20","FROM __stage08_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage07_output"]},{"kind":"READ","substeps":["$190","FROM __stage0B_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $210 := $201, $211 := $200","$80 := SUM($202)"]},{"kind":"JOIN","substeps":["SEMI HASH JOIN EACH WITH ALL ON $132 = $190"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $120 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $10 = $20"]},{"kind":"WRITE","substeps":["$211, $210, $80","TO __stage0C_output","BY HASH($210, $211)"]}],"writeRatioAvg":0.006593406593406593},{"readMsMax":"0","computeMsMax":"8","inputStages":["12"],"waitMsAvg":"1","id":"13","endMs":"1570904163903","waitMsMax":"1","startMs":"1570904163719","waitRatioMax":0.001098901098901099,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.008791208791208791,"writeMsAvg":"14","status":"COMPLETE","writeMsMax":"14","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.015384615384615385,"readMsAvg":"0","waitRatioAvg":0.001098901098901099,"completedParallelInputs":"1","computeRatioMax":0.008791208791208791,"name":"S0D: Aggregate","shuffleOutputBytes":"38","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$211, $210, $80","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $220 := $210, $221 := $211","$70 := SUM($80)"]},{"kind":"WRITE","substeps":["$221, $220, $70","TO __stage0D_output","BY HASH($220, $221)"]}],"writeRatioAvg":0.015384615384615385},{"readMsMax":"0","computeMsMax":"4","inputStages":["13"],"waitMsAvg":"1","id":"14","endMs":"1570904164067","waitMsMax":"1","startMs":"1570904163961","waitRatioMax":0.001098901098901099,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.004395604395604396,"writeMsAvg":"41","status":"COMPLETE","writeMsMax":"41","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.045054945054945054,"readMsAvg":"0","waitRatioAvg":0.001098901098901099,"completedParallelInputs":"1","computeRatioMax":0.004395604395604396,"name":"S0E: Sort+","shuffleOutputBytes":"47","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$221, $220, $70","FROM __stage0D_output"]},{"kind":"SORT","substeps":["$241 ASC, $60 ASC","LIMIT 100"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$60 := RANK() OVER (PARTITION BY $231, $230 ORDER BY $232 DESC)"]},{"kind":"SORT","substeps":["$220 ASC, $221 ASC, $70 DESC"]},{"kind":"WRITE","substeps":["$250, $251, $252, $253","TO __stage0E_output"]}],"writeRatioAvg":0.045054945054945054},{"readMsMax":"0","computeMsMax":"4","inputStages":["14"],"waitMsAvg":"0","id":"15","endMs":"1570904164175","waitMsMax":"0","startMs":"1570904164009","waitRatioMax":0,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.004395604395604396,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006593406593406593,"readMsAvg":"0","waitRatioAvg":0,"completedParallelInputs":"1","computeRatioMax":0.004395604395604396,"name":"S0F: Output","shuffleOutputBytes":"47","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$250, $251, $252, $253","FROM __stage0E_output"]},{"kind":"SORT","substeps":["$251 ASC, $252 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$260, $261, $262, $263","TO __stage0F_output"]}],"writeRatioAvg":0.006593406593406593}],"estimatedBytesProcessed":"67206484","timeline":[{"totalSlotMs":"203","activeUnits":"1","completedUnits":"2","elapsedMs":"661","pendingUnits":"1"},{"totalSlotMs":"9447","activeUnits":"3","completedUnits":"107","elapsedMs":"1993","pendingUnits":"1"},{"totalSlotMs":"10857","activeUnits":"0","completedUnits":"111","elapsedMs":"2721","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"68157440","totalPartitionsProcessed":"0","totalBytesProcessed":"67206484","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"}]},"endTime":"1570904164380"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query70_1570904160"},"etag":"MjIPC57VgmMGDhy0K95GSQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query70_1570904160?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon99f216e30817882f3bc99d2e9a5678b542f33d04","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query70\nSELECT Sum(ss_net_profit) AS total_sum, \n s_state, \n s_county, \n Rank() \n OVER ( \n PARTITION BY s_state, s_county\n ORDER BY Sum(ss_net_profit) DESC) AS rank_within_parent \nFROM store_sales, \n date_dim d1, \n store \nWHERE d1.d_month_seq BETWEEN 1200 AND 1200 + 11 \n AND d1.d_date_sk = ss_sold_date_sk \n AND s_store_sk = ss_store_sk \n AND s_state IN (SELECT s_state \n FROM (SELECT s_state AS \n s_state, \n Rank() \n OVER ( \n partition BY s_state \n ORDER BY Sum(ss_net_profit) DESC) AS \n ranking \n FROM store_sales, \n store, \n date_dim \n WHERE d_month_seq BETWEEN 1200 AND 1200 + 11 \n AND d_date_sk = ss_sold_date_sk \n AND s_store_sk = ss_store_sk \n GROUP BY s_state) tmp1 \n WHERE ranking <= 5) \nGROUP BY s_state, s_county \nORDER BY s_state, \n rank_within_parent\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query70_1570904160","user_email":"nithish.sankaranarayanan@ulb.be"}
