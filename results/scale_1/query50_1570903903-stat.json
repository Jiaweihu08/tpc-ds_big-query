{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"5992","creationTime":"1570903905843","totalBytesProcessed":"122950592","startTime":"1570903905993","query":{"totalSlotMs":"5992","queryPlan":[{"readMsMax":"10","computeMsMax":"8","waitMsAvg":"1","id":"0","endMs":"1570903906209","waitMsMax":"1","startMs":"1570903906153","waitRatioMax":0.0002591344908007256,"readRatioAvg":0.002591344908007256,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0020730759264058047,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005441824306815237,"readMsAvg":"10","waitRatioAvg":0.0002591344908007256,"completedParallelInputs":"1","computeRatioMax":0.0020730759264058047,"name":"S00: Input","shuffleOutputBytes":"270","recordsWritten":"30","readRatioMax":0.002591344908007256,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $11:d_year, $12:d_moy","FROM date_dim","WHERE and(equal($11, 2002), equal($12, 9))"]},{"kind":"WRITE","substeps":["$10","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.005441824306815237},{"readMsMax":"11","computeMsMax":"48","waitMsAvg":"22","id":"1","endMs":"1570903906268","waitMsMax":"22","startMs":"1570903906193","waitRatioMax":0.005700958797615963,"readRatioAvg":0.0028504793988079814,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.012438455558434827,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"48","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005700958797615963,"readMsAvg":"11","waitRatioAvg":0.005700958797615963,"completedParallelInputs":"1","computeRatioMax":0.012438455558434827,"name":"S01: Input","shuffleOutputBytes":"657441","recordsWritten":"73049","readRatioMax":0.0028504793988079814,"steps":[{"kind":"READ","substeps":["$1:d_date_sk","FROM date_dim"]},{"kind":"WRITE","substeps":["$1","TO __stage01_output","BY HASH($1)"]}],"writeRatioAvg":0.005700958797615963},{"readMsMax":"35","computeMsMax":"8","waitMsAvg":"23","id":"2","endMs":"1570903906269","waitMsMax":"23","startMs":"1570903906209","waitRatioMax":0.005960093288416689,"readRatioAvg":0.009069707178025395,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.0020730759264058047,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0015548069448043534,"readMsAvg":"35","waitRatioAvg":0.005960093288416689,"completedParallelInputs":"1","computeRatioMax":0.0020730759264058047,"name":"S02: Input","shuffleOutputBytes":"1460","recordsWritten":"12","readRatioMax":0.009069707178025395,"steps":[{"kind":"READ","substeps":["$20:s_store_sk, $21:s_store_name, $22:s_company_id, $23:s_street_number, $24:s_street_name, $25:s_street_type, $26:s_suite_number, $27:s_city, $28:s_county, $29:s_state, $30:s_zip","FROM store"]},{"kind":"WRITE","substeps":["$20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.0015548069448043534},{"readMsMax":"19","computeMsMax":"350","waitMsAvg":"37","id":"3","endMs":"1570903906648","waitMsMax":"37","startMs":"1570903906236","waitRatioMax":0.009587976159626846,"readRatioAvg":0.004923555325213786,"parallelInputs":"1","recordsRead":"288116","computeRatioAvg":0.09069707178025395,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"350","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005960093288416689,"readMsAvg":"19","waitRatioAvg":0.009587976159626846,"completedParallelInputs":"1","computeRatioMax":0.09069707178025395,"name":"S03: Input","shuffleOutputBytes":"9962884","recordsWritten":"277857","readRatioMax":0.004923555325213786,"steps":[{"kind":"READ","substeps":["$50:sr_returned_date_sk, $51:sr_item_sk, $52:sr_customer_sk, $53:sr_ticket_number","FROM store_returns"]},{"kind":"WRITE","substeps":["$50, $51, $52, $53","TO __stage03_output","BY HASH($53, $51, $52)"]}],"writeRatioAvg":0.005960093288416689},{"readMsMax":"34","computeMsMax":"3859","inputStages":["0","1","2","3"],"waitMsAvg":"6","id":"5","endMs":"1570903908714","waitMsMax":"6","startMs":"1570903906681","waitRatioMax":0.0015548069448043534,"readRatioAvg":0.00881057268722467,"parallelInputs":"1","recordsRead":"3232126","computeRatioAvg":1,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"3859","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0010365379632029023,"readMsAvg":"34","waitRatioAvg":0.0015548069448043534,"completedParallelInputs":"1","computeRatioMax":1,"name":"S05: Join+","shuffleOutputBytes":"943","recordsWritten":"6","readRatioMax":0.00881057268722467,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_item_sk, $42:ss_customer_sk, $43:ss_store_sk, $44:ss_ticket_number","FROM store_sales"]},{"kind":"READ","substeps":["$50, $51, $52, $53","FROM __stage03_output"]},{"kind":"READ","substeps":["$20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30","FROM __stage02_output"]},{"kind":"READ","substeps":["$1","FROM __stage01_output"]},{"kind":"READ","substeps":["$10","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $160 := $140, $161 := $141, $162 := $142, $163 := $143, $164 := $144, $165 := $145, $166 := $146, $167 := $147, $168 := $148, $169 := $149","$70 := SUM($84)","$71 := SUM($83)","$72 := SUM($82)","$73 := SUM($81)","$74 := SUM($80)"]},{"kind":"COMPUTE","substeps":["$80 := case_no_value(greater(subtract($151, $150), 120), 1, 0)","$81 := case_no_value(and(greater(subtract($151, $150), 90), less_or_equal(subtract($151, $150), 120)), 1, 0)","$82 := case_no_value(and(greater(subtract($151, $150), 60), less_or_equal(subtract($151, $150), 90)), 1, 0)","$83 := case_no_value(and(greater(subtract($151, $150), 30), less_or_equal(subtract($151, $150), 60)), 1, 0)","$84 := case_no_value(less_or_equal(subtract($151, $150), 30), 1, 0)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $131 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $100 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $91 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $44 = $53, $41 = $51, $42 = $52"]},{"kind":"WRITE","substeps":["$160, $161, $162, $163, $164, $165, $166, $167, $168, $169, $70, $71, $72, $73, $74","TO __stage05_output","BY HASH($160, $161, $162, $163, $164, $165, $166, $167, $168, $169)"]}],"writeRatioAvg":0.0010365379632029023},{"readMsMax":"0","computeMsMax":"4","inputStages":["5"],"waitMsAvg":"2","id":"6","endMs":"1570903908984","waitMsMax":"2","startMs":"1570903908970","waitRatioMax":0.0005182689816014512,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"6","computeRatioAvg":0.0010365379632029023,"writeMsAvg":"2","status":"COMPLETE","writeMsMax":"2","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0005182689816014512,"readMsAvg":"0","waitRatioAvg":0.0005182689816014512,"completedParallelInputs":"1","computeRatioMax":0.0010365379632029023,"name":"S06: Sort+","shuffleOutputBytes":"943","recordsWritten":"6","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$160, $161, $162, $163, $164, $165, $166, $167, $168, $169, $70, $71, $72, $73, $74","FROM __stage05_output"]},{"kind":"SORT","substeps":["$170 ASC, $171 ASC, $172 ASC, $173 ASC, $174 ASC, $175 ASC, $176 ASC, $177 ASC, $178 ASC, $179 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $170 := $160, $171 := $161, $172 := $162, $173 := $163, $174 := $164, $175 := $165, $176 := $166, $177 := $167, $178 := $168, $179 := $169","$60 := SUM($70)","$61 := SUM($71)","$62 := SUM($72)","$63 := SUM($73)","$64 := SUM($74)"]},{"kind":"WRITE","substeps":["$180, $181, $182, $183, $184, $185, $186, $187, $188, $189, $190, $191, $192, $193, $194","TO __stage06_output"]}],"writeRatioAvg":0.0005182689816014512},{"readMsMax":"0","computeMsMax":"5","inputStages":["6"],"waitMsAvg":"1","id":"7","endMs":"1570903909146","waitMsMax":"1","startMs":"1570903909082","waitRatioMax":0.0002591344908007256,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"6","computeRatioAvg":0.001295672454003628,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001813941435605079,"readMsAvg":"0","waitRatioAvg":0.0002591344908007256,"completedParallelInputs":"1","computeRatioMax":0.001295672454003628,"name":"S07: Output","shuffleOutputBytes":"943","recordsWritten":"6","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$180, $181, $182, $183, $184, $185, $186, $187, $188, $189, $190, $191, $192, $193, $194","FROM __stage06_output"]},{"kind":"SORT","substeps":["$180 ASC, $181 ASC, $182 ASC, $183 ASC, $184 ASC, $185 ASC, $186 ASC, $187 ASC, $188 ASC, $189 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$200, $201, $202, $203, $204, $205, $206, $207, $208, $209, $210, $211, $212, $213, $214","TO __stage07_output"]}],"writeRatioAvg":0.001813941435605079}],"estimatedBytesProcessed":"122950592","timeline":[{"totalSlotMs":"1362","activeUnits":"1","completedUnits":"4","elapsedMs":"660","pendingUnits":"1"},{"totalSlotMs":"2147","activeUnits":"1","completedUnits":"4","elapsedMs":"1190","pendingUnits":"1"},{"totalSlotMs":"5992","activeUnits":"1","completedUnits":"7","elapsedMs":"3307","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"123731968","totalPartitionsProcessed":"0","totalBytesProcessed":"122950592","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"}]},"endTime":"1570903909331"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query50_1570903903"},"etag":"V8/p9D5815Cf3X9dEkhWWQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query50_1570903903?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonc82e48ca906637537850a4b4d14d01b584f68459","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query50\nSELECT s_store_name, \n s_company_id, \n s_street_number, \n s_street_name, \n s_street_type, \n s_suite_number, \n s_city, \n s_county, \n s_state, \n s_zip, \n Sum(CASE \n WHEN ( sr_returned_date_sk - ss_sold_date_sk <= 30 ) THEN 1 \n ELSE 0 \n END) AS days_30, \n Sum(CASE \n WHEN ( sr_returned_date_sk - ss_sold_date_sk > 30 ) \n AND ( sr_returned_date_sk - ss_sold_date_sk <= 60 ) \n THEN 1 \n ELSE 0 \n END) AS days_31_60, \n Sum(CASE \n WHEN ( sr_returned_date_sk - ss_sold_date_sk > 60 ) \n AND ( sr_returned_date_sk - ss_sold_date_sk <= 90 ) \n THEN 1 \n ELSE 0 \n END) AS days_61_90, \n Sum(CASE \n WHEN ( sr_returned_date_sk - ss_sold_date_sk > 90 ) \n AND ( sr_returned_date_sk - ss_sold_date_sk <= 120 ) \n THEN 1 \n ELSE 0 \n END) AS days_91_120, \n Sum(CASE \n WHEN ( sr_returned_date_sk - ss_sold_date_sk > 120 ) THEN 1 \n ELSE 0 \n END) AS days_over_120 \nFROM store_sales, \n store_returns, \n store, \n date_dim d1, \n date_dim d2 \nWHERE d2.d_year = 2002 \n AND d2.d_moy = 9 \n AND ss_ticket_number = sr_ticket_number \n AND ss_item_sk = sr_item_sk \n AND ss_sold_date_sk = d1.d_date_sk \n AND sr_returned_date_sk = d2.d_date_sk \n AND ss_customer_sk = sr_customer_sk \n AND ss_store_sk = s_store_sk \nGROUP BY s_store_name, \n s_company_id, \n s_street_number, \n s_street_name, \n s_street_type, \n s_suite_number, \n s_city, \n s_county, \n s_state, \n s_zip \nORDER BY s_store_name, \n s_company_id, \n s_street_number, \n s_street_name, \n s_street_type, \n s_suite_number, \n s_city, \n s_county, \n s_state, \n s_zip\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query50_1570903903","user_email":"nithish.sankaranarayanan@ulb.be"}
