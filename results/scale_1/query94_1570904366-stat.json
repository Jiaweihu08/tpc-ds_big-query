{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"11846","creationTime":"1570904368046","totalBytesProcessed":"42987629","startTime":"1570904368246","query":{"totalSlotMs":"11846","queryPlan":[{"readMsMax":"18","computeMsMax":"56","waitMsAvg":"1","id":"0","endMs":"1570904368601","waitMsMax":"1","startMs":"1570904368423","waitRatioMax":0.0011961722488038277,"readRatioAvg":0.0215311004784689,"parallelInputs":"1","recordsRead":"72121","computeRatioAvg":0.06698564593301436,"writeMsAvg":"87","status":"COMPLETE","writeMsMax":"87","computeMsAvg":"56","shuffleOutputBytesSpilled":"0","writeRatioMax":0.10406698564593302,"readMsAvg":"18","waitRatioAvg":0.0011961722488038277,"completedParallelInputs":"1","computeRatioMax":0.06698564593301436,"name":"S00: Input","shuffleOutputBytes":"649089","recordsWritten":"72121","readRatioMax":0.0215311004784689,"steps":[{"kind":"READ","substeps":["$1:wr_order_number","FROM web_returns"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.10406698564593302},{"readMsMax":"20","computeMsMax":"647","waitMsAvg":"15","id":"1","endMs":"1570904369006","waitMsMax":"15","startMs":"1570904368464","waitRatioMax":0.017942583732057416,"readRatioAvg":0.023923444976076555,"parallelInputs":"1","recordsRead":"720759","computeRatioAvg":0.7739234449760766,"writeMsAvg":"194","status":"COMPLETE","writeMsMax":"194","computeMsAvg":"647","shuffleOutputBytesSpilled":"0","writeRatioMax":0.23205741626794257,"readMsAvg":"20","waitRatioAvg":0.017942583732057416,"completedParallelInputs":"1","computeRatioMax":0.7739234449760766,"name":"S01: Input","shuffleOutputBytes":"12972110","recordsWritten":"720759","readRatioMax":0.023923444976076555,"steps":[{"kind":"READ","substeps":["$10:ws_warehouse_sk, $11:ws_order_number","FROM web_sales"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage01_output","BY HASH($11)"]}],"writeRatioAvg":0.23205741626794257},{"readMsMax":"10","computeMsMax":"12","waitMsAvg":"1","id":"2","endMs":"1570904368653","waitMsMax":"1","startMs":"1570904368557","waitRatioMax":0.0011961722488038277,"readRatioAvg":0.011961722488038277,"parallelInputs":"1","recordsRead":"30","computeRatioAvg":0.014354066985645933,"writeMsAvg":"32","status":"COMPLETE","writeMsMax":"32","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03827751196172249,"readMsAvg":"10","waitRatioAvg":0.0011961722488038277,"completedParallelInputs":"1","computeRatioMax":0.014354066985645933,"name":"S02: Input","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.011961722488038277,"steps":[{"kind":"READ","substeps":["$20:web_site_sk, $21:web_company_name","FROM web_site","WHERE equal($21, 'pri')"]},{"kind":"WRITE","substeps":["$20","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.03827751196172249},{"readMsMax":"9","computeMsMax":"7","waitMsAvg":"17","id":"3","endMs":"1570904368683","waitMsMax":"17","startMs":"1570904368599","waitRatioMax":0.02033492822966507,"readRatioAvg":0.01076555023923445,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.008373205741626795,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.022727272727272728,"readMsAvg":"9","waitRatioAvg":0.02033492822966507,"completedParallelInputs":"1","computeRatioMax":0.008373205741626795,"name":"S03: Input","shuffleOutputBytes":"7839","recordsWritten":"871","readRatioMax":0.01076555023923445,"steps":[{"kind":"READ","substeps":["$40:ca_address_sk, $41:ca_state","FROM customer_address","WHERE equal($41, 'MT')"]},{"kind":"WRITE","substeps":["$40","TO __stage03_output","BY HASH($40)"]}],"writeRatioAvg":0.022727272727272728},{"readMsMax":"13","computeMsMax":"19","waitMsAvg":"40","id":"4","endMs":"1570904368726","waitMsMax":"40","startMs":"1570904368642","waitRatioMax":0.04784688995215311,"readRatioAvg":0.01555023923444976,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.022727272727272728,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008373205741626795,"readMsAvg":"13","waitRatioAvg":0.04784688995215311,"completedParallelInputs":"1","computeRatioMax":0.022727272727272728,"name":"S04: Input","shuffleOutputBytes":"558","recordsWritten":"62","readRatioMax":0.01555023923444976,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_date","FROM date_dim","WHERE between(CAST($51 AS DATE), 11017, 11078)"]},{"kind":"WRITE","substeps":["$50","TO __stage04_output","BY HASH($50)"]}],"writeRatioAvg":0.008373205741626795},{"readMsMax":"0","computeMsMax":"14","inputStages":["1"],"waitMsAvg":"2","id":"6","endMs":"1570904369217","waitMsMax":"5","startMs":"1570904369095","waitRatioMax":0.005980861244019139,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"720759","computeRatioAvg":0.01076555023923445,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"39","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04665071770334928,"readMsAvg":"0","waitRatioAvg":0.0023923444976076554,"completedParallelInputs":"100","computeRatioMax":0.01674641148325359,"name":"S06: Coalesce","shuffleOutputBytes":"12972110","recordsWritten":"720759","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage01_output"]}],"writeRatioAvg":0.03229665071770335},{"readMsMax":"60","computeMsMax":"836","inputStages":["0","6","2","3","4"],"waitMsAvg":"1","id":"7","endMs":"1570904369697","waitMsMax":"1","startMs":"1570904369123","waitRatioMax":0.0011961722488038277,"readRatioAvg":0.07177033492822966,"parallelInputs":"1","recordsRead":"1514573","computeRatioAvg":1,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"836","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004784688995215311,"readMsAvg":"60","waitRatioAvg":0.0011961722488038277,"completedParallelInputs":"1","computeRatioMax":1,"name":"S07: Join+","shuffleOutputBytes":"148","recordsWritten":"7","readRatioMax":0.07177033492822966,"steps":[{"kind":"READ","substeps":["$30:ws_ship_date_sk, $31:ws_ship_addr_sk, $32:ws_web_site_sk, $33:ws_warehouse_sk, $34:ws_order_number, $35:ws_ext_ship_cost, $36:ws_net_profit","FROM web_sales"]},{"kind":"READ","substeps":["$50","FROM __stage04_output"]},{"kind":"READ","substeps":["$40","FROM __stage03_output"]},{"kind":"READ","substeps":["$20","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage06_output"]},{"kind":"READ","substeps":["$1","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $170, $231 := $150","$140 := SUM($152)","$141 := SUM($151)"]},{"kind":"COMPUTE","substeps":["$150 := if(equal($170, 1), $220, NULL)","$151 := if(equal($170, 0), $222, NULL)","$152 := if(equal($170, 0), $221, NULL)"]},{"kind":"COMPUTE","substeps":["$160 := ARRAY<...>"]},{"kind":"JOIN","substeps":["ANTI HASH JOIN EACH WITH ALL ON $211 = $1"]},{"kind":"JOIN","substeps":["SEMI HASH JOIN EACH WITH ALL ON $201 = $11"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $190 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $180 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $30 = $50"]},{"kind":"WRITE","substeps":["$140, $141, $231, $230","TO __stage07_output","BY HASH($230, $231)"]}],"writeRatioAvg":0.004784688995215311},{"readMsMax":"0","computeMsMax":"5","inputStages":["7"],"waitMsAvg":"1","id":"8","endMs":"1570904369840","waitMsMax":"1","startMs":"1570904369820","waitRatioMax":0.0011961722488038277,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"7","computeRatioAvg":0.005980861244019139,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004784688995215311,"readMsAvg":"0","waitRatioAvg":0.0011961722488038277,"completedParallelInputs":"1","computeRatioMax":0.005980861244019139,"name":"S08: Aggregate+","shuffleOutputBytes":"56","recordsWritten":"2","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$140, $141, $231, $230","FROM __stage07_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $250 := $240","$110 := COUNT($122)","$111 := ANY_VALUE($121)","$112 := ANY_VALUE($120)"]},{"kind":"COMPUTE","substeps":["$120 := if(equal($240, 0), $131, NULL)","$121 := if(equal($240, 0), $130, NULL)","$122 := if(equal($240, 1), $241, NULL)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230, $241 := $231","$130 := SUM($140)","$131 := SUM($141)"]},{"kind":"WRITE","substeps":["$110, $111, $112, $250","TO __stage08_output","BY HASH($250)"]}],"writeRatioAvg":0.004784688995215311},{"readMsMax":"0","computeMsMax":"5","inputStages":["8"],"waitMsAvg":"2","id":"9","endMs":"1570904369895","waitMsMax":"2","startMs":"1570904369844","waitRatioMax":0.0023923444976076554,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2","computeRatioAvg":0.005980861244019139,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"28","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03349282296650718,"readMsAvg":"0","waitRatioAvg":0.0023923444976076554,"completedParallelInputs":"1","computeRatioMax":0.005980861244019139,"name":"S09: Aggregate+","shuffleOutputBytes":"27","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110, $111, $112, $250","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["$80 := ANY_VALUE($92)","$81 := ANY_VALUE($91)","$82 := ANY_VALUE($90)"]},{"kind":"COMPUTE","substeps":["$90 := if(equal($260, 0), $102, NULL)","$91 := if(equal($260, 0), $101, NULL)","$92 := if(equal($260, 1), $100, NULL)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $260 := $250","$100 := SUM_OF_COUNTS($110)","$101 := ANY_VALUE($111)","$102 := ANY_VALUE($112)"]},{"kind":"WRITE","substeps":["$80, $81, $82","TO __stage09_output"]}],"writeRatioAvg":0.03349282296650718},{"readMsMax":"0","computeMsMax":"5","inputStages":["9"],"waitMsAvg":"1","id":"10","endMs":"1570904369917","waitMsMax":"1","startMs":"1570904369864","waitRatioMax":0.0011961722488038277,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.005980861244019139,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007177033492822967,"readMsAvg":"0","waitRatioAvg":0.0011961722488038277,"completedParallelInputs":"1","computeRatioMax":0.005980861244019139,"name":"S0A: Output","shuffleOutputBytes":"27","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$80, $81, $82","FROM __stage09_output"]},{"kind":"SORT","substeps":["$60 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$60 := if(is_null($70), 0, $70)"]},{"kind":"AGGREGATE","substeps":["$70 := ANY_VALUE($80)","$71 := ANY_VALUE($81)","$72 := ANY_VALUE($82)"]},{"kind":"WRITE","substeps":["$270, $271, $272","TO __stage0A_output"]}],"writeRatioAvg":0.007177033492822967}],"estimatedBytesProcessed":"42987629","timeline":[{"totalSlotMs":"1155","activeUnits":"1","completedUnits":"4","elapsedMs":"679","pendingUnits":"1"},{"totalSlotMs":"11846","activeUnits":"1","completedUnits":"109","elapsedMs":"1824","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"52428800","totalPartitionsProcessed":"0","totalBytesProcessed":"42987629","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_site","datasetId":"scale_1"}]},"endTime":"1570904370108"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query94_1570904366"},"etag":"LyzfmkXxbNNYKwGDDphZQw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query94_1570904366?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon4b36e4188f3c3da0ea866343e06a68edf1957896","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query94\nSELECT \n Count(DISTINCT ws_order_number) AS order_count, \n Sum(ws_ext_ship_cost) AS total_shipping_cost , \n Sum(ws_net_profit) AS total_net_profit\nFROM web_sales ws1 , \n date_dim , \n customer_address , \n web_site \nWHERE Cast(d_date AS DATE) BETWEEN Cast('2000-3-01' AS DATE) AND ( \n Cast('2000-5-01' AS DATE)) \nAND ws1.ws_ship_date_sk = d_date_sk \nAND ws1.ws_ship_addr_sk = ca_address_sk \nAND ca_state = 'MT' \nAND ws1.ws_web_site_sk = web_site_sk \nAND web_company_name = 'pri' \nAND EXISTS \n ( \n SELECT benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup \n FROM web_sales ws2 \n WHERE ws1.ws_order_number = ws2.ws_order_number \n AND ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) \nAND NOT EXISTS \n ( \n SELECT benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup \n FROM web_returns wr1 \n WHERE ws1.ws_order_number = wr1.wr_order_number) \nORDER BY count(DISTINCT ws_order_number) \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query94_1570904366","user_email":"nithish.sankaranarayanan@ulb.be"}
