{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"49400","creationTime":"1570903861596","totalBytesProcessed":"91456239","startTime":"1570903861726","query":{"totalSlotMs":"49400","queryPlan":[{"readMsMax":"8","computeMsMax":"8","waitMsAvg":"50","id":"0","endMs":"1570903862085","waitMsMax":"50","startMs":"1570903862033","waitRatioMax":0.012051096649795132,"readRatioAvg":0.001928175463967221,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.001928175463967221,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004820438659918052,"readMsAvg":"8","waitRatioAvg":0.012051096649795132,"completedParallelInputs":"1","computeRatioMax":0.001928175463967221,"name":"S00: Input","shuffleOutputBytes":"357","recordsWritten":"12","readRatioMax":0.001928175463967221,"steps":[{"kind":"READ","substeps":["$80:s_store_sk, $81:s_store_name, $82:s_company_name","FROM store"]},{"kind":"WRITE","substeps":["$80, $81, $82","TO __stage00_output","BY HASH($80)"]}],"writeRatioAvg":0.004820438659918052},{"readMsMax":"9","computeMsMax":"16","waitMsAvg":"57","id":"1","endMs":"1570903862275","waitMsMax":"57","startMs":"1570903862060","waitRatioMax":0.01373825018076645,"readRatioAvg":0.0021691973969631237,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.003856350927934442,"writeMsAvg":"13","status":"COMPLETE","writeMsMax":"13","computeMsAvg":"16","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0031332851289467343,"readMsAvg":"9","waitRatioAvg":0.01373825018076645,"completedParallelInputs":"1","computeRatioMax":0.003856350927934442,"name":"S01: Input","shuffleOutputBytes":"11529","recordsWritten":"427","readRatioMax":0.0021691973969631237,"steps":[{"kind":"READ","substeps":["$110:d_date_sk, $111:d_year, $112:d_moy","FROM date_dim","WHERE or(equal($111, 1999), and(equal($111, 1998), equal($112, 12)), and(equal($111, 2000), equal($112, 1)))"]},{"kind":"WRITE","substeps":["$110, $111, $112","TO __stage01_output","BY HASH($110)"]}],"writeRatioAvg":0.0031332851289467343},{"readMsMax":"7","computeMsMax":"19","waitMsAvg":"40","id":"3","endMs":"1570903862252","waitMsMax":"40","startMs":"1570903862073","waitRatioMax":0.009640877319836105,"readRatioAvg":0.0016871535309713184,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.00457941672692215,"writeMsAvg":"156","status":"COMPLETE","writeMsMax":"156","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03759942154736081,"readMsAvg":"7","waitRatioAvg":0.009640877319836105,"completedParallelInputs":"1","computeRatioMax":0.00457941672692215,"name":"S03: Input","shuffleOutputBytes":"738172","recordsWritten":"18000","readRatioMax":0.0016871535309713184,"steps":[{"kind":"READ","substeps":["$90:i_item_sk, $91:i_brand, $92:i_category","FROM item"]},{"kind":"WRITE","substeps":["$90, $91, $92","TO __stage03_output","BY HASH($90)"]}],"writeRatioAvg":0.03759942154736081},{"readMsMax":"5","computeMsMax":"5","waitMsAvg":"36","id":"4","endMs":"1570903862272","waitMsMax":"36","startMs":"1570903862085","waitRatioMax":0.008676789587852495,"readRatioAvg":0.001205109664979513,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.001205109664979513,"writeMsAvg":"173","status":"COMPLETE","writeMsMax":"173","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04169679440829115,"readMsAvg":"5","waitRatioAvg":0.008676789587852495,"completedParallelInputs":"1","computeRatioMax":0.001205109664979513,"name":"S04: Input","shuffleOutputBytes":"357","recordsWritten":"12","readRatioMax":0.001205109664979513,"steps":[{"kind":"READ","substeps":["$10:s_store_sk, $11:s_store_name, $12:s_company_name","FROM store"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage04_output","BY HASH($10)"]}],"writeRatioAvg":0.04169679440829115},{"readMsMax":"9","computeMsMax":"16","waitMsAvg":"45","id":"5","endMs":"1570903862319","waitMsMax":"45","startMs":"1570903862114","waitRatioMax":0.010845986984815618,"readRatioAvg":0.0021691973969631237,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.003856350927934442,"writeMsAvg":"164","status":"COMPLETE","writeMsMax":"164","computeMsAvg":"16","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03952759701132803,"readMsAvg":"9","waitRatioAvg":0.010845986984815618,"completedParallelInputs":"1","computeRatioMax":0.003856350927934442,"name":"S05: Input","shuffleOutputBytes":"11529","recordsWritten":"427","readRatioMax":0.0021691973969631237,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_year, $72:d_moy","FROM date_dim","WHERE or(equal($71, 1999), and(equal($71, 1998), equal($72, 12)), and(equal($71, 2000), equal($72, 1)))"]},{"kind":"WRITE","substeps":["$70, $71, $72","TO __stage05_output","BY HASH($70)"]}],"writeRatioAvg":0.03952759701132803},{"readMsMax":"6","computeMsMax":"23","waitMsAvg":"1","id":"7","endMs":"1570903862283","waitMsMax":"1","startMs":"1570903862193","waitRatioMax":0.00024102193299590263,"readRatioAvg":0.0014461315979754157,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.00554350445890576,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"23","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00457941672692215,"readMsAvg":"6","waitRatioAvg":0.00024102193299590263,"completedParallelInputs":"1","computeRatioMax":0.00554350445890576,"name":"S07: Input","shuffleOutputBytes":"738172","recordsWritten":"18000","readRatioMax":0.0014461315979754157,"steps":[{"kind":"READ","substeps":["$50:i_item_sk, $51:i_brand, $52:i_category","FROM item"]},{"kind":"WRITE","substeps":["$50, $51, $52","TO __stage07_output","BY HASH($50)"]}],"writeRatioAvg":0.00457941672692215},{"readMsMax":"7","computeMsMax":"6","waitMsAvg":"2","id":"8","endMs":"1570903862261","waitMsMax":"2","startMs":"1570903862209","waitRatioMax":0.00048204386599180526,"readRatioAvg":0.0016871535309713184,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.0014461315979754157,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005302482525909858,"readMsAvg":"7","waitRatioAvg":0.00048204386599180526,"completedParallelInputs":"1","computeRatioMax":0.0014461315979754157,"name":"S08: Input","shuffleOutputBytes":"357","recordsWritten":"12","readRatioMax":0.0016871535309713184,"steps":[{"kind":"READ","substeps":["$1:s_store_sk, $2:s_store_name, $3:s_company_name","FROM store"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage08_output","BY HASH($1)"]}],"writeRatioAvg":0.005302482525909858},{"readMsMax":"64","computeMsMax":"20","waitMsAvg":"6","id":"9","endMs":"1570903862364","waitMsMax":"6","startMs":"1570903862231","waitRatioMax":0.0014461315979754157,"readRatioAvg":0.015425403711737768,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004820438659918052,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"20","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0014461315979754157,"readMsAvg":"64","waitRatioAvg":0.0014461315979754157,"completedParallelInputs":"1","computeRatioMax":0.004820438659918052,"name":"S09: Input","shuffleOutputBytes":"11529","recordsWritten":"427","readRatioMax":0.015425403711737768,"steps":[{"kind":"READ","substeps":["$40:d_date_sk, $41:d_year, $42:d_moy","FROM date_dim","WHERE or(equal($41, 1999), and(equal($41, 1998), equal($42, 12)), and(equal($41, 2000), equal($42, 1)))"]},{"kind":"WRITE","substeps":["$40, $41, $42","TO __stage09_output","BY HASH($40)"]}],"writeRatioAvg":0.0014461315979754157},{"readMsMax":"7","computeMsMax":"21","waitMsAvg":"3","id":"11","endMs":"1570903862465","waitMsMax":"3","startMs":"1570903862261","waitRatioMax":0.0007230657989877079,"readRatioAvg":0.0016871535309713184,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.005061460592913955,"writeMsAvg":"182","status":"COMPLETE","writeMsMax":"182","computeMsAvg":"21","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04386599180525428,"readMsAvg":"7","waitRatioAvg":0.0007230657989877079,"completedParallelInputs":"1","computeRatioMax":0.005061460592913955,"name":"S0B: Input","shuffleOutputBytes":"738172","recordsWritten":"18000","readRatioMax":0.0016871535309713184,"steps":[{"kind":"READ","substeps":["$20:i_item_sk, $21:i_brand, $22:i_category","FROM item"]},{"kind":"WRITE","substeps":["$20, $21, $22","TO __stage0B_output","BY HASH($20)"]}],"writeRatioAvg":0.04386599180525428},{"readMsMax":"39","computeMsMax":"3303","inputStages":["0","1","3"],"waitMsAvg":"7","id":"13","endMs":"1570903864438","waitMsMax":"7","startMs":"1570903862376","waitRatioMax":0.0016871535309713184,"readRatioAvg":0.009399855386840203,"parallelInputs":"1","recordsRead":"2899617","computeRatioAvg":0.7960954446854663,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"3303","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006507592190889371,"readMsAvg":"39","waitRatioAvg":0.0016871535309713184,"completedParallelInputs":"1","computeRatioMax":0.7960954446854663,"name":"S0D: Join+","shuffleOutputBytes":"5303838","recordsWritten":"65441","readRatioMax":0.009399855386840203,"steps":[{"kind":"READ","substeps":["$100:ss_sold_date_sk, $101:ss_item_sk, $102:ss_store_sk, $103:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$90, $91, $92","FROM __stage03_output"]},{"kind":"READ","substeps":["$110, $111, $112","FROM __stage01_output"]},{"kind":"READ","substeps":["$80, $81, $82","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $290 := $281, $291 := $280, $292 := $285, $293 := $286, $294 := $283, $295 := $284","$240 := SUM($282)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $272 = $80"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $252 = $110"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $101 = $90"]},{"kind":"WRITE","substeps":["$292, $293, $291, $290, $294, $295, $240","TO __stage0D_output","BY HASH($290, $291, $292, $293, $294, $295)"]}],"writeRatioAvg":0.006507592190889371},{"readMsMax":"45","computeMsMax":"4149","inputStages":["4","5","7"],"waitMsAvg":"9","id":"15","endMs":"1570903865049","waitMsMax":"9","startMs":"1570903862418","waitRatioMax":0.0021691973969631237,"readRatioAvg":0.010845986984815618,"parallelInputs":"1","recordsRead":"2899617","computeRatioAvg":1,"writeMsAvg":"32","status":"COMPLETE","writeMsMax":"32","computeMsAvg":"4149","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007712701855868884,"readMsAvg":"45","waitRatioAvg":0.0021691973969631237,"completedParallelInputs":"1","computeRatioMax":1,"name":"S0F: Join+","shuffleOutputBytes":"5303838","recordsWritten":"65441","readRatioMax":0.010845986984815618,"steps":[{"kind":"READ","substeps":["$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_store_sk, $63:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$50, $51, $52","FROM __stage07_output"]},{"kind":"READ","substeps":["$70, $71, $72","FROM __stage05_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $390 := $381, $391 := $380, $392 := $385, $393 := $386, $394 := $383, $395 := $384","$220 := SUM($382)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $372 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $352 = $70"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $61 = $50"]},{"kind":"WRITE","substeps":["$392, $393, $391, $390, $394, $395, $220","TO __stage0F_output","BY HASH($390, $391, $392, $393, $394, $395)"]}],"writeRatioAvg":0.007712701855868884},{"readMsMax":"29","computeMsMax":"3684","inputStages":["8","9","11"],"waitMsAvg":"32","id":"16","endMs":"1570903864444","waitMsMax":"32","startMs":"1570903862532","waitRatioMax":0.007712701855868884,"readRatioAvg":0.0069896360568811764,"parallelInputs":"1","recordsRead":"2899617","computeRatioAvg":0.8879248011569053,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"3684","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001928175463967221,"readMsAvg":"29","waitRatioAvg":0.007712701855868884,"completedParallelInputs":"1","computeRatioMax":0.8879248011569053,"name":"S10: Join+","shuffleOutputBytes":"5303838","recordsWritten":"65441","readRatioMax":0.0069896360568811764,"steps":[{"kind":"READ","substeps":["$30:ss_sold_date_sk, $31:ss_item_sk, $32:ss_store_sk, $33:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$20, $21, $22","FROM __stage0B_output"]},{"kind":"READ","substeps":["$40, $41, $42","FROM __stage09_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $480 := $471, $481 := $470, $482 := $475, $483 := $476, $484 := $473, $485 := $474","$210 := SUM($472)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $462 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $442 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $31 = $20"]},{"kind":"WRITE","substeps":["$482, $483, $481, $480, $484, $485, $210","TO __stage10_output","BY HASH($480, $481, $482, $483, $484, $485)"]}],"writeRatioAvg":0.001928175463967221},{"readMsMax":"0","computeMsMax":"261","inputStages":["13"],"waitMsAvg":"2","id":"17","endMs":"1570903865066","waitMsMax":"2","startMs":"1570903864885","waitRatioMax":0.00048204386599180526,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"65441","computeRatioAvg":0.06290672451193059,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"261","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005302482525909858,"readMsAvg":"0","waitRatioAvg":0.00048204386599180526,"completedParallelInputs":"1","computeRatioMax":0.06290672451193059,"name":"S11: Aggregate","shuffleOutputBytes":"5303838","recordsWritten":"65441","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$292, $293, $291, $290, $294, $295, $240","FROM __stage0D_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $300 := $290, $301 := $291, $302 := $292, $303 := $293, $304 := $294, $305 := $295","$230 := SUM($240)"]},{"kind":"WRITE","substeps":["$302, $303, $301, $300, $304, $305, $230","TO __stage11_output","BY HASH($300, $301, $302, $303, $304)"]}],"writeRatioAvg":0.005302482525909858},{"readMsMax":"0","computeMsMax":"224","inputStages":["16"],"waitMsAvg":"9","id":"18","endMs":"1570903865267","waitMsMax":"9","startMs":"1570903865099","waitRatioMax":0.0021691973969631237,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"65441","computeRatioAvg":0.05398891299108219,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"28","computeMsAvg":"224","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006748614123885274,"readMsAvg":"0","waitRatioAvg":0.0021691973969631237,"completedParallelInputs":"1","computeRatioMax":0.05398891299108219,"name":"S12: Aggregate","shuffleOutputBytes":"5303838","recordsWritten":"65441","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$482, $483, $481, $480, $484, $485, $210","FROM __stage10_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $490 := $480, $491 := $481, $492 := $482, $493 := $483, $494 := $484, $495 := $485","$180 := SUM($210)"]},{"kind":"WRITE","substeps":["$492, $493, $491, $490, $494, $495, $180","TO __stage12_output","BY HASH($490, $491, $492, $493)"]}],"writeRatioAvg":0.006748614123885274},{"readMsMax":"0","computeMsMax":"235","inputStages":["15"],"waitMsAvg":"2","id":"19","endMs":"1570903866701","waitMsMax":"2","startMs":"1570903865486","waitRatioMax":0.00048204386599180526,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"65441","computeRatioAvg":0.056640154254037116,"writeMsAvg":"1086","status":"COMPLETE","writeMsMax":"1086","computeMsAvg":"235","shuffleOutputBytesSpilled":"0","writeRatioMax":0.26174981923355023,"readMsAvg":"0","waitRatioAvg":0.00048204386599180526,"completedParallelInputs":"1","computeRatioMax":0.056640154254037116,"name":"S13: Aggregate","shuffleOutputBytes":"5303838","recordsWritten":"65441","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$392, $393, $391, $390, $394, $395, $220","FROM __stage0F_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $400 := $390, $401 := $391, $402 := $392, $403 := $393, $404 := $394, $405 := $395","$200 := SUM($220)"]},{"kind":"WRITE","substeps":["$402, $403, $401, $400, $404, $405, $200","TO __stage13_output","BY HASH($400, $401, $402, $403)"]}],"writeRatioAvg":0.26174981923355023},{"readMsMax":"0","computeMsMax":"420","inputStages":["17"],"waitMsAvg":"2","id":"20","endMs":"1570903865784","waitMsMax":"2","startMs":"1570903865519","waitRatioMax":0.00048204386599180526,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"65441","computeRatioAvg":0.1012292118582791,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"420","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004820438659918052,"readMsAvg":"0","waitRatioAvg":0.00048204386599180526,"completedParallelInputs":"1","computeRatioMax":0.1012292118582791,"name":"S14: Sort+","shuffleOutputBytes":"5892687","recordsWritten":"65441","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$302, $303, $301, $300, $304, $305, $230","FROM __stage11_output"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$190 := AVG($316) OVER (PARTITION BY $313, $312, $310, $311, $314 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)"]},{"kind":"SORT","substeps":["$300 ASC, $301 ASC, $302 ASC, $303 ASC, $304 ASC"]},{"kind":"WRITE","substeps":["$320, $321, $322, $323, $324, $325, $190, $326","TO __stage14_output","BY HASH($323, $322, $320, $321)"]}],"writeRatioAvg":0.004820438659918052},{"readMsMax":"0","computeMsMax":"510","inputStages":["18"],"waitMsAvg":"1","id":"21","endMs":"1570903867130","waitMsMax":"1","startMs":"1570903866826","waitRatioMax":0.00024102193299590263,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"65441","computeRatioAvg":0.12292118582791034,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"510","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005061460592913955,"readMsAvg":"0","waitRatioAvg":0.00024102193299590263,"completedParallelInputs":"1","computeRatioMax":0.12292118582791034,"name":"S15: Sort+","shuffleOutputBytes":"4662092","recordsWritten":"64528","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$492, $493, $491, $490, $494, $495, $180","FROM __stage12_output"]},{"kind":"COMPUTE","substeps":["$130 := subtract($150, 1)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$150 := RANK() OVER (PARTITION BY $503, $502, $500, $501 ORDER BY $504 ASC, $505 ASC)"]},{"kind":"SORT","substeps":["$490 ASC, $491 ASC, $492 ASC, $493 ASC, $494 ASC, $495 ASC"]},{"kind":"WRITE","substeps":["$130, $510, $511, $512, $513, $514","TO __stage15_output","BY HASH($513, $512, $510, $511, $130)"]}],"writeRatioAvg":0.005061460592913955},{"readMsMax":"0","computeMsMax":"253","inputStages":["20"],"waitMsAvg":"2","id":"23","endMs":"1570903867018","waitMsMax":"2","startMs":"1570903866860","waitRatioMax":0.00048204386599180526,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"65441","computeRatioAvg":0.06097854904796336,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"253","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004820438659918052,"readMsAvg":"0","waitRatioAvg":0.00048204386599180526,"completedParallelInputs":"1","computeRatioMax":0.06097854904796336,"name":"S17: Sort+","shuffleOutputBytes":"4962522","recordsWritten":"49993","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$320, $321, $322, $323, $324, $325, $190, $326","FROM __stage14_output"]},{"kind":"FILTER","substeps":["and(equal($344, 1999), greater($346, 0), ...)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$160 := RANK() OVER (PARTITION BY $333, $332, $330, $331 ORDER BY $334 ASC, $335 ASC)"]},{"kind":"SORT","substeps":["$323 ASC, $322 ASC, $320 ASC, $321 ASC, $324 ASC, $325 ASC"]},{"kind":"WRITE","substeps":["$160, $340, $341, $342, $343, $344, $345, $346, $347","TO __stage17_output","BY HASH($343, $342, $340, $341, $160)"]}],"writeRatioAvg":0.004820438659918052},{"readMsMax":"0","computeMsMax":"10","inputStages":["23"],"waitMsAvg":"4","id":"24","endMs":"1570903867180","waitMsMax":"6","startMs":"1570903867065","waitRatioMax":0.0014461315979754157,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"49993","computeRatioAvg":0.0014461315979754157,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"57","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01373825018076645,"readMsAvg":"0","waitRatioAvg":0.0009640877319836105,"completedParallelInputs":"100","computeRatioMax":0.002410219329959026,"name":"S18: Coalesce","shuffleOutputBytes":"4962522","recordsWritten":"49993","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage17_output"]}],"writeRatioAvg":0.006507592190889371},{"readMsMax":"0","computeMsMax":"8","inputStages":["21"],"waitMsAvg":"1","id":"26","endMs":"1570903867460","waitMsMax":"4","startMs":"1570903867224","waitRatioMax":0.0009640877319836105,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"64528","computeRatioAvg":0.001205109664979513,"writeMsAvg":"167","status":"COMPLETE","writeMsMax":"205","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04940949626416004,"readMsAvg":"0","waitRatioAvg":0.00024102193299590263,"completedParallelInputs":"100","computeRatioMax":0.001928175463967221,"name":"S1A: Coalesce","shuffleOutputBytes":"4662092","recordsWritten":"64528","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage15_output"]}],"writeRatioAvg":0.04025066281031574},{"readMsMax":"0","computeMsMax":"648","inputStages":["19","26","24"],"waitMsAvg":"4","id":"27","endMs":"1570903867878","waitMsMax":"4","startMs":"1570903867228","waitRatioMax":0.0009640877319836105,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"179962","computeRatioAvg":0.1561822125813449,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"648","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001205109664979513,"readMsAvg":"0","waitRatioAvg":0.0009640877319836105,"completedParallelInputs":"1","computeRatioMax":0.1561822125813449,"name":"S1B: Join+","shuffleOutputBytes":"7322","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$402, $403, $401, $400, $404, $405, $200","FROM __stage13_output"]},{"kind":"READ","substeps":["$160, $340, $341, $342, $343, $344, $345, $346, $347","FROM __stage18_output"]},{"kind":"READ","substeps":["$130, $510, $511, $512, $513, $514","FROM __stage1A_output"]},{"kind":"SORT","substeps":["$120 ASC, $522 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$120 := subtract($525, $523)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $433 = $513, $432 = $512, $430 = $510, $431 = $511, $436 = $130"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $423 = $343, $422 = $342, $420 = $340, $421 = $341, $140 = $160"]},{"kind":"COMPUTE","substeps":["$140 := add($170, 1)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$170 := RANK() OVER (PARTITION BY $413, $412, $410, $411 ORDER BY $414 ASC, $415 ASC)"]},{"kind":"SORT","substeps":["$400 ASC, $401 ASC, $402 ASC, $403 ASC, $404 ASC, $405 ASC"]},{"kind":"WRITE","substeps":["$530, $531, $532, $533, $534, $535, $536, $537","TO __stage1B_output"]}],"writeRatioAvg":0.001205109664979513},{"readMsMax":"0","computeMsMax":"6","inputStages":["27"],"waitMsAvg":"1","id":"28","endMs":"1570903868014","waitMsMax":"1","startMs":"1570903867320","waitRatioMax":0.00024102193299590263,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0014461315979754157,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0016871535309713184,"readMsAvg":"0","waitRatioAvg":0.00024102193299590263,"completedParallelInputs":"1","computeRatioMax":0.0014461315979754157,"name":"S1C: Output","shuffleOutputBytes":"6422","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$530, $531, $532, $533, $534, $535, $536, $537","FROM __stage1B_output"]},{"kind":"SORT","substeps":["$533 ASC, $532 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$540, $541, $542, $543, $544, $545, $546","TO __stage1C_output"]}],"writeRatioAvg":0.0016871535309713184}],"estimatedBytesProcessed":"91456239","timeline":[{"totalSlotMs":"2108","activeUnits":"3","completedUnits":"9","elapsedMs":"808","pendingUnits":"3"},{"totalSlotMs":"17657","activeUnits":"2","completedUnits":"14","elapsedMs":"3826","pendingUnits":"2"},{"totalSlotMs":"29172","activeUnits":"1","completedUnits":"118","elapsedMs":"5478","pendingUnits":"1"},{"totalSlotMs":"49400","activeUnits":"2","completedUnits":"220","elapsedMs":"6576","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"92274688","totalPartitionsProcessed":"0","totalBytesProcessed":"91456239","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"}]},"endTime":"1570903868329"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query47_1570903859"},"etag":"cwaC0+kH6knRog+tt0cjNA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query47_1570903859?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon08356a2eaf7450e09f39bc741bf057aa8974254c","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query47\nWITH v1 \n AS (SELECT i_category, \n i_brand, \n s_store_name, \n s_company_name, \n d_year, \n d_moy, \n Sum(ss_sales_price) sum_sales, \n Avg(Sum(ss_sales_price)) \n OVER ( \n partition BY i_category, i_brand, s_store_name, \n s_company_name, \n d_year) \n avg_monthly_sales, \n Rank() \n OVER ( \n partition BY i_category, i_brand, s_store_name, \n s_company_name \n ORDER BY d_year, d_moy) rn \n FROM item, \n store_sales, \n date_dim, \n store \n WHERE ss_item_sk = i_item_sk \n AND ss_sold_date_sk = d_date_sk \n AND ss_store_sk = s_store_sk \n AND ( d_year = 1999 \n OR ( d_year = 1999 - 1 \n AND d_moy = 12 ) \n OR ( d_year = 1999 + 1 \n AND d_moy = 1 ) ) \n GROUP BY i_category, \n i_brand, \n s_store_name, \n s_company_name, \n d_year, \n d_moy), \n v2 \n AS (SELECT v1.i_category, \n v1.d_year, \n v1.d_moy, \n v1.avg_monthly_sales, \n v1.sum_sales, \n v1_lag.sum_sales psum, \n v1_lead.sum_sales nsum \n FROM v1, \n v1 v1_lag, \n v1 v1_lead \n WHERE v1.i_category = v1_lag.i_category \n AND v1.i_category = v1_lead.i_category \n AND v1.i_brand = v1_lag.i_brand \n AND v1.i_brand = v1_lead.i_brand \n AND v1.s_store_name = v1_lag.s_store_name \n AND v1.s_store_name = v1_lead.s_store_name \n AND v1.s_company_name = v1_lag.s_company_name \n AND v1.s_company_name = v1_lead.s_company_name \n AND v1.rn = v1_lag.rn + 1 \n AND v1.rn = v1_lead.rn - 1) \nSELECT benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup \nFROM v2 \nWHERE d_year = 1999 \n AND avg_monthly_sales > 0 \n AND CASE \n WHEN avg_monthly_sales > 0 THEN Abs(sum_sales - avg_monthly_sales) \n / \n avg_monthly_sales \n ELSE NULL \n END > 0.1 \nORDER BY sum_sales - avg_monthly_sales, \n 3\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query47_1570903859","user_email":"nithish.sankaranarayanan@ulb.be"}
