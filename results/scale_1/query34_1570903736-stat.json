{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"23753","creationTime":"1570903738902","totalBytesProcessed":"116232282","startTime":"1570903739093","query":{"totalSlotMs":"23753","queryPlan":[{"readMsMax":"23","computeMsMax":"11","waitMsAvg":"1","id":"0","endMs":"1570903739445","waitMsMax":"1","startMs":"1570903739378","waitRatioMax":0.0006430868167202572,"readRatioAvg":0.014790996784565916,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.00707395498392283,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012218649517684888,"readMsAvg":"23","waitRatioAvg":0.0006430868167202572,"completedParallelInputs":"1","computeRatioMax":0.00707395498392283,"name":"S00: Input","shuffleOutputBytes":"4680","recordsWritten":"520","readRatioMax":0.014790996784565916,"steps":[{"kind":"READ","substeps":["$10:hd_demo_sk, $11:hd_buy_potential, $12:hd_dep_count, $13:hd_vehicle_count","FROM household_demographics","WHERE and(or(equal($11, '>10000'), equal($11, 'unknown')), greater($13, 0), ...)"]},{"kind":"WRITE","substeps":["$10","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.012218649517684888},{"readMsMax":"33","computeMsMax":"9","waitMsAvg":"14","id":"1","endMs":"1570903739550","waitMsMax":"14","startMs":"1570903739419","waitRatioMax":0.0090032154340836,"readRatioAvg":0.02122186495176849,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.005787781350482315,"writeMsAvg":"73","status":"COMPLETE","writeMsMax":"73","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04694533762057878,"readMsAvg":"33","waitRatioAvg":0.0090032154340836,"completedParallelInputs":"1","computeRatioMax":0.005787781350482315,"name":"S01: Input","shuffleOutputBytes":"108","recordsWritten":"12","readRatioMax":0.02122186495176849,"steps":[{"kind":"READ","substeps":["$30:s_store_sk, $31:s_county","FROM store","WHERE in($31, 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', ...)"]},{"kind":"WRITE","substeps":["$30","TO __stage01_output","BY HASH($30)"]}],"writeRatioAvg":0.04694533762057878},{"readMsMax":"12","computeMsMax":"8","waitMsAvg":"1","id":"2","endMs":"1570903739608","waitMsMax":"1","startMs":"1570903739489","waitRatioMax":0.0006430868167202572,"readRatioAvg":0.0077170418006430866,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.005144694533762058,"writeMsAvg":"41","status":"COMPLETE","writeMsMax":"41","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.026366559485530548,"readMsAvg":"12","waitRatioAvg":0.0006430868167202572,"completedParallelInputs":"1","computeRatioMax":0.005144694533762058,"name":"S02: Input","shuffleOutputBytes":"2268","recordsWritten":"252","readRatioMax":0.0077170418006430866,"steps":[{"kind":"READ","substeps":["$40:d_date_sk, $41:d_year, $42:d_dom","FROM date_dim","WHERE and(or(between($42, 1, 3), between($42, 25, 28)), in($41, 1999, 2000, 2001))"]},{"kind":"WRITE","substeps":["$40","TO __stage02_output","BY HASH($40)"]}],"writeRatioAvg":0.026366559485530548},{"readMsMax":"25","computeMsMax":"1555","inputStages":["0","1","2"],"waitMsAvg":"1","id":"4","endMs":"1570903741094","waitMsMax":"1","startMs":"1570903739699","waitRatioMax":0.0006430868167202572,"readRatioAvg":0.01607717041800643,"parallelInputs":"1","recordsRead":"2881962","computeRatioAvg":1,"writeMsAvg":"553","status":"COMPLETE","writeMsMax":"553","computeMsAvg":"1555","shuffleOutputBytesSpilled":"0","writeRatioMax":0.35562700964630223,"readMsAvg":"25","waitRatioAvg":0.0006430868167202572,"completedParallelInputs":"1","computeRatioMax":1,"name":"S04: Join+","shuffleOutputBytes":"67715","recordsWritten":"2553","readRatioMax":0.01607717041800643,"steps":[{"kind":"READ","substeps":["$20:ss_sold_date_sk, $21:ss_customer_sk, $22:ss_hdemo_sk, $23:ss_store_sk, $24:ss_ticket_number","FROM store_sales"]},{"kind":"READ","substeps":["$40","FROM __stage02_output"]},{"kind":"READ","substeps":["$30","FROM __stage01_output"]},{"kind":"READ","substeps":["$10","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $100 := $91, $101 := $90","$60 := COUNT_STAR()"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $81 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $72 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $40"]},{"kind":"WRITE","substeps":["$101, $100, $60","TO __stage04_output","BY HASH($100, $101)"]}],"writeRatioAvg":0.35562700964630223},{"readMsMax":"0","computeMsMax":"11","inputStages":["4"],"waitMsAvg":"1","id":"6","endMs":"1570903741594","waitMsMax":"1","startMs":"1570903741336","waitRatioMax":0.0006430868167202572,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2553","computeRatioAvg":0.00707395498392283,"writeMsAvg":"59","status":"COMPLETE","writeMsMax":"59","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.037942122186495175,"readMsAvg":"0","waitRatioAvg":0.0006430868167202572,"completedParallelInputs":"1","computeRatioMax":0.00707395498392283,"name":"S06: Aggregate+","shuffleOutputBytes":"6399","recordsWritten":"237","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$101, $100, $60","FROM __stage04_output"]},{"kind":"FILTER","substeps":["between($50, 15, 20)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $110 := $100, $111 := $101","$50 := SUM_OF_COUNTS($60)"]},{"kind":"WRITE","substeps":["$50, $110, $111","TO __stage06_output","BY HASH($111)"]}],"writeRatioAvg":0.037942122186495175},{"readMsMax":"0","computeMsMax":"9","inputStages":["6"],"waitMsAvg":"11","id":"7","endMs":"1570903741880","waitMsMax":"14","startMs":"1570903741641","waitRatioMax":0.0090032154340836,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"237","computeRatioAvg":0.002572347266881029,"writeMsAvg":"169","status":"COMPLETE","writeMsMax":"209","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.13440514469453377,"readMsAvg":"0","waitRatioAvg":0.00707395498392283,"completedParallelInputs":"100","computeRatioMax":0.005787781350482315,"name":"S07: Coalesce","shuffleOutputBytes":"6399","recordsWritten":"237","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage06_output"]}],"writeRatioAvg":0.10868167202572347},{"readMsMax":"9","computeMsMax":"37","inputStages":["7"],"waitMsAvg":"3","id":"8","endMs":"1570903741920","waitMsMax":"3","startMs":"1570903741715","waitRatioMax":0.0019292604501607716,"readRatioAvg":0.005787781350482315,"parallelInputs":"1","recordsRead":"100237","computeRatioAvg":0.023794212218649517,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"37","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0038585209003215433,"readMsAvg":"9","waitRatioAvg":0.0019292604501607716,"completedParallelInputs":"1","computeRatioMax":0.023794212218649517,"name":"S08: Join","shuffleOutputBytes":"12637","recordsWritten":"237","readRatioMax":0.005787781350482315,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_salutation, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag","FROM customer"]},{"kind":"READ","substeps":["$50, $110, $111","FROM __stage07_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $111"]},{"kind":"WRITE","substeps":["$122, $123, $124, $125, $120, $121","TO __stage08_output"]}],"writeRatioAvg":0.0038585209003215433},{"readMsMax":"0","computeMsMax":"5","inputStages":["8"],"waitMsAvg":"0","id":"9","endMs":"1570903742147","waitMsMax":"0","startMs":"1570903741953","waitRatioMax":0,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"237","computeRatioAvg":0.003215434083601286,"writeMsAvg":"184","status":"COMPLETE","writeMsMax":"184","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.11832797427652733,"readMsAvg":"0","waitRatioAvg":0,"completedParallelInputs":"1","computeRatioMax":0.003215434083601286,"name":"S09: Output","shuffleOutputBytes":"12637","recordsWritten":"237","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$122, $123, $124, $125, $120, $121","FROM __stage08_output"]},{"kind":"SORT","substeps":["$124 ASC, $123 ASC, $122 ASC, $125 DESC"]},{"kind":"WRITE","substeps":["$130, $131, $132, $133, $134, $135","TO __stage09_output"]}],"writeRatioAvg":0.11832797427652733}],"estimatedBytesProcessed":"116232282","timeline":[{"totalSlotMs":"404","activeUnits":"1","completedUnits":"3","elapsedMs":"786","pendingUnits":"1"},{"totalSlotMs":"23753","activeUnits":"1","completedUnits":"107","elapsedMs":"3318","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"116391936","totalPartitionsProcessed":"0","totalBytesProcessed":"116232282","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"}]},"endTime":"1570903742451"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query34_1570903736"},"etag":"YBTRLKUfXIq9Rkd7hpQFbw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query34_1570903736?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon698f84acaffe66b6652c21151d99a141312a4c19","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query34\nSELECT c_last_name, \n c_first_name, \n c_salutation, \n c_preferred_cust_flag, \n ss_ticket_number, \n cnt \nFROM (SELECT ss_ticket_number, \n ss_customer_sk, \n Count(*) cnt \n FROM store_sales, \n date_dim, \n store, \n household_demographics \n WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk \n AND store_sales.ss_store_sk = store.s_store_sk \n AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk \n AND ( date_dim.d_dom BETWEEN 1 AND 3 \n OR date_dim.d_dom BETWEEN 25 AND 28 ) \n AND ( household_demographics.hd_buy_potential = '>10000' \n OR household_demographics.hd_buy_potential = 'unknown' ) \n AND household_demographics.hd_vehicle_count > 0 \n AND ( CASE \n WHEN household_demographics.hd_vehicle_count > 0 THEN \n household_demographics.hd_dep_count / \n household_demographics.hd_vehicle_count \n ELSE NULL \n END ) > 1.2 \n AND date_dim.d_year IN ( 1999, 1999 + 1, 1999 + 2 ) \n AND store.s_county IN ( 'Williamson County', 'Williamson County', \n 'Williamson County', \n 'Williamson County' \n , \n 'Williamson County', 'Williamson County', \n 'Williamson County', \n 'Williamson County' \n ) \n GROUP BY ss_ticket_number, \n ss_customer_sk) dn, \n customer \nWHERE ss_customer_sk = c_customer_sk \n AND cnt BETWEEN 15 AND 20 \nORDER BY c_last_name, \n c_first_name, \n c_salutation, \n c_preferred_cust_flag DESC; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query34_1570903736","user_email":"nithish.sankaranarayanan@ulb.be"}
