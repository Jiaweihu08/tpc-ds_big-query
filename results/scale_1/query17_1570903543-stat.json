{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"47627","creationTime":"1570903545853","totalBytesProcessed":"194720975","startTime":"1570903546118","query":{"totalSlotMs":"47627","queryPlan":[{"readMsMax":"52","computeMsMax":"53","waitMsAvg":"1","id":"0","endMs":"1570903546672","waitMsMax":"1","startMs":"1570903546464","waitRatioMax":0.0001749475157452764,"readRatioAvg":0.009097270818754374,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.00927221833449965,"writeMsAvg":"75","status":"COMPLETE","writeMsMax":"75","computeMsAvg":"53","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013121063680895731,"readMsAvg":"52","waitRatioAvg":0.0001749475157452764,"completedParallelInputs":"1","computeRatioMax":0.00927221833449965,"name":"S00: Input","shuffleOutputBytes":"2418607","recordsWritten":"18000","readRatioMax":0.009097270818754374,"steps":[{"kind":"READ","substeps":["$1:i_item_sk, $2:i_item_id, $3:i_item_desc","FROM item"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.013121063680895731},{"readMsMax":"50","computeMsMax":"5","waitMsAvg":"17","id":"1","endMs":"1570903546581","waitMsMax":"17","startMs":"1570903546501","waitRatioMax":0.002974107767669699,"readRatioAvg":0.00874737578726382,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.0008747375787263821,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0010496850944716584,"readMsAvg":"50","waitRatioAvg":0.002974107767669699,"completedParallelInputs":"1","computeRatioMax":0.0008747375787263821,"name":"S01: Input","shuffleOutputBytes":"192","recordsWritten":"12","readRatioMax":0.00874737578726382,"steps":[{"kind":"READ","substeps":["$10:s_store_sk, $11:s_state","FROM store"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.0010496850944716584},{"readMsMax":"10","computeMsMax":"11","waitMsAvg":"29","id":"2","endMs":"1570903546645","waitMsMax":"29","startMs":"1570903546546","waitRatioMax":0.005073477956613016,"readRatioAvg":0.0017494751574527643,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0019244226731980406,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0047235829251224635,"readMsAvg":"10","waitRatioAvg":0.005073477956613016,"completedParallelInputs":"1","computeRatioMax":0.0019244226731980406,"name":"S02: Input","shuffleOutputBytes":"2466","recordsWritten":"274","readRatioMax":0.0017494751574527643,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_quarter_name","FROM date_dim","WHERE in($21, '1999Q1', '1999Q2', '1999Q3')"]},{"kind":"WRITE","substeps":["$20","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.0047235829251224635},{"readMsMax":"10","computeMsMax":"7","waitMsAvg":"34","id":"3","endMs":"1570903546719","waitMsMax":"34","startMs":"1570903546582","waitRatioMax":0.005948215535339398,"readRatioAvg":0.0017494751574527643,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.001224632610216935,"writeMsAvg":"66","status":"COMPLETE","writeMsMax":"66","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011546536039188244,"readMsAvg":"10","waitRatioAvg":0.005948215535339398,"completedParallelInputs":"1","computeRatioMax":0.001224632610216935,"name":"S03: Input","shuffleOutputBytes":"2466","recordsWritten":"274","readRatioMax":0.0017494751574527643,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_quarter_name","FROM date_dim","WHERE in($31, '1999Q1', '1999Q2', '1999Q3')"]},{"kind":"WRITE","substeps":["$30","TO __stage03_output","BY HASH($30)"]}],"writeRatioAvg":0.011546536039188244},{"readMsMax":"9","computeMsMax":"10","waitMsAvg":"16","id":"4","endMs":"1570903546684","waitMsMax":"16","startMs":"1570903546591","waitRatioMax":0.0027991602519244225,"readRatioAvg":0.0015745276417074878,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0017494751574527643,"writeMsAvg":"58","status":"COMPLETE","writeMsMax":"58","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010146955913226032,"readMsAvg":"9","waitRatioAvg":0.0027991602519244225,"completedParallelInputs":"1","computeRatioMax":0.0017494751574527643,"name":"S04: Input","shuffleOutputBytes":"819","recordsWritten":"91","readRatioMax":0.0015745276417074878,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_quarter_name","FROM date_dim","WHERE equal($51, '1999Q1')"]},{"kind":"WRITE","substeps":["$50","TO __stage04_output","BY HASH($50)"]}],"writeRatioAvg":0.010146955913226032},{"readMsMax":"35","computeMsMax":"2475","waitMsAvg":"1","id":"5","endMs":"1570903547869","waitMsMax":"1","startMs":"1570903546631","waitRatioMax":0.0001749475157452764,"readRatioAvg":0.006123163051084675,"parallelInputs":"1","recordsRead":"1437442","computeRatioAvg":0.4329951014695591,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"2475","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004198740377886634,"readMsAvg":"35","waitRatioAvg":0.0001749475157452764,"completedParallelInputs":"1","computeRatioMax":0.4329951014695591,"name":"S05: Input","shuffleOutputBytes":"51431876","recordsWritten":"1430285","readRatioMax":0.006123163051084675,"steps":[{"kind":"READ","substeps":["$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_quantity","FROM catalog_sales"]},{"kind":"WRITE","substeps":["$40, $41, $42, $43","TO __stage05_output","BY HASH($41, $42)"]}],"writeRatioAvg":0.004198740377886634},{"readMsMax":"106","computeMsMax":"534","waitMsAvg":"1","id":"6","endMs":"1570903547229","waitMsMax":"1","startMs":"1570903546663","waitRatioMax":0.0001749475157452764,"readRatioAvg":0.0185444366689993,"parallelInputs":"1","recordsRead":"288116","computeRatioAvg":0.0934219734079776,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"534","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0034989503149055285,"readMsAvg":"106","waitRatioAvg":0.0001749475157452764,"completedParallelInputs":"1","computeRatioMax":0.0934219734079776,"name":"S06: Input","shuffleOutputBytes":"12423245","recordsWritten":"277857","readRatioMax":0.0185444366689993,"steps":[{"kind":"READ","substeps":["$70:sr_returned_date_sk, $71:sr_item_sk, $72:sr_customer_sk, $73:sr_ticket_number, $74:sr_return_quantity","FROM store_returns"]},{"kind":"WRITE","substeps":["$70, $71, $72, $73, $74","TO __stage06_output","BY HASH($72, $71, $73)"]}],"writeRatioAvg":0.0034989503149055285},{"readMsMax":"0","computeMsMax":"25","inputStages":["5"],"waitMsAvg":"2","id":"9","endMs":"1570903548304","waitMsMax":"4","startMs":"1570903547884","waitRatioMax":0.0006997900629811056,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1430285","computeRatioAvg":0.002974107767669699,"writeMsAvg":"182","status":"COMPLETE","writeMsMax":"215","computeMsAvg":"17","shuffleOutputBytesSpilled":"0","writeRatioMax":0.037613715885234426,"readMsAvg":"0","waitRatioAvg":0.0003498950314905528,"completedParallelInputs":"100","computeRatioMax":0.00437368789363191,"name":"S09: Coalesce","shuffleOutputBytes":"51431876","recordsWritten":"1430285","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage05_output"]}],"writeRatioAvg":0.03184044786564031},{"readMsMax":"34","computeMsMax":"5716","inputStages":["0","1","2","3","4","9","6"],"waitMsAvg":"1","id":"10","endMs":"1570903551158","waitMsMax":"1","startMs":"1570903547999","waitRatioMax":0.0001749475157452764,"readRatioAvg":0.005948215535339398,"parallelInputs":"1","recordsRead":"4607971","computeRatioAvg":1,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"5716","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0008747375787263821,"readMsAvg":"34","waitRatioAvg":0.0001749475157452764,"completedParallelInputs":"1","computeRatioMax":1,"name":"S0A: Join+","shuffleOutputBytes":"732","recordsWritten":"2","readRatioMax":0.005948215535339398,"steps":[{"kind":"READ","substeps":["$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_customer_sk, $63:ss_store_sk, $64:ss_ticket_number, $65:ss_quantity","FROM store_sales"]},{"kind":"READ","substeps":["$70, $71, $72, $73, $74","FROM __stage06_output"]},{"kind":"READ","substeps":["$40, $41, $42, $43","FROM __stage09_output"]},{"kind":"READ","substeps":["$50","FROM __stage04_output"]},{"kind":"READ","substeps":["$30","FROM __stage03_output"]},{"kind":"READ","substeps":["$20","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage01_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $210 := $204, $211 := $205, $212 := $200","$100 := COUNT($202)","$101 := VAR_POP($110)","$102 := SHARD_AVG($202)","$103 := COUNT($203)","$104 := VAR_POP($111)","$105 := SHARD_AVG($203)","$106 := COUNT($201)","$107 := VAR_POP($112)","$108 := SHARD_AVG($201)"]},{"kind":"COMPUTE","substeps":["$110 := CAST($202 AS DOUBLE)","$111 := CAST($203 AS DOUBLE)","$112 := CAST($201 AS DOUBLE)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $191 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $182 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $170 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $155 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $130 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $126 = $41, $125 = $42"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $62 = $72, $61 = $71, $64 = $73"]},{"kind":"WRITE","substeps":["$210, $211, $212, $100, $101, $102, $103, $104, $105, $106, $107, $108","TO __stage0A_output","BY HASH($210, $211, $212)"]}],"writeRatioAvg":0.0008747375787263821},{"readMsMax":"0","computeMsMax":"3","inputStages":["10"],"waitMsAvg":"1","id":"11","endMs":"1570903551884","waitMsMax":"1","startMs":"1570903551871","waitRatioMax":0.0001749475157452764,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2","computeRatioAvg":0.0005248425472358292,"writeMsAvg":"2","status":"COMPLETE","writeMsMax":"2","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0003498950314905528,"readMsAvg":"0","waitRatioAvg":0.0001749475157452764,"completedParallelInputs":"1","computeRatioMax":0.0005248425472358292,"name":"S0B: Sort+","shuffleOutputBytes":"550","recordsWritten":"2","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$210, $211, $212, $100, $101, $102, $103, $104, $105, $106, $107, $108","FROM __stage0A_output"]},{"kind":"COMPUTE","substeps":["$80 := divide($234, $235)","$81 := divide($237, $238)","$82 := divide($240, $241)"]},{"kind":"SORT","substeps":["$220 ASC, $221 ASC, $222 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $220 := $210, $221 := $211, $222 := $212","$90 := SUM_OF_COUNTS($100)","$91 := ROOT_STDDEV_SAMP($101)","$92 := ROOT_AVG($102)","$93 := SUM_OF_COUNTS($103)","$94 := ROOT_STDDEV_SAMP($104)","$95 := ROOT_AVG($105)","$96 := SUM_OF_COUNTS($106)","$97 := ROOT_STDDEV_SAMP($107)","$98 := ROOT_AVG($108)"]},{"kind":"WRITE","substeps":["$230, $231, $232, $80, $81, $82, $233, $234, $235, $236, $237, $238, $239, $241","TO __stage0B_output"]}],"writeRatioAvg":0.0003498950314905528},{"readMsMax":"0","computeMsMax":"9","inputStages":["11"],"waitMsAvg":"1","id":"12","endMs":"1570903552098","waitMsMax":"1","startMs":"1570903552034","waitRatioMax":0.0001749475157452764,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2","computeRatioAvg":0.0015745276417074878,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001224632610216935,"readMsAvg":"0","waitRatioAvg":0.0001749475157452764,"completedParallelInputs":"1","computeRatioMax":0.0015745276417074878,"name":"S0C: Output","shuffleOutputBytes":"550","recordsWritten":"2","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$230, $231, $232, $80, $81, $82, $233, $234, $235, $236, $237, $238, $239, $241","FROM __stage0B_output"]},{"kind":"SORT","substeps":["$230 ASC, $231 ASC, $232 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $261, $262, $263","TO __stage0C_output"]}],"writeRatioAvg":0.001224632610216935}],"estimatedBytesProcessed":"194720975","timeline":[{"totalSlotMs":"972","activeUnits":"3","completedUnits":"5","elapsedMs":"849","pendingUnits":"3"},{"totalSlotMs":"39915","activeUnits":"2","completedUnits":"107","elapsedMs":"2254","pendingUnits":"1"},{"totalSlotMs":"47627","activeUnits":"0","completedUnits":"110","elapsedMs":"6197","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"195035136","totalPartitionsProcessed":"0","totalBytesProcessed":"194720975","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"}]},"endTime":"1570903552355"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query17_1570903543"},"etag":"/xxrsvXLLyKO0ozYuoCN3g==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query17_1570903543?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anone999a4b57a0abab27953e739ab9555c3e157b4c7","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query17\nSELECT i_item_id, \n i_item_desc, \n s_state, \n Count(ss_quantity) AS \n store_sales_quantitycount, \n Avg(ss_quantity) AS \n store_sales_quantityave, \n Stddev_samp(ss_quantity) AS \n store_sales_quantitystdev, \n Stddev_samp(ss_quantity) / Avg(ss_quantity) AS \n store_sales_quantitycov, \n Count(sr_return_quantity) AS \n store_returns_quantitycount, \n Avg(sr_return_quantity) AS \n store_returns_quantityave, \n Stddev_samp(sr_return_quantity) AS \n store_returns_quantitystdev, \n Stddev_samp(sr_return_quantity) / Avg(sr_return_quantity) AS \n store_returns_quantitycov, \n Count(cs_quantity) AS \n catalog_sales_quantitycount, \n Avg(cs_quantity) AS \n catalog_sales_quantityave, \n Stddev_samp(cs_quantity) / Avg(cs_quantity) AS \n catalog_sales_quantitystdev, \n Stddev_samp(cs_quantity) / Avg(cs_quantity) AS \n catalog_sales_quantitycov \nFROM store_sales, \n store_returns, \n catalog_sales, \n date_dim d1, \n date_dim d2, \n date_dim d3, \n store, \n item \nWHERE d1.d_quarter_name = '1999Q1' \n AND d1.d_date_sk = ss_sold_date_sk \n AND i_item_sk = ss_item_sk \n AND s_store_sk = ss_store_sk \n AND ss_customer_sk = sr_customer_sk \n AND ss_item_sk = sr_item_sk \n AND ss_ticket_number = sr_ticket_number \n AND sr_returned_date_sk = d2.d_date_sk \n AND d2.d_quarter_name IN ( '1999Q1', '1999Q2', '1999Q3' ) \n AND sr_customer_sk = cs_bill_customer_sk \n AND sr_item_sk = cs_item_sk \n AND cs_sold_date_sk = d3.d_date_sk \n AND d3.d_quarter_name IN ( '1999Q1', '1999Q2', '1999Q3' ) \nGROUP BY i_item_id, \n i_item_desc, \n s_state \nORDER BY i_item_id, \n i_item_desc, \n s_state\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query17_1570903543","user_email":"nithish.sankaranarayanan@ulb.be"}
