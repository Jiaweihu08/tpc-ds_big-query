{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"96370","creationTime":"1570904374176","totalBytesProcessed":"42987629","startTime":"1570904374309","query":{"totalSlotMs":"96370","queryPlan":[{"readMsMax":"12","computeMsMax":"49","waitMsAvg":"1","id":"0","endMs":"1570904374747","waitMsMax":"1","startMs":"1570904374518","waitRatioMax":0.00015862944162436547,"readRatioAvg":0.0019035532994923859,"parallelInputs":"1","recordsRead":"72121","computeRatioAvg":0.0077728426395939085,"writeMsAvg":"184","status":"COMPLETE","writeMsMax":"184","computeMsAvg":"49","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02918781725888325,"readMsAvg":"12","waitRatioAvg":0.00015862944162436547,"completedParallelInputs":"1","computeRatioMax":0.0077728426395939085,"name":"S00: Input","shuffleOutputBytes":"649089","recordsWritten":"72121","readRatioMax":0.0019035532994923859,"steps":[{"kind":"READ","substeps":["$1:wr_order_number","FROM web_returns"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.02918781725888325},{"readMsMax":"17","computeMsMax":"512","waitMsAvg":"1","id":"1","endMs":"1570904374986","waitMsMax":"1","startMs":"1570904374630","waitRatioMax":0.00015862944162436547,"readRatioAvg":0.002696700507614213,"parallelInputs":"1","recordsRead":"720759","computeRatioAvg":0.08121827411167512,"writeMsAvg":"91","status":"COMPLETE","writeMsMax":"91","computeMsAvg":"512","shuffleOutputBytesSpilled":"0","writeRatioMax":0.014435279187817259,"readMsAvg":"17","waitRatioAvg":0.00015862944162436547,"completedParallelInputs":"1","computeRatioMax":0.08121827411167512,"name":"S01: Input","shuffleOutputBytes":"12972110","recordsWritten":"720759","readRatioMax":0.002696700507614213,"steps":[{"kind":"READ","substeps":["$50:ws_warehouse_sk, $51:ws_order_number","FROM web_sales"]},{"kind":"WRITE","substeps":["$50, $51","TO __stage01_output","BY HASH($51)"]}],"writeRatioAvg":0.014435279187817259},{"readMsMax":"13","computeMsMax":"558","waitMsAvg":"38","id":"3","endMs":"1570904375030","waitMsMax":"38","startMs":"1570904374717","waitRatioMax":0.006027918781725888,"readRatioAvg":0.0020621827411167514,"parallelInputs":"1","recordsRead":"720759","computeRatioAvg":0.08851522842639593,"writeMsAvg":"43","status":"COMPLETE","writeMsMax":"43","computeMsAvg":"558","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006821065989847715,"readMsAvg":"13","waitRatioAvg":0.006027918781725888,"completedParallelInputs":"1","computeRatioMax":0.08851522842639593,"name":"S03: Input","shuffleOutputBytes":"12972110","recordsWritten":"720759","readRatioMax":0.0020621827411167514,"steps":[{"kind":"READ","substeps":["$30:ws_warehouse_sk, $31:ws_order_number","FROM web_sales"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage03_output","BY HASH($31)"]}],"writeRatioAvg":0.006821065989847715},{"readMsMax":"13","computeMsMax":"10","waitMsAvg":"35","id":"5","endMs":"1570904374946","waitMsMax":"35","startMs":"1570904374761","waitRatioMax":0.005552030456852792,"readRatioAvg":0.0020621827411167514,"parallelInputs":"1","recordsRead":"30","computeRatioAvg":0.0015862944162436548,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003331218274111675,"readMsAvg":"13","waitRatioAvg":0.005552030456852792,"completedParallelInputs":"1","computeRatioMax":0.0015862944162436548,"name":"S05: Input","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.0020621827411167514,"steps":[{"kind":"READ","substeps":["$10:web_site_sk, $11:web_company_name","FROM web_site","WHERE equal($11, 'pri')"]},{"kind":"WRITE","substeps":["$10","TO __stage05_output","BY HASH($10)"]}],"writeRatioAvg":0.003331218274111675},{"readMsMax":"12","computeMsMax":"16","waitMsAvg":"3","id":"6","endMs":"1570904375012","waitMsMax":"3","startMs":"1570904374763","waitRatioMax":0.00047588832487309646,"readRatioAvg":0.0019035532994923859,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.0025380710659898475,"writeMsAvg":"171","status":"COMPLETE","writeMsMax":"171","computeMsAvg":"16","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0271256345177665,"readMsAvg":"12","waitRatioAvg":0.00047588832487309646,"completedParallelInputs":"1","computeRatioMax":0.0025380710659898475,"name":"S06: Input","shuffleOutputBytes":"12969","recordsWritten":"1441","readRatioMax":0.0019035532994923859,"steps":[{"kind":"READ","substeps":["$70:ca_address_sk, $71:ca_state","FROM customer_address","WHERE equal($71, 'IN')"]},{"kind":"WRITE","substeps":["$70","TO __stage06_output","BY HASH($70)"]}],"writeRatioAvg":0.0271256345177665},{"readMsMax":"15","computeMsMax":"16","waitMsAvg":"1","id":"7","endMs":"1570904374966","waitMsMax":"1","startMs":"1570904374790","waitRatioMax":0.00015862944162436547,"readRatioAvg":0.0023794416243654824,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0025380710659898475,"writeMsAvg":"145","status":"COMPLETE","writeMsMax":"145","computeMsAvg":"16","shuffleOutputBytesSpilled":"0","writeRatioMax":0.023001269035532994,"readMsAvg":"15","waitRatioAvg":0.00015862944162436547,"completedParallelInputs":"1","computeRatioMax":0.0025380710659898475,"name":"S07: Input","shuffleOutputBytes":"558","recordsWritten":"62","readRatioMax":0.0023794416243654824,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_date","FROM date_dim","WHERE between(CAST($81 AS DATE), 11048, 11109)"]},{"kind":"WRITE","substeps":["$80","TO __stage07_output","BY HASH($80)"]}],"writeRatioAvg":0.023001269035532994},{"readMsMax":"0","computeMsMax":"14","inputStages":["1"],"waitMsAvg":"2","id":"10","endMs":"1570904375345","waitMsMax":"4","startMs":"1570904375048","waitRatioMax":0.0006345177664974619,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"720759","computeRatioAvg":0.0014276649746192893,"writeMsAvg":"77","status":"COMPLETE","writeMsMax":"186","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02950507614213198,"readMsAvg":"0","waitRatioAvg":0.00031725888324873094,"completedParallelInputs":"100","computeRatioMax":0.002220812182741117,"name":"S0A: Coalesce","shuffleOutputBytes":"12972110","recordsWritten":"720759","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage01_output"]}],"writeRatioAvg":0.012214467005076142},{"readMsMax":"11","computeMsMax":"6304","inputStages":["10","0"],"waitMsAvg":"2","id":"11","endMs":"1570904378910","waitMsMax":"2","startMs":"1570904375102","waitRatioMax":0.00031725888324873094,"readRatioAvg":0.0017449238578680203,"parallelInputs":"1","recordsRead":"1513639","computeRatioAvg":1,"writeMsAvg":"509","status":"COMPLETE","writeMsMax":"509","computeMsAvg":"6304","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08074238578680203,"readMsAvg":"11","waitRatioAvg":0.00031725888324873094,"completedParallelInputs":"1","computeRatioMax":1,"name":"S0B: Join+","shuffleOutputBytes":"78828678","recordsWritten":"8758742","readRatioMax":0.0017449238578680203,"steps":[{"kind":"READ","substeps":["$40:ws_warehouse_sk, $41:ws_order_number","FROM web_sales"]},{"kind":"READ","substeps":["$50, $51","FROM __stage0A_output"]},{"kind":"READ","substeps":["$1","FROM __stage00_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $261 = $1"]},{"kind":"FILTER","substeps":["not_equal($260, $262)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $41 = $51"]},{"kind":"WRITE","substeps":["$270","TO __stage0B_output","BY HASH($270)"]}],"writeRatioAvg":0.08074238578680203},{"readMsMax":"0","computeMsMax":"15","inputStages":["3"],"waitMsAvg":"5","id":"12","endMs":"1570904375373","waitMsMax":"7","startMs":"1570904375107","waitRatioMax":0.0011104060913705585,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"720759","computeRatioAvg":0.0014276649746192893,"writeMsAvg":"51","status":"COMPLETE","writeMsMax":"115","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01824238578680203,"readMsAvg":"0","waitRatioAvg":0.0007931472081218274,"completedParallelInputs":"100","computeRatioMax":0.0023794416243654824,"name":"S0C: Coalesce","shuffleOutputBytes":"12972110","recordsWritten":"720759","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage03_output"]}],"writeRatioAvg":0.00809010152284264},{"readMsMax":"13","computeMsMax":"5246","inputStages":["12"],"waitMsAvg":"1","id":"13","endMs":"1570904378103","waitMsMax":"1","startMs":"1570904375146","waitRatioMax":0.00015862944162436547,"readRatioAvg":0.0020621827411167514,"parallelInputs":"1","recordsRead":"1441518","computeRatioAvg":0.8321700507614214,"writeMsAvg":"374","status":"COMPLETE","writeMsMax":"374","computeMsAvg":"5246","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05932741116751269,"readMsAvg":"13","waitRatioAvg":0.00015862944162436547,"completedParallelInputs":"1","computeRatioMax":0.8321700507614214,"name":"S0D: Join+","shuffleOutputBytes":"60025896","recordsWritten":"6669544","readRatioMax":0.0020621827411167514,"steps":[{"kind":"READ","substeps":["$20:ws_warehouse_sk, $21:ws_order_number","FROM web_sales"]},{"kind":"READ","substeps":["$30, $31","FROM __stage0C_output"]},{"kind":"FILTER","substeps":["not_equal($240, $242)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $21 = $31"]},{"kind":"WRITE","substeps":["$241","TO __stage0D_output","BY HASH($241)"]}],"writeRatioAvg":0.05932741116751269},{"readMsMax":"0","computeMsMax":"44","inputStages":["13"],"waitMsAvg":"8","id":"14","endMs":"1570904378390","waitMsMax":"16","startMs":"1570904378106","waitRatioMax":0.0025380710659898475,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"6669544","computeRatioAvg":0.004600253807106599,"writeMsAvg":"52","status":"COMPLETE","writeMsMax":"73","computeMsAvg":"29","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01157994923857868,"readMsAvg":"0","waitRatioAvg":0.0012690355329949238,"completedParallelInputs":"100","computeRatioMax":0.006979695431472081,"name":"S0E: Coalesce","shuffleOutputBytes":"60025896","recordsWritten":"6669544","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0D_output"]}],"writeRatioAvg":0.008248730964467006},{"readMsMax":"30","computeMsMax":"921","inputStages":["14","5","6","7"],"waitMsAvg":"1","id":"15","endMs":"1570904379655","waitMsMax":"1","startMs":"1570904379066","waitRatioMax":0.00015862944162436547,"readRatioAvg":0.004758883248730965,"parallelInputs":"1","recordsRead":"7391807","computeRatioAvg":0.1460977157360406,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"921","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0006345177664974619,"readMsAvg":"30","waitRatioAvg":0.00015862944162436547,"completedParallelInputs":"1","computeRatioMax":0.1460977157360406,"name":"S0F: Join","shuffleOutputBytes":"729","recordsWritten":"27","readRatioMax":0.004758883248730965,"steps":[{"kind":"READ","substeps":["$60:ws_ship_date_sk, $61:ws_ship_addr_sk, $62:ws_web_site_sk, $63:ws_order_number, $64:ws_ext_ship_cost, $65:ws_net_profit","FROM web_sales"]},{"kind":"READ","substeps":["$80","FROM __stage07_output"]},{"kind":"READ","substeps":["$70","FROM __stage06_output"]},{"kind":"READ","substeps":["$10","FROM __stage05_output"]},{"kind":"READ","substeps":["$241","FROM __stage0E_output"]},{"kind":"JOIN","substeps":["SEMI HASH JOIN EACH WITH ALL ON $230 = $241"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $220 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $210 = $70"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $60 = $80"]},{"kind":"WRITE","substeps":["$250, $251, $252","TO __stage0F_output","BY HASH($250)"]}],"writeRatioAvg":0.0006345177664974619},{"readMsMax":"0","computeMsMax":"20","inputStages":["11","15"],"waitMsAvg":"2","id":"16","endMs":"1570904379945","waitMsMax":"6","startMs":"1570904379835","waitRatioMax":0.0009517766497461929,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2020147","computeRatioAvg":0.0014276649746192893,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"30","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004758883248730965,"readMsAvg":"0","waitRatioAvg":0.00031725888324873094,"completedParallelInputs":"100","computeRatioMax":0.0031725888324873096,"name":"S10: Join+","shuffleOutputBytes":"576","recordsWritten":"24","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$250, $251, $252","FROM __stage0F_output"]},{"kind":"READ","substeps":["$270","FROM __stage0B_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $290 := $200, $291 := $180","$170 := SUM($182)","$171 := SUM($181)"]},{"kind":"COMPUTE","substeps":["$180 := if(equal($200, 1), $280, NULL)","$181 := if(equal($200, 0), $282, NULL)","$182 := if(equal($200, 0), $281, NULL)"]},{"kind":"COMPUTE","substeps":["$190 := ARRAY<...>"]},{"kind":"JOIN","substeps":["SEMI HASH JOIN EACH WITH EACH ON $250 = $270"]},{"kind":"WRITE","substeps":["$170, $171, $291, $290","TO __stage10_output","BY HASH($290, $291)"]}],"writeRatioAvg":0.0015862944162436548},{"readMsMax":"0","computeMsMax":"8","inputStages":["16"],"waitMsAvg":"1","id":"17","endMs":"1570904380350","waitMsMax":"1","startMs":"1570904380118","waitRatioMax":0.00015862944162436547,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"24","computeRatioAvg":0.0012690355329949238,"writeMsAvg":"49","status":"COMPLETE","writeMsMax":"49","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0077728426395939085,"readMsAvg":"0","waitRatioAvg":0.00015862944162436547,"completedParallelInputs":"1","computeRatioMax":0.0012690355329949238,"name":"S11: Aggregate+","shuffleOutputBytes":"56","recordsWritten":"2","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$170, $171, $291, $290","FROM __stage10_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $310 := $300","$140 := COUNT($152)","$141 := ANY_VALUE($151)","$142 := ANY_VALUE($150)"]},{"kind":"COMPUTE","substeps":["$150 := if(equal($300, 0), $161, NULL)","$151 := if(equal($300, 0), $160, NULL)","$152 := if(equal($300, 1), $301, NULL)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $300 := $290, $301 := $291","$160 := SUM($170)","$161 := SUM($171)"]},{"kind":"WRITE","substeps":["$140, $141, $142, $310","TO __stage11_output","BY HASH($310)"]}],"writeRatioAvg":0.0077728426395939085},{"readMsMax":"0","computeMsMax":"5","inputStages":["17"],"waitMsAvg":"1","id":"18","endMs":"1570904380517","waitMsMax":"1","startMs":"1570904380370","waitRatioMax":0.00015862944162436547,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2","computeRatioAvg":0.0007931472081218274,"writeMsAvg":"86","status":"COMPLETE","writeMsMax":"86","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01364213197969543,"readMsAvg":"0","waitRatioAvg":0.00015862944162436547,"completedParallelInputs":"1","computeRatioMax":0.0007931472081218274,"name":"S12: Aggregate+","shuffleOutputBytes":"27","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$140, $141, $142, $310","FROM __stage11_output"]},{"kind":"AGGREGATE","substeps":["$110 := ANY_VALUE($122)","$111 := ANY_VALUE($121)","$112 := ANY_VALUE($120)"]},{"kind":"COMPUTE","substeps":["$120 := if(equal($320, 0), $132, NULL)","$121 := if(equal($320, 0), $131, NULL)","$122 := if(equal($320, 1), $130, NULL)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $320 := $310","$130 := SUM_OF_COUNTS($140)","$131 := ANY_VALUE($141)","$132 := ANY_VALUE($142)"]},{"kind":"WRITE","substeps":["$110, $111, $112","TO __stage12_output"]}],"writeRatioAvg":0.01364213197969543},{"readMsMax":"0","computeMsMax":"5","inputStages":["18"],"waitMsAvg":"2","id":"19","endMs":"1570904380549","waitMsMax":"2","startMs":"1570904380418","waitRatioMax":0.00031725888324873094,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.0007931472081218274,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007931472081218274,"readMsAvg":"0","waitRatioAvg":0.00031725888324873094,"completedParallelInputs":"1","computeRatioMax":0.0007931472081218274,"name":"S13: Output","shuffleOutputBytes":"27","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110, $111, $112","FROM __stage12_output"]},{"kind":"SORT","substeps":["$90 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$90 := if(is_null($100), 0, $100)"]},{"kind":"AGGREGATE","substeps":["$100 := ANY_VALUE($110)","$101 := ANY_VALUE($111)","$102 := ANY_VALUE($112)"]},{"kind":"WRITE","substeps":["$330, $331, $332","TO __stage13_output"]}],"writeRatioAvg":0.0007931472081218274}],"estimatedBytesProcessed":"42987629","timeline":[{"totalSlotMs":"2360","activeUnits":"4","completedUnits":"5","elapsedMs":"710","pendingUnits":"4"},{"totalSlotMs":"51852","activeUnits":"2","completedUnits":"206","elapsedMs":"1224","pendingUnits":"2"},{"totalSlotMs":"88991","activeUnits":"1","completedUnits":"308","elapsedMs":"5104","pendingUnits":"1"},{"totalSlotMs":"96370","activeUnits":"1","completedUnits":"412","elapsedMs":"6422","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"52428800","totalPartitionsProcessed":"0","totalBytesProcessed":"42987629","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_site","datasetId":"scale_1"}]},"endTime":"1570904380758"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query95_1570904372"},"etag":"TiJYjgS0q3OeK7dog9N7CA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query95_1570904372?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon0e566a99a2735675ebe94461c45641dc50de773d","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query95\nWITH ws_wh AS \n( \n SELECT ws1.ws_order_number, \n ws1.ws_warehouse_sk wh1, \n ws2.ws_warehouse_sk wh2 \n FROM web_sales ws1, \n web_sales ws2 \n WHERE ws1.ws_order_number = ws2.ws_order_number \n AND ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) \nSELECT \n Count(DISTINCT ws_order_number) AS order_count, \n Sum(ws_ext_ship_cost) AS total_shipping_cost, \n Sum(ws_net_profit) AS total_net_profit\nFROM web_sales ws1 , \n date_dim , \n customer_address , \n web_site \nWHERE Cast(d_date AS DATE) BETWEEN Cast('2000-4-01' AS DATE) AND ( \n Cast('2000-6-01' AS DATE)) \nAND ws1.ws_ship_date_sk = d_date_sk \nAND ws1.ws_ship_addr_sk = ca_address_sk \nAND ca_state = 'IN' \nAND ws1.ws_web_site_sk = web_site_sk \nAND web_company_name = 'pri' \nAND ws1.ws_order_number IN \n ( \n SELECT ws_order_number \n FROM ws_wh) \nAND ws1.ws_order_number IN \n ( \n SELECT wr_order_number \n FROM web_returns, \n ws_wh \n WHERE wr_order_number = ws_wh.ws_order_number) \nORDER BY count(DISTINCT ws_order_number) \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query95_1570904372","user_email":"nithish.sankaranarayanan@ulb.be"}
