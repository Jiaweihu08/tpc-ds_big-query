{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"40951","creationTime":"1570903706695","totalBytesProcessed":"16769817","startTime":"1570903706875","query":{"totalSlotMs":"40951","queryPlan":[{"readMsMax":"11","computeMsMax":"32","waitMsAvg":"1","id":"0","endMs":"1570903707290","waitMsMax":"1","startMs":"1570903707107","waitRatioMax":0.0048543689320388345,"readRatioAvg":0.05339805825242718,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.1553398058252427,"writeMsAvg":"148","status":"COMPLETE","writeMsMax":"148","computeMsAvg":"32","shuffleOutputBytesSpilled":"0","writeRatioMax":0.7184466019417476,"readMsAvg":"11","waitRatioAvg":0.0048543689320388345,"completedParallelInputs":"1","computeRatioMax":0.1553398058252427,"name":"S00: Input","shuffleOutputBytes":"791066","recordsWritten":"50000","readRatioMax":0.05339805825242718,"steps":[{"kind":"READ","substeps":["$60:ca_address_sk, $61:ca_state","FROM customer_address"]},{"kind":"WRITE","substeps":["$60, $61","TO __stage00_output","BY HASH($60)"]}],"writeRatioAvg":0.7184466019417476},{"readMsMax":"10","computeMsMax":"7","waitMsAvg":"1","id":"1","endMs":"1570903707266","waitMsMax":"1","startMs":"1570903707197","waitRatioMax":0.0048543689320388345,"readRatioAvg":0.04854368932038835,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.03398058252427184,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03398058252427184,"readMsAvg":"10","waitRatioAvg":0.0048543689320388345,"completedParallelInputs":"1","computeRatioMax":0.03398058252427184,"name":"S01: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.04854368932038835,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_year","FROM date_dim","WHERE equal($81, 2000)"]},{"kind":"WRITE","substeps":["$80","TO __stage01_output","BY HASH($80)"]}],"writeRatioAvg":0.03398058252427184},{"readMsMax":"9","computeMsMax":"42","waitMsAvg":"41","id":"3","endMs":"1570903707442","waitMsMax":"41","startMs":"1570903707266","waitRatioMax":0.19902912621359223,"readRatioAvg":0.043689320388349516,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.20388349514563106,"writeMsAvg":"91","status":"COMPLETE","writeMsMax":"91","computeMsAvg":"42","shuffleOutputBytesSpilled":"0","writeRatioMax":0.441747572815534,"readMsAvg":"9","waitRatioAvg":0.19902912621359223,"completedParallelInputs":"1","computeRatioMax":0.20388349514563106,"name":"S03: Input","shuffleOutputBytes":"791066","recordsWritten":"50000","readRatioMax":0.043689320388349516,"steps":[{"kind":"READ","substeps":["$30:ca_address_sk, $31:ca_state","FROM customer_address"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage03_output","BY HASH($30)"]}],"writeRatioAvg":0.441747572815534},{"readMsMax":"6","computeMsMax":"6","waitMsAvg":"40","id":"4","endMs":"1570903707477","waitMsMax":"40","startMs":"1570903707283","waitRatioMax":0.1941747572815534,"readRatioAvg":0.02912621359223301,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.02912621359223301,"writeMsAvg":"178","status":"COMPLETE","writeMsMax":"178","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.8640776699029126,"readMsAvg":"6","waitRatioAvg":0.1941747572815534,"completedParallelInputs":"1","computeRatioMax":0.02912621359223301,"name":"S04: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.02912621359223301,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year","FROM date_dim","WHERE equal($51, 2000)"]},{"kind":"WRITE","substeps":["$50","TO __stage04_output","BY HASH($50)"]}],"writeRatioAvg":0.8640776699029126},{"readMsMax":"18","computeMsMax":"69","inputStages":["0","1"],"waitMsAvg":"1","id":"7","endMs":"1570903707513","waitMsMax":"1","startMs":"1570903707404","waitRatioMax":0.0048543689320388345,"readRatioAvg":0.08737864077669903,"parallelInputs":"1","recordsRead":"122487","computeRatioAvg":0.33495145631067963,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"69","shuffleOutputBytesSpilled":"0","writeRatioMax":0.10194174757281553,"readMsAvg":"18","waitRatioAvg":0.0048543689320388345,"completedParallelInputs":"1","computeRatioMax":0.33495145631067963,"name":"S07: Join+","shuffleOutputBytes":"327152","recordsWritten":"13228","readRatioMax":0.08737864077669903,"steps":[{"kind":"READ","substeps":["$70:wr_returned_date_sk, $71:wr_returning_customer_sk, $72:wr_returning_addr_sk, $73:wr_return_amt","FROM web_returns"]},{"kind":"READ","substeps":["$80","FROM __stage01_output"]},{"kind":"READ","substeps":["$60, $61","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $250 := $240, $251 := $242","$140 := SUM($241)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $231 = $60"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $70 = $80"]},{"kind":"WRITE","substeps":["$251, $250, $140","TO __stage07_output","BY HASH($250, $251)"]}],"writeRatioAvg":0.10194174757281553},{"readMsMax":"15","computeMsMax":"70","inputStages":["3","4"],"waitMsAvg":"2","id":"8","endMs":"1570903707675","waitMsMax":"2","startMs":"1570903707583","waitRatioMax":0.009708737864077669,"readRatioAvg":0.07281553398058252,"parallelInputs":"1","recordsRead":"122487","computeRatioAvg":0.33980582524271846,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"70","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08737864077669903,"readMsAvg":"15","waitRatioAvg":0.009708737864077669,"completedParallelInputs":"1","computeRatioMax":0.33980582524271846,"name":"S08: Join+","shuffleOutputBytes":"327152","recordsWritten":"13228","readRatioMax":0.07281553398058252,"steps":[{"kind":"READ","substeps":["$40:wr_returned_date_sk, $41:wr_returning_customer_sk, $42:wr_returning_addr_sk, $43:wr_return_amt","FROM web_returns"]},{"kind":"READ","substeps":["$50","FROM __stage04_output"]},{"kind":"READ","substeps":["$30, $31","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $180, $191 := $182","$120 := SUM($181)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $171 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $50"]},{"kind":"WRITE","substeps":["$191, $190, $120","TO __stage08_output","BY HASH($190, $191)"]}],"writeRatioAvg":0.08737864077669903},{"readMsMax":"0","computeMsMax":"16","inputStages":["7"],"waitMsAvg":"1","id":"9","endMs":"1570903707865","waitMsMax":"1","startMs":"1570903707616","waitRatioMax":0.0048543689320388345,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"13228","computeRatioAvg":0.07766990291262135,"writeMsAvg":"42","status":"COMPLETE","writeMsMax":"42","computeMsAvg":"16","shuffleOutputBytesSpilled":"0","writeRatioMax":0.20388349514563106,"readMsAvg":"0","waitRatioAvg":0.0048543689320388345,"completedParallelInputs":"1","computeRatioMax":0.07766990291262135,"name":"S09: Aggregate","shuffleOutputBytes":"1226","recordsWritten":"52","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$251, $250, $140","FROM __stage07_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $270 := $261","$110 := SHARD_AVG($130)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $260 := $250, $261 := $251","$130 := SUM($140)"]},{"kind":"WRITE","substeps":["$270, $110","TO __stage09_output","BY HASH($270)"]}],"writeRatioAvg":0.20388349514563106},{"readMsMax":"0","computeMsMax":"8","inputStages":["9"],"waitMsAvg":"1","id":"10","endMs":"1570903708137","waitMsMax":"1","startMs":"1570903707932","waitRatioMax":0.0048543689320388345,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"52","computeRatioAvg":0.038834951456310676,"writeMsAvg":"184","status":"COMPLETE","writeMsMax":"184","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.8932038834951457,"readMsAvg":"0","waitRatioAvg":0.0048543689320388345,"completedParallelInputs":"1","computeRatioMax":0.038834951456310676,"name":"S0A: Aggregate","shuffleOutputBytes":"816","recordsWritten":"51","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$270, $110","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $280 := $270","$90 := ROOT_AVG($110)"]},{"kind":"WRITE","substeps":["$90, $280","TO __stage0A_output","BY HASH($280)"]}],"writeRatioAvg":0.8932038834951457},{"readMsMax":"0","computeMsMax":"35","inputStages":["8"],"waitMsAvg":"1","id":"11","endMs":"1570903708129","waitMsMax":"1","startMs":"1570903707979","waitRatioMax":0.0048543689320388345,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"13228","computeRatioAvg":0.16990291262135923,"writeMsAvg":"62","status":"COMPLETE","writeMsMax":"62","computeMsAvg":"35","shuffleOutputBytesSpilled":"0","writeRatioMax":0.30097087378640774,"readMsAvg":"0","waitRatioAvg":0.0048543689320388345,"completedParallelInputs":"1","computeRatioMax":0.16990291262135923,"name":"S0B: Aggregate","shuffleOutputBytes":"326499","recordsWritten":"13185","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$191, $190, $120","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $200 := $190, $201 := $191","$100 := SUM($120)"]},{"kind":"WRITE","substeps":["$100, $200, $201","TO __stage0B_output","BY HASH($200)"]}],"writeRatioAvg":0.30097087378640774},{"readMsMax":"6","computeMsMax":"6","waitMsAvg":"1","id":"12","endMs":"1570903708177","waitMsMax":"1","startMs":"1570903708008","waitRatioMax":0.0048543689320388345,"readRatioAvg":0.02912621359223301,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.02912621359223301,"writeMsAvg":"153","status":"COMPLETE","writeMsMax":"153","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.7427184466019418,"readMsAvg":"6","waitRatioAvg":0.0048543689320388345,"completedParallelInputs":"1","computeRatioMax":0.02912621359223301,"name":"S0C: Input","shuffleOutputBytes":"12969","recordsWritten":"1441","readRatioMax":0.02912621359223301,"steps":[{"kind":"READ","substeps":["$20:ca_address_sk, $21:ca_state","FROM customer_address","WHERE equal($21, 'IN')"]},{"kind":"WRITE","substeps":["$20","TO __stage0C_output","BY HASH($20)"]}],"writeRatioAvg":0.7427184466019418},{"readMsMax":"0","computeMsMax":"8","inputStages":["11"],"waitMsAvg":"1","id":"14","endMs":"1570903708431","waitMsMax":"4","startMs":"1570903708183","waitRatioMax":0.019417475728155338,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"13185","computeRatioAvg":0.019417475728155338,"writeMsAvg":"161","status":"COMPLETE","writeMsMax":"206","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":1,"readMsAvg":"0","waitRatioAvg":0.0048543689320388345,"completedParallelInputs":"100","computeRatioMax":0.038834951456310676,"name":"S0E: Coalesce","shuffleOutputBytes":"326499","recordsWritten":"13185","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0B_output"]}],"writeRatioAvg":0.7815533980582524},{"readMsMax":"0","computeMsMax":"7","inputStages":["10"],"waitMsAvg":"3","id":"15","endMs":"1570903708405","waitMsMax":"7","startMs":"1570903708183","waitRatioMax":0.03398058252427184,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"51","computeRatioAvg":0.014563106796116505,"writeMsAvg":"170","status":"COMPLETE","writeMsMax":"199","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.9660194174757282,"readMsAvg":"0","waitRatioAvg":0.014563106796116505,"completedParallelInputs":"100","computeRatioMax":0.03398058252427184,"name":"S0F: Coalesce","shuffleOutputBytes":"816","recordsWritten":"51","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0A_output"]}],"writeRatioAvg":0.8252427184466019},{"readMsMax":"37","computeMsMax":"146","inputStages":["15","14","12"],"waitMsAvg":"6","id":"16","endMs":"1570903708537","waitMsMax":"6","startMs":"1570903708190","waitRatioMax":0.02912621359223301,"readRatioAvg":0.1796116504854369,"parallelInputs":"1","recordsRead":"114677","computeRatioAvg":0.7087378640776699,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"146","shuffleOutputBytesSpilled":"0","writeRatioMax":0.038834951456310676,"readMsAvg":"37","waitRatioAvg":0.02912621359223301,"completedParallelInputs":"1","computeRatioMax":0.7087378640776699,"name":"S10: Join+","shuffleOutputBytes":"13690","recordsWritten":"90","readRatioMax":0.1796116504854369,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_customer_id, $3:c_current_addr_sk, $4:c_salutation, $5:c_first_name, $6:c_last_name, $7:c_preferred_cust_flag, $8:c_birth_day, $9:c_birth_month, $10:c_birth_year, $11:c_birth_country, $12:c_login, $13:c_email_address, $14:c_last_review_date","FROM customer"]},{"kind":"READ","substeps":["$20","FROM __stage0C_output"]},{"kind":"READ","substeps":["$100, $200, $201","FROM __stage0E_output"]},{"kind":"READ","substeps":["$90, $280","FROM __stage0F_output"]},{"kind":"SORT","substeps":["$290 ASC, $291 ASC, $292 ASC, $293 ASC, $294 ASC, $295 ASC, $296 ASC, $297 ASC, $298 ASC, $299 ASC, $300 ASC, $301 ASC, $302 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["greater($302, multiply($303, 1.2))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $222 = $280"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $150 = $200"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $3 = $20"]},{"kind":"WRITE","substeps":["$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $322","TO __stage10_output"]}],"writeRatioAvg":0.038834951456310676},{"readMsMax":"0","computeMsMax":"5","inputStages":["16"],"waitMsAvg":"1","id":"17","endMs":"1570903708575","waitMsMax":"1","startMs":"1570903708297","waitRatioMax":0.0048543689320388345,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"90","computeRatioAvg":0.024271844660194174,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02912621359223301,"readMsAvg":"0","waitRatioAvg":0.0048543689320388345,"completedParallelInputs":"1","computeRatioMax":0.024271844660194174,"name":"S11: Output","shuffleOutputBytes":"13690","recordsWritten":"90","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $322","FROM __stage10_output"]},{"kind":"SORT","substeps":["$310 ASC, $311 ASC, $312 ASC, $313 ASC, $314 ASC, $315 ASC, $316 ASC, $317 ASC, $318 ASC, $319 ASC, $320 ASC, $321 ASC, $322 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$330, $331, $332, $333, $334, $335, $336, $337, $338, $339, $340, $341, $342","TO __stage11_output"]}],"writeRatioAvg":0.02912621359223301}],"estimatedBytesProcessed":"16769817","timeline":[{"totalSlotMs":"922","activeUnits":"1","completedUnits":"5","elapsedMs":"734","pendingUnits":"2"},{"totalSlotMs":"40951","activeUnits":"4","completedUnits":"212","elapsedMs":"1864","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"41943040","totalPartitionsProcessed":"0","totalBytesProcessed":"16769817","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_returns","datasetId":"scale_1"}]},"endTime":"1570903708780"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query30_1570903704"},"etag":"mTLhPd/m6WiDySHe+gu2nw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query30_1570903704?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon0320c489235bf733762a140778164ff08d339cca","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query30\nWITH customer_total_return \n AS (SELECT wr_returning_customer_sk AS ctr_customer_sk, \n ca_state AS ctr_state, \n Sum(wr_return_amt) AS ctr_total_return \n FROM web_returns, \n date_dim, \n customer_address \n WHERE wr_returned_date_sk = d_date_sk \n AND d_year = 2000 \n AND wr_returning_addr_sk = ca_address_sk \n GROUP BY wr_returning_customer_sk, \n ca_state) \nSELECT c_customer_id, \n c_salutation, \n c_first_name, \n c_last_name, \n c_preferred_cust_flag, \n c_birth_day, \n c_birth_month, \n c_birth_year, \n c_birth_country, \n c_login, \n c_email_address, \n c_last_review_date, \n ctr_total_return \nFROM customer_total_return ctr1, \n customer_address, \n customer \nWHERE ctr1.ctr_total_return > (SELECT Avg(ctr_total_return) benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup 1.2 \n FROM customer_total_return ctr2 \n WHERE ctr1.ctr_state = ctr2.ctr_state) \n AND ca_address_sk = c_current_addr_sk \n AND ca_state = 'IN' \n AND ctr1.ctr_customer_sk = c_customer_sk \nORDER BY c_customer_id, \n c_salutation, \n c_first_name, \n c_last_name, \n c_preferred_cust_flag, \n c_birth_day, \n c_birth_month, \n c_birth_year, \n c_birth_country, \n c_login, \n c_email_address, \n c_last_review_date, \n ctr_total_return\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query30_1570903704","user_email":"nithish.sankaranarayanan@ulb.be"}
