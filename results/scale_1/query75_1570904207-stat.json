{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"31921","creationTime":"1570904209064","totalBytesProcessed":"216193456","startTime":"1570904209206","query":{"totalSlotMs":"31921","queryPlan":[{"readMsMax":"21","computeMsMax":"94","waitMsAvg":"2","id":"0","endMs":"1570904210237","waitMsMax":"2","startMs":"1570904209410","waitRatioMax":0.000980392156862745,"readRatioAvg":0.010294117647058823,"parallelInputs":"1","recordsRead":"72121","computeRatioAvg":0.04607843137254902,"writeMsAvg":"164","status":"COMPLETE","writeMsMax":"164","computeMsAvg":"94","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0803921568627451,"readMsAvg":"21","waitRatioAvg":0.000980392156862745,"completedParallelInputs":"1","computeRatioMax":0.04607843137254902,"name":"S00: Input","shuffleOutputBytes":"2545420","recordsWritten":"72121","readRatioMax":0.010294117647058823,"steps":[{"kind":"READ","substeps":["$50:wr_item_sk, $51:wr_order_number, $52:wr_return_quantity, $53:wr_return_amt","FROM web_returns"]},{"kind":"WRITE","substeps":["$50, $51, $52, $53","TO __stage00_output","BY HASH($51, $50)"]}],"writeRatioAvg":0.0803921568627451},{"readMsMax":"12","computeMsMax":"9","waitMsAvg":"1","id":"1","endMs":"1570904209572","waitMsMax":"1","startMs":"1570904209491","waitRatioMax":0.0004901960784313725,"readRatioAvg":0.0058823529411764705,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004411764705882353,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00392156862745098,"readMsAvg":"12","waitRatioAvg":0.0004901960784313725,"completedParallelInputs":"1","computeRatioMax":0.004411764705882353,"name":"S01: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0058823529411764705,"steps":[{"kind":"READ","substeps":["$170:d_date_sk, $171:d_year","FROM date_dim","WHERE equal($171, 2001)"]},{"kind":"WRITE","substeps":["$170, $171","TO __stage01_output","BY HASH($170)"]}],"writeRatioAvg":0.00392156862745098},{"readMsMax":"10","computeMsMax":"13","waitMsAvg":"21","id":"2","endMs":"1570904209746","waitMsMax":"21","startMs":"1570904209527","waitRatioMax":0.010294117647058823,"readRatioAvg":0.004901960784313725,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.006372549019607843,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0029411764705882353,"readMsAvg":"10","waitRatioAvg":0.010294117647058823,"completedParallelInputs":"1","computeRatioMax":0.006372549019607843,"name":"S02: Input","shuffleOutputBytes":"82495","recordsWritten":"1835","readRatioMax":0.004901960784313725,"steps":[{"kind":"READ","substeps":["$230:i_item_sk, $231:i_brand_id, $232:i_class_id, $233:i_category_id, $235:i_manufact_id, $234:i_category","FROM item","WHERE equal($234, 'Men')"]},{"kind":"WRITE","substeps":["$230, $231, $232, $233, $235","TO __stage02_output","BY HASH($230)"]}],"writeRatioAvg":0.0029411764705882353},{"readMsMax":"30","computeMsMax":"464","waitMsAvg":"31","id":"4","endMs":"1570904210394","waitMsMax":"31","startMs":"1570904209572","waitRatioMax":0.015196078431372549,"readRatioAvg":0.014705882352941176,"parallelInputs":"1","recordsRead":"288116","computeRatioAvg":0.22745098039215686,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"464","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010294117647058823,"readMsAvg":"30","waitRatioAvg":0.015196078431372549,"completedParallelInputs":"1","computeRatioMax":0.22745098039215686,"name":"S04: Input","shuffleOutputBytes":"10208624","recordsWritten":"288116","readRatioMax":0.014705882352941176,"steps":[{"kind":"READ","substeps":["$40:sr_item_sk, $41:sr_ticket_number, $42:sr_return_quantity, $43:sr_return_amt","FROM store_returns"]},{"kind":"WRITE","substeps":["$40, $41, $42, $43","TO __stage04_output","BY HASH($41, $40)"]}],"writeRatioAvg":0.010294117647058823},{"readMsMax":"8","computeMsMax":"8","waitMsAvg":"37","id":"5","endMs":"1570904209854","waitMsMax":"37","startMs":"1570904209664","waitRatioMax":0.018137254901960786,"readRatioAvg":0.00392156862745098,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.00392156862745098,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0029411764705882353,"readMsAvg":"8","waitRatioAvg":0.018137254901960786,"completedParallelInputs":"1","computeRatioMax":0.00392156862745098,"name":"S05: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.00392156862745098,"steps":[{"kind":"READ","substeps":["$150:d_date_sk, $151:d_year","FROM date_dim","WHERE equal($151, 2001)"]},{"kind":"WRITE","substeps":["$150, $151","TO __stage05_output","BY HASH($150)"]}],"writeRatioAvg":0.0029411764705882353},{"readMsMax":"5","computeMsMax":"11","waitMsAvg":"22","id":"6","endMs":"1570904209865","waitMsMax":"22","startMs":"1570904209660","waitRatioMax":0.010784313725490196,"readRatioAvg":0.0024509803921568627,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.005392156862745098,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009313725490196078,"readMsAvg":"5","waitRatioAvg":0.010784313725490196,"completedParallelInputs":"1","computeRatioMax":0.005392156862745098,"name":"S06: Input","shuffleOutputBytes":"82495","recordsWritten":"1835","readRatioMax":0.0024509803921568627,"steps":[{"kind":"READ","substeps":["$220:i_item_sk, $221:i_brand_id, $222:i_class_id, $223:i_category_id, $225:i_manufact_id, $224:i_category","FROM item","WHERE equal($224, 'Men')"]},{"kind":"WRITE","substeps":["$220, $221, $222, $223, $225","TO __stage06_output","BY HASH($220)"]}],"writeRatioAvg":0.009313725490196078},{"readMsMax":"23","computeMsMax":"205","waitMsAvg":"1","id":"8","endMs":"1570904210420","waitMsMax":"1","startMs":"1570904209665","waitRatioMax":0.0004901960784313725,"readRatioAvg":0.011274509803921568,"parallelInputs":"1","recordsRead":"143868","computeRatioAvg":0.10049019607843138,"writeMsAvg":"13","status":"COMPLETE","writeMsMax":"13","computeMsAvg":"205","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006372549019607843,"readMsAvg":"23","waitRatioAvg":0.0004901960784313725,"completedParallelInputs":"1","computeRatioMax":0.10049019607843138,"name":"S08: Input","shuffleOutputBytes":"5132512","recordsWritten":"143868","readRatioMax":0.011274509803921568,"steps":[{"kind":"READ","substeps":["$30:cr_item_sk, $31:cr_order_number, $32:cr_return_quantity, $33:cr_return_amount","FROM catalog_returns"]},{"kind":"WRITE","substeps":["$30, $31, $32, $33","TO __stage08_output","BY HASH($31, $30)"]}],"writeRatioAvg":0.006372549019607843},{"readMsMax":"8","computeMsMax":"8","waitMsAvg":"2","id":"9","endMs":"1570904209822","waitMsMax":"2","startMs":"1570904209686","waitRatioMax":0.000980392156862745,"readRatioAvg":0.00392156862745098,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.00392156862745098,"writeMsAvg":"75","status":"COMPLETE","writeMsMax":"75","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03676470588235294,"readMsAvg":"8","waitRatioAvg":0.000980392156862745,"completedParallelInputs":"1","computeRatioMax":0.00392156862745098,"name":"S09: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.00392156862745098,"steps":[{"kind":"READ","substeps":["$130:d_date_sk, $131:d_year","FROM date_dim","WHERE equal($131, 2001)"]},{"kind":"WRITE","substeps":["$130, $131","TO __stage09_output","BY HASH($130)"]}],"writeRatioAvg":0.03676470588235294},{"readMsMax":"7","computeMsMax":"9","waitMsAvg":"1","id":"10","endMs":"1570904209915","waitMsMax":"1","startMs":"1570904209702","waitRatioMax":0.0004901960784313725,"readRatioAvg":0.003431372549019608,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.004411764705882353,"writeMsAvg":"193","status":"COMPLETE","writeMsMax":"193","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0946078431372549,"readMsAvg":"7","waitRatioAvg":0.0004901960784313725,"completedParallelInputs":"1","computeRatioMax":0.004411764705882353,"name":"S0A: Input","shuffleOutputBytes":"82495","recordsWritten":"1835","readRatioMax":0.003431372549019608,"steps":[{"kind":"READ","substeps":["$210:i_item_sk, $211:i_brand_id, $212:i_class_id, $213:i_category_id, $215:i_manufact_id, $214:i_category","FROM item","WHERE equal($214, 'Men')"]},{"kind":"WRITE","substeps":["$210, $211, $212, $213, $215","TO __stage0A_output","BY HASH($210)"]}],"writeRatioAvg":0.0946078431372549},{"readMsMax":"11","computeMsMax":"98","waitMsAvg":"1","id":"12","endMs":"1570904210021","waitMsMax":"1","startMs":"1570904209791","waitRatioMax":0.0004901960784313725,"readRatioAvg":0.005392156862745098,"parallelInputs":"1","recordsRead":"72121","computeRatioAvg":0.04803921568627451,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"98","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005392156862745098,"readMsAvg":"11","waitRatioAvg":0.0004901960784313725,"completedParallelInputs":"1","computeRatioMax":0.04803921568627451,"name":"S0C: Input","shuffleOutputBytes":"2545420","recordsWritten":"72121","readRatioMax":0.005392156862745098,"steps":[{"kind":"READ","substeps":["$20:wr_item_sk, $21:wr_order_number, $22:wr_return_quantity, $23:wr_return_amt","FROM web_returns"]},{"kind":"WRITE","substeps":["$20, $21, $22, $23","TO __stage0C_output","BY HASH($21, $20)"]}],"writeRatioAvg":0.005392156862745098},{"readMsMax":"9","computeMsMax":"10","waitMsAvg":"1","id":"13","endMs":"1570904209921","waitMsMax":"1","startMs":"1570904209807","waitRatioMax":0.0004901960784313725,"readRatioAvg":0.004411764705882353,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004901960784313725,"writeMsAvg":"82","status":"COMPLETE","writeMsMax":"82","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04019607843137255,"readMsAvg":"9","waitRatioAvg":0.0004901960784313725,"completedParallelInputs":"1","computeRatioMax":0.004901960784313725,"name":"S0D: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.004411764705882353,"steps":[{"kind":"READ","substeps":["$110:d_date_sk, $111:d_year","FROM date_dim","WHERE equal($111, 2002)"]},{"kind":"WRITE","substeps":["$110, $111","TO __stage0D_output","BY HASH($110)"]}],"writeRatioAvg":0.04019607843137255},{"readMsMax":"7","computeMsMax":"10","waitMsAvg":"2","id":"14","endMs":"1570904209950","waitMsMax":"2","startMs":"1570904209830","waitRatioMax":0.000980392156862745,"readRatioAvg":0.003431372549019608,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.004901960784313725,"writeMsAvg":"59","status":"COMPLETE","writeMsMax":"59","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02892156862745098,"readMsAvg":"7","waitRatioAvg":0.000980392156862745,"completedParallelInputs":"1","computeRatioMax":0.004901960784313725,"name":"S0E: Input","shuffleOutputBytes":"82495","recordsWritten":"1835","readRatioMax":0.003431372549019608,"steps":[{"kind":"READ","substeps":["$200:i_item_sk, $201:i_brand_id, $202:i_class_id, $203:i_category_id, $205:i_manufact_id, $204:i_category","FROM item","WHERE equal($204, 'Men')"]},{"kind":"WRITE","substeps":["$200, $201, $202, $203, $205","TO __stage0E_output","BY HASH($200)"]}],"writeRatioAvg":0.02892156862745098},{"readMsMax":"20","computeMsMax":"496","waitMsAvg":"1","id":"16","endMs":"1570904210369","waitMsMax":"1","startMs":"1570904209906","waitRatioMax":0.0004901960784313725,"readRatioAvg":0.00980392156862745,"parallelInputs":"1","recordsRead":"288116","computeRatioAvg":0.24313725490196078,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"496","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008823529411764706,"readMsAvg":"20","waitRatioAvg":0.0004901960784313725,"completedParallelInputs":"1","computeRatioMax":0.24313725490196078,"name":"S10: Input","shuffleOutputBytes":"10208624","recordsWritten":"288116","readRatioMax":0.00980392156862745,"steps":[{"kind":"READ","substeps":["$10:sr_item_sk, $11:sr_ticket_number, $12:sr_return_quantity, $13:sr_return_amt","FROM store_returns"]},{"kind":"WRITE","substeps":["$10, $11, $12, $13","TO __stage10_output","BY HASH($11, $10)"]}],"writeRatioAvg":0.008823529411764706},{"readMsMax":"11","computeMsMax":"10","waitMsAvg":"1","id":"17","endMs":"1570904210143","waitMsMax":"1","startMs":"1570904209922","waitRatioMax":0.0004901960784313725,"readRatioAvg":0.005392156862745098,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004901960784313725,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004411764705882353,"readMsAvg":"11","waitRatioAvg":0.0004901960784313725,"completedParallelInputs":"1","computeRatioMax":0.004901960784313725,"name":"S11: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.005392156862745098,"steps":[{"kind":"READ","substeps":["$90:d_date_sk, $91:d_year","FROM date_dim","WHERE equal($91, 2002)"]},{"kind":"WRITE","substeps":["$90, $91","TO __stage11_output","BY HASH($90)"]}],"writeRatioAvg":0.004411764705882353},{"readMsMax":"7","computeMsMax":"13","waitMsAvg":"1","id":"18","endMs":"1570904210078","waitMsMax":"1","startMs":"1570904209936","waitRatioMax":0.0004901960784313725,"readRatioAvg":0.003431372549019608,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.006372549019607843,"writeMsAvg":"72","status":"COMPLETE","writeMsMax":"72","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03529411764705882,"readMsAvg":"7","waitRatioAvg":0.0004901960784313725,"completedParallelInputs":"1","computeRatioMax":0.006372549019607843,"name":"S12: Input","shuffleOutputBytes":"82495","recordsWritten":"1835","readRatioMax":0.003431372549019608,"steps":[{"kind":"READ","substeps":["$190:i_item_sk, $191:i_brand_id, $192:i_class_id, $193:i_category_id, $195:i_manufact_id, $194:i_category","FROM item","WHERE equal($194, 'Men')"]},{"kind":"WRITE","substeps":["$190, $191, $192, $193, $195","TO __stage12_output","BY HASH($190)"]}],"writeRatioAvg":0.03529411764705882},{"readMsMax":"18","computeMsMax":"191","waitMsAvg":"1","id":"20","endMs":"1570904210755","waitMsMax":"1","startMs":"1570904210025","waitRatioMax":0.0004901960784313725,"readRatioAvg":0.008823529411764706,"parallelInputs":"1","recordsRead":"143868","computeRatioAvg":0.09362745098039216,"writeMsAvg":"15","status":"COMPLETE","writeMsMax":"15","computeMsAvg":"191","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007352941176470588,"readMsAvg":"18","waitRatioAvg":0.0004901960784313725,"completedParallelInputs":"1","computeRatioMax":0.09362745098039216,"name":"S14: Input","shuffleOutputBytes":"5132512","recordsWritten":"143868","readRatioMax":0.008823529411764706,"steps":[{"kind":"READ","substeps":["$1:cr_item_sk, $2:cr_order_number, $3:cr_return_quantity, $4:cr_return_amount","FROM catalog_returns"]},{"kind":"WRITE","substeps":["$1, $2, $3, $4","TO __stage14_output","BY HASH($2, $1)"]}],"writeRatioAvg":0.007352941176470588},{"readMsMax":"10","computeMsMax":"10","waitMsAvg":"1","id":"21","endMs":"1570904210111","waitMsMax":"1","startMs":"1570904210042","waitRatioMax":0.0004901960784313725,"readRatioAvg":0.004901960784313725,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004901960784313725,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0029411764705882353,"readMsAvg":"10","waitRatioAvg":0.0004901960784313725,"completedParallelInputs":"1","computeRatioMax":0.004901960784313725,"name":"S15: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.004901960784313725,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_year","FROM date_dim","WHERE equal($71, 2002)"]},{"kind":"WRITE","substeps":["$70, $71","TO __stage15_output","BY HASH($70)"]}],"writeRatioAvg":0.0029411764705882353},{"readMsMax":"8","computeMsMax":"14","waitMsAvg":"1","id":"22","endMs":"1570904210262","waitMsMax":"1","startMs":"1570904210055","waitRatioMax":0.0004901960784313725,"readRatioAvg":0.00392156862745098,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.006862745098039216,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"14","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00392156862745098,"readMsAvg":"8","waitRatioAvg":0.0004901960784313725,"completedParallelInputs":"1","computeRatioMax":0.006862745098039216,"name":"S16: Input","shuffleOutputBytes":"82495","recordsWritten":"1835","readRatioMax":0.00392156862745098,"steps":[{"kind":"READ","substeps":["$180:i_item_sk, $181:i_brand_id, $182:i_class_id, $183:i_category_id, $185:i_manufact_id, $184:i_category","FROM item","WHERE equal($184, 'Men')"]},{"kind":"WRITE","substeps":["$180, $181, $182, $183, $185","TO __stage16_output","BY HASH($180)"]}],"writeRatioAvg":0.00392156862745098},{"readMsMax":"34","computeMsMax":"2040","inputStages":["1","0","2","8","5","6","9","4","10"],"waitMsAvg":"1","id":"25","endMs":"1570904211839","waitMsMax":"1","startMs":"1570904210587","waitRatioMax":0.0004901960784313725,"readRatioAvg":0.015196078431372549,"parallelInputs":"3","recordsRead":"6558294","computeRatioAvg":0.6509803921568628,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"1328","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0024509803921568627,"readMsAvg":"31","waitRatioAvg":0.0004901960784313725,"completedParallelInputs":"3","computeRatioMax":1,"name":"S19: Join+","shuffleOutputBytes":"165963","recordsWritten":"2637","readRatioMax":0.016666666666666666,"steps":[{"kind":"READ","substeps":["$120:cs_sold_date_sk, $121:cs_item_sk, $122:cs_order_number, $123:cs_quantity, $124:cs_ext_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$210, $211, $212, $213, $215","FROM __stage0A_output"]},{"kind":"READ","substeps":["$130, $131","FROM __stage09_output"]},{"kind":"READ","substeps":["$30, $31, $32, $33","FROM __stage08_output"]},{"kind":"READ","substeps":["$140:ss_sold_date_sk, $141:ss_item_sk, $142:ss_ticket_number, $143:ss_quantity, $144:ss_ext_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$220, $221, $222, $223, $225","FROM __stage06_output"]},{"kind":"READ","substeps":["$150, $151","FROM __stage05_output"]},{"kind":"READ","substeps":["$40, $41, $42, $43","FROM __stage04_output"]},{"kind":"READ","substeps":["$160:ws_sold_date_sk, $161:ws_item_sk, $162:ws_order_number, $163:ws_quantity, $164:ws_ext_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$230, $231, $232, $233, $235","FROM __stage02_output"]},{"kind":"READ","substeps":["$170, $171","FROM __stage01_output"]},{"kind":"READ","substeps":["$50, $51, $52, $53","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $670 := $300, $671 := $301, $672 := $302, $673 := $303, $674 := $304","$280 := SUM($305)","$281 := SUM($306)"]},{"kind":"COMPUTE","substeps":["$340 := subtract($560, coalesce($567, 0))","$341 := subtract($561, coalesce($568, 0))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $551 = $31, $550 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $530 = $130"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $121 = $210"]},{"kind":"COMPUTE","substeps":["$350 := subtract($610, coalesce($617, 0))","$351 := subtract($611, coalesce($618, 0))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $601 = $41, $600 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $580 = $150"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $141 = $220"]},{"kind":"COMPUTE","substeps":["$360 := subtract($660, coalesce($667, 0))","$361 := subtract($661, coalesce($668, 0))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $651 = $51, $650 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $630 = $170"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $161 = $230"]},{"kind":"WRITE","substeps":["$280, $281, $670, $671, $672, $673, $674","TO __stage19_output","BY HASH($670, $671, $672, $673, $674)"]}],"writeRatioAvg":0.0024509803921568627},{"readMsMax":"52","computeMsMax":"1952","inputStages":["13","14","12","16","17","21","18","20","22"],"waitMsAvg":"1","id":"26","endMs":"1570904212084","waitMsMax":"2","startMs":"1570904210954","waitRatioMax":0.000980392156862745,"readRatioAvg":0.02107843137254902,"parallelInputs":"3","recordsRead":"6558294","computeRatioAvg":0.7225490196078431,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"1474","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003431372549019608,"readMsAvg":"43","waitRatioAvg":0.0004901960784313725,"completedParallelInputs":"3","computeRatioMax":0.9568627450980393,"name":"S1A: Join+","shuffleOutputBytes":"165609","recordsWritten":"2631","readRatioMax":0.025490196078431372,"steps":[{"kind":"READ","substeps":["$60:cs_sold_date_sk, $61:cs_item_sk, $62:cs_order_number, $63:cs_quantity, $64:cs_ext_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$180, $181, $182, $183, $185","FROM __stage16_output"]},{"kind":"READ","substeps":["$70, $71","FROM __stage15_output"]},{"kind":"READ","substeps":["$1, $2, $3, $4","FROM __stage14_output"]},{"kind":"READ","substeps":["$80:ss_sold_date_sk, $81:ss_item_sk, $82:ss_ticket_number, $83:ss_quantity, $84:ss_ext_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$190, $191, $192, $193, $195","FROM __stage12_output"]},{"kind":"READ","substeps":["$90, $91","FROM __stage11_output"]},{"kind":"READ","substeps":["$10, $11, $12, $13","FROM __stage10_output"]},{"kind":"READ","substeps":["$100:ws_sold_date_sk, $101:ws_item_sk, $102:ws_order_number, $103:ws_quantity, $104:ws_ext_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$200, $201, $202, $203, $205","FROM __stage0E_output"]},{"kind":"READ","substeps":["$110, $111","FROM __stage0D_output"]},{"kind":"READ","substeps":["$20, $21, $22, $23","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $510 := $290, $511 := $291, $512 := $292, $513 := $293, $514 := $294","$270 := SUM($295)","$271 := SUM($296)"]},{"kind":"COMPUTE","substeps":["$310 := subtract($400, coalesce($407, 0))","$311 := subtract($401, coalesce($408, 0))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $391 = $2, $390 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $370 = $70"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $61 = $180"]},{"kind":"COMPUTE","substeps":["$320 := subtract($450, coalesce($457, 0))","$321 := subtract($451, coalesce($458, 0))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $441 = $11, $440 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $420 = $90"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $81 = $190"]},{"kind":"COMPUTE","substeps":["$330 := subtract($500, coalesce($507, 0))","$331 := subtract($501, coalesce($508, 0))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $491 = $21, $490 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $470 = $110"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $101 = $200"]},{"kind":"WRITE","substeps":["$270, $271, $510, $511, $512, $513, $514","TO __stage1A_output","BY HASH($510, $511, $512, $513, $514)"]}],"writeRatioAvg":0.0024509803921568627},{"readMsMax":"0","computeMsMax":"13","inputStages":["25"],"waitMsAvg":"1","id":"27","endMs":"1570904212279","waitMsMax":"1","startMs":"1570904212195","waitRatioMax":0.0004901960784313725,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2637","computeRatioAvg":0.006372549019607843,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010784313725490196,"readMsAvg":"0","waitRatioAvg":0.0004901960784313725,"completedParallelInputs":"1","computeRatioMax":0.006372549019607843,"name":"S1B: Aggregate","shuffleOutputBytes":"55188","recordsWritten":"876","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$280, $281, $670, $671, $672, $673, $674","FROM __stage19_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $680 := $670, $681 := $671, $682 := $672, $683 := $673, $684 := $674","$260 := SUM($280)","$261 := SUM($281)"]},{"kind":"WRITE","substeps":["$260, $261, $680, $681, $682, $683, $684","TO __stage1B_output","BY HASH($681, $682, $683, $684)"]}],"writeRatioAvg":0.010784313725490196},{"readMsMax":"0","computeMsMax":"10","inputStages":["27"],"waitMsAvg":"2","id":"29","endMs":"1570904212465","waitMsMax":"4","startMs":"1570904212295","waitRatioMax":0.00196078431372549,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"876","computeRatioAvg":0.0029411764705882353,"writeMsAvg":"88","status":"COMPLETE","writeMsMax":"117","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.057352941176470586,"readMsAvg":"0","waitRatioAvg":0.000980392156862745,"completedParallelInputs":"100","computeRatioMax":0.004901960784313725,"name":"S1D: Coalesce","shuffleOutputBytes":"55188","recordsWritten":"876","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage1B_output"]}],"writeRatioAvg":0.043137254901960784},{"readMsMax":"0","computeMsMax":"11","inputStages":["26","29"],"waitMsAvg":"3","id":"30","endMs":"1570904212490","waitMsMax":"3","startMs":"1570904212299","waitRatioMax":0.0014705882352941176,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"3507","computeRatioAvg":0.005392156862745098,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00196078431372549,"readMsAvg":"0","waitRatioAvg":0.0014705882352941176,"completedParallelInputs":"1","computeRatioMax":0.005392156862745098,"name":"S1E: Join+","shuffleOutputBytes":"9000","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$270, $271, $510, $511, $512, $513, $514","FROM __stage1A_output"]},{"kind":"READ","substeps":["$260, $261, $680, $681, $682, $683, $684","FROM __stage1D_output"]},{"kind":"SORT","substeps":["$240 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$240 := subtract($690, $697)","$241 := subtract($691, $698)"]},{"kind":"FILTER","substeps":["less(divide(CAST($690 AS DOUBLE), CAST($697 AS DOUBLE)), 0.9)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $521 = $681, $522 = $682, $523 = $683, $524 = $684"]},{"kind":"AGGREGATE","substeps":["GROUP BY $520 := $510, $521 := $511, $522 := $512, $523 := $513, $524 := $514","$250 := SUM($270)","$251 := SUM($271)"]},{"kind":"WRITE","substeps":["$700, $701, $702, $703, $704, $705, $706, $707, $708, $709","TO __stage1E_output"]}],"writeRatioAvg":0.00196078431372549},{"readMsMax":"0","computeMsMax":"8","inputStages":["30"],"waitMsAvg":"1","id":"31","endMs":"1570904212508","waitMsMax":"1","startMs":"1570904212391","waitRatioMax":0.0004901960784313725,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.00392156862745098,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003431372549019608,"readMsAvg":"0","waitRatioAvg":0.0004901960784313725,"completedParallelInputs":"1","computeRatioMax":0.00392156862745098,"name":"S1F: Output","shuffleOutputBytes":"9000","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$700, $701, $702, $703, $704, $705, $706, $707, $708, $709","FROM __stage1E_output"]},{"kind":"SORT","substeps":["$700 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$710, $711, $712, $713, $714, $715, $716, $717, $718, $719","TO __stage1F_output"]}],"writeRatioAvg":0.003431372549019608}],"estimatedBytesProcessed":"216193456","timeline":[{"totalSlotMs":"1353","activeUnits":"12","completedUnits":"5","elapsedMs":"705","pendingUnits":"13"},{"totalSlotMs":"9815","activeUnits":"3","completedUnits":"18","elapsedMs":"1717","pendingUnits":"6"},{"totalSlotMs":"17338","activeUnits":"4","completedUnits":"22","elapsedMs":"2849","pendingUnits":"2"},{"totalSlotMs":"31921","activeUnits":"0","completedUnits":"127","elapsedMs":"3529","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"217055232","totalPartitionsProcessed":"0","totalBytesProcessed":"216193456","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"}]},"endTime":"1570904212759"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query75_1570904207"},"etag":"S+f9NEVLrn4GvG0ZnUBhAQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query75_1570904207?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon2049716bb365c49f4ce162822085272bcb183ad9","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query75\nWITH all_sales \n AS (SELECT d_year, \n i_brand_id, \n i_class_id, \n i_category_id, \n i_manufact_id, \n Sum(sales_cnt) AS sales_cnt, \n Sum(sales_amt) AS sales_amt \n FROM (SELECT d_year, \n i_brand_id, \n i_class_id, \n i_category_id, \n i_manufact_id, \n cs_quantity - COALESCE(cr_return_quantity, 0) AS \n sales_cnt, \n cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS \n sales_amt \n FROM catalog_sales \n JOIN item \n ON i_item_sk = cs_item_sk \n JOIN date_dim \n ON d_date_sk = cs_sold_date_sk \n LEFT JOIN catalog_returns \n ON ( cs_order_number = cr_order_number \n AND cs_item_sk = cr_item_sk ) \n WHERE i_category = 'Men' \n UNION ALL\n SELECT d_year, \n i_brand_id, \n i_class_id, \n i_category_id, \n i_manufact_id, \n ss_quantity - COALESCE(sr_return_quantity, 0) AS \n sales_cnt, \n ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS \n sales_amt \n FROM store_sales \n JOIN item \n ON i_item_sk = ss_item_sk \n JOIN date_dim \n ON d_date_sk = ss_sold_date_sk \n LEFT JOIN store_returns \n ON ( ss_ticket_number = sr_ticket_number \n AND ss_item_sk = sr_item_sk ) \n WHERE i_category = 'Men' \n UNION ALL\n SELECT d_year, \n i_brand_id, \n i_class_id, \n i_category_id, \n i_manufact_id, \n ws_quantity - COALESCE(wr_return_quantity, 0) AS \n sales_cnt, \n ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS \n sales_amt \n FROM web_sales \n JOIN item \n ON i_item_sk = ws_item_sk \n JOIN date_dim \n ON d_date_sk = ws_sold_date_sk \n LEFT JOIN web_returns \n ON ( ws_order_number = wr_order_number \n AND ws_item_sk = wr_item_sk ) \n WHERE i_category = 'Men') sales_detail \n GROUP BY d_year, \n i_brand_id, \n i_class_id, \n i_category_id, \n i_manufact_id) \nSELECT prev_yr.d_year AS prev_year, \n curr_yr.d_year AS year1, \n curr_yr.i_brand_id, \n curr_yr.i_class_id, \n curr_yr.i_category_id, \n curr_yr.i_manufact_id, \n prev_yr.sales_cnt AS prev_yr_cnt, \n curr_yr.sales_cnt AS curr_yr_cnt, \n curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, \n curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff \nFROM all_sales curr_yr, \n all_sales prev_yr \nWHERE curr_yr.i_brand_id = prev_yr.i_brand_id \n AND curr_yr.i_class_id = prev_yr.i_class_id \n AND curr_yr.i_category_id = prev_yr.i_category_id \n AND curr_yr.i_manufact_id = prev_yr.i_manufact_id \n AND curr_yr.d_year = 2002 \n AND prev_yr.d_year = 2002 - 1 \n AND curr_yr.sales_cnt / prev_yr.sales_cnt\n < 0.9 \nORDER BY sales_cnt_diff\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query75_1570904207","user_email":"nithish.sankaranarayanan@ulb.be"}
