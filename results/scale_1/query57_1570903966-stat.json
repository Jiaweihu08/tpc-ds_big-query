{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"39881","creationTime":"1570903968640","totalBytesProcessed":"48190353","startTime":"1570903968810","query":{"totalSlotMs":"39881","queryPlan":[{"readMsMax":"35","computeMsMax":"7","waitMsAvg":"3","id":"0","endMs":"1570903969090","waitMsMax":"3","startMs":"1570903969022","waitRatioMax":0.0012259910093992644,"readRatioAvg":0.014303228442991417,"parallelInputs":"1","recordsRead":"6","computeRatioAvg":0.0028606456885982836,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0028606456885982836,"readMsAvg":"35","waitRatioAvg":0.0012259910093992644,"completedParallelInputs":"1","computeRatioMax":0.0028606456885982836,"name":"S00: Input","shuffleOutputBytes":"155","recordsWritten":"6","readRatioMax":0.014303228442991417,"steps":[{"kind":"READ","substeps":["$80:cc_call_center_sk, $81:cc_name","FROM call_center"]},{"kind":"WRITE","substeps":["$80, $81","TO __stage00_output","BY HASH($80)"]}],"writeRatioAvg":0.0028606456885982836},{"readMsMax":"22","computeMsMax":"17","waitMsAvg":"21","id":"1","endMs":"1570903969183","waitMsMax":"21","startMs":"1570903969065","waitRatioMax":0.00858193706579485,"readRatioAvg":0.008990600735594606,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.006947282386595832,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"17","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0032693093583980384,"readMsAvg":"22","waitRatioAvg":0.00858193706579485,"completedParallelInputs":"1","computeRatioMax":0.006947282386595832,"name":"S01: Input","shuffleOutputBytes":"11556","recordsWritten":"428","readRatioMax":0.008990600735594606,"steps":[{"kind":"READ","substeps":["$110:d_date_sk, $111:d_year, $112:d_moy","FROM date_dim","WHERE or(equal($111, 2000), and(equal($111, 1999), equal($112, 12)), and(equal($111, 2001), equal($112, 1)))"]},{"kind":"WRITE","substeps":["$110, $111, $112","TO __stage01_output","BY HASH($110)"]}],"writeRatioAvg":0.0032693093583980384},{"readMsMax":"6","computeMsMax":"20","waitMsAvg":"18","id":"3","endMs":"1570903969220","waitMsMax":"18","startMs":"1570903969106","waitRatioMax":0.0073559460563955865,"readRatioAvg":0.002451982018798529,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.008173273395995096,"writeMsAvg":"34","status":"COMPLETE","writeMsMax":"34","computeMsAvg":"20","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013894564773191663,"readMsAvg":"6","waitRatioAvg":0.0073559460563955865,"completedParallelInputs":"1","computeRatioMax":0.008173273395995096,"name":"S03: Input","shuffleOutputBytes":"738172","recordsWritten":"18000","readRatioMax":0.002451982018798529,"steps":[{"kind":"READ","substeps":["$90:i_item_sk, $91:i_brand, $92:i_category","FROM item"]},{"kind":"WRITE","substeps":["$90, $91, $92","TO __stage03_output","BY HASH($90)"]}],"writeRatioAvg":0.013894564773191663},{"readMsMax":"4","computeMsMax":"8","waitMsAvg":"2","id":"4","endMs":"1570903969336","waitMsMax":"2","startMs":"1570903969128","waitRatioMax":0.0008173273395995096,"readRatioAvg":0.0016346546791990192,"parallelInputs":"1","recordsRead":"6","computeRatioAvg":0.0032693093583980384,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"26","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010625255414793625,"readMsAvg":"4","waitRatioAvg":0.0008173273395995096,"completedParallelInputs":"1","computeRatioMax":0.0032693093583980384,"name":"S04: Input","shuffleOutputBytes":"155","recordsWritten":"6","readRatioMax":0.0016346546791990192,"steps":[{"kind":"READ","substeps":["$10:cc_call_center_sk, $11:cc_name","FROM call_center"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage04_output","BY HASH($10)"]}],"writeRatioAvg":0.010625255414793625},{"readMsMax":"8","computeMsMax":"19","waitMsAvg":"2","id":"5","endMs":"1570903969321","waitMsMax":"2","startMs":"1570903969158","waitRatioMax":0.0008173273395995096,"readRatioAvg":0.0032693093583980384,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.007764609726195341,"writeMsAvg":"90","status":"COMPLETE","writeMsMax":"90","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03677973028197793,"readMsAvg":"8","waitRatioAvg":0.0008173273395995096,"completedParallelInputs":"1","computeRatioMax":0.007764609726195341,"name":"S05: Input","shuffleOutputBytes":"11556","recordsWritten":"428","readRatioMax":0.0032693093583980384,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_year, $72:d_moy","FROM date_dim","WHERE or(equal($71, 2000), and(equal($71, 1999), equal($72, 12)), and(equal($71, 2001), equal($72, 1)))"]},{"kind":"WRITE","substeps":["$70, $71, $72","TO __stage05_output","BY HASH($70)"]}],"writeRatioAvg":0.03677973028197793},{"readMsMax":"9","computeMsMax":"24","waitMsAvg":"2","id":"7","endMs":"1570903969398","waitMsMax":"2","startMs":"1570903969298","waitRatioMax":0.0008173273395995096,"readRatioAvg":0.0036779730281977932,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.009807928075194115,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"28","computeMsAvg":"24","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011442582754393135,"readMsAvg":"9","waitRatioAvg":0.0008173273395995096,"completedParallelInputs":"1","computeRatioMax":0.009807928075194115,"name":"S07: Input","shuffleOutputBytes":"738172","recordsWritten":"18000","readRatioMax":0.0036779730281977932,"steps":[{"kind":"READ","substeps":["$50:i_item_sk, $51:i_brand, $52:i_category","FROM item"]},{"kind":"WRITE","substeps":["$50, $51, $52","TO __stage07_output","BY HASH($50)"]}],"writeRatioAvg":0.011442582754393135},{"readMsMax":"7","computeMsMax":"7","waitMsAvg":"1","id":"8","endMs":"1570903969405","waitMsMax":"1","startMs":"1570903969322","waitRatioMax":0.0004086636697997548,"readRatioAvg":0.0028606456885982836,"parallelInputs":"1","recordsRead":"6","computeRatioAvg":0.0028606456885982836,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"16","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006538618716796077,"readMsAvg":"7","waitRatioAvg":0.0004086636697997548,"completedParallelInputs":"1","computeRatioMax":0.0028606456885982836,"name":"S08: Input","shuffleOutputBytes":"155","recordsWritten":"6","readRatioMax":0.0028606456885982836,"steps":[{"kind":"READ","substeps":["$1:cc_call_center_sk, $2:cc_name","FROM call_center"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage08_output","BY HASH($1)"]}],"writeRatioAvg":0.006538618716796077},{"readMsMax":"10","computeMsMax":"20","waitMsAvg":"1","id":"9","endMs":"1570903969540","waitMsMax":"1","startMs":"1570903969349","waitRatioMax":0.0004086636697997548,"readRatioAvg":0.004086636697997548,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.008173273395995096,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"20","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0032693093583980384,"readMsAvg":"10","waitRatioAvg":0.0004086636697997548,"completedParallelInputs":"1","computeRatioMax":0.008173273395995096,"name":"S09: Input","shuffleOutputBytes":"11556","recordsWritten":"428","readRatioMax":0.004086636697997548,"steps":[{"kind":"READ","substeps":["$40:d_date_sk, $41:d_year, $42:d_moy","FROM date_dim","WHERE or(equal($41, 2000), and(equal($41, 1999), equal($42, 12)), and(equal($41, 2001), equal($42, 1)))"]},{"kind":"WRITE","substeps":["$40, $41, $42","TO __stage09_output","BY HASH($40)"]}],"writeRatioAvg":0.0032693093583980384},{"readMsMax":"17","computeMsMax":"25","waitMsAvg":"1","id":"11","endMs":"1570903969501","waitMsMax":"1","startMs":"1570903969387","waitRatioMax":0.0004086636697997548,"readRatioAvg":0.006947282386595832,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.01021659174499387,"writeMsAvg":"37","status":"COMPLETE","writeMsMax":"37","computeMsAvg":"25","shuffleOutputBytesSpilled":"0","writeRatioMax":0.015120555782590927,"readMsAvg":"17","waitRatioAvg":0.0004086636697997548,"completedParallelInputs":"1","computeRatioMax":0.01021659174499387,"name":"S0B: Input","shuffleOutputBytes":"738172","recordsWritten":"18000","readRatioMax":0.006947282386595832,"steps":[{"kind":"READ","substeps":["$20:i_item_sk, $21:i_brand, $22:i_category","FROM item"]},{"kind":"WRITE","substeps":["$20, $21, $22","TO __stage0B_output","BY HASH($20)"]}],"writeRatioAvg":0.015120555782590927},{"readMsMax":"28","computeMsMax":"1356","inputStages":["0","1","3"],"waitMsAvg":"1","id":"12","endMs":"1570903970226","waitMsMax":"1","startMs":"1570903969415","waitRatioMax":0.0004086636697997548,"readRatioAvg":0.011442582754393135,"parallelInputs":"1","recordsRead":"1455876","computeRatioAvg":0.5541479362484675,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"1356","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0073559460563955865,"readMsAvg":"28","waitRatioAvg":0.0004086636697997548,"completedParallelInputs":"1","computeRatioMax":0.5541479362484675,"name":"S0C: Join+","shuffleOutputBytes":"2449853","recordsWritten":"32204","readRatioMax":0.011442582754393135,"steps":[{"kind":"READ","substeps":["$100:cs_sold_date_sk, $101:cs_call_center_sk, $102:cs_item_sk, $103:cs_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$90, $91, $92","FROM __stage03_output"]},{"kind":"READ","substeps":["$110, $111, $112","FROM __stage01_output"]},{"kind":"READ","substeps":["$80, $81","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $290 := $281, $291 := $280, $292 := $285, $293 := $283, $294 := $284","$240 := SUM($282)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $272 = $80"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $252 = $110"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $102 = $90"]},{"kind":"WRITE","substeps":["$292, $291, $290, $293, $294, $240","TO __stage0C_output","BY HASH($290, $291, $292, $293, $294)"]}],"writeRatioAvg":0.0073559460563955865},{"readMsMax":"35","computeMsMax":"2447","inputStages":["4","5","7"],"waitMsAvg":"2","id":"13","endMs":"1570903970747","waitMsMax":"2","startMs":"1570903969454","waitRatioMax":0.0008173273395995096,"readRatioAvg":0.014303228442991417,"parallelInputs":"1","recordsRead":"1455876","computeRatioAvg":1,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"2447","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00858193706579485,"readMsAvg":"35","waitRatioAvg":0.0008173273395995096,"completedParallelInputs":"1","computeRatioMax":1,"name":"S0D: Join+","shuffleOutputBytes":"2449853","recordsWritten":"32204","readRatioMax":0.014303228442991417,"steps":[{"kind":"READ","substeps":["$60:cs_sold_date_sk, $61:cs_call_center_sk, $62:cs_item_sk, $63:cs_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$50, $51, $52","FROM __stage07_output"]},{"kind":"READ","substeps":["$70, $71, $72","FROM __stage05_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $390 := $381, $391 := $380, $392 := $385, $393 := $383, $394 := $384","$220 := SUM($382)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $372 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $352 = $70"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $62 = $50"]},{"kind":"WRITE","substeps":["$392, $391, $390, $393, $394, $220","TO __stage0D_output","BY HASH($390, $391, $392, $393, $394)"]}],"writeRatioAvg":0.00858193706579485},{"readMsMax":"48","computeMsMax":"2367","inputStages":["8","9","11"],"waitMsAvg":"2","id":"15","endMs":"1570903970972","waitMsMax":"2","startMs":"1570903969606","waitRatioMax":0.0008173273395995096,"readRatioAvg":0.01961585615038823,"parallelInputs":"1","recordsRead":"1455876","computeRatioAvg":0.9673069064160196,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"2367","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011033919084593379,"readMsAvg":"48","waitRatioAvg":0.0008173273395995096,"completedParallelInputs":"1","computeRatioMax":0.9673069064160196,"name":"S0F: Join+","shuffleOutputBytes":"2449853","recordsWritten":"32204","readRatioMax":0.01961585615038823,"steps":[{"kind":"READ","substeps":["$30:cs_sold_date_sk, $31:cs_call_center_sk, $32:cs_item_sk, $33:cs_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$20, $21, $22","FROM __stage0B_output"]},{"kind":"READ","substeps":["$40, $41, $42","FROM __stage09_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $480 := $471, $481 := $470, $482 := $475, $483 := $473, $484 := $474","$210 := SUM($472)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $462 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $442 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $32 = $20"]},{"kind":"WRITE","substeps":["$482, $481, $480, $483, $484, $210","TO __stage0F_output","BY HASH($480, $481, $482, $483, $484)"]}],"writeRatioAvg":0.011033919084593379},{"readMsMax":"0","computeMsMax":"111","inputStages":["12"],"waitMsAvg":"1","id":"16","endMs":"1570903970456","waitMsMax":"1","startMs":"1570903970368","waitRatioMax":0.0004086636697997548,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"32204","computeRatioAvg":0.045361667347772784,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"111","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007764609726195341,"readMsAvg":"0","waitRatioAvg":0.0004086636697997548,"completedParallelInputs":"1","computeRatioMax":0.045361667347772784,"name":"S10: Aggregate","shuffleOutputBytes":"2449853","recordsWritten":"32204","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$292, $291, $290, $293, $294, $240","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $300 := $290, $301 := $291, $302 := $292, $303 := $293, $304 := $294","$230 := SUM($240)"]},{"kind":"WRITE","substeps":["$302, $301, $300, $303, $304, $230","TO __stage10_output","BY HASH($300, $301, $302, $303)"]}],"writeRatioAvg":0.007764609726195341},{"readMsMax":"0","computeMsMax":"185","inputStages":["16"],"waitMsAvg":"3","id":"17","endMs":"1570903970677","waitMsMax":"3","startMs":"1570903970547","waitRatioMax":0.0012259910093992644,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"32204","computeRatioAvg":0.07560277891295464,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"185","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008990600735594606,"readMsAvg":"0","waitRatioAvg":0.0012259910093992644,"completedParallelInputs":"1","computeRatioMax":0.07560277891295464,"name":"S11: Sort+","shuffleOutputBytes":"2739689","recordsWritten":"32204","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$302, $301, $300, $303, $304, $230","FROM __stage10_output"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$190 := AVG($315) OVER (PARTITION BY $312, $311, $310, $313 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)"]},{"kind":"SORT","substeps":["$300 ASC, $301 ASC, $302 ASC, $303 ASC"]},{"kind":"WRITE","substeps":["$320, $321, $322, $323, $324, $190, $325","TO __stage11_output","BY HASH($322, $321, $320)"]}],"writeRatioAvg":0.008990600735594606},{"readMsMax":"0","computeMsMax":"116","inputStages":["13"],"waitMsAvg":"3","id":"18","endMs":"1570903971139","waitMsMax":"3","startMs":"1570903970928","waitRatioMax":0.0012259910093992644,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"32204","computeRatioAvg":0.047404985696771554,"writeMsAvg":"133","status":"COMPLETE","writeMsMax":"133","computeMsAvg":"116","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05435226808336739,"readMsAvg":"0","waitRatioAvg":0.0012259910093992644,"completedParallelInputs":"1","computeRatioMax":0.047404985696771554,"name":"S12: Aggregate","shuffleOutputBytes":"2449853","recordsWritten":"32204","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$392, $391, $390, $393, $394, $220","FROM __stage0D_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $400 := $390, $401 := $391, $402 := $392, $403 := $393, $404 := $394","$200 := SUM($220)"]},{"kind":"WRITE","substeps":["$402, $401, $400, $403, $404, $200","TO __stage12_output","BY HASH($400, $401, $402)"]}],"writeRatioAvg":0.05435226808336739},{"readMsMax":"0","computeMsMax":"125","inputStages":["15"],"waitMsAvg":"1","id":"19","endMs":"1570903971519","waitMsMax":"1","startMs":"1570903971339","waitRatioMax":0.0004086636697997548,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"32204","computeRatioAvg":0.05108295872496935,"writeMsAvg":"77","status":"COMPLETE","writeMsMax":"77","computeMsAvg":"125","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03146710257458112,"readMsAvg":"0","waitRatioAvg":0.0004086636697997548,"completedParallelInputs":"1","computeRatioMax":0.05108295872496935,"name":"S13: Aggregate","shuffleOutputBytes":"2449853","recordsWritten":"32204","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$482, $481, $480, $483, $484, $210","FROM __stage0F_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $490 := $480, $491 := $481, $492 := $482, $493 := $483, $494 := $484","$180 := SUM($210)"]},{"kind":"WRITE","substeps":["$492, $491, $490, $493, $494, $180","TO __stage13_output","BY HASH($490, $491, $492)"]}],"writeRatioAvg":0.03146710257458112},{"readMsMax":"0","computeMsMax":"252","inputStages":["19"],"waitMsAvg":"2","id":"20","endMs":"1570903971719","waitMsMax":"2","startMs":"1570903971544","waitRatioMax":0.0008173273395995096,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"32204","computeRatioAvg":0.10298324478953821,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"252","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009807928075194115,"readMsAvg":"0","waitRatioAvg":0.0008173273395995096,"completedParallelInputs":"1","computeRatioMax":0.10298324478953821,"name":"S14: Sort+","shuffleOutputBytes":"2126527","recordsWritten":"31574","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$492, $491, $490, $493, $494, $180","FROM __stage13_output"]},{"kind":"COMPUTE","substeps":["$130 := subtract($150, 1)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$150 := RANK() OVER (PARTITION BY $502, $501, $500 ORDER BY $503 ASC, $504 ASC)"]},{"kind":"SORT","substeps":["$490 ASC, $491 ASC, $492 ASC, $493 ASC, $494 ASC"]},{"kind":"WRITE","substeps":["$130, $510, $511, $512, $513","TO __stage14_output","BY HASH($512, $511, $510, $130)"]}],"writeRatioAvg":0.009807928075194115},{"readMsMax":"0","computeMsMax":"186","inputStages":["18"],"waitMsAvg":"6","id":"21","endMs":"1570903971783","waitMsMax":"6","startMs":"1570903971574","waitRatioMax":0.002451982018798529,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"32204","computeRatioAvg":0.0760114425827544,"writeMsAvg":"104","status":"COMPLETE","writeMsMax":"104","computeMsAvg":"186","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0425010216591745,"readMsAvg":"0","waitRatioAvg":0.002451982018798529,"completedParallelInputs":"1","computeRatioMax":0.0760114425827544,"name":"S15: Sort+","shuffleOutputBytes":"2126527","recordsWritten":"31574","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$402, $401, $400, $403, $404, $200","FROM __stage12_output"]},{"kind":"COMPUTE","substeps":["$140 := add($170, 1)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$170 := RANK() OVER (PARTITION BY $412, $411, $410 ORDER BY $413 ASC, $414 ASC)"]},{"kind":"SORT","substeps":["$400 ASC, $401 ASC, $402 ASC, $403 ASC, $404 ASC"]},{"kind":"WRITE","substeps":["$140, $420, $421, $422, $423","TO __stage15_output","BY HASH($422, $421, $420, $140)"]}],"writeRatioAvg":0.0425010216591745},{"readMsMax":"0","computeMsMax":"9","inputStages":["21"],"waitMsAvg":"1","id":"23","endMs":"1570903972010","waitMsMax":"3","startMs":"1570903971807","waitRatioMax":0.0012259910093992644,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"31574","computeRatioAvg":0.002043318348998774,"writeMsAvg":"83","status":"COMPLETE","writeMsMax":"185","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.07560277891295464,"readMsAvg":"0","waitRatioAvg":0.0004086636697997548,"completedParallelInputs":"100","computeRatioMax":0.0036779730281977932,"name":"S17: Coalesce","shuffleOutputBytes":"2126527","recordsWritten":"31574","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage15_output"]}],"writeRatioAvg":0.033919084593379646},{"readMsMax":"0","computeMsMax":"10","inputStages":["20"],"waitMsAvg":"3","id":"24","endMs":"1570903972089","waitMsMax":"6","startMs":"1570903971808","waitRatioMax":0.002451982018798529,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"31574","computeRatioAvg":0.002451982018798529,"writeMsAvg":"71","status":"COMPLETE","writeMsMax":"185","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.07560277891295464,"readMsAvg":"0","waitRatioAvg":0.0012259910093992644,"completedParallelInputs":"100","computeRatioMax":0.004086636697997548,"name":"S18: Coalesce","shuffleOutputBytes":"2126527","recordsWritten":"31574","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage14_output"]}],"writeRatioAvg":0.029015120555782592},{"readMsMax":"0","computeMsMax":"214","inputStages":["17","24","23"],"waitMsAvg":"10","id":"25","endMs":"1570903972219","waitMsMax":"10","startMs":"1570903971820","waitRatioMax":0.004086636697997548,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"95352","computeRatioAvg":0.08745402533714752,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"214","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0016346546791990192,"readMsAvg":"0","waitRatioAvg":0.004086636697997548,"completedParallelInputs":"1","computeRatioMax":0.08745402533714752,"name":"S19: Join+","shuffleOutputBytes":"7567","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$320, $321, $322, $323, $324, $190, $325","FROM __stage11_output"]},{"kind":"READ","substeps":["$140, $420, $421, $422, $423","FROM __stage17_output"]},{"kind":"READ","substeps":["$130, $510, $511, $512, $513","FROM __stage18_output"]},{"kind":"SORT","substeps":["$120 ASC, $522 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$120 := subtract($524, $522)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $432 = $512, $431 = $511, $430 = $510, $434 = $130"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $342 = $422, $341 = $421, $340 = $420, $160 = $140"]},{"kind":"FILTER","substeps":["and(equal($343, 2000), greater($344, 0), ...)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$160 := RANK() OVER (PARTITION BY $332, $331, $330 ORDER BY $333 ASC, $334 ASC)"]},{"kind":"SORT","substeps":["$322 ASC, $321 ASC, $320 ASC, $323 ASC, $324 ASC"]},{"kind":"WRITE","substeps":["$530, $531, $532, $533, $534, $535, $536","TO __stage19_output"]}],"writeRatioAvg":0.0016346546791990192},{"readMsMax":"0","computeMsMax":"5","inputStages":["25"],"waitMsAvg":"1","id":"26","endMs":"1570903972319","waitMsMax":"1","startMs":"1570903971877","waitRatioMax":0.0004086636697997548,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.002043318348998774,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002451982018798529,"readMsAvg":"0","waitRatioAvg":0.0004086636697997548,"completedParallelInputs":"1","computeRatioMax":0.002043318348998774,"name":"S1A: Output","shuffleOutputBytes":"6667","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$530, $531, $532, $533, $534, $535, $536","FROM __stage19_output"]},{"kind":"SORT","substeps":["$532 ASC, $534 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$540, $541, $542, $543, $544, $545","TO __stage1A_output"]}],"writeRatioAvg":0.002451982018798529}],"estimatedBytesProcessed":"48190353","timeline":[{"totalSlotMs":"1357","activeUnits":"4","completedUnits":"8","elapsedMs":"714","pendingUnits":"4"},{"totalSlotMs":"6592","activeUnits":"3","completedUnits":"12","elapsedMs":"1920","pendingUnits":"2"},{"totalSlotMs":"9450","activeUnits":"201","completedUnits":"18","elapsedMs":"3034","pendingUnits":"202"},{"totalSlotMs":"39881","activeUnits":"0","completedUnits":"220","elapsedMs":"3805","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"48234496","totalPartitionsProcessed":"0","totalBytesProcessed":"48190353","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"call_center","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"}]},"endTime":"1570903972654"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query57_1570903966"},"etag":"LgNWfrNOMSGVfzPbLF2QHg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query57_1570903966?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonc7cd285bfe7af45b86deae606ca96dd8b3d7d6ee","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query57\nWITH v1 \n AS (SELECT i_category, \n i_brand, \n cc_name, \n d_year, \n d_moy, \n Sum(cs_sales_price) sum_sales \n , \n Avg(Sum(cs_sales_price)) \n OVER ( \n partition BY i_category, i_brand, cc_name, d_year) \n avg_monthly_sales \n , \n Rank() \n OVER ( \n partition BY i_category, i_brand, cc_name \n ORDER BY d_year, d_moy) rn \n FROM item, \n catalog_sales, \n date_dim, \n call_center \n WHERE cs_item_sk = i_item_sk \n AND cs_sold_date_sk = d_date_sk \n AND cc_call_center_sk = cs_call_center_sk \n AND ( d_year = 2000 \n OR ( d_year = 2000 - 1 \n AND d_moy = 12 ) \n OR ( d_year = 2000 + 1 \n AND d_moy = 1 ) ) \n GROUP BY i_category, \n i_brand, \n cc_name, \n d_year, \n d_moy), \n v2 \n AS (SELECT v1.i_brand, \n v1.d_year, \n v1.avg_monthly_sales, \n v1.sum_sales, \n v1_lag.sum_sales psum, \n v1_lead.sum_sales nsum \n FROM v1, \n v1 v1_lag, \n v1 v1_lead \n WHERE v1.i_category = v1_lag.i_category \n AND v1.i_category = v1_lead.i_category \n AND v1.i_brand = v1_lag.i_brand \n AND v1.i_brand = v1_lead.i_brand \n AND v1. cc_name = v1_lag. cc_name \n AND v1. cc_name = v1_lead. cc_name \n AND v1.rn = v1_lag.rn + 1 \n AND v1.rn = v1_lead.rn - 1) \nSELECT benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup \nFROM v2 \nWHERE d_year = 2000 \n AND avg_monthly_sales > 0 \n AND CASE \n WHEN avg_monthly_sales > 0 THEN Abs(sum_sales - avg_monthly_sales) \n / \n avg_monthly_sales \n ELSE NULL \n END > 0.1 \nORDER BY sum_sales - avg_monthly_sales, \n 3\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query57_1570903966","user_email":"nithish.sankaranarayanan@ulb.be"}
