{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"3079","creationTime":"1570903804177","totalBytesProcessed":"62826704","startTime":"1570903804335","query":{"totalSlotMs":"3079","queryPlan":[{"readMsMax":"15","computeMsMax":"18","waitMsAvg":"1","id":"0","endMs":"1570903804702","waitMsMax":"1","startMs":"1570903804494","waitRatioMax":0.0005681818181818182,"readRatioAvg":0.008522727272727272,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.010227272727272727,"writeMsAvg":"176","status":"COMPLETE","writeMsMax":"176","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.1,"readMsAvg":"15","waitRatioAvg":0.0005681818181818182,"completedParallelInputs":"1","computeRatioMax":0.010227272727272727,"name":"S00: Input","shuffleOutputBytes":"1488","recordsWritten":"62","readRatioMax":0.008522727272727272,"steps":[{"kind":"READ","substeps":["$1:d_date_sk, $2:d_date","FROM date_dim","WHERE between(CAST($2 AS DATE), 11808, 11869)"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.1},{"readMsMax":"9","computeMsMax":"9","waitMsAvg":"1","id":"1","endMs":"1570903804672","waitMsMax":"1","startMs":"1570903804581","waitRatioMax":0.0005681818181818182,"readRatioAvg":0.005113636363636364,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.005113636363636364,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011363636363636364,"readMsAvg":"9","waitRatioAvg":0.0005681818181818182,"completedParallelInputs":"1","computeRatioMax":0.005113636363636364,"name":"S01: Input","shuffleOutputBytes":"35220","recordsWritten":"1174","readRatioMax":0.005113636363636364,"steps":[{"kind":"READ","substeps":["$20:i_item_sk, $21:i_item_id, $22:i_current_price","FROM item","WHERE between($22, 0.99, 1.49)"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage01_output","BY HASH($20)"]}],"writeRatioAvg":0.011363636363636364},{"readMsMax":"7","computeMsMax":"4","waitMsAvg":"16","id":"2","endMs":"1570903804669","waitMsMax":"16","startMs":"1570903804621","waitRatioMax":0.00909090909090909,"readRatioAvg":0.003977272727272727,"parallelInputs":"1","recordsRead":"5","computeRatioAvg":0.0022727272727272726,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011363636363636364,"readMsAvg":"7","waitRatioAvg":0.00909090909090909,"completedParallelInputs":"1","computeRatioMax":0.0022727272727272726,"name":"S02: Input","shuffleOutputBytes":"80","recordsWritten":"5","readRatioMax":0.003977272727272727,"steps":[{"kind":"READ","substeps":["$10:w_warehouse_sk, $11:w_state","FROM warehouse"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage02_output","BY HASH($10)"]}],"writeRatioAvg":0.011363636363636364},{"readMsMax":"89","computeMsMax":"184","waitMsAvg":"34","id":"3","endMs":"1570903805506","waitMsMax":"34","startMs":"1570903804665","waitRatioMax":0.019318181818181818,"readRatioAvg":0.05056818181818182,"parallelInputs":"1","recordsRead":"143868","computeRatioAvg":0.10454545454545454,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"184","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005113636363636364,"readMsAvg":"89","waitRatioAvg":0.019318181818181818,"completedParallelInputs":"1","computeRatioMax":0.10454545454545454,"name":"S03: Input","shuffleOutputBytes":"3861804","recordsWritten":"143868","readRatioMax":0.05056818181818182,"steps":[{"kind":"READ","substeps":["$40:cr_item_sk, $41:cr_order_number, $42:cr_refunded_cash","FROM catalog_returns"]},{"kind":"WRITE","substeps":["$40, $41, $42","TO __stage03_output","BY HASH($41, $40)"]}],"writeRatioAvg":0.005113636363636364},{"readMsMax":"37","computeMsMax":"1760","inputStages":["0","1","2","3"],"waitMsAvg":"1","id":"4","endMs":"1570903806550","waitMsMax":"1","startMs":"1570903805587","waitRatioMax":0.0005681818181818182,"readRatioAvg":0.021022727272727273,"parallelInputs":"1","recordsRead":"1582551","computeRatioAvg":1,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"1760","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003409090909090909,"readMsAvg":"37","waitRatioAvg":0.0005681818181818182,"completedParallelInputs":"1","computeRatioMax":1,"name":"S04: Join+","shuffleOutputBytes":"25438","recordsWritten":"553","readRatioMax":0.021022727272727273,"steps":[{"kind":"READ","substeps":["$30:cs_sold_date_sk, $31:cs_warehouse_sk, $32:cs_item_sk, $33:cs_order_number, $34:cs_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$40, $41, $42","FROM __stage03_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage02_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage01_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $120 := $110, $121 := $111","$60 := SUM($71)","$61 := SUM($70)"]},{"kind":"COMPUTE","substeps":["$70 := case_no_value(greater_or_equal(CAST($114 AS DATE), 11839), subtract($112, coalesce($113, 0)), 0)","$71 := case_no_value(less(CAST($114 AS DATE), 11839), subtract($112, coalesce($113, 0)), 0)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $101 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $91 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $81 = $10"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $33 = $41, $32 = $40"]},{"kind":"WRITE","substeps":["$120, $121, $60, $61","TO __stage04_output","BY HASH($120, $121)"]}],"writeRatioAvg":0.003409090909090909},{"readMsMax":"0","computeMsMax":"7","inputStages":["4"],"waitMsAvg":"1","id":"5","endMs":"1570903806823","waitMsMax":"1","startMs":"1570903806729","waitRatioMax":0.0005681818181818182,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"553","computeRatioAvg":0.003977272727272727,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.016477272727272726,"readMsAvg":"0","waitRatioAvg":0.0005681818181818182,"completedParallelInputs":"1","computeRatioMax":0.003977272727272727,"name":"S05: Sort+","shuffleOutputBytes":"4600","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$120, $121, $60, $61","FROM __stage04_output"]},{"kind":"SORT","substeps":["$130 ASC, $131 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $130 := $120, $131 := $121","$50 := SUM($60)","$51 := SUM($61)"]},{"kind":"WRITE","substeps":["$140, $141, $142, $143","TO __stage05_output"]}],"writeRatioAvg":0.016477272727272726},{"readMsMax":"0","computeMsMax":"4","inputStages":["5"],"waitMsAvg":"1","id":"6","endMs":"1570903806840","waitMsMax":"1","startMs":"1570903806749","waitRatioMax":0.0005681818181818182,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0022727272727272726,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002840909090909091,"readMsAvg":"0","waitRatioAvg":0.0005681818181818182,"completedParallelInputs":"1","computeRatioMax":0.0022727272727272726,"name":"S06: Output","shuffleOutputBytes":"4600","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$140, $141, $142, $143","FROM __stage05_output"]},{"kind":"SORT","substeps":["$140 ASC, $141 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$150, $151, $152, $153","TO __stage06_output"]}],"writeRatioAvg":0.002840909090909091}],"estimatedBytesProcessed":"62826704","timeline":[{"totalSlotMs":"277","activeUnits":"1","completedUnits":"3","elapsedMs":"659","pendingUnits":"1"},{"totalSlotMs":"1664","activeUnits":"1","completedUnits":"4","elapsedMs":"1673","pendingUnits":"1"},{"totalSlotMs":"3079","activeUnits":"1","completedUnits":"7","elapsedMs":"3923","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"62914560","totalPartitionsProcessed":"0","totalBytesProcessed":"62826704","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"warehouse","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"}]},"endTime":"1570903808288"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query40_1570903802"},"etag":"uLFZon0J39lcyn5pU3S1cg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query40_1570903802?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon7bbcd599f972f0ea74619bb1805fa86a66b9d0f4","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query40\nSELECT\n w_state , \n i_item_id , \n Sum( \n CASE \n WHEN ( \n Cast(d_date AS DATE) < Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) \n ELSE 0 \n END) AS sales_before , \n Sum( \n CASE \n WHEN ( \n Cast(d_date AS DATE) >= Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) \n ELSE 0 \n END) AS sales_after \nFROM catalog_sales \nLEFT OUTER JOIN catalog_returns \nON ( \n cs_order_number = cr_order_number \n AND cs_item_sk = cr_item_sk) , \n warehouse , \n item , \n date_dim \nWHERE i_current_price BETWEEN 0.99 AND 1.49 \nAND i_item_sk = cs_item_sk \nAND cs_warehouse_sk = w_warehouse_sk \nAND cs_sold_date_sk = d_date_sk \nAND Cast(d_date AS DATE) BETWEEN (Cast ('2002-05-01' AS DATE)) AND cast ('2002-07-01' AS date)\nGROUP BY w_state, \n i_item_id \nORDER BY w_state, \n i_item_id \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query40_1570903802","user_email":"nithish.sankaranarayanan@ulb.be"}
