{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"21993","creationTime":"1570903722048","totalBytesProcessed":"36132628","startTime":"1570903722213","query":{"totalSlotMs":"21993","queryPlan":[{"readMsMax":"15","computeMsMax":"14","waitMsAvg":"1","id":"0","endMs":"1570903722581","waitMsMax":"1","startMs":"1570903722494","waitRatioMax":0.002105263157894737,"readRatioAvg":0.031578947368421054,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.029473684210526315,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"14","shuffleOutputBytesSpilled":"0","writeRatioMax":0.014736842105263158,"readMsAvg":"15","waitRatioAvg":0.002105263157894737,"completedParallelInputs":"1","computeRatioMax":0.029473684210526315,"name":"S00: Input","shuffleOutputBytes":"828","recordsWritten":"92","readRatioMax":0.031578947368421054,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $11:d_date","FROM date_dim","WHERE between(CAST($11 AS DATE), 11385, 11476)"]},{"kind":"WRITE","substeps":["$10","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.014736842105263158},{"readMsMax":"11","computeMsMax":"23","waitMsAvg":"43","id":"2","endMs":"1570903722656","waitMsMax":"43","startMs":"1570903722577","waitRatioMax":0.09052631578947369,"readRatioAvg":0.023157894736842106,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.04842105263157895,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"23","shuffleOutputBytesSpilled":"0","writeRatioMax":0.014736842105263158,"readMsAvg":"11","waitRatioAvg":0.09052631578947369,"completedParallelInputs":"1","computeRatioMax":0.04842105263157895,"name":"S02: Input","shuffleOutputBytes":"828","recordsWritten":"92","readRatioMax":0.023157894736842106,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_date","FROM date_dim","WHERE between(CAST($31 AS DATE), 11385, 11476)"]},{"kind":"WRITE","substeps":["$30","TO __stage02_output","BY HASH($30)"]}],"writeRatioAvg":0.014736842105263158},{"readMsMax":"6","computeMsMax":"7","waitMsAvg":"27","id":"3","endMs":"1570903722667","waitMsMax":"27","startMs":"1570903722583","waitRatioMax":0.056842105263157895,"readRatioAvg":0.01263157894736842,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.014736842105263158,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.035789473684210524,"readMsAvg":"6","waitRatioAvg":0.056842105263157895,"completedParallelInputs":"1","computeRatioMax":0.014736842105263158,"name":"S03: Input","shuffleOutputBytes":"135","recordsWritten":"15","readRatioMax":0.01263157894736842,"steps":[{"kind":"READ","substeps":["$40:i_item_sk, $41:i_manufact_id","FROM item","WHERE equal($41, 610)"]},{"kind":"WRITE","substeps":["$40","TO __stage03_output","BY HASH($40)"]}],"writeRatioAvg":0.035789473684210524},{"readMsMax":"27","computeMsMax":"398","inputStages":["0"],"waitMsAvg":"5","id":"5","endMs":"1570903722877","waitMsMax":"5","startMs":"1570903722620","waitRatioMax":0.010526315789473684,"readRatioAvg":0.056842105263157895,"parallelInputs":"1","recordsRead":"1437534","computeRatioAvg":0.8378947368421052,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"398","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04,"readMsAvg":"27","waitRatioAvg":0.010526315789473684,"completedParallelInputs":"1","computeRatioMax":0.8378947368421052,"name":"S05: Join","shuffleOutputBytes":"749402","recordsWritten":"41677","readRatioMax":0.056842105263157895,"steps":[{"kind":"READ","substeps":["$1:cs_sold_date_sk, $2:cs_item_sk, $3:cs_ext_discount_amt","FROM catalog_sales"]},{"kind":"READ","substeps":["$10","FROM __stage00_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $10"]},{"kind":"WRITE","substeps":["$120, $121","TO __stage05_output","BY HASH($120)"]}],"writeRatioAvg":0.04},{"readMsMax":"0","computeMsMax":"7","inputStages":["5"],"waitMsAvg":"3","id":"6","endMs":"1570903723171","waitMsMax":"7","startMs":"1570903722946","waitRatioMax":0.014736842105263158,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"41677","computeRatioAvg":0.008421052631578947,"writeMsAvg":"177","status":"COMPLETE","writeMsMax":"198","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.4168421052631579,"readMsAvg":"0","waitRatioAvg":0.00631578947368421,"completedParallelInputs":"100","computeRatioMax":0.014736842105263158,"name":"S06: Coalesce","shuffleOutputBytes":"749402","recordsWritten":"41677","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage05_output"]}],"writeRatioAvg":0.3726315789473684},{"readMsMax":"30","computeMsMax":"475","inputStages":["6","2","3"],"waitMsAvg":"7","id":"7","endMs":"1570903723400","waitMsMax":"7","startMs":"1570903723045","waitRatioMax":0.014736842105263158,"readRatioAvg":0.06315789473684211,"parallelInputs":"1","recordsRead":"1479226","computeRatioAvg":1,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"475","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008421052631578947,"readMsAvg":"30","waitRatioAvg":0.014736842105263158,"completedParallelInputs":"1","computeRatioMax":1,"name":"S07: Join+","shuffleOutputBytes":"2613","recordsWritten":"46","readRatioMax":0.06315789473684211,"steps":[{"kind":"READ","substeps":["$20:cs_sold_date_sk, $21:cs_item_sk, $22:cs_ext_discount_amt","FROM catalog_sales"]},{"kind":"READ","substeps":["$40","FROM __stage03_output"]},{"kind":"READ","substeps":["$30","FROM __stage02_output"]},{"kind":"READ","substeps":["$120, $121","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $140 := $131","$80 := SHARD_AVG($132)","$81 := ANY_VALUE($130)"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $111 = $120"]},{"kind":"COMPUTE","substeps":["$90 := UNIQUE_ROW_ID()"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $100 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $21 = $40"]},{"kind":"WRITE","substeps":["$80, $81, $140","TO __stage07_output","BY HASH($140)"]}],"writeRatioAvg":0.008421052631578947},{"readMsMax":"0","computeMsMax":"4","inputStages":["7"],"waitMsAvg":"4","id":"8","endMs":"1570903723490","waitMsMax":"4","startMs":"1570903723478","waitRatioMax":0.008421052631578947,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"46","computeRatioAvg":0.008421052631578947,"writeMsAvg":"2","status":"COMPLETE","writeMsMax":"2","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004210526315789474,"readMsAvg":"0","waitRatioAvg":0.008421052631578947,"completedParallelInputs":"1","computeRatioMax":0.008421052631578947,"name":"S08: Aggregate+","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$80, $81, $140","FROM __stage07_output"]},{"kind":"AGGREGATE","substeps":["$60 := SUM($71)"]},{"kind":"FILTER","substeps":["greater($71, multiply(1.3, $70))"]},{"kind":"AGGREGATE","substeps":["GROUP BY $150 := $140","$70 := ROOT_AVG($80)","$71 := ANY_VALUE($81)"]},{"kind":"WRITE","substeps":["$60","TO __stage08_output"]}],"writeRatioAvg":0.004210526315789474},{"readMsMax":"0","computeMsMax":"8","inputStages":["8"],"waitMsAvg":"2","id":"9","endMs":"1570903723787","waitMsMax":"2","startMs":"1570903723570","waitRatioMax":0.004210526315789474,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.016842105263157894,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"28","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05894736842105263,"readMsAvg":"0","waitRatioAvg":0.004210526315789474,"completedParallelInputs":"1","computeRatioMax":0.016842105263157894,"name":"S09: Output","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$60","FROM __stage08_output"]},{"kind":"LIMIT","substeps":["100"]},{"kind":"AGGREGATE","substeps":["$50 := SUM($60)"]},{"kind":"WRITE","substeps":["$50","TO __stage09_output"]}],"writeRatioAvg":0.05894736842105263}],"estimatedBytesProcessed":"36132628","timeline":[{"totalSlotMs":"1118","activeUnits":"100","completedUnits":"4","elapsedMs":"783","pendingUnits":"101"},{"totalSlotMs":"21993","activeUnits":"0","completedUnits":"107","elapsedMs":"1769","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"36700160","totalPartitionsProcessed":"0","totalBytesProcessed":"36132628","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"}]},"endTime":"1570903724018"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query32_1570903719"},"etag":"zUNpkOy3biqzBSDk9SCsOw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query32_1570903719?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonf7f780207b2056f81614dcefc755a59cfcd95c79","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query32\nSELECT \n Sum(cs_ext_discount_amt) AS excess_discount_amount\nFROM catalog_sales , \n item , \n date_dim \nWHERE i_manufact_id = 610 \nAND i_item_sk = cs_item_sk \nAND Cast(d_date AS DATE) BETWEEN Cast('2001-03-04' AS DATE) AND ( \n Cast('2001-06-03' AS DATE)) \nAND d_date_sk = cs_sold_date_sk \nAND cs_ext_discount_amt > \n ( \n SELECT 1.3 benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup avg(cs_ext_discount_amt) \n FROM catalog_sales , \n date_dim \n WHERE cs_item_sk = i_item_sk \n AND Cast(d_date AS DATE) BETWEEN Cast('2001-03-04' AS DATE) AND ( \n Cast('2001-06-03' AS DATE)) \n AND d_date_sk = cs_sold_date_sk ) \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query32_1570903719","user_email":"nithish.sankaranarayanan@ulb.be"}
