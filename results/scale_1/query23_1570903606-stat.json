{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"92763","creationTime":"1570903608931","totalBytesProcessed":"202594099","startTime":"1570903609159","query":{"totalSlotMs":"92763","queryPlan":[{"readMsMax":"9","computeMsMax":"7","waitMsAvg":"1","id":"0","endMs":"1570903609557","waitMsMax":"1","startMs":"1570903609355","waitRatioMax":7.593591009188245e-05,"readRatioAvg":0.0006834231908269421,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0005315513706431772,"writeMsAvg":"184","status":"COMPLETE","writeMsMax":"184","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01397220745690637,"readMsAvg":"9","waitRatioAvg":7.593591009188245e-05,"completedParallelInputs":"1","computeRatioMax":0.0005315513706431772,"name":"S00: Input","shuffleOutputBytes":"13149","recordsWritten":"1461","readRatioMax":0.0006834231908269421,"steps":[{"kind":"READ","substeps":["$180:d_date_sk, $181:d_year","FROM date_dim","WHERE in($181, 1998, 1999, 2000, 2001)"]},{"kind":"WRITE","substeps":["$180","TO __stage00_output","BY HASH($180)"]}],"writeRatioAvg":0.01397220745690637},{"readMsMax":"10","computeMsMax":"51","waitMsAvg":"1","id":"1","endMs":"1570903609494","waitMsMax":"1","startMs":"1570903609432","waitRatioMax":7.593591009188245e-05,"readRatioAvg":0.0007593591009188245,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.003872731414686005,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"16","computeMsAvg":"51","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0012149745614701193,"readMsAvg":"10","waitRatioAvg":7.593591009188245e-05,"completedParallelInputs":"1","computeRatioMax":0.003872731414686005,"name":"S01: Input","shuffleOutputBytes":"900000","recordsWritten":"100000","readRatioMax":0.0007593591009188245,"steps":[{"kind":"READ","substeps":["$170:c_customer_sk","FROM customer"]},{"kind":"WRITE","substeps":["$170","TO __stage01_output","BY HASH($170)"]}],"writeRatioAvg":0.0012149745614701193},{"readMsMax":"7","computeMsMax":"8","waitMsAvg":"31","id":"3","endMs":"1570903609692","waitMsMax":"31","startMs":"1570903609495","waitRatioMax":0.002354013212848356,"readRatioAvg":0.0005315513706431772,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0006074872807350596,"writeMsAvg":"35","status":"COMPLETE","writeMsMax":"35","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002657756853215886,"readMsAvg":"7","waitRatioAvg":0.002354013212848356,"completedParallelInputs":"1","computeRatioMax":0.0006074872807350596,"name":"S03: Input","shuffleOutputBytes":"13149","recordsWritten":"1461","readRatioMax":0.0005315513706431772,"steps":[{"kind":"READ","substeps":["$140:d_date_sk, $141:d_year","FROM date_dim","WHERE in($141, 1998, 1999, 2000, 2001)"]},{"kind":"WRITE","substeps":["$140","TO __stage03_output","BY HASH($140)"]}],"writeRatioAvg":0.002657756853215886},{"readMsMax":"6","computeMsMax":"45","waitMsAvg":"37","id":"4","endMs":"1570903609736","waitMsMax":"37","startMs":"1570903609519","waitRatioMax":0.0028096286733996505,"readRatioAvg":0.0004556154605512947,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.00341711595413471,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"45","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007593591009188245,"readMsAvg":"6","waitRatioAvg":0.0028096286733996505,"completedParallelInputs":"1","computeRatioMax":0.00341711595413471,"name":"S04: Input","shuffleOutputBytes":"900000","recordsWritten":"100000","readRatioMax":0.0004556154605512947,"steps":[{"kind":"READ","substeps":["$130:c_customer_sk","FROM customer"]},{"kind":"WRITE","substeps":["$130","TO __stage04_output","BY HASH($130)"]}],"writeRatioAvg":0.0007593591009188245},{"readMsMax":"18","computeMsMax":"55","waitMsAvg":"1","id":"6","endMs":"1570903610368","waitMsMax":"1","startMs":"1570903609531","waitRatioMax":7.593591009188245e-05,"readRatioAvg":0.0013668463816538842,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.0041764750550535345,"writeMsAvg":"139","status":"COMPLETE","writeMsMax":"139","computeMsAvg":"55","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01055509150277166,"readMsAvg":"18","waitRatioAvg":7.593591009188245e-05,"completedParallelInputs":"1","computeRatioMax":0.0041764750550535345,"name":"S06: Input","shuffleOutputBytes":"2040607","recordsWritten":"18000","readRatioMax":0.0013668463816538842,"steps":[{"kind":"READ","substeps":["$90:i_item_sk, $91:i_item_desc","FROM item"]},{"kind":"WRITE","substeps":["$90, $91","TO __stage06_output","BY HASH($90)"]}],"writeRatioAvg":0.01055509150277166},{"readMsMax":"10","computeMsMax":"10","waitMsAvg":"1","id":"7","endMs":"1570903609762","waitMsMax":"1","startMs":"1570903609549","waitRatioMax":7.593591009188245e-05,"readRatioAvg":0.0007593591009188245,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0007593591009188245,"writeMsAvg":"186","status":"COMPLETE","writeMsMax":"186","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.014124079277090137,"readMsAvg":"10","waitRatioAvg":7.593591009188245e-05,"completedParallelInputs":"1","computeRatioMax":0.0007593591009188245,"name":"S07: Input","shuffleOutputBytes":"35064","recordsWritten":"1461","readRatioMax":0.0007593591009188245,"steps":[{"kind":"READ","substeps":["$190:d_date_sk, $191:d_date, $192:d_year","FROM date_dim","WHERE in($192, 1998, 1999, 2000, 2001)"]},{"kind":"WRITE","substeps":["$190, $191","TO __stage07_output","BY HASH($190)"]}],"writeRatioAvg":0.014124079277090137},{"readMsMax":"14","computeMsMax":"41","waitMsAvg":"4","id":"9","endMs":"1570903609747","waitMsMax":"4","startMs":"1570903609644","waitRatioMax":0.0003037436403675298,"readRatioAvg":0.0010631027412863544,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.0031133723137671803,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"41","shuffleOutputBytesSpilled":"0","writeRatioMax":0.000835295011010707,"readMsAvg":"14","waitRatioAvg":0.0003037436403675298,"completedParallelInputs":"1","computeRatioMax":0.0031133723137671803,"name":"S09: Input","shuffleOutputBytes":"2040607","recordsWritten":"18000","readRatioMax":0.0010631027412863544,"steps":[{"kind":"READ","substeps":["$80:i_item_sk, $81:i_item_desc","FROM item"]},{"kind":"WRITE","substeps":["$80, $81","TO __stage09_output","BY HASH($80)"]}],"writeRatioAvg":0.000835295011010707},{"readMsMax":"12","computeMsMax":"11","waitMsAvg":"1","id":"10","endMs":"1570903609728","waitMsMax":"1","startMs":"1570903609653","waitRatioMax":7.593591009188245e-05,"readRatioAvg":0.0009112309211025895,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.000835295011010707,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0004556154605512947,"readMsAvg":"12","waitRatioAvg":7.593591009188245e-05,"completedParallelInputs":"1","computeRatioMax":0.000835295011010707,"name":"S0A: Input","shuffleOutputBytes":"35064","recordsWritten":"1461","readRatioMax":0.0009112309211025895,"steps":[{"kind":"READ","substeps":["$150:d_date_sk, $151:d_date, $152:d_year","FROM date_dim","WHERE in($152, 1998, 1999, 2000, 2001)"]},{"kind":"WRITE","substeps":["$150, $151","TO __stage0A_output","BY HASH($150)"]}],"writeRatioAvg":0.0004556154605512947},{"readMsMax":"8","computeMsMax":"55","waitMsAvg":"1","id":"12","endMs":"1570903609734","waitMsMax":"1","startMs":"1570903609683","waitRatioMax":7.593591009188245e-05,"readRatioAvg":0.0006074872807350596,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.0041764750550535345,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"55","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007593591009188245,"readMsAvg":"8","waitRatioAvg":7.593591009188245e-05,"completedParallelInputs":"1","computeRatioMax":0.0041764750550535345,"name":"S0C: Input","shuffleOutputBytes":"900000","recordsWritten":"100000","readRatioMax":0.0006074872807350596,"steps":[{"kind":"READ","substeps":["$70:c_customer_sk","FROM customer"]},{"kind":"WRITE","substeps":["$70","TO __stage0C_output","BY HASH($70)"]}],"writeRatioAvg":0.0007593591009188245},{"readMsMax":"19","computeMsMax":"67","waitMsAvg":"3","id":"14","endMs":"1570903609816","waitMsMax":"3","startMs":"1570903609712","waitRatioMax":0.00022780773027564736,"readRatioAvg":0.0014427822917457665,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.005087705976156124,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"67","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0012909104715620016,"readMsAvg":"19","waitRatioAvg":0.00022780773027564736,"completedParallelInputs":"1","computeRatioMax":0.005087705976156124,"name":"S0E: Input","shuffleOutputBytes":"900000","recordsWritten":"100000","readRatioMax":0.0014427822917457665,"steps":[{"kind":"READ","substeps":["$50:c_customer_sk","FROM customer"]},{"kind":"WRITE","substeps":["$50","TO __stage0E_output","BY HASH($50)"]}],"writeRatioAvg":0.0012909104715620016},{"readMsMax":"35","computeMsMax":"5075","inputStages":["0","1"],"waitMsAvg":"5","id":"17","endMs":"1570903612669","waitMsMax":"5","startMs":"1570903609776","waitRatioMax":0.00037967955045941227,"readRatioAvg":0.002657756853215886,"parallelInputs":"1","recordsRead":"2982639","computeRatioAvg":0.3853747437163034,"writeMsAvg":"38","status":"COMPLETE","writeMsMax":"38","computeMsAvg":"5075","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002885564583491533,"readMsAvg":"35","waitRatioAvg":0.00037967955045941227,"completedParallelInputs":"1","computeRatioMax":0.3853747437163034,"name":"S11: Join+","shuffleOutputBytes":"1534410","recordsWritten":"85245","readRatioMax":0.002657756853215886,"steps":[{"kind":"READ","substeps":["$160:ss_sold_date_sk, $161:ss_customer_sk, $162:ss_quantity, $163:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$170","FROM __stage01_output"]},{"kind":"READ","substeps":["$180","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $640 := $632","$430 := SUM($460)"]},{"kind":"COMPUTE","substeps":["$460 := multiply(CAST($630 AS DOUBLE), $631)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $620 = $180"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $161 = $170"]},{"kind":"WRITE","substeps":["$640, $430","TO __stage11_output","BY HASH($640)"]}],"writeRatioAvg":0.002885564583491533},{"readMsMax":"21","computeMsMax":"4303","inputStages":["12"],"waitMsAvg":"1","id":"19","endMs":"1570903612305","waitMsMax":"1","startMs":"1570903609875","waitRatioMax":7.593591009188245e-05,"readRatioAvg":0.0015946541119295314,"parallelInputs":"1","recordsRead":"2981178","computeRatioAvg":0.32675222112537017,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"4303","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0017465259321132963,"readMsAvg":"21","waitRatioAvg":7.593591009188245e-05,"completedParallelInputs":"1","computeRatioMax":0.32675222112537017,"name":"S13: Join+","shuffleOutputBytes":"1635444","recordsWritten":"90858","readRatioMax":0.0015946541119295314,"steps":[{"kind":"READ","substeps":["$60:ss_customer_sk, $61:ss_quantity, $62:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$70","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $740 := $732","$360 := SUM($400)"]},{"kind":"COMPUTE","substeps":["$400 := multiply(CAST($730 AS DOUBLE), $731)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $60 = $70"]},{"kind":"WRITE","substeps":["$740, $360","TO __stage13_output","BY HASH($740)"]}],"writeRatioAvg":0.0017465259321132963},{"readMsMax":"30","computeMsMax":"4008","inputStages":["3","4"],"waitMsAvg":"1","id":"20","endMs":"1570903612224","waitMsMax":"1","startMs":"1570903609893","waitRatioMax":7.593591009188245e-05,"readRatioAvg":0.0022780773027564734,"parallelInputs":"1","recordsRead":"2982639","computeRatioAvg":0.3043511276482649,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"26","computeMsAvg":"4008","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0019743336623889436,"readMsAvg":"30","waitRatioAvg":7.593591009188245e-05,"completedParallelInputs":"1","computeRatioMax":0.3043511276482649,"name":"S14: Join+","shuffleOutputBytes":"1534410","recordsWritten":"85245","readRatioMax":0.0022780773027564734,"steps":[{"kind":"READ","substeps":["$120:ss_sold_date_sk, $121:ss_customer_sk, $122:ss_quantity, $123:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$130","FROM __stage04_output"]},{"kind":"READ","substeps":["$140","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $490 := $482","$410 := SUM($450)"]},{"kind":"COMPUTE","substeps":["$450 := multiply(CAST($480 AS DOUBLE), $481)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $470 = $140"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $121 = $130"]},{"kind":"WRITE","substeps":["$490, $410","TO __stage14_output","BY HASH($490)"]}],"writeRatioAvg":0.0019743336623889436},{"readMsMax":"21","computeMsMax":"10179","inputStages":["9","10"],"waitMsAvg":"2","id":"21","endMs":"1570903615678","waitMsMax":"2","startMs":"1570903609912","waitRatioMax":0.0001518718201837649,"readRatioAvg":0.0015946541119295314,"parallelInputs":"1","recordsRead":"2900639","computeRatioAvg":0.7729516288252715,"writeMsAvg":"48","status":"COMPLETE","writeMsMax":"48","computeMsAvg":"10179","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003644923684410358,"readMsAvg":"21","waitRatioAvg":0.0001518718201837649,"completedParallelInputs":"1","computeRatioMax":0.7729516288252715,"name":"S15: Join+","shuffleOutputBytes":"136578418","recordsWritten":"2077849","readRatioMax":0.0015946541119295314,"steps":[{"kind":"READ","substeps":["$100:ss_sold_date_sk, $101:ss_item_sk","FROM store_sales"]},{"kind":"READ","substeps":["$150, $151","FROM __stage0A_output"]},{"kind":"READ","substeps":["$80, $81","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $550 := $420, $551 := $541, $552 := $540","$370 := COUNT_STAR()"]},{"kind":"COMPUTE","substeps":["$420 := substr($542, 1, 30)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $530 = $80"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $100 = $150"]},{"kind":"WRITE","substeps":["$551, $552, $370, $550","TO __stage15_output","BY HASH($550, $551, $552)"]}],"writeRatioAvg":0.003644923684410358},{"readMsMax":"21","computeMsMax":"4529","inputStages":["14"],"waitMsAvg":"1","id":"23","endMs":"1570903612287","waitMsMax":"1","startMs":"1570903609952","waitRatioMax":7.593591009188245e-05,"readRatioAvg":0.0015946541119295314,"parallelInputs":"1","recordsRead":"2981178","computeRatioAvg":0.34391373680613563,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"26","computeMsAvg":"4529","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0019743336623889436,"readMsAvg":"21","waitRatioAvg":7.593591009188245e-05,"completedParallelInputs":"1","computeRatioMax":0.34391373680613563,"name":"S17: Join+","shuffleOutputBytes":"1635444","recordsWritten":"90858","readRatioMax":0.0015946541119295314,"steps":[{"kind":"READ","substeps":["$40:ss_customer_sk, $41:ss_quantity, $42:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$50","FROM __stage0E_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $590 := $582","$340 := SUM($380)"]},{"kind":"COMPUTE","substeps":["$380 := multiply(CAST($580 AS DOUBLE), $581)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $50"]},{"kind":"WRITE","substeps":["$590, $340","TO __stage17_output","BY HASH($590)"]}],"writeRatioAvg":0.0019743336623889436},{"readMsMax":"29","computeMsMax":"13169","inputStages":["6","7"],"waitMsAvg":"2","id":"24","endMs":"1570903618676","waitMsMax":"2","startMs":"1570903610549","waitRatioMax":0.0001518718201837649,"readRatioAvg":0.0022021413926645913,"parallelInputs":"1","recordsRead":"2900639","computeRatioAvg":1,"writeMsAvg":"52","status":"COMPLETE","writeMsMax":"52","computeMsAvg":"13169","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003948667324777887,"readMsAvg":"29","waitRatioAvg":0.0001518718201837649,"completedParallelInputs":"1","computeRatioMax":1,"name":"S18: Join+","shuffleOutputBytes":"136578418","recordsWritten":"2077849","readRatioMax":0.0022021413926645913,"steps":[{"kind":"READ","substeps":["$110:ss_sold_date_sk, $111:ss_item_sk","FROM store_sales"]},{"kind":"READ","substeps":["$190, $191","FROM __stage07_output"]},{"kind":"READ","substeps":["$90, $91","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $700 := $440, $701 := $691, $702 := $690","$390 := COUNT_STAR()"]},{"kind":"COMPUTE","substeps":["$440 := substr($692, 1, 30)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $680 = $90"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $110 = $190"]},{"kind":"WRITE","substeps":["$701, $702, $390, $700","TO __stage18_output","BY HASH($700, $701, $702)"]}],"writeRatioAvg":0.003948667324777887},{"readMsMax":"0","computeMsMax":"47","inputStages":["20"],"waitMsAvg":"1","id":"25","endMs":"1570903612628","waitMsMax":"1","startMs":"1570903612406","waitRatioMax":7.593591009188245e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"85245","computeRatioAvg":0.0035689877743184753,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"47","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00037967955045941227,"readMsAvg":"0","waitRatioAvg":7.593591009188245e-05,"completedParallelInputs":"1","computeRatioMax":0.0035689877743184753,"name":"S19: Aggregate","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$490, $410","FROM __stage14_output"]},{"kind":"AGGREGATE","substeps":["$290 := MAX($330)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $500 := $490","$330 := SUM($410)"]},{"kind":"WRITE","substeps":["$290","TO __stage19_output"]}],"writeRatioAvg":0.00037967955045941227},{"readMsMax":"0","computeMsMax":"3","inputStages":["25"],"waitMsAvg":"2","id":"26","endMs":"1570903612671","waitMsMax":"2","startMs":"1570903612408","waitRatioMax":0.0001518718201837649,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.00022780773027564736,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0003037436403675298,"readMsAvg":"0","waitRatioAvg":0.0001518718201837649,"completedParallelInputs":"1","computeRatioMax":0.00022780773027564736,"name":"S1A: Aggregate","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$290","FROM __stage19_output"]},{"kind":"AGGREGATE","substeps":["$250 := MAX($290)"]},{"kind":"WRITE","substeps":["$250","TO __stage1A_output"]}],"writeRatioAvg":0.0003037436403675298},{"readMsMax":"0","computeMsMax":"59","inputStages":["17"],"waitMsAvg":"1","id":"27","endMs":"1570903613079","waitMsMax":"1","startMs":"1570903612902","waitRatioMax":7.593591009188245e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"85245","computeRatioAvg":0.004480218695421065,"writeMsAvg":"129","status":"COMPLETE","writeMsMax":"129","computeMsAvg":"59","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009795732401852835,"readMsAvg":"0","waitRatioAvg":7.593591009188245e-05,"completedParallelInputs":"1","computeRatioMax":0.004480218695421065,"name":"S1B: Aggregate","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$640, $430","FROM __stage11_output"]},{"kind":"AGGREGATE","substeps":["$310 := MAX($350)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $650 := $640","$350 := SUM($430)"]},{"kind":"WRITE","substeps":["$310","TO __stage1B_output"]}],"writeRatioAvg":0.009795732401852835},{"readMsMax":"0","computeMsMax":"4","inputStages":["27"],"waitMsAvg":"2","id":"28","endMs":"1570903613096","waitMsMax":"2","startMs":"1570903612904","waitRatioMax":0.0001518718201837649,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.0003037436403675298,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0003037436403675298,"readMsAvg":"0","waitRatioAvg":0.0001518718201837649,"completedParallelInputs":"1","computeRatioMax":0.0003037436403675298,"name":"S1C: Aggregate","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$310","FROM __stage1B_output"]},{"kind":"AGGREGATE","substeps":["$260 := MAX($310)"]},{"kind":"WRITE","substeps":["$260","TO __stage1C_output"]}],"writeRatioAvg":0.0003037436403675298},{"readMsMax":"0","computeMsMax":"3879","inputStages":["24"],"waitMsAvg":"4","id":"29","endMs":"1570903620799","waitMsMax":"4","startMs":"1570903618810","waitRatioMax":0.0003037436403675298,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2077849","computeRatioAvg":0.29455539524641206,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"3879","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0022021413926645913,"readMsAvg":"0","waitRatioAvg":0.0003037436403675298,"completedParallelInputs":"1","computeRatioMax":0.29455539524641206,"name":"S1D: Repartition","shuffleOutputBytes":"136578418","recordsWritten":"2077849","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage18_output"]}],"writeRatioAvg":0.0022021413926645913},{"readMsMax":"0","computeMsMax":"61","inputStages":["19"],"waitMsAvg":"1","id":"30","endMs":"1570903621326","waitMsMax":"1","startMs":"1570903620873","waitRatioMax":7.593591009188245e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"90859","computeRatioAvg":0.00463209051560483,"writeMsAvg":"218","status":"COMPLETE","writeMsMax":"218","computeMsAvg":"61","shuffleOutputBytesSpilled":"0","writeRatioMax":0.016554028400030375,"readMsAvg":"0","waitRatioAvg":7.593591009188245e-05,"completedParallelInputs":"1","computeRatioMax":0.00463209051560483,"name":"S1E: Aggregate+","shuffleOutputBytes":"108","recordsWritten":"12","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$260","FROM __stage1C_output"]},{"kind":"READ","substeps":["$740, $360","FROM __stage13_output"]},{"kind":"FILTER","substeps":["greater($280, multiply(0.95, $260))"]},{"kind":"AGGREGATE","substeps":["GROUP BY $750 := $740","$280 := SUM($360)"]},{"kind":"WRITE","substeps":["$750","TO __stage1E_output","BY HASH($750)"]}],"writeRatioAvg":0.016554028400030375},{"readMsMax":"0","computeMsMax":"429","inputStages":["29","24"],"waitMsAvg":"1","id":"31","endMs":"1570903621437","waitMsMax":"1","startMs":"1570903620946","waitRatioMax":7.593591009188245e-05,"readRatioAvg":0,"parallelInputs":"10","recordsRead":"2077849","computeRatioAvg":0.028627838104639685,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"377","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007593591009188245,"readMsAvg":"0","waitRatioAvg":7.593591009188245e-05,"completedParallelInputs":"10","computeRatioMax":0.03257650542941757,"name":"S1F: Aggregate+","shuffleOutputBytes":"873","recordsWritten":"97","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$701, $702, $390, $700","FROM __stage18_output"]},{"kind":"FILTER","substeps":["greater($320, 4)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $710 := $700, $711 := $701, $712 := $702","$320 := SUM_OF_COUNTS($390)"]},{"kind":"WRITE","substeps":["$711","TO __stage1F_output","BY HASH($711)"]}],"writeRatioAvg":0.0005315513706431772},{"readMsMax":"8","computeMsMax":"7","waitMsAvg":"2","id":"32","endMs":"1570903621219","waitMsMax":"2","startMs":"1570903621022","waitRatioMax":0.0001518718201837649,"readRatioAvg":0.0006074872807350596,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0005315513706431772,"writeMsAvg":"177","status":"COMPLETE","writeMsMax":"177","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013440656086263193,"readMsAvg":"8","waitRatioAvg":0.0001518718201837649,"completedParallelInputs":"1","computeRatioMax":0.0005315513706431772,"name":"S20: Input","shuffleOutputBytes":"270","recordsWritten":"30","readRatioMax":0.0006074872807350596,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_year, $32:d_moy","FROM date_dim","WHERE and(equal($31, 1998), equal($32, 6))"]},{"kind":"WRITE","substeps":["$30","TO __stage20_output","BY HASH($30)"]}],"writeRatioAvg":0.013440656086263193},{"readMsMax":"0","computeMsMax":"58","inputStages":["23"],"waitMsAvg":"1","id":"34","endMs":"1570903621266","waitMsMax":"1","startMs":"1570903621105","waitRatioMax":7.593591009188245e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"90859","computeRatioAvg":0.004404282785329183,"writeMsAvg":"112","status":"COMPLETE","writeMsMax":"112","computeMsAvg":"58","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008504821930290835,"readMsAvg":"0","waitRatioAvg":7.593591009188245e-05,"completedParallelInputs":"1","computeRatioMax":0.004404282785329183,"name":"S22: Aggregate+","shuffleOutputBytes":"108","recordsWritten":"12","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$250","FROM __stage1A_output"]},{"kind":"READ","substeps":["$590, $340","FROM __stage17_output"]},{"kind":"FILTER","substeps":["greater($270, multiply(0.95, $250))"]},{"kind":"AGGREGATE","substeps":["GROUP BY $600 := $590","$270 := SUM($340)"]},{"kind":"WRITE","substeps":["$600","TO __stage22_output","BY HASH($600)"]}],"writeRatioAvg":0.008504821930290835},{"readMsMax":"0","computeMsMax":"6237","inputStages":["21"],"waitMsAvg":"1","id":"35","endMs":"1570903624429","waitMsMax":"1","startMs":"1570903621180","waitRatioMax":7.593591009188245e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2077849","computeRatioAvg":0.47361227124307087,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"6237","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00037967955045941227,"readMsAvg":"0","waitRatioAvg":7.593591009188245e-05,"completedParallelInputs":"1","computeRatioMax":0.47361227124307087,"name":"S23: Aggregate+","shuffleOutputBytes":"873","recordsWritten":"97","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$551, $552, $370, $550","FROM __stage15_output"]},{"kind":"FILTER","substeps":["greater($300, 4)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $560 := $550, $561 := $551, $562 := $552","$300 := SUM_OF_COUNTS($370)"]},{"kind":"WRITE","substeps":["$561","TO __stage23_output","BY HASH($561)"]}],"writeRatioAvg":0.00037967955045941227},{"readMsMax":"10","computeMsMax":"11","waitMsAvg":"2","id":"36","endMs":"1570903621423","waitMsMax":"2","startMs":"1570903621204","waitRatioMax":0.0001518718201837649,"readRatioAvg":0.0007593591009188245,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.000835295011010707,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007593591009188245,"readMsAvg":"10","waitRatioAvg":0.0001518718201837649,"completedParallelInputs":"1","computeRatioMax":0.000835295011010707,"name":"S24: Input","shuffleOutputBytes":"270","recordsWritten":"30","readRatioMax":0.0007593591009188245,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_year, $22:d_moy","FROM date_dim","WHERE and(equal($21, 1998), equal($22, 6))"]},{"kind":"WRITE","substeps":["$20","TO __stage24_output","BY HASH($20)"]}],"writeRatioAvg":0.0007593591009188245},{"readMsMax":"0","computeMsMax":"8","inputStages":["31"],"waitMsAvg":"2","id":"38","endMs":"1570903621631","waitMsMax":"4","startMs":"1570903621509","waitRatioMax":0.0003037436403675298,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"97","computeRatioAvg":0.00037967955045941227,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"41","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0031133723137671803,"readMsAvg":"0","waitRatioAvg":0.0001518718201837649,"completedParallelInputs":"100","computeRatioMax":0.0006074872807350596,"name":"S26: Coalesce","shuffleOutputBytes":"873","recordsWritten":"97","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage1F_output"]}],"writeRatioAvg":0.001518718201837649},{"readMsMax":"0","computeMsMax":"8","inputStages":["30"],"waitMsAvg":"4","id":"39","endMs":"1570903621620","waitMsMax":"6","startMs":"1570903621513","waitRatioMax":0.0004556154605512947,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"12","computeRatioAvg":0.00037967955045941227,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"52","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003948667324777887,"readMsAvg":"0","waitRatioAvg":0.0003037436403675298,"completedParallelInputs":"100","computeRatioMax":0.0006074872807350596,"name":"S27: Coalesce","shuffleOutputBytes":"108","recordsWritten":"12","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage1E_output"]}],"writeRatioAvg":0.001822461842205179},{"readMsMax":"0","computeMsMax":"8","inputStages":["35"],"waitMsAvg":"2","id":"40","endMs":"1570903624967","waitMsMax":"3","startMs":"1570903624856","waitRatioMax":0.00022780773027564736,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"97","computeRatioAvg":0.00037967955045941227,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"37","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0028096286733996505,"readMsAvg":"0","waitRatioAvg":0.0001518718201837649,"completedParallelInputs":"100","computeRatioMax":0.0006074872807350596,"name":"S28: Coalesce","shuffleOutputBytes":"873","recordsWritten":"97","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage23_output"]}],"writeRatioAvg":0.0014427822917457665},{"readMsMax":"0","computeMsMax":"9","inputStages":["34"],"waitMsAvg":"3","id":"41","endMs":"1570903624981","waitMsMax":"4","startMs":"1570903624858","waitRatioMax":0.0003037436403675298,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"12","computeRatioAvg":0.00037967955045941227,"writeMsAvg":"37","status":"COMPLETE","writeMsMax":"61","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00463209051560483,"readMsAvg":"0","waitRatioAvg":0.00022780773027564736,"completedParallelInputs":"100","computeRatioMax":0.0006834231908269421,"name":"S29: Coalesce","shuffleOutputBytes":"108","recordsWritten":"12","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage22_output"]}],"writeRatioAvg":0.0028096286733996505},{"readMsMax":"240","computeMsMax":"1021","inputStages":["26","39","38","28","32","41","40","36"],"waitMsAvg":"4","id":"42","endMs":"1570903625843","waitMsMax":"6","startMs":"1570903624862","waitRatioMax":0.0004556154605512947,"readRatioAvg":0.010479155592679779,"parallelInputs":"2","recordsRead":"2158483","computeRatioAvg":0.05209203432303136,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"686","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00037967955045941227,"readMsAvg":"138","waitRatioAvg":0.0003037436403675298,"completedParallelInputs":"2","computeRatioMax":0.07753056420381198,"name":"S2A: Join+","shuffleOutputBytes":"2","recordsWritten":"2","readRatioMax":0.018224618422051787,"steps":[{"kind":"READ","substeps":["$250","FROM __stage1A_output"]},{"kind":"READ","substeps":["$1:cs_sold_date_sk, $2:cs_bill_customer_sk, $3:cs_item_sk, $4:cs_quantity, $5:cs_list_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$20","FROM __stage24_output"]},{"kind":"READ","substeps":["$561","FROM __stage28_output"]},{"kind":"READ","substeps":["$600","FROM __stage29_output"]},{"kind":"READ","substeps":["$260","FROM __stage1C_output"]},{"kind":"READ","substeps":["$10:ws_sold_date_sk, $11:ws_item_sk, $12:ws_bill_customer_sk, $13:ws_quantity, $14:ws_list_price","FROM web_sales"]},{"kind":"READ","substeps":["$30","FROM __stage20_output"]},{"kind":"READ","substeps":["$711","FROM __stage26_output"]},{"kind":"READ","substeps":["$750","FROM __stage27_output"]},{"kind":"AGGREGATE","substeps":["$210 := SUM($220)"]},{"kind":"COMPUTE","substeps":["$230 := multiply(CAST($610 AS DOUBLE), $611)"]},{"kind":"JOIN","substeps":["SEMI HASH JOIN EACH WITH ALL ON $570 = $600"]},{"kind":"JOIN","substeps":["SEMI HASH JOIN EACH WITH ALL ON $521 = $561"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $20"]},{"kind":"COMPUTE","substeps":["$240 := multiply(CAST($760 AS DOUBLE), $761)"]},{"kind":"JOIN","substeps":["SEMI HASH JOIN EACH WITH ALL ON $720 = $750"]},{"kind":"JOIN","substeps":["SEMI HASH JOIN EACH WITH ALL ON $670 = $711"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $10 = $30"]},{"kind":"WRITE","substeps":["$210","TO __stage2A_output"]}],"writeRatioAvg":0.0003037436403675298},{"readMsMax":"0","computeMsMax":"6","inputStages":["42"],"waitMsAvg":"1","id":"43","endMs":"1570903626042","waitMsMax":"1","startMs":"1570903624885","waitRatioMax":7.593591009188245e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2","computeRatioAvg":0.0004556154605512947,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0004556154605512947,"readMsAvg":"0","waitRatioAvg":7.593591009188245e-05,"completedParallelInputs":"1","computeRatioMax":0.0004556154605512947,"name":"S2B: Output","shuffleOutputBytes":"1","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$210","FROM __stage2A_output"]},{"kind":"LIMIT","substeps":["100"]},{"kind":"AGGREGATE","substeps":["$200 := SUM($210)"]},{"kind":"WRITE","substeps":["$200","TO __stage2B_output"]}],"writeRatioAvg":0.0004556154605512947}],"estimatedBytesProcessed":"202594099","timeline":[{"totalSlotMs":"1780","activeUnits":"6","completedUnits":"9","elapsedMs":"699","pendingUnits":"7"},{"totalSlotMs":"10049","activeUnits":"6","completedUnits":"10","elapsedMs":"1896","pendingUnits":"6"},{"totalSlotMs":"28802","activeUnits":"2","completedUnits":"18","elapsedMs":"4249","pendingUnits":"2"},{"totalSlotMs":"36004","activeUnits":"1","completedUnits":"19","elapsedMs":"7025","pendingUnits":"1"},{"totalSlotMs":"40306","activeUnits":"1","completedUnits":"20","elapsedMs":"10025","pendingUnits":"1"},{"totalSlotMs":"65491","activeUnits":"6","completedUnits":"235","elapsedMs":"12677","pendingUnits":"1"},{"totalSlotMs":"90572","activeUnits":"168","completedUnits":"437","elapsedMs":"16322","pendingUnits":"2"},{"totalSlotMs":"92763","activeUnits":"2","completedUnits":"439","elapsedMs":"17193","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"203423744","totalPartitionsProcessed":"0","totalBytesProcessed":"202594099","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"}]},"endTime":"1570903626389"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query23_1570903606"},"etag":"IPBq3co9cyAWsp+fOEXHkA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query23_1570903606?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anone2fbb2295ce5551cf82360896d4270789cb7c2cc","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query23\nWITH frequent_ss_items \n AS (SELECT Substr(i_item_desc, 1, 30) itemdesc, \n i_item_sk item_sk, \n d_date solddate, \n Count(*) cnt \n FROM store_sales, \n date_dim, \n item \n WHERE ss_sold_date_sk = d_date_sk \n AND ss_item_sk = i_item_sk \n AND d_year IN ( 1998, 1998 + 1, 1998 + 2, 1998 + 3 ) \n GROUP BY 1, \n i_item_sk, \n d_date \n HAVING Count(*) > 4), \n max_store_sales \n AS (SELECT Max(csales) tpcds_cmax \n FROM (SELECT c_customer_sk, \n Sum(ss_quantity benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup ss_sales_price) csales \n FROM store_sales, \n customer, \n date_dim \n WHERE ss_customer_sk = c_customer_sk \n AND ss_sold_date_sk = d_date_sk \n AND d_year IN ( 1998, 1998 + 1, 1998 + 2, 1998 + 3 ) \n GROUP BY c_customer_sk)), \n best_ss_customer \n AS (SELECT c_customer_sk, \n Sum(ss_quantity benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup ss_sales_price) ssales \n FROM store_sales, \n customer \n WHERE ss_customer_sk = c_customer_sk \n GROUP BY c_customer_sk \n HAVING Sum(ss_quantity benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup ss_sales_price) > \n ( 95 / 100.0 ) benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup (SELECT benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup \n FROM max_store_sales)) \nSELECT Sum(sales) \nFROM (SELECT cs_quantity benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup cs_list_price sales \n FROM catalog_sales, \n date_dim \n WHERE d_year = 1998 \n AND d_moy = 6 \n AND cs_sold_date_sk = d_date_sk \n AND cs_item_sk IN (SELECT item_sk \n FROM frequent_ss_items) \n AND cs_bill_customer_sk IN (SELECT c_customer_sk \n FROM best_ss_customer) \n UNION ALL \n SELECT ws_quantity benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup ws_list_price sales \n FROM web_sales, \n date_dim \n WHERE d_year = 1998 \n AND d_moy = 6 \n AND ws_sold_date_sk = d_date_sk \n AND ws_item_sk IN (SELECT item_sk \n FROM frequent_ss_items) \n AND ws_bill_customer_sk IN (SELECT c_customer_sk \n FROM best_ss_customer)) LIMIT 100; "},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query23_1570903606","user_email":"nithish.sankaranarayanan@ulb.be"}
