{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"3641","creationTime":"1570903587229","totalBytesProcessed":"373217471","startTime":"1570903587394","query":{"totalSlotMs":"3641","queryPlan":[{"readMsMax":"14","computeMsMax":"19","waitMsAvg":"10","id":"0","endMs":"1570903587707","waitMsMax":"10","startMs":"1570903587654","waitRatioMax":0.0031036623215394167,"readRatioAvg":0.004345127250155183,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.005896958410924891,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002482929857231533,"readMsAvg":"14","waitRatioAvg":0.0031036623215394167,"completedParallelInputs":"1","computeRatioMax":0.005896958410924891,"name":"S00: Input","shuffleOutputBytes":"1488","recordsWritten":"62","readRatioMax":0.004345127250155183,"steps":[{"kind":"READ","substeps":["$1:d_date_sk, $2:d_date","FROM date_dim","WHERE between(CAST($2 AS DATE), 11060, 11121)"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.002482929857231533},{"readMsMax":"7","computeMsMax":"10","waitMsAvg":"44","id":"1","endMs":"1570903587785","waitMsMax":"44","startMs":"1570903587702","waitRatioMax":0.013656114214773432,"readRatioAvg":0.0021725636250775914,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.0031036623215394167,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00558659217877095,"readMsAvg":"7","waitRatioAvg":0.013656114214773432,"completedParallelInputs":"1","computeRatioMax":0.0031036623215394167,"name":"S01: Input","shuffleOutputBytes":"35220","recordsWritten":"1174","readRatioMax":0.0021725636250775914,"steps":[{"kind":"READ","substeps":["$30:i_item_sk, $31:i_item_id, $32:i_current_price","FROM item","WHERE between($32, 0.99, 1.49)"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage01_output","BY HASH($30)"]}],"writeRatioAvg":0.00558659217877095},{"readMsMax":"47","computeMsMax":"9","waitMsAvg":"33","id":"2","endMs":"1570903587770","waitMsMax":"33","startMs":"1570903587707","waitRatioMax":0.010242085661080074,"readRatioAvg":0.014587212911235258,"parallelInputs":"1","recordsRead":"5","computeRatioAvg":0.002793296089385475,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0015518311607697084,"readMsAvg":"47","waitRatioAvg":0.010242085661080074,"completedParallelInputs":"1","computeRatioMax":0.002793296089385475,"name":"S02: Input","shuffleOutputBytes":"151","recordsWritten":"5","readRatioMax":0.014587212911235258,"steps":[{"kind":"READ","substeps":["$20:w_warehouse_sk, $21:w_warehouse_name","FROM warehouse"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.0015518311607697084},{"readMsMax":"120","computeMsMax":"3222","inputStages":["0","1","2"],"waitMsAvg":"3","id":"5","endMs":"1570903589829","waitMsMax":"3","startMs":"1570903587893","waitRatioMax":0.000931098696461825,"readRatioAvg":0.037243947858473,"parallelInputs":"1","recordsRead":"11746241","computeRatioAvg":1,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"3222","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0012414649286157666,"readMsAvg":"120","waitRatioAvg":0.000931098696461825,"completedParallelInputs":"1","computeRatioMax":1,"name":"S05: Join+","shuffleOutputBytes":"176085","recordsWritten":"2925","readRatioMax":0.037243947858473,"steps":[{"kind":"READ","substeps":["$10:inv_date_sk, $11:inv_item_sk, $12:inv_warehouse_sk, $13:inv_quantity_on_hand","FROM inventory"]},{"kind":"READ","substeps":["$20, $21","FROM __stage02_output"]},{"kind":"READ","substeps":["$30, $31","FROM __stage01_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $100 := $91, $101 := $92","$50 := SUM($61)","$51 := SUM($60)"]},{"kind":"COMPUTE","substeps":["$60 := case_no_value(greater_or_equal(CAST($93 AS DATE), 11090), $90, 0)","$61 := case_no_value(less(CAST($93 AS DATE), 11090), $90, 0)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $80 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $71 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $12 = $20"]},{"kind":"WRITE","substeps":["$100, $101, $50, $51","TO __stage05_output","BY HASH($100, $101)"]}],"writeRatioAvg":0.0012414649286157666},{"readMsMax":"0","computeMsMax":"9","inputStages":["5"],"waitMsAvg":"2","id":"6","endMs":"1570903590614","waitMsMax":"2","startMs":"1570903590421","waitRatioMax":0.0006207324643078833,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2925","computeRatioAvg":0.002793296089385475,"writeMsAvg":"182","status":"COMPLETE","writeMsMax":"182","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05648665425201738,"readMsAvg":"0","waitRatioAvg":0.0006207324643078833,"completedParallelInputs":"1","computeRatioMax":0.002793296089385475,"name":"S06: Sort+","shuffleOutputBytes":"6300","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$100, $101, $50, $51","FROM __stage05_output"]},{"kind":"SORT","substeps":["$110 ASC, $111 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["between(case_no_value(greater($40, 0), divide(CAST($41 AS DOUBLE), CAST($40 AS DOUBLE)), NULL), 0.66666666666666663, 1.5)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $110 := $100, $111 := $101","$40 := SUM($50)","$41 := SUM($51)"]},{"kind":"WRITE","substeps":["$120, $121, $122, $123","TO __stage06_output"]}],"writeRatioAvg":0.05648665425201738},{"readMsMax":"0","computeMsMax":"4","inputStages":["6"],"waitMsAvg":"13","id":"7","endMs":"1570903590641","waitMsMax":"13","startMs":"1570903590518","waitRatioMax":0.0040347610180012415,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0012414649286157666,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0015518311607697084,"readMsAvg":"0","waitRatioAvg":0.0040347610180012415,"completedParallelInputs":"1","computeRatioMax":0.0012414649286157666,"name":"S07: Output","shuffleOutputBytes":"6300","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$120, $121, $122, $123","FROM __stage06_output"]},{"kind":"SORT","substeps":["$120 ASC, $121 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$130, $131, $132, $133","TO __stage07_output"]}],"writeRatioAvg":0.0015518311607697084}],"estimatedBytesProcessed":"373217471","timeline":[{"totalSlotMs":"253","activeUnits":"1","completedUnits":"3","elapsedMs":"761","pendingUnits":"1"},{"totalSlotMs":"3641","activeUnits":"0","completedUnits":"6","elapsedMs":"3424","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"373293056","totalPartitionsProcessed":"0","totalBytesProcessed":"373217471","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"warehouse","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"inventory","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"}]},"endTime":"1570903590864"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query21_1570903584"},"etag":"fuE+we8M/zLXoPPfwXdmLw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query21_1570903584?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonfc8ca8a3978dba21c7aec9780aef848144ae634d","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query21\nSELECT\n benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup \nFROM ( \n SELECT w_warehouse_name , \n i_item_id , \n Sum( \n CASE \n WHEN ( \n Cast(d_date AS DATE) < Cast ('2000-05-13' AS DATE)) THEN inv_quantity_on_hand \n ELSE 0 \n END) AS inv_before , \n Sum( \n CASE \n WHEN ( \n Cast(d_date AS DATE) >= Cast ('2000-05-13' AS DATE)) THEN inv_quantity_on_hand \n ELSE 0 \n END) AS inv_after \n FROM inventory , \n warehouse , \n item , \n date_dim \n WHERE i_current_price BETWEEN 0.99 AND 1.49 \n AND i_item_sk = inv_item_sk \n AND inv_warehouse_sk = w_warehouse_sk \n AND inv_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN (Cast ('2000-04-13' AS DATE)) AND ( \n cast ('2000-06-13' AS date)) \n GROUP BY w_warehouse_name, \n i_item_id) x \nWHERE ( \n CASE \n WHEN inv_before > 0 THEN inv_after / inv_before \n ELSE NULL \n END) BETWEEN 2.0/3.0 AND 3.0/2.0 \nORDER BY w_warehouse_name , \n i_item_id \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query21_1570903584","user_email":"nithish.sankaranarayanan@ulb.be"}
