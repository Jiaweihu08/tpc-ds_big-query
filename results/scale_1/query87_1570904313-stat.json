{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"39510","creationTime":"1570904314501","totalBytesProcessed":"82826745","startTime":"1570904314712","query":{"totalSlotMs":"39510","queryPlan":[{"readMsMax":"11","computeMsMax":"118","waitMsAvg":"0","id":"0","endMs":"1570904315708","waitMsMax":"0","startMs":"1570904314975","waitRatioMax":0,"readRatioAvg":0.004852227613586237,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.05205116894574327,"writeMsAvg":"15","status":"COMPLETE","writeMsMax":"15","computeMsAvg":"118","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0066166740185266875,"readMsAvg":"11","waitRatioAvg":0,"completedParallelInputs":"1","computeRatioMax":0.05205116894574327,"name":"S00: Input","shuffleOutputBytes":"3027711","recordsWritten":"100000","readRatioMax":0.004852227613586237,"steps":[{"kind":"READ","substeps":["$20:c_customer_sk, $21:c_first_name, $22:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$20, $21, $22","TO __stage00_output","BY HASH($20)"]}],"writeRatioAvg":0.0066166740185266875},{"readMsMax":"17","computeMsMax":"10","waitMsAvg":"28","id":"1","endMs":"1570904315069","waitMsMax":"28","startMs":"1570904315019","waitRatioMax":0.012351124834583149,"readRatioAvg":0.007498897220996913,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004411116012351125,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0030877812086457872,"readMsAvg":"17","waitRatioAvg":0.012351124834583149,"completedParallelInputs":"1","computeRatioMax":0.004411116012351125,"name":"S01: Input","shuffleOutputBytes":"8760","recordsWritten":"365","readRatioMax":0.007498897220996913,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_date, $82:d_month_seq","FROM date_dim","WHERE between($82, 1188, 1199)"]},{"kind":"WRITE","substeps":["$80, $81","TO __stage01_output","BY HASH($80)"]}],"writeRatioAvg":0.0030877812086457872},{"readMsMax":"11","computeMsMax":"135","waitMsAvg":"48","id":"3","endMs":"1570904315437","waitMsMax":"48","startMs":"1570904315069","waitRatioMax":0.0211733568592854,"readRatioAvg":0.004852227613586237,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.05955006616674018,"writeMsAvg":"107","status":"COMPLETE","writeMsMax":"107","computeMsAvg":"135","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04719894133215704,"readMsAvg":"11","waitRatioAvg":0.0211733568592854,"completedParallelInputs":"1","computeRatioMax":0.05955006616674018,"name":"S03: Input","shuffleOutputBytes":"3027711","recordsWritten":"100000","readRatioMax":0.004852227613586237,"steps":[{"kind":"READ","substeps":["$10:c_customer_sk, $11:c_first_name, $12:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage03_output","BY HASH($10)"]}],"writeRatioAvg":0.04719894133215704},{"readMsMax":"13","computeMsMax":"7","waitMsAvg":"69","id":"4","endMs":"1570904315319","waitMsMax":"69","startMs":"1570904315106","waitRatioMax":0.030436700485222762,"readRatioAvg":0.005734450816056462,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0030877812086457872,"writeMsAvg":"188","status":"COMPLETE","writeMsMax":"188","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08292898103220114,"readMsAvg":"13","waitRatioAvg":0.030436700485222762,"completedParallelInputs":"1","computeRatioMax":0.0030877812086457872,"name":"S04: Input","shuffleOutputBytes":"8760","recordsWritten":"365","readRatioMax":0.005734450816056462,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_date, $72:d_month_seq","FROM date_dim","WHERE between($72, 1188, 1199)"]},{"kind":"WRITE","substeps":["$70, $71","TO __stage04_output","BY HASH($70)"]}],"writeRatioAvg":0.08292898103220114},{"readMsMax":"13","computeMsMax":"133","waitMsAvg":"30","id":"6","endMs":"1570904315539","waitMsMax":"30","startMs":"1570904315106","waitRatioMax":0.013233348037053375,"readRatioAvg":0.005734450816056462,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.05866784296426996,"writeMsAvg":"168","status":"COMPLETE","writeMsMax":"168","computeMsAvg":"133","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0741067490074989,"readMsAvg":"13","waitRatioAvg":0.013233348037053375,"completedParallelInputs":"1","computeRatioMax":0.05866784296426996,"name":"S06: Input","shuffleOutputBytes":"3027711","recordsWritten":"100000","readRatioMax":0.005734450816056462,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_first_name, $3:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage06_output","BY HASH($1)"]}],"writeRatioAvg":0.0741067490074989},{"readMsMax":"12","computeMsMax":"8","waitMsAvg":"12","id":"7","endMs":"1570904315321","waitMsMax":"12","startMs":"1570904315107","waitRatioMax":0.00529333921482135,"readRatioAvg":0.00529333921482135,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0035288928098809,"writeMsAvg":"191","status":"COMPLETE","writeMsMax":"191","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08425231583590649,"readMsAvg":"12","waitRatioAvg":0.00529333921482135,"completedParallelInputs":"1","computeRatioMax":0.0035288928098809,"name":"S07: Input","shuffleOutputBytes":"8760","recordsWritten":"365","readRatioMax":0.00529333921482135,"steps":[{"kind":"READ","substeps":["$60:d_date_sk, $61:d_date, $62:d_month_seq","FROM date_dim","WHERE between($62, 1188, 1199)"]},{"kind":"WRITE","substeps":["$60, $61","TO __stage07_output","BY HASH($60)"]}],"writeRatioAvg":0.08425231583590649},{"readMsMax":"45","computeMsMax":"2267","inputStages":["3","4"],"waitMsAvg":"2","id":"12","endMs":"1570904316888","waitMsMax":"2","startMs":"1570904315504","waitRatioMax":0.000882223202470225,"readRatioAvg":0.019850022055580063,"parallelInputs":"1","recordsRead":"2981543","computeRatioAvg":1,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"2267","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009263343625937363,"readMsAvg":"45","waitRatioAvg":0.000882223202470225,"completedParallelInputs":"1","computeRatioMax":1,"name":"S0C: Join+","shuffleOutputBytes":"1731911","recordsWritten":"47462","readRatioMax":0.019850022055580063,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_customer_sk","FROM store_sales"]},{"kind":"READ","substeps":["$70, $71","FROM __stage04_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $140 := $132, $141 := $131, $142 := $130"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $120 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $70"]},{"kind":"WRITE","substeps":["$141, $140, $142","TO __stage0C_output","BY HASH($140, $141, $142)"]}],"writeRatioAvg":0.009263343625937363},{"readMsMax":"11","computeMsMax":"246","inputStages":["6","7"],"waitMsAvg":"1","id":"13","endMs":"1570904315785","waitMsMax":"1","startMs":"1570904315613","waitRatioMax":0.0004411116012351125,"readRatioAvg":0.004852227613586237,"parallelInputs":"1","recordsRead":"821124","computeRatioAvg":0.10851345390383767,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"246","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007498897220996913,"readMsAvg":"11","waitRatioAvg":0.0004411116012351125,"completedParallelInputs":"1","computeRatioMax":0.10851345390383767,"name":"S0D: Join+","shuffleOutputBytes":"429900","recordsWritten":"11825","readRatioMax":0.004852227613586237,"steps":[{"kind":"READ","substeps":["$30:ws_sold_date_sk, $31:ws_bill_customer_sk","FROM web_sales"]},{"kind":"READ","substeps":["$60, $61","FROM __stage07_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $222, $231 := $221, $232 := $220"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $210 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $30 = $60"]},{"kind":"WRITE","substeps":["$231, $230, $232","TO __stage0D_output","BY HASH($230, $231, $232)"]}],"writeRatioAvg":0.007498897220996913},{"readMsMax":"23","computeMsMax":"1606","inputStages":["0","1"],"waitMsAvg":"1","id":"14","endMs":"1570904316814","waitMsMax":"1","startMs":"1570904315868","waitRatioMax":0.0004411116012351125,"readRatioAvg":0.010145566828407587,"parallelInputs":"1","recordsRead":"1537807","computeRatioAvg":0.7084252315835906,"writeMsAvg":"85","status":"COMPLETE","writeMsMax":"85","computeMsAvg":"1606","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03749448610498456,"readMsAvg":"23","waitRatioAvg":0.0004411116012351125,"completedParallelInputs":"1","computeRatioMax":0.7084252315835906,"name":"S0E: Join+","shuffleOutputBytes":"1149371","recordsWritten":"31557","readRatioMax":0.010145566828407587,"steps":[{"kind":"READ","substeps":["$50:cs_sold_date_sk, $51:cs_bill_customer_sk","FROM catalog_sales"]},{"kind":"READ","substeps":["$80, $81","FROM __stage01_output"]},{"kind":"READ","substeps":["$20, $21, $22","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $172, $181 := $171, $182 := $170"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $160 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $50 = $80"]},{"kind":"WRITE","substeps":["$181, $180, $182","TO __stage0E_output","BY HASH($180, $181, $182)"]}],"writeRatioAvg":0.03749448610498456},{"readMsMax":"0","computeMsMax":"25","inputStages":["13"],"waitMsAvg":"0","id":"15","endMs":"1570904317087","waitMsMax":"0","startMs":"1570904316994","waitRatioMax":0,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"11825","computeRatioAvg":0.011027790030877812,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"25","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00882223202470225,"readMsAvg":"0","waitRatioAvg":0,"completedParallelInputs":"1","computeRatioMax":0.011027790030877812,"name":"S0F: Aggregate","shuffleOutputBytes":"416160","recordsWritten":"11265","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$231, $230, $232","FROM __stage0D_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230, $241 := $231, $242 := $232"]},{"kind":"WRITE","substeps":["$240, $241, $242","TO __stage0F_output","BY HASH($240, $241, $242)"]}],"writeRatioAvg":0.00882223202470225},{"readMsMax":"0","computeMsMax":"81","inputStages":["14"],"waitMsAvg":"1","id":"16","endMs":"1570904317086","waitMsMax":"1","startMs":"1570904317011","waitRatioMax":0.0004411116012351125,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"31557","computeRatioAvg":0.03573003970004411,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"81","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008381120423467137,"readMsAvg":"0","waitRatioAvg":0.0004411116012351125,"completedParallelInputs":"1","computeRatioMax":0.03573003970004411,"name":"S10: Aggregate","shuffleOutputBytes":"1113227","recordsWritten":"30117","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$181, $180, $182","FROM __stage0E_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $180, $191 := $181, $192 := $182"]},{"kind":"WRITE","substeps":["$190, $191, $192","TO __stage10_output","BY HASH($190, $191, $192)"]}],"writeRatioAvg":0.008381120423467137},{"readMsMax":"0","computeMsMax":"11","inputStages":["16"],"waitMsAvg":"2","id":"17","endMs":"1570904317291","waitMsMax":"5","startMs":"1570904317102","waitRatioMax":0.0022055580061755625,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"30117","computeRatioAvg":0.0030877812086457872,"writeMsAvg":"103","status":"COMPLETE","writeMsMax":"129","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05690339655932951,"readMsAvg":"0","waitRatioAvg":0.000882223202470225,"completedParallelInputs":"100","computeRatioMax":0.004852227613586237,"name":"S11: Coalesce","shuffleOutputBytes":"1113227","recordsWritten":"30117","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage10_output"]}],"writeRatioAvg":0.04543449492721659},{"readMsMax":"0","computeMsMax":"6","inputStages":["15"],"waitMsAvg":"1","id":"18","endMs":"1570904317324","waitMsMax":"3","startMs":"1570904317107","waitRatioMax":0.0013233348037053375,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"11265","computeRatioAvg":0.00176444640494045,"writeMsAvg":"147","status":"COMPLETE","writeMsMax":"194","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08557565063961182,"readMsAvg":"0","waitRatioAvg":0.0004411116012351125,"completedParallelInputs":"100","computeRatioMax":0.002646669607410675,"name":"S12: Coalesce","shuffleOutputBytes":"416160","recordsWritten":"11265","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0F_output"]}],"writeRatioAvg":0.06484340538156154},{"readMsMax":"0","computeMsMax":"111","inputStages":["12","18","17"],"waitMsAvg":"4","id":"19","endMs":"1570904317448","waitMsMax":"4","startMs":"1570904317110","waitRatioMax":0.00176444640494045,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"88844","computeRatioAvg":0.048963387737097484,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"111","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00882223202470225,"readMsAvg":"0","waitRatioAvg":0.00176444640494045,"completedParallelInputs":"1","computeRatioMax":0.048963387737097484,"name":"S13: Join+","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$141, $140, $142","FROM __stage0C_output"]},{"kind":"READ","substeps":["$190, $191, $192","FROM __stage11_output"]},{"kind":"READ","substeps":["$240, $241, $242","FROM __stage12_output"]},{"kind":"AGGREGATE","substeps":["$100 := COUNT($110)"]},{"kind":"COMPUTE","substeps":["$110 := 1"]},{"kind":"JOIN","substeps":["ANTI HASH JOIN EACH WITH ALL ON $201 = $240, $200 = $241, $202 = $242"]},{"kind":"JOIN","substeps":["ANTI HASH JOIN EACH WITH ALL ON $150 = $190, $151 = $191, $152 = $192"]},{"kind":"AGGREGATE","substeps":["GROUP BY $150 := $140, $151 := $141, $152 := $142"]},{"kind":"WRITE","substeps":["$100","TO __stage13_output"]}],"writeRatioAvg":0.00882223202470225},{"readMsMax":"0","computeMsMax":"8","inputStages":["19"],"waitMsAvg":"1","id":"20","endMs":"1570904317467","waitMsMax":"1","startMs":"1570904317207","waitRatioMax":0.0004411116012351125,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.0035288928098809,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002646669607410675,"readMsAvg":"0","waitRatioAvg":0.0004411116012351125,"completedParallelInputs":"1","computeRatioMax":0.0035288928098809,"name":"S14: Output","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$100","FROM __stage13_output"]},{"kind":"AGGREGATE","substeps":["$90 := SUM_OF_COUNTS($100)"]},{"kind":"WRITE","substeps":["$90","TO __stage14_output"]}],"writeRatioAvg":0.002646669607410675}],"estimatedBytesProcessed":"82826745","timeline":[{"totalSlotMs":"1793","activeUnits":"5","completedUnits":"4","elapsedMs":"768","pendingUnits":"5"},{"totalSlotMs":"4788","activeUnits":"2","completedUnits":"7","elapsedMs":"1295","pendingUnits":"2"},{"totalSlotMs":"39510","activeUnits":"26","completedUnits":"213","elapsedMs":"2924","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"82837504","totalPartitionsProcessed":"0","totalBytesProcessed":"82826745","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_1"}]},"endTime":"1570904317669"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query87_1570904313"},"etag":"1TsQoHQYP2mWlswVJDCiOA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query87_1570904313?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon08245d9f818f18f91c71ac0a5146795deb4ea585","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query87\nwith store_customers as (\n select distinct c_last_name as sc_last, c_first_name as sc_first, d_date as sc_date\n from store_sales, date_dim, customer\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_customer_sk = customer.c_customer_sk\n and d_month_seq between 1188 and 1188+11\n),\ncatalog_customers as (\n select distinct c_last_name as cc_last, c_first_name as cc_first, d_date as cc_date\n from catalog_sales, date_dim, customer\n where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1188 and 1188+11\n),\nweb_customers as (\n select distinct c_last_name as wc_last, c_first_name as wc_first, d_date as wc_date\n from web_sales, date_dim, customer\n where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1188 and 1188+11\n)\nselect count(1) \nfrom store_customers \nwhere not exists (\n select 1 from catalog_customers \n where sc_last = cc_last and sc_first = cc_first and sc_date = cc_date\n)\nand not exists (\n select 1 from web_customers \n where sc_last = wc_last and sc_first = wc_first and sc_date = wc_date\n);\n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query87_1570904313","user_email":"nithish.sankaranarayanan@ulb.be"}
