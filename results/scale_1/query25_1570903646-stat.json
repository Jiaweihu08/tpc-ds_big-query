{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"50552","creationTime":"1570903648727","totalBytesProcessed":"195358796","startTime":"1570903648926","query":{"totalSlotMs":"50552","queryPlan":[{"readMsMax":"49","computeMsMax":"74","waitMsAvg":"1","id":"0","endMs":"1570903649855","waitMsMax":"1","startMs":"1570903649094","waitRatioMax":0.0001669449081803005,"readRatioAvg":0.008180300500834724,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.012353923205342237,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"74","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00333889816360601,"readMsAvg":"49","waitRatioAvg":0.0001669449081803005,"completedParallelInputs":"1","computeRatioMax":0.012353923205342237,"name":"S00: Input","shuffleOutputBytes":"2418607","recordsWritten":"18000","readRatioMax":0.008180300500834724,"steps":[{"kind":"READ","substeps":["$1:i_item_sk, $2:i_item_id, $3:i_item_desc","FROM item"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.00333889816360601},{"readMsMax":"7","computeMsMax":"5","waitMsAvg":"26","id":"1","endMs":"1570903649287","waitMsMax":"26","startMs":"1570903649134","waitRatioMax":0.004340567612687813,"readRatioAvg":0.0011686143572621035,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.0008347245409015025,"writeMsAvg":"137","status":"COMPLETE","writeMsMax":"137","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02287145242070117,"readMsAvg":"7","waitRatioAvg":0.004340567612687813,"completedParallelInputs":"1","computeRatioMax":0.0008347245409015025,"name":"S01: Input","shuffleOutputBytes":"465","recordsWritten":"12","readRatioMax":0.0011686143572621035,"steps":[{"kind":"READ","substeps":["$10:s_store_sk, $11:s_store_id, $12:s_store_name","FROM store"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.02287145242070117},{"readMsMax":"16","computeMsMax":"10","waitMsAvg":"52","id":"2","endMs":"1570903649273","waitMsMax":"52","startMs":"1570903649176","waitRatioMax":0.008681135225375626,"readRatioAvg":0.002671118530884808,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.001669449081803005,"writeMsAvg":"56","status":"COMPLETE","writeMsMax":"56","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009348914858096828,"readMsAvg":"16","waitRatioAvg":0.008681135225375626,"completedParallelInputs":"1","computeRatioMax":0.001669449081803005,"name":"S02: Input","shuffleOutputBytes":"1926","recordsWritten":"214","readRatioMax":0.002671118530884808,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_year, $22:d_moy","FROM date_dim","WHERE and(between($22, 4, 10), equal($21, 2001))"]},{"kind":"WRITE","substeps":["$20","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.009348914858096828},{"readMsMax":"8","computeMsMax":"10","waitMsAvg":"79","id":"3","endMs":"1570903649308","waitMsMax":"79","startMs":"1570903649219","waitRatioMax":0.01318864774624374,"readRatioAvg":0.001335559265442404,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.001669449081803005,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0028380634390651085,"readMsAvg":"8","waitRatioAvg":0.01318864774624374,"completedParallelInputs":"1","computeRatioMax":0.001669449081803005,"name":"S03: Input","shuffleOutputBytes":"1926","recordsWritten":"214","readRatioMax":0.001335559265442404,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_year, $32:d_moy","FROM date_dim","WHERE and(between($32, 4, 10), equal($31, 2001))"]},{"kind":"WRITE","substeps":["$30","TO __stage03_output","BY HASH($30)"]}],"writeRatioAvg":0.0028380634390651085},{"readMsMax":"7","computeMsMax":"8","waitMsAvg":"32","id":"4","endMs":"1570903649343","waitMsMax":"32","startMs":"1570903649263","waitRatioMax":0.005342237061769616,"readRatioAvg":0.0011686143572621035,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.001335559265442404,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003005008347245409,"readMsAvg":"7","waitRatioAvg":0.005342237061769616,"completedParallelInputs":"1","computeRatioMax":0.001335559265442404,"name":"S04: Input","shuffleOutputBytes":"270","recordsWritten":"30","readRatioMax":0.0011686143572621035,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year, $52:d_moy","FROM date_dim","WHERE and(equal($52, 4), equal($51, 2001))"]},{"kind":"WRITE","substeps":["$50","TO __stage04_output","BY HASH($50)"]}],"writeRatioAvg":0.003005008347245409},{"readMsMax":"40","computeMsMax":"2858","waitMsAvg":"26","id":"5","endMs":"1570903650700","waitMsMax":"26","startMs":"1570903649274","waitRatioMax":0.004340567612687813,"readRatioAvg":0.00667779632721202,"parallelInputs":"1","recordsRead":"1437442","computeRatioAvg":0.47712854757929885,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"2858","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003672787979966611,"readMsAvg":"40","waitRatioAvg":0.004340567612687813,"completedParallelInputs":"1","computeRatioMax":0.47712854757929885,"name":"S05: Input","shuffleOutputBytes":"51460620","recordsWritten":"1430285","readRatioMax":0.00667779632721202,"steps":[{"kind":"READ","substeps":["$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_net_profit","FROM catalog_sales"]},{"kind":"WRITE","substeps":["$40, $41, $42, $43","TO __stage05_output","BY HASH($41, $42)"]}],"writeRatioAvg":0.003672787979966611},{"readMsMax":"29","computeMsMax":"540","waitMsAvg":"21","id":"6","endMs":"1570903650222","waitMsMax":"21","startMs":"1570903649287","waitRatioMax":0.0035058430717863106,"readRatioAvg":0.004841402337228714,"parallelInputs":"1","recordsRead":"288116","computeRatioAvg":0.09015025041736227,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"540","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0035058430717863106,"readMsAvg":"29","waitRatioAvg":0.0035058430717863106,"completedParallelInputs":"1","computeRatioMax":0.09015025041736227,"name":"S06: Input","shuffleOutputBytes":"12423221","recordsWritten":"277857","readRatioMax":0.004841402337228714,"steps":[{"kind":"READ","substeps":["$70:sr_returned_date_sk, $71:sr_item_sk, $72:sr_customer_sk, $73:sr_ticket_number, $74:sr_net_loss","FROM store_returns"]},{"kind":"WRITE","substeps":["$70, $71, $72, $73, $74","TO __stage06_output","BY HASH($72, $71, $73)"]}],"writeRatioAvg":0.0035058430717863106},{"readMsMax":"0","computeMsMax":"29","inputStages":["5"],"waitMsAvg":"1","id":"9","endMs":"1570903651495","waitMsMax":"2","startMs":"1570903650791","waitRatioMax":0.000333889816360601,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1430285","computeRatioAvg":0.0031719532554257096,"writeMsAvg":"152","status":"COMPLETE","writeMsMax":"194","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.032387312186978295,"readMsAvg":"0","waitRatioAvg":0.0001669449081803005,"completedParallelInputs":"100","computeRatioMax":0.004841402337228714,"name":"S09: Coalesce","shuffleOutputBytes":"51460620","recordsWritten":"1430285","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage05_output"]}],"writeRatioAvg":0.025375626043405677},{"readMsMax":"31","computeMsMax":"5990","inputStages":["0","1","2","6","3","4","9"],"waitMsAvg":"1","id":"10","endMs":"1570903654273","waitMsMax":"1","startMs":"1570903650861","waitRatioMax":0.0001669449081803005,"readRatioAvg":0.0051752921535893155,"parallelInputs":"1","recordsRead":"4589778","computeRatioAvg":1,"writeMsAvg":"2","status":"COMPLETE","writeMsMax":"2","computeMsAvg":"5990","shuffleOutputBytesSpilled":"0","writeRatioMax":0.000333889816360601,"readMsAvg":"31","waitRatioAvg":0.0001669449081803005,"completedParallelInputs":"1","computeRatioMax":1,"name":"S0A: Join+","shuffleOutputBytes":"0","recordsWritten":"0","readRatioMax":0.0051752921535893155,"steps":[{"kind":"READ","substeps":["$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_customer_sk, $63:ss_store_sk, $64:ss_ticket_number, $65:ss_net_profit","FROM store_sales"]},{"kind":"READ","substeps":["$70, $71, $72, $73, $74","FROM __stage06_output"]},{"kind":"READ","substeps":["$40, $41, $42, $43","FROM __stage09_output"]},{"kind":"READ","substeps":["$50","FROM __stage04_output"]},{"kind":"READ","substeps":["$30","FROM __stage03_output"]},{"kind":"READ","substeps":["$20","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage01_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $200 := $195, $201 := $196, $202 := $190, $203 := $191","$90 := MAX($193)","$91 := MAX($194)","$92 := MAX($192)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $181 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $172 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $150 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $135 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $110 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $106 = $41, $105 = $42"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $62 = $72, $61 = $71, $64 = $73"]},{"kind":"WRITE","substeps":["$200, $201, $202, $203, $90, $91, $92","TO __stage0A_output","BY HASH($200, $201, $202, $203)"]}],"writeRatioAvg":0.000333889816360601},{"readMsMax":"0","computeMsMax":"4","inputStages":["10"],"waitMsAvg":"5","id":"11","endMs":"1570903655097","waitMsMax":"5","startMs":"1570903654988","waitRatioMax":0.0008347245409015025,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"0","computeRatioAvg":0.000667779632721202,"writeMsAvg":"54","status":"COMPLETE","writeMsMax":"54","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009015025041736227,"readMsAvg":"0","waitRatioAvg":0.0008347245409015025,"completedParallelInputs":"1","computeRatioMax":0.000667779632721202,"name":"S0B: Sort+","shuffleOutputBytes":"0","recordsWritten":"0","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$200, $201, $202, $203, $90, $91, $92","FROM __stage0A_output"]},{"kind":"SORT","substeps":["$210 ASC, $211 ASC, $212 ASC, $213 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203","$80 := MAX($90)","$81 := MAX($91)","$82 := MAX($92)"]},{"kind":"WRITE","substeps":["$220, $221, $222, $223, $224, $225, $226","TO __stage0B_output"]}],"writeRatioAvg":0.009015025041736227},{"readMsMax":"0","computeMsMax":"6","inputStages":["11"],"waitMsAvg":"1","id":"12","endMs":"1570903655114","waitMsMax":"1","startMs":"1570903655006","waitRatioMax":0.0001669449081803005,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"0","computeRatioAvg":0.001001669449081803,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0008347245409015025,"readMsAvg":"0","waitRatioAvg":0.0001669449081803005,"completedParallelInputs":"1","computeRatioMax":0.001001669449081803,"name":"S0C: Output","shuffleOutputBytes":"0","recordsWritten":"0","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$220, $221, $222, $223, $224, $225, $226","FROM __stage0B_output"]},{"kind":"SORT","substeps":["$220 ASC, $221 ASC, $222 ASC, $223 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$230, $231, $232, $233, $234, $235, $236","TO __stage0C_output"]}],"writeRatioAvg":0.0008347245409015025}],"estimatedBytesProcessed":"195358796","timeline":[{"totalSlotMs":"597","activeUnits":"4","completedUnits":"4","elapsedMs":"669","pendingUnits":"4"},{"totalSlotMs":"8099","activeUnits":"101","completedUnits":"7","elapsedMs":"2006","pendingUnits":"101"},{"totalSlotMs":"44058","activeUnits":"3","completedUnits":"107","elapsedMs":"3071","pendingUnits":"1"},{"totalSlotMs":"50552","activeUnits":"0","completedUnits":"110","elapsedMs":"6331","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"196083712","totalPartitionsProcessed":"0","totalBytesProcessed":"195358796","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"}]},"endTime":"1570903655281"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query25_1570903646"},"etag":"NY2bRAV/RIV+2aF2bF2z/Q==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query25_1570903646?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anoncfb30002c7527243bbab1e1f36af6c8aa7ad44b4","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query25\nSELECT i_item_id, \n i_item_desc, \n s_store_id, \n s_store_name, \n Max(ss_net_profit) AS store_sales_profit, \n Max(sr_net_loss) AS store_returns_loss, \n Max(cs_net_profit) AS catalog_sales_profit \nFROM store_sales, \n store_returns, \n catalog_sales, \n date_dim d1, \n date_dim d2, \n date_dim d3, \n store, \n item \nWHERE d1.d_moy = 4 \n AND d1.d_year = 2001 \n AND d1.d_date_sk = ss_sold_date_sk \n AND i_item_sk = ss_item_sk \n AND s_store_sk = ss_store_sk \n AND ss_customer_sk = sr_customer_sk \n AND ss_item_sk = sr_item_sk \n AND ss_ticket_number = sr_ticket_number \n AND sr_returned_date_sk = d2.d_date_sk \n AND d2.d_moy BETWEEN 4 AND 10 \n AND d2.d_year = 2001 \n AND sr_customer_sk = cs_bill_customer_sk \n AND sr_item_sk = cs_item_sk \n AND cs_sold_date_sk = d3.d_date_sk \n AND d3.d_moy BETWEEN 4 AND 10 \n AND d3.d_year = 2001 \nGROUP BY i_item_id, \n i_item_desc, \n s_store_id, \n s_store_name \nORDER BY i_item_id, \n i_item_desc, \n s_store_id, \n s_store_name\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query25_1570903646","user_email":"nithish.sankaranarayanan@ulb.be"}
