{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"21734","creationTime":"1570903537061","totalBytesProcessed":"83415282","startTime":"1570903537181","query":{"totalSlotMs":"21734","queryPlan":[{"readMsMax":"49","computeMsMax":"98","waitMsAvg":"2","id":"0","endMs":"1570903537475","waitMsMax":"2","startMs":"1570903537332","waitRatioMax":0.0008791208791208791,"readRatioAvg":0.021538461538461538,"parallelInputs":"1","recordsRead":"143868","computeRatioAvg":0.043076923076923075,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"28","computeMsAvg":"98","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012307692307692308,"readMsAvg":"49","waitRatioAvg":0.0008791208791208791,"completedParallelInputs":"1","computeRatioMax":0.043076923076923075,"name":"S00: Input","shuffleOutputBytes":"1294812","recordsWritten":"143868","readRatioMax":0.021538461538461538,"steps":[{"kind":"READ","substeps":["$1:cr_order_number","FROM catalog_returns"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.012307692307692308},{"readMsMax":"122","computeMsMax":"1236","waitMsAvg":"24","id":"1","endMs":"1570903538131","waitMsMax":"24","startMs":"1570903537375","waitRatioMax":0.01054945054945055,"readRatioAvg":0.053626373626373625,"parallelInputs":"1","recordsRead":"1437442","computeRatioAvg":0.5432967032967033,"writeMsAvg":"69","status":"COMPLETE","writeMsMax":"69","computeMsAvg":"1236","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03032967032967033,"readMsAvg":"122","waitRatioAvg":0.01054945054945055,"completedParallelInputs":"1","computeRatioMax":0.5432967032967033,"name":"S01: Input","shuffleOutputBytes":"25815828","recordsWritten":"1437442","readRatioMax":0.053626373626373625,"steps":[{"kind":"READ","substeps":["$10:cs_warehouse_sk, $11:cs_order_number","FROM catalog_sales"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage01_output","BY HASH($11)"]}],"writeRatioAvg":0.03032967032967033},{"readMsMax":"29","computeMsMax":"8","waitMsAvg":"51","id":"2","endMs":"1570903537538","waitMsMax":"51","startMs":"1570903537421","waitRatioMax":0.02241758241758242,"readRatioAvg":0.012747252747252748,"parallelInputs":"1","recordsRead":"6","computeRatioAvg":0.0035164835164835165,"writeMsAvg":"13","status":"COMPLETE","writeMsMax":"13","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005714285714285714,"readMsAvg":"29","waitRatioAvg":0.02241758241758242,"completedParallelInputs":"1","computeRatioMax":0.0035164835164835165,"name":"S02: Input","shuffleOutputBytes":"54","recordsWritten":"6","readRatioMax":0.012747252747252748,"steps":[{"kind":"READ","substeps":["$20:cc_call_center_sk, $21:cc_county","FROM call_center","WHERE in($21, 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County')"]},{"kind":"WRITE","substeps":["$20","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.005714285714285714},{"readMsMax":"12","computeMsMax":"10","waitMsAvg":"4","id":"3","endMs":"1570903537542","waitMsMax":"4","startMs":"1570903537463","waitRatioMax":0.0017582417582417582,"readRatioAvg":0.005274725274725275,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.004395604395604396,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0026373626373626374,"readMsAvg":"12","waitRatioAvg":0.0017582417582417582,"completedParallelInputs":"1","computeRatioMax":0.004395604395604396,"name":"S03: Input","shuffleOutputBytes":"13356","recordsWritten":"1484","readRatioMax":0.005274725274725275,"steps":[{"kind":"READ","substeps":["$40:ca_address_sk, $41:ca_state","FROM customer_address","WHERE equal($41, 'IA')"]},{"kind":"WRITE","substeps":["$40","TO __stage03_output","BY HASH($40)"]}],"writeRatioAvg":0.0026373626373626374},{"readMsMax":"12","computeMsMax":"18","waitMsAvg":"26","id":"4","endMs":"1570903537707","waitMsMax":"26","startMs":"1570903537506","waitRatioMax":0.011428571428571429,"readRatioAvg":0.005274725274725275,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.007912087912087912,"writeMsAvg":"164","status":"COMPLETE","writeMsMax":"164","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.07208791208791208,"readMsAvg":"12","waitRatioAvg":0.011428571428571429,"completedParallelInputs":"1","computeRatioMax":0.007912087912087912,"name":"S04: Input","shuffleOutputBytes":"558","recordsWritten":"62","readRatioMax":0.005274725274725275,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_date","FROM date_dim","WHERE between(CAST($51 AS DATE), 11747, 11808)"]},{"kind":"WRITE","substeps":["$50","TO __stage04_output","BY HASH($50)"]}],"writeRatioAvg":0.07208791208791208},{"readMsMax":"0","computeMsMax":"20","inputStages":["1"],"waitMsAvg":"2","id":"6","endMs":"1570903538543","waitMsMax":"4","startMs":"1570903538287","waitRatioMax":0.0017582417582417582,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1437442","computeRatioAvg":0.006153846153846154,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"109","computeMsAvg":"14","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04791208791208791,"readMsAvg":"0","waitRatioAvg":0.0008791208791208791,"completedParallelInputs":"100","computeRatioMax":0.008791208791208791,"name":"S06: Coalesce","shuffleOutputBytes":"25815828","recordsWritten":"1437442","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage01_output"]}],"writeRatioAvg":0.01054945054945055},{"readMsMax":"121","computeMsMax":"2275","inputStages":["0","6","2","3","4"],"waitMsAvg":"1","id":"7","endMs":"1570903539848","waitMsMax":"1","startMs":"1570903538310","waitRatioMax":0.00043956043956043956,"readRatioAvg":0.05318681318681319,"parallelInputs":"1","recordsRead":"3020304","computeRatioAvg":1,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"2275","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003076923076923077,"readMsAvg":"121","waitRatioAvg":0.00043956043956043956,"completedParallelInputs":"1","computeRatioMax":1,"name":"S07: Join+","shuffleOutputBytes":"2568","recordsWritten":"128","readRatioMax":0.05318681318681319,"steps":[{"kind":"READ","substeps":["$30:cs_ship_date_sk, $31:cs_ship_addr_sk, $32:cs_call_center_sk, $33:cs_warehouse_sk, $34:cs_order_number, $35:cs_ext_ship_cost, $36:cs_net_profit","FROM catalog_sales"]},{"kind":"READ","substeps":["$50","FROM __stage04_output"]},{"kind":"READ","substeps":["$40","FROM __stage03_output"]},{"kind":"READ","substeps":["$20","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage06_output"]},{"kind":"READ","substeps":["$1","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $170, $231 := $150","$140 := SUM($152)","$141 := SUM($151)"]},{"kind":"COMPUTE","substeps":["$150 := if(equal($170, 1), $220, NULL)","$151 := if(equal($170, 0), $222, NULL)","$152 := if(equal($170, 0), $221, NULL)"]},{"kind":"COMPUTE","substeps":["$160 := ARRAY<...>"]},{"kind":"JOIN","substeps":["ANTI HASH JOIN EACH WITH ALL ON $211 = $1"]},{"kind":"JOIN","substeps":["SEMI HASH JOIN EACH WITH ALL ON $201 = $11"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $190 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $180 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $30 = $50"]},{"kind":"WRITE","substeps":["$140, $141, $231, $230","TO __stage07_output","BY HASH($230, $231)"]}],"writeRatioAvg":0.003076923076923077},{"readMsMax":"0","computeMsMax":"9","inputStages":["7"],"waitMsAvg":"4","id":"8","endMs":"1570903540362","waitMsMax":"4","startMs":"1570903540279","waitRatioMax":0.0017582417582417582,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"128","computeRatioAvg":0.003956043956043956,"writeMsAvg":"14","status":"COMPLETE","writeMsMax":"14","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006153846153846154,"readMsAvg":"0","waitRatioAvg":0.0017582417582417582,"completedParallelInputs":"1","computeRatioMax":0.003956043956043956,"name":"S08: Aggregate+","shuffleOutputBytes":"56","recordsWritten":"2","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$140, $141, $231, $230","FROM __stage07_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $250 := $240","$110 := COUNT($122)","$111 := ANY_VALUE($121)","$112 := ANY_VALUE($120)"]},{"kind":"COMPUTE","substeps":["$120 := if(equal($240, 0), $131, NULL)","$121 := if(equal($240, 0), $130, NULL)","$122 := if(equal($240, 1), $241, NULL)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230, $241 := $231","$130 := SUM($140)","$131 := SUM($141)"]},{"kind":"WRITE","substeps":["$110, $111, $112, $250","TO __stage08_output","BY HASH($250)"]}],"writeRatioAvg":0.006153846153846154},{"readMsMax":"0","computeMsMax":"5","inputStages":["8"],"waitMsAvg":"3","id":"9","endMs":"1570903540570","waitMsMax":"3","startMs":"1570903540373","waitRatioMax":0.0013186813186813187,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2","computeRatioAvg":0.002197802197802198,"writeMsAvg":"187","status":"COMPLETE","writeMsMax":"187","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08219780219780219,"readMsAvg":"0","waitRatioAvg":0.0013186813186813187,"completedParallelInputs":"1","computeRatioMax":0.002197802197802198,"name":"S09: Aggregate+","shuffleOutputBytes":"27","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110, $111, $112, $250","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["$80 := ANY_VALUE($92)","$81 := ANY_VALUE($91)","$82 := ANY_VALUE($90)"]},{"kind":"COMPUTE","substeps":["$90 := if(equal($260, 0), $102, NULL)","$91 := if(equal($260, 0), $101, NULL)","$92 := if(equal($260, 1), $100, NULL)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $260 := $250","$100 := SUM_OF_COUNTS($110)","$101 := ANY_VALUE($111)","$102 := ANY_VALUE($112)"]},{"kind":"WRITE","substeps":["$80, $81, $82","TO __stage09_output"]}],"writeRatioAvg":0.08219780219780219},{"readMsMax":"0","computeMsMax":"3","inputStages":["9"],"waitMsAvg":"2","id":"10","endMs":"1570903540582","waitMsMax":"2","startMs":"1570903540387","waitRatioMax":0.0008791208791208791,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.0013186813186813187,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002197802197802198,"readMsAvg":"0","waitRatioAvg":0.0008791208791208791,"completedParallelInputs":"1","computeRatioMax":0.0013186813186813187,"name":"S0A: Output","shuffleOutputBytes":"27","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$80, $81, $82","FROM __stage09_output"]},{"kind":"SORT","substeps":["$60 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$60 := if(is_null($70), 0, $70)"]},{"kind":"AGGREGATE","substeps":["$70 := ANY_VALUE($80)","$71 := ANY_VALUE($81)","$72 := ANY_VALUE($82)"]},{"kind":"WRITE","substeps":["$270, $271, $272","TO __stage0A_output"]}],"writeRatioAvg":0.002197802197802198}],"estimatedBytesProcessed":"83415282","timeline":[{"totalSlotMs":"1058","activeUnits":"1","completedUnits":"4","elapsedMs":"652","pendingUnits":"1"},{"totalSlotMs":"19387","activeUnits":"1","completedUnits":"105","elapsedMs":"1451","pendingUnits":"1"},{"totalSlotMs":"21734","activeUnits":"1","completedUnits":"109","elapsedMs":"3579","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"83886080","totalPartitionsProcessed":"0","totalBytesProcessed":"83415282","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"call_center","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_1"}]},"endTime":"1570903540783"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query16_1570903535"},"etag":"PFP4z3ftHJ4Am6tp7X45/w==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query16_1570903535?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anone3742e0af7ea4d0b00b644c2a130d6e9ad605a87","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query16\nSELECT\n Count(DISTINCT cs_order_number) AS order_count ,\n Sum(cs_ext_ship_cost) AS total_shipping_cost ,\n Sum(cs_net_profit) AS total_net_profit\nFROM catalog_sales cs1 ,\n date_dim ,\n customer_address ,\n call_center\nWHERE Cast(d_date AS DATE) BETWEEN Cast('2002-3-01' AS DATE) AND (\n Cast('2002-5-01' AS DATE))\nAND cs1.cs_ship_date_sk = d_date_sk\nAND cs1.cs_ship_addr_sk = ca_address_sk\nAND ca_state = 'IA'\nAND cs1.cs_call_center_sk = cc_call_center_sk\nAND cc_county IN ('Williamson County',\n 'Williamson County',\n 'Williamson County',\n 'Williamson County',\n 'Williamson County' )\nAND EXISTS\n (\n SELECT dsdgen dsqgen tcp-ds-dsdgen FROM catalog_sales cs2\n WHERE cs1.cs_order_number = cs2.cs_order_number\n AND cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\nAND NOT EXISTS\n (\n SELECT dsdgen dsqgen tcp-ds-dsdgen FROM catalog_returns cr1\n WHERE cs1.cs_order_number = cr1.cr_order_number)\nORDER BY count(DISTINCT cs_order_number)\nLIMIT 100;\n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query16_1570903535","user_email":"nithish.sankaranarayanan@ulb.be"}
