{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"5233","creationTime":"1570904168450","totalBytesProcessed":"162884846","startTime":"1570904168577","query":{"totalSlotMs":"5233","queryPlan":[{"readMsMax":"13","computeMsMax":"28","waitMsAvg":"1","id":"0","endMs":"1570904168792","waitMsMax":"1","startMs":"1570904168746","waitRatioMax":0.000555247084952804,"readRatioAvg":0.007218212104386452,"parallelInputs":"1","recordsRead":"86400","computeRatioAvg":0.015546918378678512,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"28","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004997223764575236,"readMsAvg":"13","waitRatioAvg":0.000555247084952804,"completedParallelInputs":"1","computeRatioMax":0.015546918378678512,"name":"S00: Input","shuffleOutputBytes":"680400","recordsWritten":"25200","readRatioMax":0.007218212104386452,"steps":[{"kind":"READ","substeps":["$1:t_time_sk, $2:t_hour, $3:t_minute, $4:t_meal_time","FROM time_dim","WHERE or(equal($4, 'breakfast'), equal($4, 'dinner'))"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.004997223764575236},{"readMsMax":"9","computeMsMax":"10","waitMsAvg":"29","id":"1","endMs":"1570904169005","waitMsMax":"29","startMs":"1570904168791","waitRatioMax":0.016102165463631316,"readRatioAvg":0.004997223764575236,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.00555247084952804,"writeMsAvg":"193","status":"COMPLETE","writeMsMax":"193","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.10716268739589117,"readMsAvg":"9","waitRatioAvg":0.016102165463631316,"completedParallelInputs":"1","computeRatioMax":0.00555247084952804,"name":"S01: Input","shuffleOutputBytes":"13235","recordsWritten":"338","readRatioMax":0.004997223764575236,"steps":[{"kind":"READ","substeps":["$10:i_item_sk, $11:i_brand_id, $12:i_brand, $13:i_manager_id","FROM item","WHERE equal($13, 1)"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.10716268739589117},{"readMsMax":"18","computeMsMax":"26","waitMsAvg":"18","id":"2","endMs":"1570904169000","waitMsMax":"18","startMs":"1570904168793","waitRatioMax":0.009994447529150472,"readRatioAvg":0.009994447529150472,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.014436424208772903,"writeMsAvg":"176","status":"COMPLETE","writeMsMax":"176","computeMsAvg":"26","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0977234869516935,"readMsAvg":"18","waitRatioAvg":0.009994447529150472,"completedParallelInputs":"1","computeRatioMax":0.014436424208772903,"name":"S02: Input","shuffleOutputBytes":"270","recordsWritten":"30","readRatioMax":0.009994447529150472,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_year, $72:d_moy","FROM date_dim","WHERE and(equal($72, 11), equal($71, 2001))"]},{"kind":"WRITE","substeps":["$70","TO __stage02_output","BY HASH($70)"]}],"writeRatioAvg":0.0977234869516935},{"readMsMax":"16","computeMsMax":"10","waitMsAvg":"1","id":"4","endMs":"1570904168928","waitMsMax":"1","startMs":"1570904168874","waitRatioMax":0.000555247084952804,"readRatioAvg":0.008883953359244865,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.00555247084952804,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004997223764575236,"readMsAvg":"16","waitRatioAvg":0.000555247084952804,"completedParallelInputs":"1","computeRatioMax":0.00555247084952804,"name":"S04: Input","shuffleOutputBytes":"270","recordsWritten":"30","readRatioMax":0.008883953359244865,"steps":[{"kind":"READ","substeps":["$60:d_date_sk, $61:d_year, $62:d_moy","FROM date_dim","WHERE and(equal($62, 11), equal($61, 2001))"]},{"kind":"WRITE","substeps":["$60","TO __stage04_output","BY HASH($60)"]}],"writeRatioAvg":0.004997223764575236},{"readMsMax":"13","computeMsMax":"15","waitMsAvg":"1","id":"6","endMs":"1570904169109","waitMsMax":"1","startMs":"1570904168910","waitRatioMax":0.000555247084952804,"readRatioAvg":0.007218212104386452,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.00832870627429206,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"15","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004997223764575236,"readMsAvg":"13","waitRatioAvg":0.000555247084952804,"completedParallelInputs":"1","computeRatioMax":0.00832870627429206,"name":"S06: Input","shuffleOutputBytes":"270","recordsWritten":"30","readRatioMax":0.007218212104386452,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year, $52:d_moy","FROM date_dim","WHERE and(equal($52, 11), equal($51, 2001))"]},{"kind":"WRITE","substeps":["$50","TO __stage06_output","BY HASH($50)"]}],"writeRatioAvg":0.004997223764575236},{"readMsMax":"45","computeMsMax":"1801","inputStages":["0","2","4","6","1"],"waitMsAvg":"0","id":"8","endMs":"1570904170216","waitMsMax":"1","startMs":"1570904169180","waitRatioMax":0.000555247084952804,"readRatioAvg":0.02109938922820655,"parallelInputs":"3","recordsRead":"5116083","computeRatioAvg":0.5335924486396446,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"15","computeMsAvg":"961","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00832870627429206,"readMsAvg":"38","waitRatioAvg":0,"completedParallelInputs":"3","computeRatioMax":1,"name":"S08: Join+","shuffleOutputBytes":"61921","recordsWritten":"1079","readRatioMax":0.02498611882287618,"steps":[{"kind":"READ","substeps":["$20:ws_sold_date_sk, $21:ws_sold_time_sk, $22:ws_item_sk, $23:ws_ext_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$50","FROM __stage06_output"]},{"kind":"READ","substeps":["$30:cs_sold_date_sk, $31:cs_sold_time_sk, $32:cs_item_sk, $33:cs_ext_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$60","FROM __stage04_output"]},{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_sold_time_sk, $42:ss_item_sk, $43:ss_ext_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$70","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage01_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $181, $191 := $180, $192 := $183, $193 := $184","$90 := SUM($182)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $173 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $101 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $30 = $60"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $70"]},{"kind":"WRITE","substeps":["$192, $193, $191, $190, $90","TO __stage08_output","BY HASH($190, $191, $192, $193)"]}],"writeRatioAvg":0.006662965019433648},{"readMsMax":"0","computeMsMax":"7","inputStages":["8"],"waitMsAvg":"2","id":"9","endMs":"1570904170749","waitMsMax":"2","startMs":"1570904170273","waitRatioMax":0.001110494169905608,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1079","computeRatioAvg":0.003886729594669628,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003331482509716824,"readMsAvg":"0","waitRatioAvg":0.001110494169905608,"completedParallelInputs":"1","computeRatioMax":0.003886729594669628,"name":"S09: Aggregate","shuffleOutputBytes":"61579","recordsWritten":"1073","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$192, $193, $191, $190, $90","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $200 := $190, $201 := $191, $202 := $192, $203 := $193","$80 := SUM($90)"]},{"kind":"WRITE","substeps":["$202, $203, $201, $200, $80","TO __stage09_output"]}],"writeRatioAvg":0.003331482509716824},{"readMsMax":"0","computeMsMax":"5","inputStages":["9"],"waitMsAvg":"4","id":"10","endMs":"1570904171183","waitMsMax":"4","startMs":"1570904170799","waitRatioMax":0.002220988339811216,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1073","computeRatioAvg":0.00277623542476402,"writeMsAvg":"374","status":"COMPLETE","writeMsMax":"374","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.2076624097723487,"readMsAvg":"0","waitRatioAvg":0.002220988339811216,"completedParallelInputs":"1","computeRatioMax":0.00277623542476402,"name":"S0A: Output","shuffleOutputBytes":"61579","recordsWritten":"1073","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$202, $203, $201, $200, $80","FROM __stage09_output"]},{"kind":"SORT","substeps":["$80 DESC, $201 ASC"]},{"kind":"WRITE","substeps":["$210, $211, $212, $213, $214","TO __stage0A_output"]}],"writeRatioAvg":0.2076624097723487}],"estimatedBytesProcessed":"162884846","timeline":[{"totalSlotMs":"698","activeUnits":"3","completedUnits":"5","elapsedMs":"670","pendingUnits":"3"},{"totalSlotMs":"4339","activeUnits":"2","completedUnits":"8","elapsedMs":"1827","pendingUnits":"1"},{"totalSlotMs":"5233","activeUnits":"1","completedUnits":"10","elapsedMs":"2916","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"163577856","totalPartitionsProcessed":"0","totalBytesProcessed":"162884846","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"time_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_1"}]},"endTime":"1570904171521"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query71_1570904167"},"etag":"LI6CAPPNSbir6pCV5Psvyg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query71_1570904167?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon4ae0dfa654dca730e0c8026fd9bd682b7e682cd0","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query71\nSELECT i_brand_id brand_id, \n i_brand brand, \n t_hour, \n t_minute, \n Sum(ext_price) ext_price \nFROM item, \n (SELECT ws_ext_sales_price AS ext_price, \n ws_sold_date_sk AS sold_date_sk, \n ws_item_sk AS sold_item_sk, \n ws_sold_time_sk AS time_sk \n FROM web_sales, \n date_dim \n WHERE d_date_sk = ws_sold_date_sk \n AND d_moy = 11 \n AND d_year = 2001 \n UNION ALL \n SELECT cs_ext_sales_price AS ext_price, \n cs_sold_date_sk AS sold_date_sk, \n cs_item_sk AS sold_item_sk, \n cs_sold_time_sk AS time_sk \n FROM catalog_sales, \n date_dim \n WHERE d_date_sk = cs_sold_date_sk \n AND d_moy = 11 \n AND d_year = 2001 \n UNION ALL \n SELECT ss_ext_sales_price AS ext_price, \n ss_sold_date_sk AS sold_date_sk, \n ss_item_sk AS sold_item_sk, \n ss_sold_time_sk AS time_sk \n FROM store_sales, \n date_dim \n WHERE d_date_sk = ss_sold_date_sk \n AND d_moy = 11 \n AND d_year = 2001) AS tmp, \n time_dim \nWHERE sold_item_sk = i_item_sk \n AND i_manager_id = 1 \n AND time_sk = t_time_sk \n AND ( t_meal_time = 'breakfast' \n OR t_meal_time = 'dinner' ) \nGROUP BY i_brand, \n i_brand_id, \n t_hour, \n t_minute \nORDER BY ext_price DESC, \n i_brand_id; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query71_1570904167","user_email":"nithish.sankaranarayanan@ulb.be"}
