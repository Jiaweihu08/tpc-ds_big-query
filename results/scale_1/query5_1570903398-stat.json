{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"6556","creationTime":"1570903400149","totalBytesProcessed":"186473492","startTime":"1570903400387","query":{"totalSlotMs":"6556","queryPlan":[{"readMsMax":"33","computeMsMax":"7","waitMsAvg":"9","id":"0","endMs":"1570903400807","waitMsMax":"9","startMs":"1570903400698","waitRatioMax":0.00841908325537886,"readRatioAvg":0.03086997193638915,"parallelInputs":"1","recordsRead":"30","computeRatioAvg":0.006548175865294668,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.018709073900841908,"readMsAvg":"33","waitRatioAvg":0.00841908325537886,"completedParallelInputs":"1","computeRatioMax":0.006548175865294668,"name":"S00: Input","shuffleOutputBytes":"900","recordsWritten":"30","readRatioMax":0.03086997193638915,"steps":[{"kind":"READ","substeps":["$20:web_site_sk, $21:web_site_id","FROM web_site"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage00_output","BY HASH($20)"]}],"writeRatioAvg":0.018709073900841908},{"readMsMax":"44","computeMsMax":"18","waitMsAvg":"19","id":"1","endMs":"1570903401033","waitMsMax":"19","startMs":"1570903400757","waitRatioMax":0.01777362020579981,"readRatioAvg":0.0411599625818522,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.01683816651075772,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01683816651075772,"readMsAvg":"44","waitRatioAvg":0.01777362020579981,"completedParallelInputs":"1","computeRatioMax":0.01683816651075772,"name":"S01: Input","shuffleOutputBytes":"135","recordsWritten":"15","readRatioMax":0.0411599625818522,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_date","FROM date_dim","WHERE between(CAST($51 AS DATE), 11921, 11935)"]},{"kind":"WRITE","substeps":["$50","TO __stage01_output","BY HASH($50)"]}],"writeRatioAvg":0.01683816651075772},{"readMsMax":"101","computeMsMax":"731","waitMsAvg":"26","id":"2","endMs":"1570903401750","waitMsMax":"26","startMs":"1570903400786","waitRatioMax":0.02432179607109448,"readRatioAvg":0.09448082319925163,"parallelInputs":"1","recordsRead":"720759","computeRatioAvg":0.6838166510757717,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"731","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02245088868101029,"readMsAvg":"101","waitRatioAvg":0.02432179607109448,"completedParallelInputs":"1","computeRatioMax":0.6838166510757717,"name":"S02: Input","shuffleOutputBytes":"19458989","recordsWritten":"720759","readRatioMax":0.09448082319925163,"steps":[{"kind":"READ","substeps":["$120:ws_item_sk, $121:ws_web_site_sk, $122:ws_order_number","FROM web_sales"]},{"kind":"WRITE","substeps":["$120, $121, $122","TO __stage02_output","BY HASH($120, $122)"]}],"writeRatioAvg":0.02245088868101029},{"readMsMax":"37","computeMsMax":"14","waitMsAvg":"15","id":"3","endMs":"1570903401043","waitMsMax":"15","startMs":"1570903400807","waitRatioMax":0.01403180542563143,"readRatioAvg":0.03461178671655753,"parallelInputs":"1","recordsRead":"11718","computeRatioAvg":0.013096351730589336,"writeMsAvg":"185","status":"COMPLETE","writeMsMax":"185","computeMsAvg":"14","shuffleOutputBytesSpilled":"0","writeRatioMax":0.17305893358278765,"readMsAvg":"37","waitRatioAvg":0.01403180542563143,"completedParallelInputs":"1","computeRatioMax":0.013096351730589336,"name":"S03: Input","shuffleOutputBytes":"351540","recordsWritten":"11718","readRatioMax":0.03461178671655753,"steps":[{"kind":"READ","substeps":["$10:cp_catalog_page_sk, $11:cp_catalog_page_id","FROM catalog_page"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage03_output","BY HASH($10)"]}],"writeRatioAvg":0.17305893358278765},{"readMsMax":"7","computeMsMax":"19","waitMsAvg":"4","id":"4","endMs":"1570903401033","waitMsMax":"4","startMs":"1570903400835","waitRatioMax":0.0037418147801683817,"readRatioAvg":0.006548175865294668,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.01777362020579981,"writeMsAvg":"173","status":"COMPLETE","writeMsMax":"173","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.1618334892422825,"readMsAvg":"7","waitRatioAvg":0.0037418147801683817,"completedParallelInputs":"1","computeRatioMax":0.01777362020579981,"name":"S04: Input","shuffleOutputBytes":"135","recordsWritten":"15","readRatioMax":0.006548175865294668,"steps":[{"kind":"READ","substeps":["$40:d_date_sk, $41:d_date","FROM date_dim","WHERE between(CAST($41 AS DATE), 11921, 11935)"]},{"kind":"WRITE","substeps":["$40","TO __stage04_output","BY HASH($40)"]}],"writeRatioAvg":0.1618334892422825},{"readMsMax":"21","computeMsMax":"4","waitMsAvg":"8","id":"6","endMs":"1570903401041","waitMsMax":"8","startMs":"1570903400940","waitRatioMax":0.007483629560336763,"readRatioAvg":0.019644527595884004,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.0037418147801683817,"writeMsAvg":"71","status":"COMPLETE","writeMsMax":"71","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.06641721234798878,"readMsAvg":"21","waitRatioAvg":0.007483629560336763,"completedParallelInputs":"1","computeRatioMax":0.0037418147801683817,"name":"S06: Input","shuffleOutputBytes":"360","recordsWritten":"12","readRatioMax":0.019644527595884004,"steps":[{"kind":"READ","substeps":["$1:s_store_sk, $2:s_store_id","FROM store"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage06_output","BY HASH($1)"]}],"writeRatioAvg":0.06641721234798878},{"readMsMax":"13","computeMsMax":"19","waitMsAvg":"2","id":"7","endMs":"1570903401062","waitMsMax":"2","startMs":"1570903400966","waitRatioMax":0.0018709073900841909,"readRatioAvg":0.01216089803554724,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.01777362020579981,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00841908325537886,"readMsAvg":"13","waitRatioAvg":0.0018709073900841909,"completedParallelInputs":"1","computeRatioMax":0.01777362020579981,"name":"S07: Input","shuffleOutputBytes":"135","recordsWritten":"15","readRatioMax":0.01216089803554724,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_date","FROM date_dim","WHERE between(CAST($31 AS DATE), 11921, 11935)"]},{"kind":"WRITE","substeps":["$30","TO __stage07_output","BY HASH($30)"]}],"writeRatioAvg":0.00841908325537886},{"readMsMax":"109","computeMsMax":"681","inputStages":["3","4"],"waitMsAvg":"18","id":"10","endMs":"1570903401623","waitMsMax":"18","startMs":"1570903401144","waitRatioMax":0.01683816651075772,"readRatioAvg":0.06641721234798878,"parallelInputs":"2","recordsRead":"1604776","computeRatioAvg":0.35547240411599623,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"13","computeMsAvg":"380","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01216089803554724,"readMsAvg":"71","waitRatioAvg":0.01683816651075772,"completedParallelInputs":"2","computeRatioMax":0.637043966323667,"name":"S0A: Join+","shuffleOutputBytes":"40601","recordsWritten":"713","readRatioMax":0.1019644527595884,"steps":[{"kind":"READ","substeps":["$80:cs_sold_date_sk, $81:cs_catalog_page_sk, $82:cs_ext_sales_price, $83:cs_net_profit","FROM catalog_sales"]},{"kind":"READ","substeps":["$90:cr_returned_date_sk, $91:cr_catalog_page_sk, $92:cr_return_amount, $93:cr_net_loss","FROM catalog_returns"]},{"kind":"READ","substeps":["$40","FROM __stage04_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $400 := $394","$230 := SUM($390)","$231 := SUM($391)","$232 := SUM($392)","$233 := SUM($393)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $380 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $261 = $40"]},{"kind":"COMPUTE","substeps":["$300 := 0"]},{"kind":"COMPUTE","substeps":["$310 := 0"]},{"kind":"WRITE","substeps":["$400, $230, $231, $232, $233","TO __stage0A_output","BY HASH($400)"]}],"writeRatioAvg":0.01028999064546305},{"readMsMax":"36","computeMsMax":"1069","inputStages":["6","7"],"waitMsAvg":"35","id":"11","endMs":"1570903401831","waitMsMax":"35","startMs":"1570903401180","waitRatioMax":0.03274087932647334,"readRatioAvg":0.023386342376052385,"parallelInputs":"2","recordsRead":"3169348","computeRatioAvg":0.5696913002806361,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"609","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004677268475210477,"readMsAvg":"25","waitRatioAvg":0.03274087932647334,"completedParallelInputs":"2","computeRatioMax":1,"name":"S0B: Join+","shuffleOutputBytes":"684","recordsWritten":"12","readRatioMax":0.03367633302151544,"steps":[{"kind":"READ","substeps":["$60:ss_sold_date_sk, $61:ss_store_sk, $62:ss_ext_sales_price, $63:ss_net_profit","FROM store_sales"]},{"kind":"READ","substeps":["$70:sr_returned_date_sk, $71:sr_store_sk, $72:sr_return_amt, $73:sr_net_loss","FROM store_returns"]},{"kind":"READ","substeps":["$30","FROM __stage07_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $360 := $354","$220 := SUM($350)","$221 := SUM($351)","$222 := SUM($352)","$223 := SUM($353)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $340 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $251 = $30"]},{"kind":"COMPUTE","substeps":["$280 := 0"]},{"kind":"COMPUTE","substeps":["$290 := 0"]},{"kind":"WRITE","substeps":["$360, $220, $221, $222, $223","TO __stage0B_output","BY HASH($360)"]}],"writeRatioAvg":0.0037418147801683817},{"readMsMax":"148","computeMsMax":"1025","inputStages":["0","1","2"],"waitMsAvg":"2","id":"12","endMs":"1570903402645","waitMsMax":"2","startMs":"1570903401997","waitRatioMax":0.0018709073900841909,"readRatioAvg":0.10477081384471469,"parallelInputs":"2","recordsRead":"2234488","computeRatioAvg":0.9111318989710009,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"974","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004677268475210477,"readMsAvg":"112","waitRatioAvg":0.0018709073900841909,"completedParallelInputs":"2","computeRatioMax":0.9588400374181478,"name":"S0C: Join+","shuffleOutputBytes":"1710","recordsWritten":"30","readRatioMax":0.1384471468662301,"steps":[{"kind":"READ","substeps":["$100:ws_sold_date_sk, $101:ws_web_site_sk, $102:ws_ext_sales_price, $103:ws_net_profit","FROM web_sales"]},{"kind":"READ","substeps":["$110:wr_returned_date_sk, $111:wr_item_sk, $112:wr_order_number, $113:wr_return_amt, $114:wr_net_loss","FROM web_returns"]},{"kind":"READ","substeps":["$120, $121, $122","FROM __stage02_output"]},{"kind":"READ","substeps":["$50","FROM __stage01_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $450 := $444","$240 := SUM($440)","$241 := SUM($441)","$242 := SUM($442)","$243 := SUM($443)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $430 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $271 = $50"]},{"kind":"COMPUTE","substeps":["$320 := 0"]},{"kind":"COMPUTE","substeps":["$330 := 0"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $111 = $120, $112 = $122"]},{"kind":"WRITE","substeps":["$450, $240, $241, $242, $243","TO __stage0C_output","BY HASH($450)"]}],"writeRatioAvg":0.004677268475210477},{"readMsMax":"0","computeMsMax":"11","inputStages":["11","10","12"],"waitMsAvg":"8","id":"13","endMs":"1570903402935","waitMsMax":"8","startMs":"1570903402846","waitRatioMax":0.007483629560336763,"readRatioAvg":0,"parallelInputs":"3","recordsRead":"755","computeRatioAvg":0.00841908325537886,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02245088868101029,"readMsAvg":"0","waitRatioAvg":0.007483629560336763,"completedParallelInputs":"3","computeRatioMax":0.01028999064546305,"name":"S0D: Aggregate+","shuffleOutputBytes":"49002","recordsWritten":"615","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$360, $220, $221, $222, $223","FROM __stage0B_output"]},{"kind":"READ","substeps":["$400, $230, $231, $232, $233","FROM __stage0A_output"]},{"kind":"READ","substeps":["$450, $240, $241, $242, $243","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $470 := $150, $471 := $151","$140 := SUM($152)","$141 := SUM($153)","$142 := SUM($154)"]},{"kind":"COMPUTE","substeps":["$160 := 'store channel'","$161 := concat('store', $370)","$162 := subtract($191, $193)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $370 := $360","$190 := SUM($220)","$191 := SUM($221)","$192 := SUM($222)","$193 := SUM($223)"]},{"kind":"COMPUTE","substeps":["$170 := 'catalog channel'","$171 := concat('catalog_page', $410)","$172 := subtract($201, $203)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $410 := $400","$200 := SUM($230)","$201 := SUM($231)","$202 := SUM($232)","$203 := SUM($233)"]},{"kind":"COMPUTE","substeps":["$180 := 'web channel'","$181 := concat('web_site', $460)","$182 := subtract($211, $213)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $460 := $450","$210 := SUM($240)","$211 := SUM($241)","$212 := SUM($242)","$213 := SUM($243)"]},{"kind":"WRITE","substeps":["$140, $141, $142, $470, $471","TO __stage0D_output","BY HASH($470, $471)"]}],"writeRatioAvg":0.01683816651075772},{"readMsMax":"0","computeMsMax":"8","inputStages":["13"],"waitMsAvg":"4","id":"14","endMs":"1570903403014","waitMsMax":"4","startMs":"1570903402959","waitRatioMax":0.0037418147801683817,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"615","computeRatioAvg":0.007483629560336763,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.027128157156220765,"readMsAvg":"0","waitRatioAvg":0.0037418147801683817,"completedParallelInputs":"1","computeRatioMax":0.007483629560336763,"name":"S0E: Sort+","shuffleOutputBytes":"7992","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$140, $141, $142, $470, $471","FROM __stage0D_output"]},{"kind":"SORT","substeps":["$480 ASC, $481 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $480 := $470, $481 := $471","$130 := SUM($140)","$131 := SUM($141)","$132 := SUM($142)"]},{"kind":"WRITE","substeps":["$490, $491, $492, $493, $494","TO __stage0E_output"]}],"writeRatioAvg":0.027128157156220765},{"readMsMax":"0","computeMsMax":"7","inputStages":["14"],"waitMsAvg":"1","id":"15","endMs":"1570903403043","waitMsMax":"1","startMs":"1570903402973","waitRatioMax":0.0009354536950420954,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.006548175865294668,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005612722170252572,"readMsAvg":"0","waitRatioAvg":0.0009354536950420954,"completedParallelInputs":"1","computeRatioMax":0.006548175865294668,"name":"S0F: Output","shuffleOutputBytes":"7992","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$490, $491, $492, $493, $494","FROM __stage0E_output"]},{"kind":"SORT","substeps":["$493 ASC, $494 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$500, $501, $502, $503, $504","TO __stage0F_output"]}],"writeRatioAvg":0.005612722170252572}],"estimatedBytesProcessed":"186473492","timeline":[{"totalSlotMs":"1168","activeUnits":"5","completedUnits":"6","elapsedMs":"814","pendingUnits":"5"},{"totalSlotMs":"3110","activeUnits":"2","completedUnits":"11","elapsedMs":"1947","pendingUnits":"2"},{"totalSlotMs":"6556","activeUnits":"2","completedUnits":"18","elapsedMs":"2889","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"186646528","totalPartitionsProcessed":"0","totalBytesProcessed":"186473492","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_site","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_page","datasetId":"scale_1"}]},"endTime":"1570903403308"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query5_1570903398"},"etag":"9pWdKelmgPTlDvPxylY3aQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query5_1570903398?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonb198383b50d9ac756deb18f108eab190c269394d","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query5\nWITH ssr AS \n( \n SELECT s_store_id, \n Sum(sales_price) AS sales, \n Sum(profit) AS profit, \n Sum(return_amt) AS returns1, \n Sum(net_loss) AS profit_loss \n FROM ( \n SELECT ss_store_sk AS store_sk, \n ss_sold_date_sk AS date_sk, \n ss_ext_sales_price AS sales_price, \n ss_net_profit AS profit, \n 0 AS return_amt, \n 0 AS net_loss \n FROM store_sales \n UNION ALL \n SELECT sr_store_sk AS store_sk, \n sr_returned_date_sk AS date_sk, \n 0 AS sales_price, \n 0 AS profit, \n sr_return_amt AS return_amt, \n sr_net_loss AS net_loss \n FROM store_returns ) salesreturns, \n date_dim, \n store \n WHERE date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN Cast('2002-08-22' AS DATE) AND ( \n Cast('2002-09-05' AS DATE)) \n AND store_sk = s_store_sk \n GROUP BY s_store_id) , csr AS \n( \n SELECT cp_catalog_page_id, \n sum(sales_price) AS sales, \n sum(profit) AS profit, \n sum(return_amt) AS returns1, \n sum(net_loss) AS profit_loss \n FROM ( \n SELECT cs_catalog_page_sk AS page_sk, \n cs_sold_date_sk AS date_sk, \n cs_ext_sales_price AS sales_price, \n cs_net_profit AS profit, \n 0 AS return_amt, \n 0 AS net_loss \n FROM catalog_sales \n UNION ALL \n SELECT cr_catalog_page_sk AS page_sk, \n cr_returned_date_sk AS date_sk, \n 0 AS sales_price, \n 0 AS profit, \n cr_return_amount AS return_amt, \n cr_net_loss AS net_loss \n FROM catalog_returns ) salesreturns, \n date_dim, \n catalog_page \n WHERE date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2002-08-22' AS date) AND ( \n Cast('2002-09-05' AS DATE)) \n AND page_sk = cp_catalog_page_sk \n GROUP BY cp_catalog_page_id) , wsr AS \n( \n SELECT web_site_id, \n sum(sales_price) AS sales, \n sum(profit) AS profit, \n sum(return_amt) AS returns1, \n sum(net_loss) AS profit_loss \n FROM ( \n SELECT ws_web_site_sk AS wsr_web_site_sk, \n ws_sold_date_sk AS date_sk, \n ws_ext_sales_price AS sales_price, \n ws_net_profit AS profit, \n 0 AS return_amt, \n 0 AS net_loss \n FROM web_sales \n UNION ALL \n SELECT ws_web_site_sk AS wsr_web_site_sk, \n wr_returned_date_sk AS date_sk, \n 0 AS sales_price, \n 0 AS profit, \n wr_return_amt AS return_amt, \n wr_net_loss AS net_loss \n FROM web_returns \n LEFT OUTER JOIN web_sales \n ON ( \n wr_item_sk = ws_item_sk \n AND wr_order_number = ws_order_number) ) salesreturns,\n date_dim, \n web_site \n WHERE date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2002-08-22' AS date) AND ( \n Cast('2002-09-05' AS DATE)) \n AND wsr_web_site_sk = web_site_sk \n GROUP BY web_site_id) \nSELECT \n channel , \n id , \n sum(sales) AS sales , \n sum(returns1) AS returns1 , \n sum(profit) AS profit \nFROM ( \n SELECT 'store channel' AS channel , \n Concat('store', s_store_id) AS id , \n sales , \n returns1 , \n (profit - profit_loss) AS profit \n FROM ssr \n UNION ALL \n SELECT 'catalog channel' AS channel , \n Concat('catalog_page', cp_catalog_page_id) AS id , \n sales , \n returns1 , \n (profit - profit_loss) AS profit \n FROM csr \n UNION ALL \n SELECT 'web channel' AS channel , \n Concat('web_site', web_site_id) AS id , \n sales , \n returns1 , \n (profit - profit_loss) AS profit \n FROM wsr ) x \nGROUP BY channel, id\nORDER BY channel , \n id \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query5_1570903398","user_email":"nithish.sankaranarayanan@ulb.be"}
