{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"41452","creationTime":"1570904273060","totalBytesProcessed":"16574844","startTime":"1570904273269","query":{"totalSlotMs":"41452","queryPlan":[{"readMsMax":"13","computeMsMax":"40","waitMsAvg":"44","id":"0","endMs":"1570904273660","waitMsMax":"44","startMs":"1570904273612","waitRatioMax":0.10891089108910891,"readRatioAvg":0.03217821782178218,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.09900990099009901,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"40","shuffleOutputBytesSpilled":"0","writeRatioMax":0.019801980198019802,"readMsAvg":"13","waitRatioAvg":0.10891089108910891,"completedParallelInputs":"1","computeRatioMax":0.09900990099009901,"name":"S00: Input","shuffleOutputBytes":"791066","recordsWritten":"50000","readRatioMax":0.03217821782178218,"steps":[{"kind":"READ","substeps":["$60:ca_address_sk, $61:ca_state","FROM customer_address"]},{"kind":"WRITE","substeps":["$60, $61","TO __stage00_output","BY HASH($60)"]}],"writeRatioAvg":0.019801980198019802},{"readMsMax":"11","computeMsMax":"7","waitMsAvg":"76","id":"1","endMs":"1570904273733","waitMsMax":"76","startMs":"1570904273660","waitRatioMax":0.18811881188118812,"readRatioAvg":0.027227722772277228,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.017326732673267328,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.027227722772277228,"readMsAvg":"11","waitRatioAvg":0.18811881188118812,"completedParallelInputs":"1","computeRatioMax":0.017326732673267328,"name":"S01: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.027227722772277228,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_year","FROM date_dim","WHERE equal($81, 1999)"]},{"kind":"WRITE","substeps":["$80","TO __stage01_output","BY HASH($80)"]}],"writeRatioAvg":0.027227722772277228},{"readMsMax":"7","computeMsMax":"36","waitMsAvg":"81","id":"3","endMs":"1570904273755","waitMsMax":"81","startMs":"1570904273698","waitRatioMax":0.2004950495049505,"readRatioAvg":0.017326732673267328,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.0891089108910891,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"36","shuffleOutputBytesSpilled":"0","writeRatioMax":0.027227722772277228,"readMsAvg":"7","waitRatioAvg":0.2004950495049505,"completedParallelInputs":"1","computeRatioMax":0.0891089108910891,"name":"S03: Input","shuffleOutputBytes":"791066","recordsWritten":"50000","readRatioMax":0.017326732673267328,"steps":[{"kind":"READ","substeps":["$30:ca_address_sk, $31:ca_state","FROM customer_address"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage03_output","BY HASH($30)"]}],"writeRatioAvg":0.027227722772277228},{"readMsMax":"9","computeMsMax":"10","waitMsAvg":"103","id":"4","endMs":"1570904273947","waitMsMax":"103","startMs":"1570904273734","waitRatioMax":0.25495049504950495,"readRatioAvg":0.022277227722772276,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.024752475247524754,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05198019801980198,"readMsAvg":"9","waitRatioAvg":0.25495049504950495,"completedParallelInputs":"1","computeRatioMax":0.024752475247524754,"name":"S04: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.022277227722772276,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year","FROM date_dim","WHERE equal($51, 1999)"]},{"kind":"WRITE","substeps":["$50","TO __stage04_output","BY HASH($50)"]}],"writeRatioAvg":0.05198019801980198},{"readMsMax":"23","computeMsMax":"136","inputStages":["0","1"],"waitMsAvg":"30","id":"6","endMs":"1570904274039","waitMsMax":"30","startMs":"1570904273883","waitRatioMax":0.07425742574257425,"readRatioAvg":0.05693069306930693,"parallelInputs":"1","recordsRead":"194233","computeRatioAvg":0.33663366336633666,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"136","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04455445544554455,"readMsAvg":"23","waitRatioAvg":0.07425742574257425,"completedParallelInputs":"1","computeRatioMax":0.33663366336633666,"name":"S06: Join+","shuffleOutputBytes":"679750","recordsWritten":"27446","readRatioMax":0.05693069306930693,"steps":[{"kind":"READ","substeps":["$70:cr_returned_date_sk, $71:cr_returning_customer_sk, $72:cr_returning_addr_sk, $73:cr_return_amt_inc_tax","FROM catalog_returns"]},{"kind":"READ","substeps":["$80","FROM __stage01_output"]},{"kind":"READ","substeps":["$60, $61","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $220, $231 := $222","$140 := SUM($221)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $211 = $60"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $70 = $80"]},{"kind":"WRITE","substeps":["$231, $230, $140","TO __stage06_output","BY HASH($230, $231)"]}],"writeRatioAvg":0.04455445544554455},{"readMsMax":"29","computeMsMax":"139","inputStages":["3","4"],"waitMsAvg":"22","id":"7","endMs":"1570904274275","waitMsMax":"22","startMs":"1570904274085","waitRatioMax":0.054455445544554455,"readRatioAvg":0.07178217821782178,"parallelInputs":"1","recordsRead":"194233","computeRatioAvg":0.34405940594059403,"writeMsAvg":"66","status":"COMPLETE","writeMsMax":"66","computeMsAvg":"139","shuffleOutputBytesSpilled":"0","writeRatioMax":0.16336633663366337,"readMsAvg":"29","waitRatioAvg":0.054455445544554455,"completedParallelInputs":"1","computeRatioMax":0.34405940594059403,"name":"S07: Join+","shuffleOutputBytes":"679750","recordsWritten":"27446","readRatioMax":0.07178217821782178,"steps":[{"kind":"READ","substeps":["$40:cr_returned_date_sk, $41:cr_returning_customer_sk, $42:cr_returning_addr_sk, $43:cr_return_amt_inc_tax","FROM catalog_returns"]},{"kind":"READ","substeps":["$50","FROM __stage04_output"]},{"kind":"READ","substeps":["$30, $31","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $170 := $160, $171 := $162","$120 := SUM($161)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $151 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $50"]},{"kind":"WRITE","substeps":["$171, $170, $120","TO __stage07_output","BY HASH($170, $171)"]}],"writeRatioAvg":0.16336633663366337},{"readMsMax":"0","computeMsMax":"33","inputStages":["6"],"waitMsAvg":"29","id":"8","endMs":"1570904274196","waitMsMax":"29","startMs":"1570904274117","waitRatioMax":0.07178217821782178,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"27446","computeRatioAvg":0.08168316831683169,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"33","shuffleOutputBytesSpilled":"0","writeRatioMax":0.019801980198019802,"readMsAvg":"0","waitRatioAvg":0.07178217821782178,"completedParallelInputs":"1","computeRatioMax":0.08168316831683169,"name":"S08: Aggregate","shuffleOutputBytes":"1233","recordsWritten":"52","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$231, $230, $140","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $250 := $241","$110 := SHARD_AVG($130)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230, $241 := $231","$130 := SUM($140)"]},{"kind":"WRITE","substeps":["$250, $110","TO __stage08_output","BY HASH($250)"]}],"writeRatioAvg":0.019801980198019802},{"readMsMax":"17","computeMsMax":"27","waitMsAvg":"19","id":"9","endMs":"1570904274400","waitMsMax":"19","startMs":"1570904274324","waitRatioMax":0.04702970297029703,"readRatioAvg":0.04207920792079208,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.06683168316831684,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"27","shuffleOutputBytesSpilled":"0","writeRatioMax":0.054455445544554455,"readMsAvg":"17","waitRatioAvg":0.04702970297029703,"completedParallelInputs":"1","computeRatioMax":0.06683168316831684,"name":"S09: Input","shuffleOutputBytes":"565248","recordsWritten":"3984","readRatioMax":0.04207920792079208,"steps":[{"kind":"READ","substeps":["$1:ca_address_sk, $2:ca_street_number, $3:ca_street_name, $4:ca_street_type, $5:ca_suite_number, $6:ca_city, $7:ca_county, $8:ca_state, $9:ca_zip, $10:ca_country, $11:ca_gmt_offset, $12:ca_location_type","FROM customer_address","WHERE equal($8, 'TX')"]},{"kind":"WRITE","substeps":["$1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12","TO __stage09_output","BY HASH($1)"]}],"writeRatioAvg":0.054455445544554455},{"readMsMax":"0","computeMsMax":"5","inputStages":["8"],"waitMsAvg":"52","id":"10","endMs":"1570904274425","waitMsMax":"52","startMs":"1570904274375","waitRatioMax":0.12871287128712872,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"52","computeRatioAvg":0.012376237623762377,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0594059405940594,"readMsAvg":"0","waitRatioAvg":0.12871287128712872,"completedParallelInputs":"1","computeRatioMax":0.012376237623762377,"name":"S0A: Aggregate","shuffleOutputBytes":"816","recordsWritten":"51","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$250, $110","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $260 := $250","$90 := ROOT_AVG($110)"]},{"kind":"WRITE","substeps":["$90, $260","TO __stage0A_output","BY HASH($260)"]}],"writeRatioAvg":0.0594059405940594},{"readMsMax":"0","computeMsMax":"50","inputStages":["7"],"waitMsAvg":"43","id":"12","endMs":"1570904274489","waitMsMax":"43","startMs":"1570904274408","waitRatioMax":0.10643564356435643,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"27446","computeRatioAvg":0.12376237623762376,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"50","shuffleOutputBytesSpilled":"0","writeRatioMax":0.054455445544554455,"readMsAvg":"0","waitRatioAvg":0.10643564356435643,"completedParallelInputs":"1","computeRatioMax":0.12376237623762376,"name":"S0C: Aggregate","shuffleOutputBytes":"679042","recordsWritten":"27404","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$171, $170, $120","FROM __stage07_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $170, $181 := $171","$100 := SUM($120)"]},{"kind":"WRITE","substeps":["$100, $180, $181","TO __stage0C_output","BY HASH($180)"]}],"writeRatioAvg":0.054455445544554455},{"readMsMax":"0","computeMsMax":"13","inputStages":["12"],"waitMsAvg":"27","id":"13","endMs":"1570904274933","waitMsMax":"44","startMs":"1570904274518","waitRatioMax":0.10891089108910891,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"27404","computeRatioAvg":0.017326732673267328,"writeMsAvg":"244","status":"COMPLETE","writeMsMax":"404","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":1,"readMsAvg":"0","waitRatioAvg":0.06683168316831684,"completedParallelInputs":"100","computeRatioMax":0.03217821782178218,"name":"S0D: Coalesce","shuffleOutputBytes":"679042","recordsWritten":"27404","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0C_output"]}],"writeRatioAvg":0.6039603960396039},{"readMsMax":"0","computeMsMax":"9","inputStages":["10"],"waitMsAvg":"41","id":"14","endMs":"1570904274703","waitMsMax":"45","startMs":"1570904274518","waitRatioMax":0.11138613861386139,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"51","computeRatioAvg":0.012376237623762377,"writeMsAvg":"47","status":"COMPLETE","writeMsMax":"87","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.21534653465346534,"readMsAvg":"0","waitRatioAvg":0.10148514851485149,"completedParallelInputs":"100","computeRatioMax":0.022277227722772276,"name":"S0E: Coalesce","shuffleOutputBytes":"816","recordsWritten":"51","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0A_output"]}],"writeRatioAvg":0.11633663366336634},{"readMsMax":"20","computeMsMax":"111","inputStages":["9","14","13"],"waitMsAvg":"45","id":"15","endMs":"1570904275137","waitMsMax":"45","startMs":"1570904274542","waitRatioMax":0.11138613861386139,"readRatioAvg":0.04950495049504951,"parallelInputs":"1","recordsRead":"131439","computeRatioAvg":0.2747524752475248,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"111","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012376237623762377,"readMsAvg":"20","waitRatioAvg":0.11138613861386139,"completedParallelInputs":"1","computeRatioMax":0.2747524752475248,"name":"S0F: Join+","shuffleOutputBytes":"19209","recordsWritten":"100","readRatioMax":0.04950495049504951,"steps":[{"kind":"READ","substeps":["$20:c_customer_sk, $21:c_customer_id, $22:c_current_addr_sk, $23:c_salutation, $24:c_first_name, $25:c_last_name","FROM customer"]},{"kind":"READ","substeps":["$100, $180, $181","FROM __stage0D_output"]},{"kind":"READ","substeps":["$90, $260","FROM __stage0E_output"]},{"kind":"READ","substeps":["$1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12","FROM __stage09_output"]},{"kind":"SORT","substeps":["$290 ASC, $291 ASC, $292 ASC, $293 ASC, $295 ASC, $296 ASC, $297 ASC, $298 ASC, $299 ASC, $300 ASC, $301 ASC, $302 ASC, $303 ASC, $304 ASC, $305 ASC, $294 ASC","LIMIT 100"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $271 = $1"]},{"kind":"FILTER","substeps":["greater($275, multiply($276, 1.2))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $190 = $260"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $180"]},{"kind":"WRITE","substeps":["$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $322, $323, $324, $325","TO __stage0F_output"]}],"writeRatioAvg":0.012376237623762377},{"readMsMax":"0","computeMsMax":"6","inputStages":["15"],"waitMsAvg":"3","id":"16","endMs":"1570904275205","waitMsMax":"3","startMs":"1570904274562","waitRatioMax":0.007425742574257425,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.01485148514851485,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01485148514851485,"readMsAvg":"0","waitRatioAvg":0.007425742574257425,"completedParallelInputs":"1","computeRatioMax":0.01485148514851485,"name":"S10: Output","shuffleOutputBytes":"19209","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $322, $323, $324, $325","FROM __stage0F_output"]},{"kind":"SORT","substeps":["$321 ASC, $322 ASC, $323 ASC, $324 ASC, $310 ASC, $311 ASC, $312 ASC, $313 ASC, $314 ASC, $315 ASC, $316 ASC, $317 ASC, $318 ASC, $319 ASC, $320 ASC, $325 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$330, $331, $332, $333, $334, $335, $336, $337, $338, $339, $340, $341, $342, $343, $344, $345","TO __stage10_output"]}],"writeRatioAvg":0.01485148514851485}],"estimatedBytesProcessed":"16574844","timeline":[{"totalSlotMs":"697","activeUnits":"1","completedUnits":"5","elapsedMs":"845","pendingUnits":"2"},{"totalSlotMs":"41452","activeUnits":"196","completedUnits":"212","elapsedMs":"2154","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"41943040","totalPartitionsProcessed":"0","totalBytesProcessed":"16574844","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_1"}]},"endTime":"1570904275463"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query81_1570904271"},"etag":"85pOf2DajZp+bHt8AqqIgQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query81_1570904271?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anone5d72a06092135851fec9402128436c609b029ef","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"\n-- query81\nWITH customer_total_return \n AS (SELECT cr_returning_customer_sk AS ctr_customer_sk, \n ca_state AS ctr_state, \n Sum(cr_return_amt_inc_tax) AS ctr_total_return \n FROM catalog_returns, \n date_dim, \n customer_address \n WHERE cr_returned_date_sk = d_date_sk \n AND d_year = 1999 \n AND cr_returning_addr_sk = ca_address_sk \n GROUP BY cr_returning_customer_sk, \n ca_state),\nhigh_return AS (\n SELECT ctr_state AS hr_state, Avg(ctr_total_return) benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup 1.2 AS hr_limit\n FROM customer_total_return \n GROUP BY ctr_state\n)\nSELECT c_customer_id, \n c_salutation, \n c_first_name, \n c_last_name, \n ca_street_number, \n ca_street_name, \n ca_street_type, \n ca_suite_number, \n ca_city, \n ca_county, \n ca_state, \n ca_zip, \n ca_country, \n ca_gmt_offset, \n ca_location_type, \n ctr_total_return \nFROM customer_total_return, \n high_return,\n customer_address, \n customer\nWHERE ctr_state = hr_state \n AND ctr_customer_sk = c_customer_sk \n AND ca_address_sk = c_current_addr_sk \n AND ca_state = 'TX' \n AND ctr_total_return > hr_limit\nORDER BY c_customer_id, \n c_salutation, \n c_first_name, \n c_last_name, \n ca_street_number, \n ca_street_name, \n ca_street_type, \n ca_suite_number, \n ca_city, \n ca_county, \n ca_state, \n ca_zip, \n ca_country, \n ca_gmt_offset, \n ca_location_type, \n ctr_total_return\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query81_1570904271","user_email":"nithish.sankaranarayanan@ulb.be"}
