{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"20854","creationTime":"1570904094268","totalBytesProcessed":"92841674","startTime":"1570904094439","query":{"totalSlotMs":"20854","queryPlan":[{"readMsMax":"9","computeMsMax":"7","waitMsAvg":"2","id":"0","endMs":"1570904094784","waitMsMax":"2","startMs":"1570904094576","waitRatioMax":0.0008849557522123894,"readRatioAvg":0.003982300884955752,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.003097345132743363,"writeMsAvg":"188","status":"COMPLETE","writeMsMax":"188","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0831858407079646,"readMsAvg":"9","waitRatioAvg":0.0008849557522123894,"completedParallelInputs":"1","computeRatioMax":0.003097345132743363,"name":"S00: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.003982300884955752,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_month_seq","FROM date_dim","WHERE between($51, 1199, 1210)"]},{"kind":"WRITE","substeps":["$50","TO __stage00_output","BY HASH($50)"]}],"writeRatioAvg":0.0831858407079646},{"readMsMax":"8","computeMsMax":"7","waitMsAvg":"23","id":"2","endMs":"1570904094798","waitMsMax":"23","startMs":"1570904094729","waitRatioMax":0.010176991150442478,"readRatioAvg":0.0035398230088495575,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.003097345132743363,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003097345132743363,"readMsAvg":"8","waitRatioAvg":0.010176991150442478,"completedParallelInputs":"1","computeRatioMax":0.003097345132743363,"name":"S02: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.0035398230088495575,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_month_seq","FROM date_dim","WHERE between($31, 1199, 1210)"]},{"kind":"WRITE","substeps":["$30","TO __stage02_output","BY HASH($30)"]}],"writeRatioAvg":0.003097345132743363},{"readMsMax":"24","computeMsMax":"2260","inputStages":["0"],"waitMsAvg":"1","id":"4","endMs":"1570904096022","waitMsMax":"1","startMs":"1570904094829","waitRatioMax":0.0004424778761061947,"readRatioAvg":0.010619469026548672,"parallelInputs":"1","recordsRead":"2881544","computeRatioAvg":1,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"26","computeMsAvg":"2260","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011504424778761062,"readMsAvg":"24","waitRatioAvg":0.0004424778761061947,"completedParallelInputs":"1","computeRatioMax":1,"name":"S04: Join+","shuffleOutputBytes":"1981395","recordsWritten":"76377","readRatioMax":0.010619469026548672,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_item_sk, $42:ss_store_sk, $43:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$50","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $160 := $151, $161 := $150","$110 := SUM($152)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $50"]},{"kind":"WRITE","substeps":["$161, $160, $110","TO __stage04_output","BY HASH($160, $161)"]}],"writeRatioAvg":0.011504424778761062},{"readMsMax":"35","computeMsMax":"1517","inputStages":["2"],"waitMsAvg":"1","id":"5","endMs":"1570904095729","waitMsMax":"1","startMs":"1570904094912","waitRatioMax":0.0004424778761061947,"readRatioAvg":0.015486725663716814,"parallelInputs":"1","recordsRead":"2881544","computeRatioAvg":0.6712389380530973,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"1517","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003982300884955752,"readMsAvg":"35","waitRatioAvg":0.0004424778761061947,"completedParallelInputs":"1","computeRatioMax":0.6712389380530973,"name":"S05: Join+","shuffleOutputBytes":"1981395","recordsWritten":"76377","readRatioMax":0.015486725663716814,"steps":[{"kind":"READ","substeps":["$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_store_sk, $23:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$30","FROM __stage02_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $130 := $121, $131 := $120","$80 := SUM($122)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $30"]},{"kind":"WRITE","substeps":["$131, $130, $80","TO __stage05_output","BY HASH($130, $131)"]}],"writeRatioAvg":0.003982300884955752},{"readMsMax":"0","computeMsMax":"81","inputStages":["4"],"waitMsAvg":"1","id":"6","endMs":"1570904096373","waitMsMax":"1","startMs":"1570904096314","waitRatioMax":0.0004424778761061947,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"76377","computeRatioAvg":0.03584070796460177,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"81","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002654867256637168,"readMsAvg":"0","waitRatioAvg":0.0004424778761061947,"completedParallelInputs":"1","computeRatioMax":0.03584070796460177,"name":"S06: Aggregate","shuffleOutputBytes":"174","recordsWritten":"7","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$161, $160, $110","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $170","$90 := SHARD_AVG($100)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $170 := $160, $171 := $161","$100 := SUM($110)"]},{"kind":"WRITE","substeps":["$180, $90","TO __stage06_output","BY HASH($180)"]}],"writeRatioAvg":0.002654867256637168},{"readMsMax":"32","computeMsMax":"82","waitMsAvg":"1","id":"7","endMs":"1570904097043","waitMsMax":"1","startMs":"1570904096399","waitRatioMax":0.0004424778761061947,"readRatioAvg":0.01415929203539823,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.036283185840707964,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"82","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004424778761061947,"readMsAvg":"32","waitRatioAvg":0.0004424778761061947,"completedParallelInputs":"1","computeRatioMax":0.036283185840707964,"name":"S07: Input","shuffleOutputBytes":"2744119","recordsWritten":"18000","readRatioMax":0.01415929203539823,"steps":[{"kind":"READ","substeps":["$1:i_item_sk, $2:i_item_desc, $3:i_current_price, $4:i_wholesale_cost, $5:i_brand","FROM item"]},{"kind":"WRITE","substeps":["$1, $2, $3, $4, $5","TO __stage07_output","BY HASH($1)"]}],"writeRatioAvg":0.004424778761061947},{"readMsMax":"20","computeMsMax":"6","waitMsAvg":"1","id":"8","endMs":"1570904096490","waitMsMax":"1","startMs":"1570904096414","waitRatioMax":0.0004424778761061947,"readRatioAvg":0.008849557522123894,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.002654867256637168,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002654867256637168,"readMsAvg":"20","waitRatioAvg":0.0004424778761061947,"completedParallelInputs":"1","computeRatioMax":0.002654867256637168,"name":"S08: Input","shuffleOutputBytes":"213","recordsWritten":"12","readRatioMax":0.008849557522123894,"steps":[{"kind":"READ","substeps":["$10:s_store_sk, $11:s_store_name","FROM store"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage08_output","BY HASH($10)"]}],"writeRatioAvg":0.002654867256637168},{"readMsMax":"0","computeMsMax":"6","inputStages":["6"],"waitMsAvg":"1","id":"9","endMs":"1570904096507","waitMsMax":"1","startMs":"1570904096434","waitRatioMax":0.0004424778761061947,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"7","computeRatioAvg":0.002654867256637168,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"12","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005309734513274336,"readMsAvg":"0","waitRatioAvg":0.0004424778761061947,"completedParallelInputs":"1","computeRatioMax":0.002654867256637168,"name":"S09: Aggregate","shuffleOutputBytes":"108","recordsWritten":"6","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$180, $90","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $180","$70 := ROOT_AVG($90)"]},{"kind":"WRITE","substeps":["$70, $190","TO __stage09_output","BY HASH($190)"]}],"writeRatioAvg":0.005309734513274336},{"readMsMax":"0","computeMsMax":"11","inputStages":["9"],"waitMsAvg":"1","id":"11","endMs":"1570904096730","waitMsMax":"2","startMs":"1570904096526","waitRatioMax":0.0008849557522123894,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"6","computeRatioAvg":0.002654867256637168,"writeMsAvg":"98","status":"COMPLETE","writeMsMax":"181","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08008849557522124,"readMsAvg":"0","waitRatioAvg":0.0004424778761061947,"completedParallelInputs":"100","computeRatioMax":0.0048672566371681415,"name":"S0B: Coalesce","shuffleOutputBytes":"108","recordsWritten":"6","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage09_output"]}],"writeRatioAvg":0.04336283185840708},{"readMsMax":"0","computeMsMax":"128","inputStages":["5","7","8","11"],"waitMsAvg":"1","id":"13","endMs":"1570904097199","waitMsMax":"1","startMs":"1570904097090","waitRatioMax":0.0004424778761061947,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"94395","computeRatioAvg":0.05663716814159292,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"128","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0022123893805309734,"readMsAvg":"0","waitRatioAvg":0.0004424778761061947,"completedParallelInputs":"1","computeRatioMax":0.05663716814159292,"name":"S0D: Join+","shuffleOutputBytes":"16595","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$131, $130, $80","FROM __stage05_output"]},{"kind":"READ","substeps":["$70, $190","FROM __stage0B_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage08_output"]},{"kind":"READ","substeps":["$1, $2, $3, $4, $5","FROM __stage07_output"]},{"kind":"SORT","substeps":["$220 ASC, $222 ASC","LIMIT 100"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $210 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $201 = $10"]},{"kind":"FILTER","substeps":["less_or_equal($202, multiply(0.1, $203))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $140 = $190"]},{"kind":"AGGREGATE","substeps":["GROUP BY $140 := $130, $141 := $131","$60 := SUM($80)"]},{"kind":"WRITE","substeps":["$230, $231, $232, $233, $234, $235","TO __stage0D_output"]}],"writeRatioAvg":0.0022123893805309734},{"readMsMax":"0","computeMsMax":"6","inputStages":["13"],"waitMsAvg":"1","id":"14","endMs":"1570904097218","waitMsMax":"1","startMs":"1570904097106","waitRatioMax":0.0004424778761061947,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.002654867256637168,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002654867256637168,"readMsAvg":"0","waitRatioAvg":0.0004424778761061947,"completedParallelInputs":"1","computeRatioMax":0.002654867256637168,"name":"S0E: Output","shuffleOutputBytes":"16595","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$230, $231, $232, $233, $234, $235","FROM __stage0D_output"]},{"kind":"SORT","substeps":["$234 ASC, $230 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$240, $241, $242, $243, $244, $245","TO __stage0E_output"]}],"writeRatioAvg":0.002654867256637168}],"estimatedBytesProcessed":"92841674","timeline":[{"totalSlotMs":"833","activeUnits":"2","completedUnits":"2","elapsedMs":"638","pendingUnits":"2"},{"totalSlotMs":"19314","activeUnits":"2","completedUnits":"107","elapsedMs":"2377","pendingUnits":"2"},{"totalSlotMs":"20854","activeUnits":"2","completedUnits":"110","elapsedMs":"3058","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"93323264","totalPartitionsProcessed":"0","totalBytesProcessed":"92841674","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"}]},"endTime":"1570904097522"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query65_1570904092"},"etag":"+ya6lodbx1Jxl781N9VZPw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query65_1570904092?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anoncf6689bb0d0f5bd03456daaacb7c1e5b06ab1bea","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query65\nSELECT s_store_name, \n i_item_desc, \n sc.revenue, \n i_current_price, \n i_wholesale_cost, \n i_brand \nFROM store, \n item, \n (SELECT ss_store_sk, \n Avg(revenue) AS ave \n FROM (SELECT ss_store_sk, \n ss_item_sk, \n Sum(ss_sales_price) AS revenue \n FROM store_sales, \n date_dim \n WHERE ss_sold_date_sk = d_date_sk \n AND d_month_seq BETWEEN 1199 AND 1199 + 11 \n GROUP BY ss_store_sk, \n ss_item_sk) sa \n GROUP BY ss_store_sk) sb, \n (SELECT ss_store_sk, \n ss_item_sk, \n Sum(ss_sales_price) AS revenue \n FROM store_sales, \n date_dim \n WHERE ss_sold_date_sk = d_date_sk \n AND d_month_seq BETWEEN 1199 AND 1199 + 11 \n GROUP BY ss_store_sk, \n ss_item_sk) sc \nWHERE sb.ss_store_sk = sc.ss_store_sk \n AND sc.revenue <= 0.1 benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup sb.ave \n AND s_store_sk = sc.ss_store_sk \n AND i_item_sk = sc.ss_item_sk \nORDER BY s_store_name, \n i_item_desc\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query65_1570904092","user_email":"nithish.sankaranarayanan@ulb.be"}
