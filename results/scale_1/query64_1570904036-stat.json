{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"227352","creationTime":"1570904038176","totalBytesProcessed":"340876689","startTime":"1570904038475","query":{"totalSlotMs":"227352","queryPlan":[{"readMsMax":"129","computeMsMax":"380","waitMsAvg":"1","id":"0","endMs":"1570904039639","waitMsMax":"1","startMs":"1570904038731","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0.005629500327296531,"parallelInputs":"1","recordsRead":"143868","computeRatioAvg":0.01658302421994327,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"380","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007418721361553567,"readMsAvg":"129","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.01658302421994327,"name":"S00: Input","shuffleOutputBytes":"6405732","recordsWritten":"143868","readRatioMax":0.005629500327296531,"steps":[{"kind":"READ","substeps":["$290:cr_item_sk, $291:cr_order_number, $292:cr_refunded_cash, $293:cr_reversed_charge, $294:cr_store_credit","FROM catalog_returns"]},{"kind":"WRITE","substeps":["$290, $291, $292, $293, $294","TO __stage00_output","BY HASH($290, $291)"]}],"writeRatioAvg":0.0007418721361553567},{"readMsMax":"35","computeMsMax":"271","waitMsAvg":"51","id":"2","endMs":"1570904039318","waitMsMax":"51","startMs":"1570904038816","waitRatioMax":0.00222561640846607,"readRatioAvg":0.0015273838097316168,"parallelInputs":"1","recordsRead":"143868","computeRatioAvg":0.011826314641064805,"writeMsAvg":"54","status":"COMPLETE","writeMsMax":"54","computeMsAvg":"271","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00235653502072878,"readMsAvg":"35","waitRatioAvg":0.00222561640846607,"completedParallelInputs":"1","computeRatioMax":0.011826314641064805,"name":"S02: Input","shuffleOutputBytes":"6405732","recordsWritten":"143868","readRatioMax":0.0015273838097316168,"steps":[{"kind":"READ","substeps":["$260:cr_item_sk, $261:cr_order_number, $262:cr_refunded_cash, $263:cr_reversed_charge, $264:cr_store_credit","FROM catalog_returns"]},{"kind":"WRITE","substeps":["$260, $261, $262, $263, $264","TO __stage02_output","BY HASH($260, $261)"]}],"writeRatioAvg":0.00235653502072878},{"readMsMax":"44","computeMsMax":"1287","inputStages":["2"],"waitMsAvg":"1","id":"4","endMs":"1570904040193","waitMsMax":"1","startMs":"1570904039351","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0.001920139646519747,"parallelInputs":"1","recordsRead":"1581310","computeRatioAvg":0.0561640846607026,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"26","computeMsAvg":"1287","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0011346279729434869,"readMsAvg":"44","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.0561640846607026,"name":"S04: Join+","shuffleOutputBytes":"482395","recordsWritten":"17873","readRatioMax":0.001920139646519747,"steps":[{"kind":"READ","substeps":["$250:cs_item_sk, $251:cs_order_number, $252:cs_ext_list_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$260, $261, $262, $263, $264","FROM __stage02_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $670 := $660","$460 := SUM($661)","$461 := SUM($480)"]},{"kind":"COMPUTE","substeps":["$480 := add(add($662, $663), $664)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $250 = $260, $251 = $261"]},{"kind":"WRITE","substeps":["$670, $460, $461","TO __stage04_output","BY HASH($670)"]}],"writeRatioAvg":0.0011346279729434869},{"readMsMax":"22","computeMsMax":"1104","inputStages":["0"],"waitMsAvg":"12","id":"5","endMs":"1570904040411","waitMsMax":"12","startMs":"1570904039815","waitRatioMax":0.00052367444905084,"readRatioAvg":0.0009600698232598735,"parallelInputs":"1","recordsRead":"1581310","computeRatioAvg":0.04817804931267729,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"1104","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00026183722452542,"readMsAvg":"22","waitRatioAvg":0.00052367444905084,"completedParallelInputs":"1","computeRatioMax":0.04817804931267729,"name":"S05: Join+","shuffleOutputBytes":"482395","recordsWritten":"17873","readRatioMax":0.0009600698232598735,"steps":[{"kind":"READ","substeps":["$280:cs_item_sk, $281:cs_order_number, $282:cs_ext_list_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$290, $291, $292, $293, $294","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $1080 := $1070","$470 := SUM($1071)","$471 := SUM($490)"]},{"kind":"COMPUTE","substeps":["$490 := add(add($1072, $1073), $1074)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $280 = $290, $281 = $291"]},{"kind":"WRITE","substeps":["$1080, $470, $471","TO __stage05_output","BY HASH($1080)"]}],"writeRatioAvg":0.00026183722452542},{"readMsMax":"14","computeMsMax":"50","waitMsAvg":"3","id":"6","endMs":"1570904040626","waitMsMax":"3","startMs":"1570904040485","waitRatioMax":0.00013091861226271,"readRatioAvg":0.0006109535238926467,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.002181976871045167,"writeMsAvg":"82","status":"COMPLETE","writeMsMax":"82","computeMsAvg":"50","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0035784420685140736,"readMsAvg":"14","waitRatioAvg":0.00013091861226271,"completedParallelInputs":"1","computeRatioMax":0.002181976871045167,"name":"S06: Input","shuffleOutputBytes":"1314882","recordsWritten":"73049","readRatioMax":0.0006109535238926467,"steps":[{"kind":"READ","substeps":["$1:d_date_sk, $2:d_year","FROM date_dim"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage06_output","BY HASH($1)"]}],"writeRatioAvg":0.0035784420685140736},{"readMsMax":"10","computeMsMax":"53","waitMsAvg":"9","id":"7","endMs":"1570904040702","waitMsMax":"9","startMs":"1570904040511","waitRatioMax":0.00039275583678813006,"readRatioAvg":0.0004363953742090334,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.002312895483307877,"writeMsAvg":"150","status":"COMPLETE","writeMsMax":"150","computeMsAvg":"53","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006545930613135501,"readMsAvg":"10","waitRatioAvg":0.00039275583678813006,"completedParallelInputs":"1","computeRatioMax":0.002312895483307877,"name":"S07: Input","shuffleOutputBytes":"1314882","recordsWritten":"73049","readRatioMax":0.0004363953742090334,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_year","FROM date_dim"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage07_output","BY HASH($20)"]}],"writeRatioAvg":0.006545930613135501},{"readMsMax":"7","computeMsMax":"8","waitMsAvg":"1","id":"8","endMs":"1570904040683","waitMsMax":"1","startMs":"1570904040593","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0.00030547676194632336,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.0003491162993672267,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"16","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0006982325987344534,"readMsAvg":"7","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.0003491162993672267,"name":"S08: Input","shuffleOutputBytes":"333","recordsWritten":"12","readRatioMax":0.00030547676194632336,"steps":[{"kind":"READ","substeps":["$40:s_store_sk, $41:s_store_name, $42:s_zip","FROM store"]},{"kind":"WRITE","substeps":["$40, $41, $42","TO __stage08_output","BY HASH($40)"]}],"writeRatioAvg":0.0006982325987344534},{"readMsMax":"28","computeMsMax":"6","waitMsAvg":"1","id":"9","endMs":"1570904040662","waitMsMax":"1","startMs":"1570904040608","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0.0012219070477852935,"parallelInputs":"1","recordsRead":"300","computeRatioAvg":0.00026183722452542,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00026183722452542,"readMsAvg":"28","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.00026183722452542,"name":"S09: Input","shuffleOutputBytes":"2700","recordsWritten":"300","readRatioMax":0.0012219070477852935,"steps":[{"kind":"READ","substeps":["$60:p_promo_sk","FROM promotion"]},{"kind":"WRITE","substeps":["$60","TO __stage09_output","BY HASH($60)"]}],"writeRatioAvg":0.00026183722452542},{"readMsMax":"7","computeMsMax":"94","waitMsAvg":"1","id":"10","endMs":"1570904040753","waitMsMax":"1","startMs":"1570904040627","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0.00030547676194632336,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.004102116517564914,"writeMsAvg":"14","status":"COMPLETE","writeMsMax":"14","computeMsAvg":"94","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0006109535238926467,"readMsAvg":"7","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.004102116517564914,"name":"S0A: Input","shuffleOutputBytes":"2665808","recordsWritten":"50000","readRatioMax":0.00030547676194632336,"steps":[{"kind":"READ","substeps":["$80:ca_address_sk, $81:ca_street_number, $82:ca_street_name, $83:ca_city, $84:ca_zip","FROM customer_address"]},{"kind":"WRITE","substeps":["$80, $81, $82, $83, $84","TO __stage0A_output","BY HASH($80)"]}],"writeRatioAvg":0.0006109535238926467},{"readMsMax":"15","computeMsMax":"100","waitMsAvg":"2","id":"11","endMs":"1570904041196","waitMsMax":"2","startMs":"1570904040645","waitRatioMax":8.727907484180668e-05,"readRatioAvg":0.0006545930613135501,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.004363953742090334,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"16","computeMsAvg":"100","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0006982325987344534,"readMsAvg":"15","waitRatioAvg":8.727907484180668e-05,"completedParallelInputs":"1","computeRatioMax":0.004363953742090334,"name":"S0B: Input","shuffleOutputBytes":"2665808","recordsWritten":"50000","readRatioMax":0.0006545930613135501,"steps":[{"kind":"READ","substeps":["$100:ca_address_sk, $101:ca_street_number, $102:ca_street_name, $103:ca_city, $104:ca_zip","FROM customer_address"]},{"kind":"WRITE","substeps":["$100, $101, $102, $103, $104","TO __stage0B_output","BY HASH($100)"]}],"writeRatioAvg":0.0006982325987344534},{"readMsMax":"35","computeMsMax":"6","waitMsAvg":"1","id":"12","endMs":"1570904041988","waitMsMax":"1","startMs":"1570904040658","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0.0015273838097316168,"parallelInputs":"1","recordsRead":"20","computeRatioAvg":0.00026183722452542,"writeMsAvg":"1280","status":"COMPLETE","writeMsMax":"1280","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.055858607898756275,"readMsAvg":"35","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.00026183722452542,"name":"S0C: Input","shuffleOutputBytes":"180","recordsWritten":"20","readRatioMax":0.0015273838097316168,"steps":[{"kind":"READ","substeps":["$120:ib_income_band_sk","FROM income_band"]},{"kind":"WRITE","substeps":["$120","TO __stage0C_output","BY HASH($120)"]}],"writeRatioAvg":0.055858607898756275},{"readMsMax":"16","computeMsMax":"7","waitMsAvg":"2","id":"13","endMs":"1570904040768","waitMsMax":"2","startMs":"1570904040678","waitRatioMax":8.727907484180668e-05,"readRatioAvg":0.0006982325987344534,"parallelInputs":"1","recordsRead":"20","computeRatioAvg":0.00030547676194632336,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007418721361553567,"readMsAvg":"16","waitRatioAvg":8.727907484180668e-05,"completedParallelInputs":"1","computeRatioMax":0.00030547676194632336,"name":"S0D: Input","shuffleOutputBytes":"180","recordsWritten":"20","readRatioMax":0.0006982325987344534,"steps":[{"kind":"READ","substeps":["$140:ib_income_band_sk","FROM income_band"]},{"kind":"WRITE","substeps":["$140","TO __stage0D_output","BY HASH($140)"]}],"writeRatioAvg":0.0007418721361553567},{"readMsMax":"0","computeMsMax":"27","inputStages":["4"],"waitMsAvg":"1","id":"14","endMs":"1570904040762","waitMsMax":"1","startMs":"1570904040696","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"17873","computeRatioAvg":0.00117826751036439,"writeMsAvg":"41","status":"COMPLETE","writeMsMax":"41","computeMsAvg":"27","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0017892210342570368,"readMsAvg":"0","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.00117826751036439,"name":"S0E: Aggregate+","shuffleOutputBytes":"154395","recordsWritten":"17155","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$670, $460, $461","FROM __stage04_output"]},{"kind":"FILTER","substeps":["greater($440, multiply(2, $441))"]},{"kind":"AGGREGATE","substeps":["GROUP BY $680 := $670","$440 := SUM($460)","$441 := SUM($461)"]},{"kind":"WRITE","substeps":["$680","TO __stage0E_output","BY HASH($680)"]}],"writeRatioAvg":0.0017892210342570368},{"readMsMax":"9","computeMsMax":"8","waitMsAvg":"1","id":"15","endMs":"1570904040773","waitMsMax":"1","startMs":"1570904040716","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0.00039275583678813006,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0003491162993672267,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"26","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0011346279729434869,"readMsAvg":"9","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.0003491162993672267,"name":"S0F: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.00039275583678813006,"steps":[{"kind":"READ","substeps":["$160:d_date_sk, $161:d_year","FROM date_dim","WHERE equal($161, 2001)"]},{"kind":"WRITE","substeps":["$160, $161","TO __stage0F_output","BY HASH($160)"]}],"writeRatioAvg":0.0011346279729434869},{"readMsMax":"8","computeMsMax":"9","waitMsAvg":"1","id":"16","endMs":"1570904040824","waitMsMax":"1","startMs":"1570904040737","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0.0003491162993672267,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.00039275583678813006,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0008727907484180668,"readMsAvg":"8","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.00039275583678813006,"name":"S10: Input","shuffleOutputBytes":"421","recordsWritten":"13","readRatioMax":0.0003491162993672267,"steps":[{"kind":"READ","substeps":["$190:i_item_sk, $193:i_product_name, $191:i_current_price, $192:i_color","FROM item","WHERE and(in($192, 'cyan', 'peach', 'blush', 'frosted', 'powder', 'orange'), between($191, 58, 68), between($191, 59, 73))"]},{"kind":"WRITE","substeps":["$190, $193","TO __stage10_output","BY HASH($190)"]}],"writeRatioAvg":0.0008727907484180668},{"readMsMax":"12","computeMsMax":"235","waitMsAvg":"0","id":"17","endMs":"1570904041483","waitMsMax":"0","startMs":"1570904040753","waitRatioMax":0,"readRatioAvg":0.00052367444905084,"parallelInputs":"1","recordsRead":"288116","computeRatioAvg":0.010255291293912285,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"235","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00104734889810168,"readMsAvg":"12","waitRatioAvg":0,"completedParallelInputs":"1","computeRatioMax":0.010255291293912285,"name":"S11: Input","shuffleOutputBytes":"5186088","recordsWritten":"288116","readRatioMax":0.00052367444905084,"steps":[{"kind":"READ","substeps":["$180:sr_item_sk, $181:sr_ticket_number","FROM store_returns"]},{"kind":"WRITE","substeps":["$180, $181","TO __stage11_output","BY HASH($180, $181)"]}],"writeRatioAvg":0.00104734889810168},{"readMsMax":"36","computeMsMax":"1421","waitMsAvg":"1","id":"18","endMs":"1570904041678","waitMsMax":"1","startMs":"1570904040780","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0.0015710233471525202,"parallelInputs":"1","recordsRead":"1920800","computeRatioAvg":0.06201178267510364,"writeMsAvg":"166","status":"COMPLETE","writeMsMax":"166","computeMsAvg":"1421","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007244163211869954,"readMsAvg":"36","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.06201178267510364,"name":"S12: Input","shuffleOutputBytes":"28812000","recordsWritten":"1920800","readRatioMax":0.0015710233471525202,"steps":[{"kind":"READ","substeps":["$220:cd_demo_sk, $221:cd_marital_status","FROM customer_demographics"]},{"kind":"WRITE","substeps":["$220, $221","TO __stage12_output","BY HASH($220)"]}],"writeRatioAvg":0.007244163211869954},{"readMsMax":"20","computeMsMax":"1565","waitMsAvg":"2","id":"19","endMs":"1570904041785","waitMsMax":"2","startMs":"1570904040801","waitRatioMax":8.727907484180668e-05,"readRatioAvg":0.0008727907484180668,"parallelInputs":"1","recordsRead":"1920800","computeRatioAvg":0.06829587606371372,"writeMsAvg":"186","status":"COMPLETE","writeMsMax":"186","computeMsAvg":"1565","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00811695396028802,"readMsAvg":"20","waitRatioAvg":8.727907484180668e-05,"completedParallelInputs":"1","computeRatioMax":0.06829587606371372,"name":"S13: Input","shuffleOutputBytes":"28812000","recordsWritten":"1920800","readRatioMax":0.0008727907484180668,"steps":[{"kind":"READ","substeps":["$240:cd_demo_sk, $241:cd_marital_status","FROM customer_demographics"]},{"kind":"WRITE","substeps":["$240, $241","TO __stage13_output","BY HASH($240)"]}],"writeRatioAvg":0.00811695396028802},{"readMsMax":"35","computeMsMax":"10","waitMsAvg":"2","id":"20","endMs":"1570904040873","waitMsMax":"2","startMs":"1570904040820","waitRatioMax":8.727907484180668e-05,"readRatioAvg":0.0015273838097316168,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.0004363953742090334,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0002181976871045167,"readMsAvg":"35","waitRatioAvg":8.727907484180668e-05,"completedParallelInputs":"1","computeRatioMax":0.0004363953742090334,"name":"S14: Input","shuffleOutputBytes":"129600","recordsWritten":"7200","readRatioMax":0.0015273838097316168,"steps":[{"kind":"READ","substeps":["$300:hd_demo_sk, $301:hd_income_band_sk","FROM household_demographics"]},{"kind":"WRITE","substeps":["$300, $301","TO __stage14_output","BY HASH($300)"]}],"writeRatioAvg":0.0002181976871045167},{"readMsMax":"22","computeMsMax":"13","waitMsAvg":"1","id":"21","endMs":"1570904041006","waitMsMax":"1","startMs":"1570904040832","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0.0009600698232598735,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.0005673139864717434,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00030547676194632336,"readMsAvg":"22","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.0005673139864717434,"name":"S15: Input","shuffleOutputBytes":"129600","recordsWritten":"7200","readRatioMax":0.0009600698232598735,"steps":[{"kind":"READ","substeps":["$320:hd_demo_sk, $321:hd_income_band_sk","FROM household_demographics"]},{"kind":"WRITE","substeps":["$320, $321","TO __stage15_output","BY HASH($320)"]}],"writeRatioAvg":0.00030547676194632336},{"readMsMax":"21","computeMsMax":"197","waitMsAvg":"1","id":"22","endMs":"1570904041043","waitMsMax":"1","startMs":"1570904040849","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0.0009164302858389701,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.008596988871917958,"writeMsAvg":"13","status":"COMPLETE","writeMsMax":"13","computeMsAvg":"197","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0005673139864717434,"readMsAvg":"21","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.008596988871917958,"name":"S16: Input","shuffleOutputBytes":"5289960","recordsWritten":"100000","readRatioMax":0.0009164302858389701,"steps":[{"kind":"READ","substeps":["$360:c_customer_sk, $361:c_current_cdemo_sk, $362:c_current_hdemo_sk, $363:c_current_addr_sk, $364:c_first_shipto_date_sk, $365:c_first_sales_date_sk","FROM customer"]},{"kind":"WRITE","substeps":["$360, $361, $362, $363, $364, $365","TO __stage16_output","BY HASH($360)"]}],"writeRatioAvg":0.0005673139864717434},{"readMsMax":"16","computeMsMax":"63","waitMsAvg":"1","id":"24","endMs":"1570904041054","waitMsMax":"1","startMs":"1570904040982","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0.0006982325987344534,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0027492908575169105,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"63","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00048003491162993675,"readMsAvg":"16","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.0027492908575169105,"name":"S18: Input","shuffleOutputBytes":"1314882","recordsWritten":"73049","readRatioMax":0.0006982325987344534,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $11:d_year","FROM date_dim"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage18_output","BY HASH($10)"]}],"writeRatioAvg":0.00048003491162993675},{"readMsMax":"9","computeMsMax":"44","waitMsAvg":"1","id":"25","endMs":"1570904041049","waitMsMax":"1","startMs":"1570904041002","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0.00039275583678813006,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.001920139646519747,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"44","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00039275583678813006,"readMsAvg":"9","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.001920139646519747,"name":"S19: Input","shuffleOutputBytes":"1314882","recordsWritten":"73049","readRatioMax":0.00039275583678813006,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_year","FROM date_dim"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage19_output","BY HASH($30)"]}],"writeRatioAvg":0.00039275583678813006},{"readMsMax":"8","computeMsMax":"7","waitMsAvg":"1","id":"26","endMs":"1570904041094","waitMsMax":"1","startMs":"1570904041019","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0.0003491162993672267,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.00030547676194632336,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0003491162993672267,"readMsAvg":"8","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.00030547676194632336,"name":"S1A: Input","shuffleOutputBytes":"333","recordsWritten":"12","readRatioMax":0.0003491162993672267,"steps":[{"kind":"READ","substeps":["$50:s_store_sk, $51:s_store_name, $52:s_zip","FROM store"]},{"kind":"WRITE","substeps":["$50, $51, $52","TO __stage1A_output","BY HASH($50)"]}],"writeRatioAvg":0.0003491162993672267},{"readMsMax":"10","computeMsMax":"6","waitMsAvg":"1","id":"27","endMs":"1570904041107","waitMsMax":"1","startMs":"1570904041032","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0.0004363953742090334,"parallelInputs":"1","recordsRead":"300","computeRatioAvg":0.00026183722452542,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0003491162993672267,"readMsAvg":"10","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.00026183722452542,"name":"S1B: Input","shuffleOutputBytes":"2700","recordsWritten":"300","readRatioMax":0.0004363953742090334,"steps":[{"kind":"READ","substeps":["$70:p_promo_sk","FROM promotion"]},{"kind":"WRITE","substeps":["$70","TO __stage1B_output","BY HASH($70)"]}],"writeRatioAvg":0.0003491162993672267},{"readMsMax":"11","computeMsMax":"85","waitMsAvg":"1","id":"28","endMs":"1570904041169","waitMsMax":"1","startMs":"1570904041049","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0.00048003491162993675,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.0037093606807767836,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"85","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0004363953742090334,"readMsAvg":"11","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.0037093606807767836,"name":"S1C: Input","shuffleOutputBytes":"2665808","recordsWritten":"50000","readRatioMax":0.00048003491162993675,"steps":[{"kind":"READ","substeps":["$90:ca_address_sk, $91:ca_street_number, $92:ca_street_name, $93:ca_city, $94:ca_zip","FROM customer_address"]},{"kind":"WRITE","substeps":["$90, $91, $92, $93, $94","TO __stage1C_output","BY HASH($90)"]}],"writeRatioAvg":0.0004363953742090334},{"readMsMax":"12","computeMsMax":"99","waitMsAvg":"1","id":"29","endMs":"1570904041748","waitMsMax":"1","startMs":"1570904041068","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0.00052367444905084,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.00432031420466943,"writeMsAvg":"66","status":"COMPLETE","writeMsMax":"66","computeMsAvg":"99","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0028802094697796205,"readMsAvg":"12","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.00432031420466943,"name":"S1D: Input","shuffleOutputBytes":"2665808","recordsWritten":"50000","readRatioMax":0.00052367444905084,"steps":[{"kind":"READ","substeps":["$110:ca_address_sk, $111:ca_street_number, $112:ca_street_name, $113:ca_city, $114:ca_zip","FROM customer_address"]},{"kind":"WRITE","substeps":["$110, $111, $112, $113, $114","TO __stage1D_output","BY HASH($110)"]}],"writeRatioAvg":0.0028802094697796205},{"readMsMax":"5","computeMsMax":"7","waitMsAvg":"1","id":"30","endMs":"1570904041167","waitMsMax":"1","startMs":"1570904041089","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0.0002181976871045167,"parallelInputs":"1","recordsRead":"20","computeRatioAvg":0.00030547676194632336,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007855116735762601,"readMsAvg":"5","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.00030547676194632336,"name":"S1E: Input","shuffleOutputBytes":"180","recordsWritten":"20","readRatioMax":0.0002181976871045167,"steps":[{"kind":"READ","substeps":["$130:ib_income_band_sk","FROM income_band"]},{"kind":"WRITE","substeps":["$130","TO __stage1E_output","BY HASH($130)"]}],"writeRatioAvg":0.0007855116735762601},{"readMsMax":"8","computeMsMax":"8","waitMsAvg":"1","id":"31","endMs":"1570904041189","waitMsMax":"1","startMs":"1570904041105","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0.0003491162993672267,"parallelInputs":"1","recordsRead":"20","computeRatioAvg":0.0003491162993672267,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007418721361553567,"readMsAvg":"8","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.0003491162993672267,"name":"S1F: Input","shuffleOutputBytes":"180","recordsWritten":"20","readRatioMax":0.0003491162993672267,"steps":[{"kind":"READ","substeps":["$150:ib_income_band_sk","FROM income_band"]},{"kind":"WRITE","substeps":["$150","TO __stage1F_output","BY HASH($150)"]}],"writeRatioAvg":0.0007418721361553567},{"readMsMax":"0","computeMsMax":"27","inputStages":["5"],"waitMsAvg":"1","id":"32","endMs":"1570904041177","waitMsMax":"1","startMs":"1570904041119","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"17873","computeRatioAvg":0.00117826751036439,"writeMsAvg":"31","status":"COMPLETE","writeMsMax":"31","computeMsAvg":"27","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0013528256600480034,"readMsAvg":"0","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.00117826751036439,"name":"S20: Aggregate+","shuffleOutputBytes":"154395","recordsWritten":"17155","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$1080, $470, $471","FROM __stage05_output"]},{"kind":"FILTER","substeps":["greater($450, multiply(2, $451))"]},{"kind":"AGGREGATE","substeps":["GROUP BY $1090 := $1080","$450 := SUM($470)","$451 := SUM($471)"]},{"kind":"WRITE","substeps":["$1090","TO __stage20_output","BY HASH($1090)"]}],"writeRatioAvg":0.0013528256600480034},{"readMsMax":"8","computeMsMax":"11","waitMsAvg":"5","id":"33","endMs":"1570904041232","waitMsMax":"5","startMs":"1570904041146","waitRatioMax":0.0002181976871045167,"readRatioAvg":0.0003491162993672267,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.00048003491162993675,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0008727907484180668,"readMsAvg":"8","waitRatioAvg":0.0002181976871045167,"completedParallelInputs":"1","computeRatioMax":0.00048003491162993675,"name":"S21: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0003491162993672267,"steps":[{"kind":"READ","substeps":["$170:d_date_sk, $171:d_year","FROM date_dim","WHERE equal($171, 2002)"]},{"kind":"WRITE","substeps":["$170, $171","TO __stage21_output","BY HASH($170)"]}],"writeRatioAvg":0.0008727907484180668},{"readMsMax":"6","computeMsMax":"9","waitMsAvg":"2","id":"34","endMs":"1570904041367","waitMsMax":"2","startMs":"1570904041164","waitRatioMax":8.727907484180668e-05,"readRatioAvg":0.00026183722452542,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.00039275583678813006,"writeMsAvg":"15","status":"COMPLETE","writeMsMax":"15","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0006545930613135501,"readMsAvg":"6","waitRatioAvg":8.727907484180668e-05,"completedParallelInputs":"1","computeRatioMax":0.00039275583678813006,"name":"S22: Input","shuffleOutputBytes":"421","recordsWritten":"13","readRatioMax":0.00026183722452542,"steps":[{"kind":"READ","substeps":["$210:i_item_sk, $213:i_product_name, $211:i_current_price, $212:i_color","FROM item","WHERE and(in($212, 'cyan', 'peach', 'blush', 'frosted', 'powder', 'orange'), between($211, 58, 68), between($211, 59, 73))"]},{"kind":"WRITE","substeps":["$210, $213","TO __stage22_output","BY HASH($210)"]}],"writeRatioAvg":0.0006545930613135501},{"readMsMax":"12","computeMsMax":"280","waitMsAvg":"1","id":"35","endMs":"1570904041397","waitMsMax":"1","startMs":"1570904041177","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0.00052367444905084,"parallelInputs":"1","recordsRead":"288116","computeRatioAvg":0.012219070477852935,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"280","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007418721361553567,"readMsAvg":"12","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.012219070477852935,"name":"S23: Input","shuffleOutputBytes":"5186088","recordsWritten":"288116","readRatioMax":0.00052367444905084,"steps":[{"kind":"READ","substeps":["$200:sr_item_sk, $201:sr_ticket_number","FROM store_returns"]},{"kind":"WRITE","substeps":["$200, $201","TO __stage23_output","BY HASH($200, $201)"]}],"writeRatioAvg":0.0007418721361553567},{"readMsMax":"15","computeMsMax":"1159","waitMsAvg":"1","id":"36","endMs":"1570904041898","waitMsMax":"1","startMs":"1570904041196","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0.0006545930613135501,"parallelInputs":"1","recordsRead":"1920800","computeRatioAvg":0.05057822387082697,"writeMsAvg":"138","status":"COMPLETE","writeMsMax":"138","computeMsAvg":"1159","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006022256164084661,"readMsAvg":"15","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.05057822387082697,"name":"S24: Input","shuffleOutputBytes":"28812000","recordsWritten":"1920800","readRatioMax":0.0006545930613135501,"steps":[{"kind":"READ","substeps":["$230:cd_demo_sk, $231:cd_marital_status","FROM customer_demographics"]},{"kind":"WRITE","substeps":["$230, $231","TO __stage24_output","BY HASH($230)"]}],"writeRatioAvg":0.006022256164084661},{"readMsMax":"29","computeMsMax":"1404","waitMsAvg":"6","id":"37","endMs":"1570904042241","waitMsMax":"6","startMs":"1570904041220","waitRatioMax":0.00026183722452542,"readRatioAvg":0.0012655465852061969,"parallelInputs":"1","recordsRead":"1920800","computeRatioAvg":0.061269910538948286,"writeMsAvg":"308","status":"COMPLETE","writeMsMax":"308","computeMsAvg":"1404","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013440977525638229,"readMsAvg":"29","waitRatioAvg":0.00026183722452542,"completedParallelInputs":"1","computeRatioMax":0.061269910538948286,"name":"S25: Input","shuffleOutputBytes":"28812000","recordsWritten":"1920800","readRatioMax":0.0012655465852061969,"steps":[{"kind":"READ","substeps":["$270:cd_demo_sk, $271:cd_marital_status","FROM customer_demographics"]},{"kind":"WRITE","substeps":["$270, $271","TO __stage25_output","BY HASH($270)"]}],"writeRatioAvg":0.013440977525638229},{"readMsMax":"6","computeMsMax":"13","waitMsAvg":"2","id":"38","endMs":"1570904057455","waitMsMax":"2","startMs":"1570904041328","waitRatioMax":8.727907484180668e-05,"readRatioAvg":0.00026183722452542,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.0005673139864717434,"writeMsAvg":"16063","status":"COMPLETE","writeMsMax":"16063","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.7009818895919703,"readMsAvg":"6","waitRatioAvg":8.727907484180668e-05,"completedParallelInputs":"1","computeRatioMax":0.0005673139864717434,"name":"S26: Input","shuffleOutputBytes":"129600","recordsWritten":"7200","readRatioMax":0.00026183722452542,"steps":[{"kind":"READ","substeps":["$310:hd_demo_sk, $311:hd_income_band_sk","FROM household_demographics"]},{"kind":"WRITE","substeps":["$310, $311","TO __stage26_output","BY HASH($310)"]}],"writeRatioAvg":0.7009818895919703},{"readMsMax":"7","computeMsMax":"12","waitMsAvg":"2","id":"39","endMs":"1570904041424","waitMsMax":"2","startMs":"1570904041343","waitRatioMax":8.727907484180668e-05,"readRatioAvg":0.00030547676194632336,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.00052367444905084,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0004363953742090334,"readMsAvg":"7","waitRatioAvg":8.727907484180668e-05,"completedParallelInputs":"1","computeRatioMax":0.00052367444905084,"name":"S27: Input","shuffleOutputBytes":"129600","recordsWritten":"7200","readRatioMax":0.00030547676194632336,"steps":[{"kind":"READ","substeps":["$330:hd_demo_sk, $331:hd_income_band_sk","FROM household_demographics"]},{"kind":"WRITE","substeps":["$330, $331","TO __stage27_output","BY HASH($330)"]}],"writeRatioAvg":0.0004363953742090334},{"readMsMax":"14","computeMsMax":"163","waitMsAvg":"1","id":"40","endMs":"1570904041648","waitMsMax":"1","startMs":"1570904041360","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0.0006109535238926467,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.007113244599607244,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"163","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0004363953742090334,"readMsAvg":"14","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.007113244599607244,"name":"S28: Input","shuffleOutputBytes":"5289960","recordsWritten":"100000","readRatioMax":0.0006109535238926467,"steps":[{"kind":"READ","substeps":["$390:c_customer_sk, $391:c_current_cdemo_sk, $392:c_current_hdemo_sk, $393:c_current_addr_sk, $394:c_first_shipto_date_sk, $395:c_first_sales_date_sk","FROM customer"]},{"kind":"WRITE","substeps":["$390, $391, $392, $393, $394, $395","TO __stage28_output","BY HASH($390)"]}],"writeRatioAvg":0.0004363953742090334},{"readMsMax":"0","computeMsMax":"19","inputStages":["19"],"waitMsAvg":"3","id":"44","endMs":"1570904042195","waitMsMax":"11","startMs":"1570904041934","waitRatioMax":0.00048003491162993675,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1920800","computeRatioAvg":0.0006545930613135501,"writeMsAvg":"57","status":"COMPLETE","writeMsMax":"99","computeMsAvg":"15","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00432031420466943,"readMsAvg":"0","waitRatioAvg":0.00013091861226271,"completedParallelInputs":"100","computeRatioMax":0.0008291512109971634,"name":"S2C: Coalesce","shuffleOutputBytes":"28812000","recordsWritten":"1920800","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage13_output"]}],"writeRatioAvg":0.00248745363299149},{"readMsMax":"0","computeMsMax":"19","inputStages":["18"],"waitMsAvg":"11","id":"45","endMs":"1570904042112","waitMsMax":"14","startMs":"1570904041944","waitRatioMax":0.0006109535238926467,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1920800","computeRatioAvg":0.0006545930613135501,"writeMsAvg":"58","status":"COMPLETE","writeMsMax":"95","computeMsAvg":"15","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0041457560549858176,"readMsAvg":"0","waitRatioAvg":0.00048003491162993675,"completedParallelInputs":"100","computeRatioMax":0.0008291512109971634,"name":"S2D: Coalesce","shuffleOutputBytes":"28812000","recordsWritten":"1920800","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage12_output"]}],"writeRatioAvg":0.0025310931704123937},{"readMsMax":"0","computeMsMax":"10","inputStages":["14"],"waitMsAvg":"14","id":"46","endMs":"1570904042098","waitMsMax":"22","startMs":"1570904041934","waitRatioMax":0.0009600698232598735,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"17155","computeRatioAvg":0.0002181976871045167,"writeMsAvg":"49","status":"COMPLETE","writeMsMax":"95","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0041457560549858176,"readMsAvg":"0","waitRatioAvg":0.0006109535238926467,"completedParallelInputs":"100","computeRatioMax":0.0004363953742090334,"name":"S2E: Coalesce","shuffleOutputBytes":"154395","recordsWritten":"17155","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0E_output"]}],"writeRatioAvg":0.0021383373336242638},{"readMsMax":"458","computeMsMax":"16701","inputStages":["6","7","9","10","13","21","44","15","17","46","16","20","11","45","8","12","22"],"waitMsAvg":"3","id":"48","endMs":"1570904052719","waitMsMax":"3","startMs":"1570904042167","waitRatioMax":0.00013091861226271,"readRatioAvg":0.01998690813877373,"parallelInputs":"1","recordsRead":"7389277","computeRatioAvg":0.7288239144665066,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"16701","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00017455814968361336,"readMsAvg":"458","waitRatioAvg":0.00013091861226271,"completedParallelInputs":"1","computeRatioMax":0.7288239144665066,"name":"S30: Join+","shuffleOutputBytes":"3197","recordsWritten":"16","readRatioMax":0.01998690813877373,"steps":[{"kind":"READ","substeps":["$340:ss_sold_date_sk, $341:ss_item_sk, $342:ss_customer_sk, $343:ss_cdemo_sk, $344:ss_hdemo_sk, $345:ss_addr_sk, $346:ss_store_sk, $347:ss_promo_sk, $348:ss_ticket_number, $349:ss_wholesale_cost, $350:ss_list_price, $351:ss_coupon_amt","FROM store_sales"]},{"kind":"READ","substeps":["$360, $361, $362, $363, $364, $365","FROM __stage16_output"]},{"kind":"READ","substeps":["$320, $321","FROM __stage15_output"]},{"kind":"READ","substeps":["$300, $301","FROM __stage14_output"]},{"kind":"READ","substeps":["$240, $241","FROM __stage2C_output"]},{"kind":"READ","substeps":["$220, $221","FROM __stage2D_output"]},{"kind":"READ","substeps":["$180, $181","FROM __stage11_output"]},{"kind":"READ","substeps":["$190, $193","FROM __stage10_output"]},{"kind":"READ","substeps":["$160, $161","FROM __stage0F_output"]},{"kind":"READ","substeps":["$680","FROM __stage2E_output"]},{"kind":"READ","substeps":["$140","FROM __stage0D_output"]},{"kind":"READ","substeps":["$120","FROM __stage0C_output"]},{"kind":"READ","substeps":["$100, $101, $102, $103, $104","FROM __stage0B_output"]},{"kind":"READ","substeps":["$80, $81, $82, $83, $84","FROM __stage0A_output"]},{"kind":"READ","substeps":["$60","FROM __stage09_output"]},{"kind":"READ","substeps":["$40, $41, $42","FROM __stage08_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage07_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $870 := $863, $871 := $862, $872 := $851, $873 := $852, $874 := $853, $875 := $854, $876 := $855, $877 := $856, $878 := $857, $879 := $858, $880 := $859, $881 := $860, $882 := $861, $883 := $867, $884 := $850","$420 := COUNT_STAR()","$421 := SUM($864)","$422 := SUM($865)","$423 := SUM($866)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $846 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $824 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $801 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $778 = $60"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $753 = $80"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $739 = $100"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $713 = $120"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $694 = $140"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $644 = $680"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $622 = $160"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $603 = $190"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $584 = $180, $588 = $181"]},{"kind":"FILTER","substeps":["not_equal($595, $580)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $564 = $220"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $551 = $240"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $523 = $300"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $512 = $320"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $342 = $360"]},{"kind":"WRITE","substeps":["$883, $884, $872, $873, $874, $875, $876, $877, $878, $879, $880, $881, $882, $871, $870, $420","TO __stage30_output","BY HASH($870, $871, $872, $873, $874, $875, $876, $877, $878, $879, $880, $881, $882, $883, $884)"]}],"writeRatioAvg":0.00017455814968361336},{"readMsMax":"0","computeMsMax":"20","inputStages":["37"],"waitMsAvg":"2","id":"49","endMs":"1570904058781","waitMsMax":"7","startMs":"1570904058070","waitRatioMax":0.00030547676194632336,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1920800","computeRatioAvg":0.0006982325987344534,"writeMsAvg":"33","status":"COMPLETE","writeMsMax":"92","computeMsAvg":"16","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004014837442723107,"readMsAvg":"0","waitRatioAvg":8.727907484180668e-05,"completedParallelInputs":"100","computeRatioMax":0.0008727907484180668,"name":"S31: Coalesce","shuffleOutputBytes":"28812000","recordsWritten":"1920800","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage25_output"]}],"writeRatioAvg":0.0014401047348898102},{"readMsMax":"0","computeMsMax":"20","inputStages":["36"],"waitMsAvg":"7","id":"50","endMs":"1570904058344","waitMsMax":"8","startMs":"1570904058072","waitRatioMax":0.0003491162993672267,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1920800","computeRatioAvg":0.0006545930613135501,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"58","computeMsAvg":"15","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0025310931704123937,"readMsAvg":"0","waitRatioAvg":0.00030547676194632336,"completedParallelInputs":"100","computeRatioMax":0.0008727907484180668,"name":"S32: Coalesce","shuffleOutputBytes":"28812000","recordsWritten":"1920800","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage24_output"]}],"writeRatioAvg":0.0008291512109971634},{"readMsMax":"0","computeMsMax":"11","inputStages":["32"],"waitMsAvg":"8","id":"51","endMs":"1570904058397","waitMsMax":"9","startMs":"1570904058072","waitRatioMax":0.00039275583678813006,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"17155","computeRatioAvg":0.00026183722452542,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"87","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0037966397556185904,"readMsAvg":"0","waitRatioAvg":0.0003491162993672267,"completedParallelInputs":"100","computeRatioMax":0.00048003491162993675,"name":"S33: Coalesce","shuffleOutputBytes":"154395","recordsWritten":"17155","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage20_output"]}],"writeRatioAvg":0.0009600698232598735},{"readMsMax":"550","computeMsMax":"22915","inputStages":["24","26","27","28","25","31","51","33","40","50","34","30","39","49","35","29","38"],"waitMsAvg":"2","id":"52","endMs":"1570904072130","waitMsMax":"2","startMs":"1570904058111","waitRatioMax":8.727907484180668e-05,"readRatioAvg":0.024001745581496835,"parallelInputs":"1","recordsRead":"7389277","computeRatioAvg":1,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"12","computeMsAvg":"22915","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00052367444905084,"readMsAvg":"550","waitRatioAvg":8.727907484180668e-05,"completedParallelInputs":"1","computeRatioMax":1,"name":"S34: Join+","shuffleOutputBytes":"4288","recordsWritten":"21","readRatioMax":0.024001745581496835,"steps":[{"kind":"READ","substeps":["$370:ss_sold_date_sk, $371:ss_item_sk, $372:ss_customer_sk, $373:ss_cdemo_sk, $374:ss_hdemo_sk, $375:ss_addr_sk, $376:ss_store_sk, $377:ss_promo_sk, $378:ss_ticket_number, $379:ss_wholesale_cost, $380:ss_list_price, $381:ss_coupon_amt","FROM store_sales"]},{"kind":"READ","substeps":["$390, $391, $392, $393, $394, $395","FROM __stage28_output"]},{"kind":"READ","substeps":["$330, $331","FROM __stage27_output"]},{"kind":"READ","substeps":["$310, $311","FROM __stage26_output"]},{"kind":"READ","substeps":["$270, $271","FROM __stage31_output"]},{"kind":"READ","substeps":["$230, $231","FROM __stage32_output"]},{"kind":"READ","substeps":["$200, $201","FROM __stage23_output"]},{"kind":"READ","substeps":["$210, $213","FROM __stage22_output"]},{"kind":"READ","substeps":["$170, $171","FROM __stage21_output"]},{"kind":"READ","substeps":["$1090","FROM __stage33_output"]},{"kind":"READ","substeps":["$150","FROM __stage1F_output"]},{"kind":"READ","substeps":["$130","FROM __stage1E_output"]},{"kind":"READ","substeps":["$110, $111, $112, $113, $114","FROM __stage1D_output"]},{"kind":"READ","substeps":["$90, $91, $92, $93, $94","FROM __stage1C_output"]},{"kind":"READ","substeps":["$70","FROM __stage1B_output"]},{"kind":"READ","substeps":["$50, $51, $52","FROM __stage1A_output"]},{"kind":"READ","substeps":["$30, $31","FROM __stage19_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage18_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $1280 := $1273, $1281 := $1272, $1282 := $1261, $1283 := $1262, $1284 := $1263, $1285 := $1264, $1286 := $1265, $1287 := $1266, $1288 := $1267, $1289 := $1268, $1290 := $1269, $1291 := $1270, $1292 := $1271, $1293 := $1277, $1294 := $1260","$430 := COUNT_STAR()","$431 := SUM($1274)","$432 := SUM($1275)","$433 := SUM($1276)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1256 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1234 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1211 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1188 = $70"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1163 = $90"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1149 = $110"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1123 = $130"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1104 = $150"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1054 = $1090"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1032 = $170"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1013 = $210"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $994 = $200, $998 = $201"]},{"kind":"FILTER","substeps":["not_equal($1005, $990)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $974 = $230"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $961 = $270"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $933 = $310"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $922 = $330"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $372 = $390"]},{"kind":"WRITE","substeps":["$1293, $1294, $1282, $1283, $1284, $1285, $1286, $1287, $1288, $1289, $1290, $1291, $1292, $1281, $1280, $430","TO __stage34_output","BY HASH($1280, $1281, $1282, $1283, $1284, $1285, $1286, $1287, $1288, $1289, $1290, $1291, $1292, $1293, $1294)"]}],"writeRatioAvg":0.00052367444905084},{"readMsMax":"0","computeMsMax":"7","inputStages":["48"],"waitMsAvg":"2","id":"54","endMs":"1570904073991","waitMsMax":"2","startMs":"1570904073767","waitRatioMax":8.727907484180668e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"16","computeRatioAvg":0.00030547676194632336,"writeMsAvg":"165","status":"COMPLETE","writeMsMax":"165","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007200523674449051,"readMsAvg":"0","waitRatioAvg":8.727907484180668e-05,"completedParallelInputs":"1","computeRatioMax":0.00030547676194632336,"name":"S36: Aggregate","shuffleOutputBytes":"2909","recordsWritten":"16","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$883, $884, $872, $873, $874, $875, $876, $877, $878, $879, $880, $881, $882, $871, $870, $420","FROM __stage30_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $890 := $870, $891 := $871, $892 := $872, $893 := $873, $894 := $874, $895 := $875, $896 := $876, $897 := $877, $898 := $878, $899 := $879, $900 := $880, $901 := $881, $902 := $882, $903 := $883, $904 := $884","$400 := SUM_OF_COUNTS($420)","$401 := SUM($421)","$402 := SUM($422)","$403 := SUM($423)"]},{"kind":"WRITE","substeps":["$400, $401, $402, $403, $890, $891, $892, $893, $894, $895, $896, $897, $898, $899, $900, $901","TO __stage36_output","BY HASH($891, $892, $893)"]}],"writeRatioAvg":0.007200523674449051},{"readMsMax":"0","computeMsMax":"9","inputStages":["54"],"waitMsAvg":"1","id":"55","endMs":"1570904074111","waitMsMax":"3","startMs":"1570904074018","waitRatioMax":0.00013091861226271,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"16","computeRatioAvg":0.0002181976871045167,"writeMsAvg":"15","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0012655465852061969,"readMsAvg":"0","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"100","computeRatioMax":0.00039275583678813006,"name":"S37: Coalesce","shuffleOutputBytes":"2909","recordsWritten":"16","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage36_output"]}],"writeRatioAvg":0.0006545930613135501},{"readMsMax":"0","computeMsMax":"9","inputStages":["52","55"],"waitMsAvg":"1","id":"56","endMs":"1570904074145","waitMsMax":"1","startMs":"1570904074036","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"37","computeRatioAvg":0.00039275583678813006,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00026183722452542,"readMsAvg":"0","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.00039275583678813006,"name":"S38: Join+","shuffleOutputBytes":"3094","recordsWritten":"14","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$1293, $1294, $1282, $1283, $1284, $1285, $1286, $1287, $1288, $1289, $1290, $1291, $1292, $1281, $1280, $430","FROM __stage34_output"]},{"kind":"READ","substeps":["$400, $401, $402, $403, $890, $891, $892, $893, $894, $895, $896, $897, $898, $899, $900, $901","FROM __stage37_output"]},{"kind":"FILTER","substeps":["less_or_equal($1337, $1332)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1301 = $891, $1302 = $892, $1303 = $893"]},{"kind":"AGGREGATE","substeps":["GROUP BY $1300 := $1280, $1301 := $1281, $1302 := $1282, $1303 := $1283, $1304 := $1284, $1305 := $1285, $1306 := $1286, $1307 := $1287, $1308 := $1288, $1309 := $1289, $1310 := $1290, $1311 := $1291, $1312 := $1292, $1313 := $1293, $1314 := $1294","$410 := SUM_OF_COUNTS($430)","$411 := SUM($431)","$412 := SUM($432)","$413 := SUM($433)"]},{"kind":"WRITE","substeps":["$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330, $1336, $1331, $1332, $1333, $1334","TO __stage38_output"]}],"writeRatioAvg":0.00026183722452542},{"readMsMax":"0","computeMsMax":"8","inputStages":["56"],"waitMsAvg":"1","id":"57","endMs":"1570904074303","waitMsMax":"1","startMs":"1570904074149","waitRatioMax":4.363953742090334e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"14","computeRatioAvg":0.0003491162993672267,"writeMsAvg":"120","status":"COMPLETE","writeMsMax":"120","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005236744490508401,"readMsAvg":"0","waitRatioAvg":4.363953742090334e-05,"completedParallelInputs":"1","computeRatioMax":0.0003491162993672267,"name":"S39: Output","shuffleOutputBytes":"3094","recordsWritten":"14","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$1320, $1321, $1322, $1323, $1324, $1325, $1326, $1327, $1328, $1329, $1330, $1336, $1331, $1332, $1333, $1334","FROM __stage38_output"]},{"kind":"SORT","substeps":["$1331 ASC, $1320 ASC, $1337 ASC"]},{"kind":"WRITE","substeps":["$1350, $1351, $1352, $1353, $1354, $1355, $1356, $1357, $1358, $1359, $1360, $1361, $1362, $1363, $1364, $1365","TO __stage39_output"]}],"writeRatioAvg":0.005236744490508401}],"estimatedBytesProcessed":"340876689","timeline":[{"totalSlotMs":"747","activeUnits":"4","completedUnits":"0","elapsedMs":"757","pendingUnits":"4"},{"totalSlotMs":"5408","activeUnits":"5","completedUnits":"7","elapsedMs":"2222","pendingUnits":"6"},{"totalSlotMs":"14536","activeUnits":"10","completedUnits":"32","elapsedMs":"3252","pendingUnits":"8"},{"totalSlotMs":"61592","activeUnits":"3","completedUnits":"337","elapsedMs":"3782","pendingUnits":"3"},{"totalSlotMs":"110651","activeUnits":"1","completedUnits":"339","elapsedMs":"14376","pendingUnits":"1"},{"totalSlotMs":"178186","activeUnits":"55","completedUnits":"585","elapsedMs":"20105","pendingUnits":"55"},{"totalSlotMs":"196063","activeUnits":"1","completedUnits":"639","elapsedMs":"20630","pendingUnits":"1"},{"totalSlotMs":"219205","activeUnits":"0","completedUnits":"640","elapsedMs":"34165","pendingUnits":"0"},{"totalSlotMs":"227352","activeUnits":"1","completedUnits":"743","elapsedMs":"36303","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"341835776","totalPartitionsProcessed":"0","totalBytesProcessed":"340876689","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"income_band","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"promotion","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"customer_demographics","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_1"}]},"endTime":"1570904074810"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query64_1570904036"},"etag":"ZkHJMMJ3EXdzwuXaVOOnvw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query64_1570904036?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon188cc3d5fa583ce2675829453fe85d268b914cba","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query64\nWITH cs_ui \n AS (SELECT cs_item_sk, \n Sum(cs_ext_list_price) AS sale, \n Sum(cr_refunded_cash + cr_reversed_charge \n + cr_store_credit) AS refund \n FROM catalog_sales, \n catalog_returns \n WHERE cs_item_sk = cr_item_sk \n AND cs_order_number = cr_order_number \n GROUP BY cs_item_sk \n HAVING Sum(cs_ext_list_price) > 2 benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup Sum( \n cr_refunded_cash + cr_reversed_charge \n + cr_store_credit)), \n cross_sales \n AS (SELECT i_product_name product_name, \n i_item_sk item_sk, \n s_store_name store_name, \n s_zip store_zip, \n ad1.ca_street_number b_street_number, \n ad1.ca_street_name b_streen_name, \n ad1.ca_city b_city, \n ad1.ca_zip b_zip, \n ad2.ca_street_number c_street_number, \n ad2.ca_street_name c_street_name, \n ad2.ca_city c_city, \n ad2.ca_zip c_zip, \n d1.d_year AS syear, \n d2.d_year AS fsyear, \n d3.d_year s2year, \n Count(*) cnt, \n Sum(ss_wholesale_cost) s1, \n Sum(ss_list_price) s2, \n Sum(ss_coupon_amt) s3 \n FROM store_sales, \n store_returns, \n cs_ui, \n date_dim d1, \n date_dim d2, \n date_dim d3, \n store, \n customer, \n customer_demographics cd1, \n customer_demographics cd2, \n promotion, \n household_demographics hd1, \n household_demographics hd2, \n customer_address ad1, \n customer_address ad2, \n income_band ib1, \n income_band ib2, \n item \n WHERE ss_store_sk = s_store_sk \n AND ss_sold_date_sk = d1.d_date_sk \n AND ss_customer_sk = c_customer_sk \n AND ss_cdemo_sk = cd1.cd_demo_sk \n AND ss_hdemo_sk = hd1.hd_demo_sk \n AND ss_addr_sk = ad1.ca_address_sk \n AND ss_item_sk = i_item_sk \n AND ss_item_sk = sr_item_sk \n AND ss_ticket_number = sr_ticket_number \n AND ss_item_sk = cs_ui.cs_item_sk \n AND c_current_cdemo_sk = cd2.cd_demo_sk \n AND c_current_hdemo_sk = hd2.hd_demo_sk \n AND c_current_addr_sk = ad2.ca_address_sk \n AND c_first_sales_date_sk = d2.d_date_sk \n AND c_first_shipto_date_sk = d3.d_date_sk \n AND ss_promo_sk = p_promo_sk \n AND hd1.hd_income_band_sk = ib1.ib_income_band_sk \n AND hd2.hd_income_band_sk = ib2.ib_income_band_sk \n AND cd1.cd_marital_status <> cd2.cd_marital_status \n AND i_color IN ( 'cyan', 'peach', 'blush', 'frosted', \n 'powder', 'orange' ) \n AND i_current_price BETWEEN 58 AND 58 + 10 \n AND i_current_price BETWEEN 58 + 1 AND 58 + 15 \n GROUP BY i_product_name, \n i_item_sk, \n s_store_name, \n s_zip, \n ad1.ca_street_number, \n ad1.ca_street_name, \n ad1.ca_city, \n ad1.ca_zip, \n ad2.ca_street_number, \n ad2.ca_street_name, \n ad2.ca_city, \n ad2.ca_zip, \n d1.d_year, \n d2.d_year, \n d3.d_year) \nSELECT cs1.product_name, \n cs1.store_name, \n cs1.store_zip, \n cs1.b_street_number, \n cs1.b_streen_name, \n cs1.b_city, \n cs1.b_zip, \n cs1.c_street_number, \n cs1.c_street_name, \n cs1.c_city, \n cs1.c_zip, \n cs1.syear, \n cs1.cnt, \n cs1.s1, \n cs1.s2, \n cs1.s3, \n cs2.s1 AS s1_, \n cs2.s2 AS s2_, \n cs2.s3 AS s3_, \n cs2.syear AS syear_, \n cs2.cnt AS cnt_ \nFROM cross_sales cs1, \n cross_sales cs2 \nWHERE cs1.item_sk = cs2.item_sk \n AND cs1.syear = 2001 \n AND cs2.syear = 2001 + 1 \n AND cs2.cnt <= cs1.cnt \n AND cs1.store_name = cs2.store_name \n AND cs1.store_zip = cs2.store_zip \nORDER BY cs1.product_name, \n cs1.store_name, \n cs2.cnt; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query64_1570904036","user_email":"nithish.sankaranarayanan@ulb.be"}
