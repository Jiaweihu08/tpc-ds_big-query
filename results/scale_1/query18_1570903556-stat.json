{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"47335","creationTime":"1570903558943","totalBytesProcessed":"169466550","startTime":"1570903559109","query":{"totalSlotMs":"47335","queryPlan":[{"readMsMax":"48","computeMsMax":"1366","waitMsAvg":"4","id":"0","endMs":"1570903560258","waitMsMax":"4","startMs":"1570903559303","waitRatioMax":0.000878348704435661,"readRatioAvg":0.010540184453227932,"parallelInputs":"1","recordsRead":"1920800","computeRatioAvg":0.29995608256477824,"writeMsAvg":"182","status":"COMPLETE","writeMsMax":"182","computeMsAvg":"1366","shuffleOutputBytesSpilled":"0","writeRatioMax":0.039964866051822576,"readMsAvg":"48","waitRatioAvg":0.000878348704435661,"completedParallelInputs":"1","computeRatioMax":0.29995608256477824,"name":"S00: Input","shuffleOutputBytes":"17287200","recordsWritten":"1920800","readRatioMax":0.010540184453227932,"steps":[{"kind":"READ","substeps":["$1:cd_demo_sk","FROM customer_demographics"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.039964866051822576},{"readMsMax":"10","computeMsMax":"27","waitMsAvg":"19","id":"1","endMs":"1570903559481","waitMsMax":"19","startMs":"1570903559339","waitRatioMax":0.00417215634606939,"readRatioAvg":0.0021958717610891525,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.005928853754940711,"writeMsAvg":"99","status":"COMPLETE","writeMsMax":"99","computeMsAvg":"27","shuffleOutputBytesSpilled":"0","writeRatioMax":0.021739130434782608,"readMsAvg":"10","waitRatioAvg":0.00417215634606939,"completedParallelInputs":"1","computeRatioMax":0.005928853754940711,"name":"S01: Input","shuffleOutputBytes":"540000","recordsWritten":"18000","readRatioMax":0.0021958717610891525,"steps":[{"kind":"READ","substeps":["$10:i_item_sk, $11:i_item_id","FROM item"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.021739130434782608},{"readMsMax":"27","computeMsMax":"165","waitMsAvg":"45","id":"2","endMs":"1570903559532","waitMsMax":"45","startMs":"1570903559383","waitRatioMax":0.009881422924901186,"readRatioAvg":0.005928853754940711,"parallelInputs":"1","recordsRead":"1920800","computeRatioAvg":0.036231884057971016,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"165","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005270092226613966,"readMsAvg":"27","waitRatioAvg":0.009881422924901186,"completedParallelInputs":"1","computeRatioMax":0.036231884057971016,"name":"S02: Input","shuffleOutputBytes":"2469600","recordsWritten":"137200","readRatioMax":0.005928853754940711,"steps":[{"kind":"READ","substeps":["$20:cd_demo_sk, $23:cd_dep_count, $21:cd_gender, $22:cd_education_status","FROM customer_demographics","WHERE and(equal($21, 'F'), equal($22, 'Secondary'))"]},{"kind":"WRITE","substeps":["$20, $23","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.005270092226613966},{"readMsMax":"10","computeMsMax":"25","waitMsAvg":"70","id":"3","endMs":"1570903559487","waitMsMax":"70","startMs":"1570903559426","waitRatioMax":0.015371102327624066,"readRatioAvg":0.0021958717610891525,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.005489679402722881,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"25","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004391743522178305,"readMsAvg":"10","waitRatioAvg":0.015371102327624066,"completedParallelInputs":"1","computeRatioMax":0.005489679402722881,"name":"S03: Input","shuffleOutputBytes":"641397","recordsWritten":"12243","readRatioMax":0.0021958717610891525,"steps":[{"kind":"READ","substeps":["$30:ca_address_sk, $31:ca_county, $32:ca_state, $33:ca_country","FROM customer_address","WHERE in($32, 'KS', 'IA', 'AL', 'UT', 'VA', 'NC', 'TX')"]},{"kind":"WRITE","substeps":["$30, $31, $32, $33","TO __stage03_output","BY HASH($30)"]}],"writeRatioAvg":0.004391743522178305},{"readMsMax":"21","computeMsMax":"9","waitMsAvg":"36","id":"4","endMs":"1570903559545","waitMsMax":"36","startMs":"1570903559469","waitRatioMax":0.007905138339920948,"readRatioAvg":0.00461133069828722,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.001976284584980237,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0010979358805445762,"readMsAvg":"21","waitRatioAvg":0.007905138339920948,"completedParallelInputs":"1","computeRatioMax":0.001976284584980237,"name":"S04: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.00461133069828722,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year","FROM date_dim","WHERE equal($51, 2001)"]},{"kind":"WRITE","substeps":["$50","TO __stage04_output","BY HASH($50)"]}],"writeRatioAvg":0.0010979358805445762},{"readMsMax":"23","computeMsMax":"67","waitMsAvg":"32","id":"5","endMs":"1570903559553","waitMsMax":"32","startMs":"1570903559482","waitRatioMax":0.007026789635485288,"readRatioAvg":0.005050505050505051,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.014712340799297322,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"67","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0024154589371980675,"readMsAvg":"23","waitRatioAvg":0.007026789635485288,"completedParallelInputs":"1","computeRatioMax":0.014712340799297322,"name":"S05: Input","shuffleOutputBytes":"1706268","recordsWritten":"47767","readRatioMax":0.005050505050505051,"steps":[{"kind":"READ","substeps":["$60:c_customer_sk, $61:c_current_cdemo_sk, $62:c_current_addr_sk, $64:c_birth_year, $63:c_birth_month","FROM customer","WHERE in($63, 8, 4, 2, 5, 11, 9)"]},{"kind":"WRITE","substeps":["$60, $61, $62, $64","TO __stage05_output","BY HASH($60)"]}],"writeRatioAvg":0.0024154589371980675},{"readMsMax":"0","computeMsMax":"10","inputStages":["2"],"waitMsAvg":"6","id":"7","endMs":"1570903559842","waitMsMax":"10","startMs":"1570903559587","waitRatioMax":0.0021958717610891525,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"137200","computeRatioAvg":0.0013175230566534915,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"56","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012296881862099254,"readMsAvg":"0","waitRatioAvg":0.0013175230566534915,"completedParallelInputs":"100","computeRatioMax":0.0021958717610891525,"name":"S07: Coalesce","shuffleOutputBytes":"2469600","recordsWritten":"137200","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage02_output"]}],"writeRatioAvg":0.006148440931049627},{"readMsMax":"0","computeMsMax":"17","inputStages":["0"],"waitMsAvg":"1","id":"9","endMs":"1570903560931","waitMsMax":"4","startMs":"1570903560497","waitRatioMax":0.000878348704435661,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1920800","computeRatioAvg":0.002854633289415898,"writeMsAvg":"170","status":"COMPLETE","writeMsMax":"232","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.050944224857268336,"readMsAvg":"0","waitRatioAvg":0.00021958717610891525,"completedParallelInputs":"100","computeRatioMax":0.003732981993851559,"name":"S09: Coalesce","shuffleOutputBytes":"17287200","recordsWritten":"1920800","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage00_output"]}],"writeRatioAvg":0.03732981993851559},{"readMsMax":"291","computeMsMax":"4554","inputStages":["9","1","7","3","4","5"],"waitMsAvg":"4","id":"10","endMs":"1570903564015","waitMsMax":"4","startMs":"1570903560573","waitRatioMax":0.000878348704435661,"readRatioAvg":0.06389986824769434,"parallelInputs":"1","recordsRead":"3573817","computeRatioAvg":1,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"4554","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0010979358805445762,"readMsAvg":"291","waitRatioAvg":0.000878348704435661,"completedParallelInputs":"1","computeRatioMax":1,"name":"S0A: Join+","shuffleOutputBytes":"397908","recordsWritten":"2251","readRatioMax":0.06389986824769434,"steps":[{"kind":"READ","substeps":["$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_bill_cdemo_sk, $43:cs_item_sk, $44:cs_quantity, $45:cs_list_price, $46:cs_sales_price, $47:cs_coupon_amt, $48:cs_net_profit","FROM catalog_sales"]},{"kind":"READ","substeps":["$60, $61, $62, $64","FROM __stage05_output"]},{"kind":"READ","substeps":["$50","FROM __stage04_output"]},{"kind":"READ","substeps":["$30, $31, $32, $33","FROM __stage03_output"]},{"kind":"READ","substeps":["$20, $23","FROM __stage07_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage01_output"]},{"kind":"READ","substeps":["$1","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $220 := $200, $221 := $204, $222 := $203, $223 := $202","$80 := SHARD_AVG($205)","$81 := SHARD_AVG($206)","$82 := SHARD_AVG($208)","$83 := SHARD_AVG($207)","$84 := SHARD_AVG($209)","$85 := SHARD_AVG($210)","$86 := SHARD_AVG($201)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $189 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $163 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $140 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $128 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $100 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $41 = $60"]},{"kind":"WRITE","substeps":["$220, $223, $222, $221, $80, $81, $82, $83, $84, $85, $86","TO __stage0A_output","BY HASH($220, $221, $222, $223)"]}],"writeRatioAvg":0.0010979358805445762},{"readMsMax":"0","computeMsMax":"17","inputStages":["10"],"waitMsAvg":"3","id":"11","endMs":"1570903564726","waitMsMax":"3","startMs":"1570903564599","waitRatioMax":0.0006587615283267457,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2251","computeRatioAvg":0.003732981993851559,"writeMsAvg":"109","status":"COMPLETE","writeMsMax":"109","computeMsAvg":"17","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02393500219587176,"readMsAvg":"0","waitRatioAvg":0.0006587615283267457,"completedParallelInputs":"1","computeRatioMax":0.003732981993851559,"name":"S0B: Sort+","shuffleOutputBytes":"12378","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$220, $223, $222, $221, $80, $81, $82, $83, $84, $85, $86","FROM __stage0A_output"]},{"kind":"SORT","substeps":["$231 ASC, $232 ASC, $233 ASC, $230 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $220, $231 := $221, $232 := $222, $233 := $223","$70 := ROOT_AVG($80)","$71 := ROOT_AVG($81)","$72 := ROOT_AVG($82)","$73 := ROOT_AVG($83)","$74 := ROOT_AVG($84)","$75 := ROOT_AVG($85)","$76 := ROOT_AVG($86)"]},{"kind":"WRITE","substeps":["$240, $241, $242, $243, $244, $245, $246, $247, $248, $249, $250","TO __stage0B_output"]}],"writeRatioAvg":0.02393500219587176},{"readMsMax":"0","computeMsMax":"8","inputStages":["11"],"waitMsAvg":"13","id":"12","endMs":"1570903564808","waitMsMax":"13","startMs":"1570903564715","waitRatioMax":0.002854633289415898,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.001756697408871322,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00417215634606939,"readMsAvg":"0","waitRatioAvg":0.002854633289415898,"completedParallelInputs":"1","computeRatioMax":0.001756697408871322,"name":"S0C: Output","shuffleOutputBytes":"12378","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$240, $241, $242, $243, $244, $245, $246, $247, $248, $249, $250","FROM __stage0B_output"]},{"kind":"SORT","substeps":["$243 ASC, $242 ASC, $241 ASC, $240 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$260, $261, $262, $263, $264, $265, $266, $267, $268, $269, $270","TO __stage0C_output"]}],"writeRatioAvg":0.00417215634606939}],"estimatedBytesProcessed":"169466550","timeline":[{"totalSlotMs":"13311","activeUnits":"50","completedUnits":"58","elapsedMs":"695","pendingUnits":"49"},{"totalSlotMs":"22892","activeUnits":"47","completedUnits":"106","elapsedMs":"1197","pendingUnits":"1"},{"totalSlotMs":"41099","activeUnits":"1","completedUnits":"206","elapsedMs":"1889","pendingUnits":"1"},{"totalSlotMs":"47335","activeUnits":"0","completedUnits":"209","elapsedMs":"5853","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"169869312","totalPartitionsProcessed":"0","totalBytesProcessed":"169466550","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"customer_demographics","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"}]},"endTime":"1570903565001"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query18_1570903556"},"etag":"fer+ERuNcRoMqmmwT2t1Xg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query18_1570903556?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon8842f0897cae3bb9787302ac52102e0bdab465db","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query18\nSELECT i_item_id, \n ca_country, \n ca_state, \n ca_county, \n Avg(cs_quantity) agg1, \n Avg(cs_list_price) agg2, \n Avg(cs_coupon_amt) agg3, \n Avg(cs_sales_price) agg4, \n Avg(cs_net_profit) agg5, \n Avg(c_birth_year) agg6, \n Avg(cd1.cd_dep_count) agg7 \nFROM catalog_sales, \n customer_demographics cd1, \n customer_demographics cd2, \n customer, \n customer_address, \n date_dim, \n item \nWHERE cs_sold_date_sk = d_date_sk \n AND cs_item_sk = i_item_sk \n AND cs_bill_cdemo_sk = cd1.cd_demo_sk \n AND cs_bill_customer_sk = c_customer_sk \n AND cd1.cd_gender = 'F' \n AND cd1.cd_education_status = 'Secondary' \n AND c_current_cdemo_sk = cd2.cd_demo_sk \n AND c_current_addr_sk = ca_address_sk \n AND c_birth_month IN ( 8, 4, 2, 5, \n 11, 9 ) \n AND d_year = 2001 \n AND ca_state IN ( 'KS', 'IA', 'AL', 'UT', \n 'VA', 'NC', 'TX' ) \nGROUP BY i_item_id, ca_country, ca_state, ca_county \nORDER BY ca_country, \n ca_state, \n ca_county, \n i_item_id\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query18_1570903556","user_email":"nithish.sankaranarayanan@ulb.be"}
