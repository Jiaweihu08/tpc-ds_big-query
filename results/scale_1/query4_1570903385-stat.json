{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"145970","creationTime":"1570903386919","totalBytesProcessed":"240918482","startTime":"1570903387180","query":{"totalSlotMs":"145970","queryPlan":[{"readMsMax":"13","computeMsMax":"8","waitMsAvg":"15","id":"0","endMs":"1570903387629","waitMsMax":"15","startMs":"1570903387445","waitRatioMax":0.0026795284030010718,"readRatioAvg":0.0023222579492675954,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0014290818149339049,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0014290818149339049,"readMsAvg":"13","waitRatioAvg":0.0026795284030010718,"completedParallelInputs":"1","computeRatioMax":0.0014290818149339049,"name":"S00: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0023222579492675954,"steps":[{"kind":"READ","substeps":["$180:d_date_sk, $181:d_year","FROM date_dim","WHERE equal($181, 2001)"]},{"kind":"WRITE","substeps":["$180, $181","TO __stage00_output","BY HASH($180)"]}],"writeRatioAvg":0.0014290818149339049},{"readMsMax":"18","computeMsMax":"88","waitMsAvg":"66","id":"2","endMs":"1570903388259","waitMsMax":"66","startMs":"1570903387542","waitRatioMax":0.011789924973204717,"readRatioAvg":0.003215434083601286,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.015719899964272956,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"88","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003394069310468024,"readMsAvg":"18","waitRatioAvg":0.011789924973204717,"completedParallelInputs":"1","computeRatioMax":0.015719899964272956,"name":"S02: Input","shuffleOutputBytes":"3000000","recordsWritten":"100000","readRatioMax":0.003215434083601286,"steps":[{"kind":"READ","substeps":["$160:c_customer_sk, $161:c_customer_id","FROM customer"]},{"kind":"WRITE","substeps":["$160, $161","TO __stage02_output","BY HASH($160)"]}],"writeRatioAvg":0.003394069310468024},{"readMsMax":"11","computeMsMax":"6","waitMsAvg":"34","id":"3","endMs":"1570903387757","waitMsMax":"34","startMs":"1570903387596","waitRatioMax":0.006073597713469096,"readRatioAvg":0.0019649874955341195,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0010718113612004287,"writeMsAvg":"139","status":"COMPLETE","writeMsMax":"139","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0248302965344766,"readMsAvg":"11","waitRatioAvg":0.006073597713469096,"completedParallelInputs":"1","computeRatioMax":0.0010718113612004287,"name":"S03: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0019649874955341195,"steps":[{"kind":"READ","substeps":["$150:d_date_sk, $151:d_year","FROM date_dim","WHERE equal($151, 2001)"]},{"kind":"WRITE","substeps":["$150, $151","TO __stage03_output","BY HASH($150)"]}],"writeRatioAvg":0.0248302965344766},{"readMsMax":"23","computeMsMax":"99","waitMsAvg":"42","id":"5","endMs":"1570903387914","waitMsMax":"42","startMs":"1570903387635","waitRatioMax":0.007502679528403001,"readRatioAvg":0.004108610217934977,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.017684887459807074,"writeMsAvg":"32","status":"COMPLETE","writeMsMax":"32","computeMsAvg":"99","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0057163272597356195,"readMsAvg":"23","waitRatioAvg":0.007502679528403001,"completedParallelInputs":"1","computeRatioMax":0.017684887459807074,"name":"S05: Input","shuffleOutputBytes":"3000000","recordsWritten":"100000","readRatioMax":0.004108610217934977,"steps":[{"kind":"READ","substeps":["$130:c_customer_sk, $131:c_customer_id","FROM customer"]},{"kind":"WRITE","substeps":["$130, $131","TO __stage05_output","BY HASH($130)"]}],"writeRatioAvg":0.0057163272597356195},{"readMsMax":"10","computeMsMax":"7","waitMsAvg":"40","id":"6","endMs":"1570903387943","waitMsMax":"40","startMs":"1570903387735","waitRatioMax":0.007145409074669525,"readRatioAvg":0.0017863522686673813,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.001250446588067167,"writeMsAvg":"186","status":"COMPLETE","writeMsMax":"186","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03322615219721329,"readMsAvg":"10","waitRatioAvg":0.007145409074669525,"completedParallelInputs":"1","computeRatioMax":0.001250446588067167,"name":"S06: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0017863522686673813,"steps":[{"kind":"READ","substeps":["$120:d_date_sk, $121:d_year","FROM date_dim","WHERE equal($121, 2002)"]},{"kind":"WRITE","substeps":["$120, $121","TO __stage06_output","BY HASH($120)"]}],"writeRatioAvg":0.03322615219721329},{"readMsMax":"42","computeMsMax":"113","waitMsAvg":"53","id":"8","endMs":"1570903388192","waitMsMax":"53","startMs":"1570903387859","waitRatioMax":0.00946766702393712,"readRatioAvg":0.007502679528403001,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.020185780635941408,"writeMsAvg":"38","status":"COMPLETE","writeMsMax":"38","computeMsAvg":"113","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006788138620936048,"readMsAvg":"42","waitRatioAvg":0.00946766702393712,"completedParallelInputs":"1","computeRatioMax":0.020185780635941408,"name":"S08: Input","shuffleOutputBytes":"3000000","recordsWritten":"100000","readRatioMax":0.007502679528403001,"steps":[{"kind":"READ","substeps":["$100:c_customer_sk, $101:c_customer_id","FROM customer"]},{"kind":"WRITE","substeps":["$100, $101","TO __stage08_output","BY HASH($100)"]}],"writeRatioAvg":0.006788138620936048},{"readMsMax":"15","computeMsMax":"12","waitMsAvg":"39","id":"9","endMs":"1570903388138","waitMsMax":"39","startMs":"1570903387860","waitRatioMax":0.006966773847802787,"readRatioAvg":0.0026795284030010718,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0021436227224008574,"writeMsAvg":"64","status":"COMPLETE","writeMsMax":"64","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011432654519471239,"readMsAvg":"15","waitRatioAvg":0.006966773847802787,"completedParallelInputs":"1","computeRatioMax":0.0021436227224008574,"name":"S09: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0026795284030010718,"steps":[{"kind":"READ","substeps":["$90:d_date_sk, $91:d_year","FROM date_dim","WHERE equal($91, 2002)"]},{"kind":"WRITE","substeps":["$90, $91","TO __stage09_output","BY HASH($90)"]}],"writeRatioAvg":0.011432654519471239},{"readMsMax":"45","computeMsMax":"104","waitMsAvg":"10","id":"11","endMs":"1570903388301","waitMsMax":"10","startMs":"1570903387938","waitRatioMax":0.0017863522686673813,"readRatioAvg":0.008038585209003215,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.018578063594140763,"writeMsAvg":"43","status":"COMPLETE","writeMsMax":"43","computeMsAvg":"104","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007681314755269739,"readMsAvg":"45","waitRatioAvg":0.0017863522686673813,"completedParallelInputs":"1","computeRatioMax":0.018578063594140763,"name":"S0B: Input","shuffleOutputBytes":"3000000","recordsWritten":"100000","readRatioMax":0.008038585209003215,"steps":[{"kind":"READ","substeps":["$70:c_customer_sk, $71:c_customer_id","FROM customer"]},{"kind":"WRITE","substeps":["$70, $71","TO __stage0B_output","BY HASH($70)"]}],"writeRatioAvg":0.007681314755269739},{"readMsMax":"18","computeMsMax":"13","waitMsAvg":"77","id":"12","endMs":"1570903388227","waitMsMax":"77","startMs":"1570903388021","waitRatioMax":0.013754912468738835,"readRatioAvg":0.003215434083601286,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0023222579492675954,"writeMsAvg":"15","status":"COMPLETE","writeMsMax":"15","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0026795284030010718,"readMsAvg":"18","waitRatioAvg":0.013754912468738835,"completedParallelInputs":"1","computeRatioMax":0.0023222579492675954,"name":"S0C: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.003215434083601286,"steps":[{"kind":"READ","substeps":["$60:d_date_sk, $61:d_year","FROM date_dim","WHERE equal($61, 2001)"]},{"kind":"WRITE","substeps":["$60, $61","TO __stage0C_output","BY HASH($60)"]}],"writeRatioAvg":0.0026795284030010718},{"readMsMax":"44","computeMsMax":"93","waitMsAvg":"54","id":"14","endMs":"1570903388419","waitMsMax":"54","startMs":"1570903388106","waitRatioMax":0.00964630225080386,"readRatioAvg":0.007859949982136478,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.016613076098606645,"writeMsAvg":"31","status":"COMPLETE","writeMsMax":"31","computeMsAvg":"93","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0055376920328688815,"readMsAvg":"44","waitRatioAvg":0.00964630225080386,"completedParallelInputs":"1","computeRatioMax":0.016613076098606645,"name":"S0E: Input","shuffleOutputBytes":"3000000","recordsWritten":"100000","readRatioMax":0.007859949982136478,"steps":[{"kind":"READ","substeps":["$40:c_customer_sk, $41:c_customer_id","FROM customer"]},{"kind":"WRITE","substeps":["$40, $41","TO __stage0E_output","BY HASH($40)"]}],"writeRatioAvg":0.0055376920328688815},{"readMsMax":"17","computeMsMax":"7","waitMsAvg":"26","id":"15","endMs":"1570903388342","waitMsMax":"26","startMs":"1570903388173","waitRatioMax":0.004644515898535191,"readRatioAvg":0.003036798856734548,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.001250446588067167,"writeMsAvg":"141","status":"COMPLETE","writeMsMax":"141","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.025187566988210074,"readMsAvg":"17","waitRatioAvg":0.004644515898535191,"completedParallelInputs":"1","computeRatioMax":0.001250446588067167,"name":"S0F: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.003036798856734548,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_year","FROM date_dim","WHERE equal($31, 2002)"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage0F_output","BY HASH($30)"]}],"writeRatioAvg":0.025187566988210074},{"readMsMax":"18","computeMsMax":"96","waitMsAvg":"33","id":"17","endMs":"1570903388534","waitMsMax":"33","startMs":"1570903388223","waitRatioMax":0.005894962486602358,"readRatioAvg":0.003215434083601286,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.01714898177920686,"writeMsAvg":"40","status":"COMPLETE","writeMsMax":"40","computeMsAvg":"96","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007145409074669525,"readMsAvg":"18","waitRatioAvg":0.005894962486602358,"completedParallelInputs":"1","computeRatioMax":0.01714898177920686,"name":"S11: Input","shuffleOutputBytes":"3000000","recordsWritten":"100000","readRatioMax":0.003215434083601286,"steps":[{"kind":"READ","substeps":["$10:c_customer_sk, $11:c_customer_id","FROM customer"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage11_output","BY HASH($10)"]}],"writeRatioAvg":0.007145409074669525},{"readMsMax":"38","computeMsMax":"3160","inputStages":["3","5"],"waitMsAvg":"21","id":"18","endMs":"1570903389940","waitMsMax":"21","startMs":"1570903388293","waitRatioMax":0.0037513397642015005,"readRatioAvg":0.006788138620936048,"parallelInputs":"1","recordsRead":"1537807","computeRatioAvg":0.5644873168988924,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"3160","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0037513397642015005,"readMsAvg":"38","waitRatioAvg":0.0037513397642015005,"completedParallelInputs":"1","computeRatioMax":0.5644873168988924,"name":"S12: Join+","shuffleOutputBytes":"1068054","recordsWritten":"27386","readRatioMax":0.006788138620936048,"steps":[{"kind":"READ","substeps":["$140:cs_sold_date_sk, $141:cs_bill_customer_sk, $142:cs_ext_discount_amt, $143:cs_ext_sales_price, $144:cs_ext_wholesale_cost, $145:cs_ext_list_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$130, $131","FROM __stage05_output"]},{"kind":"READ","substeps":["$150, $151","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $480 := $470, $481 := $475","$320 := SUM($350)"]},{"kind":"COMPUTE","substeps":["$350 := divide(add(subtract(subtract($474, $473), $471), $472), 2)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $461 = $150"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $141 = $130"]},{"kind":"WRITE","substeps":["$480, $481, $320","TO __stage12_output","BY HASH($480, $481)"]}],"writeRatioAvg":0.0037513397642015005},{"readMsMax":"109","computeMsMax":"5598","inputStages":["6","8"],"waitMsAvg":"10","id":"19","endMs":"1570903392284","waitMsMax":"10","startMs":"1570903388301","waitRatioMax":0.0017863522686673813,"readRatioAvg":0.019471239728474456,"parallelInputs":"1","recordsRead":"2981543","computeRatioAvg":1,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"5598","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00482315112540193,"readMsAvg":"109","waitRatioAvg":0.0017863522686673813,"completedParallelInputs":"1","computeRatioMax":1,"name":"S13: Join+","shuffleOutputBytes":"1491165","recordsWritten":"38235","readRatioMax":0.019471239728474456,"steps":[{"kind":"READ","substeps":["$110:ss_sold_date_sk, $111:ss_customer_sk, $112:ss_ext_discount_amt, $113:ss_ext_sales_price, $114:ss_ext_wholesale_cost, $115:ss_ext_list_price","FROM store_sales"]},{"kind":"READ","substeps":["$100, $101","FROM __stage08_output"]},{"kind":"READ","substeps":["$120, $121","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $430 := $420, $431 := $425","$310 := SUM($340)"]},{"kind":"COMPUTE","substeps":["$340 := divide(add(subtract(subtract($424, $423), $421), $422), 2)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $411 = $120"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $111 = $100"]},{"kind":"WRITE","substeps":["$430, $431, $310","TO __stage13_output","BY HASH($430, $431)"]}],"writeRatioAvg":0.00482315112540193},{"readMsMax":"54","computeMsMax":"4767","inputStages":["0","2"],"waitMsAvg":"9","id":"20","endMs":"1570903391293","waitMsMax":"9","startMs":"1570903388534","waitRatioMax":0.001607717041800643,"readRatioAvg":0.00964630225080386,"parallelInputs":"1","recordsRead":"2981543","computeRatioAvg":0.8515541264737406,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"4767","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004108610217934977,"readMsAvg":"54","waitRatioAvg":0.001607717041800643,"completedParallelInputs":"1","computeRatioMax":0.8515541264737406,"name":"S14: Join+","shuffleOutputBytes":"1475214","recordsWritten":"37826","readRatioMax":0.00964630225080386,"steps":[{"kind":"READ","substeps":["$170:ss_sold_date_sk, $171:ss_customer_sk, $172:ss_ext_discount_amt, $173:ss_ext_sales_price, $174:ss_ext_wholesale_cost, $175:ss_ext_list_price","FROM store_sales"]},{"kind":"READ","substeps":["$160, $161","FROM __stage02_output"]},{"kind":"READ","substeps":["$180, $181","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $390 := $380, $391 := $385","$330 := SUM($360)"]},{"kind":"COMPUTE","substeps":["$360 := divide(add(subtract(subtract($384, $383), $381), $382), 2)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $371 = $180"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $171 = $160"]},{"kind":"WRITE","substeps":["$390, $391, $330","TO __stage14_output","BY HASH($390, $391)"]}],"writeRatioAvg":0.004108610217934977},{"readMsMax":"45","computeMsMax":"2838","inputStages":["9","11"],"waitMsAvg":"40","id":"21","endMs":"1570903390250","waitMsMax":"40","startMs":"1570903388705","waitRatioMax":0.007145409074669525,"readRatioAvg":0.008038585209003215,"parallelInputs":"1","recordsRead":"1537807","computeRatioAvg":0.5069667738478028,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"2838","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004287245444801715,"readMsAvg":"45","waitRatioAvg":0.007145409074669525,"completedParallelInputs":"1","computeRatioMax":0.5069667738478028,"name":"S15: Join+","shuffleOutputBytes":"1066689","recordsWritten":"27351","readRatioMax":0.008038585209003215,"steps":[{"kind":"READ","substeps":["$80:cs_sold_date_sk, $81:cs_bill_customer_sk, $82:cs_ext_discount_amt, $83:cs_ext_sales_price, $84:cs_ext_wholesale_cost, $85:cs_ext_list_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$70, $71","FROM __stage0B_output"]},{"kind":"READ","substeps":["$90, $91","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $530 := $520, $531 := $525","$270 := SUM($300)"]},{"kind":"COMPUTE","substeps":["$300 := divide(add(subtract(subtract($524, $523), $521), $522), 2)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $511 = $90"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $81 = $70"]},{"kind":"WRITE","substeps":["$530, $531, $270","TO __stage15_output","BY HASH($530, $531)"]}],"writeRatioAvg":0.004287245444801715},{"readMsMax":"42","computeMsMax":"534","inputStages":["12","14"],"waitMsAvg":"6","id":"22","endMs":"1570903390398","waitMsMax":"6","startMs":"1570903388807","waitRatioMax":0.0010718113612004287,"readRatioAvg":0.007502679528403001,"parallelInputs":"1","recordsRead":"821124","computeRatioAvg":0.09539121114683816,"writeMsAvg":"1222","status":"COMPLETE","writeMsMax":"1222","computeMsAvg":"534","shuffleOutputBytesSpilled":"0","writeRatioMax":0.21829224723115398,"readMsAvg":"42","waitRatioAvg":0.0010718113612004287,"completedParallelInputs":"1","computeRatioMax":0.09539121114683816,"name":"S16: Join+","shuffleOutputBytes":"437307","recordsWritten":"11213","readRatioMax":0.007502679528403001,"steps":[{"kind":"READ","substeps":["$50:ws_sold_date_sk, $51:ws_bill_customer_sk, $52:ws_ext_discount_amt, $53:ws_ext_sales_price, $54:ws_ext_wholesale_cost, $55:ws_ext_list_price","FROM web_sales"]},{"kind":"READ","substeps":["$40, $41","FROM __stage0E_output"]},{"kind":"READ","substeps":["$60, $61","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $580 := $570, $581 := $575","$240 := SUM($280)"]},{"kind":"COMPUTE","substeps":["$280 := divide(add(subtract(subtract($574, $573), $571), $572), 2)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $561 = $60"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $51 = $40"]},{"kind":"WRITE","substeps":["$580, $581, $240","TO __stage16_output","BY HASH($580, $581)"]}],"writeRatioAvg":0.21829224723115398},{"readMsMax":"42","computeMsMax":"594","inputStages":["15","17"],"waitMsAvg":"5","id":"23","endMs":"1570903390298","waitMsMax":"5","startMs":"1570903388992","waitRatioMax":0.0008931761343336906,"readRatioAvg":0.007502679528403001,"parallelInputs":"1","recordsRead":"821124","computeRatioAvg":0.10610932475884244,"writeMsAvg":"813","status":"COMPLETE","writeMsMax":"813","computeMsAvg":"594","shuffleOutputBytesSpilled":"0","writeRatioMax":0.1452304394426581,"readMsAvg":"42","waitRatioAvg":0.0008931761343336906,"completedParallelInputs":"1","computeRatioMax":0.10610932475884244,"name":"S17: Join+","shuffleOutputBytes":"439491","recordsWritten":"11269","readRatioMax":0.007502679528403001,"steps":[{"kind":"READ","substeps":["$20:ws_sold_date_sk, $21:ws_bill_customer_sk, $22:ws_ext_discount_amt, $23:ws_ext_sales_price, $24:ws_ext_wholesale_cost, $25:ws_ext_list_price","FROM web_sales"]},{"kind":"READ","substeps":["$10, $11","FROM __stage11_output"]},{"kind":"READ","substeps":["$30, $31","FROM __stage0F_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $630 := $620, $631 := $625","$210 := SUM($230)"]},{"kind":"COMPUTE","substeps":["$230 := divide(add(subtract(subtract($624, $623), $621), $622), 2)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $611 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $21 = $10"]},{"kind":"WRITE","substeps":["$630, $631, $210","TO __stage17_output","BY HASH($630, $631)"]}],"writeRatioAvg":0.1452304394426581},{"readMsMax":"98","computeMsMax":"150","waitMsAvg":"1","id":"24","endMs":"1570903393951","waitMsMax":"1","startMs":"1570903392745","waitRatioMax":0.0001786352268667381,"readRatioAvg":0.017506252232940337,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.02679528403001072,"writeMsAvg":"489","status":"COMPLETE","writeMsMax":"489","computeMsAvg":"150","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08735262593783494,"readMsAvg":"98","waitRatioAvg":0.0001786352268667381,"completedParallelInputs":"1","computeRatioMax":0.02679528403001072,"name":"S18: Input","shuffleOutputBytes":"4810946","recordsWritten":"100000","readRatioMax":0.017506252232940337,"steps":[{"kind":"READ","substeps":["$1:c_customer_id, $2:c_first_name, $3:c_last_name, $4:c_preferred_cust_flag","FROM customer"]},{"kind":"WRITE","substeps":["$1, $2, $3, $4","TO __stage18_output","BY HASH($1)"]}],"writeRatioAvg":0.08735262593783494},{"readMsMax":"0","computeMsMax":"27","inputStages":["23"],"waitMsAvg":"6","id":"25","endMs":"1570903393224","waitMsMax":"6","startMs":"1570903392862","waitRatioMax":0.0010718113612004287,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"11269","computeRatioAvg":0.00482315112540193,"writeMsAvg":"150","status":"COMPLETE","writeMsMax":"150","computeMsAvg":"27","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02679528403001072,"readMsAvg":"0","waitRatioAvg":0.0010718113612004287,"completedParallelInputs":"1","computeRatioMax":0.00482315112540193,"name":"S19: Aggregate","shuffleOutputBytes":"338070","recordsWritten":"11269","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$630, $631, $210","FROM __stage17_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $640 := $630, $641 := $631","$190 := SUM($210)"]},{"kind":"WRITE","substeps":["$190, $640","TO __stage19_output","BY HASH($640)"]}],"writeRatioAvg":0.02679528403001072},{"readMsMax":"0","computeMsMax":"38","inputStages":["22"],"waitMsAvg":"1","id":"26","endMs":"1570903393339","waitMsMax":"1","startMs":"1570903392993","waitRatioMax":0.0001786352268667381,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"11213","computeRatioAvg":0.006788138620936048,"writeMsAvg":"139","status":"COMPLETE","writeMsMax":"139","computeMsAvg":"38","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0248302965344766,"readMsAvg":"0","waitRatioAvg":0.0001786352268667381,"completedParallelInputs":"1","computeRatioMax":0.006788138620936048,"name":"S1A: Aggregate+","shuffleOutputBytes":"331110","recordsWritten":"11037","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$580, $581, $240","FROM __stage16_output"]},{"kind":"FILTER","substeps":["greater($200, 0)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $590 := $580, $591 := $581","$200 := SUM($240)"]},{"kind":"WRITE","substeps":["$200, $590","TO __stage1A_output","BY HASH($590)"]}],"writeRatioAvg":0.0248302965344766},{"readMsMax":"0","computeMsMax":"85","inputStages":["21"],"waitMsAvg":"1","id":"27","endMs":"1570903393284","waitMsMax":"1","startMs":"1570903393034","waitRatioMax":0.0001786352268667381,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"27351","computeRatioAvg":0.01518399428367274,"writeMsAvg":"183","status":"COMPLETE","writeMsMax":"183","computeMsAvg":"85","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03269024651661308,"readMsAvg":"0","waitRatioAvg":0.0001786352268667381,"completedParallelInputs":"1","computeRatioMax":0.01518399428367274,"name":"S1B: Aggregate","shuffleOutputBytes":"820530","recordsWritten":"27351","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$530, $531, $270","FROM __stage15_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $540 := $530, $541 := $531","$220 := SUM($270)"]},{"kind":"WRITE","substeps":["$220, $540","TO __stage1B_output","BY HASH($540)"]}],"writeRatioAvg":0.03269024651661308},{"readMsMax":"0","computeMsMax":"73","inputStages":["18"],"waitMsAvg":"1","id":"28","endMs":"1570903393378","waitMsMax":"1","startMs":"1570903393135","waitRatioMax":0.0001786352268667381,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"27386","computeRatioAvg":0.013040371561271883,"writeMsAvg":"166","status":"COMPLETE","writeMsMax":"166","computeMsAvg":"73","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02965344765987853,"readMsAvg":"0","waitRatioAvg":0.0001786352268667381,"completedParallelInputs":"1","computeRatioMax":0.013040371561271883,"name":"S1C: Aggregate+","shuffleOutputBytes":"788940","recordsWritten":"26298","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$480, $481, $320","FROM __stage12_output"]},{"kind":"FILTER","substeps":["greater($260, 0)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $490 := $480, $491 := $481","$260 := SUM($320)"]},{"kind":"WRITE","substeps":["$260, $490","TO __stage1C_output","BY HASH($490)"]}],"writeRatioAvg":0.02965344765987853},{"readMsMax":"0","computeMsMax":"78","inputStages":["19"],"waitMsAvg":"1","id":"29","endMs":"1570903393377","waitMsMax":"1","startMs":"1570903393235","waitRatioMax":0.0001786352268667381,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"38235","computeRatioAvg":0.013933547695605574,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"78","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004287245444801715,"readMsAvg":"0","waitRatioAvg":0.0001786352268667381,"completedParallelInputs":"1","computeRatioMax":0.013933547695605574,"name":"S1D: Aggregate","shuffleOutputBytes":"1147050","recordsWritten":"38235","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$430, $431, $310","FROM __stage13_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $440 := $430, $441 := $431","$250 := SUM($310)"]},{"kind":"WRITE","substeps":["$250, $440","TO __stage1D_output","BY HASH($440)"]}],"writeRatioAvg":0.004287245444801715},{"readMsMax":"0","computeMsMax":"9","inputStages":["29"],"waitMsAvg":"2","id":"31","endMs":"1570903393673","waitMsMax":"4","startMs":"1570903393398","waitRatioMax":0.0007145409074669524,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"38235","computeRatioAvg":0.0008931761343336906,"writeMsAvg":"173","status":"COMPLETE","writeMsMax":"221","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03947838513754912,"readMsAvg":"0","waitRatioAvg":0.0003572704537334762,"completedParallelInputs":"100","computeRatioMax":0.001607717041800643,"name":"S1F: Coalesce","shuffleOutputBytes":"1147050","recordsWritten":"38235","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage1D_output"]}],"writeRatioAvg":0.030903894247945696},{"readMsMax":"0","computeMsMax":"10","inputStages":["28"],"waitMsAvg":"3","id":"33","endMs":"1570903393788","waitMsMax":"4","startMs":"1570903393482","waitRatioMax":0.0007145409074669524,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"26298","computeRatioAvg":0.001250446588067167,"writeMsAvg":"72","status":"COMPLETE","writeMsMax":"104","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.018578063594140763,"readMsAvg":"0","waitRatioAvg":0.0005359056806002144,"completedParallelInputs":"100","computeRatioMax":0.0017863522686673813,"name":"S21: Coalesce","shuffleOutputBytes":"788940","recordsWritten":"26298","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage1C_output"]}],"writeRatioAvg":0.012861736334405145},{"readMsMax":"0","computeMsMax":"12","inputStages":["27"],"waitMsAvg":"4","id":"34","endMs":"1570903393890","waitMsMax":"6","startMs":"1570903393486","waitRatioMax":0.0010718113612004287,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"27351","computeRatioAvg":0.0010718113612004287,"writeMsAvg":"152","status":"COMPLETE","writeMsMax":"200","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03572704537334762,"readMsAvg":"0","waitRatioAvg":0.0007145409074669524,"completedParallelInputs":"100","computeRatioMax":0.0021436227224008574,"name":"S22: Coalesce","shuffleOutputBytes":"820530","recordsWritten":"27351","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage1B_output"]}],"writeRatioAvg":0.027152554483744193},{"readMsMax":"0","computeMsMax":"27","inputStages":["26"],"waitMsAvg":"6","id":"35","endMs":"1570903393863","waitMsMax":"7","startMs":"1570903393488","waitRatioMax":0.001250446588067167,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"11037","computeRatioAvg":0.0010718113612004287,"writeMsAvg":"109","status":"COMPLETE","writeMsMax":"187","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.033404787424080026,"readMsAvg":"0","waitRatioAvg":0.0010718113612004287,"completedParallelInputs":"100","computeRatioMax":0.00482315112540193,"name":"S23: Coalesce","shuffleOutputBytes":"331110","recordsWritten":"11037","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage1A_output"]}],"writeRatioAvg":0.019471239728474456},{"readMsMax":"0","computeMsMax":"12","inputStages":["25"],"waitMsAvg":"8","id":"36","endMs":"1570903393866","waitMsMax":"15","startMs":"1570903393486","waitRatioMax":0.0026795284030010718,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"11269","computeRatioAvg":0.001250446588067167,"writeMsAvg":"114","status":"COMPLETE","writeMsMax":"152","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.027152554483744193,"readMsAvg":"0","waitRatioAvg":0.0014290818149339049,"completedParallelInputs":"100","computeRatioMax":0.0021436227224008574,"name":"S24: Coalesce","shuffleOutputBytes":"338070","recordsWritten":"11269","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage19_output"]}],"writeRatioAvg":0.020364415862808145},{"readMsMax":"0","computeMsMax":"315","inputStages":["24","36","20","35","31","34","33"],"waitMsAvg":"1","id":"38","endMs":"1570903394724","waitMsMax":"1","startMs":"1570903394008","waitRatioMax":0.0001786352268667381,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"252016","computeRatioAvg":0.05627009646302251,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"315","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007145409074669524,"readMsAvg":"0","waitRatioAvg":0.0001786352268667381,"completedParallelInputs":"1","computeRatioMax":0.05627009646302251,"name":"S26: Join+","shuffleOutputBytes":"435","recordsWritten":"9","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$390, $391, $330","FROM __stage14_output"]},{"kind":"READ","substeps":["$250, $440","FROM __stage1F_output"]},{"kind":"READ","substeps":["$260, $490","FROM __stage21_output"]},{"kind":"READ","substeps":["$220, $540","FROM __stage22_output"]},{"kind":"READ","substeps":["$200, $590","FROM __stage23_output"]},{"kind":"READ","substeps":["$190, $640","FROM __stage24_output"]},{"kind":"READ","substeps":["$1, $2, $3, $4","FROM __stage18_output"]},{"kind":"SORT","substeps":["$660 ASC","LIMIT 100"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $650 = $1"]},{"kind":"FILTER","substeps":["greater(case_no_value(greater($653, 0), divide($652, $653), NULL), case_no_value(greater($651, 0), divide($654, $651), NULL))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $601 = $640"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $551 = $590"]},{"kind":"FILTER","substeps":["greater(case_no_value(greater($553, 0), divide($555, $553), NULL), case_no_value(greater($554, 0), divide($552, $554), NULL))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $501 = $540"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $450 = $490"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $400 = $440"]},{"kind":"FILTER","substeps":["greater($290, 0)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $400 := $390, $401 := $391","$290 := SUM($330)"]},{"kind":"WRITE","substeps":["$670, $671, $672, $673","TO __stage26_output"]}],"writeRatioAvg":0.0007145409074669524},{"readMsMax":"0","computeMsMax":"4","inputStages":["38"],"waitMsAvg":"1","id":"39","endMs":"1570903394760","waitMsMax":"1","startMs":"1570903394095","waitRatioMax":0.0001786352268667381,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"9","computeRatioAvg":0.0007145409074669524,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0010718113612004287,"readMsAvg":"0","waitRatioAvg":0.0001786352268667381,"completedParallelInputs":"1","computeRatioMax":0.0007145409074669524,"name":"S27: Output","shuffleOutputBytes":"435","recordsWritten":"9","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$670, $671, $672, $673","FROM __stage26_output"]},{"kind":"SORT","substeps":["$673 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$680, $681, $682, $683","TO __stage27_output"]}],"writeRatioAvg":0.0010718113612004287}],"estimatedBytesProcessed":"240918482","timeline":[{"totalSlotMs":"1257","activeUnits":"8","completedUnits":"4","elapsedMs":"767","pendingUnits":"10"},{"totalSlotMs":"8933","activeUnits":"6","completedUnits":"12","elapsedMs":"1858","pendingUnits":"6"},{"totalSlotMs":"20809","activeUnits":"2","completedUnits":"16","elapsedMs":"3265","pendingUnits":"2"},{"totalSlotMs":"27830","activeUnits":"1","completedUnits":"18","elapsedMs":"5609","pendingUnits":"2"},{"totalSlotMs":"143811","activeUnits":"20","completedUnits":"521","elapsedMs":"6711","pendingUnits":"4"},{"totalSlotMs":"145970","activeUnits":"2","completedUnits":"526","elapsedMs":"7928","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"241172480","totalPartitionsProcessed":"0","totalBytesProcessed":"240918482","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_1"}]},"endTime":"1570903395153"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query4_1570903385"},"etag":"cftO3FkEInkPUB73WuGlug==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query4_1570903385?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon7ebf5e749e0c9020d24354da0d5949e220a1559e","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query4\nWITH year_total \n AS (SELECT c_customer_id customer_id, \n d_year dyear, \n Sum(( ( ss_ext_list_price - ss_ext_wholesale_cost \n - ss_ext_discount_amt \n ) \n + \n ss_ext_sales_price ) / 2) year_total, \n 's' sale_type \n FROM customer, \n store_sales, \n date_dim \n WHERE c_customer_sk = ss_customer_sk \n AND ss_sold_date_sk = d_date_sk \n GROUP BY c_customer_id, \n d_year \n UNION ALL \n SELECT c_customer_id customer_id, \n d_year dyear, \n Sum(( ( ( cs_ext_list_price \n - cs_ext_wholesale_cost \n - cs_ext_discount_amt \n ) + \n cs_ext_sales_price ) / 2 )) year_total, \n 'c' sale_type \n FROM customer, \n catalog_sales, \n date_dim \n WHERE c_customer_sk = cs_bill_customer_sk \n AND cs_sold_date_sk = d_date_sk \n GROUP BY c_customer_id, \n d_year \n UNION ALL \n SELECT c_customer_id customer_id, \n d_year dyear, \n Sum(( ( ( ws_ext_list_price \n - ws_ext_wholesale_cost \n - ws_ext_discount_amt \n ) + \n ws_ext_sales_price ) / 2 )) year_total, \n 'w' sale_type \n FROM customer, \n web_sales, \n date_dim \n WHERE c_customer_sk = ws_bill_customer_sk \n AND ws_sold_date_sk = d_date_sk \n GROUP BY c_customer_id, \n d_year) \nSELECT t_s_secyear.customer_id, \n customer.c_first_name, \n customer.c_last_name, \n customer.c_preferred_cust_flag \nFROM year_total t_s_firstyear, \n year_total t_s_secyear, \n year_total t_c_firstyear, \n year_total t_c_secyear, \n year_total t_w_firstyear, \n year_total t_w_secyear,\n customer\nWHERE t_s_secyear.customer_id = t_s_firstyear.customer_id \n AND t_s_firstyear.customer_id = t_c_secyear.customer_id \n AND t_s_firstyear.customer_id = t_c_firstyear.customer_id \n AND t_s_firstyear.customer_id = t_w_firstyear.customer_id \n AND t_s_firstyear.customer_id = t_w_secyear.customer_id \n AND t_s_secyear.customer_id = customer.c_customer_id\n AND t_s_firstyear.sale_type = 's' \n AND t_c_firstyear.sale_type = 'c' \n AND t_w_firstyear.sale_type = 'w' \n AND t_s_secyear.sale_type = 's' \n AND t_c_secyear.sale_type = 'c' \n AND t_w_secyear.sale_type = 'w' \n AND t_s_firstyear.dyear = 2001 \n AND t_s_secyear.dyear = 2001 + 1 \n AND t_c_firstyear.dyear = 2001 \n AND t_c_secyear.dyear = 2001 + 1 \n AND t_w_firstyear.dyear = 2001 \n AND t_w_secyear.dyear = 2001 + 1 \n AND t_s_firstyear.year_total > 0 \n AND t_c_firstyear.year_total > 0 \n AND t_w_firstyear.year_total > 0 \n AND CASE \n WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / \n t_c_firstyear.year_total \n ELSE NULL \n END > CASE \n WHEN t_s_firstyear.year_total > 0 THEN \n t_s_secyear.year_total / \n t_s_firstyear.year_total \n ELSE NULL \n END \n AND CASE \n WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / \n t_c_firstyear.year_total \n ELSE NULL \n END > CASE \n WHEN t_w_firstyear.year_total > 0 THEN \n t_w_secyear.year_total / \n t_w_firstyear.year_total \n ELSE NULL \n END \nORDER BY t_s_secyear.customer_id\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query4_1570903385","user_email":"nithish.sankaranarayanan@ulb.be"}
