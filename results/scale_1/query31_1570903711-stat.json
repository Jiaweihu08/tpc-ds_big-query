{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"56990","creationTime":"1570903713545","totalBytesProcessed":"86266861","startTime":"1570903713747","query":{"totalSlotMs":"56990","queryPlan":[{"readMsMax":"8","computeMsMax":"38","waitMsAvg":"1","id":"0","endMs":"1570903713993","waitMsMax":"1","startMs":"1570903713900","waitRatioMax":0.0005494505494505495,"readRatioAvg":0.004395604395604396,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.020879120879120878,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"38","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005494505494505495,"readMsAvg":"8","waitRatioAvg":0.0005494505494505495,"completedParallelInputs":"1","computeRatioMax":0.020879120879120878,"name":"S00: Input","shuffleOutputBytes":"1371149","recordsWritten":"50000","readRatioMax":0.004395604395604396,"steps":[{"kind":"READ","substeps":["$100:ca_address_sk, $101:ca_county","FROM customer_address"]},{"kind":"WRITE","substeps":["$100, $101","TO __stage00_output","BY HASH($100)"]}],"writeRatioAvg":0.005494505494505495},{"readMsMax":"9","computeMsMax":"10","waitMsAvg":"16","id":"1","endMs":"1570903714027","waitMsMax":"16","startMs":"1570903713943","waitRatioMax":0.008791208791208791,"readRatioAvg":0.004945054945054945,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.005494505494505495,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011538461538461539,"readMsAvg":"9","waitRatioAvg":0.008791208791208791,"completedParallelInputs":"1","computeRatioMax":0.005494505494505495,"name":"S01: Input","shuffleOutputBytes":"2457","recordsWritten":"91","readRatioMax":0.004945054945054945,"steps":[{"kind":"READ","substeps":["$170:d_date_sk, $171:d_year, $172:d_qoy","FROM date_dim","WHERE and(equal($172, 2), equal($171, 2001))"]},{"kind":"WRITE","substeps":["$170, $171, $172","TO __stage01_output","BY HASH($170)"]}],"writeRatioAvg":0.011538461538461539},{"readMsMax":"8","computeMsMax":"35","waitMsAvg":"29","id":"3","endMs":"1570903714195","waitMsMax":"29","startMs":"1570903713993","waitRatioMax":0.015934065934065933,"readRatioAvg":0.004395604395604396,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.019230769230769232,"writeMsAvg":"167","status":"COMPLETE","writeMsMax":"167","computeMsAvg":"35","shuffleOutputBytesSpilled":"0","writeRatioMax":0.09175824175824175,"readMsAvg":"8","waitRatioAvg":0.015934065934065933,"completedParallelInputs":"1","computeRatioMax":0.019230769230769232,"name":"S03: Input","shuffleOutputBytes":"1371149","recordsWritten":"50000","readRatioMax":0.004395604395604396,"steps":[{"kind":"READ","substeps":["$90:ca_address_sk, $91:ca_county","FROM customer_address"]},{"kind":"WRITE","substeps":["$90, $91","TO __stage03_output","BY HASH($90)"]}],"writeRatioAvg":0.09175824175824175},{"readMsMax":"9","computeMsMax":"9","waitMsAvg":"46","id":"4","endMs":"1570903714157","waitMsMax":"46","startMs":"1570903714028","waitRatioMax":0.025274725274725275,"readRatioAvg":0.004945054945054945,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004945054945054945,"writeMsAvg":"55","status":"COMPLETE","writeMsMax":"55","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03021978021978022,"readMsAvg":"9","waitRatioAvg":0.025274725274725275,"completedParallelInputs":"1","computeRatioMax":0.004945054945054945,"name":"S04: Input","shuffleOutputBytes":"2457","recordsWritten":"91","readRatioMax":0.004945054945054945,"steps":[{"kind":"READ","substeps":["$160:d_date_sk, $161:d_year, $162:d_qoy","FROM date_dim","WHERE and(equal($162, 1), equal($161, 2001))"]},{"kind":"WRITE","substeps":["$160, $161, $162","TO __stage04_output","BY HASH($160)"]}],"writeRatioAvg":0.03021978021978022},{"readMsMax":"44","computeMsMax":"49","waitMsAvg":"3","id":"6","endMs":"1570903714216","waitMsMax":"3","startMs":"1570903714082","waitRatioMax":0.0016483516483516484,"readRatioAvg":0.024175824175824177,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.026923076923076925,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"49","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01098901098901099,"readMsAvg":"44","waitRatioAvg":0.0016483516483516484,"completedParallelInputs":"1","computeRatioMax":0.026923076923076925,"name":"S06: Input","shuffleOutputBytes":"1371149","recordsWritten":"50000","readRatioMax":0.024175824175824177,"steps":[{"kind":"READ","substeps":["$60:ca_address_sk, $61:ca_county","FROM customer_address"]},{"kind":"WRITE","substeps":["$60, $61","TO __stage06_output","BY HASH($60)"]}],"writeRatioAvg":0.01098901098901099},{"readMsMax":"13","computeMsMax":"8","waitMsAvg":"2","id":"7","endMs":"1570903714169","waitMsMax":"2","startMs":"1570903714099","waitRatioMax":0.001098901098901099,"readRatioAvg":0.007142857142857143,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004395604395604396,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0032967032967032967,"readMsAvg":"13","waitRatioAvg":0.001098901098901099,"completedParallelInputs":"1","computeRatioMax":0.004395604395604396,"name":"S07: Input","shuffleOutputBytes":"2484","recordsWritten":"92","readRatioMax":0.007142857142857143,"steps":[{"kind":"READ","substeps":["$150:d_date_sk, $151:d_year, $152:d_qoy","FROM date_dim","WHERE and(equal($152, 3), equal($151, 2001))"]},{"kind":"WRITE","substeps":["$150, $151, $152","TO __stage07_output","BY HASH($150)"]}],"writeRatioAvg":0.0032967032967032967},{"readMsMax":"12","computeMsMax":"47","waitMsAvg":"1","id":"9","endMs":"1570903714203","waitMsMax":"1","startMs":"1570903714129","waitRatioMax":0.0005494505494505495,"readRatioAvg":0.006593406593406593,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.025824175824175823,"writeMsAvg":"15","status":"COMPLETE","writeMsMax":"15","computeMsAvg":"47","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008241758241758242,"readMsAvg":"12","waitRatioAvg":0.0005494505494505495,"completedParallelInputs":"1","computeRatioMax":0.025824175824175823,"name":"S09: Input","shuffleOutputBytes":"1371149","recordsWritten":"50000","readRatioMax":0.006593406593406593,"steps":[{"kind":"READ","substeps":["$40:ca_address_sk, $41:ca_county","FROM customer_address"]},{"kind":"WRITE","substeps":["$40, $41","TO __stage09_output","BY HASH($40)"]}],"writeRatioAvg":0.008241758241758242},{"readMsMax":"17","computeMsMax":"11","waitMsAvg":"1","id":"10","endMs":"1570903714251","waitMsMax":"1","startMs":"1570903714151","waitRatioMax":0.0005494505494505495,"readRatioAvg":0.00934065934065934,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.006043956043956044,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00934065934065934,"readMsAvg":"17","waitRatioAvg":0.0005494505494505495,"completedParallelInputs":"1","computeRatioMax":0.006043956043956044,"name":"S0A: Input","shuffleOutputBytes":"2457","recordsWritten":"91","readRatioMax":0.00934065934065934,"steps":[{"kind":"READ","substeps":["$120:d_date_sk, $121:d_year, $122:d_qoy","FROM date_dim","WHERE and(equal($122, 1), equal($121, 2001))"]},{"kind":"WRITE","substeps":["$120, $121, $122","TO __stage0A_output","BY HASH($120)"]}],"writeRatioAvg":0.00934065934065934},{"readMsMax":"12","computeMsMax":"52","waitMsAvg":"1","id":"12","endMs":"1570903714266","waitMsMax":"1","startMs":"1570903714194","waitRatioMax":0.0005494505494505495,"readRatioAvg":0.006593406593406593,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.02857142857142857,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"52","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006043956043956044,"readMsAvg":"12","waitRatioAvg":0.0005494505494505495,"completedParallelInputs":"1","computeRatioMax":0.02857142857142857,"name":"S0C: Input","shuffleOutputBytes":"1371149","recordsWritten":"50000","readRatioMax":0.006593406593406593,"steps":[{"kind":"READ","substeps":["$20:ca_address_sk, $21:ca_county","FROM customer_address"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage0C_output","BY HASH($20)"]}],"writeRatioAvg":0.006043956043956044},{"readMsMax":"11","computeMsMax":"6","waitMsAvg":"1","id":"13","endMs":"1570903714306","waitMsMax":"1","startMs":"1570903714214","waitRatioMax":0.0005494505494505495,"readRatioAvg":0.006043956043956044,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0032967032967032967,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010439560439560439,"readMsAvg":"11","waitRatioAvg":0.0005494505494505495,"completedParallelInputs":"1","computeRatioMax":0.0032967032967032967,"name":"S0D: Input","shuffleOutputBytes":"2457","recordsWritten":"91","readRatioMax":0.006043956043956044,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_year, $82:d_qoy","FROM date_dim","WHERE and(equal($82, 2), equal($81, 2001))"]},{"kind":"WRITE","substeps":["$80, $81, $82","TO __stage0D_output","BY HASH($80)"]}],"writeRatioAvg":0.010439560439560439},{"readMsMax":"9","computeMsMax":"48","waitMsAvg":"2","id":"15","endMs":"1570903714483","waitMsMax":"2","startMs":"1570903714249","waitRatioMax":0.001098901098901099,"readRatioAvg":0.004945054945054945,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.026373626373626374,"writeMsAvg":"14","status":"COMPLETE","writeMsMax":"14","computeMsAvg":"48","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007692307692307693,"readMsAvg":"9","waitRatioAvg":0.001098901098901099,"completedParallelInputs":"1","computeRatioMax":0.026373626373626374,"name":"S0F: Input","shuffleOutputBytes":"1371149","recordsWritten":"50000","readRatioMax":0.004945054945054945,"steps":[{"kind":"READ","substeps":["$1:ca_address_sk, $2:ca_county","FROM customer_address"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage0F_output","BY HASH($1)"]}],"writeRatioAvg":0.007692307692307693},{"readMsMax":"8","computeMsMax":"10","waitMsAvg":"2","id":"16","endMs":"1570903714402","waitMsMax":"2","startMs":"1570903714264","waitRatioMax":0.001098901098901099,"readRatioAvg":0.004395604395604396,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.005494505494505495,"writeMsAvg":"107","status":"COMPLETE","writeMsMax":"107","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05879120879120879,"readMsAvg":"8","waitRatioAvg":0.001098901098901099,"completedParallelInputs":"1","computeRatioMax":0.005494505494505495,"name":"S10: Input","shuffleOutputBytes":"2484","recordsWritten":"92","readRatioMax":0.004395604395604396,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_year, $32:d_qoy","FROM date_dim","WHERE and(equal($32, 3), equal($31, 2001))"]},{"kind":"WRITE","substeps":["$30, $31, $32","TO __stage10_output","BY HASH($30)"]}],"writeRatioAvg":0.05879120879120879},{"readMsMax":"30","computeMsMax":"859","inputStages":["0","1"],"waitMsAvg":"1","id":"18","endMs":"1570903714908","waitMsMax":"1","startMs":"1570903714371","waitRatioMax":0.0005494505494505495,"readRatioAvg":0.016483516483516484,"parallelInputs":"1","recordsRead":"2931269","computeRatioAvg":0.47197802197802197,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"3","computeMsAvg":"859","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0016483516483516484,"readMsAvg":"30","waitRatioAvg":0.0005494505494505495,"completedParallelInputs":"1","computeRatioMax":0.47197802197802197,"name":"S12: Join+","shuffleOutputBytes":"75254","recordsWritten":"1629","readRatioMax":0.016483516483516484,"steps":[{"kind":"READ","substeps":["$140:ss_sold_date_sk, $141:ss_addr_sk, $142:ss_ext_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$170, $171, $172","FROM __stage01_output"]},{"kind":"READ","substeps":["$100, $101","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $380 := $373, $381 := $372, $382 := $371","$300 := SUM($370)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $360 = $100"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $140 = $170"]},{"kind":"WRITE","substeps":["$380, $382, $381, $300","TO __stage12_output","BY HASH($380, $381, $382)"]}],"writeRatioAvg":0.0016483516483516484},{"readMsMax":"31","computeMsMax":"1343","inputStages":["3","4"],"waitMsAvg":"1","id":"21","endMs":"1570903715169","waitMsMax":"1","startMs":"1570903714438","waitRatioMax":0.0005494505494505495,"readRatioAvg":0.01703296703296703,"parallelInputs":"1","recordsRead":"2931269","computeRatioAvg":0.737912087912088,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"3","computeMsAvg":"1343","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0016483516483516484,"readMsAvg":"31","waitRatioAvg":0.0005494505494505495,"completedParallelInputs":"1","computeRatioMax":0.737912087912088,"name":"S15: Join+","shuffleOutputBytes":"77133","recordsWritten":"1670","readRatioMax":0.01703296703296703,"steps":[{"kind":"READ","substeps":["$130:ss_sold_date_sk, $131:ss_addr_sk, $132:ss_ext_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$160, $161, $162","FROM __stage04_output"]},{"kind":"READ","substeps":["$90, $91","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $330 := $323, $331 := $322, $332 := $321","$290 := SUM($320)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $310 = $90"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $130 = $160"]},{"kind":"WRITE","substeps":["$330, $332, $331, $290","TO __stage15_output","BY HASH($330, $331, $332)"]}],"writeRatioAvg":0.0016483516483516484},{"readMsMax":"56","computeMsMax":"1820","inputStages":["6","7"],"waitMsAvg":"1","id":"22","endMs":"1570903715736","waitMsMax":"1","startMs":"1570903714455","waitRatioMax":0.0005494505494505495,"readRatioAvg":0.03076923076923077,"parallelInputs":"1","recordsRead":"2931270","computeRatioAvg":1,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"1820","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006043956043956044,"readMsAvg":"56","waitRatioAvg":0.0005494505494505495,"completedParallelInputs":"1","computeRatioMax":1,"name":"S16: Join+","shuffleOutputBytes":"82735","recordsWritten":"1790","readRatioMax":0.03076923076923077,"steps":[{"kind":"READ","substeps":["$110:ss_sold_date_sk, $111:ss_addr_sk, $112:ss_ext_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$150, $151, $152","FROM __stage07_output"]},{"kind":"READ","substeps":["$60, $61","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $440 := $433, $441 := $432, $442 := $431","$280 := SUM($430)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $420 = $60"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $110 = $150"]},{"kind":"WRITE","substeps":["$440, $442, $441, $280","TO __stage16_output","BY HASH($440, $441, $442)"]}],"writeRatioAvg":0.006043956043956044},{"readMsMax":"26","computeMsMax":"159","inputStages":["9","10"],"waitMsAvg":"1","id":"23","endMs":"1570903714611","waitMsMax":"1","startMs":"1570903714474","waitRatioMax":0.0005494505494505495,"readRatioAvg":0.014285714285714285,"parallelInputs":"1","recordsRead":"770850","computeRatioAvg":0.08736263736263736,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"159","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0027472527472527475,"readMsAvg":"26","waitRatioAvg":0.0005494505494505495,"completedParallelInputs":"1","computeRatioMax":0.08736263736263736,"name":"S17: Join+","shuffleOutputBytes":"40488","recordsWritten":"880","readRatioMax":0.014285714285714285,"steps":[{"kind":"READ","substeps":["$70:ws_sold_date_sk, $71:ws_bill_addr_sk, $72:ws_ext_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$120, $121, $122","FROM __stage0A_output"]},{"kind":"READ","substeps":["$40, $41","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $500 := $493, $501 := $492, $502 := $491","$270 := SUM($490)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $480 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $70 = $120"]},{"kind":"WRITE","substeps":["$500, $502, $501, $270","TO __stage17_output","BY HASH($500, $501, $502)"]}],"writeRatioAvg":0.0027472527472527475},{"readMsMax":"35","computeMsMax":"179","inputStages":["12","13"],"waitMsAvg":"1","id":"24","endMs":"1570903715128","waitMsMax":"1","startMs":"1570903714497","waitRatioMax":0.0005494505494505495,"readRatioAvg":0.019230769230769232,"parallelInputs":"1","recordsRead":"770850","computeRatioAvg":0.09835164835164835,"writeMsAvg":"474","status":"COMPLETE","writeMsMax":"474","computeMsAvg":"179","shuffleOutputBytesSpilled":"0","writeRatioMax":0.26043956043956046,"readMsAvg":"35","waitRatioAvg":0.0005494505494505495,"completedParallelInputs":"1","computeRatioMax":0.09835164835164835,"name":"S18: Join+","shuffleOutputBytes":"39068","recordsWritten":"848","readRatioMax":0.019230769230769232,"steps":[{"kind":"READ","substeps":["$50:ws_sold_date_sk, $51:ws_bill_addr_sk, $52:ws_ext_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$80, $81, $82","FROM __stage0D_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $560 := $553, $561 := $552, $562 := $551","$240 := SUM($550)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $540 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $50 = $80"]},{"kind":"WRITE","substeps":["$560, $562, $561, $240","TO __stage18_output","BY HASH($560, $561, $562)"]}],"writeRatioAvg":0.26043956043956046},{"readMsMax":"22","computeMsMax":"209","inputStages":["15","16"],"waitMsAvg":"4","id":"26","endMs":"1570903714771","waitMsMax":"4","startMs":"1570903714587","waitRatioMax":0.002197802197802198,"readRatioAvg":0.012087912087912088,"parallelInputs":"1","recordsRead":"770851","computeRatioAvg":0.11483516483516483,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"209","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00989010989010989,"readMsAvg":"22","waitRatioAvg":0.002197802197802198,"completedParallelInputs":"1","computeRatioMax":0.11483516483516483,"name":"S1A: Join+","shuffleOutputBytes":"58204","recordsWritten":"1262","readRatioMax":0.012087912087912088,"steps":[{"kind":"READ","substeps":["$10:ws_sold_date_sk, $11:ws_bill_addr_sk, $12:ws_ext_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$30, $31, $32","FROM __stage10_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage0F_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $620 := $613, $621 := $612, $622 := $611","$210 := SUM($610)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $600 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $10 = $30"]},{"kind":"WRITE","substeps":["$620, $622, $621, $210","TO __stage1A_output","BY HASH($620, $621, $622)"]}],"writeRatioAvg":0.00989010989010989},{"readMsMax":"0","computeMsMax":"9","inputStages":["26"],"waitMsAvg":"1","id":"27","endMs":"1570903715950","waitMsMax":"1","startMs":"1570903715900","waitRatioMax":0.0005494505494505495,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1262","computeRatioAvg":0.004945054945054945,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"26","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.014285714285714285,"readMsAvg":"0","waitRatioAvg":0.0005494505494505495,"completedParallelInputs":"1","computeRatioMax":0.004945054945054945,"name":"S1B: Aggregate","shuffleOutputBytes":"35478","recordsWritten":"1261","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$620, $622, $621, $210","FROM __stage1A_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $630 := $620, $631 := $621, $632 := $622","$190 := SUM($210)"]},{"kind":"WRITE","substeps":["$190, $630","TO __stage1B_output","BY HASH($630)"]}],"writeRatioAvg":0.014285714285714285},{"readMsMax":"0","computeMsMax":"9","inputStages":["24"],"waitMsAvg":"1","id":"28","endMs":"1570903716009","waitMsMax":"1","startMs":"1570903715917","waitRatioMax":0.0005494505494505495,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"848","computeRatioAvg":0.004945054945054945,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012637362637362638,"readMsAvg":"0","waitRatioAvg":0.0005494505494505495,"completedParallelInputs":"1","computeRatioMax":0.004945054945054945,"name":"S1C: Aggregate","shuffleOutputBytes":"23794","recordsWritten":"847","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$560, $562, $561, $240","FROM __stage18_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $570 := $560, $571 := $561, $572 := $562","$200 := SUM($240)"]},{"kind":"WRITE","substeps":["$200, $570","TO __stage1C_output","BY HASH($570)"]}],"writeRatioAvg":0.012637362637362638},{"readMsMax":"0","computeMsMax":"10","inputStages":["23"],"waitMsAvg":"1","id":"29","endMs":"1570903715984","waitMsMax":"1","startMs":"1570903715935","waitRatioMax":0.0005494505494505495,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"880","computeRatioAvg":0.005494505494505495,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005494505494505495,"readMsAvg":"0","waitRatioAvg":0.0005494505494505495,"completedParallelInputs":"1","computeRatioMax":0.005494505494505495,"name":"S1D: Aggregate","shuffleOutputBytes":"24638","recordsWritten":"879","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$500, $502, $501, $270","FROM __stage17_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $510 := $500, $511 := $501, $512 := $502","$220 := SUM($270)"]},{"kind":"WRITE","substeps":["$220, $510","TO __stage1D_output","BY HASH($510)"]}],"writeRatioAvg":0.005494505494505495},{"readMsMax":"0","computeMsMax":"9","inputStages":["22"],"waitMsAvg":"1","id":"30","endMs":"1570903716017","waitMsMax":"1","startMs":"1570903715950","waitRatioMax":0.0005494505494505495,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1790","computeRatioAvg":0.004945054945054945,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"12","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006593406593406593,"readMsAvg":"0","waitRatioAvg":0.0005494505494505495,"completedParallelInputs":"1","computeRatioMax":0.004945054945054945,"name":"S1E: Aggregate","shuffleOutputBytes":"50505","recordsWritten":"1789","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$440, $442, $441, $280","FROM __stage16_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $450 := $440, $451 := $441, $452 := $442","$230 := SUM($280)"]},{"kind":"WRITE","substeps":["$230, $450","TO __stage1E_output","BY HASH($450)"]}],"writeRatioAvg":0.006593406593406593},{"readMsMax":"0","computeMsMax":"9","inputStages":["18"],"waitMsAvg":"1","id":"31","endMs":"1570903716020","waitMsMax":"1","startMs":"1570903715965","waitRatioMax":0.0005494505494505495,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1629","computeRatioAvg":0.004945054945054945,"writeMsAvg":"41","status":"COMPLETE","writeMsMax":"41","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.022527472527472527,"readMsAvg":"0","waitRatioAvg":0.0005494505494505495,"completedParallelInputs":"1","computeRatioMax":0.004945054945054945,"name":"S1F: Aggregate","shuffleOutputBytes":"45922","recordsWritten":"1628","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$380, $382, $381, $300","FROM __stage12_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $390 := $380, $391 := $381, $392 := $382","$260 := SUM($300)"]},{"kind":"WRITE","substeps":["$260, $390","TO __stage1F_output","BY HASH($390)"]}],"writeRatioAvg":0.022527472527472527},{"readMsMax":"0","computeMsMax":"10","inputStages":["31"],"waitMsAvg":"2","id":"33","endMs":"1570903716292","waitMsMax":"6","startMs":"1570903716033","waitRatioMax":0.0032967032967032967,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1628","computeRatioAvg":0.0027472527472527475,"writeMsAvg":"43","status":"COMPLETE","writeMsMax":"67","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.036813186813186814,"readMsAvg":"0","waitRatioAvg":0.001098901098901099,"completedParallelInputs":"100","computeRatioMax":0.005494505494505495,"name":"S21: Coalesce","shuffleOutputBytes":"45922","recordsWritten":"1628","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage1F_output"]}],"writeRatioAvg":0.023626373626373626},{"readMsMax":"0","computeMsMax":"9","inputStages":["30"],"waitMsAvg":"6","id":"34","endMs":"1570903716174","waitMsMax":"7","startMs":"1570903716033","waitRatioMax":0.0038461538461538464,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1789","computeRatioAvg":0.0027472527472527475,"writeMsAvg":"33","status":"COMPLETE","writeMsMax":"55","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03021978021978022,"readMsAvg":"0","waitRatioAvg":0.0032967032967032967,"completedParallelInputs":"100","computeRatioMax":0.004945054945054945,"name":"S22: Coalesce","shuffleOutputBytes":"50505","recordsWritten":"1789","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage1E_output"]}],"writeRatioAvg":0.018131868131868133},{"readMsMax":"0","computeMsMax":"9","inputStages":["29"],"waitMsAvg":"6","id":"35","endMs":"1570903716183","waitMsMax":"8","startMs":"1570903716033","waitRatioMax":0.004395604395604396,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"879","computeRatioAvg":0.0027472527472527475,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"57","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03131868131868132,"readMsAvg":"0","waitRatioAvg":0.0032967032967032967,"completedParallelInputs":"100","computeRatioMax":0.004945054945054945,"name":"S23: Coalesce","shuffleOutputBytes":"24638","recordsWritten":"879","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage1D_output"]}],"writeRatioAvg":0.015934065934065933},{"readMsMax":"0","computeMsMax":"10","inputStages":["28"],"waitMsAvg":"8","id":"36","endMs":"1570903716192","waitMsMax":"9","startMs":"1570903716037","waitRatioMax":0.004945054945054945,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"847","computeRatioAvg":0.0027472527472527475,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"51","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.028021978021978023,"readMsAvg":"0","waitRatioAvg":0.004395604395604396,"completedParallelInputs":"100","computeRatioMax":0.005494505494505495,"name":"S24: Coalesce","shuffleOutputBytes":"23794","recordsWritten":"847","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage1C_output"]}],"writeRatioAvg":0.013186813186813187},{"readMsMax":"0","computeMsMax":"8","inputStages":["27"],"waitMsAvg":"9","id":"37","endMs":"1570903716283","waitMsMax":"12","startMs":"1570903716035","waitRatioMax":0.006593406593406593,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1261","computeRatioAvg":0.0027472527472527475,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"53","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02912087912087912,"readMsAvg":"0","waitRatioAvg":0.004945054945054945,"completedParallelInputs":"100","computeRatioMax":0.004395604395604396,"name":"S25: Coalesce","shuffleOutputBytes":"35478","recordsWritten":"1261","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage1B_output"]}],"writeRatioAvg":0.012637362637362638},{"readMsMax":"0","computeMsMax":"28","inputStages":["21","37","36","33","35","34"],"waitMsAvg":"1","id":"38","endMs":"1570903716295","waitMsMax":"1","startMs":"1570903716074","waitRatioMax":0.0005494505494505495,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"8074","computeRatioAvg":0.015384615384615385,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"28","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004395604395604396,"readMsAvg":"0","waitRatioAvg":0.0005494505494505495,"completedParallelInputs":"1","computeRatioMax":0.015384615384615385,"name":"S26: Join+","shuffleOutputBytes":"2241","recordsWritten":"35","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$330, $332, $331, $290","FROM __stage15_output"]},{"kind":"READ","substeps":["$260, $390","FROM __stage21_output"]},{"kind":"READ","substeps":["$230, $450","FROM __stage22_output"]},{"kind":"READ","substeps":["$220, $510","FROM __stage23_output"]},{"kind":"READ","substeps":["$200, $570","FROM __stage24_output"]},{"kind":"READ","substeps":["$190, $630","FROM __stage25_output"]},{"kind":"COMPUTE","substeps":["$180 := divide($642, $643)","$181 := divide($646, $645)","$182 := divide($647, $642)","$183 := divide($644, $646)"]},{"kind":"FILTER","substeps":["greater(case_no_value(greater($642, 0), divide($647, $642), NULL), case_no_value(greater($646, 0), divide($644, $646), NULL))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $580 = $630"]},{"kind":"FILTER","substeps":["greater(case_no_value(greater($583, 0), divide($587, $583), NULL), case_no_value(greater($585, 0), divide($586, $585), NULL))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $525 = $570"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $460 = $510"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $403 = $450"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $340 = $390"]},{"kind":"AGGREGATE","substeps":["GROUP BY $340 := $330, $341 := $331, $342 := $332","$250 := SUM($290)"]},{"kind":"WRITE","substeps":["$640, $641, $180, $181, $182, $183","TO __stage26_output"]}],"writeRatioAvg":0.004395604395604396},{"readMsMax":"0","computeMsMax":"3","inputStages":["38"],"waitMsAvg":"1","id":"39","endMs":"1570903716500","waitMsMax":"1","startMs":"1570903716332","waitRatioMax":0.0005494505494505495,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"35","computeRatioAvg":0.0016483516483516484,"writeMsAvg":"153","status":"COMPLETE","writeMsMax":"153","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08406593406593407,"readMsAvg":"0","waitRatioAvg":0.0005494505494505495,"completedParallelInputs":"1","computeRatioMax":0.0016483516483516484,"name":"S27: Output","shuffleOutputBytes":"2241","recordsWritten":"35","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$640, $641, $180, $181, $182, $183","FROM __stage26_output"]},{"kind":"SORT","substeps":["$641 ASC"]},{"kind":"WRITE","substeps":["$650, $651, $652, $653, $654, $655","TO __stage27_output"]}],"writeRatioAvg":0.08406593406593407}],"estimatedBytesProcessed":"86266861","timeline":[{"totalSlotMs":"1713","activeUnits":"7","completedUnits":"10","elapsedMs":"657","pendingUnits":"8"},{"totalSlotMs":"8228","activeUnits":"4","completedUnits":"17","elapsedMs":"1666","pendingUnits":"1"},{"totalSlotMs":"56990","activeUnits":"5","completedUnits":"525","elapsedMs":"3064","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"87031808","totalPartitionsProcessed":"0","totalBytesProcessed":"86266861","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_1"}]},"endTime":"1570903716848"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query31_1570903711"},"etag":"Ube8zL+we+HR32JfN1y6TA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query31_1570903711?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonbbb88c59c4562e8f6670e6f117ab2fc539272f7f","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query31\nWITH ss \n AS (SELECT ca_county, \n d_qoy, \n d_year, \n Sum(ss_ext_sales_price) AS store_sales \n FROM store_sales, \n date_dim, \n customer_address \n WHERE ss_sold_date_sk = d_date_sk \n AND ss_addr_sk = ca_address_sk \n GROUP BY ca_county, \n d_qoy, \n d_year), \n ws \n AS (SELECT ca_county, \n d_qoy, \n d_year, \n Sum(ws_ext_sales_price) AS web_sales \n FROM web_sales, \n date_dim, \n customer_address \n WHERE ws_sold_date_sk = d_date_sk \n AND ws_bill_addr_sk = ca_address_sk \n GROUP BY ca_county, \n d_qoy, \n d_year) \nSELECT ss1.ca_county, \n ss1.d_year, \n ws2.web_sales / ws1.web_sales web_q1_q2_increase, \n ss2.store_sales / ss1.store_sales store_q1_q2_increase, \n ws3.web_sales / ws2.web_sales web_q2_q3_increase, \n ss3.store_sales / ss2.store_sales store_q2_q3_increase \nFROM ss ss1, \n ss ss2, \n ss ss3, \n ws ws1, \n ws ws2, \n ws ws3 \nWHERE ss1.d_qoy = 1 \n AND ss1.d_year = 2001 \n AND ss1.ca_county = ss2.ca_county \n AND ss2.d_qoy = 2 \n AND ss2.d_year = 2001 \n AND ss2.ca_county = ss3.ca_county \n AND ss3.d_qoy = 3 \n AND ss3.d_year = 2001 \n AND ss1.ca_county = ws1.ca_county \n AND ws1.d_qoy = 1 \n AND ws1.d_year = 2001 \n AND ws1.ca_county = ws2.ca_county \n AND ws2.d_qoy = 2 \n AND ws2.d_year = 2001 \n AND ws1.ca_county = ws3.ca_county \n AND ws3.d_qoy = 3 \n AND ws3.d_year = 2001 \n AND CASE \n WHEN ws1.web_sales > 0 THEN ws2.web_sales / ws1.web_sales \n ELSE NULL \n END > CASE \n WHEN ss1.store_sales > 0 THEN \n ss2.store_sales / ss1.store_sales \n ELSE NULL \n END \n AND CASE \n WHEN ws2.web_sales > 0 THEN ws3.web_sales / ws2.web_sales \n ELSE NULL \n END > CASE \n WHEN ss2.store_sales > 0 THEN \n ss3.store_sales / ss2.store_sales \n ELSE NULL \n END \nORDER BY ss1.d_year; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query31_1570903711","user_email":"nithish.sankaranarayanan@ulb.be"}
