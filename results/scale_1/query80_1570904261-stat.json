{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"11284","creationTime":"1570904262589","totalBytesProcessed":"294716533","startTime":"1570904262735","query":{"totalSlotMs":"11284","queryPlan":[{"readMsMax":"21","computeMsMax":"9","waitMsAvg":"6","id":"0","endMs":"1570904263172","waitMsMax":"6","startMs":"1570904262948","waitRatioMax":0.0015436068947774634,"readRatioAvg":0.005402624131721122,"parallelInputs":"1","recordsRead":"300","computeRatioAvg":0.002315410342166195,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005145356315924878,"readMsAvg":"21","waitRatioAvg":0.0015436068947774634,"completedParallelInputs":"1","computeRatioMax":0.002315410342166195,"name":"S00: Input","shuffleOutputBytes":"2691","recordsWritten":"299","readRatioMax":0.005402624131721122,"steps":[{"kind":"READ","substeps":["$20:p_promo_sk, $21:p_channel_tv","FROM promotion","WHERE equal($21, 'N')"]},{"kind":"WRITE","substeps":["$20","TO __stage00_output","BY HASH($20)"]}],"writeRatioAvg":0.005145356315924878},{"readMsMax":"9","computeMsMax":"10","waitMsAvg":"2","id":"1","endMs":"1570904263189","waitMsMax":"2","startMs":"1570904262981","waitRatioMax":0.0005145356315924878,"readRatioAvg":0.002315410342166195,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.002572678157962439,"writeMsAvg":"186","status":"COMPLETE","writeMsMax":"186","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.047851813738101365,"readMsAvg":"9","waitRatioAvg":0.0005145356315924878,"completedParallelInputs":"1","computeRatioMax":0.002572678157962439,"name":"S01: Input","shuffleOutputBytes":"9171","recordsWritten":"1019","readRatioMax":0.002315410342166195,"steps":[{"kind":"READ","substeps":["$80:i_item_sk, $81:i_current_price","FROM item","WHERE greater($81, 50)"]},{"kind":"WRITE","substeps":["$80","TO __stage01_output","BY HASH($80)"]}],"writeRatioAvg":0.047851813738101365},{"readMsMax":"19","computeMsMax":"5","waitMsAvg":"2","id":"2","endMs":"1570904263151","waitMsMax":"2","startMs":"1570904263066","waitRatioMax":0.0005145356315924878,"readRatioAvg":0.004888088500128634,"parallelInputs":"1","recordsRead":"30","computeRatioAvg":0.0012863390789812194,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0015436068947774634,"readMsAvg":"19","waitRatioAvg":0.0005145356315924878,"completedParallelInputs":"1","computeRatioMax":0.0012863390789812194,"name":"S02: Input","shuffleOutputBytes":"900","recordsWritten":"30","readRatioMax":0.004888088500128634,"steps":[{"kind":"READ","substeps":["$70:web_site_sk, $71:web_site_id","FROM web_site"]},{"kind":"WRITE","substeps":["$70, $71","TO __stage02_output","BY HASH($70)"]}],"writeRatioAvg":0.0015436068947774634},{"readMsMax":"13","computeMsMax":"20","waitMsAvg":"25","id":"3","endMs":"1570904263162","waitMsMax":"25","startMs":"1570904263105","waitRatioMax":0.006431695394906097,"readRatioAvg":0.0033444816053511705,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.005145356315924878,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"12","computeMsAvg":"20","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0030872137895549268,"readMsAvg":"13","waitRatioAvg":0.006431695394906097,"completedParallelInputs":"1","computeRatioMax":0.005145356315924878,"name":"S03: Input","shuffleOutputBytes":"3564","recordsWritten":"396","readRatioMax":0.0033444816053511705,"steps":[{"kind":"READ","substeps":["$170:d_date_sk, $171:d_date","FROM date_dim","WHERE between(CAST($171 AS DATE), 11195, 11590)"]},{"kind":"WRITE","substeps":["$170","TO __stage03_output","BY HASH($170)"]}],"writeRatioAvg":0.0030872137895549268},{"readMsMax":"37","computeMsMax":"100","waitMsAvg":"55","id":"4","endMs":"1570904263312","waitMsMax":"55","startMs":"1570904263152","waitRatioMax":0.014149729868793414,"readRatioAvg":0.009518909184461024,"parallelInputs":"1","recordsRead":"72121","computeRatioAvg":0.025726781579624387,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"100","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005917159763313609,"readMsAvg":"37","waitRatioAvg":0.014149729868793414,"completedParallelInputs":"1","computeRatioMax":0.025726781579624387,"name":"S04: Input","shuffleOutputBytes":"2545260","recordsWritten":"72121","readRatioMax":0.009518909184461024,"steps":[{"kind":"READ","substeps":["$160:wr_item_sk, $161:wr_order_number, $162:wr_return_amt, $163:wr_net_loss","FROM web_returns"]},{"kind":"WRITE","substeps":["$160, $161, $162, $163","TO __stage04_output","BY HASH($160, $161)"]}],"writeRatioAvg":0.005917159763313609},{"readMsMax":"12","computeMsMax":"11","waitMsAvg":"41","id":"5","endMs":"1570904263291","waitMsMax":"41","startMs":"1570904263157","waitRatioMax":0.010547980447646,"readRatioAvg":0.0030872137895549268,"parallelInputs":"1","recordsRead":"300","computeRatioAvg":0.002829945973758683,"writeMsAvg":"111","status":"COMPLETE","writeMsMax":"111","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.028556727553383073,"readMsAvg":"12","waitRatioAvg":0.010547980447646,"completedParallelInputs":"1","computeRatioMax":0.002829945973758683,"name":"S05: Input","shuffleOutputBytes":"2691","recordsWritten":"299","readRatioMax":0.0030872137895549268,"steps":[{"kind":"READ","substeps":["$10:p_promo_sk, $11:p_channel_tv","FROM promotion","WHERE equal($11, 'N')"]},{"kind":"WRITE","substeps":["$10","TO __stage05_output","BY HASH($10)"]}],"writeRatioAvg":0.028556727553383073},{"readMsMax":"8","computeMsMax":"9","waitMsAvg":"30","id":"6","endMs":"1570904263759","waitMsMax":"30","startMs":"1570904263164","waitRatioMax":0.007718034473887317,"readRatioAvg":0.0020581425263699513,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.002315410342166195,"writeMsAvg":"576","status":"COMPLETE","writeMsMax":"576","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.14818626189863648,"readMsAvg":"8","waitRatioAvg":0.007718034473887317,"completedParallelInputs":"1","computeRatioMax":0.002315410342166195,"name":"S06: Input","shuffleOutputBytes":"9171","recordsWritten":"1019","readRatioMax":0.0020581425263699513,"steps":[{"kind":"READ","substeps":["$60:i_item_sk, $61:i_current_price","FROM item","WHERE greater($61, 50)"]},{"kind":"WRITE","substeps":["$60","TO __stage06_output","BY HASH($60)"]}],"writeRatioAvg":0.14818626189863648},{"readMsMax":"6","computeMsMax":"16","waitMsAvg":"15","id":"7","endMs":"1570904263366","waitMsMax":"15","startMs":"1570904263172","waitRatioMax":0.0038590172369436584,"readRatioAvg":0.0015436068947774634,"parallelInputs":"1","recordsRead":"11718","computeRatioAvg":0.004116285052739903,"writeMsAvg":"174","status":"COMPLETE","writeMsMax":"174","computeMsAvg":"16","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04476459994854644,"readMsAvg":"6","waitRatioAvg":0.0038590172369436584,"completedParallelInputs":"1","computeRatioMax":0.004116285052739903,"name":"S07: Input","shuffleOutputBytes":"351540","recordsWritten":"11718","readRatioMax":0.0015436068947774634,"steps":[{"kind":"READ","substeps":["$50:cp_catalog_page_sk, $51:cp_catalog_page_id","FROM catalog_page"]},{"kind":"WRITE","substeps":["$50, $51","TO __stage07_output","BY HASH($50)"]}],"writeRatioAvg":0.04476459994854644},{"readMsMax":"9","computeMsMax":"18","waitMsAvg":"3","id":"8","endMs":"1570904263343","waitMsMax":"3","startMs":"1570904263261","waitRatioMax":0.0007718034473887317,"readRatioAvg":0.002315410342166195,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.00463082068433239,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0018008747105737071,"readMsAvg":"9","waitRatioAvg":0.0007718034473887317,"completedParallelInputs":"1","computeRatioMax":0.00463082068433239,"name":"S08: Input","shuffleOutputBytes":"3564","recordsWritten":"396","readRatioMax":0.002315410342166195,"steps":[{"kind":"READ","substeps":["$140:d_date_sk, $141:d_date","FROM date_dim","WHERE between(CAST($141 AS DATE), 11195, 11590)"]},{"kind":"WRITE","substeps":["$140","TO __stage08_output","BY HASH($140)"]}],"writeRatioAvg":0.0018008747105737071},{"readMsMax":"22","computeMsMax":"233","waitMsAvg":"3","id":"9","endMs":"1570904263767","waitMsMax":"3","startMs":"1570904263276","waitRatioMax":0.0007718034473887317,"readRatioAvg":0.005659891947517366,"parallelInputs":"1","recordsRead":"143868","computeRatioAvg":0.05994340108052482,"writeMsAvg":"192","status":"COMPLETE","writeMsMax":"192","computeMsAvg":"233","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04939542063287883,"readMsAvg":"22","waitRatioAvg":0.0007718034473887317,"completedParallelInputs":"1","computeRatioMax":0.05994340108052482,"name":"S09: Input","shuffleOutputBytes":"5132184","recordsWritten":"143868","readRatioMax":0.005659891947517366,"steps":[{"kind":"READ","substeps":["$130:cr_item_sk, $131:cr_order_number, $132:cr_return_amount, $133:cr_net_loss","FROM catalog_returns"]},{"kind":"WRITE","substeps":["$130, $131, $132, $133","TO __stage09_output","BY HASH($130, $131)"]}],"writeRatioAvg":0.04939542063287883},{"readMsMax":"7","computeMsMax":"11","waitMsAvg":"1","id":"10","endMs":"1570904263499","waitMsMax":"1","startMs":"1570904263292","waitRatioMax":0.0002572678157962439,"readRatioAvg":0.0018008747105737071,"parallelInputs":"1","recordsRead":"300","computeRatioAvg":0.002829945973758683,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005145356315924878,"readMsAvg":"7","waitRatioAvg":0.0002572678157962439,"completedParallelInputs":"1","computeRatioMax":0.002829945973758683,"name":"S0A: Input","shuffleOutputBytes":"2691","recordsWritten":"299","readRatioMax":0.0018008747105737071,"steps":[{"kind":"READ","substeps":["$1:p_promo_sk, $2:p_channel_tv","FROM promotion","WHERE equal($2, 'N')"]},{"kind":"WRITE","substeps":["$1","TO __stage0A_output","BY HASH($1)"]}],"writeRatioAvg":0.005145356315924878},{"readMsMax":"8","computeMsMax":"7","waitMsAvg":"4","id":"11","endMs":"1570904263513","waitMsMax":"4","startMs":"1570904263318","waitRatioMax":0.0010290712631849757,"readRatioAvg":0.0020581425263699513,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.0018008747105737071,"writeMsAvg":"174","status":"COMPLETE","writeMsMax":"174","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04476459994854644,"readMsAvg":"8","waitRatioAvg":0.0010290712631849757,"completedParallelInputs":"1","computeRatioMax":0.0018008747105737071,"name":"S0B: Input","shuffleOutputBytes":"9171","recordsWritten":"1019","readRatioMax":0.0020581425263699513,"steps":[{"kind":"READ","substeps":["$40:i_item_sk, $41:i_current_price","FROM item","WHERE greater($41, 50)"]},{"kind":"WRITE","substeps":["$40","TO __stage0B_output","BY HASH($40)"]}],"writeRatioAvg":0.04476459994854644},{"readMsMax":"13","computeMsMax":"12","waitMsAvg":"2","id":"12","endMs":"1570904263615","waitMsMax":"2","startMs":"1570904263393","waitRatioMax":0.0005145356315924878,"readRatioAvg":0.0033444816053511705,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.0030872137895549268,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005402624131721122,"readMsAvg":"13","waitRatioAvg":0.0005145356315924878,"completedParallelInputs":"1","computeRatioMax":0.0030872137895549268,"name":"S0C: Input","shuffleOutputBytes":"360","recordsWritten":"12","readRatioMax":0.0033444816053511705,"steps":[{"kind":"READ","substeps":["$30:s_store_sk, $31:s_store_id","FROM store"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage0C_output","BY HASH($30)"]}],"writeRatioAvg":0.005402624131721122},{"readMsMax":"18","computeMsMax":"16","waitMsAvg":"2","id":"13","endMs":"1570904263630","waitMsMax":"2","startMs":"1570904263423","waitRatioMax":0.0005145356315924878,"readRatioAvg":0.00463082068433239,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004116285052739903,"writeMsAvg":"172","status":"COMPLETE","writeMsMax":"172","computeMsAvg":"16","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04425006431695395,"readMsAvg":"18","waitRatioAvg":0.0005145356315924878,"completedParallelInputs":"1","computeRatioMax":0.004116285052739903,"name":"S0D: Input","shuffleOutputBytes":"3564","recordsWritten":"396","readRatioMax":0.00463082068433239,"steps":[{"kind":"READ","substeps":["$110:d_date_sk, $111:d_date","FROM date_dim","WHERE between(CAST($111 AS DATE), 11195, 11590)"]},{"kind":"WRITE","substeps":["$110","TO __stage0D_output","BY HASH($110)"]}],"writeRatioAvg":0.04425006431695395},{"readMsMax":"28","computeMsMax":"509","waitMsAvg":"2","id":"14","endMs":"1570904263992","waitMsMax":"2","startMs":"1570904263498","waitRatioMax":0.0005145356315924878,"readRatioAvg":0.0072034988422948285,"parallelInputs":"1","recordsRead":"288116","computeRatioAvg":0.13094931824028813,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"509","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007460766658091073,"readMsAvg":"28","waitRatioAvg":0.0005145356315924878,"completedParallelInputs":"1","computeRatioMax":0.13094931824028813,"name":"S0E: Input","shuffleOutputBytes":"10209768","recordsWritten":"288116","readRatioMax":0.0072034988422948285,"steps":[{"kind":"READ","substeps":["$100:sr_item_sk, $101:sr_ticket_number, $102:sr_return_amt, $103:sr_net_loss","FROM store_returns"]},{"kind":"WRITE","substeps":["$100, $101, $102, $103","TO __stage0E_output","BY HASH($100, $101)"]}],"writeRatioAvg":0.007460766658091073},{"readMsMax":"60","computeMsMax":"864","inputStages":["0","1","2","3","4"],"waitMsAvg":"3","id":"15","endMs":"1570904264173","waitMsMax":"3","startMs":"1570904263519","waitRatioMax":0.0007718034473887317,"readRatioAvg":0.015436068947774634,"parallelInputs":"1","recordsRead":"794624","computeRatioAvg":0.22227939284795473,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"864","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0012863390789812194,"readMsAvg":"60","waitRatioAvg":0.0007718034473887317,"completedParallelInputs":"1","computeRatioMax":0.22227939284795473,"name":"S0F: Join+","shuffleOutputBytes":"720","recordsWritten":"15","readRatioMax":0.015436068947774634,"steps":[{"kind":"READ","substeps":["$150:ws_sold_date_sk, $151:ws_item_sk, $152:ws_web_site_sk, $153:ws_promo_sk, $154:ws_order_number, $155:ws_ext_sales_price, $156:ws_net_profit","FROM web_sales"]},{"kind":"READ","substeps":["$160, $161, $162, $163","FROM __stage04_output"]},{"kind":"READ","substeps":["$170","FROM __stage03_output"]},{"kind":"READ","substeps":["$70, $71","FROM __stage02_output"]},{"kind":"READ","substeps":["$80","FROM __stage01_output"]},{"kind":"READ","substeps":["$20","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $520 := $510","$290 := SUM($511)","$291 := SUM($320)","$292 := SUM($321)"]},{"kind":"COMPUTE","substeps":["$320 := coalesce($513, 0)","$321 := subtract($512, coalesce($514, 0))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $501 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $490 = $80"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $481 = $70"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $470 = $170"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $151 = $160, $154 = $161"]},{"kind":"WRITE","substeps":["$520, $290, $291, $292","TO __stage0F_output","BY HASH($520)"]}],"writeRatioAvg":0.0012863390789812194},{"readMsMax":"58","computeMsMax":"2183","inputStages":["5","6","7","8","9"],"waitMsAvg":"10","id":"16","endMs":"1570904265059","waitMsMax":"10","startMs":"1570904263877","waitRatioMax":0.002572678157962439,"readRatioAvg":0.014921533316182145,"parallelInputs":"1","recordsRead":"1594742","computeRatioAvg":0.5616156418832005,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"2183","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0010290712631849757,"readMsAvg":"58","waitRatioAvg":0.002572678157962439,"completedParallelInputs":"1","computeRatioMax":0.5616156418832005,"name":"S10: Join+","shuffleOutputBytes":"84240","recordsWritten":"1755","readRatioMax":0.014921533316182145,"steps":[{"kind":"READ","substeps":["$120:cs_sold_date_sk, $121:cs_catalog_page_sk, $122:cs_item_sk, $123:cs_promo_sk, $124:cs_order_number, $125:cs_ext_sales_price, $126:cs_net_profit","FROM catalog_sales"]},{"kind":"READ","substeps":["$130, $131, $132, $133","FROM __stage09_output"]},{"kind":"READ","substeps":["$140","FROM __stage08_output"]},{"kind":"READ","substeps":["$50, $51","FROM __stage07_output"]},{"kind":"READ","substeps":["$60","FROM __stage06_output"]},{"kind":"READ","substeps":["$10","FROM __stage05_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $450 := $440","$280 := SUM($441)","$281 := SUM($310)","$282 := SUM($311)"]},{"kind":"COMPUTE","substeps":["$310 := coalesce($443, 0)","$311 := subtract($442, coalesce($444, 0))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $431 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $420 = $60"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $410 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $400 = $140"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $122 = $130, $124 = $131"]},{"kind":"WRITE","substeps":["$450, $280, $281, $282","TO __stage10_output","BY HASH($450)"]}],"writeRatioAvg":0.0010290712631849757},{"readMsMax":"51","computeMsMax":"3887","inputStages":["10","11","12","13","14"],"waitMsAvg":"9","id":"17","endMs":"1570904266355","waitMsMax":"9","startMs":"1570904264086","waitRatioMax":0.002315410342166195,"readRatioAvg":0.013120658605608439,"parallelInputs":"1","recordsRead":"3171020","computeRatioAvg":1,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"3887","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0015436068947774634,"readMsAvg":"51","waitRatioAvg":0.002315410342166195,"completedParallelInputs":"1","computeRatioMax":1,"name":"S11: Join+","shuffleOutputBytes":"288","recordsWritten":"6","readRatioMax":0.013120658605608439,"steps":[{"kind":"READ","substeps":["$90:ss_sold_date_sk, $91:ss_item_sk, $92:ss_store_sk, $93:ss_promo_sk, $94:ss_ticket_number, $95:ss_ext_sales_price, $96:ss_net_profit","FROM store_sales"]},{"kind":"READ","substeps":["$100, $101, $102, $103","FROM __stage0E_output"]},{"kind":"READ","substeps":["$110","FROM __stage0D_output"]},{"kind":"READ","substeps":["$30, $31","FROM __stage0C_output"]},{"kind":"READ","substeps":["$40","FROM __stage0B_output"]},{"kind":"READ","substeps":["$1","FROM __stage0A_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $380 := $370","$270 := SUM($371)","$271 := SUM($300)","$272 := SUM($301)"]},{"kind":"COMPUTE","substeps":["$300 := coalesce($373, 0)","$301 := subtract($372, coalesce($374, 0))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $361 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $350 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $341 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $330 = $110"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $91 = $100, $94 = $101"]},{"kind":"WRITE","substeps":["$380, $270, $271, $272","TO __stage11_output","BY HASH($380)"]}],"writeRatioAvg":0.0015436068947774634},{"readMsMax":"0","computeMsMax":"16","inputStages":["17","16","15"],"waitMsAvg":"7","id":"18","endMs":"1570904266792","waitMsMax":"7","startMs":"1570904266593","waitRatioMax":0.0018008747105737071,"readRatioAvg":0,"parallelInputs":"3","recordsRead":"1776","computeRatioAvg":0.002572678157962439,"writeMsAvg":"47","status":"COMPLETE","writeMsMax":"50","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012863390789812194,"readMsAvg":"0","waitRatioAvg":0.0018008747105737071,"completedParallelInputs":"3","computeRatioMax":0.004116285052739903,"name":"S12: Aggregate+","shuffleOutputBytes":"141906","recordsWritten":"1776","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$380, $270, $271, $272","FROM __stage11_output"]},{"kind":"READ","substeps":["$450, $280, $281, $282","FROM __stage10_output"]},{"kind":"READ","substeps":["$520, $290, $291, $292","FROM __stage0F_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $540 := $200, $541 := $201","$190 := SUM($202)","$191 := SUM($203)","$192 := SUM($204)"]},{"kind":"COMPUTE","substeps":["$210 := 'store channel'","$211 := concat('store', $390)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $390 := $380","$240 := SUM($270)","$241 := SUM($271)","$242 := SUM($272)"]},{"kind":"COMPUTE","substeps":["$220 := 'catalog channel'","$221 := concat('catalog_page', $460)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $460 := $450","$250 := SUM($280)","$251 := SUM($281)","$252 := SUM($282)"]},{"kind":"COMPUTE","substeps":["$230 := 'web channel'","$231 := concat('web_site', $530)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $530 := $520","$260 := SUM($290)","$261 := SUM($291)","$262 := SUM($292)"]},{"kind":"WRITE","substeps":["$190, $191, $192, $540, $541","TO __stage12_output","BY HASH($540, $541)"]}],"writeRatioAvg":0.012091587342423462},{"readMsMax":"0","computeMsMax":"9","inputStages":["18"],"waitMsAvg":"13","id":"19","endMs":"1570904267375","waitMsMax":"13","startMs":"1570904267186","waitRatioMax":0.0033444816053511705,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1776","computeRatioAvg":0.002315410342166195,"writeMsAvg":"167","status":"COMPLETE","writeMsMax":"167","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04296372523797273,"readMsAvg":"0","waitRatioAvg":0.0033444816053511705,"completedParallelInputs":"1","computeRatioMax":0.002315410342166195,"name":"S13: Sort+","shuffleOutputBytes":"8000","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$190, $191, $192, $540, $541","FROM __stage12_output"]},{"kind":"SORT","substeps":["$550 ASC, $551 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $550 := $540, $551 := $541","$180 := SUM($190)","$181 := SUM($191)","$182 := SUM($192)"]},{"kind":"WRITE","substeps":["$560, $561, $562, $563, $564","TO __stage13_output"]}],"writeRatioAvg":0.04296372523797273},{"readMsMax":"0","computeMsMax":"7","inputStages":["19"],"waitMsAvg":"67","id":"20","endMs":"1570904267392","waitMsMax":"67","startMs":"1570904267331","waitRatioMax":0.017236943658348342,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0018008747105737071,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0020581425263699513,"readMsAvg":"0","waitRatioAvg":0.017236943658348342,"completedParallelInputs":"1","computeRatioMax":0.0018008747105737071,"name":"S14: Output","shuffleOutputBytes":"8000","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$560, $561, $562, $563, $564","FROM __stage13_output"]},{"kind":"SORT","substeps":["$563 ASC, $564 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$570, $571, $572, $573, $574","TO __stage14_output"]}],"writeRatioAvg":0.0020581425263699513}],"estimatedBytesProcessed":"294716533","timeline":[{"totalSlotMs":"1206","activeUnits":"6","completedUnits":"8","elapsedMs":"714","pendingUnits":"7"},{"totalSlotMs":"4827","activeUnits":"2","completedUnits":"16","elapsedMs":"1853","pendingUnits":"2"},{"totalSlotMs":"7935","activeUnits":"1","completedUnits":"17","elapsedMs":"2827","pendingUnits":"1"},{"totalSlotMs":"11284","activeUnits":"0","completedUnits":"23","elapsedMs":"4825","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"295698432","totalPartitionsProcessed":"0","totalBytesProcessed":"294716533","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"promotion","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_site","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_page","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"}]},"endTime":"1570904267580"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query80_1570904261"},"etag":"oNmGGxmmJ70oqdS1yndjsw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query80_1570904261?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon50c6d28d94855edeec684846b477d0a0f416b224","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query80\nWITH ssr AS \n( \n SELECT s_store_id AS store_id, \n Sum(ss_ext_sales_price) AS sales, \n Sum(COALESCE(sr_return_amt, 0)) AS returns1, \n Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n FROM store_sales \n LEFT OUTER JOIN store_returns \n ON ( \n ss_item_sk = sr_item_sk \n AND ss_ticket_number = sr_ticket_number), \n date_dim, \n store, \n item, \n promotion \n WHERE ss_sold_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN Cast('2000-08-26' AS DATE) AND ( \n Cast('2001-09-25' AS DATE)) \n AND ss_store_sk = s_store_sk \n AND ss_item_sk = i_item_sk \n AND i_current_price > 50 \n AND ss_promo_sk = p_promo_sk \n AND p_channel_tv = 'N' \n GROUP BY s_store_id) , csr AS \n( \n SELECT cp_catalog_page_id AS catalog_page_id, \n sum(cs_ext_sales_price) AS sales, \n sum(COALESCE(cr_return_amount, 0)) AS returns1, \n sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n FROM catalog_sales \n LEFT OUTER JOIN catalog_returns \n ON ( \n cs_item_sk = cr_item_sk \n AND cs_order_number = cr_order_number), \n date_dim, \n catalog_page, \n item, \n promotion \n WHERE cs_sold_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2000-08-26' AS date) AND ( \n Cast('2001-09-25' AS DATE)) \n AND cs_catalog_page_sk = cp_catalog_page_sk \n AND cs_item_sk = i_item_sk \n AND i_current_price > 50 \n AND cs_promo_sk = p_promo_sk \n AND p_channel_tv = 'N' \n GROUP BY cp_catalog_page_id) , wsr AS \n( \n SELECT web_site_id, \n sum(ws_ext_sales_price) AS sales, \n sum(COALESCE(wr_return_amt, 0)) AS returns1, \n sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n FROM web_sales \n LEFT OUTER JOIN web_returns \n ON ( \n ws_item_sk = wr_item_sk \n AND ws_order_number = wr_order_number), \n date_dim, \n web_site, \n item, \n promotion \n WHERE ws_sold_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2000-08-26' AS date) AND ( \n Cast('2001-09-25' AS DATE)) \n AND ws_web_site_sk = web_site_sk \n AND ws_item_sk = i_item_sk \n AND i_current_price > 50 \n AND ws_promo_sk = p_promo_sk \n AND p_channel_tv = 'N' \n GROUP BY web_site_id) \nSELECT\n channel , \n id , \n sum(sales) AS sales , \n sum(returns1) AS returns1 , \n sum(profit) AS profit \nFROM ( \n SELECT 'store channel' AS channel , \n Concat('store', store_id) AS id , \n sales , \n returns1 , \n profit \n FROM ssr \n UNION ALL \n SELECT 'catalog channel' AS channel , \n Concat('catalog_page', catalog_page_id) AS id , \n sales , \n returns1 , \n profit \n FROM csr \n UNION ALL \n SELECT 'web channel' AS channel , \n Concat('web_site', web_site_id) AS id , \n sales , \n returns1 , \n profit \n FROM wsr ) x \nGROUP BY channel, id\nORDER BY channel , \n id \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query80_1570904261","user_email":"nithish.sankaranarayanan@ulb.be"}
