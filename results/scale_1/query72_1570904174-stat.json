{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"96312","creationTime":"1570904175773","totalBytesProcessed":"490075858","startTime":"1570904176008","query":{"totalSlotMs":"96312","queryPlan":[{"readMsMax":"15","computeMsMax":"109","waitMsAvg":"1","id":"0","endMs":"1570904176800","waitMsMax":"1","startMs":"1570904176383","waitRatioMax":9.813542688910697e-05,"readRatioAvg":0.0014720314033366045,"parallelInputs":"1","recordsRead":"143868","computeRatioAvg":0.01069676153091266,"writeMsAvg":"158","status":"COMPLETE","writeMsMax":"158","computeMsAvg":"109","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0155053974484789,"readMsAvg":"15","waitRatioAvg":9.813542688910697e-05,"completedParallelInputs":"1","computeRatioMax":0.01069676153091266,"name":"S00: Input","shuffleOutputBytes":"2589624","recordsWritten":"143868","readRatioMax":0.0014720314033366045,"steps":[{"kind":"READ","substeps":["$20:cr_item_sk, $21:cr_order_number","FROM catalog_returns"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage00_output","BY HASH($20, $21)"]}],"writeRatioAvg":0.0155053974484789},{"readMsMax":"18","computeMsMax":"7","waitMsAvg":"1","id":"1","endMs":"1570904176511","waitMsMax":"1","startMs":"1570904176463","waitRatioMax":9.813542688910697e-05,"readRatioAvg":0.0017664376840039254,"parallelInputs":"1","recordsRead":"300","computeRatioAvg":0.0006869479882237487,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0005888125613346418,"readMsAvg":"18","waitRatioAvg":9.813542688910697e-05,"completedParallelInputs":"1","computeRatioMax":0.0006869479882237487,"name":"S01: Input","shuffleOutputBytes":"2700","recordsWritten":"300","readRatioMax":0.0017664376840039254,"steps":[{"kind":"READ","substeps":["$30:p_promo_sk","FROM promotion"]},{"kind":"WRITE","substeps":["$30","TO __stage01_output","BY HASH($30)"]}],"writeRatioAvg":0.0005888125613346418},{"readMsMax":"16","computeMsMax":"8","waitMsAvg":"23","id":"2","endMs":"1570904176549","waitMsMax":"23","startMs":"1570904176506","waitRatioMax":0.0022571148184494603,"readRatioAvg":0.0015701668302257115,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0007850834151128558,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0004906771344455348,"readMsAvg":"16","waitRatioAvg":0.0022571148184494603,"completedParallelInputs":"1","computeRatioMax":0.0007850834151128558,"name":"S02: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0015701668302257115,"steps":[{"kind":"READ","substeps":["$40:d_date_sk, $41:d_week_seq, $42:d_year","FROM date_dim","WHERE equal($42, 2002)"]},{"kind":"WRITE","substeps":["$40, $41","TO __stage02_output","BY HASH($40)"]}],"writeRatioAvg":0.0004906771344455348},{"readMsMax":"37","computeMsMax":"7","waitMsAvg":"14","id":"3","endMs":"1570904176563","waitMsMax":"14","startMs":"1570904176511","waitRatioMax":0.0013738959764474975,"readRatioAvg":0.0036310107948969578,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.0006869479882237487,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0003925417075564279,"readMsAvg":"37","waitRatioAvg":0.0013738959764474975,"completedParallelInputs":"1","computeRatioMax":0.0006869479882237487,"name":"S03: Input","shuffleOutputBytes":"10800","recordsWritten":"1200","readRatioMax":0.0036310107948969578,"steps":[{"kind":"READ","substeps":["$50:hd_demo_sk, $51:hd_buy_potential","FROM household_demographics","WHERE equal($51, '501-1000')"]},{"kind":"WRITE","substeps":["$50","TO __stage03_output","BY HASH($50)"]}],"writeRatioAvg":0.0003925417075564279},{"readMsMax":"34","computeMsMax":"244","waitMsAvg":"38","id":"4","endMs":"1570904176765","waitMsMax":"38","startMs":"1570904176549","waitRatioMax":0.003729146221786065,"readRatioAvg":0.0033366045142296367,"parallelInputs":"1","recordsRead":"1920800","computeRatioAvg":0.0239450441609421,"writeMsAvg":"71","status":"COMPLETE","writeMsMax":"71","computeMsAvg":"244","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006967615309126595,"readMsAvg":"34","waitRatioAvg":0.003729146221786065,"completedParallelInputs":"1","computeRatioMax":0.0239450441609421,"name":"S04: Input","shuffleOutputBytes":"3457440","recordsWritten":"384160","readRatioMax":0.0033366045142296367,"steps":[{"kind":"READ","substeps":["$60:cd_demo_sk, $61:cd_marital_status","FROM customer_demographics","WHERE equal($61, 'M')"]},{"kind":"WRITE","substeps":["$60","TO __stage04_output","BY HASH($60)"]}],"writeRatioAvg":0.006967615309126595},{"readMsMax":"88","computeMsMax":"3583","waitMsAvg":"9","id":"6","endMs":"1570904178374","waitMsMax":"9","startMs":"1570904176550","waitRatioMax":0.0008832188420019627,"readRatioAvg":0.008635917566241413,"parallelInputs":"1","recordsRead":"1437442","computeRatioAvg":0.3516192345436703,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"16","computeMsAvg":"3583","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0015701668302257115,"readMsAvg":"88","waitRatioAvg":0.0008832188420019627,"completedParallelInputs":"1","computeRatioMax":0.3516192345436703,"name":"S06: Input","shuffleOutputBytes":"102660752","recordsWritten":"1426638","readRatioMax":0.008635917566241413,"steps":[{"kind":"READ","substeps":["$70:cs_sold_date_sk, $71:cs_bill_cdemo_sk, $72:cs_bill_hdemo_sk, $73:cs_warehouse_sk, $74:cs_item_sk, $75:cs_promo_sk, $76:cs_order_number, $77:cs_quantity","FROM catalog_sales"]},{"kind":"WRITE","substeps":["$70, $71, $72, $73, $74, $75, $76, $77","TO __stage06_output","BY HASH($74, $70, $73)"]}],"writeRatioAvg":0.0015701668302257115},{"readMsMax":"0","computeMsMax":"36","inputStages":["6"],"waitMsAvg":"1","id":"7","endMs":"1570904179186","waitMsMax":"4","startMs":"1570904178429","waitRatioMax":0.0003925417075564279,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1426638","computeRatioAvg":0.002649656526005888,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"37","computeMsAvg":"27","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0036310107948969578,"readMsAvg":"0","waitRatioAvg":9.813542688910697e-05,"completedParallelInputs":"100","computeRatioMax":0.0035328753680078507,"name":"S07: Coalesce","shuffleOutputBytes":"102660752","recordsWritten":"1426638","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage06_output"]}],"writeRatioAvg":0.0025515210991167814},{"readMsMax":"0","computeMsMax":"12","inputStages":["4"],"waitMsAvg":"6","id":"8","endMs":"1570904178537","waitMsMax":"10","startMs":"1570904178430","waitRatioMax":0.0009813542688910696,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"384160","computeRatioAvg":0.0006869479882237487,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"35","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0034347399411187437,"readMsAvg":"0","waitRatioAvg":0.0005888125613346418,"completedParallelInputs":"100","computeRatioMax":0.0011776251226692837,"name":"S08: Coalesce","shuffleOutputBytes":"3457440","recordsWritten":"384160","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage04_output"]}],"writeRatioAvg":0.0018645731108930324},{"readMsMax":"33","computeMsMax":"10190","inputStages":["0","1","2","3","8","7"],"waitMsAvg":"1","id":"9","endMs":"1570904185430","waitMsMax":"1","startMs":"1570904178456","waitRatioMax":9.813542688910697e-05,"readRatioAvg":0.00323846908734053,"parallelInputs":"1","recordsRead":"13701531","computeRatioAvg":1,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"10190","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001962708537782139,"readMsAvg":"33","waitRatioAvg":9.813542688910697e-05,"completedParallelInputs":"1","computeRatioMax":1,"name":"S09: Join+","shuffleOutputBytes":"3726","recordsWritten":"69","readRatioMax":0.00323846908734053,"steps":[{"kind":"READ","substeps":["$80:inv_date_sk, $81:inv_item_sk, $82:inv_warehouse_sk, $83:inv_quantity_on_hand","FROM inventory"]},{"kind":"READ","substeps":["$70, $71, $72, $73, $74, $75, $76, $77","FROM __stage07_output"]},{"kind":"READ","substeps":["$60","FROM __stage08_output"]},{"kind":"READ","substeps":["$50","FROM __stage03_output"]},{"kind":"READ","substeps":["$40, $41","FROM __stage02_output"]},{"kind":"READ","substeps":["$30","FROM __stage01_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $183, $191 := $182, $192 := $181","$100 := SUM($111)","$101 := SUM($110)","$102 := COUNT_STAR()"]},{"kind":"COMPUTE","substeps":["$110 := case_no_value(not(is_null($180)), 1, 0)","$111 := case_no_value(is_null($180), 1, 0)"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $172 = $20, $173 = $21"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $162 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $150 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $141 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $121 = $60"]},{"kind":"FILTER","substeps":["less($128, $127)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $81 = $74, $80 = $70, $82 = $73"]},{"kind":"WRITE","substeps":["$192, $191, $190, $100, $101, $102","TO __stage09_output","BY HASH($190, $191, $192)"]}],"writeRatioAvg":0.001962708537782139},{"readMsMax":"45","computeMsMax":"57","waitMsAvg":"1","id":"10","endMs":"1570904187115","waitMsMax":"1","startMs":"1570904186963","waitRatioMax":9.813542688910697e-05,"readRatioAvg":0.004416094210009814,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.005593719332679097,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"26","computeMsAvg":"57","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0025515210991167814,"readMsAvg":"45","waitRatioAvg":9.813542688910697e-05,"completedParallelInputs":"1","computeRatioMax":0.005593719332679097,"name":"S0A: Input","shuffleOutputBytes":"2040607","recordsWritten":"18000","readRatioMax":0.004416094210009814,"steps":[{"kind":"READ","substeps":["$1:i_item_sk, $2:i_item_desc","FROM item"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage0A_output","BY HASH($1)"]}],"writeRatioAvg":0.0025515210991167814},{"readMsMax":"62","computeMsMax":"8","waitMsAvg":"1","id":"11","endMs":"1570904187132","waitMsMax":"1","startMs":"1570904186986","waitRatioMax":9.813542688910697e-05,"readRatioAvg":0.006084396467124632,"parallelInputs":"1","recordsRead":"5","computeRatioAvg":0.0007850834151128558,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002845927379784102,"readMsAvg":"62","waitRatioAvg":9.813542688910697e-05,"completedParallelInputs":"1","computeRatioMax":0.0007850834151128558,"name":"S0B: Input","shuffleOutputBytes":"151","recordsWritten":"5","readRatioMax":0.006084396467124632,"steps":[{"kind":"READ","substeps":["$10:w_warehouse_sk, $11:w_warehouse_name","FROM warehouse"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage0B_output","BY HASH($10)"]}],"writeRatioAvg":0.002845927379784102},{"readMsMax":"0","computeMsMax":"25","inputStages":["9","10","11"],"waitMsAvg":"1","id":"13","endMs":"1570904187195","waitMsMax":"1","startMs":"1570904187145","waitRatioMax":9.813542688910697e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"18074","computeRatioAvg":0.0024533856722276743,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"25","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0004906771344455348,"readMsAvg":"0","waitRatioAvg":9.813542688910697e-05,"completedParallelInputs":"1","computeRatioMax":0.0024533856722276743,"name":"S0D: Join+","shuffleOutputBytes":"10281","recordsWritten":"69","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$192, $191, $190, $100, $101, $102","FROM __stage09_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage0B_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage0A_output"]},{"kind":"SORT","substeps":["$224 DESC, $225 ASC, $220 ASC, $221 ASC","LIMIT 100"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $211 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $201 = $10"]},{"kind":"AGGREGATE","substeps":["GROUP BY $200 := $190, $201 := $191, $202 := $192","$90 := SUM($100)","$91 := SUM($101)","$92 := SUM_OF_COUNTS($102)"]},{"kind":"WRITE","substeps":["$230, $231, $232, $233, $234, $235","TO __stage0D_output"]}],"writeRatioAvg":0.0004906771344455348},{"readMsMax":"0","computeMsMax":"7","inputStages":["13"],"waitMsAvg":"1","id":"14","endMs":"1570904187221","waitMsMax":"1","startMs":"1570904187161","waitRatioMax":9.813542688910697e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"69","computeRatioAvg":0.0006869479882237487,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0006869479882237487,"readMsAvg":"0","waitRatioAvg":9.813542688910697e-05,"completedParallelInputs":"1","computeRatioMax":0.0006869479882237487,"name":"S0E: Output","shuffleOutputBytes":"10281","recordsWritten":"69","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$230, $231, $232, $233, $234, $235","FROM __stage0D_output"]},{"kind":"SORT","substeps":["$235 DESC, $230 ASC, $231 ASC, $232 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$240, $241, $242, $243, $244, $245","TO __stage0E_output"]}],"writeRatioAvg":0.0006869479882237487}],"estimatedBytesProcessed":"490075858","timeline":[{"totalSlotMs":"1168","activeUnits":"2","completedUnits":"5","elapsedMs":"877","pendingUnits":"2"},{"totalSlotMs":"78387","activeUnits":"91","completedUnits":"206","elapsedMs":"3424","pendingUnits":"1"},{"totalSlotMs":"95710","activeUnits":"0","completedUnits":"207","elapsedMs":"9926","pendingUnits":"0"},{"totalSlotMs":"96312","activeUnits":"0","completedUnits":"211","elapsedMs":"11388","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"490733568","totalPartitionsProcessed":"0","totalBytesProcessed":"490075858","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"promotion","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"warehouse","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"inventory","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"customer_demographics","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"}]},"endTime":"1570904187434"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query72_1570904174"},"etag":"+WaWUg1AWtNdnyy4LiSTCA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query72_1570904174?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon7fa629275e6a2c9beabd418b06fed48857993b1a","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query72\nWITH top_items AS (\n SELECT cs_item_sk, \n cs_warehouse_sk, \n d1.d_week_seq, \n Sum(CASE \n WHEN p_promo_sk IS NULL THEN 1 \n ELSE 0 \n END) no_promo, \n Sum(CASE \n WHEN p_promo_sk IS NOT NULL THEN 1 \n ELSE 0 \n END) promo, \n Count(*) total_cnt \n FROM catalog_sales \n JOIN inventory \n ON ( cs_item_sk = inv_item_sk and cs_sold_date_sk = inv_date_sk and cs_warehouse_sk = inv_warehouse_sk ) \n JOIN customer_demographics \n ON ( cs_bill_cdemo_sk = cd_demo_sk ) \n JOIN household_demographics \n ON ( cs_bill_hdemo_sk = hd_demo_sk ) \n JOIN date_dim d1 \n ON ( cs_sold_date_sk = d1.d_date_sk ) \n LEFT OUTER JOIN promotion \n ON ( cs_promo_sk = p_promo_sk ) \n LEFT OUTER JOIN catalog_returns \n ON ( cr_item_sk = cs_item_sk \n AND cr_order_number = cs_order_number ) \n WHERE inv_quantity_on_hand < cs_quantity \n AND hd_buy_potential = '501-1000' \n AND d1.d_year = 2002 \n AND cd_marital_status = 'M' \n GROUP BY 1, 2, 3\n)\nSELECT i_item_desc, \n w_warehouse_name, \n d_week_seq,\n no_promo,\n promo,\n total_cnt\nFROM top_items \nJOIN warehouse \n ON ( w_warehouse_sk = cs_warehouse_sk ) \nJOIN item \n ON ( i_item_sk = cs_item_sk ) \nORDER BY total_cnt DESC, \n 1, 2, 3\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query72_1570904174","user_email":"nithish.sankaranarayanan@ulb.be"}
