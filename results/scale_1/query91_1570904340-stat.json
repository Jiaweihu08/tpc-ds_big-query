{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"23959","creationTime":"1570904341719","totalBytesProcessed":"53702042","startTime":"1570904341851","query":{"totalSlotMs":"23959","queryPlan":[{"readMsMax":"6","computeMsMax":"8","waitMsAvg":"14","id":"0","endMs":"1570904342246","waitMsMax":"14","startMs":"1570904342064","waitRatioMax":0.010416666666666666,"readRatioAvg":0.004464285714285714,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.005952380952380952,"writeMsAvg":"164","status":"COMPLETE","writeMsMax":"164","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.12202380952380952,"readMsAvg":"6","waitRatioAvg":0.010416666666666666,"completedParallelInputs":"1","computeRatioMax":0.005952380952380952,"name":"S00: Input","shuffleOutputBytes":"10800","recordsWritten":"1200","readRatioMax":0.004464285714285714,"steps":[{"kind":"READ","substeps":["$1:hd_demo_sk, $2:hd_buy_potential","FROM household_demographics","WHERE like($2, 'Unknown%')"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.12202380952380952},{"readMsMax":"68","computeMsMax":"337","waitMsAvg":"27","id":"1","endMs":"1570904342377","waitMsMax":"27","startMs":"1570904342097","waitRatioMax":0.020089285714285716,"readRatioAvg":0.050595238095238096,"parallelInputs":"1","recordsRead":"1920800","computeRatioAvg":0.2507440476190476,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"337","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01636904761904762,"readMsAvg":"68","waitRatioAvg":0.020089285714285716,"completedParallelInputs":"1","computeRatioMax":0.2507440476190476,"name":"S01: Input","shuffleOutputBytes":"3402560","recordsWritten":"109760","readRatioMax":0.050595238095238096,"steps":[{"kind":"READ","substeps":["$10:cd_demo_sk, $11:cd_marital_status, $12:cd_education_status","FROM customer_demographics","WHERE or(and(equal($11, 'M'), equal($12, 'Unknown')), and(equal($11, 'W'), equal($12, 'Advanced Degree')))"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.01636904761904762},{"readMsMax":"11","computeMsMax":"13","waitMsAvg":"6","id":"2","endMs":"1570904342403","waitMsMax":"6","startMs":"1570904342173","waitRatioMax":0.004464285714285714,"readRatioAvg":0.00818452380952381,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.009672619047619048,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01636904761904762,"readMsAvg":"11","waitRatioAvg":0.004464285714285714,"completedParallelInputs":"1","computeRatioMax":0.009672619047619048,"name":"S02: Input","shuffleOutputBytes":"49851","recordsWritten":"5539","readRatioMax":0.00818452380952381,"steps":[{"kind":"READ","substeps":["$30:ca_address_sk, $31:ca_gmt_offset","FROM customer_address","WHERE equal($31, -7)"]},{"kind":"WRITE","substeps":["$30","TO __stage02_output","BY HASH($30)"]}],"writeRatioAvg":0.01636904761904762},{"readMsMax":"11","computeMsMax":"8","waitMsAvg":"37","id":"4","endMs":"1570904342426","waitMsMax":"37","startMs":"1570904342248","waitRatioMax":0.027529761904761904,"readRatioAvg":0.00818452380952381,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.005952380952380952,"writeMsAvg":"155","status":"COMPLETE","writeMsMax":"155","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.11532738095238096,"readMsAvg":"11","waitRatioAvg":0.027529761904761904,"completedParallelInputs":"1","computeRatioMax":0.005952380952380952,"name":"S04: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.00818452380952381,"steps":[{"kind":"READ","substeps":["$60:d_date_sk, $61:d_year, $62:d_moy","FROM date_dim","WHERE and(equal($61, 1999), equal($62, 12))"]},{"kind":"WRITE","substeps":["$60","TO __stage04_output","BY HASH($60)"]}],"writeRatioAvg":0.11532738095238096},{"readMsMax":"64","computeMsMax":"8","waitMsAvg":"1","id":"6","endMs":"1570904342419","waitMsMax":"1","startMs":"1570904342336","waitRatioMax":0.000744047619047619,"readRatioAvg":0.047619047619047616,"parallelInputs":"1","recordsRead":"6","computeRatioAvg":0.005952380952380952,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003720238095238095,"readMsAvg":"64","waitRatioAvg":0.000744047619047619,"completedParallelInputs":"1","computeRatioMax":0.005952380952380952,"name":"S06: Input","shuffleOutputBytes":"398","recordsWritten":"6","readRatioMax":0.047619047619047616,"steps":[{"kind":"READ","substeps":["$40:cc_call_center_sk, $41:cc_call_center_id, $42:cc_name, $43:cc_manager","FROM call_center"]},{"kind":"WRITE","substeps":["$40, $41, $42, $43","TO __stage06_output","BY HASH($40)"]}],"writeRatioAvg":0.003720238095238095},{"readMsMax":"18","computeMsMax":"65","inputStages":["4","6"],"waitMsAvg":"3","id":"8","endMs":"1570904342606","waitMsMax":"3","startMs":"1570904342529","waitRatioMax":0.002232142857142857,"readRatioAvg":0.013392857142857142,"parallelInputs":"1","recordsRead":"143905","computeRatioAvg":0.04836309523809524,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"65","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004464285714285714,"readMsAvg":"18","waitRatioAvg":0.002232142857142857,"completedParallelInputs":"1","computeRatioMax":0.04836309523809524,"name":"S08: Join","shuffleOutputBytes":"170522","recordsWritten":"2295","readRatioMax":0.013392857142857142,"steps":[{"kind":"READ","substeps":["$50:cr_returned_date_sk, $51:cr_returning_customer_sk, $52:cr_call_center_sk, $53:cr_net_loss","FROM catalog_returns"]},{"kind":"READ","substeps":["$40, $41, $42, $43","FROM __stage06_output"]},{"kind":"READ","substeps":["$60","FROM __stage04_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $93 = $60"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $52 = $40"]},{"kind":"WRITE","substeps":["$110, $111, $112, $113, $114","TO __stage08_output","BY HASH($113)"]}],"writeRatioAvg":0.004464285714285714},{"readMsMax":"0","computeMsMax":"9","inputStages":["8"],"waitMsAvg":"5","id":"9","endMs":"1570904342817","waitMsMax":"7","startMs":"1570904342636","waitRatioMax":0.005208333333333333,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2295","computeRatioAvg":0.003720238095238095,"writeMsAvg":"51","status":"COMPLETE","writeMsMax":"115","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08556547619047619,"readMsAvg":"0","waitRatioAvg":0.003720238095238095,"completedParallelInputs":"100","computeRatioMax":0.006696428571428571,"name":"S09: Coalesce","shuffleOutputBytes":"170522","recordsWritten":"2295","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage08_output"]}],"writeRatioAvg":0.03794642857142857},{"readMsMax":"0","computeMsMax":"10","inputStages":["1"],"waitMsAvg":"7","id":"10","endMs":"1570904342784","waitMsMax":"10","startMs":"1570904342636","waitRatioMax":0.00744047619047619,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"109760","computeRatioAvg":0.004464285714285714,"writeMsAvg":"54","status":"COMPLETE","writeMsMax":"65","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04836309523809524,"readMsAvg":"0","waitRatioAvg":0.005208333333333333,"completedParallelInputs":"100","computeRatioMax":0.00744047619047619,"name":"S0A: Coalesce","shuffleOutputBytes":"3402560","recordsWritten":"109760","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage01_output"]}],"writeRatioAvg":0.04017857142857143},{"readMsMax":"18","computeMsMax":"115","inputStages":["0","10","2","9"],"waitMsAvg":"1","id":"11","endMs":"1570904342861","waitMsMax":"1","startMs":"1570904342680","waitRatioMax":0.000744047619047619,"readRatioAvg":0.013392857142857142,"parallelInputs":"1","recordsRead":"218794","computeRatioAvg":0.08556547619047619,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"115","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002976190476190476,"readMsAvg":"18","waitRatioAvg":0.000744047619047619,"completedParallelInputs":"1","computeRatioMax":0.08556547619047619,"name":"S0B: Join+","shuffleOutputBytes":"173","recordsWritten":"2","readRatioMax":0.013392857142857142,"steps":[{"kind":"READ","substeps":["$20:c_customer_sk, $21:c_current_cdemo_sk, $22:c_current_hdemo_sk, $23:c_current_addr_sk","FROM customer"]},{"kind":"READ","substeps":["$110, $111, $112, $113, $114","FROM __stage09_output"]},{"kind":"READ","substeps":["$30","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage0A_output"]},{"kind":"READ","substeps":["$1","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $172, $181 := $173, $182 := $174, $183 := $170, $184 := $171","$80 := SUM($175)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $160 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $140 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $126 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $113"]},{"kind":"WRITE","substeps":["$183, $184, $180, $181, $182, $80","TO __stage0B_output","BY HASH($180, $181, $182, $183, $184)"]}],"writeRatioAvg":0.002976190476190476},{"readMsMax":"0","computeMsMax":"5","inputStages":["11"],"waitMsAvg":"2","id":"12","endMs":"1570904342993","waitMsMax":"2","startMs":"1570904342926","waitRatioMax":0.001488095238095238,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2","computeRatioAvg":0.003720238095238095,"writeMsAvg":"41","status":"COMPLETE","writeMsMax":"41","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03050595238095238,"readMsAvg":"0","waitRatioAvg":0.001488095238095238,"completedParallelInputs":"1","computeRatioMax":0.003720238095238095,"name":"S0C: Aggregate","shuffleOutputBytes":"129","recordsWritten":"2","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$183, $184, $180, $181, $182, $80","FROM __stage0B_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $180, $191 := $181, $192 := $182, $193 := $183, $194 := $184","$70 := SUM($80)"]},{"kind":"WRITE","substeps":["$190, $191, $192, $70","TO __stage0C_output"]}],"writeRatioAvg":0.03050595238095238},{"readMsMax":"0","computeMsMax":"4","inputStages":["12"],"waitMsAvg":"1","id":"13","endMs":"1570904344368","waitMsMax":"1","startMs":"1570904343013","waitRatioMax":0.000744047619047619,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2","computeRatioAvg":0.002976190476190476,"writeMsAvg":"1344","status":"COMPLETE","writeMsMax":"1344","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":1,"readMsAvg":"0","waitRatioAvg":0.000744047619047619,"completedParallelInputs":"1","computeRatioMax":0.002976190476190476,"name":"S0D: Output","shuffleOutputBytes":"129","recordsWritten":"2","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$190, $191, $192, $70","FROM __stage0C_output"]},{"kind":"SORT","substeps":["$70 DESC"]},{"kind":"WRITE","substeps":["$200, $201, $202, $203","TO __stage0D_output"]}],"writeRatioAvg":1}],"estimatedBytesProcessed":"53702042","timeline":[{"totalSlotMs":"1364","activeUnits":"2","completedUnits":"5","elapsedMs":"713","pendingUnits":"2"},{"totalSlotMs":"22064","activeUnits":"1","completedUnits":"208","elapsedMs":"1257","pendingUnits":"1"},{"totalSlotMs":"23959","activeUnits":"1","completedUnits":"209","elapsedMs":"2875","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"73400320","totalPartitionsProcessed":"0","totalBytesProcessed":"53702042","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"call_center","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"customer_demographics","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_1"}]},"endTime":"1570904344757"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query91_1570904340"},"etag":"eG3c8qVxiu9Dhn1smINDJQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query91_1570904340?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anoned23572c1ceff91dc827494fc5db35d420aa1e1f","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query91\nSELECT cc_call_center_id Call_Center, \n cc_name Call_Center_Name, \n cc_manager Manager, \n Sum(cr_net_loss) Returns_Loss \nFROM call_center, \n catalog_returns, \n date_dim, \n customer, \n customer_address, \n customer_demographics, \n household_demographics \nWHERE cr_call_center_sk = cc_call_center_sk \n AND cr_returned_date_sk = d_date_sk \n AND cr_returning_customer_sk = c_customer_sk \n AND cd_demo_sk = c_current_cdemo_sk \n AND hd_demo_sk = c_current_hdemo_sk \n AND ca_address_sk = c_current_addr_sk \n AND d_year = 1999 \n AND d_moy = 12 \n AND ( ( cd_marital_status = 'M' \n AND cd_education_status = 'Unknown' ) \n OR ( cd_marital_status = 'W' \n AND cd_education_status = 'Advanced Degree' ) ) \n AND hd_buy_potential LIKE 'Unknown%' \n AND ca_gmt_offset = -7 \nGROUP BY cc_call_center_id, \n cc_name, \n cc_manager, \n cd_marital_status, \n cd_education_status \nORDER BY Sum(cr_net_loss) DESC; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query91_1570904340","user_email":"nithish.sankaranarayanan@ulb.be"}
