{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"36536","creationTime":"1570903942656","totalBytesProcessed":"123487845","startTime":"1570903942867","query":{"totalSlotMs":"36536","queryPlan":[{"readMsMax":"15","computeMsMax":"83","waitMsAvg":"1","id":"0","endMs":"1570903943515","waitMsMax":"1","startMs":"1570903943065","waitRatioMax":0.0009652509652509653,"readRatioAvg":0.01447876447876448,"parallelInputs":"1","recordsRead":"100000","computeRatioAvg":0.08011583011583012,"writeMsAvg":"139","status":"COMPLETE","writeMsMax":"139","computeMsAvg":"83","shuffleOutputBytesSpilled":"0","writeRatioMax":0.13416988416988418,"readMsAvg":"15","waitRatioAvg":0.0009652509652509653,"completedParallelInputs":"1","computeRatioMax":0.08011583011583012,"name":"S00: Input","shuffleOutputBytes":"1800000","recordsWritten":"100000","readRatioMax":0.01447876447876448,"steps":[{"kind":"READ","substeps":["$50:c_customer_sk, $51:c_current_addr_sk","FROM customer"]},{"kind":"WRITE","substeps":["$50, $51","TO __stage00_output","BY HASH($50)"]}],"writeRatioAvg":0.13416988416988418},{"readMsMax":"16","computeMsMax":"11","waitMsAvg":"1","id":"1","endMs":"1570903943300","waitMsMax":"1","startMs":"1570903943103","waitRatioMax":0.0009652509652509653,"readRatioAvg":0.015444015444015444,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.010617760617760617,"writeMsAvg":"162","status":"COMPLETE","writeMsMax":"162","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.15637065637065636,"readMsAvg":"16","waitRatioAvg":0.0009652509652509653,"completedParallelInputs":"1","computeRatioMax":0.010617760617760617,"name":"S01: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.015444015444015444,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_year, $72:d_moy","FROM date_dim","WHERE and(equal($72, 5), equal($71, 2000))"]},{"kind":"WRITE","substeps":["$70","TO __stage01_output","BY HASH($70)"]}],"writeRatioAvg":0.15637065637065636},{"readMsMax":"13","computeMsMax":"11","waitMsAvg":"1","id":"2","endMs":"1570903943243","waitMsMax":"1","startMs":"1570903943187","waitRatioMax":0.0009652509652509653,"readRatioAvg":0.012548262548262547,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.010617760617760617,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.019305019305019305,"readMsAvg":"13","waitRatioAvg":0.0009652509652509653,"completedParallelInputs":"1","computeRatioMax":0.010617760617760617,"name":"S02: Input","shuffleOutputBytes":"936","recordsWritten":"104","readRatioMax":0.012548262548262547,"steps":[{"kind":"READ","substeps":["$100:i_item_sk, $101:i_class, $102:i_category","FROM item","WHERE and(equal($102, 'Sports'), equal($101, 'fitness'))"]},{"kind":"WRITE","substeps":["$100","TO __stage02_output","BY HASH($100)"]}],"writeRatioAvg":0.019305019305019305},{"readMsMax":"7","computeMsMax":"9","waitMsAvg":"11","id":"4","endMs":"1570903943409","waitMsMax":"11","startMs":"1570903943244","waitRatioMax":0.010617760617760617,"readRatioAvg":0.006756756756756757,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.008687258687258687,"writeMsAvg":"148","status":"COMPLETE","writeMsMax":"148","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.14285714285714285,"readMsAvg":"7","waitRatioAvg":0.010617760617760617,"completedParallelInputs":"1","computeRatioMax":0.008687258687258687,"name":"S04: Input","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.006756756756756757,"steps":[{"kind":"READ","substeps":["$60:d_month_seq, $61:d_year, $62:d_moy","FROM date_dim","WHERE and(equal($61, 2000), equal($62, 5))"]},{"kind":"AGGREGATE","substeps":["GROUP BY $260 := $200"]},{"kind":"COMPUTE","substeps":["$200 := add($60, 3)"]},{"kind":"WRITE","substeps":["$260","TO __stage04_output","BY HASH($260)"]}],"writeRatioAvg":0.14285714285714285},{"readMsMax":"8","computeMsMax":"9","waitMsAvg":"11","id":"5","endMs":"1570903943376","waitMsMax":"11","startMs":"1570903943324","waitRatioMax":0.010617760617760617,"readRatioAvg":0.007722007722007722,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.008687258687258687,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.017374517374517374,"readMsAvg":"8","waitRatioAvg":0.010617760617760617,"completedParallelInputs":"1","computeRatioMax":0.008687258687258687,"name":"S05: Input","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.007722007722007722,"steps":[{"kind":"READ","substeps":["$40:d_month_seq, $41:d_year, $42:d_moy","FROM date_dim","WHERE and(equal($41, 2000), equal($42, 5))"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $190"]},{"kind":"COMPUTE","substeps":["$190 := add($40, 1)"]},{"kind":"WRITE","substeps":["$230","TO __stage05_output","BY HASH($230)"]}],"writeRatioAvg":0.017374517374517374},{"readMsMax":"0","computeMsMax":"3","inputStages":["5"],"waitMsAvg":"1","id":"8","endMs":"1570903943584","waitMsMax":"1","startMs":"1570903943390","waitRatioMax":0.0009652509652509653,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.0028957528957528956,"writeMsAvg":"185","status":"COMPLETE","writeMsMax":"185","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.17857142857142858,"readMsAvg":"0","waitRatioAvg":0.0009652509652509653,"completedParallelInputs":"1","computeRatioMax":0.0028957528957528956,"name":"S08: Aggregate+","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$230","FROM __stage05_output"]},{"kind":"LIMIT","substeps":["2"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230"]},{"kind":"WRITE","substeps":["$240","TO __stage08_output"]}],"writeRatioAvg":0.17857142857142858},{"readMsMax":"0","computeMsMax":"3","inputStages":["8"],"waitMsAvg":"2","id":"9","endMs":"1570903943595","waitMsMax":"2","startMs":"1570903943392","waitRatioMax":0.0019305019305019305,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.0028957528957528956,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004826254826254826,"readMsAvg":"0","waitRatioAvg":0.0019305019305019305,"completedParallelInputs":"1","computeRatioMax":0.0028957528957528956,"name":"S09: Aggregate","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$240","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["$170 := ANY_AND_CHECK($240)"]},{"kind":"WRITE","substeps":["$170","TO __stage09_output"]}],"writeRatioAvg":0.004826254826254826},{"readMsMax":"0","computeMsMax":"4","inputStages":["4"],"waitMsAvg":"1","id":"10","endMs":"1570903943728","waitMsMax":"1","startMs":"1570903943426","waitRatioMax":0.0009652509652509653,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.003861003861003861,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003861003861003861,"readMsAvg":"0","waitRatioAvg":0.0009652509652509653,"completedParallelInputs":"1","computeRatioMax":0.003861003861003861,"name":"S0A: Aggregate+","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$260","FROM __stage04_output"]},{"kind":"LIMIT","substeps":["2"]},{"kind":"AGGREGATE","substeps":["GROUP BY $270 := $260"]},{"kind":"WRITE","substeps":["$270","TO __stage0A_output"]}],"writeRatioAvg":0.003861003861003861},{"readMsMax":"0","computeMsMax":"5","inputStages":["10"],"waitMsAvg":"4","id":"11","endMs":"1570903943755","waitMsMax":"4","startMs":"1570903943429","waitRatioMax":0.003861003861003861,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.004826254826254826,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003861003861003861,"readMsAvg":"0","waitRatioAvg":0.003861003861003861,"completedParallelInputs":"1","computeRatioMax":0.004826254826254826,"name":"S0B: Aggregate","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$270","FROM __stage0A_output"]},{"kind":"AGGREGATE","substeps":["$180 := ANY_AND_CHECK($270)"]},{"kind":"WRITE","substeps":["$180","TO __stage0B_output"]}],"writeRatioAvg":0.003861003861003861},{"readMsMax":"40","computeMsMax":"772","inputStages":["0","1","2"],"waitMsAvg":"3","id":"12","endMs":"1570903944039","waitMsMax":"3","startMs":"1570903943545","waitRatioMax":0.0028957528957528956,"readRatioAvg":0.025096525096525095,"parallelInputs":"2","recordsRead":"2358471","computeRatioAvg":0.49324324324324326,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"511","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004826254826254826,"readMsAvg":"26","waitRatioAvg":0.0028957528957528956,"completedParallelInputs":"2","computeRatioMax":0.7451737451737451,"name":"S0C: Join+","shuffleOutputBytes":"2268","recordsWritten":"126","readRatioMax":0.03861003861003861,"steps":[{"kind":"READ","substeps":["$80:cs_sold_date_sk, $81:cs_bill_customer_sk, $82:cs_item_sk","FROM catalog_sales"]},{"kind":"READ","substeps":["$90:ws_sold_date_sk, $91:ws_item_sk, $92:ws_bill_customer_sk","FROM web_sales"]},{"kind":"READ","substeps":["$100","FROM __stage02_output"]},{"kind":"READ","substeps":["$70","FROM __stage01_output"]},{"kind":"READ","substeps":["$50, $51","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $320 := $310, $321 := $311"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $300 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $290 = $70"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $212 = $100"]},{"kind":"WRITE","substeps":["$320, $321","TO __stage0C_output","BY HASH($320, $321)"]}],"writeRatioAvg":0.003861003861003861},{"readMsMax":"9","computeMsMax":"20","waitMsAvg":"2","id":"13","endMs":"1570903944185","waitMsMax":"2","startMs":"1570903944121","waitRatioMax":0.0019305019305019305,"readRatioAvg":0.008687258687258687,"parallelInputs":"1","recordsRead":"73051","computeRatioAvg":0.019305019305019305,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"20","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009652509652509652,"readMsAvg":"9","waitRatioAvg":0.0019305019305019305,"completedParallelInputs":"1","computeRatioMax":0.019305019305019305,"name":"S0D: Input","shuffleOutputBytes":"828","recordsWritten":"92","readRatioMax":0.008687258687258687,"steps":[{"kind":"READ","substeps":["$180","FROM __stage0B_output"]},{"kind":"READ","substeps":["$170","FROM __stage09_output"]},{"kind":"READ","substeps":["$10:d_date_sk, $11:d_month_seq","FROM date_dim"]},{"kind":"FILTER","substeps":["between($11, $170, $180)"]},{"kind":"WRITE","substeps":["$10","TO __stage0D_output","BY HASH($10)"]}],"writeRatioAvg":0.009652509652509652},{"readMsMax":"7","computeMsMax":"15","waitMsAvg":"1","id":"14","endMs":"1570903944218","waitMsMax":"1","startMs":"1570903944141","waitRatioMax":0.0009652509652509653,"readRatioAvg":0.006756756756756757,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.01447876447876448,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"15","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009652509652509652,"readMsAvg":"7","waitRatioAvg":0.0009652509652509653,"completedParallelInputs":"1","computeRatioMax":0.01447876447876448,"name":"S0E: Input","shuffleOutputBytes":"348","recordsWritten":"12","readRatioMax":0.006756756756756757,"steps":[{"kind":"READ","substeps":["$1:s_county, $2:s_state","FROM store"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage0E_output","BY HASH($1, $2)"]}],"writeRatioAvg":0.009652509652509652},{"readMsMax":"20","computeMsMax":"59","waitMsAvg":"1","id":"15","endMs":"1570903944222","waitMsMax":"1","startMs":"1570903944157","waitRatioMax":0.0009652509652509653,"readRatioAvg":0.019305019305019305,"parallelInputs":"1","recordsRead":"50000","computeRatioAvg":0.05694980694980695,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"59","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007722007722007722,"readMsAvg":"20","waitRatioAvg":0.0009652509652509653,"completedParallelInputs":"1","computeRatioMax":0.05694980694980695,"name":"S0F: Input","shuffleOutputBytes":"1712215","recordsWritten":"50000","readRatioMax":0.019305019305019305,"steps":[{"kind":"READ","substeps":["$20:ca_address_sk, $21:ca_county, $22:ca_state","FROM customer_address"]},{"kind":"WRITE","substeps":["$20, $21, $22","TO __stage0F_output","BY HASH($20)"]}],"writeRatioAvg":0.007722007722007722},{"readMsMax":"0","computeMsMax":"8","inputStages":["12"],"waitMsAvg":"1","id":"17","endMs":"1570903944375","waitMsMax":"1","startMs":"1570903944193","waitRatioMax":0.0009652509652509653,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"126","computeRatioAvg":0.007722007722007722,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.023166023166023165,"readMsAvg":"0","waitRatioAvg":0.0009652509652509653,"completedParallelInputs":"1","computeRatioMax":0.007722007722007722,"name":"S11: Aggregate","shuffleOutputBytes":"2268","recordsWritten":"126","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$320, $321","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $330 := $320, $331 := $321"]},{"kind":"WRITE","substeps":["$330, $331","TO __stage11_output","BY HASH($330)"]}],"writeRatioAvg":0.023166023166023165},{"readMsMax":"0","computeMsMax":"9","inputStages":["17"],"waitMsAvg":"3","id":"18","endMs":"1570903944694","waitMsMax":"24","startMs":"1570903944419","waitRatioMax":0.023166023166023165,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"126","computeRatioAvg":0.004826254826254826,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"59","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05694980694980695,"readMsAvg":"0","waitRatioAvg":0.0028957528957528956,"completedParallelInputs":"100","computeRatioMax":0.008687258687258687,"name":"S12: Coalesce","shuffleOutputBytes":"2268","recordsWritten":"126","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage11_output"]}],"writeRatioAvg":0.026061776061776062},{"readMsMax":"0","computeMsMax":"9","inputStages":["13"],"waitMsAvg":"22","id":"19","endMs":"1570903944679","waitMsMax":"27","startMs":"1570903944419","waitRatioMax":0.026061776061776062,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"92","computeRatioAvg":0.005791505791505791,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"59","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05694980694980695,"readMsAvg":"0","waitRatioAvg":0.021235521235521235,"completedParallelInputs":"100","computeRatioMax":0.008687258687258687,"name":"S13: Coalesce","shuffleOutputBytes":"828","recordsWritten":"92","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0D_output"]}],"writeRatioAvg":0.009652509652509652},{"readMsMax":"25","computeMsMax":"1036","inputStages":["9","18","14","11","19","15"],"waitMsAvg":"1","id":"20","endMs":"1570903945271","waitMsMax":"1","startMs":"1570903944448","waitRatioMax":0.0009652509652509653,"readRatioAvg":0.02413127413127413,"parallelInputs":"1","recordsRead":"2931318","computeRatioAvg":1,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"3","computeMsAvg":"1036","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0028957528957528956,"readMsAvg":"25","waitRatioAvg":0.0009652509652509653,"completedParallelInputs":"1","computeRatioMax":1,"name":"S14: Join+","shuffleOutputBytes":"0","recordsWritten":"0","readRatioMax":0.02413127413127413,"steps":[{"kind":"READ","substeps":["$170","FROM __stage09_output"]},{"kind":"READ","substeps":["$180","FROM __stage0B_output"]},{"kind":"READ","substeps":["$30:ss_sold_date_sk, $31:ss_customer_sk, $32:ss_ext_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$330, $331","FROM __stage12_output"]},{"kind":"READ","substeps":["$20, $21, $22","FROM __stage0F_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage0E_output"]},{"kind":"READ","substeps":["$10","FROM __stage13_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $380 := $371","$160 := SUM($370)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $360 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $353 = $1, $354 = $2"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $341 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $31 = $330"]},{"kind":"WRITE","substeps":["$380, $160","TO __stage14_output","BY HASH($380)"]}],"writeRatioAvg":0.0028957528957528956},{"readMsMax":"0","computeMsMax":"4","inputStages":["20"],"waitMsAvg":"1","id":"21","endMs":"1570903945405","waitMsMax":"1","startMs":"1570903945353","waitRatioMax":0.0009652509652509653,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"0","computeRatioAvg":0.003861003861003861,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.026061776061776062,"readMsAvg":"0","waitRatioAvg":0.0009652509652509653,"completedParallelInputs":"1","computeRatioMax":0.003861003861003861,"name":"S15: Aggregate+","shuffleOutputBytes":"0","recordsWritten":"0","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$380, $160","FROM __stage14_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $400 := $140","$130 := COUNT_STAR()"]},{"kind":"COMPUTE","substeps":["$140 := floor(divide($150, 50))"]},{"kind":"AGGREGATE","substeps":["GROUP BY $390 := $380","$150 := SUM($160)"]},{"kind":"WRITE","substeps":["$130, $400","TO __stage15_output","BY HASH($400)"]}],"writeRatioAvg":0.026061776061776062},{"readMsMax":"0","computeMsMax":"3","inputStages":["21"],"waitMsAvg":"1","id":"22","endMs":"1570903945598","waitMsMax":"1","startMs":"1570903945425","waitRatioMax":0.0009652509652509653,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"0","computeRatioAvg":0.0028957528957528956,"writeMsAvg":"163","status":"COMPLETE","writeMsMax":"163","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.15733590733590733,"readMsAvg":"0","waitRatioAvg":0.0009652509652509653,"completedParallelInputs":"1","computeRatioMax":0.0028957528957528956,"name":"S16: Sort+","shuffleOutputBytes":"0","recordsWritten":"0","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$130, $400","FROM __stage15_output"]},{"kind":"COMPUTE","substeps":["$110 := multiply($421, 50)"]},{"kind":"SORT","substeps":["$410 ASC, $120 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $410 := $400","$120 := SUM_OF_COUNTS($130)"]},{"kind":"WRITE","substeps":["$110, $420, $421","TO __stage16_output"]}],"writeRatioAvg":0.15733590733590733},{"readMsMax":"0","computeMsMax":"5","inputStages":["22"],"waitMsAvg":"1","id":"23","endMs":"1570903945618","waitMsMax":"1","startMs":"1570903945508","waitRatioMax":0.0009652509652509653,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"0","computeRatioAvg":0.004826254826254826,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"3","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0028957528957528956,"readMsAvg":"0","waitRatioAvg":0.0009652509652509653,"completedParallelInputs":"1","computeRatioMax":0.004826254826254826,"name":"S17: Output","shuffleOutputBytes":"0","recordsWritten":"0","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110, $420, $421","FROM __stage16_output"]},{"kind":"SORT","substeps":["$421 ASC, $420 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$430, $431, $432","TO __stage17_output"]}],"writeRatioAvg":0.0028957528957528956}],"estimatedBytesProcessed":"123487845","timeline":[{"totalSlotMs":"1936","activeUnits":"6","completedUnits":"5","elapsedMs":"701","pendingUnits":"6"},{"totalSlotMs":"19943","activeUnits":"100","completedUnits":"122","elapsedMs":"1767","pendingUnits":"94"},{"totalSlotMs":"36536","activeUnits":"1","completedUnits":"219","elapsedMs":"2942","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"123731968","totalPartitionsProcessed":"0","totalBytesProcessed":"123487845","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_1"}]},"endTime":"1570903945907"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query54_1570903940"},"etag":"/B/98MOEAPl6dqfRfbaAVg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query54_1570903940?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anond0c900884f641beef3b9f8678493308bb1ed54fb","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query54\nWITH my_customers \n AS (SELECT DISTINCT c_customer_sk, \n c_current_addr_sk \n FROM (SELECT cs_sold_date_sk sold_date_sk, \n cs_bill_customer_sk customer_sk, \n cs_item_sk item_sk \n FROM catalog_sales \n UNION ALL \n SELECT ws_sold_date_sk sold_date_sk, \n ws_bill_customer_sk customer_sk, \n ws_item_sk item_sk \n FROM web_sales) cs_or_ws_sales, \n item, \n date_dim, \n customer \n WHERE sold_date_sk = d_date_sk \n AND item_sk = i_item_sk \n AND i_category = 'Sports' \n AND i_class = 'fitness' \n AND c_customer_sk = cs_or_ws_sales.customer_sk \n AND d_moy = 5 \n AND d_year = 2000), \n my_revenue \n AS (SELECT c_customer_sk, \n Sum(ss_ext_sales_price) AS revenue \n FROM my_customers, \n store_sales, \n customer_address, \n store, \n date_dim \n WHERE c_current_addr_sk = ca_address_sk \n AND ca_county = s_county \n AND ca_state = s_state \n AND ss_sold_date_sk = d_date_sk \n AND c_customer_sk = ss_customer_sk \n AND d_month_seq BETWEEN (SELECT DISTINCT d_month_seq + 1 \n FROM date_dim \n WHERE d_year = 2000 \n AND d_moy = 5) AND \n (SELECT DISTINCT \n d_month_seq + 3 \n FROM date_dim \n WHERE d_year = 2000 \n AND d_moy = 5) \n GROUP BY c_customer_sk), \n segments \n AS (SELECT Floor(revenue / 50) AS segment \n FROM my_revenue) \nSELECT segment, \n Count(*) AS num_customers, \n segment benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup 50 AS segment_base \nFROM segments \nGROUP BY segment \nORDER BY segment, \n num_customers\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query54_1570903940","user_email":"nithish.sankaranarayanan@ulb.be"}
