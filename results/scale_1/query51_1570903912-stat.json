{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"14663","creationTime":"1570903915313","totalBytesProcessed":"86416940","startTime":"1570903915534","query":{"totalSlotMs":"14663","queryPlan":[{"readMsMax":"14","computeMsMax":"11","waitMsAvg":"1","id":"0","endMs":"1570903915897","waitMsMax":"1","startMs":"1570903915806","waitRatioMax":0.00035285815102328866,"readRatioAvg":0.004940014114326041,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0038814396612561752,"writeMsAvg":"52","status":"COMPLETE","writeMsMax":"52","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01834862385321101,"readMsAvg":"14","waitRatioAvg":0.00035285815102328866,"completedParallelInputs":"1","computeRatioMax":0.0038814396612561752,"name":"S00: Input","shuffleOutputBytes":"8784","recordsWritten":"366","readRatioMax":0.004940014114326041,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_date, $32:d_month_seq","FROM date_dim","WHERE between($32, 1192, 1203)"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage00_output","BY HASH($30)"]}],"writeRatioAvg":0.01834862385321101},{"readMsMax":"12","computeMsMax":"11","waitMsAvg":"54","id":"2","endMs":"1570903916100","waitMsMax":"54","startMs":"1570903915891","waitRatioMax":0.019054340155257588,"readRatioAvg":0.004234297812279464,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0038814396612561752,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007057163020465773,"readMsAvg":"12","waitRatioAvg":0.019054340155257588,"completedParallelInputs":"1","computeRatioMax":0.0038814396612561752,"name":"S02: Input","shuffleOutputBytes":"8784","recordsWritten":"366","readRatioMax":0.004234297812279464,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $11:d_date, $12:d_month_seq","FROM date_dim","WHERE between($12, 1192, 1203)"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage02_output","BY HASH($10)"]}],"writeRatioAvg":0.007057163020465773},{"readMsMax":"28","computeMsMax":"2834","inputStages":["0"],"waitMsAvg":"13","id":"4","endMs":"1570903917417","waitMsMax":"13","startMs":"1570903915934","waitRatioMax":0.0045871559633027525,"readRatioAvg":0.009880028228652082,"parallelInputs":"1","recordsRead":"2881544","computeRatioAvg":1,"writeMsAvg":"44","status":"COMPLETE","writeMsMax":"44","computeMsAvg":"2834","shuffleOutputBytesSpilled":"0","writeRatioMax":0.015525758645024701,"readMsAvg":"28","waitRatioAvg":0.0045871559633027525,"completedParallelInputs":"1","computeRatioMax":1,"name":"S04: Join+","shuffleOutputBytes":"16373246","recordsWritten":"498758","readRatioMax":0.009880028228652082,"steps":[{"kind":"READ","substeps":["$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_sales_price","FROM store_sales","WHERE not(is_null($21))"]},{"kind":"READ","substeps":["$30, $31","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $170, $181 := $172","$110 := SUM($171)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $30"]},{"kind":"WRITE","substeps":["$180, $181, $110","TO __stage04_output","BY HASH($180, $181)"]}],"writeRatioAvg":0.015525758645024701},{"readMsMax":"24","computeMsMax":"490","inputStages":["2"],"waitMsAvg":"0","id":"5","endMs":"1570903916505","waitMsMax":"0","startMs":"1570903916159","waitRatioMax":0,"readRatioAvg":0.008468595624558928,"parallelInputs":"1","recordsRead":"721125","computeRatioAvg":0.17290049400141144,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"25","computeMsAvg":"490","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008821453775582216,"readMsAvg":"24","waitRatioAvg":0,"completedParallelInputs":"1","computeRatioMax":0.17290049400141144,"name":"S05: Join+","shuffleOutputBytes":"4602324","recordsWritten":"139468","readRatioMax":0.008468595624558928,"steps":[{"kind":"READ","substeps":["$1:ws_sold_date_sk, $2:ws_item_sk, $3:ws_sales_price","FROM web_sales","WHERE not(is_null($2))"]},{"kind":"READ","substeps":["$10, $11","FROM __stage02_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $130 := $120, $131 := $122","$100 := SUM($121)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $10"]},{"kind":"WRITE","substeps":["$130, $131, $100","TO __stage05_output","BY HASH($130, $131)"]}],"writeRatioAvg":0.008821453775582216},{"readMsMax":"0","computeMsMax":"242","inputStages":["5"],"waitMsAvg":"1","id":"6","endMs":"1570903916868","waitMsMax":"1","startMs":"1570903916659","waitRatioMax":0.00035285815102328866,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"139468","computeRatioAvg":0.08539167254763586,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"25","computeMsAvg":"242","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008821453775582216,"readMsAvg":"0","waitRatioAvg":0.00035285815102328866,"completedParallelInputs":"1","computeRatioMax":0.08539167254763586,"name":"S06: Aggregate","shuffleOutputBytes":"4602324","recordsWritten":"139468","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$130, $131, $100","FROM __stage05_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $140 := $130, $141 := $131","$80 := SUM($100)"]},{"kind":"WRITE","substeps":["$140, $141, $80","TO __stage06_output","BY HASH($140)"]}],"writeRatioAvg":0.008821453775582216},{"readMsMax":"0","computeMsMax":"1122","inputStages":["4"],"waitMsAvg":"1","id":"7","endMs":"1570903918237","waitMsMax":"1","startMs":"1570903917567","waitRatioMax":0.00035285815102328866,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"498758","computeRatioAvg":0.3959068454481299,"writeMsAvg":"38","status":"COMPLETE","writeMsMax":"38","computeMsAvg":"1122","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013408609738884969,"readMsAvg":"0","waitRatioAvg":0.00035285815102328866,"completedParallelInputs":"1","computeRatioMax":0.3959068454481299,"name":"S07: Aggregate","shuffleOutputBytes":"16373246","recordsWritten":"498758","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$180, $181, $110","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $180, $191 := $181","$90 := SUM($110)"]},{"kind":"WRITE","substeps":["$190, $191, $90","TO __stage07_output","BY HASH($190)"]}],"writeRatioAvg":0.013408609738884969},{"readMsMax":"0","computeMsMax":"1945","inputStages":["7"],"waitMsAvg":"1","id":"8","endMs":"1570903919547","waitMsMax":"1","startMs":"1570903918453","waitRatioMax":0.00035285815102328866,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"498758","computeRatioAvg":0.6863091037402964,"writeMsAvg":"38","status":"COMPLETE","writeMsMax":"38","computeMsAvg":"1945","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013408609738884969,"readMsAvg":"0","waitRatioAvg":0.00035285815102328866,"completedParallelInputs":"1","computeRatioMax":0.6863091037402964,"name":"S08: Sort+","shuffleOutputBytes":"16456750","recordsWritten":"498758","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$190, $191, $90","FROM __stage07_output"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$70 := SUM($202) OVER (PARTITION BY $200 ORDER BY $201 ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)"]},{"kind":"SORT","substeps":["$190 ASC, $191 ASC"]},{"kind":"WRITE","substeps":["$70, $210, $211","TO __stage08_output","BY HASH($210, $211)"]}],"writeRatioAvg":0.013408609738884969},{"readMsMax":"0","computeMsMax":"426","inputStages":["6"],"waitMsAvg":"1","id":"9","endMs":"1570903918855","waitMsMax":"1","startMs":"1570903918549","waitRatioMax":0.00035285815102328866,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"139468","computeRatioAvg":0.15031757233592097,"writeMsAvg":"82","status":"COMPLETE","writeMsMax":"82","computeMsAvg":"426","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02893436838390967,"readMsAvg":"0","waitRatioAvg":0.00035285815102328866,"completedParallelInputs":"1","computeRatioMax":0.15031757233592097,"name":"S09: Sort+","shuffleOutputBytes":"4602444","recordsWritten":"139468","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$140, $141, $80","FROM __stage06_output"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$60 := SUM($152) OVER (PARTITION BY $150 ORDER BY $151 ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)"]},{"kind":"SORT","substeps":["$140 ASC, $141 ASC"]},{"kind":"WRITE","substeps":["$60, $160, $161","TO __stage09_output","BY HASH($160, $161)"]}],"writeRatioAvg":0.02893436838390967},{"readMsMax":"0","computeMsMax":"23","inputStages":["8","9"],"waitMsAvg":"2","id":"10","endMs":"1570903919832","waitMsMax":"5","startMs":"1570903919731","waitRatioMax":0.0017642907551164433,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"638226","computeRatioAvg":0.006351446718419196,"writeMsAvg":"30","status":"COMPLETE","writeMsMax":"46","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.016231474947071278,"readMsAvg":"0","waitRatioAvg":0.0007057163020465773,"completedParallelInputs":"100","computeRatioMax":0.008115737473535639,"name":"S0A: Join+","shuffleOutputBytes":"21009772","recordsWritten":"611778","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$60, $160, $161","FROM __stage09_output"]},{"kind":"READ","substeps":["$70, $210, $211","FROM __stage08_output"]},{"kind":"COMPUTE","substeps":["$50 := case_no_value(not(is_null($220)), $220, $223)","$51 := case_no_value(not(is_null($221)), $221, $224)"]},{"kind":"JOIN","substeps":["FULL OUTER HASH JOIN EACH WITH EACH ON $160 = $210, $161 = $211"]},{"kind":"WRITE","substeps":["$50, $51, $222, $225","TO __stage0A_output","BY HASH($50)"]}],"writeRatioAvg":0.01058574453069866},{"readMsMax":"0","computeMsMax":"772","inputStages":["10"],"waitMsAvg":"1","id":"11","endMs":"1570903921029","waitMsMax":"1","startMs":"1570903919845","waitRatioMax":0.00035285815102328866,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"611778","computeRatioAvg":0.27240649258997884,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"772","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0017642907551164433,"readMsAvg":"0","waitRatioAvg":0.00035285815102328866,"completedParallelInputs":"1","computeRatioMax":0.27240649258997884,"name":"S0B: Sort+","shuffleOutputBytes":"5216","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$50, $51, $222, $225","FROM __stage0A_output"]},{"kind":"SORT","substeps":["$240 ASC, $241 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["greater($40, $41)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$40 := MAX($232) OVER (PARTITION BY $230 ORDER BY $231 ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)","$41 := MAX($233) OVER (PARTITION BY $230 ORDER BY $231 ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)"]},{"kind":"SORT","substeps":["$50 ASC, $51 ASC"]},{"kind":"WRITE","substeps":["$250, $251, $252, $253, $254, $255","TO __stage0B_output"]}],"writeRatioAvg":0.0017642907551164433},{"readMsMax":"0","computeMsMax":"5","inputStages":["11"],"waitMsAvg":"3","id":"12","endMs":"1570903921349","waitMsMax":"3","startMs":"1570903919865","waitRatioMax":0.001058574453069866,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0017642907551164433,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002117148906139732,"readMsAvg":"0","waitRatioAvg":0.001058574453069866,"completedParallelInputs":"1","computeRatioMax":0.0017642907551164433,"name":"S0C: Output","shuffleOutputBytes":"5216","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$250, $251, $252, $253, $254, $255","FROM __stage0B_output"]},{"kind":"SORT","substeps":["$252 ASC, $253 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$260, $261, $262, $263, $264, $265","TO __stage0C_output"]}],"writeRatioAvg":0.002117148906139732}],"estimatedBytesProcessed":"86416940","timeline":[{"totalSlotMs":"767","activeUnits":"2","completedUnits":"2","elapsedMs":"773","pendingUnits":"2"},{"totalSlotMs":"3012","activeUnits":"1","completedUnits":"5","elapsedMs":"2385","pendingUnits":"1"},{"totalSlotMs":"5612","activeUnits":"2","completedUnits":"7","elapsedMs":"3824","pendingUnits":"1"},{"totalSlotMs":"11747","activeUnits":"2","completedUnits":"108","elapsedMs":"4517","pendingUnits":"2"},{"totalSlotMs":"14663","activeUnits":"0","completedUnits":"110","elapsedMs":"6312","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"87031808","totalPartitionsProcessed":"0","totalBytesProcessed":"86416940","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_1"}]},"endTime":"1570903921888"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query51_1570903912"},"etag":"q0h8FK3jUEITFLdtQrITFg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query51_1570903912?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anond489f9fc439b5799b70a39fc0a2003b08eb168fe","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query51\nWITH web_v1 AS \n( \n SELECT ws_item_sk item_sk, \n d_date, \n sum(Sum(ws_sales_price)) OVER (partition BY ws_item_sk ORDER BY d_date rows BETWEEN UNBOUNDED PRECEDING AND CURRENT row) cume_sales\n FROM web_sales , \n date_dim \n WHERE ws_sold_date_sk=d_date_sk \n AND d_month_seq BETWEEN 1192 AND 1192+11 \n AND ws_item_sk IS NOT NULL \n GROUP BY ws_item_sk, \n d_date), store_v1 AS \n( \n SELECT ss_item_sk item_sk, \n d_date, \n sum(sum(ss_sales_price)) OVER (partition BY ss_item_sk ORDER BY d_date rows BETWEEN UNBOUNDED PRECEDING AND CURRENT row) cume_sales\n FROM store_sales , \n date_dim \n WHERE ss_sold_date_sk=d_date_sk \n AND d_month_seq BETWEEN 1192 AND 1192+11 \n AND ss_item_sk IS NOT NULL \n GROUP BY ss_item_sk, \n d_date) \nSELECT \n benchmark.sh bootstrap.sh data_gen.sh dsdgen dsqgen load_data.sh query Readme.md results tcp-ds-dsdgen tpcds.idx warmup \nFROM ( \n SELECT item_sk , \n d_date , \n web_sales , \n store_sales , \n max(web_sales) OVER (partition BY item_sk ORDER BY d_date rows BETWEEN UNBOUNDED PRECEDING AND CURRENT row) web_cumulative ,\n max(store_sales) OVER (partition BY item_sk ORDER BY d_date rows BETWEEN UNBOUNDED PRECEDING AND CURRENT row) store_cumulative\n FROM ( \n SELECT \n CASE \n WHEN web.item_sk IS NOT NULL THEN web.item_sk\n ELSE store.item_sk \n END item_sk , \n CASE \n WHEN web.d_date IS NOT NULL THEN web.d_date\n ELSE store.d_date \n END d_date , \n web.cume_sales web_sales , \n store.cume_sales store_sales \n FROM web_v1 web \n FULL OUTER JOIN store_v1 store \n ON ( \n web.item_sk = store.item_sk\n AND web.d_date = store.d_date) )x )y\nWHERE web_cumulative > store_cumulative \nORDER BY item_sk , \n d_date \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query51_1570903912","user_email":"nithish.sankaranarayanan@ulb.be"}
