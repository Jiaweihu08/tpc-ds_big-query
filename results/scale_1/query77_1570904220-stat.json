{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"64770","creationTime":"1570904222151","totalBytesProcessed":"174032140","startTime":"1570904222361","query":{"totalSlotMs":"64770","queryPlan":[{"readMsMax":"31","computeMsMax":"8","waitMsAvg":"1","id":"0","endMs":"1570904222715","waitMsMax":"1","startMs":"1570904222599","waitRatioMax":0.0005885815185403178,"readRatioAvg":0.018246027074749854,"parallelInputs":"1","recordsRead":"60","computeRatioAvg":0.004708652148322542,"writeMsAvg":"62","status":"COMPLETE","writeMsMax":"62","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03649205414949971,"readMsAvg":"31","waitRatioAvg":0.0005885815185403178,"completedParallelInputs":"1","computeRatioMax":0.004708652148322542,"name":"S00: Input","shuffleOutputBytes":"540","recordsWritten":"60","readRatioMax":0.018246027074749854,"steps":[{"kind":"READ","substeps":["$50:wp_web_page_sk","FROM web_page"]},{"kind":"WRITE","substeps":["$50","TO __stage00_output","BY HASH($50)"]}],"writeRatioAvg":0.03649205414949971},{"readMsMax":"12","computeMsMax":"21","waitMsAvg":"1","id":"1","endMs":"1570904222751","waitMsMax":"1","startMs":"1570904222669","waitRatioMax":0.0005885815185403178,"readRatioAvg":0.007062978222483814,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.012360211889346674,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"21","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005885815185403178,"readMsAvg":"12","waitRatioAvg":0.0005885815185403178,"completedParallelInputs":"1","computeRatioMax":0.012360211889346674,"name":"S01: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.007062978222483814,"steps":[{"kind":"READ","substeps":["$150:d_date_sk, $151:d_date","FROM date_dim","WHERE between(CAST($151 AS DATE), 11550, 11580)"]},{"kind":"WRITE","substeps":["$150","TO __stage01_output","BY HASH($150)"]}],"writeRatioAvg":0.005885815185403178},{"readMsMax":"5","computeMsMax":"8","waitMsAvg":"30","id":"3","endMs":"1570904222978","waitMsMax":"30","startMs":"1570904222751","waitRatioMax":0.017657445556209534,"readRatioAvg":0.002942907592701589,"parallelInputs":"1","recordsRead":"60","computeRatioAvg":0.004708652148322542,"writeMsAvg":"47","status":"COMPLETE","writeMsMax":"47","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02766333137139494,"readMsAvg":"5","waitRatioAvg":0.017657445556209534,"completedParallelInputs":"1","computeRatioMax":0.004708652148322542,"name":"S03: Input","shuffleOutputBytes":"540","recordsWritten":"60","readRatioMax":0.002942907592701589,"steps":[{"kind":"READ","substeps":["$40:wp_web_page_sk","FROM web_page"]},{"kind":"WRITE","substeps":["$40","TO __stage03_output","BY HASH($40)"]}],"writeRatioAvg":0.02766333137139494},{"readMsMax":"11","computeMsMax":"25","waitMsAvg":"14","id":"4","endMs":"1570904222981","waitMsMax":"14","startMs":"1570904222755","waitRatioMax":0.00824014125956445,"readRatioAvg":0.006474396703943496,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.014714537963507945,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"12","computeMsAvg":"25","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007062978222483814,"readMsAvg":"11","waitRatioAvg":0.00824014125956445,"completedParallelInputs":"1","computeRatioMax":0.014714537963507945,"name":"S04: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.006474396703943496,"steps":[{"kind":"READ","substeps":["$140:d_date_sk, $141:d_date","FROM date_dim","WHERE between(CAST($141 AS DATE), 11550, 11580)"]},{"kind":"WRITE","substeps":["$140","TO __stage04_output","BY HASH($140)"]}],"writeRatioAvg":0.007062978222483814},{"readMsMax":"8","computeMsMax":"17","waitMsAvg":"1","id":"6","endMs":"1570904222950","waitMsMax":"1","startMs":"1570904222862","waitRatioMax":0.0005885815185403178,"readRatioAvg":0.004708652148322542,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.010005885815185403,"writeMsAvg":"15","status":"COMPLETE","writeMsMax":"15","computeMsAvg":"17","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008828722778104767,"readMsAvg":"8","waitRatioAvg":0.0005885815185403178,"completedParallelInputs":"1","computeRatioMax":0.010005885815185403,"name":"S06: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.004708652148322542,"steps":[{"kind":"READ","substeps":["$90:d_date_sk, $91:d_date","FROM date_dim","WHERE between(CAST($91 AS DATE), 11550, 11580)"]},{"kind":"WRITE","substeps":["$90","TO __stage06_output","BY HASH($90)"]}],"writeRatioAvg":0.008828722778104767},{"readMsMax":"13","computeMsMax":"20","waitMsAvg":"2","id":"8","endMs":"1570904223079","waitMsMax":"2","startMs":"1570904222917","waitRatioMax":0.0011771630370806356,"readRatioAvg":0.007651559741024131,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.011771630370806356,"writeMsAvg":"88","status":"COMPLETE","writeMsMax":"88","computeMsAvg":"20","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05179517363154797,"readMsAvg":"13","waitRatioAvg":0.0011771630370806356,"completedParallelInputs":"1","computeRatioMax":0.011771630370806356,"name":"S08: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.007651559741024131,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_date","FROM date_dim","WHERE between(CAST($81 AS DATE), 11550, 11580)"]},{"kind":"WRITE","substeps":["$80","TO __stage08_output","BY HASH($80)"]}],"writeRatioAvg":0.05179517363154797},{"readMsMax":"39","computeMsMax":"6","waitMsAvg":"2","id":"10","endMs":"1570904223099","waitMsMax":"2","startMs":"1570904223029","waitRatioMax":0.0011771630370806356,"readRatioAvg":0.022954679223072396,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.003531489111241907,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004120070629782225,"readMsAvg":"39","waitRatioAvg":0.0011771630370806356,"completedParallelInputs":"1","computeRatioMax":0.003531489111241907,"name":"S0A: Input","shuffleOutputBytes":"108","recordsWritten":"12","readRatioMax":0.022954679223072396,"steps":[{"kind":"READ","substeps":["$10:s_store_sk","FROM store"]},{"kind":"WRITE","substeps":["$10","TO __stage0A_output","BY HASH($10)"]}],"writeRatioAvg":0.004120070629782225},{"readMsMax":"11","computeMsMax":"19","waitMsAvg":"1","id":"11","endMs":"1570904223335","waitMsMax":"1","startMs":"1570904223050","waitRatioMax":0.0005885815185403178,"readRatioAvg":0.006474396703943496,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.011183048852266038,"writeMsAvg":"75","status":"COMPLETE","writeMsMax":"75","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04414361389052384,"readMsAvg":"11","waitRatioAvg":0.0005885815185403178,"completedParallelInputs":"1","computeRatioMax":0.011183048852266038,"name":"S0B: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.006474396703943496,"steps":[{"kind":"READ","substeps":["$130:d_date_sk, $131:d_date","FROM date_dim","WHERE between(CAST($131 AS DATE), 11550, 11580)"]},{"kind":"WRITE","substeps":["$130","TO __stage0B_output","BY HASH($130)"]}],"writeRatioAvg":0.04414361389052384},{"readMsMax":"10","computeMsMax":"10","waitMsAvg":"1","id":"13","endMs":"1570904223253","waitMsMax":"1","startMs":"1570904223106","waitRatioMax":0.0005885815185403178,"readRatioAvg":0.005885815185403178,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.005885815185403178,"writeMsAvg":"109","status":"COMPLETE","writeMsMax":"109","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.06415538552089464,"readMsAvg":"10","waitRatioAvg":0.0005885815185403178,"completedParallelInputs":"1","computeRatioMax":0.005885815185403178,"name":"S0D: Input","shuffleOutputBytes":"108","recordsWritten":"12","readRatioMax":0.005885815185403178,"steps":[{"kind":"READ","substeps":["$1:s_store_sk","FROM store"]},{"kind":"WRITE","substeps":["$1","TO __stage0D_output","BY HASH($1)"]}],"writeRatioAvg":0.06415538552089464},{"readMsMax":"7","computeMsMax":"16","waitMsAvg":"1","id":"14","endMs":"1570904223323","waitMsMax":"1","startMs":"1570904223225","waitRatioMax":0.0005885815185403178,"readRatioAvg":0.004120070629782225,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.009417304296645085,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"26","computeMsAvg":"16","shuffleOutputBytesSpilled":"0","writeRatioMax":0.015303119482048263,"readMsAvg":"7","waitRatioAvg":0.0005885815185403178,"completedParallelInputs":"1","computeRatioMax":0.009417304296645085,"name":"S0E: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.004120070629782225,"steps":[{"kind":"READ","substeps":["$120:d_date_sk, $121:d_date","FROM date_dim","WHERE between(CAST($121 AS DATE), 11550, 11580)"]},{"kind":"WRITE","substeps":["$120","TO __stage0E_output","BY HASH($120)"]}],"writeRatioAvg":0.015303119482048263},{"readMsMax":"33","computeMsMax":"34","inputStages":["0","1"],"waitMsAvg":"1","id":"16","endMs":"1570904223419","waitMsMax":"1","startMs":"1570904223280","waitRatioMax":0.0005885815185403178,"readRatioAvg":0.01942319011183049,"parallelInputs":"1","recordsRead":"72212","computeRatioAvg":0.020011771630370805,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"16","computeMsAvg":"34","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009417304296645085,"readMsAvg":"33","waitRatioAvg":0.0005885815185403178,"completedParallelInputs":"1","computeRatioMax":0.020011771630370805,"name":"S10: Join+","shuffleOutputBytes":"1080","recordsWritten":"40","readRatioMax":0.01942319011183049,"steps":[{"kind":"READ","substeps":["$110:wr_returned_date_sk, $111:wr_web_page_sk, $112:wr_return_amt, $113:wr_net_loss","FROM web_returns"]},{"kind":"READ","substeps":["$150","FROM __stage01_output"]},{"kind":"READ","substeps":["$50","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $560 := $552","$330 := SUM($550)","$331 := SUM($551)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $540 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $110 = $150"]},{"kind":"WRITE","substeps":["$560, $330, $331","TO __stage10_output","BY HASH($560)"]}],"writeRatioAvg":0.009417304296645085},{"readMsMax":"20","computeMsMax":"38","inputStages":["6"],"waitMsAvg":"1","id":"17","endMs":"1570904225058","waitMsMax":"1","startMs":"1570904223308","waitRatioMax":0.0005885815185403178,"readRatioAvg":0.011771630370806356,"parallelInputs":"1","recordsRead":"143899","computeRatioAvg":0.022366097704532076,"writeMsAvg":"1699","status":"COMPLETE","writeMsMax":"1699","computeMsAvg":"38","shuffleOutputBytesSpilled":"0","writeRatioMax":1,"readMsAvg":"20","waitRatioAvg":0.0005885815185403178,"completedParallelInputs":"1","computeRatioMax":0.022366097704532076,"name":"S11: Join+","shuffleOutputBytes":"127","recordsWritten":"5","readRatioMax":0.011771630370806356,"steps":[{"kind":"READ","substeps":["$30:cr_returned_date_sk, $31:cr_call_center_sk, $32:cr_return_amount, $33:cr_net_loss","FROM catalog_returns"]},{"kind":"READ","substeps":["$90","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $470 := $460","$310 := SUM($461)","$311 := SUM($462)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $30 = $90"]},{"kind":"WRITE","substeps":["$470, $310, $311","TO __stage11_output","BY HASH($470)"]}],"writeRatioAvg":1},{"readMsMax":"32","computeMsMax":"216","inputStages":["3","4"],"waitMsAvg":"1","id":"18","endMs":"1570904223606","waitMsMax":"1","startMs":"1570904223419","waitRatioMax":0.0005885815185403178,"readRatioAvg":0.01883460859329017,"parallelInputs":"1","recordsRead":"720850","computeRatioAvg":0.12713360800470866,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"216","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005885815185403178,"readMsAvg":"32","waitRatioAvg":0.0005885815185403178,"completedParallelInputs":"1","computeRatioMax":0.12713360800470866,"name":"S12: Join+","shuffleOutputBytes":"810","recordsWritten":"30","readRatioMax":0.01883460859329017,"steps":[{"kind":"READ","substeps":["$100:ws_sold_date_sk, $101:ws_web_page_sk, $102:ws_ext_sales_price, $103:ws_net_profit","FROM web_sales"]},{"kind":"READ","substeps":["$140","FROM __stage04_output"]},{"kind":"READ","substeps":["$40","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $520 := $512","$320 := SUM($510)","$321 := SUM($511)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $500 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $100 = $140"]},{"kind":"WRITE","substeps":["$520, $320, $321","TO __stage12_output","BY HASH($520)"]}],"writeRatioAvg":0.005885815185403178},{"readMsMax":"33","computeMsMax":"426","inputStages":["8"],"waitMsAvg":"2","id":"19","endMs":"1570904223715","waitMsMax":"2","startMs":"1570904223455","waitRatioMax":0.0011771630370806356,"readRatioAvg":0.01942319011183049,"parallelInputs":"1","recordsRead":"1437473","computeRatioAvg":0.2507357268981754,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"426","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002942907592701589,"readMsAvg":"33","waitRatioAvg":0.0011771630370806356,"completedParallelInputs":"1","computeRatioMax":0.2507357268981754,"name":"S13: Join+","shuffleOutputBytes":"100","recordsWritten":"4","readRatioMax":0.01942319011183049,"steps":[{"kind":"READ","substeps":["$20:cs_sold_date_sk, $21:cs_call_center_sk, $22:cs_ext_sales_price, $23:cs_net_profit","FROM catalog_sales"]},{"kind":"READ","substeps":["$80","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $440 := $430","$300 := SUM($431)","$301 := SUM($432)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $80"]},{"kind":"WRITE","substeps":["$440, $300, $301","TO __stage13_output","BY HASH($440)"]}],"writeRatioAvg":0.002942907592701589},{"readMsMax":"32","computeMsMax":"913","inputStages":["13","14"],"waitMsAvg":"1","id":"20","endMs":"1570904224002","waitMsMax":"1","startMs":"1570904223494","waitRatioMax":0.0005885815185403178,"readRatioAvg":0.01883460859329017,"parallelInputs":"1","recordsRead":"2881221","computeRatioAvg":0.5373749264273102,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"913","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002354326074161271,"readMsAvg":"32","waitRatioAvg":0.0005885815185403178,"completedParallelInputs":"1","computeRatioMax":0.5373749264273102,"name":"S14: Join+","shuffleOutputBytes":"162","recordsWritten":"6","readRatioMax":0.01883460859329017,"steps":[{"kind":"READ","substeps":["$60:ss_sold_date_sk, $61:ss_store_sk, $62:ss_ext_sales_price, $63:ss_net_profit","FROM store_sales"]},{"kind":"READ","substeps":["$120","FROM __stage0E_output"]},{"kind":"READ","substeps":["$1","FROM __stage0D_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $360 := $352","$280 := SUM($350)","$281 := SUM($351)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $340 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $60 = $120"]},{"kind":"WRITE","substeps":["$360, $280, $281","TO __stage14_output","BY HASH($360)"]}],"writeRatioAvg":0.002354326074161271},{"readMsMax":"19","computeMsMax":"115","inputStages":["10","11"],"waitMsAvg":"1","id":"21","endMs":"1570904223619","waitMsMax":"1","startMs":"1570904223523","waitRatioMax":0.0005885815185403178,"readRatioAvg":0.011183048852266038,"parallelInputs":"1","recordsRead":"288159","computeRatioAvg":0.06768687463213655,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"3","computeMsAvg":"115","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0017657445556209534,"readMsAvg":"19","waitRatioAvg":0.0005885815185403178,"completedParallelInputs":"1","computeRatioMax":0.06768687463213655,"name":"S15: Join+","shuffleOutputBytes":"162","recordsWritten":"6","readRatioMax":0.011183048852266038,"steps":[{"kind":"READ","substeps":["$70:sr_returned_date_sk, $71:sr_store_sk, $72:sr_return_amt, $73:sr_net_loss","FROM store_returns"]},{"kind":"READ","substeps":["$130","FROM __stage0B_output"]},{"kind":"READ","substeps":["$10","FROM __stage0A_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $400 := $392","$290 := SUM($390)","$291 := SUM($391)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $380 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $70 = $130"]},{"kind":"WRITE","substeps":["$400, $290, $291","TO __stage15_output","BY HASH($400)"]}],"writeRatioAvg":0.0017657445556209534},{"readMsMax":"0","computeMsMax":"7","inputStages":["16"],"waitMsAvg":"1","id":"22","endMs":"1570904225547","waitMsMax":"1","startMs":"1570904225497","waitRatioMax":0.0005885815185403178,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"40","computeRatioAvg":0.004120070629782225,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"26","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.015303119482048263,"readMsAvg":"0","waitRatioAvg":0.0005885815185403178,"completedParallelInputs":"1","computeRatioMax":0.004120070629782225,"name":"S16: Aggregate","shuffleOutputBytes":"1080","recordsWritten":"40","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$560, $330, $331","FROM __stage10_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $570 := $560","$270 := SUM($330)","$271 := SUM($331)"]},{"kind":"WRITE","substeps":["$270, $271, $570","TO __stage16_output","BY HASH($570)"]}],"writeRatioAvg":0.015303119482048263},{"readMsMax":"0","computeMsMax":"8","inputStages":["17"],"waitMsAvg":"1","id":"23","endMs":"1570904225599","waitMsMax":"1","startMs":"1570904225517","waitRatioMax":0.0005885815185403178,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"5","computeRatioAvg":0.004708652148322542,"writeMsAvg":"14","status":"COMPLETE","writeMsMax":"14","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00824014125956445,"readMsAvg":"0","waitRatioAvg":0.0005885815185403178,"completedParallelInputs":"1","computeRatioMax":0.004708652148322542,"name":"S17: Aggregate","shuffleOutputBytes":"90","recordsWritten":"5","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$470, $310, $311","FROM __stage11_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $480 := $470","$250 := SUM($310)","$251 := SUM($311)"]},{"kind":"WRITE","substeps":["$250, $251","TO __stage17_output"]}],"writeRatioAvg":0.00824014125956445},{"readMsMax":"0","computeMsMax":"8","inputStages":["19"],"waitMsAvg":"1","id":"24","endMs":"1570904225588","waitMsMax":"1","startMs":"1570904225532","waitRatioMax":0.0005885815185403178,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"4","computeRatioAvg":0.004708652148322542,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"26","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.015303119482048263,"readMsAvg":"0","waitRatioAvg":0.0005885815185403178,"completedParallelInputs":"1","computeRatioMax":0.004708652148322542,"name":"S18: Aggregate","shuffleOutputBytes":"100","recordsWritten":"4","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$440, $300, $301","FROM __stage13_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $450 := $440","$240 := SUM($300)","$241 := SUM($301)"]},{"kind":"WRITE","substeps":["$240, $241, $450","TO __stage18_output"]}],"writeRatioAvg":0.015303119482048263},{"readMsMax":"0","computeMsMax":"8","inputStages":["21"],"waitMsAvg":"1","id":"25","endMs":"1570904225633","waitMsMax":"1","startMs":"1570904225548","waitRatioMax":0.0005885815185403178,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"6","computeRatioAvg":0.004708652148322542,"writeMsAvg":"14","status":"COMPLETE","writeMsMax":"14","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00824014125956445,"readMsAvg":"0","waitRatioAvg":0.0005885815185403178,"completedParallelInputs":"1","computeRatioMax":0.004708652148322542,"name":"S19: Aggregate","shuffleOutputBytes":"162","recordsWritten":"6","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$400, $290, $291","FROM __stage15_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $410 := $400","$230 := SUM($290)","$231 := SUM($291)"]},{"kind":"WRITE","substeps":["$230, $231, $410","TO __stage19_output","BY HASH($410)"]}],"writeRatioAvg":0.00824014125956445},{"readMsMax":"0","computeMsMax":"9","inputStages":["22"],"waitMsAvg":"2","id":"26","endMs":"1570904225681","waitMsMax":"5","startMs":"1570904225584","waitRatioMax":0.002942907592701589,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"40","computeRatioAvg":0.002942907592701589,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"73","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0429664508534432,"readMsAvg":"0","waitRatioAvg":0.0011771630370806356,"completedParallelInputs":"100","computeRatioMax":0.00529723366686286,"name":"S1A: Coalesce","shuffleOutputBytes":"1080","recordsWritten":"40","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage16_output"]}],"writeRatioAvg":0.011771630370806356},{"readMsMax":"0","computeMsMax":"9","inputStages":["24"],"waitMsAvg":"1","id":"27","endMs":"1570904225826","waitMsMax":"2","startMs":"1570904225608","waitRatioMax":0.0011771630370806356,"readRatioAvg":0,"parallelInputs":"40","recordsRead":"4","computeRatioAvg":0.002942907592701589,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"85","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.050029429075927015,"readMsAvg":"0","waitRatioAvg":0.0005885815185403178,"completedParallelInputs":"40","computeRatioMax":0.00529723366686286,"name":"S1B: Coalesce","shuffleOutputBytes":"100","recordsWritten":"4","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage18_output"]}],"writeRatioAvg":0.017068864037669218},{"readMsMax":"0","computeMsMax":"9","inputStages":["25"],"waitMsAvg":"1","id":"28","endMs":"1570904225744","waitMsMax":"5","startMs":"1570904225643","waitRatioMax":0.002942907592701589,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"6","computeRatioAvg":0.002942907592701589,"writeMsAvg":"14","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012948793407886992,"readMsAvg":"0","waitRatioAvg":0.0005885815185403178,"completedParallelInputs":"100","computeRatioMax":0.00529723366686286,"name":"S1C: Coalesce","shuffleOutputBytes":"162","recordsWritten":"6","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage19_output"]}],"writeRatioAvg":0.00824014125956445},{"readMsMax":"0","computeMsMax":"11","inputStages":["20","18","26","28","23","27"],"waitMsAvg":"1","id":"29","endMs":"1570904227163","waitMsMax":"2","startMs":"1570904225664","waitRatioMax":0.0011771630370806356,"readRatioAvg":0,"parallelInputs":"42","recordsRead":"107","computeRatioAvg":0.004120070629782225,"writeMsAvg":"1069","status":"COMPLETE","writeMsMax":"1433","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.8434373160682754,"readMsAvg":"0","waitRatioAvg":0.0005885815185403178,"completedParallelInputs":"42","computeRatioMax":0.006474396703943496,"name":"S1D: Join+","shuffleOutputBytes":"2964","recordsWritten":"56","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$360, $280, $281","FROM __stage14_output"]},{"kind":"READ","substeps":["$230, $231, $410","FROM __stage1C_output"]},{"kind":"READ","substeps":["$240, $241, $450","FROM __stage1B_output"]},{"kind":"READ","substeps":["$250, $251","FROM __stage17_output"]},{"kind":"READ","substeps":["$520, $320, $321","FROM __stage12_output"]},{"kind":"READ","substeps":["$270, $271, $570","FROM __stage1A_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $590 := $180, $591 := $181","$170 := SUM($182)","$171 := SUM($183)","$172 := SUM($184)"]},{"kind":"COMPUTE","substeps":["$190 := 'store channel'","$191 := coalesce($423, 0)","$192 := subtract($422, coalesce($424, 0))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $370 = $410"]},{"kind":"AGGREGATE","substeps":["GROUP BY $370 := $360","$220 := SUM($280)","$221 := SUM($281)"]},{"kind":"COMPUTE","substeps":["$200 := 'catalog channel'","$201 := subtract($492, $494)"]},{"kind":"JOIN","substeps":["CROSS EACH WITH EACH "]},{"kind":"COMPUTE","substeps":["$210 := 'web channel'","$211 := coalesce($583, 0)","$212 := subtract($582, coalesce($584, 0))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $530 = $570"]},{"kind":"AGGREGATE","substeps":["GROUP BY $530 := $520","$260 := SUM($320)","$261 := SUM($321)"]},{"kind":"WRITE","substeps":["$170, $171, $172, $590, $591","TO __stage1D_output","BY HASH($590, $591)"]}],"writeRatioAvg":0.6291936433195998},{"readMsMax":"0","computeMsMax":"8","inputStages":["29"],"waitMsAvg":"1","id":"30","endMs":"1570904227319","waitMsMax":"1","startMs":"1570904227174","waitRatioMax":0.0005885815185403178,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"56","computeRatioAvg":0.004708652148322542,"writeMsAvg":"126","status":"COMPLETE","writeMsMax":"126","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.07416127133608005,"readMsAvg":"0","waitRatioAvg":0.0005885815185403178,"completedParallelInputs":"1","computeRatioMax":0.004708652148322542,"name":"S1E: Sort+","shuffleOutputBytes":"2100","recordsWritten":"40","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$170, $171, $172, $590, $591","FROM __stage1D_output"]},{"kind":"SORT","substeps":["$600 ASC, $601 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $600 := $590, $601 := $591","$160 := SUM($170)","$161 := SUM($171)","$162 := SUM($172)"]},{"kind":"WRITE","substeps":["$610, $611, $612, $613, $614","TO __stage1E_output"]}],"writeRatioAvg":0.07416127133608005},{"readMsMax":"0","computeMsMax":"5","inputStages":["30"],"waitMsAvg":"1","id":"31","endMs":"1570904227336","waitMsMax":"1","startMs":"1570904227290","waitRatioMax":0.0005885815185403178,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"40","computeRatioAvg":0.002942907592701589,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002942907592701589,"readMsAvg":"0","waitRatioAvg":0.0005885815185403178,"completedParallelInputs":"1","computeRatioMax":0.002942907592701589,"name":"S1F: Output","shuffleOutputBytes":"2100","recordsWritten":"40","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$610, $611, $612, $613, $614","FROM __stage1E_output"]},{"kind":"SORT","substeps":["$613 ASC, $614 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$620, $621, $622, $623, $624","TO __stage1F_output"]}],"writeRatioAvg":0.002942907592701589}],"estimatedBytesProcessed":"174032140","timeline":[{"totalSlotMs":"2424","activeUnits":"7","completedUnits":"6","elapsedMs":"740","pendingUnits":"8"},{"totalSlotMs":"6033","activeUnits":"5","completedUnits":"15","elapsedMs":"1748","pendingUnits":"1"},{"totalSlotMs":"30220","activeUnits":"42","completedUnits":"260","elapsedMs":"3728","pendingUnits":"42"},{"totalSlotMs":"64770","activeUnits":"2","completedUnits":"304","elapsedMs":"5175","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"174063616","totalPartitionsProcessed":"0","totalBytesProcessed":"174032140","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_page","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_1"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_1"}]},"endTime":"1570904227616"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query77_1570904220"},"etag":"NpVe68KRvhFaRzsnjPiLUg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query77_1570904220?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_1"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon314c992c2eea392c8ac4b3052a72ee929db028fa","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"\n-- query77\nWITH ss AS \n( \n SELECT s_store_sk, \n Sum(ss_ext_sales_price) AS sales, \n Sum(ss_net_profit) AS profit \n FROM store_sales, \n date_dim, \n store \n WHERE ss_sold_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN Cast('2001-08-16' AS DATE) AND ( \n Cast('2001-09-15' AS DATE)) \n AND ss_store_sk = s_store_sk \n GROUP BY s_store_sk) , sr AS \n( \n SELECT s_store_sk, \n sum(sr_return_amt) AS returns1, \n sum(sr_net_loss) AS profit_loss \n FROM store_returns, \n date_dim, \n store \n WHERE sr_returned_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2001-08-16' AS date) AND ( \n Cast('2001-09-15' AS DATE)) \n AND sr_store_sk = s_store_sk \n GROUP BY s_store_sk), cs AS \n( \n SELECT cs_call_center_sk, \n sum(cs_ext_sales_price) AS sales, \n sum(cs_net_profit) AS profit \n FROM catalog_sales, \n date_dim \n WHERE cs_sold_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2001-08-16' AS date) AND ( \n Cast('2001-09-15' AS DATE)) \n GROUP BY cs_call_center_sk ), cr AS \n( \n SELECT cr_call_center_sk, \n sum(cr_return_amount) AS returns1, \n sum(cr_net_loss) AS profit_loss \n FROM catalog_returns, \n date_dim \n WHERE cr_returned_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2001-08-16' AS date) AND ( \n Cast('2001-09-15' AS DATE)) \n GROUP BY cr_call_center_sk ), ws AS \n( \n SELECT wp_web_page_sk, \n sum(ws_ext_sales_price) AS sales, \n sum(ws_net_profit) AS profit \n FROM web_sales, \n date_dim, \n web_page \n WHERE ws_sold_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2001-08-16' AS date) AND ( \n Cast('2001-09-15' AS DATE)) \n AND ws_web_page_sk = wp_web_page_sk \n GROUP BY wp_web_page_sk), wr AS \n( \n SELECT wp_web_page_sk, \n sum(wr_return_amt) AS returns1, \n sum(wr_net_loss) AS profit_loss \n FROM web_returns, \n date_dim, \n web_page \n WHERE wr_returned_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2001-08-16' AS date) AND ( \n Cast('2001-09-15' AS DATE)) \n AND wr_web_page_sk = wp_web_page_sk \n GROUP BY wp_web_page_sk) \nSELECT\n channel , \n id , \n sum(sales) AS sales , \n sum(returns1) AS returns1 , \n sum(profit) AS profit \nFROM ( \n SELECT 'store channel' AS channel , \n ss.s_store_sk AS id , \n sales , \n COALESCE(returns1, 0) AS returns1 , \n (profit - COALESCE(profit_loss,0)) AS profit \n FROM ss \n LEFT JOIN sr \n ON ss.s_store_sk = sr.s_store_sk \n UNION ALL \n SELECT 'catalog channel' AS channel , \n cs_call_center_sk AS id , \n sales , \n returns1 , \n (profit - profit_loss) AS profit \n FROM cs , \n cr \n UNION ALL \n SELECT 'web channel' AS channel , \n ws.wp_web_page_sk AS id , \n sales , \n COALESCE(returns1, 0) returns1 , \n (profit - COALESCE(profit_loss,0)) AS profit \n FROM ws \n LEFT JOIN wr \n ON ws.wp_web_page_sk = wr.wp_web_page_sk ) x \nGROUP BY channel, id\nORDER BY channel , \n id \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query77_1570904220","user_email":"nithish.sankaranarayanan@ulb.be"}
