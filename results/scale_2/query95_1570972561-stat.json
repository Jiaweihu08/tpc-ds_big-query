{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"295918","creationTime":"1570972563134","totalBytesProcessed":"413380470","startTime":"1570972563276","query":{"totalSlotMs":"295918","queryPlan":[{"readMsMax":"17","computeMsMax":"467","waitMsAvg":"1","id":"0","endMs":"1570972563721","waitMsMax":"1","startMs":"1570972563401","waitRatioMax":0.0005385029617662897,"readRatioAvg":0.009154550350026925,"parallelInputs":"1","recordsRead":"720202","computeRatioAvg":0.2514808831448573,"writeMsAvg":"78","status":"COMPLETE","writeMsMax":"78","computeMsAvg":"467","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0420032310177706,"readMsAvg":"17","waitRatioAvg":0.0005385029617662897,"completedParallelInputs":"1","computeRatioMax":0.2514808831448573,"name":"S00: Input","shuffleOutputBytes":"6481818","recordsWritten":"720202","readRatioMax":0.009154550350026925,"steps":[{"kind":"READ","substeps":["$1:wr_order_number","FROM web_returns"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.0420032310177706},{"readMsMax":"33","computeMsMax":"1857","waitMsAvg":"69","id":"1","endMs":"1570972564464","waitMsMax":"109","startMs":"1570972563444","waitRatioMax":0.05869682283252558,"readRatioAvg":0.015616585891222402,"parallelInputs":"4","recordsRead":"7201030","computeRatioAvg":0.8610662358642972,"writeMsAvg":"70","status":"COMPLETE","writeMsMax":"79","computeMsAvg":"1599","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04254173397953689,"readMsAvg":"29","waitRatioAvg":0.03715670436187399,"completedParallelInputs":"4","computeRatioMax":1,"name":"S01: Input","shuffleOutputBytes":"129604572","recordsWritten":"7201030","readRatioMax":0.017770597738287562,"steps":[{"kind":"READ","substeps":["$50:ws_warehouse_sk, $51:ws_order_number","FROM web_sales"]},{"kind":"WRITE","substeps":["$50, $51","TO __stage01_output","BY HASH($51)"]}],"writeRatioAvg":0.03769520732364028},{"readMsMax":"33","computeMsMax":"1426","waitMsAvg":"101","id":"2","endMs":"1570972564475","waitMsMax":"139","startMs":"1570972563458","waitRatioMax":0.07485191168551426,"readRatioAvg":0.013462574044157244,"parallelInputs":"4","recordsRead":"7201030","computeRatioAvg":0.7215939687668282,"writeMsAvg":"96","status":"COMPLETE","writeMsMax":"192","computeMsAvg":"1340","shuffleOutputBytesSpilled":"0","writeRatioMax":0.10339256865912763,"readMsAvg":"25","waitRatioAvg":0.05438879913839526,"completedParallelInputs":"4","computeRatioMax":0.7679052234787291,"name":"S02: Input","shuffleOutputBytes":"129604572","recordsWritten":"7201030","readRatioMax":0.017770597738287562,"steps":[{"kind":"READ","substeps":["$40:ws_warehouse_sk, $41:ws_order_number","FROM web_sales"]},{"kind":"WRITE","substeps":["$40, $41","TO __stage02_output","BY HASH($41)"]}],"writeRatioAvg":0.051696284329563816},{"readMsMax":"28","computeMsMax":"1584","waitMsAvg":"99","id":"3","endMs":"1570972564519","waitMsMax":"141","startMs":"1570972563465","waitRatioMax":0.07592891760904685,"readRatioAvg":0.014539579967689823,"parallelInputs":"4","recordsRead":"7201030","computeRatioAvg":0.8012924071082391,"writeMsAvg":"98","status":"COMPLETE","writeMsMax":"185","computeMsAvg":"1488","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0996230479267636,"readMsAvg":"27","waitRatioAvg":0.05331179321486268,"completedParallelInputs":"4","computeRatioMax":0.8529886914378029,"name":"S03: Input","shuffleOutputBytes":"129604572","recordsWritten":"7201030","readRatioMax":0.015078082929456112,"steps":[{"kind":"READ","substeps":["$30:ws_warehouse_sk, $31:ws_order_number","FROM web_sales"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage03_output","BY HASH($31)"]}],"writeRatioAvg":0.05277329025309639},{"readMsMax":"31","computeMsMax":"1536","waitMsAvg":"137","id":"4","endMs":"1570972564468","waitMsMax":"268","startMs":"1570972563510","waitRatioMax":0.14431879375336565,"readRatioAvg":0.013462574044157244,"parallelInputs":"4","recordsRead":"7201030","computeRatioAvg":0.7544426494345718,"writeMsAvg":"71","status":"COMPLETE","writeMsMax":"81","computeMsAvg":"1401","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04361873990306947,"readMsAvg":"25","waitRatioAvg":0.07377490576198169,"completedParallelInputs":"4","computeRatioMax":0.827140549273021,"name":"S04: Input","shuffleOutputBytes":"129604572","recordsWritten":"7201030","readRatioMax":0.01669359181475498,"steps":[{"kind":"READ","substeps":["$20:ws_warehouse_sk, $21:ws_order_number","FROM web_sales"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage04_output","BY HASH($21)"]}],"writeRatioAvg":0.03823371028540657},{"readMsMax":"14","computeMsMax":"7","waitMsAvg":"7","id":"5","endMs":"1570972563637","waitMsMax":"7","startMs":"1570972563553","waitRatioMax":0.003769520732364028,"readRatioAvg":0.007539041464728056,"parallelInputs":"1","recordsRead":"42","computeRatioAvg":0.003769520732364028,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003769520732364028,"readMsAvg":"14","waitRatioAvg":0.003769520732364028,"completedParallelInputs":"1","computeRatioMax":0.003769520732364028,"name":"S05: Input","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.007539041464728056,"steps":[{"kind":"READ","substeps":["$10:web_site_sk, $11:web_company_name","FROM web_site","WHERE equal($11, 'pri')"]},{"kind":"WRITE","substeps":["$10","TO __stage05_output","BY HASH($10)"]}],"writeRatioAvg":0.003769520732364028},{"readMsMax":"34","computeMsMax":"16","waitMsAvg":"73","id":"6","endMs":"1570972563693","waitMsMax":"73","startMs":"1570972563633","waitRatioMax":0.039310716208939146,"readRatioAvg":0.01830910070005385,"parallelInputs":"1","recordsRead":"250000","computeRatioAvg":0.008616047388260635,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"16","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004308023694130318,"readMsAvg":"34","waitRatioAvg":0.039310716208939146,"completedParallelInputs":"1","computeRatioMax":0.008616047388260635,"name":"S06: Input","shuffleOutputBytes":"64350","recordsWritten":"7150","readRatioMax":0.01830910070005385,"steps":[{"kind":"READ","substeps":["$70:ca_address_sk, $71:ca_state","FROM customer_address","WHERE equal($71, 'IN')"]},{"kind":"WRITE","substeps":["$70","TO __stage06_output","BY HASH($70)"]}],"writeRatioAvg":0.004308023694130318},{"readMsMax":"10","computeMsMax":"17","waitMsAvg":"67","id":"7","endMs":"1570972563714","waitMsMax":"67","startMs":"1570972563638","waitRatioMax":0.03607969843834141,"readRatioAvg":0.005385029617662897,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.009154550350026925,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"17","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004846526655896607,"readMsAvg":"10","waitRatioAvg":0.03607969843834141,"completedParallelInputs":"1","computeRatioMax":0.009154550350026925,"name":"S07: Input","shuffleOutputBytes":"558","recordsWritten":"62","readRatioMax":0.005385029617662897,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_date","FROM date_dim","WHERE between(CAST($81 AS DATE), 11048, 11109)"]},{"kind":"WRITE","substeps":["$80","TO __stage07_output","BY HASH($80)"]}],"writeRatioAvg":0.004846526655896607},{"readMsMax":"0","computeMsMax":"12","inputStages":["0"],"waitMsAvg":"1","id":"9","endMs":"1570972564819","waitMsMax":"3","startMs":"1570972564584","waitRatioMax":0.0016155088852988692,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"720202","computeRatioAvg":0.004308023694130318,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"83","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.044695745826602046,"readMsAvg":"0","waitRatioAvg":0.0005385029617662897,"completedParallelInputs":"100","computeRatioMax":0.006462035541195477,"name":"S09: Coalesce","shuffleOutputBytes":"6481818","recordsWritten":"720202","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage00_output"]}],"writeRatioAvg":0.010770059235325794},{"readMsMax":"0","computeMsMax":"1477","inputStages":["1","2","9"],"waitMsAvg":"1","id":"10","endMs":"1570972565936","waitMsMax":"3","startMs":"1570972564603","waitRatioMax":0.0016155088852988692,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"86422260","computeRatioAvg":0.6537425955842757,"writeMsAvg":"80","status":"COMPLETE","writeMsMax":"432","computeMsAvg":"1214","shuffleOutputBytesSpilled":"0","writeRatioMax":0.23263327948303716,"readMsAvg":"0","waitRatioAvg":0.0005385029617662897,"completedParallelInputs":"100","computeRatioMax":0.7953688745288099,"name":"S0A: Join+","shuffleOutputBytes":"883371816","recordsWritten":"98152424","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$40, $41","FROM __stage02_output"]},{"kind":"READ","substeps":["$50, $51","FROM __stage01_output"]},{"kind":"READ","substeps":["$1","FROM __stage09_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $261 = $1"]},{"kind":"FILTER","substeps":["not_equal($260, $262)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH EACH ON $41 = $51"]},{"kind":"WRITE","substeps":["$270","TO __stage0A_output","BY HASH($270)"]}],"writeRatioAvg":0.043080236941303175},{"readMsMax":"0","computeMsMax":"908","inputStages":["3","4"],"waitMsAvg":"1","id":"11","endMs":"1570972565673","waitMsMax":"2","startMs":"1570972564621","waitRatioMax":0.0010770059235325794,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"14402060","computeRatioAvg":0.386645126548196,"writeMsAvg":"117","status":"COMPLETE","writeMsMax":"371","computeMsAvg":"718","shuffleOutputBytesSpilled":"0","writeRatioMax":0.19978459881529348,"readMsAvg":"0","waitRatioAvg":0.0005385029617662897,"completedParallelInputs":"100","computeRatioMax":0.48896068928379105,"name":"S0B: Join+","shuffleOutputBytes":"673779240","recordsWritten":"74864360","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$20, $21","FROM __stage04_output"]},{"kind":"READ","substeps":["$30, $31","FROM __stage03_output"]},{"kind":"FILTER","substeps":["not_equal($240, $242)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH EACH ON $21 = $31"]},{"kind":"WRITE","substeps":["$241","TO __stage0B_output","BY HASH($241)"]}],"writeRatioAvg":0.0630048465266559},{"readMsMax":"86","computeMsMax":"950","inputStages":["5","6","7"],"waitMsAvg":"1","id":"12","endMs":"1570972565583","waitMsMax":"1","startMs":"1570972564840","waitRatioMax":0.0005385029617662897,"readRatioAvg":0.03231017770597738,"parallelInputs":"4","recordsRead":"7229882","computeRatioAvg":0.4534194938072159,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"842","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012924071082390954,"readMsAvg":"60","waitRatioAvg":0.0005385029617662897,"completedParallelInputs":"4","computeRatioMax":0.5115778136779753,"name":"S0C: Join","shuffleOutputBytes":"6021","recordsWritten":"223","readRatioMax":0.046311254711900916,"steps":[{"kind":"READ","substeps":["$60:ws_ship_date_sk, $61:ws_ship_addr_sk, $62:ws_web_site_sk, $63:ws_order_number, $64:ws_ext_ship_cost, $65:ws_net_profit","FROM web_sales"]},{"kind":"READ","substeps":["$80","FROM __stage07_output"]},{"kind":"READ","substeps":["$70","FROM __stage06_output"]},{"kind":"READ","substeps":["$10","FROM __stage05_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $220 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $210 = $70"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $60 = $80"]},{"kind":"WRITE","substeps":["$230, $231, $232","TO __stage0C_output","BY HASH($230)"]}],"writeRatioAvg":0.0059235325794291865},{"readMsMax":"0","computeMsMax":"139","inputStages":["11","12"],"waitMsAvg":"1","id":"13","endMs":"1570972565896","waitMsMax":"9","startMs":"1570972565716","waitRatioMax":0.004846526655896607,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"68107259","computeRatioAvg":0.048465266558966075,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"90","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012385568120624663,"readMsAvg":"0","waitRatioAvg":0.0005385029617662897,"completedParallelInputs":"100","computeRatioMax":0.07485191168551426,"name":"S0D: Join","shuffleOutputBytes":"6021","recordsWritten":"223","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$230, $231, $232","FROM __stage0C_output"]},{"kind":"READ","substeps":["$241","FROM __stage0B_output"]},{"kind":"JOIN","substeps":["SEMI HASH JOIN EACH WITH EACH ON $230 = $241"]},{"kind":"WRITE","substeps":["$250, $251, $252","TO __stage0D_output","BY HASH($250)"]}],"writeRatioAvg":0.003769520732364028},{"readMsMax":"0","computeMsMax":"173","inputStages":["10","13"],"waitMsAvg":"1","id":"14","endMs":"1570972566208","waitMsMax":"5","startMs":"1570972565997","waitRatioMax":0.0026925148088314485,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"89335869","computeRatioAvg":0.06192784060312332,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"71","computeMsAvg":"115","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03823371028540657,"readMsAvg":"0","waitRatioAvg":0.0005385029617662897,"completedParallelInputs":"100","computeRatioMax":0.09316101238556812,"name":"S0E: Join+","shuffleOutputBytes":"4932","recordsWritten":"217","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$250, $251, $252","FROM __stage0D_output"]},{"kind":"READ","substeps":["$270","FROM __stage0A_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $290 := $200, $291 := $180","$170 := SUM($182)","$171 := SUM($181)"]},{"kind":"COMPUTE","substeps":["$180 := if(equal($200, 1), $280, NULL)","$181 := if(equal($200, 0), $282, NULL)","$182 := if(equal($200, 0), $281, NULL)"]},{"kind":"COMPUTE","substeps":["$190 := ARRAY<...>"]},{"kind":"JOIN","substeps":["SEMI HASH JOIN EACH WITH EACH ON $250 = $270"]},{"kind":"WRITE","substeps":["$170, $171, $291, $290","TO __stage0E_output","BY HASH($290, $291)"]}],"writeRatioAvg":0.0032310177705977385},{"readMsMax":"0","computeMsMax":"6","inputStages":["14"],"waitMsAvg":"1","id":"15","endMs":"1570972566322","waitMsMax":"1","startMs":"1570972566303","waitRatioMax":0.0005385029617662897,"readRatioAvg":0,"parallelInputs":"2","recordsRead":"217","computeRatioAvg":0.0026925148088314485,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002154011847065159,"readMsAvg":"0","waitRatioAvg":0.0005385029617662897,"completedParallelInputs":"2","computeRatioMax":0.0032310177705977385,"name":"S0F: Aggregate+","shuffleOutputBytes":"76","recordsWritten":"3","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$170, $171, $291, $290","FROM __stage0E_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $310 := $300","$140 := COUNT($152)","$141 := ANY_VALUE($151)","$142 := ANY_VALUE($150)"]},{"kind":"COMPUTE","substeps":["$150 := if(equal($300, 0), $161, NULL)","$151 := if(equal($300, 0), $160, NULL)","$152 := if(equal($300, 1), $301, NULL)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $300 := $290, $301 := $291","$160 := SUM($170)","$161 := SUM($171)"]},{"kind":"WRITE","substeps":["$140, $141, $142, $310","TO __stage0F_output","BY HASH($310)"]}],"writeRatioAvg":0.002154011847065159},{"readMsMax":"0","computeMsMax":"3","inputStages":["15"],"waitMsAvg":"1","id":"16","endMs":"1570972566516","waitMsMax":"1","startMs":"1570972566325","waitRatioMax":0.0005385029617662897,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"3","computeRatioAvg":0.0016155088852988692,"writeMsAvg":"149","status":"COMPLETE","writeMsMax":"149","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08023694130317717,"readMsAvg":"0","waitRatioAvg":0.0005385029617662897,"completedParallelInputs":"1","computeRatioMax":0.0016155088852988692,"name":"S10: Aggregate+","shuffleOutputBytes":"27","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$140, $141, $142, $310","FROM __stage0F_output"]},{"kind":"AGGREGATE","substeps":["$110 := ANY_VALUE($122)","$111 := ANY_VALUE($121)","$112 := ANY_VALUE($120)"]},{"kind":"COMPUTE","substeps":["$120 := if(equal($320, 0), $132, NULL)","$121 := if(equal($320, 0), $131, NULL)","$122 := if(equal($320, 1), $130, NULL)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $320 := $310","$130 := SUM_OF_COUNTS($140)","$131 := ANY_VALUE($141)","$132 := ANY_VALUE($142)"]},{"kind":"WRITE","substeps":["$110, $111, $112","TO __stage10_output"]}],"writeRatioAvg":0.08023694130317717},{"readMsMax":"0","computeMsMax":"5","inputStages":["16"],"waitMsAvg":"1","id":"17","endMs":"1570972566520","waitMsMax":"1","startMs":"1570972566402","waitRatioMax":0.0005385029617662897,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.0026925148088314485,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0026925148088314485,"readMsAvg":"0","waitRatioAvg":0.0005385029617662897,"completedParallelInputs":"1","computeRatioMax":0.0026925148088314485,"name":"S11: Output","shuffleOutputBytes":"27","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110, $111, $112","FROM __stage10_output"]},{"kind":"SORT","substeps":["$90 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$90 := if(is_null($100), 0, $100)"]},{"kind":"AGGREGATE","substeps":["$100 := ANY_VALUE($110)","$101 := ANY_VALUE($111)","$102 := ANY_VALUE($112)"]},{"kind":"WRITE","substeps":["$330, $331, $332","TO __stage11_output"]}],"writeRatioAvg":0.0026925148088314485}],"estimatedBytesProcessed":"413380470","timeline":[{"totalSlotMs":"4290","activeUnits":"16","completedUnits":"4","elapsedMs":"626","pendingUnits":"16"},{"totalSlotMs":"112917","activeUnits":"190","completedUnits":"134","elapsedMs":"1809","pendingUnits":"190"},{"totalSlotMs":"288218","activeUnits":"48","completedUnits":"476","elapsedMs":"2825","pendingUnits":"48"},{"totalSlotMs":"295918","activeUnits":"48","completedUnits":"528","elapsedMs":"3431","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"414187520","totalPartitionsProcessed":"0","totalBytesProcessed":"413380470","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_site","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_returns","datasetId":"scale_10"}]},"endTime":"1570972566735"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query95_1570972561"},"etag":"PKA5GTvOTjxwsuFnqwzG5Q==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query95_1570972561?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon1519ce97382787f3a2ff4907a431f27bf1f221c5","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query95\nWITH ws_wh AS \n( \n SELECT ws1.ws_order_number, \n ws1.ws_warehouse_sk wh1, \n ws2.ws_warehouse_sk wh2 \n FROM web_sales ws1, \n web_sales ws2 \n WHERE ws1.ws_order_number = ws2.ws_order_number \n AND ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) \nSELECT \n Count(DISTINCT ws_order_number) AS order_count, \n Sum(ws_ext_ship_cost) AS total_shipping_cost, \n Sum(ws_net_profit) AS total_net_profit\nFROM web_sales ws1 , \n date_dim , \n customer_address , \n web_site \nWHERE Cast(d_date AS DATE) BETWEEN Cast('2000-4-01' AS DATE) AND ( \n Cast('2000-6-01' AS DATE)) \nAND ws1.ws_ship_date_sk = d_date_sk \nAND ws1.ws_ship_addr_sk = ca_address_sk \nAND ca_state = 'IN' \nAND ws1.ws_web_site_sk = web_site_sk \nAND web_company_name = 'pri' \nAND ws1.ws_order_number IN \n ( \n SELECT ws_order_number \n FROM ws_wh) \nAND ws1.ws_order_number IN \n ( \n SELECT wr_order_number \n FROM web_returns, \n ws_wh \n WHERE wr_order_number = ws_wh.ws_order_number) \nORDER BY count(DISTINCT ws_order_number) \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query95_1570972561","user_email":"nithish.sankaranarayanan@ulb.be"}
