{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"117156","creationTime":"1570971938541","totalBytesProcessed":"845354732","startTime":"1570971938654","query":{"totalSlotMs":"117156","queryPlan":[{"readMsMax":"13","computeMsMax":"8","waitMsAvg":"1","id":"0","endMs":"1570971938940","waitMsMax":"1","startMs":"1570971938841","waitRatioMax":5.13347022587269e-05,"readRatioAvg":0.0006673511293634497,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0004106776180698152,"writeMsAvg":"33","status":"COMPLETE","writeMsMax":"33","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0016940451745379877,"readMsAvg":"13","waitRatioAvg":5.13347022587269e-05,"completedParallelInputs":"1","computeRatioMax":0.0004106776180698152,"name":"S00: Input","shuffleOutputBytes":"8784","recordsWritten":"366","readRatioMax":0.0006673511293634497,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_date, $32:d_month_seq","FROM date_dim","WHERE between($32, 1192, 1203)"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage00_output","BY HASH($30)"]}],"writeRatioAvg":0.0016940451745379877},{"readMsMax":"14","computeMsMax":"11","waitMsAvg":"45","id":"2","endMs":"1570971940085","waitMsMax":"45","startMs":"1570971940002","waitRatioMax":0.0023100616016427105,"readRatioAvg":0.0007186858316221766,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0005646817248459959,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0004106776180698152,"readMsAvg":"14","waitRatioAvg":0.0023100616016427105,"completedParallelInputs":"1","computeRatioMax":0.0005646817248459959,"name":"S02: Input","shuffleOutputBytes":"8784","recordsWritten":"366","readRatioMax":0.0007186858316221766,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $11:d_date, $12:d_month_seq","FROM date_dim","WHERE between($12, 1192, 1203)"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage02_output","BY HASH($10)"]}],"writeRatioAvg":0.0004106776180698152},{"readMsMax":"35","computeMsMax":"3145","inputStages":["0"],"waitMsAvg":"1","id":"4","endMs":"1570971941822","waitMsMax":"1","startMs":"1570971940025","waitRatioMax":5.13347022587269e-05,"readRatioAvg":0.0013347022587268994,"parallelInputs":"10","recordsRead":"28805772","computeRatioAvg":0.1484599589322382,"writeMsAvg":"30","status":"COMPLETE","writeMsMax":"112","computeMsAvg":"2892","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005749486652977412,"readMsAvg":"26","waitRatioAvg":5.13347022587269e-05,"completedParallelInputs":"10","computeRatioMax":0.1614476386036961,"name":"S04: Join+","shuffleOutputBytes":"177842658","recordsWritten":"5419546","readRatioMax":0.0017967145790554414,"steps":[{"kind":"READ","substeps":["$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_sales_price","FROM store_sales","WHERE not(is_null($21))"]},{"kind":"READ","substeps":["$30, $31","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $170, $181 := $172","$110 := SUM($171)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $30"]},{"kind":"WRITE","substeps":["$180, $181, $110","TO __stage04_output","BY HASH($180, $181)"]}],"writeRatioAvg":0.001540041067761807},{"readMsMax":"40","computeMsMax":"1597","inputStages":["2"],"waitMsAvg":"1","id":"5","endMs":"1570971941271","waitMsMax":"1","startMs":"1570971940119","waitRatioMax":5.13347022587269e-05,"readRatioAvg":0.001540041067761807,"parallelInputs":"4","recordsRead":"7202494","computeRatioAvg":0.07150924024640658,"writeMsAvg":"74","status":"COMPLETE","writeMsMax":"251","computeMsAvg":"1393","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012885010266940451,"readMsAvg":"30","waitRatioAvg":5.13347022587269e-05,"completedParallelInputs":"4","computeRatioMax":0.08198151950718686,"name":"S05: Join+","shuffleOutputBytes":"47157704","recordsWritten":"1429064","readRatioMax":0.002053388090349076,"steps":[{"kind":"READ","substeps":["$1:ws_sold_date_sk, $2:ws_item_sk, $3:ws_sales_price","FROM web_sales","WHERE not(is_null($2))"]},{"kind":"READ","substeps":["$10, $11","FROM __stage02_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $130 := $120, $131 := $122","$100 := SUM($121)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $10"]},{"kind":"WRITE","substeps":["$130, $131, $100","TO __stage05_output","BY HASH($130, $131)"]}],"writeRatioAvg":0.0037987679671457907},{"readMsMax":"0","computeMsMax":"3403","inputStages":["5"],"waitMsAvg":"1","id":"6","endMs":"1570971943609","waitMsMax":"1","startMs":"1570971941563","waitRatioMax":5.13347022587269e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1429064","computeRatioAvg":0.17469199178644765,"writeMsAvg":"152","status":"COMPLETE","writeMsMax":"152","computeMsAvg":"3403","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0078028747433264885,"readMsAvg":"0","waitRatioAvg":5.13347022587269e-05,"completedParallelInputs":"1","computeRatioMax":0.17469199178644765,"name":"S06: Aggregate","shuffleOutputBytes":"45464488","recordsWritten":"1377752","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$130, $131, $100","FROM __stage05_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $140 := $130, $141 := $131","$80 := SUM($100)"]},{"kind":"WRITE","substeps":["$140, $141, $80","TO __stage06_output","BY HASH($140)"]}],"writeRatioAvg":0.0078028747433264885},{"readMsMax":"0","computeMsMax":"5344","inputStages":["4"],"waitMsAvg":"1","id":"7","endMs":"1570971944009","waitMsMax":"1","startMs":"1570971941569","waitRatioMax":5.13347022587269e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"4371394","computeRatioAvg":0.2743326488706366,"writeMsAvg":"49","status":"COMPLETE","writeMsMax":"49","computeMsAvg":"5344","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002515400410677618,"readMsAvg":"0","waitRatioAvg":5.13347022587269e-05,"completedParallelInputs":"1","computeRatioMax":0.2743326488706366,"name":"S07: Repartition","shuffleOutputBytes":"143351986","recordsWritten":"4371394","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage04_output"]}],"writeRatioAvg":0.002515400410677618},{"readMsMax":"0","computeMsMax":"1515","inputStages":["7","4"],"waitMsAvg":"1","id":"8","endMs":"1570971945188","waitMsMax":"2","startMs":"1570971944209","waitRatioMax":0.0001026694045174538,"readRatioAvg":0,"parallelInputs":"10","recordsRead":"5419546","computeRatioAvg":0.06991786447638604,"writeMsAvg":"44","status":"COMPLETE","writeMsMax":"74","computeMsAvg":"1362","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0037987679671457907,"readMsAvg":"0","waitRatioAvg":5.13347022587269e-05,"completedParallelInputs":"10","computeRatioMax":0.07777207392197125,"name":"S08: Aggregate","shuffleOutputBytes":"151432114","recordsWritten":"4610826","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$180, $181, $110","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $180, $191 := $181","$90 := SUM($110)"]},{"kind":"WRITE","substeps":["$190, $191, $90","TO __stage08_output","BY HASH($190)"]}],"writeRatioAvg":0.0022587268993839835},{"readMsMax":"0","computeMsMax":"19480","inputStages":["8"],"waitMsAvg":"2","id":"9","endMs":"1570971955933","waitMsMax":"2","startMs":"1570971945223","waitRatioMax":0.0001026694045174538,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"4610826","computeRatioAvg":1,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"28","computeMsAvg":"19480","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001437371663244353,"readMsAvg":"0","waitRatioAvg":0.0001026694045174538,"completedParallelInputs":"1","computeRatioMax":1,"name":"S09: Sort+","shuffleOutputBytes":"152145498","recordsWritten":"4610826","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$190, $191, $90","FROM __stage08_output"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$70 := SUM($202) OVER (PARTITION BY $200 ORDER BY $201 ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)"]},{"kind":"SORT","substeps":["$190 ASC, $191 ASC"]},{"kind":"WRITE","substeps":["$70, $210, $211","TO __stage09_output","BY HASH($210, $211)"]}],"writeRatioAvg":0.001437371663244353},{"readMsMax":"0","computeMsMax":"4579","inputStages":["6"],"waitMsAvg":"1","id":"10","endMs":"1570971947780","waitMsMax":"1","startMs":"1570971945237","waitRatioMax":5.13347022587269e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1377752","computeRatioAvg":0.23506160164271048,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"16","computeMsAvg":"4579","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0008213552361396304,"readMsAvg":"0","waitRatioAvg":5.13347022587269e-05,"completedParallelInputs":"1","computeRatioMax":0.23506160164271048,"name":"S0A: Sort+","shuffleOutputBytes":"45465728","recordsWritten":"1377752","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$140, $141, $80","FROM __stage06_output"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$60 := SUM($152) OVER (PARTITION BY $150 ORDER BY $151 ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)"]},{"kind":"SORT","substeps":["$140 ASC, $141 ASC"]},{"kind":"WRITE","substeps":["$60, $160, $161","TO __stage0A_output","BY HASH($160, $161)"]}],"writeRatioAvg":0.0008213552361396304},{"readMsMax":"0","computeMsMax":"184","inputStages":["9","10"],"waitMsAvg":"3","id":"11","endMs":"1570971956388","waitMsMax":"10","startMs":"1570971956152","waitRatioMax":0.000513347022587269,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"5988578","computeRatioAvg":0.006570841889117043,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"37","computeMsAvg":"128","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0018993839835728954,"readMsAvg":"0","waitRatioAvg":0.0001540041067761807,"completedParallelInputs":"100","computeRatioMax":0.00944558521560575,"name":"S0B: Join+","shuffleOutputBytes":"192640856","recordsWritten":"5567080","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$60, $160, $161","FROM __stage0A_output"]},{"kind":"READ","substeps":["$70, $210, $211","FROM __stage09_output"]},{"kind":"COMPUTE","substeps":["$50 := case_no_value(not(is_null($220)), $220, $223)","$51 := case_no_value(not(is_null($221)), $221, $224)"]},{"kind":"JOIN","substeps":["FULL OUTER HASH JOIN EACH WITH EACH ON $160 = $210, $161 = $211"]},{"kind":"WRITE","substeps":["$50, $51, $222, $225","TO __stage0B_output","BY HASH($50)"]}],"writeRatioAvg":0.0012320328542094457},{"readMsMax":"0","computeMsMax":"8052","inputStages":["11"],"waitMsAvg":"1","id":"12","endMs":"1570971960812","waitMsMax":"1","startMs":"1570971956474","waitRatioMax":5.13347022587269e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"5567080","computeRatioAvg":0.413347022587269,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"8052","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0002566735112936345,"readMsAvg":"0","waitRatioAvg":5.13347022587269e-05,"completedParallelInputs":"1","computeRatioMax":0.413347022587269,"name":"S0C: Sort+","shuffleOutputBytes":"5256","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$50, $51, $222, $225","FROM __stage0B_output"]},{"kind":"SORT","substeps":["$240 ASC, $241 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["greater($40, $41)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$40 := MAX($232) OVER (PARTITION BY $230 ORDER BY $231 ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)","$41 := MAX($233) OVER (PARTITION BY $230 ORDER BY $231 ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)"]},{"kind":"SORT","substeps":["$50 ASC, $51 ASC"]},{"kind":"WRITE","substeps":["$250, $251, $252, $253, $254, $255","TO __stage0C_output"]}],"writeRatioAvg":0.0002566735112936345},{"readMsMax":"0","computeMsMax":"4","inputStages":["12"],"waitMsAvg":"1","id":"13","endMs":"1570971961935","waitMsMax":"1","startMs":"1570971956501","waitRatioMax":5.13347022587269e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0002053388090349076,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0003080082135523614,"readMsAvg":"0","waitRatioAvg":5.13347022587269e-05,"completedParallelInputs":"1","computeRatioMax":0.0002053388090349076,"name":"S0D: Output","shuffleOutputBytes":"5256","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$250, $251, $252, $253, $254, $255","FROM __stage0C_output"]},{"kind":"SORT","substeps":["$252 ASC, $253 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$260, $261, $262, $263, $264, $265","TO __stage0D_output"]}],"writeRatioAvg":0.0003080082135523614}],"estimatedBytesProcessed":"845354732","timeline":[{"totalSlotMs":"232","activeUnits":"5","completedUnits":"1","elapsedMs":"1349","pendingUnits":"5"},{"totalSlotMs":"25819","activeUnits":"14","completedUnits":"7","elapsedMs":"2637","pendingUnits":"9"},{"totalSlotMs":"35428","activeUnits":"2","completedUnits":"16","elapsedMs":"3192","pendingUnits":"2"},{"totalSlotMs":"49286","activeUnits":"10","completedUnits":"18","elapsedMs":"6057","pendingUnits":"10"},{"totalSlotMs":"56626","activeUnits":"2","completedUnits":"28","elapsedMs":"6643","pendingUnits":"2"},{"totalSlotMs":"64785","activeUnits":"1","completedUnits":"29","elapsedMs":"9628","pendingUnits":"1"},{"totalSlotMs":"101679","activeUnits":"2","completedUnits":"130","elapsedMs":"18323","pendingUnits":"2"},{"totalSlotMs":"116235","activeUnits":"1","completedUnits":"131","elapsedMs":"22660","pendingUnits":"1"},{"totalSlotMs":"117156","activeUnits":"0","completedUnits":"132","elapsedMs":"24624","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"846200832","totalPartitionsProcessed":"0","totalBytesProcessed":"845354732","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570971963301"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query51_1570971937"},"etag":"txKLTz/8dbdEHmksxlKAPA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query51_1570971937?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon78c321aa249f00a6ea96afcf2866fd5d9d4e7289","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query51\nWITH web_v1 AS \n( \n SELECT ws_item_sk item_sk, \n d_date, \n sum(Sum(ws_sales_price)) OVER (partition BY ws_item_sk ORDER BY d_date rows BETWEEN UNBOUNDED PRECEDING AND CURRENT row) cume_sales\n FROM web_sales , \n date_dim \n WHERE ws_sold_date_sk=d_date_sk \n AND d_month_seq BETWEEN 1192 AND 1192+11 \n AND ws_item_sk IS NOT NULL \n GROUP BY ws_item_sk, \n d_date), store_v1 AS \n( \n SELECT ss_item_sk item_sk, \n d_date, \n sum(sum(ss_sales_price)) OVER (partition BY ss_item_sk ORDER BY d_date rows BETWEEN UNBOUNDED PRECEDING AND CURRENT row) cume_sales\n FROM store_sales , \n date_dim \n WHERE ss_sold_date_sk=d_date_sk \n AND d_month_seq BETWEEN 1192 AND 1192+11 \n AND ss_item_sk IS NOT NULL \n GROUP BY ss_item_sk, \n d_date) \nSELECT \n benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results warmup \nFROM ( \n SELECT item_sk , \n d_date , \n web_sales , \n store_sales , \n max(web_sales) OVER (partition BY item_sk ORDER BY d_date rows BETWEEN UNBOUNDED PRECEDING AND CURRENT row) web_cumulative ,\n max(store_sales) OVER (partition BY item_sk ORDER BY d_date rows BETWEEN UNBOUNDED PRECEDING AND CURRENT row) store_cumulative\n FROM ( \n SELECT \n CASE \n WHEN web.item_sk IS NOT NULL THEN web.item_sk\n ELSE store.item_sk \n END item_sk , \n CASE \n WHEN web.d_date IS NOT NULL THEN web.d_date\n ELSE store.d_date \n END d_date , \n web.cume_sales web_sales , \n store.cume_sales store_sales \n FROM web_v1 web \n FULL OUTER JOIN store_v1 store \n ON ( \n web.item_sk = store.item_sk\n AND web.d_date = store.d_date) )x )y\nWHERE web_cumulative > store_cumulative \nORDER BY item_sk , \n d_date \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query51_1570971937","user_email":"nithish.sankaranarayanan@ulb.be"}
