{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"346752","creationTime":"1570971344511","totalBytesProcessed":"2376786058","startTime":"1570971344689","query":{"totalSlotMs":"346752","queryPlan":[{"readMsMax":"16","computeMsMax":"7","waitMsAvg":"1","id":"0","endMs":"1570971345020","waitMsMax":"1","startMs":"1570971344972","waitRatioMax":0.00016504373659019642,"readRatioAvg":0.0026406997854431426,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0011553061561313748,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001650437365901964,"readMsAvg":"16","waitRatioAvg":0.00016504373659019642,"completedParallelInputs":"1","computeRatioMax":0.0011553061561313748,"name":"S00: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0026406997854431426,"steps":[{"kind":"READ","substeps":["$180:d_date_sk, $181:d_year","FROM date_dim","WHERE equal($181, 2001)"]},{"kind":"WRITE","substeps":["$180, $181","TO __stage00_output","BY HASH($180)"]}],"writeRatioAvg":0.001650437365901964},{"readMsMax":"24","computeMsMax":"404","waitMsAvg":"22","id":"2","endMs":"1570971345852","waitMsMax":"22","startMs":"1570971345020","waitRatioMax":0.003630962204984321,"readRatioAvg":0.003961049678164714,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.06667766958243934,"writeMsAvg":"55","status":"COMPLETE","writeMsMax":"55","computeMsAvg":"404","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009077405512460801,"readMsAvg":"24","waitRatioAvg":0.003630962204984321,"completedParallelInputs":"1","computeRatioMax":0.06667766958243934,"name":"S02: Input","shuffleOutputBytes":"15000000","recordsWritten":"500000","readRatioMax":0.003961049678164714,"steps":[{"kind":"READ","substeps":["$160:c_customer_sk, $161:c_customer_id","FROM customer"]},{"kind":"WRITE","substeps":["$160, $161","TO __stage02_output","BY HASH($160)"]}],"writeRatioAvg":0.009077405512460801},{"readMsMax":"15","computeMsMax":"7","waitMsAvg":"29","id":"3","endMs":"1570971345265","waitMsMax":"29","startMs":"1570971345061","waitRatioMax":0.004786268361115695,"readRatioAvg":0.002475656048852946,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0011553061561313748,"writeMsAvg":"175","status":"COMPLETE","writeMsMax":"175","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02888265390328437,"readMsAvg":"15","waitRatioAvg":0.004786268361115695,"completedParallelInputs":"1","computeRatioMax":0.0011553061561313748,"name":"S03: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.002475656048852946,"steps":[{"kind":"READ","substeps":["$150:d_date_sk, $151:d_year","FROM date_dim","WHERE equal($151, 2001)"]},{"kind":"WRITE","substeps":["$150, $151","TO __stage03_output","BY HASH($150)"]}],"writeRatioAvg":0.02888265390328437},{"readMsMax":"21","computeMsMax":"404","waitMsAvg":"1","id":"5","endMs":"1570971345938","waitMsMax":"1","startMs":"1570971345153","waitRatioMax":0.00016504373659019642,"readRatioAvg":0.0034659184683941244,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.06667766958243934,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"28","computeMsAvg":"404","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004621224624525499,"readMsAvg":"21","waitRatioAvg":0.00016504373659019642,"completedParallelInputs":"1","computeRatioMax":0.06667766958243934,"name":"S05: Input","shuffleOutputBytes":"15000000","recordsWritten":"500000","readRatioMax":0.0034659184683941244,"steps":[{"kind":"READ","substeps":["$130:c_customer_sk, $131:c_customer_id","FROM customer"]},{"kind":"WRITE","substeps":["$130, $131","TO __stage05_output","BY HASH($130)"]}],"writeRatioAvg":0.004621224624525499},{"readMsMax":"12","computeMsMax":"7","waitMsAvg":"1","id":"6","endMs":"1570971345212","waitMsMax":"1","startMs":"1570971345168","waitRatioMax":0.00016504373659019642,"readRatioAvg":0.001980524839082357,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0011553061561313748,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001650437365901964,"readMsAvg":"12","waitRatioAvg":0.00016504373659019642,"completedParallelInputs":"1","computeRatioMax":0.0011553061561313748,"name":"S06: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.001980524839082357,"steps":[{"kind":"READ","substeps":["$120:d_date_sk, $121:d_year","FROM date_dim","WHERE equal($121, 2002)"]},{"kind":"WRITE","substeps":["$120, $121","TO __stage06_output","BY HASH($120)"]}],"writeRatioAvg":0.001650437365901964},{"readMsMax":"24","computeMsMax":"335","waitMsAvg":"1","id":"8","endMs":"1570971346096","waitMsMax":"1","startMs":"1570971345197","waitRatioMax":0.00016504373659019642,"readRatioAvg":0.003961049678164714,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.055289651757715795,"writeMsAvg":"44","status":"COMPLETE","writeMsMax":"44","computeMsAvg":"335","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007261924409968642,"readMsAvg":"24","waitRatioAvg":0.00016504373659019642,"completedParallelInputs":"1","computeRatioMax":0.055289651757715795,"name":"S08: Input","shuffleOutputBytes":"15000000","recordsWritten":"500000","readRatioMax":0.003961049678164714,"steps":[{"kind":"READ","substeps":["$100:c_customer_sk, $101:c_customer_id","FROM customer"]},{"kind":"WRITE","substeps":["$100, $101","TO __stage08_output","BY HASH($100)"]}],"writeRatioAvg":0.007261924409968642},{"readMsMax":"12","computeMsMax":"10","waitMsAvg":"3","id":"9","endMs":"1570971345359","waitMsMax":"3","startMs":"1570971345221","waitRatioMax":0.0004951312097705892,"readRatioAvg":0.001980524839082357,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.001650437365901964,"writeMsAvg":"100","status":"COMPLETE","writeMsMax":"100","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01650437365901964,"readMsAvg":"12","waitRatioAvg":0.0004951312097705892,"completedParallelInputs":"1","computeRatioMax":0.001650437365901964,"name":"S09: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.001980524839082357,"steps":[{"kind":"READ","substeps":["$90:d_date_sk, $91:d_year","FROM date_dim","WHERE equal($91, 2002)"]},{"kind":"WRITE","substeps":["$90, $91","TO __stage09_output","BY HASH($90)"]}],"writeRatioAvg":0.01650437365901964},{"readMsMax":"24","computeMsMax":"399","waitMsAvg":"4","id":"11","endMs":"1570971345738","waitMsMax":"4","startMs":"1570971345338","waitRatioMax":0.0006601749463607857,"readRatioAvg":0.003961049678164714,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.06585245089948837,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"399","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0028057435220333387,"readMsAvg":"24","waitRatioAvg":0.0006601749463607857,"completedParallelInputs":"1","computeRatioMax":0.06585245089948837,"name":"S0B: Input","shuffleOutputBytes":"15000000","recordsWritten":"500000","readRatioMax":0.003961049678164714,"steps":[{"kind":"READ","substeps":["$70:c_customer_sk, $71:c_customer_id","FROM customer"]},{"kind":"WRITE","substeps":["$70, $71","TO __stage0B_output","BY HASH($70)"]}],"writeRatioAvg":0.0028057435220333387},{"readMsMax":"26","computeMsMax":"10","waitMsAvg":"2","id":"12","endMs":"1570971345419","waitMsMax":"2","startMs":"1570971345352","waitRatioMax":0.00033008747318039283,"readRatioAvg":0.004291137151345106,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.001650437365901964,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0034659184683941244,"readMsAvg":"26","waitRatioAvg":0.00033008747318039283,"completedParallelInputs":"1","computeRatioMax":0.001650437365901964,"name":"S0C: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.004291137151345106,"steps":[{"kind":"READ","substeps":["$60:d_date_sk, $61:d_year","FROM date_dim","WHERE equal($61, 2001)"]},{"kind":"WRITE","substeps":["$60, $61","TO __stage0C_output","BY HASH($60)"]}],"writeRatioAvg":0.0034659184683941244},{"readMsMax":"31","computeMsMax":"453","waitMsAvg":"1","id":"14","endMs":"1570971347918","waitMsMax":"1","startMs":"1570971345379","waitRatioMax":0.00016504373659019642,"readRatioAvg":0.005116355834296088,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.07476481267535898,"writeMsAvg":"1656","status":"COMPLETE","writeMsMax":"1656","computeMsAvg":"453","shuffleOutputBytesSpilled":"0","writeRatioMax":0.27331242779336523,"readMsAvg":"31","waitRatioAvg":0.00016504373659019642,"completedParallelInputs":"1","computeRatioMax":0.07476481267535898,"name":"S0E: Input","shuffleOutputBytes":"15000000","recordsWritten":"500000","readRatioMax":0.005116355834296088,"steps":[{"kind":"READ","substeps":["$40:c_customer_sk, $41:c_customer_id","FROM customer"]},{"kind":"WRITE","substeps":["$40, $41","TO __stage0E_output","BY HASH($40)"]}],"writeRatioAvg":0.27331242779336523},{"readMsMax":"12","computeMsMax":"7","waitMsAvg":"1","id":"15","endMs":"1570971345464","waitMsMax":"1","startMs":"1570971345391","waitRatioMax":0.00016504373659019642,"readRatioAvg":0.001980524839082357,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0011553061561313748,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.000825218682950982,"readMsAvg":"12","waitRatioAvg":0.00016504373659019642,"completedParallelInputs":"1","computeRatioMax":0.0011553061561313748,"name":"S0F: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.001980524839082357,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_year","FROM date_dim","WHERE equal($31, 2002)"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage0F_output","BY HASH($30)"]}],"writeRatioAvg":0.000825218682950982},{"readMsMax":"25","computeMsMax":"382","waitMsAvg":"1","id":"17","endMs":"1570971346228","waitMsMax":"1","startMs":"1570971345418","waitRatioMax":0.00016504373659019642,"readRatioAvg":0.00412609341475491,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.06304670737745502,"writeMsAvg":"76","status":"COMPLETE","writeMsMax":"76","computeMsAvg":"382","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012543323980854927,"readMsAvg":"25","waitRatioAvg":0.00016504373659019642,"completedParallelInputs":"1","computeRatioMax":0.06304670737745502,"name":"S11: Input","shuffleOutputBytes":"15000000","recordsWritten":"500000","readRatioMax":0.00412609341475491,"steps":[{"kind":"READ","substeps":["$10:c_customer_sk, $11:c_customer_id","FROM customer"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage11_output","BY HASH($10)"]}],"writeRatioAvg":0.012543323980854927},{"readMsMax":"65","computeMsMax":"4143","inputStages":["9","11"],"waitMsAvg":"1","id":"18","endMs":"1570971347978","waitMsMax":"1","startMs":"1570971345827","waitRatioMax":0.00016504373659019642,"readRatioAvg":0.007757055619739231,"parallelInputs":"8","recordsRead":"18400243","computeRatioAvg":0.575672553226605,"writeMsAvg":"15","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"3488","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004456180887935303,"readMsAvg":"47","waitRatioAvg":0.00016504373659019642,"completedParallelInputs":"8","computeRatioMax":0.6837762006931837,"name":"S12: Join+","shuffleOutputBytes":"54119912","recordsWritten":"1387984","readRatioMax":0.010727842878362766,"steps":[{"kind":"READ","substeps":["$80:cs_sold_date_sk, $81:cs_bill_customer_sk, $82:cs_ext_discount_amt, $83:cs_ext_sales_price, $84:cs_ext_wholesale_cost, $85:cs_ext_list_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$70, $71","FROM __stage0B_output"]},{"kind":"READ","substeps":["$90, $91","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $530 := $520, $531 := $525","$270 := SUM($300)"]},{"kind":"COMPUTE","substeps":["$300 := divide(add(subtract(subtract($524, $523), $521), $522), 2)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $511 = $90"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $81 = $70"]},{"kind":"WRITE","substeps":["$530, $531, $270","TO __stage12_output","BY HASH($530, $531)"]}],"writeRatioAvg":0.002475656048852946},{"readMsMax":"98","computeMsMax":"6059","inputStages":["0","2"],"waitMsAvg":"1","id":"19","endMs":"1570971351692","waitMsMax":"2","startMs":"1570971345901","waitRatioMax":0.00033008747318039283,"readRatioAvg":0.007426968146558838,"parallelInputs":"10","recordsRead":"33805762","computeRatioAvg":0.8161412774385212,"writeMsAvg":"34","status":"COMPLETE","writeMsMax":"201","computeMsAvg":"4945","shuffleOutputBytesSpilled":"0","writeRatioMax":0.033173791054629476,"readMsAvg":"45","waitRatioAvg":0.00016504373659019642,"completedParallelInputs":"10","computeRatioMax":1,"name":"S13: Join+","shuffleOutputBytes":"93173475","recordsWritten":"2393453","readRatioMax":0.016174286185839246,"steps":[{"kind":"READ","substeps":["$170:ss_sold_date_sk, $171:ss_customer_sk, $172:ss_ext_discount_amt, $173:ss_ext_sales_price, $174:ss_ext_wholesale_cost, $175:ss_ext_list_price","FROM store_sales"]},{"kind":"READ","substeps":["$160, $161","FROM __stage02_output"]},{"kind":"READ","substeps":["$180, $181","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $390 := $380, $391 := $385","$330 := SUM($360)"]},{"kind":"COMPUTE","substeps":["$360 := divide(add(subtract(subtract($384, $383), $381), $382), 2)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $371 = $180"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $171 = $160"]},{"kind":"WRITE","substeps":["$390, $391, $330","TO __stage13_output","BY HASH($390, $391)"]}],"writeRatioAvg":0.0056114870440666775},{"readMsMax":"59","computeMsMax":"4691","inputStages":["3","5"],"waitMsAvg":"1","id":"20","endMs":"1570971348562","waitMsMax":"1","startMs":"1570971346071","waitRatioMax":0.00016504373659019642,"readRatioAvg":0.007096880673378445,"parallelInputs":"8","recordsRead":"18400243","computeRatioAvg":0.5651097540848324,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"3424","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004456180887935303,"readMsAvg":"43","waitRatioAvg":0.00016504373659019642,"completedParallelInputs":"8","computeRatioMax":0.7742201683446113,"name":"S14: Join+","shuffleOutputBytes":"54025425","recordsWritten":"1385559","readRatioMax":0.009737580458821588,"steps":[{"kind":"READ","substeps":["$140:cs_sold_date_sk, $141:cs_bill_customer_sk, $142:cs_ext_discount_amt, $143:cs_ext_sales_price, $144:cs_ext_wholesale_cost, $145:cs_ext_list_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$130, $131","FROM __stage05_output"]},{"kind":"READ","substeps":["$150, $151","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $480 := $470, $481 := $475","$320 := SUM($350)"]},{"kind":"COMPUTE","substeps":["$350 := divide(add(subtract(subtract($474, $473), $471), $472), 2)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $461 = $150"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $141 = $130"]},{"kind":"WRITE","substeps":["$480, $481, $320","TO __stage14_output","BY HASH($480, $481)"]}],"writeRatioAvg":0.001980524839082357},{"readMsMax":"54","computeMsMax":"5953","inputStages":["6","8"],"waitMsAvg":"2","id":"21","endMs":"1570971350154","waitMsMax":"5","startMs":"1570971346435","waitRatioMax":0.000825218682950982,"readRatioAvg":0.006601749463607856,"parallelInputs":"10","recordsRead":"33805762","computeRatioAvg":0.8153160587555702,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"13","computeMsAvg":"4940","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002145568575672553,"readMsAvg":"40","waitRatioAvg":0.00033008747318039283,"completedParallelInputs":"10","computeRatioMax":0.9825053639214392,"name":"S15: Join+","shuffleOutputBytes":"93631441","recordsWritten":"2405223","readRatioMax":0.008912361775870606,"steps":[{"kind":"READ","substeps":["$110:ss_sold_date_sk, $111:ss_customer_sk, $112:ss_ext_discount_amt, $113:ss_ext_sales_price, $114:ss_ext_wholesale_cost, $115:ss_ext_list_price","FROM store_sales"]},{"kind":"READ","substeps":["$100, $101","FROM __stage08_output"]},{"kind":"READ","substeps":["$120, $121","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $430 := $420, $431 := $425","$310 := SUM($340)"]},{"kind":"COMPUTE","substeps":["$340 := divide(add(subtract(subtract($424, $423), $421), $422), 2)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $411 = $120"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $111 = $100"]},{"kind":"WRITE","substeps":["$430, $431, $310","TO __stage15_output","BY HASH($430, $431)"]}],"writeRatioAvg":0.0018154811024921605},{"readMsMax":"49","computeMsMax":"3831","inputStages":["15","17"],"waitMsAvg":"1","id":"22","endMs":"1570971348565","waitMsMax":"1","startMs":"1570971346456","waitRatioMax":0.00016504373659019642,"readRatioAvg":0.006766793200198053,"parallelInputs":"4","recordsRead":"9202490","computeRatioAvg":0.5396930186499422,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"3270","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0037960059415745174,"readMsAvg":"41","waitRatioAvg":0.00016504373659019642,"completedParallelInputs":"4","computeRatioMax":0.6322825548770424,"name":"S16: Join+","shuffleOutputBytes":"15994647","recordsWritten":"410121","readRatioMax":0.008087143092919623,"steps":[{"kind":"READ","substeps":["$20:ws_sold_date_sk, $21:ws_bill_customer_sk, $22:ws_ext_discount_amt, $23:ws_ext_sales_price, $24:ws_ext_wholesale_cost, $25:ws_ext_list_price","FROM web_sales"]},{"kind":"READ","substeps":["$10, $11","FROM __stage11_output"]},{"kind":"READ","substeps":["$30, $31","FROM __stage0F_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $630 := $620, $631 := $625","$210 := SUM($230)"]},{"kind":"COMPUTE","substeps":["$230 := divide(add(subtract(subtract($624, $623), $621), $622), 2)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $611 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $21 = $10"]},{"kind":"WRITE","substeps":["$630, $631, $210","TO __stage16_output","BY HASH($630, $631)"]}],"writeRatioAvg":0.0026406997854431426},{"readMsMax":"102","computeMsMax":"3823","inputStages":["12","14"],"waitMsAvg":"1","id":"23","endMs":"1570971351164","waitMsMax":"1","startMs":"1570971348717","waitRatioMax":0.00016504373659019642,"readRatioAvg":0.01006766793200198,"parallelInputs":"4","recordsRead":"9202490","computeRatioAvg":0.5933322330417561,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"26","computeMsAvg":"3595","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004291137151345106,"readMsAvg":"61","waitRatioAvg":0.00016504373659019642,"completedParallelInputs":"4","computeRatioMax":0.6309622049843209,"name":"S17: Join+","shuffleOutputBytes":"15926296","recordsWritten":"408368","readRatioMax":0.016834461132200034,"steps":[{"kind":"READ","substeps":["$50:ws_sold_date_sk, $51:ws_bill_customer_sk, $52:ws_ext_discount_amt, $53:ws_ext_sales_price, $54:ws_ext_wholesale_cost, $55:ws_ext_list_price","FROM web_sales"]},{"kind":"READ","substeps":["$40, $41","FROM __stage0E_output"]},{"kind":"READ","substeps":["$60, $61","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $580 := $570, $581 := $575","$240 := SUM($280)"]},{"kind":"COMPUTE","substeps":["$280 := divide(add(subtract(subtract($574, $573), $571), $572), 2)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $561 = $60"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $51 = $40"]},{"kind":"WRITE","substeps":["$580, $581, $240","TO __stage17_output","BY HASH($580, $581)"]}],"writeRatioAvg":0.001980524839082357},{"readMsMax":"84","computeMsMax":"627","waitMsAvg":"1","id":"24","endMs":"1570971355514","waitMsMax":"1","startMs":"1570971352010","waitRatioMax":0.00016504373659019642,"readRatioAvg":0.013863673873576498,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.10348242284205314,"writeMsAvg":"2467","status":"COMPLETE","writeMsMax":"2467","computeMsAvg":"627","shuffleOutputBytesSpilled":"0","writeRatioMax":0.40716289816801454,"readMsAvg":"84","waitRatioAvg":0.00016504373659019642,"completedParallelInputs":"1","computeRatioMax":0.10348242284205314,"name":"S18: Input","shuffleOutputBytes":"24046998","recordsWritten":"500000","readRatioMax":0.013863673873576498,"steps":[{"kind":"READ","substeps":["$1:c_customer_id, $2:c_first_name, $3:c_last_name, $4:c_preferred_cust_flag","FROM customer"]},{"kind":"WRITE","substeps":["$1, $2, $3, $4","TO __stage18_output","BY HASH($1)"]}],"writeRatioAvg":0.40716289816801454},{"readMsMax":"0","computeMsMax":"463","inputStages":["22"],"waitMsAvg":"1","id":"25","endMs":"1570971352321","waitMsMax":"1","startMs":"1570971352026","waitRatioMax":0.00016504373659019642,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"410121","computeRatioAvg":0.07641525004126093,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"25","computeMsAvg":"463","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00412609341475491,"readMsAvg":"0","waitRatioAvg":0.00016504373659019642,"completedParallelInputs":"1","computeRatioMax":0.07641525004126093,"name":"S19: Aggregate","shuffleOutputBytes":"3194220","recordsWritten":"106474","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$630, $631, $210","FROM __stage16_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $640 := $630, $641 := $631","$190 := SUM($210)"]},{"kind":"WRITE","substeps":["$190, $640","TO __stage19_output","BY HASH($640)"]}],"writeRatioAvg":0.00412609341475491},{"readMsMax":"0","computeMsMax":"676","inputStages":["23"],"waitMsAvg":"1","id":"26","endMs":"1570971352450","waitMsMax":"1","startMs":"1570971352062","waitRatioMax":0.00016504373659019642,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"408368","computeRatioAvg":0.11156956593497276,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"676","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004456180887935303,"readMsAvg":"0","waitRatioAvg":0.00016504373659019642,"completedParallelInputs":"1","computeRatioMax":0.11156956593497276,"name":"S1A: Aggregate+","shuffleOutputBytes":"3124680","recordsWritten":"104156","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$580, $581, $240","FROM __stage17_output"]},{"kind":"FILTER","substeps":["greater($200, 0)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $590 := $580, $591 := $581","$200 := SUM($240)"]},{"kind":"WRITE","substeps":["$200, $590","TO __stage1A_output","BY HASH($590)"]}],"writeRatioAvg":0.004456180887935303},{"readMsMax":"0","computeMsMax":"2129","inputStages":["18"],"waitMsAvg":"3","id":"27","endMs":"1570971353186","waitMsMax":"3","startMs":"1570971352091","waitRatioMax":0.0004951312097705892,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1387984","computeRatioAvg":0.35137811520052814,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"2129","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004786268361115695,"readMsAvg":"0","waitRatioAvg":0.0004951312097705892,"completedParallelInputs":"1","computeRatioMax":0.35137811520052814,"name":"S1B: Aggregate","shuffleOutputBytes":"7071300","recordsWritten":"235710","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$530, $531, $270","FROM __stage12_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $540 := $530, $541 := $531","$220 := SUM($270)"]},{"kind":"WRITE","substeps":["$220, $540","TO __stage1B_output","BY HASH($540)"]}],"writeRatioAvg":0.004786268361115695},{"readMsMax":"0","computeMsMax":"2373","inputStages":["20"],"waitMsAvg":"1","id":"28","endMs":"1570971353478","waitMsMax":"1","startMs":"1570971352180","waitRatioMax":0.00016504373659019642,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1385559","computeRatioAvg":0.39164878692853605,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"2373","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004456180887935303,"readMsAvg":"0","waitRatioAvg":0.00016504373659019642,"completedParallelInputs":"1","computeRatioMax":0.39164878692853605,"name":"S1C: Aggregate+","shuffleOutputBytes":"6818250","recordsWritten":"227275","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$480, $481, $320","FROM __stage14_output"]},{"kind":"FILTER","substeps":["greater($260, 0)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $490 := $480, $491 := $481","$260 := SUM($320)"]},{"kind":"WRITE","substeps":["$260, $490","TO __stage1C_output","BY HASH($490)"]}],"writeRatioAvg":0.004456180887935303},{"readMsMax":"0","computeMsMax":"3672","inputStages":["21"],"waitMsAvg":"1","id":"29","endMs":"1570971354077","waitMsMax":"1","startMs":"1570971352197","waitRatioMax":0.00016504373659019642,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2405223","computeRatioAvg":0.6060406007592012,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"3672","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004786268361115695,"readMsAvg":"0","waitRatioAvg":0.00016504373659019642,"completedParallelInputs":"1","computeRatioMax":0.6060406007592012,"name":"S1D: Aggregate","shuffleOutputBytes":"9277200","recordsWritten":"309240","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$430, $431, $310","FROM __stage15_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $440 := $430, $441 := $431","$250 := SUM($310)"]},{"kind":"WRITE","substeps":["$250, $440","TO __stage1D_output","BY HASH($440)"]}],"writeRatioAvg":0.004786268361115695},{"readMsMax":"0","computeMsMax":"12","inputStages":["29"],"waitMsAvg":"16","id":"31","endMs":"1570971354745","waitMsMax":"30","startMs":"1570971354612","waitRatioMax":0.004951312097705892,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"309240","computeRatioAvg":0.0011553061561313748,"writeMsAvg":"14","status":"COMPLETE","writeMsMax":"39","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00643670572701766,"readMsAvg":"0","waitRatioAvg":0.0026406997854431426,"completedParallelInputs":"100","computeRatioMax":0.001980524839082357,"name":"S1F: Coalesce","shuffleOutputBytes":"9277200","recordsWritten":"309240","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage1D_output"]}],"writeRatioAvg":0.0023106123122627496},{"readMsMax":"0","computeMsMax":"10","inputStages":["28"],"waitMsAvg":"40","id":"32","endMs":"1570971354914","waitMsMax":"49","startMs":"1570971354620","waitRatioMax":0.008087143092919623,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"227275","computeRatioAvg":0.0009902624195411785,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"33","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005446443307476481,"readMsAvg":"0","waitRatioAvg":0.006601749463607856,"completedParallelInputs":"100","computeRatioMax":0.001650437365901964,"name":"S20: Coalesce","shuffleOutputBytes":"6818250","recordsWritten":"227275","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage1C_output"]}],"writeRatioAvg":0.0009902624195411785},{"readMsMax":"0","computeMsMax":"12","inputStages":["27"],"waitMsAvg":"46","id":"33","endMs":"1570971354907","waitMsMax":"50","startMs":"1570971354619","waitRatioMax":0.00825218682950982,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"235710","computeRatioAvg":0.0009902624195411785,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004786268361115695,"readMsAvg":"0","waitRatioAvg":0.007592011883149035,"completedParallelInputs":"100","computeRatioMax":0.001980524839082357,"name":"S21: Coalesce","shuffleOutputBytes":"7071300","recordsWritten":"235710","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage1B_output"]}],"writeRatioAvg":0.0014853936293117676},{"readMsMax":"0","computeMsMax":"10","inputStages":["26"],"waitMsAvg":"49","id":"34","endMs":"1570971355075","waitMsMax":"51","startMs":"1570971354622","waitRatioMax":0.008417230566100017,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"104156","computeRatioAvg":0.000825218682950982,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"34","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0056114870440666775,"readMsAvg":"0","waitRatioAvg":0.008087143092919623,"completedParallelInputs":"100","computeRatioMax":0.001650437365901964,"name":"S22: Coalesce","shuffleOutputBytes":"3124680","recordsWritten":"104156","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage1A_output"]}],"writeRatioAvg":0.001650437365901964},{"readMsMax":"0","computeMsMax":"11","inputStages":["25"],"waitMsAvg":"54","id":"35","endMs":"1570971354910","waitMsMax":"68","startMs":"1570971354618","waitRatioMax":0.011222974088133355,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"106474","computeRatioAvg":0.000825218682950982,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"79","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013038455190625516,"readMsAvg":"0","waitRatioAvg":0.008912361775870606,"completedParallelInputs":"100","computeRatioMax":0.0018154811024921605,"name":"S23: Coalesce","shuffleOutputBytes":"3194220","recordsWritten":"106474","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage19_output"]}],"writeRatioAvg":0.0013203498927215713},{"readMsMax":"0","computeMsMax":"4698","inputStages":["19","31","35","24","34","33","32"],"waitMsAvg":"1","id":"37","endMs":"1570971358872","waitMsMax":"1","startMs":"1570971356127","waitRatioMax":0.00016504373659019642,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"3876308","computeRatioAvg":0.7753754745007427,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"4698","shuffleOutputBytesSpilled":"0","writeRatioMax":0.000825218682950982,"readMsAvg":"0","waitRatioAvg":0.00016504373659019642,"completedParallelInputs":"1","computeRatioMax":0.7753754745007427,"name":"S25: Join+","shuffleOutputBytes":"4849","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$390, $391, $330","FROM __stage13_output"]},{"kind":"READ","substeps":["$250, $440","FROM __stage1F_output"]},{"kind":"READ","substeps":["$260, $490","FROM __stage20_output"]},{"kind":"READ","substeps":["$220, $540","FROM __stage21_output"]},{"kind":"READ","substeps":["$200, $590","FROM __stage22_output"]},{"kind":"READ","substeps":["$190, $640","FROM __stage23_output"]},{"kind":"READ","substeps":["$1, $2, $3, $4","FROM __stage18_output"]},{"kind":"SORT","substeps":["$660 ASC","LIMIT 100"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $650 = $1"]},{"kind":"FILTER","substeps":["greater(case_no_value(greater($653, 0), divide($652, $653), NULL), case_no_value(greater($651, 0), divide($654, $651), NULL))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $601 = $640"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $551 = $590"]},{"kind":"FILTER","substeps":["greater(case_no_value(greater($553, 0), divide($555, $553), NULL), case_no_value(greater($554, 0), divide($552, $554), NULL))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $501 = $540"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $450 = $490"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $400 = $440"]},{"kind":"FILTER","substeps":["greater($290, 0)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $400 := $390, $401 := $391","$290 := SUM($330)"]},{"kind":"WRITE","substeps":["$670, $671, $672, $673","TO __stage25_output"]}],"writeRatioAvg":0.000825218682950982},{"readMsMax":"0","computeMsMax":"7","inputStages":["37"],"waitMsAvg":"1","id":"38","endMs":"1570971359211","waitMsMax":"1","startMs":"1570971356148","waitRatioMax":0.00016504373659019642,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0011553061561313748,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0013203498927215713,"readMsAvg":"0","waitRatioAvg":0.00016504373659019642,"completedParallelInputs":"1","computeRatioMax":0.0011553061561313748,"name":"S26: Output","shuffleOutputBytes":"4849","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$670, $671, $672, $673","FROM __stage25_output"]},{"kind":"SORT","substeps":["$673 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$680, $681, $682, $683","TO __stage26_output"]}],"writeRatioAvg":0.0013203498927215713}],"estimatedBytesProcessed":"2376786058","timeline":[{"totalSlotMs":"6725","activeUnits":"50","completedUnits":"6","elapsedMs":"785","pendingUnits":"50"},{"totalSlotMs":"98210","activeUnits":"45","completedUnits":"11","elapsedMs":"2248","pendingUnits":"45"},{"totalSlotMs":"198042","activeUnits":"34","completedUnits":"32","elapsedMs":"3592","pendingUnits":"24"},{"totalSlotMs":"236830","activeUnits":"17","completedUnits":"47","elapsedMs":"4727","pendingUnits":"9"},{"totalSlotMs":"255398","activeUnits":"8","completedUnits":"53","elapsedMs":"5967","pendingUnits":"3"},{"totalSlotMs":"260735","activeUnits":"5","completedUnits":"56","elapsedMs":"7506","pendingUnits":"6"},{"totalSlotMs":"275242","activeUnits":"5","completedUnits":"60","elapsedMs":"9000","pendingUnits":"3"},{"totalSlotMs":"334140","activeUnits":"2","completedUnits":"561","elapsedMs":"10426","pendingUnits":"2"},{"totalSlotMs":"338373","activeUnits":"2","completedUnits":"562","elapsedMs":"11942","pendingUnits":"2"},{"totalSlotMs":"346752","activeUnits":"0","completedUnits":"564","elapsedMs":"14884","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"2377121792","totalPartitionsProcessed":"0","totalBytesProcessed":"2376786058","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570971359597"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query4_1570971343"},"etag":"BIT0UwI9pMm0AMn4C3pO1w==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query4_1570971343?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon092b61bacb6d345133bcf36961024772d6c85e4f","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query4\nWITH year_total \n AS (SELECT c_customer_id customer_id, \n d_year dyear, \n Sum(( ( ss_ext_list_price - ss_ext_wholesale_cost \n - ss_ext_discount_amt \n ) \n + \n ss_ext_sales_price ) / 2) year_total, \n 's' sale_type \n FROM customer, \n store_sales, \n date_dim \n WHERE c_customer_sk = ss_customer_sk \n AND ss_sold_date_sk = d_date_sk \n GROUP BY c_customer_id, \n d_year \n UNION ALL \n SELECT c_customer_id customer_id, \n d_year dyear, \n Sum(( ( ( cs_ext_list_price \n - cs_ext_wholesale_cost \n - cs_ext_discount_amt \n ) + \n cs_ext_sales_price ) / 2 )) year_total, \n 'c' sale_type \n FROM customer, \n catalog_sales, \n date_dim \n WHERE c_customer_sk = cs_bill_customer_sk \n AND cs_sold_date_sk = d_date_sk \n GROUP BY c_customer_id, \n d_year \n UNION ALL \n SELECT c_customer_id customer_id, \n d_year dyear, \n Sum(( ( ( ws_ext_list_price \n - ws_ext_wholesale_cost \n - ws_ext_discount_amt \n ) + \n ws_ext_sales_price ) / 2 )) year_total, \n 'w' sale_type \n FROM customer, \n web_sales, \n date_dim \n WHERE c_customer_sk = ws_bill_customer_sk \n AND ws_sold_date_sk = d_date_sk \n GROUP BY c_customer_id, \n d_year) \nSELECT t_s_secyear.customer_id, \n customer.c_first_name, \n customer.c_last_name, \n customer.c_preferred_cust_flag \nFROM year_total t_s_firstyear, \n year_total t_s_secyear, \n year_total t_c_firstyear, \n year_total t_c_secyear, \n year_total t_w_firstyear, \n year_total t_w_secyear,\n customer\nWHERE t_s_secyear.customer_id = t_s_firstyear.customer_id \n AND t_s_firstyear.customer_id = t_c_secyear.customer_id \n AND t_s_firstyear.customer_id = t_c_firstyear.customer_id \n AND t_s_firstyear.customer_id = t_w_firstyear.customer_id \n AND t_s_firstyear.customer_id = t_w_secyear.customer_id \n AND t_s_secyear.customer_id = customer.c_customer_id\n AND t_s_firstyear.sale_type = 's' \n AND t_c_firstyear.sale_type = 'c' \n AND t_w_firstyear.sale_type = 'w' \n AND t_s_secyear.sale_type = 's' \n AND t_c_secyear.sale_type = 'c' \n AND t_w_secyear.sale_type = 'w' \n AND t_s_firstyear.dyear = 2001 \n AND t_s_secyear.dyear = 2001 + 1 \n AND t_c_firstyear.dyear = 2001 \n AND t_c_secyear.dyear = 2001 + 1 \n AND t_w_firstyear.dyear = 2001 \n AND t_w_secyear.dyear = 2001 + 1 \n AND t_s_firstyear.year_total > 0 \n AND t_c_firstyear.year_total > 0 \n AND t_w_firstyear.year_total > 0 \n AND CASE \n WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / \n t_c_firstyear.year_total \n ELSE NULL \n END > CASE \n WHEN t_s_firstyear.year_total > 0 THEN \n t_s_secyear.year_total / \n t_s_firstyear.year_total \n ELSE NULL \n END \n AND CASE \n WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / \n t_c_firstyear.year_total \n ELSE NULL \n END > CASE \n WHEN t_w_firstyear.year_total > 0 THEN \n t_w_secyear.year_total / \n t_w_firstyear.year_total \n ELSE NULL \n END \nORDER BY t_s_secyear.customer_id\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query4_1570971343","user_email":"nithish.sankaranarayanan@ulb.be"}
