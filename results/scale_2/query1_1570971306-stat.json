{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"46309","creationTime":"1570971307518","totalBytesProcessed":"103041216","startTime":"1570971307637","query":{"totalSlotMs":"46309","queryPlan":[{"readMsMax":"100","computeMsMax":"7","waitMsAvg":"1","id":"0","endMs":"1570971307991","waitMsMax":"1","startMs":"1570971307862","waitRatioMax":0.00010048231511254019,"readRatioAvg":0.01004823151125402,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0007033762057877814,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007033762057877814,"readMsAvg":"100","waitRatioAvg":0.00010048231511254019,"completedParallelInputs":"1","computeRatioMax":0.0007033762057877814,"name":"S00: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.01004823151125402,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year","FROM date_dim","WHERE equal($51, 2001)"]},{"kind":"WRITE","substeps":["$50","TO __stage00_output","BY HASH($50)"]}],"writeRatioAvg":0.0007033762057877814},{"readMsMax":"10","computeMsMax":"9","waitMsAvg":"86","id":"2","endMs":"1570971317949","waitMsMax":"86","startMs":"1570971307975","waitRatioMax":0.008641479099678457,"readRatioAvg":0.0010048231511254019,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0009043408360128617,"writeMsAvg":"9952","status":"COMPLETE","writeMsMax":"9952","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":1,"readMsAvg":"10","waitRatioAvg":0.008641479099678457,"completedParallelInputs":"1","computeRatioMax":0.0009043408360128617,"name":"S02: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.0010048231511254019,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_year","FROM date_dim","WHERE equal($31, 2001)"]},{"kind":"WRITE","substeps":["$30","TO __stage02_output","BY HASH($30)"]}],"writeRatioAvg":1},{"readMsMax":"30","computeMsMax":"2187","inputStages":["0"],"waitMsAvg":"38","id":"4","endMs":"1570971309222","waitMsMax":"38","startMs":"1570971308072","waitRatioMax":0.0038183279742765273,"readRatioAvg":0.0030144694533762056,"parallelInputs":"1","recordsRead":"2878695","computeRatioAvg":0.2197548231511254,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"2187","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0029139871382636655,"readMsAvg":"30","waitRatioAvg":0.0038183279742765273,"completedParallelInputs":"1","computeRatioMax":0.2197548231511254,"name":"S04: Join+","shuffleOutputBytes":"14331690","recordsWritten":"533726","readRatioMax":0.0030144694533762056,"steps":[{"kind":"READ","substeps":["$40:sr_returned_date_sk, $41:sr_customer_sk, $42:sr_store_sk, $43:sr_return_amt","FROM store_returns"]},{"kind":"READ","substeps":["$50","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $170, $181 := $171","$110 := SUM($172)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $50"]},{"kind":"WRITE","substeps":["$180, $181, $110","TO __stage04_output","BY HASH($180, $181)"]}],"writeRatioAvg":0.0029139871382636655},{"readMsMax":"0","computeMsMax":"691","inputStages":["4"],"waitMsAvg":"66","id":"5","endMs":"1570971309818","waitMsMax":"66","startMs":"1570971309413","waitRatioMax":0.006631832797427652,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"533726","computeRatioAvg":0.06943327974276527,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"691","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0006028938906752412,"readMsAvg":"0","waitRatioAvg":0.006631832797427652,"completedParallelInputs":"1","computeRatioMax":0.06943327974276527,"name":"S05: Aggregate","shuffleOutputBytes":"1344","recordsWritten":"52","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$180, $181, $110","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $200 := $191","$80 := SHARD_AVG($90)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $180, $191 := $181","$90 := SUM($110)"]},{"kind":"WRITE","substeps":["$200, $80","TO __stage05_output","BY HASH($200)"]}],"writeRatioAvg":0.0006028938906752412},{"readMsMax":"57","computeMsMax":"2716","inputStages":["2"],"waitMsAvg":"1","id":"6","endMs":"1570971320856","waitMsMax":"1","startMs":"1570971319159","waitRatioMax":0.00010048231511254019,"readRatioAvg":0.005727491961414791,"parallelInputs":"1","recordsRead":"2878695","computeRatioAvg":0.2729099678456592,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"2716","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0021101286173633442,"readMsAvg":"57","waitRatioAvg":0.00010048231511254019,"completedParallelInputs":"1","computeRatioMax":0.2729099678456592,"name":"S06: Join+","shuffleOutputBytes":"14331690","recordsWritten":"533726","readRatioMax":0.005727491961414791,"steps":[{"kind":"READ","substeps":["$20:sr_returned_date_sk, $21:sr_customer_sk, $22:sr_store_sk, $23:sr_return_amt","FROM store_returns"]},{"kind":"READ","substeps":["$30","FROM __stage02_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $130 := $120, $131 := $121","$100 := SUM($122)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $30"]},{"kind":"WRITE","substeps":["$130, $131, $100","TO __stage06_output","BY HASH($130, $131)"]}],"writeRatioAvg":0.0021101286173633442},{"readMsMax":"0","computeMsMax":"5","inputStages":["5"],"waitMsAvg":"1","id":"7","endMs":"1570971321247","waitMsMax":"1","startMs":"1570971321173","waitRatioMax":0.00010048231511254019,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"52","computeRatioAvg":0.0005024115755627009,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002411575562700965,"readMsAvg":"0","waitRatioAvg":0.00010048231511254019,"completedParallelInputs":"1","computeRatioMax":0.0005024115755627009,"name":"S07: Aggregate","shuffleOutputBytes":"918","recordsWritten":"51","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$200, $80","FROM __stage05_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $210 := $200","$60 := ROOT_AVG($80)"]},{"kind":"WRITE","substeps":["$60, $210","TO __stage07_output","BY HASH($210)"]}],"writeRatioAvg":0.002411575562700965},{"readMsMax":"24","computeMsMax":"8","waitMsAvg":"1","id":"9","endMs":"1570971321297","waitMsMax":"1","startMs":"1570971321210","waitRatioMax":0.00010048231511254019,"readRatioAvg":0.002411575562700965,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.0008038585209003215,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0006028938906752412,"readMsAvg":"24","waitRatioAvg":0.00010048231511254019,"completedParallelInputs":"1","computeRatioMax":0.0008038585209003215,"name":"S09: Input","shuffleOutputBytes":"306","recordsWritten":"34","readRatioMax":0.002411575562700965,"steps":[{"kind":"READ","substeps":["$10:s_store_sk, $11:s_state","FROM store","WHERE equal($11, 'TN')"]},{"kind":"WRITE","substeps":["$10","TO __stage09_output","BY HASH($10)"]}],"writeRatioAvg":0.0006028938906752412},{"readMsMax":"0","computeMsMax":"980","inputStages":["6","9"],"waitMsAvg":"2","id":"11","endMs":"1570971321864","waitMsMax":"2","startMs":"1570971321327","waitRatioMax":0.00020096463022508038,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"533760","computeRatioAvg":0.09847266881028939,"writeMsAvg":"30","status":"COMPLETE","writeMsMax":"30","computeMsAvg":"980","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0030144694533762056,"readMsAvg":"0","waitRatioAvg":0.00020096463022508038,"completedParallelInputs":"1","computeRatioMax":0.09847266881028939,"name":"S0B: Join+","shuffleOutputBytes":"4768104","recordsWritten":"176832","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$130, $131, $100","FROM __stage06_output"]},{"kind":"READ","substeps":["$10","FROM __stage09_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $141 = $10"]},{"kind":"AGGREGATE","substeps":["GROUP BY $140 := $130, $141 := $131","$70 := SUM($100)"]},{"kind":"WRITE","substeps":["$150, $151, $152","TO __stage0B_output","BY HASH($150)"]}],"writeRatioAvg":0.0030144694533762056},{"readMsMax":"0","computeMsMax":"11","inputStages":["11"],"waitMsAvg":"2","id":"12","endMs":"1570971322154","waitMsMax":"6","startMs":"1570971322013","waitRatioMax":0.0006028938906752412,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"176832","computeRatioAvg":0.0006028938906752412,"writeMsAvg":"51","status":"COMPLETE","writeMsMax":"62","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006229903536977492,"readMsAvg":"0","waitRatioAvg":0.00020096463022508038,"completedParallelInputs":"100","computeRatioMax":0.0011053054662379421,"name":"S0C: Coalesce","shuffleOutputBytes":"4768104","recordsWritten":"176832","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0B_output"]}],"writeRatioAvg":0.00512459807073955},{"readMsMax":"0","computeMsMax":"9","inputStages":["7"],"waitMsAvg":"7","id":"13","endMs":"1570971322146","waitMsMax":"11","startMs":"1570971322014","waitRatioMax":0.0011053054662379421,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"51","computeRatioAvg":0.0005024115755627009,"writeMsAvg":"33","status":"COMPLETE","writeMsMax":"64","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006430868167202572,"readMsAvg":"0","waitRatioAvg":0.0007033762057877814,"completedParallelInputs":"100","computeRatioMax":0.0009043408360128617,"name":"S0D: Coalesce","shuffleOutputBytes":"918","recordsWritten":"51","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage07_output"]}],"writeRatioAvg":0.003315916398713826},{"readMsMax":"27","computeMsMax":"387","inputStages":["13","12"],"waitMsAvg":"11","id":"14","endMs":"1570971322408","waitMsMax":"11","startMs":"1570971322025","waitRatioMax":0.0011053054662379421,"readRatioAvg":0.0027130225080385854,"parallelInputs":"1","recordsRead":"676883","computeRatioAvg":0.038886655948553055,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"3","computeMsAvg":"387","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0003014469453376206,"readMsAvg":"27","waitRatioAvg":0.0011053054662379421,"completedParallelInputs":"1","computeRatioMax":0.038886655948553055,"name":"S0E: Join+","shuffleOutputBytes":"2100","recordsWritten":"100","readRatioMax":0.0027130225080385854,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_customer_id","FROM customer"]},{"kind":"READ","substeps":["$150, $151, $152","FROM __stage0C_output"]},{"kind":"READ","substeps":["$60, $210","FROM __stage0D_output"]},{"kind":"SORT","substeps":["$220 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["greater($221, multiply($222, 1.2))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $160 = $210"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $150"]},{"kind":"WRITE","substeps":["$230","TO __stage0E_output"]}],"writeRatioAvg":0.0003014469453376206},{"readMsMax":"0","computeMsMax":"4","inputStages":["14"],"waitMsAvg":"1","id":"15","endMs":"1570971322464","waitMsMax":"1","startMs":"1570971322042","waitRatioMax":0.00010048231511254019,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.00040192926045016077,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0006028938906752412,"readMsAvg":"0","waitRatioAvg":0.00010048231511254019,"completedParallelInputs":"1","computeRatioMax":0.00040192926045016077,"name":"S0F: Output","shuffleOutputBytes":"2100","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$230","FROM __stage0E_output"]},{"kind":"SORT","substeps":["$230 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$240","TO __stage0F_output"]}],"writeRatioAvg":0.0006028938906752412}],"estimatedBytesProcessed":"103041216","timeline":[{"totalSlotMs":"533","activeUnits":"3","completedUnits":"1","elapsedMs":"725","pendingUnits":"3"},{"totalSlotMs":"7018","activeUnits":"3","completedUnits":"3","elapsedMs":"2683","pendingUnits":"2"},{"totalSlotMs":"10429","activeUnits":"1","completedUnits":"4","elapsedMs":"4270","pendingUnits":"1"},{"totalSlotMs":"21029","activeUnits":"0","completedUnits":"5","elapsedMs":"10813","pendingUnits":"0"},{"totalSlotMs":"21590","activeUnits":"1","completedUnits":"4","elapsedMs":"12023","pendingUnits":"1"},{"totalSlotMs":"24534","activeUnits":"2","completedUnits":"7","elapsedMs":"13721","pendingUnits":"2"},{"totalSlotMs":"46309","activeUnits":"2","completedUnits":"210","elapsedMs":"14998","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"103809024","totalPartitionsProcessed":"0","totalBytesProcessed":"103041216","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_10"}]},"endTime":"1570971322662"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query1_1570971306"},"etag":"h5zbIiz5Wyj6Nq0w5clBpg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query1_1570971306?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon683b6d13419d809368e58ffde54889ac282ed9c1","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query1\nWITH customer_total_return \n AS (SELECT sr_customer_sk AS ctr_customer_sk, \n sr_store_sk AS ctr_store_sk, \n Sum(sr_return_amt) AS ctr_total_return \n FROM store_returns, \n date_dim \n WHERE sr_returned_date_sk = d_date_sk \n AND d_year = 2001 \n GROUP BY sr_customer_sk, \n sr_store_sk),\nhigh_return AS (\n SELECT ctr_store_sk, Avg(ctr_total_return) benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results warmup 1.2 AS return_limit\n FROM customer_total_return ctr2 \n GROUP BY ctr_store_sk\n)\nSELECT c_customer_id \nFROM customer_total_return ctr1, \n store, \n customer,\n high_return \nWHERE ctr1.ctr_total_return > high_return.return_limit\n AND s_store_sk = ctr1.ctr_store_sk \n AND s_state = 'TN' \n AND ctr1.ctr_customer_sk = c_customer_sk \n AND ctr1.ctr_store_sk = high_return.ctr_store_sk\nORDER BY c_customer_id\nLIMIT 100;\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query1_1570971306","user_email":"nithish.sankaranarayanan@ulb.be"}
