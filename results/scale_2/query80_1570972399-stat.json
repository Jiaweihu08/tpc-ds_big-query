{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"236977","creationTime":"1570972401342","totalBytesProcessed":"2930258298","startTime":"1570972401530","query":{"totalSlotMs":"236977","queryPlan":[{"readMsMax":"53","computeMsMax":"9","waitMsAvg":"12","id":"0","endMs":"1570972402121","waitMsMax":"12","startMs":"1570972401918","waitRatioMax":0.001187766010096011,"readRatioAvg":0.005245966544590716,"parallelInputs":"1","recordsRead":"500","computeRatioAvg":0.0008908245075720083,"writeMsAvg":"96","status":"COMPLETE","writeMsMax":"96","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009502128080768089,"readMsAvg":"53","waitRatioAvg":0.001187766010096011,"completedParallelInputs":"1","computeRatioMax":0.0008908245075720083,"name":"S00: Input","shuffleOutputBytes":"4482","recordsWritten":"498","readRatioMax":0.005245966544590716,"steps":[{"kind":"READ","substeps":["$20:p_promo_sk, $21:p_channel_tv","FROM promotion","WHERE equal($21, 'N')"]},{"kind":"WRITE","substeps":["$20","TO __stage00_output","BY HASH($20)"]}],"writeRatioAvg":0.009502128080768089},{"readMsMax":"10","computeMsMax":"12","waitMsAvg":"14","id":"1","endMs":"1570972402351","waitMsMax":"14","startMs":"1570972401989","waitRatioMax":0.0013857270117786796,"readRatioAvg":0.0009898050084133426,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.001187766010096011,"writeMsAvg":"157","status":"COMPLETE","writeMsMax":"157","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.015539938632089478,"readMsAvg":"10","waitRatioAvg":0.0013857270117786796,"completedParallelInputs":"1","computeRatioMax":0.001187766010096011,"name":"S01: Input","shuffleOutputBytes":"51804","recordsWritten":"5756","readRatioMax":0.0009898050084133426,"steps":[{"kind":"READ","substeps":["$80:i_item_sk, $81:i_current_price","FROM item","WHERE greater($81, 50)"]},{"kind":"WRITE","substeps":["$80","TO __stage01_output","BY HASH($80)"]}],"writeRatioAvg":0.015539938632089478},{"readMsMax":"43","computeMsMax":"13","waitMsAvg":"26","id":"2","endMs":"1570972402426","waitMsMax":"26","startMs":"1570972402094","waitRatioMax":0.0025734930218746905,"readRatioAvg":0.004256161536177373,"parallelInputs":"1","recordsRead":"42","computeRatioAvg":0.0012867465109373452,"writeMsAvg":"124","status":"COMPLETE","writeMsMax":"124","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012273582104325447,"readMsAvg":"43","waitRatioAvg":0.0025734930218746905,"completedParallelInputs":"1","computeRatioMax":0.0012867465109373452,"name":"S02: Input","shuffleOutputBytes":"1260","recordsWritten":"42","readRatioMax":0.004256161536177373,"steps":[{"kind":"READ","substeps":["$70:web_site_sk, $71:web_site_id","FROM web_site"]},{"kind":"WRITE","substeps":["$70, $71","TO __stage02_output","BY HASH($70)"]}],"writeRatioAvg":0.012273582104325447},{"readMsMax":"10","computeMsMax":"21","waitMsAvg":"19","id":"3","endMs":"1570972402543","waitMsMax":"19","startMs":"1570972402195","waitRatioMax":0.0018806295159853508,"readRatioAvg":0.0009898050084133426,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0020785905176680195,"writeMsAvg":"144","status":"COMPLETE","writeMsMax":"144","computeMsAvg":"21","shuffleOutputBytesSpilled":"0","writeRatioMax":0.014253192121152133,"readMsAvg":"10","waitRatioAvg":0.0018806295159853508,"completedParallelInputs":"1","computeRatioMax":0.0020785905176680195,"name":"S03: Input","shuffleOutputBytes":"3564","recordsWritten":"396","readRatioMax":0.0009898050084133426,"steps":[{"kind":"READ","substeps":["$170:d_date_sk, $171:d_date","FROM date_dim","WHERE between(CAST($171 AS DATE), 11195, 11590)"]},{"kind":"WRITE","substeps":["$170","TO __stage03_output","BY HASH($170)"]}],"writeRatioAvg":0.014253192121152133},{"readMsMax":"33","computeMsMax":"1511","waitMsAvg":"14","id":"4","endMs":"1570972404555","waitMsMax":"14","startMs":"1570972402265","waitRatioMax":0.0013857270117786796,"readRatioAvg":0.0032663565277640306,"parallelInputs":"1","recordsRead":"720202","computeRatioAvg":0.14955953677125605,"writeMsAvg":"49","status":"COMPLETE","writeMsMax":"49","computeMsAvg":"1511","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004850044541225378,"readMsAvg":"33","waitRatioAvg":0.0013857270117786796,"completedParallelInputs":"1","computeRatioMax":0.14955953677125605,"name":"S04: Input","shuffleOutputBytes":"25408624","recordsWritten":"720202","readRatioMax":0.0032663565277640306,"steps":[{"kind":"READ","substeps":["$160:wr_item_sk, $161:wr_order_number, $162:wr_return_amt, $163:wr_net_loss","FROM web_returns"]},{"kind":"WRITE","substeps":["$160, $161, $162, $163","TO __stage04_output","BY HASH($160, $161)"]}],"writeRatioAvg":0.004850044541225378},{"readMsMax":"11","computeMsMax":"9","waitMsAvg":"15","id":"5","endMs":"1570972402707","waitMsMax":"15","startMs":"1570972402352","waitRatioMax":0.0014847075126200138,"readRatioAvg":0.0010887855092546767,"parallelInputs":"1","recordsRead":"500","computeRatioAvg":0.0008908245075720083,"writeMsAvg":"157","status":"COMPLETE","writeMsMax":"157","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.015539938632089478,"readMsAvg":"11","waitRatioAvg":0.0014847075126200138,"completedParallelInputs":"1","computeRatioMax":0.0008908245075720083,"name":"S05: Input","shuffleOutputBytes":"4482","recordsWritten":"498","readRatioMax":0.0010887855092546767,"steps":[{"kind":"READ","substeps":["$10:p_promo_sk, $11:p_channel_tv","FROM promotion","WHERE equal($11, 'N')"]},{"kind":"WRITE","substeps":["$10","TO __stage05_output","BY HASH($10)"]}],"writeRatioAvg":0.015539938632089478},{"readMsMax":"7","computeMsMax":"14","waitMsAvg":"8","id":"6","endMs":"1570972402633","waitMsMax":"8","startMs":"1570972402427","waitRatioMax":0.0007918440067306741,"readRatioAvg":0.0006928635058893398,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.0013857270117786796,"writeMsAvg":"188","status":"COMPLETE","writeMsMax":"188","computeMsAvg":"14","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01860833415817084,"readMsAvg":"7","waitRatioAvg":0.0007918440067306741,"completedParallelInputs":"1","computeRatioMax":0.0013857270117786796,"name":"S06: Input","shuffleOutputBytes":"51804","recordsWritten":"5756","readRatioMax":0.0006928635058893398,"steps":[{"kind":"READ","substeps":["$60:i_item_sk, $61:i_current_price","FROM item","WHERE greater($61, 50)"]},{"kind":"WRITE","substeps":["$60","TO __stage06_output","BY HASH($60)"]}],"writeRatioAvg":0.01860833415817084},{"readMsMax":"7","computeMsMax":"14","waitMsAvg":"2","id":"7","endMs":"1570972402647","waitMsMax":"2","startMs":"1570972402504","waitRatioMax":0.00019796100168266851,"readRatioAvg":0.0006928635058893398,"parallelInputs":"1","recordsRead":"12000","computeRatioAvg":0.0013857270117786796,"writeMsAvg":"81","status":"COMPLETE","writeMsMax":"81","computeMsAvg":"14","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008017420568148075,"readMsAvg":"7","waitRatioAvg":0.00019796100168266851,"completedParallelInputs":"1","computeRatioMax":0.0013857270117786796,"name":"S07: Input","shuffleOutputBytes":"360000","recordsWritten":"12000","readRatioMax":0.0006928635058893398,"steps":[{"kind":"READ","substeps":["$50:cp_catalog_page_sk, $51:cp_catalog_page_id","FROM catalog_page"]},{"kind":"WRITE","substeps":["$50, $51","TO __stage07_output","BY HASH($50)"]}],"writeRatioAvg":0.008017420568148075},{"readMsMax":"9","computeMsMax":"14","waitMsAvg":"34","id":"8","endMs":"1570972402842","waitMsMax":"34","startMs":"1570972402634","waitRatioMax":0.0033653370286053645,"readRatioAvg":0.0008908245075720083,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0013857270117786796,"writeMsAvg":"187","status":"COMPLETE","writeMsMax":"187","computeMsAvg":"14","shuffleOutputBytesSpilled":"0","writeRatioMax":0.018509353657329506,"readMsAvg":"9","waitRatioAvg":0.0033653370286053645,"completedParallelInputs":"1","computeRatioMax":0.0013857270117786796,"name":"S08: Input","shuffleOutputBytes":"3564","recordsWritten":"396","readRatioMax":0.0008908245075720083,"steps":[{"kind":"READ","substeps":["$140:d_date_sk, $141:d_date","FROM date_dim","WHERE between(CAST($141 AS DATE), 11195, 11590)"]},{"kind":"WRITE","substeps":["$140","TO __stage08_output","BY HASH($140)"]}],"writeRatioAvg":0.018509353657329506},{"readMsMax":"38","computeMsMax":"2591","waitMsAvg":"28","id":"9","endMs":"1570972404035","waitMsMax":"28","startMs":"1570972402647","waitRatioMax":0.002771454023557359,"readRatioAvg":0.0037612590319707016,"parallelInputs":"1","recordsRead":"1439802","computeRatioAvg":0.25645847767989705,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"25","computeMsAvg":"2591","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0024745125210333565,"readMsAvg":"38","waitRatioAvg":0.002771454023557359,"completedParallelInputs":"1","computeRatioMax":0.25645847767989705,"name":"S09: Input","shuffleOutputBytes":"51370744","recordsWritten":"1439802","readRatioMax":0.0037612590319707016,"steps":[{"kind":"READ","substeps":["$130:cr_item_sk, $131:cr_order_number, $132:cr_return_amount, $133:cr_net_loss","FROM catalog_returns"]},{"kind":"WRITE","substeps":["$130, $131, $132, $133","TO __stage09_output","BY HASH($130, $131)"]}],"writeRatioAvg":0.0024745125210333565},{"readMsMax":"8","computeMsMax":"7","waitMsAvg":"2","id":"10","endMs":"1570972402755","waitMsMax":"2","startMs":"1570972402707","waitRatioMax":0.00019796100168266851,"readRatioAvg":0.0007918440067306741,"parallelInputs":"1","recordsRead":"500","computeRatioAvg":0.0006928635058893398,"writeMsAvg":"13","status":"COMPLETE","writeMsMax":"13","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0012867465109373452,"readMsAvg":"8","waitRatioAvg":0.00019796100168266851,"completedParallelInputs":"1","computeRatioMax":0.0006928635058893398,"name":"S0A: Input","shuffleOutputBytes":"4482","recordsWritten":"498","readRatioMax":0.0007918440067306741,"steps":[{"kind":"READ","substeps":["$1:p_promo_sk, $2:p_channel_tv","FROM promotion","WHERE equal($2, 'N')"]},{"kind":"WRITE","substeps":["$1","TO __stage0A_output","BY HASH($1)"]}],"writeRatioAvg":0.0012867465109373452},{"readMsMax":"7","computeMsMax":"16","waitMsAvg":"27","id":"11","endMs":"1570972402832","waitMsMax":"27","startMs":"1570972402756","waitRatioMax":0.002672473522716025,"readRatioAvg":0.0006928635058893398,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.0015836880134613481,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"16","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0016826685143026823,"readMsAvg":"7","waitRatioAvg":0.002672473522716025,"completedParallelInputs":"1","computeRatioMax":0.0015836880134613481,"name":"S0B: Input","shuffleOutputBytes":"51804","recordsWritten":"5756","readRatioMax":0.0006928635058893398,"steps":[{"kind":"READ","substeps":["$40:i_item_sk, $41:i_current_price","FROM item","WHERE greater($41, 50)"]},{"kind":"WRITE","substeps":["$40","TO __stage0B_output","BY HASH($40)"]}],"writeRatioAvg":0.0016826685143026823},{"readMsMax":"8","computeMsMax":"5","waitMsAvg":"27","id":"12","endMs":"1570972402850","waitMsMax":"27","startMs":"1570972402770","waitRatioMax":0.002672473522716025,"readRatioAvg":0.0007918440067306741,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.0004949025042066713,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"16","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0015836880134613481,"readMsAvg":"8","waitRatioAvg":0.002672473522716025,"completedParallelInputs":"1","computeRatioMax":0.0004949025042066713,"name":"S0C: Input","shuffleOutputBytes":"3060","recordsWritten":"102","readRatioMax":0.0007918440067306741,"steps":[{"kind":"READ","substeps":["$30:s_store_sk, $31:s_store_id","FROM store"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage0C_output","BY HASH($30)"]}],"writeRatioAvg":0.0015836880134613481},{"readMsMax":"15","computeMsMax":"21","waitMsAvg":"12","id":"13","endMs":"1570972402885","waitMsMax":"12","startMs":"1570972402773","waitRatioMax":0.001187766010096011,"readRatioAvg":0.0014847075126200138,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0020785905176680195,"writeMsAvg":"76","status":"COMPLETE","writeMsMax":"76","computeMsAvg":"21","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007522518063941403,"readMsAvg":"15","waitRatioAvg":0.001187766010096011,"completedParallelInputs":"1","computeRatioMax":0.0020785905176680195,"name":"S0D: Input","shuffleOutputBytes":"3564","recordsWritten":"396","readRatioMax":0.0014847075126200138,"steps":[{"kind":"READ","substeps":["$110:d_date_sk, $111:d_date","FROM date_dim","WHERE between(CAST($111 AS DATE), 11195, 11590)"]},{"kind":"WRITE","substeps":["$110","TO __stage0D_output","BY HASH($110)"]}],"writeRatioAvg":0.007522518063941403},{"readMsMax":"29","computeMsMax":"5876","waitMsAvg":"49","id":"14","endMs":"1570972405707","waitMsMax":"49","startMs":"1570972402832","waitRatioMax":0.004850044541225378,"readRatioAvg":0.0028704345243986936,"parallelInputs":"1","recordsRead":"2878330","computeRatioAvg":0.5816094229436801,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"5876","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0017816490151440166,"readMsAvg":"29","waitRatioAvg":0.004850044541225378,"completedParallelInputs":"1","computeRatioMax":0.5816094229436801,"name":"S0E: Input","shuffleOutputBytes":"102007816","recordsWritten":"2878330","readRatioMax":0.0028704345243986936,"steps":[{"kind":"READ","substeps":["$100:sr_item_sk, $101:sr_ticket_number, $102:sr_return_amt, $103:sr_net_loss","FROM store_returns"]},{"kind":"WRITE","substeps":["$100, $101, $102, $103","TO __stage0E_output","BY HASH($100, $101)"]}],"writeRatioAvg":0.0017816490151440166},{"readMsMax":"0","computeMsMax":"28","inputStages":["9"],"waitMsAvg":"39","id":"15","endMs":"1570972404544","waitMsMax":"44","startMs":"1570972404116","waitRatioMax":0.004355142037018707,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1439802","computeRatioAvg":0.001979610016826685,"writeMsAvg":"156","status":"COMPLETE","writeMsMax":"254","computeMsAvg":"20","shuffleOutputBytesSpilled":"0","writeRatioMax":0.025141047213698902,"readMsAvg":"0","waitRatioAvg":0.003860239532812036,"completedParallelInputs":"100","computeRatioMax":0.002771454023557359,"name":"S0F: Coalesce","shuffleOutputBytes":"51370744","recordsWritten":"1439802","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage09_output"]}],"writeRatioAvg":0.015440958131248144},{"readMsMax":"290","computeMsMax":"5288","inputStages":["5","6","7","8","15"],"waitMsAvg":"56","id":"16","endMs":"1570972410191","waitMsMax":"59","startMs":"1570972404160","waitRatioMax":0.005839849549638721,"readRatioAvg":0.008017420568148075,"parallelInputs":"8","recordsRead":"26064939","computeRatioAvg":0.47282985251905374,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"123","computeMsAvg":"4777","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012174601603484114,"readMsAvg":"81","waitRatioAvg":0.005542908047114718,"completedParallelInputs":"8","computeRatioMax":0.5234088884489756,"name":"S10: Join+","shuffleOutputBytes":"706944","recordsWritten":"14728","readRatioMax":0.028704345243986934,"steps":[{"kind":"READ","substeps":["$120:cs_sold_date_sk, $121:cs_catalog_page_sk, $122:cs_item_sk, $123:cs_promo_sk, $124:cs_order_number, $125:cs_ext_sales_price, $126:cs_net_profit","FROM catalog_sales"]},{"kind":"READ","substeps":["$130, $131, $132, $133","FROM __stage0F_output"]},{"kind":"READ","substeps":["$140","FROM __stage08_output"]},{"kind":"READ","substeps":["$50, $51","FROM __stage07_output"]},{"kind":"READ","substeps":["$60","FROM __stage06_output"]},{"kind":"READ","substeps":["$10","FROM __stage05_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $450 := $440","$280 := SUM($441)","$281 := SUM($310)","$282 := SUM($311)"]},{"kind":"COMPUTE","substeps":["$310 := coalesce($443, 0)","$311 := subtract($442, coalesce($444, 0))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $431 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $420 = $60"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $410 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $400 = $140"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $122 = $130, $124 = $131"]},{"kind":"WRITE","substeps":["$450, $280, $281, $282","TO __stage10_output","BY HASH($450)"]}],"writeRatioAvg":0.001979610016826685},{"readMsMax":"96","computeMsMax":"4130","inputStages":["0","1","2","3","4"],"waitMsAvg":"3","id":"17","endMs":"1570972407019","waitMsMax":"4","startMs":"1570972404825","waitRatioMax":0.00039592200336533703,"readRatioAvg":0.008116401068989408,"parallelInputs":"4","recordsRead":"10108606","computeRatioAvg":0.3708799366524795,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"3747","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0004949025042066713,"readMsAvg":"82","waitRatioAvg":0.00029694150252400277,"completedParallelInputs":"4","computeRatioMax":0.4087894684747105,"name":"S11: Join+","shuffleOutputBytes":"4032","recordsWritten":"84","readRatioMax":0.009502128080768089,"steps":[{"kind":"READ","substeps":["$150:ws_sold_date_sk, $151:ws_item_sk, $152:ws_web_site_sk, $153:ws_promo_sk, $154:ws_order_number, $155:ws_ext_sales_price, $156:ws_net_profit","FROM web_sales"]},{"kind":"READ","substeps":["$160, $161, $162, $163","FROM __stage04_output"]},{"kind":"READ","substeps":["$170","FROM __stage03_output"]},{"kind":"READ","substeps":["$70, $71","FROM __stage02_output"]},{"kind":"READ","substeps":["$80","FROM __stage01_output"]},{"kind":"READ","substeps":["$20","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $520 := $510","$290 := SUM($511)","$291 := SUM($320)","$292 := SUM($321)"]},{"kind":"COMPUTE","substeps":["$320 := coalesce($513, 0)","$321 := subtract($512, coalesce($514, 0))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $501 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $490 = $80"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $481 = $70"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $470 = $170"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $151 = $160, $154 = $161"]},{"kind":"WRITE","substeps":["$520, $290, $291, $292","TO __stage11_output","BY HASH($520)"]}],"writeRatioAvg":0.00039592200336533703},{"readMsMax":"0","computeMsMax":"49","inputStages":["14"],"waitMsAvg":"2","id":"18","endMs":"1570972406761","waitMsMax":"4","startMs":"1570972405827","waitRatioMax":0.00039592200336533703,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2878330","computeRatioAvg":0.0033653370286053645,"writeMsAvg":"54","status":"COMPLETE","writeMsMax":"267","computeMsAvg":"34","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02642779372463625,"readMsAvg":"0","waitRatioAvg":0.00019796100168266851,"completedParallelInputs":"100","computeRatioMax":0.004850044541225378,"name":"S12: Coalesce","shuffleOutputBytes":"102007816","recordsWritten":"2878330","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0E_output"]}],"writeRatioAvg":0.00534494704543205},{"readMsMax":"97","computeMsMax":"10103","inputStages":["10","11","12","13","18"],"waitMsAvg":"1","id":"19","endMs":"1570972411873","waitMsMax":"2","startMs":"1570972405858","waitRatioMax":0.00019796100168266851,"readRatioAvg":0.005542908047114718,"parallelInputs":"10","recordsRead":"57652932","computeRatioAvg":0.8364842126101159,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"8451","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0017816490151440166,"readMsAvg":"56","waitRatioAvg":9.898050084133426e-05,"completedParallelInputs":"10","computeRatioMax":1,"name":"S13: Join+","shuffleOutputBytes":"24480","recordsWritten":"510","readRatioMax":0.009601108581609423,"steps":[{"kind":"READ","substeps":["$90:ss_sold_date_sk, $91:ss_item_sk, $92:ss_store_sk, $93:ss_promo_sk, $94:ss_ticket_number, $95:ss_ext_sales_price, $96:ss_net_profit","FROM store_sales"]},{"kind":"READ","substeps":["$100, $101, $102, $103","FROM __stage12_output"]},{"kind":"READ","substeps":["$110","FROM __stage0D_output"]},{"kind":"READ","substeps":["$30, $31","FROM __stage0C_output"]},{"kind":"READ","substeps":["$40","FROM __stage0B_output"]},{"kind":"READ","substeps":["$1","FROM __stage0A_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $380 := $370","$270 := SUM($371)","$271 := SUM($300)","$272 := SUM($301)"]},{"kind":"COMPUTE","substeps":["$300 := coalesce($373, 0)","$301 := subtract($372, coalesce($374, 0))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $361 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $350 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $341 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $330 = $110"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $91 = $100, $94 = $101"]},{"kind":"WRITE","substeps":["$380, $270, $271, $272","TO __stage13_output","BY HASH($380)"]}],"writeRatioAvg":0.0006928635058893398},{"readMsMax":"0","computeMsMax":"22","inputStages":["19","16","17"],"waitMsAvg":"1","id":"20","endMs":"1570972412190","waitMsMax":"2","startMs":"1570972411938","waitRatioMax":0.00019796100168266851,"readRatioAvg":0,"parallelInputs":"3","recordsRead":"15322","computeRatioAvg":0.0012867465109373452,"writeMsAvg":"41","status":"COMPLETE","writeMsMax":"47","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00465208353954271,"readMsAvg":"0","waitRatioAvg":9.898050084133426e-05,"completedParallelInputs":"3","computeRatioMax":0.0021775710185093534,"name":"S14: Aggregate+","shuffleOutputBytes":"164253","recordsWritten":"2061","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$380, $270, $271, $272","FROM __stage13_output"]},{"kind":"READ","substeps":["$450, $280, $281, $282","FROM __stage10_output"]},{"kind":"READ","substeps":["$520, $290, $291, $292","FROM __stage11_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $540 := $200, $541 := $201","$190 := SUM($202)","$191 := SUM($203)","$192 := SUM($204)"]},{"kind":"COMPUTE","substeps":["$210 := 'store channel'","$211 := concat('store', $390)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $390 := $380","$240 := SUM($270)","$241 := SUM($271)","$242 := SUM($272)"]},{"kind":"COMPUTE","substeps":["$220 := 'catalog channel'","$221 := concat('catalog_page', $460)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $460 := $450","$250 := SUM($280)","$251 := SUM($281)","$252 := SUM($282)"]},{"kind":"COMPUTE","substeps":["$230 := 'web channel'","$231 := concat('web_site', $530)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $530 := $520","$260 := SUM($290)","$261 := SUM($291)","$262 := SUM($292)"]},{"kind":"WRITE","substeps":["$190, $191, $192, $540, $541","TO __stage14_output","BY HASH($540, $541)"]}],"writeRatioAvg":0.004058200534494704},{"readMsMax":"0","computeMsMax":"9","inputStages":["20"],"waitMsAvg":"3","id":"21","endMs":"1570972412411","waitMsMax":"3","startMs":"1570972412226","waitRatioMax":0.00029694150252400277,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2061","computeRatioAvg":0.0008908245075720083,"writeMsAvg":"168","status":"COMPLETE","writeMsMax":"168","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.016628724141344156,"readMsAvg":"0","waitRatioAvg":0.00029694150252400277,"completedParallelInputs":"1","computeRatioMax":0.0008908245075720083,"name":"S15: Sort+","shuffleOutputBytes":"8000","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$190, $191, $192, $540, $541","FROM __stage14_output"]},{"kind":"SORT","substeps":["$550 ASC, $551 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $550 := $540, $551 := $541","$180 := SUM($190)","$181 := SUM($191)","$182 := SUM($192)"]},{"kind":"WRITE","substeps":["$560, $561, $562, $563, $564","TO __stage15_output"]}],"writeRatioAvg":0.016628724141344156},{"readMsMax":"0","computeMsMax":"10","inputStages":["21"],"waitMsAvg":"4","id":"22","endMs":"1570972412591","waitMsMax":"4","startMs":"1570972412305","waitRatioMax":0.00039592200336533703,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0009898050084133426,"writeMsAvg":"145","status":"COMPLETE","writeMsMax":"145","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.014352172621993467,"readMsAvg":"0","waitRatioAvg":0.00039592200336533703,"completedParallelInputs":"1","computeRatioMax":0.0009898050084133426,"name":"S16: Output","shuffleOutputBytes":"8000","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$560, $561, $562, $563, $564","FROM __stage15_output"]},{"kind":"SORT","substeps":["$563 ASC, $564 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$570, $571, $572, $573, $574","TO __stage16_output"]}],"writeRatioAvg":0.014352172621993467}],"estimatedBytesProcessed":"2930258298","timeline":[{"totalSlotMs":"465","activeUnits":"4","completedUnits":"2","elapsedMs":"889","pendingUnits":"5"},{"totalSlotMs":"2597","activeUnits":"3","completedUnits":"12","elapsedMs":"1398","pendingUnits":"3"},{"totalSlotMs":"37336","activeUnits":"16","completedUnits":"114","elapsedMs":"3523","pendingUnits":"13"},{"totalSlotMs":"121982","activeUnits":"114","completedUnits":"215","elapsedMs":"5351","pendingUnits":"22"},{"totalSlotMs":"133865","activeUnits":"18","completedUnits":"219","elapsedMs":"5864","pendingUnits":"18"},{"totalSlotMs":"217549","activeUnits":"16","completedUnits":"227","elapsedMs":"8847","pendingUnits":"10"},{"totalSlotMs":"235113","activeUnits":"5","completedUnits":"236","elapsedMs":"10139","pendingUnits":"1"},{"totalSlotMs":"236977","activeUnits":"2","completedUnits":"242","elapsedMs":"11245","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"2930769920","totalPartitionsProcessed":"0","totalBytesProcessed":"2930258298","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_site","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"promotion","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_page","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_returns","datasetId":"scale_10"}]},"endTime":"1570972412798"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query80_1570972399"},"etag":"ddq0KqPdJNLmNxc8ZRYtAA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query80_1570972399?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon11564169802f1a35ba9ecb9f2b4e8c118bb471ca","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query80\nWITH ssr AS \n( \n SELECT s_store_id AS store_id, \n Sum(ss_ext_sales_price) AS sales, \n Sum(COALESCE(sr_return_amt, 0)) AS returns1, \n Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n FROM store_sales \n LEFT OUTER JOIN store_returns \n ON ( \n ss_item_sk = sr_item_sk \n AND ss_ticket_number = sr_ticket_number), \n date_dim, \n store, \n item, \n promotion \n WHERE ss_sold_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN Cast('2000-08-26' AS DATE) AND ( \n Cast('2001-09-25' AS DATE)) \n AND ss_store_sk = s_store_sk \n AND ss_item_sk = i_item_sk \n AND i_current_price > 50 \n AND ss_promo_sk = p_promo_sk \n AND p_channel_tv = 'N' \n GROUP BY s_store_id) , csr AS \n( \n SELECT cp_catalog_page_id AS catalog_page_id, \n sum(cs_ext_sales_price) AS sales, \n sum(COALESCE(cr_return_amount, 0)) AS returns1, \n sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n FROM catalog_sales \n LEFT OUTER JOIN catalog_returns \n ON ( \n cs_item_sk = cr_item_sk \n AND cs_order_number = cr_order_number), \n date_dim, \n catalog_page, \n item, \n promotion \n WHERE cs_sold_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2000-08-26' AS date) AND ( \n Cast('2001-09-25' AS DATE)) \n AND cs_catalog_page_sk = cp_catalog_page_sk \n AND cs_item_sk = i_item_sk \n AND i_current_price > 50 \n AND cs_promo_sk = p_promo_sk \n AND p_channel_tv = 'N' \n GROUP BY cp_catalog_page_id) , wsr AS \n( \n SELECT web_site_id, \n sum(ws_ext_sales_price) AS sales, \n sum(COALESCE(wr_return_amt, 0)) AS returns1, \n sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n FROM web_sales \n LEFT OUTER JOIN web_returns \n ON ( \n ws_item_sk = wr_item_sk \n AND ws_order_number = wr_order_number), \n date_dim, \n web_site, \n item, \n promotion \n WHERE ws_sold_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2000-08-26' AS date) AND ( \n Cast('2001-09-25' AS DATE)) \n AND ws_web_site_sk = web_site_sk \n AND ws_item_sk = i_item_sk \n AND i_current_price > 50 \n AND ws_promo_sk = p_promo_sk \n AND p_channel_tv = 'N' \n GROUP BY web_site_id) \nSELECT\n channel , \n id , \n sum(sales) AS sales , \n sum(returns1) AS returns1 , \n sum(profit) AS profit \nFROM ( \n SELECT 'store channel' AS channel , \n Concat('store', store_id) AS id , \n sales , \n returns1 , \n profit \n FROM ssr \n UNION ALL \n SELECT 'catalog channel' AS channel , \n Concat('catalog_page', catalog_page_id) AS id , \n sales , \n returns1 , \n profit \n FROM csr \n UNION ALL \n SELECT 'web channel' AS channel , \n Concat('web_site', web_site_id) AS id , \n sales , \n returns1 , \n profit \n FROM wsr ) x \nGROUP BY channel, id\nORDER BY channel , \n id \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query80_1570972399","user_email":"nithish.sankaranarayanan@ulb.be"}
