{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"159763","creationTime":"1570971751064","totalBytesProcessed":"840565466","startTime":"1570971751231","query":{"totalSlotMs":"159763","queryPlan":[{"readMsMax":"27","computeMsMax":"168","waitMsAvg":"4","id":"0","endMs":"1570971752037","waitMsMax":"4","startMs":"1570971751374","waitRatioMax":0.003386960203217612,"readRatioAvg":0.02286198137171888,"parallelInputs":"1","recordsRead":"250000","computeRatioAvg":0.14225232853513972,"writeMsAvg":"50","status":"COMPLETE","writeMsMax":"50","computeMsAvg":"168","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04233700254022015,"readMsAvg":"27","waitRatioAvg":0.003386960203217612,"completedParallelInputs":"1","computeRatioMax":0.14225232853513972,"name":"S00: Input","shuffleOutputBytes":"6854318","recordsWritten":"250000","readRatioMax":0.02286198137171888,"steps":[{"kind":"READ","substeps":["$100:ca_address_sk, $101:ca_county","FROM customer_address"]},{"kind":"WRITE","substeps":["$100, $101","TO __stage00_output","BY HASH($100)"]}],"writeRatioAvg":0.04233700254022015},{"readMsMax":"14","computeMsMax":"9","waitMsAvg":"1","id":"1","endMs":"1570971751525","waitMsMax":"1","startMs":"1570971751450","waitRatioMax":0.000846740050804403,"readRatioAvg":0.011854360711261643,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.007620660457239628,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005080440304826418,"readMsAvg":"14","waitRatioAvg":0.000846740050804403,"completedParallelInputs":"1","computeRatioMax":0.007620660457239628,"name":"S01: Input","shuffleOutputBytes":"2457","recordsWritten":"91","readRatioMax":0.011854360711261643,"steps":[{"kind":"READ","substeps":["$170:d_date_sk, $171:d_year, $172:d_qoy","FROM date_dim","WHERE and(equal($172, 2), equal($171, 2001))"]},{"kind":"WRITE","substeps":["$170, $171, $172","TO __stage01_output","BY HASH($170)"]}],"writeRatioAvg":0.005080440304826418},{"readMsMax":"20","computeMsMax":"263","waitMsAvg":"29","id":"3","endMs":"1570971752232","waitMsMax":"29","startMs":"1570971751525","waitRatioMax":0.024555461473327687,"readRatioAvg":0.01693480101608806,"parallelInputs":"1","recordsRead":"250000","computeRatioAvg":0.222692633361558,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"263","shuffleOutputBytesSpilled":"0","writeRatioMax":0.014394580863674851,"readMsAvg":"20","waitRatioAvg":0.024555461473327687,"completedParallelInputs":"1","computeRatioMax":0.222692633361558,"name":"S03: Input","shuffleOutputBytes":"6854318","recordsWritten":"250000","readRatioMax":0.01693480101608806,"steps":[{"kind":"READ","substeps":["$90:ca_address_sk, $91:ca_county","FROM customer_address"]},{"kind":"WRITE","substeps":["$90, $91","TO __stage03_output","BY HASH($90)"]}],"writeRatioAvg":0.014394580863674851},{"readMsMax":"25","computeMsMax":"7","waitMsAvg":"126","id":"4","endMs":"1570971751871","waitMsMax":"126","startMs":"1570971751657","waitRatioMax":0.10668924640135478,"readRatioAvg":0.021168501270110076,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0059271803556308214,"writeMsAvg":"173","status":"COMPLETE","writeMsMax":"173","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.14648602878916173,"readMsAvg":"25","waitRatioAvg":0.10668924640135478,"completedParallelInputs":"1","computeRatioMax":0.0059271803556308214,"name":"S04: Input","shuffleOutputBytes":"2457","recordsWritten":"91","readRatioMax":0.021168501270110076,"steps":[{"kind":"READ","substeps":["$160:d_date_sk, $161:d_year, $162:d_qoy","FROM date_dim","WHERE and(equal($162, 1), equal($161, 2001))"]},{"kind":"WRITE","substeps":["$160, $161, $162","TO __stage04_output","BY HASH($160)"]}],"writeRatioAvg":0.14648602878916173},{"readMsMax":"13","computeMsMax":"212","waitMsAvg":"82","id":"6","endMs":"1570971752116","waitMsMax":"82","startMs":"1570971751667","waitRatioMax":0.06943268416596104,"readRatioAvg":0.01100762066045724,"parallelInputs":"1","recordsRead":"250000","computeRatioAvg":0.17950889077053345,"writeMsAvg":"183","status":"COMPLETE","writeMsMax":"183","computeMsAvg":"212","shuffleOutputBytesSpilled":"0","writeRatioMax":0.15495342929720576,"readMsAvg":"13","waitRatioAvg":0.06943268416596104,"completedParallelInputs":"1","computeRatioMax":0.17950889077053345,"name":"S06: Input","shuffleOutputBytes":"6854318","recordsWritten":"250000","readRatioMax":0.01100762066045724,"steps":[{"kind":"READ","substeps":["$60:ca_address_sk, $61:ca_county","FROM customer_address"]},{"kind":"WRITE","substeps":["$60, $61","TO __stage06_output","BY HASH($60)"]}],"writeRatioAvg":0.15495342929720576},{"readMsMax":"15","computeMsMax":"11","waitMsAvg":"60","id":"7","endMs":"1570971751862","waitMsMax":"60","startMs":"1570971751669","waitRatioMax":0.05080440304826418,"readRatioAvg":0.012701100762066046,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.009314140558848433,"writeMsAvg":"166","status":"COMPLETE","writeMsMax":"166","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.14055884843353092,"readMsAvg":"15","waitRatioAvg":0.05080440304826418,"completedParallelInputs":"1","computeRatioMax":0.009314140558848433,"name":"S07: Input","shuffleOutputBytes":"2484","recordsWritten":"92","readRatioMax":0.012701100762066046,"steps":[{"kind":"READ","substeps":["$150:d_date_sk, $151:d_year, $152:d_qoy","FROM date_dim","WHERE and(equal($152, 3), equal($151, 2001))"]},{"kind":"WRITE","substeps":["$150, $151, $152","TO __stage07_output","BY HASH($150)"]}],"writeRatioAvg":0.14055884843353092},{"readMsMax":"33","computeMsMax":"357","waitMsAvg":"6","id":"9","endMs":"1570971752115","waitMsMax":"6","startMs":"1570971751659","waitRatioMax":0.005080440304826418,"readRatioAvg":0.0279424216765453,"parallelInputs":"1","recordsRead":"250000","computeRatioAvg":0.3022861981371719,"writeMsAvg":"31","status":"COMPLETE","writeMsMax":"31","computeMsAvg":"357","shuffleOutputBytesSpilled":"0","writeRatioMax":0.026248941574936496,"readMsAvg":"33","waitRatioAvg":0.005080440304826418,"completedParallelInputs":"1","computeRatioMax":0.3022861981371719,"name":"S09: Input","shuffleOutputBytes":"6854318","recordsWritten":"250000","readRatioMax":0.0279424216765453,"steps":[{"kind":"READ","substeps":["$40:ca_address_sk, $41:ca_county","FROM customer_address"]},{"kind":"WRITE","substeps":["$40, $41","TO __stage09_output","BY HASH($40)"]}],"writeRatioAvg":0.026248941574936496},{"readMsMax":"12","computeMsMax":"7","waitMsAvg":"7","id":"10","endMs":"1570971751863","waitMsMax":"7","startMs":"1570971751682","waitRatioMax":0.0059271803556308214,"readRatioAvg":0.010160880609652836,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0059271803556308214,"writeMsAvg":"159","status":"COMPLETE","writeMsMax":"159","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.13463166807790009,"readMsAvg":"12","waitRatioAvg":0.0059271803556308214,"completedParallelInputs":"1","computeRatioMax":0.0059271803556308214,"name":"S0A: Input","shuffleOutputBytes":"2457","recordsWritten":"91","readRatioMax":0.010160880609652836,"steps":[{"kind":"READ","substeps":["$120:d_date_sk, $121:d_year, $122:d_qoy","FROM date_dim","WHERE and(equal($122, 1), equal($121, 2001))"]},{"kind":"WRITE","substeps":["$120, $121, $122","TO __stage0A_output","BY HASH($120)"]}],"writeRatioAvg":0.13463166807790009},{"readMsMax":"15","computeMsMax":"233","waitMsAvg":"1","id":"12","endMs":"1570971752401","waitMsMax":"1","startMs":"1570971751761","waitRatioMax":0.000846740050804403,"readRatioAvg":0.012701100762066046,"parallelInputs":"1","recordsRead":"250000","computeRatioAvg":0.19729043183742592,"writeMsAvg":"14","status":"COMPLETE","writeMsMax":"14","computeMsAvg":"233","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011854360711261643,"readMsAvg":"15","waitRatioAvg":0.000846740050804403,"completedParallelInputs":"1","computeRatioMax":0.19729043183742592,"name":"S0C: Input","shuffleOutputBytes":"6854318","recordsWritten":"250000","readRatioMax":0.012701100762066046,"steps":[{"kind":"READ","substeps":["$20:ca_address_sk, $21:ca_county","FROM customer_address"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage0C_output","BY HASH($20)"]}],"writeRatioAvg":0.011854360711261643},{"readMsMax":"9","computeMsMax":"10","waitMsAvg":"1","id":"13","endMs":"1570971751991","waitMsMax":"1","startMs":"1570971751784","waitRatioMax":0.000846740050804403,"readRatioAvg":0.007620660457239628,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.00846740050804403,"writeMsAvg":"184","status":"COMPLETE","writeMsMax":"184","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.15580016934801016,"readMsAvg":"9","waitRatioAvg":0.000846740050804403,"completedParallelInputs":"1","computeRatioMax":0.00846740050804403,"name":"S0D: Input","shuffleOutputBytes":"2457","recordsWritten":"91","readRatioMax":0.007620660457239628,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_year, $82:d_qoy","FROM date_dim","WHERE and(equal($82, 2), equal($81, 2001))"]},{"kind":"WRITE","substeps":["$80, $81, $82","TO __stage0D_output","BY HASH($80)"]}],"writeRatioAvg":0.15580016934801016},{"readMsMax":"9","computeMsMax":"12","waitMsAvg":"1","id":"16","endMs":"1570971751979","waitMsMax":"1","startMs":"1570971751839","waitRatioMax":0.000846740050804403,"readRatioAvg":0.007620660457239628,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.010160880609652836,"writeMsAvg":"66","status":"COMPLETE","writeMsMax":"66","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0558848433530906,"readMsAvg":"9","waitRatioAvg":0.000846740050804403,"completedParallelInputs":"1","computeRatioMax":0.010160880609652836,"name":"S10: Input","shuffleOutputBytes":"2484","recordsWritten":"92","readRatioMax":0.007620660457239628,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_year, $32:d_qoy","FROM date_dim","WHERE and(equal($32, 3), equal($31, 2001))"]},{"kind":"WRITE","substeps":["$30, $31, $32","TO __stage10_output","BY HASH($30)"]}],"writeRatioAvg":0.0558848433530906},{"readMsMax":"51","computeMsMax":"699","inputStages":["16"],"waitMsAvg":"0","id":"22","endMs":"1570971752464","waitMsMax":"1","startMs":"1570971752006","waitRatioMax":0.000846740050804403,"readRatioAvg":0.03217612193056731,"parallelInputs":"4","recordsRead":"7201398","computeRatioAvg":0.5038103302286198,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"595","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009314140558848433,"readMsAvg":"38","waitRatioAvg":0,"completedParallelInputs":"4","computeRatioMax":0.5918712955122777,"name":"S16: Join","shuffleOutputBytes":"13827336","recordsWritten":"384098","readRatioMax":0.04318374259102455,"steps":[{"kind":"READ","substeps":["$10:ws_sold_date_sk, $11:ws_bill_addr_sk, $12:ws_ext_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$30, $31, $32","FROM __stage10_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $10 = $30"]},{"kind":"WRITE","substeps":["$600, $601, $602, $603","TO __stage16_output","BY HASH($600)"]}],"writeRatioAvg":0.006773920406435224},{"readMsMax":"31","computeMsMax":"1026","inputStages":["0","1"],"waitMsAvg":"2","id":"24","endMs":"1570971752785","waitMsMax":"3","startMs":"1570971752172","waitRatioMax":0.002540220152413209,"readRatioAvg":0.02286198137171888,"parallelInputs":"10","recordsRead":"31303022","computeRatioAvg":0.7908552074513124,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"934","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004233700254022015,"readMsAvg":"27","waitRatioAvg":0.001693480101608806,"completedParallelInputs":"10","computeRatioMax":0.8687552921253175,"name":"S18: Join+","shuffleOutputBytes":"853880","recordsWritten":"18470","readRatioMax":0.026248941574936496,"steps":[{"kind":"READ","substeps":["$140:ss_sold_date_sk, $141:ss_addr_sk, $142:ss_ext_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$170, $171, $172","FROM __stage01_output"]},{"kind":"READ","substeps":["$100, $101","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $380 := $373, $381 := $372, $382 := $371","$300 := SUM($370)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $360 = $100"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $140 = $170"]},{"kind":"WRITE","substeps":["$380, $382, $381, $300","TO __stage18_output","BY HASH($380, $381, $382)"]}],"writeRatioAvg":0.003386960203217612},{"readMsMax":"34","computeMsMax":"917","inputStages":["9","10"],"waitMsAvg":"1","id":"25","endMs":"1570971752692","waitMsMax":"1","startMs":"1570971752186","waitRatioMax":0.000846740050804403,"readRatioAvg":0.02286198137171888,"parallelInputs":"4","recordsRead":"8201394","computeRatioAvg":0.594411515664691,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"702","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004233700254022015,"readMsAvg":"27","waitRatioAvg":0.000846740050804403,"completedParallelInputs":"4","computeRatioMax":0.7764606265876376,"name":"S19: Join+","shuffleOutputBytes":"340343","recordsWritten":"7362","readRatioMax":0.028789161727349702,"steps":[{"kind":"READ","substeps":["$70:ws_sold_date_sk, $71:ws_bill_addr_sk, $72:ws_ext_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$120, $121, $122","FROM __stage0A_output"]},{"kind":"READ","substeps":["$40, $41","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $500 := $493, $501 := $492, $502 := $491","$270 := SUM($490)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $480 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $70 = $120"]},{"kind":"WRITE","substeps":["$500, $502, $501, $270","TO __stage19_output","BY HASH($500, $501, $502)"]}],"writeRatioAvg":0.004233700254022015},{"readMsMax":"58","computeMsMax":"1181","inputStages":["6","7"],"waitMsAvg":"4","id":"26","endMs":"1570971753895","waitMsMax":"30","startMs":"1570971752203","waitRatioMax":0.02540220152413209,"readRatioAvg":0.029635901778154106,"parallelInputs":"10","recordsRead":"31303032","computeRatioAvg":0.882303132938188,"writeMsAvg":"792","status":"COMPLETE","writeMsMax":"1076","computeMsAvg":"1042","shuffleOutputBytesSpilled":"0","writeRatioMax":0.9110922946655376,"readMsAvg":"35","waitRatioAvg":0.003386960203217612,"completedParallelInputs":"10","computeRatioMax":1,"name":"S1A: Join+","shuffleOutputBytes":"853880","recordsWritten":"18470","readRatioMax":0.04911092294665537,"steps":[{"kind":"READ","substeps":["$110:ss_sold_date_sk, $111:ss_addr_sk, $112:ss_ext_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$150, $151, $152","FROM __stage07_output"]},{"kind":"READ","substeps":["$60, $61","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $440 := $433, $441 := $432, $442 := $431","$280 := SUM($430)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $420 = $60"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $110 = $150"]},{"kind":"WRITE","substeps":["$440, $442, $441, $280","TO __stage1A_output","BY HASH($440, $441, $442)"]}],"writeRatioAvg":0.6706181202370872},{"readMsMax":"51","computeMsMax":"1061","inputStages":["3","4"],"waitMsAvg":"10","id":"27","endMs":"1570971753004","waitMsMax":"11","startMs":"1570971752415","waitRatioMax":0.009314140558848433,"readRatioAvg":0.028789161727349702,"parallelInputs":"10","recordsRead":"31303022","computeRatioAvg":0.7671464860287892,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"906","shuffleOutputBytesSpilled":"0","writeRatioMax":0.014394580863674851,"readMsAvg":"34","waitRatioAvg":0.00846740050804403,"completedParallelInputs":"10","computeRatioMax":0.8983911939034717,"name":"S1B: Join+","shuffleOutputBytes":"853880","recordsWritten":"18470","readRatioMax":0.04318374259102455,"steps":[{"kind":"READ","substeps":["$130:ss_sold_date_sk, $131:ss_addr_sk, $132:ss_ext_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$160, $161, $162","FROM __stage04_output"]},{"kind":"READ","substeps":["$90, $91","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $330 := $323, $331 := $322, $332 := $321","$290 := SUM($320)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $310 = $90"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $130 = $160"]},{"kind":"WRITE","substeps":["$330, $332, $331, $290","TO __stage1B_output","BY HASH($330, $331, $332)"]}],"writeRatioAvg":0.004233700254022015},{"readMsMax":"27","computeMsMax":"814","inputStages":["12","13"],"waitMsAvg":"27","id":"28","endMs":"1570971752964","waitMsMax":"40","startMs":"1570971752467","waitRatioMax":0.03386960203217612,"readRatioAvg":0.02201524132091448,"parallelInputs":"4","recordsRead":"8201394","computeRatioAvg":0.5859441151566469,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"692","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005080440304826418,"readMsAvg":"26","waitRatioAvg":0.02286198137171888,"completedParallelInputs":"4","computeRatioMax":0.6892464013547841,"name":"S1C: Join+","shuffleOutputBytes":"339226","recordsWritten":"7338","readRatioMax":0.02286198137171888,"steps":[{"kind":"READ","substeps":["$50:ws_sold_date_sk, $51:ws_bill_addr_sk, $52:ws_ext_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$80, $81, $82","FROM __stage0D_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $560 := $553, $561 := $552, $562 := $551","$240 := SUM($550)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $540 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $50 = $80"]},{"kind":"WRITE","substeps":["$560, $562, $561, $240","TO __stage1C_output","BY HASH($560, $561, $562)"]}],"writeRatioAvg":0.003386960203217612},{"readMsMax":"0","computeMsMax":"12","inputStages":["22"],"waitMsAvg":"56","id":"29","endMs":"1570971752767","waitMsMax":"58","startMs":"1570971752533","waitRatioMax":0.04911092294665537,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"384098","computeRatioAvg":0.006773920406435224,"writeMsAvg":"14","status":"COMPLETE","writeMsMax":"63","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05334462320067739,"readMsAvg":"0","waitRatioAvg":0.04741744284504657,"completedParallelInputs":"100","computeRatioMax":0.010160880609652836,"name":"S1D: Coalesce","shuffleOutputBytes":"13827336","recordsWritten":"384098","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage16_output"]}],"writeRatioAvg":0.011854360711261643},{"readMsMax":"16","computeMsMax":"666","inputStages":["29"],"waitMsAvg":"47","id":"30","endMs":"1570971753074","waitMsMax":"47","startMs":"1570971752538","waitRatioMax":0.03979678238780694,"readRatioAvg":0.013547840812870448,"parallelInputs":"1","recordsRead":"634098","computeRatioAvg":0.5639288738357324,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"666","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0059271803556308214,"readMsAvg":"16","waitRatioAvg":0.03979678238780694,"completedParallelInputs":"1","computeRatioMax":0.5639288738357324,"name":"S1E: Join+","shuffleOutputBytes":"85294","recordsWritten":"1845","readRatioMax":0.013547840812870448,"steps":[{"kind":"READ","substeps":["$1:ca_address_sk, $2:ca_county","FROM customer_address"]},{"kind":"READ","substeps":["$600, $601, $602, $603","FROM __stage1D_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $620 := $613, $621 := $612, $622 := $611","$210 := SUM($610)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $600"]},{"kind":"WRITE","substeps":["$620, $622, $621, $210","TO __stage1E_output","BY HASH($620, $621, $622)"]}],"writeRatioAvg":0.0059271803556308214},{"readMsMax":"0","computeMsMax":"11","inputStages":["30"],"waitMsAvg":"8","id":"31","endMs":"1570971754004","waitMsMax":"8","startMs":"1570971753945","waitRatioMax":0.006773920406435224,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1845","computeRatioAvg":0.009314140558848433,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01947502116850127,"readMsAvg":"0","waitRatioAvg":0.006773920406435224,"completedParallelInputs":"1","computeRatioMax":0.009314140558848433,"name":"S1F: Aggregate","shuffleOutputBytes":"52074","recordsWritten":"1844","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$620, $622, $621, $210","FROM __stage1E_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $630 := $620, $631 := $621, $632 := $622","$190 := SUM($210)"]},{"kind":"WRITE","substeps":["$190, $630","TO __stage1F_output","BY HASH($630)"]}],"writeRatioAvg":0.01947502116850127},{"readMsMax":"0","computeMsMax":"14","inputStages":["28"],"waitMsAvg":"10","id":"32","endMs":"1570971754038","waitMsMax":"10","startMs":"1570971753960","waitRatioMax":0.00846740050804403,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"7338","computeRatioAvg":0.011854360711261643,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"14","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006773920406435224,"readMsAvg":"0","waitRatioAvg":0.00846740050804403,"completedParallelInputs":"1","computeRatioMax":0.011854360711261643,"name":"S20: Aggregate","shuffleOutputBytes":"51817","recordsWritten":"1835","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$560, $562, $561, $240","FROM __stage1C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $570 := $560, $571 := $561, $572 := $562","$200 := SUM($240)"]},{"kind":"WRITE","substeps":["$200, $570","TO __stage20_output","BY HASH($570)"]}],"writeRatioAvg":0.006773920406435224},{"readMsMax":"0","computeMsMax":"14","inputStages":["25"],"waitMsAvg":"8","id":"33","endMs":"1570971754057","waitMsMax":"8","startMs":"1570971753976","waitRatioMax":0.006773920406435224,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"7362","computeRatioAvg":0.011854360711261643,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"14","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007620660457239628,"readMsAvg":"0","waitRatioAvg":0.006773920406435224,"completedParallelInputs":"1","computeRatioMax":0.011854360711261643,"name":"S21: Aggregate","shuffleOutputBytes":"51988","recordsWritten":"1841","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$500, $502, $501, $270","FROM __stage19_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $510 := $500, $511 := $501, $512 := $502","$220 := SUM($270)"]},{"kind":"WRITE","substeps":["$220, $510","TO __stage21_output","BY HASH($510)"]}],"writeRatioAvg":0.007620660457239628},{"readMsMax":"0","computeMsMax":"19","inputStages":["26"],"waitMsAvg":"7","id":"34","endMs":"1570971754079","waitMsMax":"7","startMs":"1570971753988","waitRatioMax":0.0059271803556308214,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"18470","computeRatioAvg":0.016088060965283656,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007620660457239628,"readMsAvg":"0","waitRatioAvg":0.0059271803556308214,"completedParallelInputs":"1","computeRatioMax":0.016088060965283656,"name":"S22: Aggregate","shuffleOutputBytes":"52132","recordsWritten":"1846","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$440, $442, $441, $280","FROM __stage1A_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $450 := $440, $451 := $441, $452 := $442","$230 := SUM($280)"]},{"kind":"WRITE","substeps":["$230, $450","TO __stage22_output","BY HASH($450)"]}],"writeRatioAvg":0.007620660457239628},{"readMsMax":"0","computeMsMax":"20","inputStages":["24"],"waitMsAvg":"4","id":"35","endMs":"1570971754091","waitMsMax":"4","startMs":"1570971753999","waitRatioMax":0.003386960203217612,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"18470","computeRatioAvg":0.01693480101608806,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"20","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009314140558848433,"readMsAvg":"0","waitRatioAvg":0.003386960203217612,"completedParallelInputs":"1","computeRatioMax":0.01693480101608806,"name":"S23: Aggregate","shuffleOutputBytes":"52132","recordsWritten":"1846","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$380, $382, $381, $300","FROM __stage18_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $390 := $380, $391 := $381, $392 := $382","$260 := SUM($300)"]},{"kind":"WRITE","substeps":["$260, $390","TO __stage23_output","BY HASH($390)"]}],"writeRatioAvg":0.009314140558848433},{"readMsMax":"0","computeMsMax":"11","inputStages":["35"],"waitMsAvg":"3","id":"37","endMs":"1570971754351","waitMsMax":"7","startMs":"1570971754110","waitRatioMax":0.0059271803556308214,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1846","computeRatioAvg":0.005080440304826418,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"73","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.06181202370872142,"readMsAvg":"0","waitRatioAvg":0.002540220152413209,"completedParallelInputs":"100","computeRatioMax":0.009314140558848433,"name":"S25: Coalesce","shuffleOutputBytes":"52132","recordsWritten":"1846","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage23_output"]}],"writeRatioAvg":0.01947502116850127},{"readMsMax":"0","computeMsMax":"9","inputStages":["34"],"waitMsAvg":"8","id":"38","endMs":"1570971754353","waitMsMax":"9","startMs":"1570971754112","waitRatioMax":0.007620660457239628,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1846","computeRatioAvg":0.004233700254022015,"writeMsAvg":"13","status":"COMPLETE","writeMsMax":"50","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04233700254022015,"readMsAvg":"0","waitRatioAvg":0.006773920406435224,"completedParallelInputs":"100","computeRatioMax":0.007620660457239628,"name":"S26: Coalesce","shuffleOutputBytes":"52132","recordsWritten":"1846","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage22_output"]}],"writeRatioAvg":0.01100762066045724},{"readMsMax":"0","computeMsMax":"9","inputStages":["33"],"waitMsAvg":"12","id":"39","endMs":"1570971754353","waitMsMax":"15","startMs":"1570971754111","waitRatioMax":0.012701100762066046,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1841","computeRatioAvg":0.004233700254022015,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"33","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0279424216765453,"readMsAvg":"0","waitRatioAvg":0.010160880609652836,"completedParallelInputs":"100","computeRatioMax":0.007620660457239628,"name":"S27: Coalesce","shuffleOutputBytes":"51988","recordsWritten":"1841","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage21_output"]}],"writeRatioAvg":0.009314140558848433},{"readMsMax":"0","computeMsMax":"9","inputStages":["32"],"waitMsAvg":"15","id":"40","endMs":"1570971754375","waitMsMax":"19","startMs":"1570971754113","waitRatioMax":0.016088060965283656,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1835","computeRatioAvg":0.004233700254022015,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"148","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.12531752751905165,"readMsAvg":"0","waitRatioAvg":0.012701100762066046,"completedParallelInputs":"100","computeRatioMax":0.007620660457239628,"name":"S28: Coalesce","shuffleOutputBytes":"51817","recordsWritten":"1835","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage20_output"]}],"writeRatioAvg":0.010160880609652836},{"readMsMax":"0","computeMsMax":"10","inputStages":["31"],"waitMsAvg":"19","id":"41","endMs":"1570971754303","waitMsMax":"23","startMs":"1570971754119","waitRatioMax":0.01947502116850127,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1844","computeRatioAvg":0.005080440304826418,"writeMsAvg":"72","status":"COMPLETE","writeMsMax":"118","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.09991532599491956,"readMsAvg":"0","waitRatioAvg":0.016088060965283656,"completedParallelInputs":"100","computeRatioMax":0.00846740050804403,"name":"S29: Coalesce","shuffleOutputBytes":"52074","recordsWritten":"1844","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage1F_output"]}],"writeRatioAvg":0.06096528365791702},{"readMsMax":"0","computeMsMax":"36","inputStages":["27","41","40","37","39","38"],"waitMsAvg":"5","id":"42","endMs":"1570971754581","waitMsMax":"5","startMs":"1570971754146","waitRatioMax":0.004233700254022015,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"27682","computeRatioAvg":0.03048264182895851,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"36","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005080440304826418,"readMsAvg":"0","waitRatioAvg":0.004233700254022015,"completedParallelInputs":"1","computeRatioMax":0.03048264182895851,"name":"S2A: Join+","shuffleOutputBytes":"19597","recordsWritten":"306","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$330, $332, $331, $290","FROM __stage1B_output"]},{"kind":"READ","substeps":["$260, $390","FROM __stage25_output"]},{"kind":"READ","substeps":["$230, $450","FROM __stage26_output"]},{"kind":"READ","substeps":["$220, $510","FROM __stage27_output"]},{"kind":"READ","substeps":["$200, $570","FROM __stage28_output"]},{"kind":"READ","substeps":["$190, $630","FROM __stage29_output"]},{"kind":"COMPUTE","substeps":["$180 := divide($642, $643)","$181 := divide($646, $645)","$182 := divide($647, $642)","$183 := divide($644, $646)"]},{"kind":"FILTER","substeps":["greater(case_no_value(greater($642, 0), divide($647, $642), NULL), case_no_value(greater($646, 0), divide($644, $646), NULL))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $580 = $630"]},{"kind":"FILTER","substeps":["greater(case_no_value(greater($583, 0), divide($587, $583), NULL), case_no_value(greater($585, 0), divide($586, $585), NULL))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $525 = $570"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $460 = $510"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $403 = $450"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $340 = $390"]},{"kind":"AGGREGATE","substeps":["GROUP BY $340 := $330, $341 := $331, $342 := $332","$250 := SUM($290)"]},{"kind":"WRITE","substeps":["$640, $641, $180, $181, $182, $183","TO __stage2A_output"]}],"writeRatioAvg":0.005080440304826418},{"readMsMax":"0","computeMsMax":"6","inputStages":["42"],"waitMsAvg":"1","id":"43","endMs":"1570971754675","waitMsMax":"1","startMs":"1570971754616","waitRatioMax":0.000846740050804403,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"306","computeRatioAvg":0.005080440304826418,"writeMsAvg":"31","status":"COMPLETE","writeMsMax":"31","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.026248941574936496,"readMsAvg":"0","waitRatioAvg":0.000846740050804403,"completedParallelInputs":"1","computeRatioMax":0.005080440304826418,"name":"S2B: Output","shuffleOutputBytes":"19597","recordsWritten":"306","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$640, $641, $180, $181, $182, $183","FROM __stage2A_output"]},{"kind":"SORT","substeps":["$641 ASC"]},{"kind":"WRITE","substeps":["$650, $651, $652, $653, $654, $655","TO __stage2B_output"]}],"writeRatioAvg":0.026248941574936496}],"estimatedBytesProcessed":"840565466","timeline":[{"totalSlotMs":"4033","activeUnits":"46","completedUnits":"4","elapsedMs":"645","pendingUnits":"50"},{"totalSlotMs":"63390","activeUnits":"29","completedUnits":"133","elapsedMs":"1673","pendingUnits":"21"},{"totalSlotMs":"78994","activeUnits":"10","completedUnits":"154","elapsedMs":"2728","pendingUnits":"3"},{"totalSlotMs":"159763","activeUnits":"1","completedUnits":"661","elapsedMs":"3878","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"840957952","totalPartitionsProcessed":"0","totalBytesProcessed":"840565466","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570971755133"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query31_1570971749"},"etag":"LOLGfkEg2NB+n8ONGmMzZQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query31_1570971749?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon43c5f0f1bbd006218ef1147b88a5e5f37ce5b370","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query31\nWITH ss \n AS (SELECT ca_county, \n d_qoy, \n d_year, \n Sum(ss_ext_sales_price) AS store_sales \n FROM store_sales, \n date_dim, \n customer_address \n WHERE ss_sold_date_sk = d_date_sk \n AND ss_addr_sk = ca_address_sk \n GROUP BY ca_county, \n d_qoy, \n d_year), \n ws \n AS (SELECT ca_county, \n d_qoy, \n d_year, \n Sum(ws_ext_sales_price) AS web_sales \n FROM web_sales, \n date_dim, \n customer_address \n WHERE ws_sold_date_sk = d_date_sk \n AND ws_bill_addr_sk = ca_address_sk \n GROUP BY ca_county, \n d_qoy, \n d_year) \nSELECT ss1.ca_county, \n ss1.d_year, \n ws2.web_sales / ws1.web_sales web_q1_q2_increase, \n ss2.store_sales / ss1.store_sales store_q1_q2_increase, \n ws3.web_sales / ws2.web_sales web_q2_q3_increase, \n ss3.store_sales / ss2.store_sales store_q2_q3_increase \nFROM ss ss1, \n ss ss2, \n ss ss3, \n ws ws1, \n ws ws2, \n ws ws3 \nWHERE ss1.d_qoy = 1 \n AND ss1.d_year = 2001 \n AND ss1.ca_county = ss2.ca_county \n AND ss2.d_qoy = 2 \n AND ss2.d_year = 2001 \n AND ss2.ca_county = ss3.ca_county \n AND ss3.d_qoy = 3 \n AND ss3.d_year = 2001 \n AND ss1.ca_county = ws1.ca_county \n AND ws1.d_qoy = 1 \n AND ws1.d_year = 2001 \n AND ws1.ca_county = ws2.ca_county \n AND ws2.d_qoy = 2 \n AND ws2.d_year = 2001 \n AND ws1.ca_county = ws3.ca_county \n AND ws3.d_qoy = 3 \n AND ws3.d_year = 2001 \n AND CASE \n WHEN ws1.web_sales > 0 THEN ws2.web_sales / ws1.web_sales \n ELSE NULL \n END > CASE \n WHEN ss1.store_sales > 0 THEN \n ss2.store_sales / ss1.store_sales \n ELSE NULL \n END \n AND CASE \n WHEN ws2.web_sales > 0 THEN ws3.web_sales / ws2.web_sales \n ELSE NULL \n END > CASE \n WHEN ss2.store_sales > 0 THEN \n ss3.store_sales / ss2.store_sales \n ELSE NULL \n END \nORDER BY ss1.d_year; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query31_1570971749","user_email":"nithish.sankaranarayanan@ulb.be"}
