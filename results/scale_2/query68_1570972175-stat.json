{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"70924","creationTime":"1570972176302","totalBytesProcessed":"2013099252","startTime":"1570972176440","query":{"totalSlotMs":"70924","queryPlan":[{"readMsMax":"19","computeMsMax":"175","waitMsAvg":"2","id":"0","endMs":"1570972177087","waitMsMax":"2","startMs":"1570972176781","waitRatioMax":0.0006736274840013472,"readRatioAvg":0.006399461098012799,"parallelInputs":"1","recordsRead":"250000","computeRatioAvg":0.05894240485011788,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"175","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00740990232401482,"readMsAvg":"19","waitRatioAvg":0.0006736274840013472,"completedParallelInputs":"1","computeRatioMax":0.05894240485011788,"name":"S00: Input","shuffleOutputBytes":"5642706","recordsWritten":"250000","readRatioMax":0.006399461098012799,"steps":[{"kind":"READ","substeps":["$20:ca_address_sk, $21:ca_city","FROM customer_address"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage00_output","BY HASH($20)"]}],"writeRatioAvg":0.00740990232401482},{"readMsMax":"27","computeMsMax":"7","waitMsAvg":"21","id":"1","endMs":"1570972177056","waitMsMax":"21","startMs":"1570972176825","waitRatioMax":0.007073088582014146,"readRatioAvg":0.009093971034018189,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.0023576961940047153,"writeMsAvg":"193","status":"COMPLETE","writeMsMax":"193","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.06500505220613001,"readMsAvg":"27","waitRatioAvg":0.007073088582014146,"completedParallelInputs":"1","computeRatioMax":0.0023576961940047153,"name":"S01: Input","shuffleOutputBytes":"16200","recordsWritten":"1800","readRatioMax":0.009093971034018189,"steps":[{"kind":"READ","substeps":["$30:hd_demo_sk, $31:hd_dep_count, $32:hd_vehicle_count","FROM household_demographics","WHERE or(equal($31, 8), equal($32, 3))"]},{"kind":"WRITE","substeps":["$30","TO __stage01_output","BY HASH($30)"]}],"writeRatioAvg":0.06500505220613001},{"readMsMax":"22","computeMsMax":"7","waitMsAvg":"37","id":"2","endMs":"1570972176969","waitMsMax":"37","startMs":"1570972176867","waitRatioMax":0.012462108454024925,"readRatioAvg":0.00740990232401482,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.0023576961940047153,"writeMsAvg":"59","status":"COMPLETE","writeMsMax":"59","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.019872010778039743,"readMsAvg":"22","waitRatioAvg":0.012462108454024925,"completedParallelInputs":"1","computeRatioMax":0.0023576961940047153,"name":"S02: Input","shuffleOutputBytes":"324","recordsWritten":"36","readRatioMax":0.00740990232401482,"steps":[{"kind":"READ","substeps":["$50:s_store_sk, $51:s_city","FROM store","WHERE in($51, 'Fairview', 'Midway')"]},{"kind":"WRITE","substeps":["$50","TO __stage02_output","BY HASH($50)"]}],"writeRatioAvg":0.019872010778039743},{"readMsMax":"17","computeMsMax":"10","waitMsAvg":"2","id":"3","endMs":"1570972177117","waitMsMax":"2","startMs":"1570972176919","waitRatioMax":0.0006736274840013472,"readRatioAvg":0.0057258336140114515,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.003368137420006736,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002694509936005389,"readMsAvg":"17","waitRatioAvg":0.0006736274840013472,"completedParallelInputs":"1","computeRatioMax":0.003368137420006736,"name":"S03: Input","shuffleOutputBytes":"648","recordsWritten":"72","readRatioMax":0.0057258336140114515,"steps":[{"kind":"READ","substeps":["$60:d_date_sk, $61:d_year, $62:d_dom","FROM date_dim","WHERE and(between($62, 1, 2), in($61, 1998, 1999, 2000))"]},{"kind":"WRITE","substeps":["$60","TO __stage03_output","BY HASH($60)"]}],"writeRatioAvg":0.002694509936005389},{"readMsMax":"1062","computeMsMax":"2969","inputStages":["0","1","2","3"],"waitMsAvg":"2","id":"5","endMs":"1570972179543","waitMsMax":"3","startMs":"1570972177180","waitRatioMax":0.0010104412260020209,"readRatioAvg":0.2452004041764904,"parallelInputs":"10","recordsRead":"31321192","computeRatioAvg":0.8134051869316268,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"2415","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001684068710003368,"readMsAvg":"728","waitRatioAvg":0.0006736274840013472,"completedParallelInputs":"10","computeRatioMax":1,"name":"S05: Join+","shuffleOutputBytes":"2662322","recordsWritten":"39486","readRatioMax":0.3576961940047154,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_hdemo_sk, $43:ss_addr_sk, $44:ss_store_sk, $45:ss_ticket_number, $46:ss_ext_sales_price, $47:ss_ext_list_price, $48:ss_ext_tax","FROM store_sales"]},{"kind":"READ","substeps":["$60","FROM __stage03_output"]},{"kind":"READ","substeps":["$50","FROM __stage02_output"]},{"kind":"READ","substeps":["$30","FROM __stage01_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $150 := $142, $151 := $140, $152 := $141, $153 := $146","$80 := SUM($143)","$81 := SUM($144)","$82 := SUM($145)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $131 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $111 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $93 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $60"]},{"kind":"WRITE","substeps":["$153, $151, $152, $150, $80, $81, $82","TO __stage05_output","BY HASH($150, $151, $152, $153)"]}],"writeRatioAvg":0.0013472549680026945},{"readMsMax":"0","computeMsMax":"48","inputStages":["5"],"waitMsAvg":"1","id":"8","endMs":"1570972179890","waitMsMax":"1","startMs":"1570972179672","waitRatioMax":0.0003368137420006736,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"39486","computeRatioAvg":0.016167059616032334,"writeMsAvg":"177","status":"COMPLETE","writeMsMax":"177","computeMsAvg":"48","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05961603233411923,"readMsAvg":"0","waitRatioAvg":0.0003368137420006736,"completedParallelInputs":"1","computeRatioMax":0.016167059616032334,"name":"S08: Aggregate","shuffleOutputBytes":"342361","recordsWritten":"5846","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$153, $151, $152, $150, $80, $81, $82","FROM __stage05_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $160 := $150, $161 := $151, $162 := $152, $163 := $153","$70 := SUM($80)","$71 := SUM($81)","$72 := SUM($82)"]},{"kind":"WRITE","substeps":["$70, $71, $72, $160, $161, $163","TO __stage08_output","BY HASH($161)"]}],"writeRatioAvg":0.05961603233411923},{"readMsMax":"0","computeMsMax":"7","inputStages":["8"],"waitMsAvg":"1","id":"9","endMs":"1570972180171","waitMsMax":"4","startMs":"1570972179925","waitRatioMax":0.0013472549680026945,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"5846","computeRatioAvg":0.0013472549680026945,"writeMsAvg":"173","status":"COMPLETE","writeMsMax":"227","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.07645671943415291,"readMsAvg":"0","waitRatioAvg":0.0003368137420006736,"completedParallelInputs":"100","computeRatioMax":0.0023576961940047153,"name":"S09: Coalesce","shuffleOutputBytes":"342361","recordsWritten":"5846","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage08_output"]}],"writeRatioAvg":0.05826877736611654},{"readMsMax":"31","computeMsMax":"219","inputStages":["9"],"waitMsAvg":"1","id":"10","endMs":"1570972180310","waitMsMax":"1","startMs":"1570972180019","waitRatioMax":0.0003368137420006736,"readRatioAvg":0.010441226002020883,"parallelInputs":"1","recordsRead":"505846","computeRatioAvg":0.07376220949814752,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"219","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007746716066015493,"readMsAvg":"31","waitRatioAvg":0.0003368137420006736,"completedParallelInputs":"1","computeRatioMax":0.07376220949814752,"name":"S0A: Join","shuffleOutputBytes":"466729","recordsWritten":"5846","readRatioMax":0.010441226002020883,"steps":[{"kind":"READ","substeps":["$10:c_customer_sk, $11:c_current_addr_sk, $12:c_first_name, $13:c_last_name","FROM customer"]},{"kind":"READ","substeps":["$70, $71, $72, $160, $161, $163","FROM __stage09_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $10 = $161"]},{"kind":"WRITE","substeps":["$170, $171, $172, $173, $174, $175, $176, $177","TO __stage0A_output","BY HASH($175)"]}],"writeRatioAvg":0.007746716066015493},{"readMsMax":"0","computeMsMax":"10","inputStages":["10"],"waitMsAvg":"1","id":"11","endMs":"1570972180499","waitMsMax":"6","startMs":"1570972180375","waitRatioMax":0.0020208824520040417,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"5846","computeRatioAvg":0.001684068710003368,"writeMsAvg":"38","status":"COMPLETE","writeMsMax":"63","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.021219265746042437,"readMsAvg":"0","waitRatioAvg":0.0003368137420006736,"completedParallelInputs":"100","computeRatioMax":0.003368137420006736,"name":"S0B: Coalesce","shuffleOutputBytes":"466729","recordsWritten":"5846","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0A_output"]}],"writeRatioAvg":0.012798922196025598},{"readMsMax":"13","computeMsMax":"46","inputStages":["11"],"waitMsAvg":"8","id":"12","endMs":"1570972180607","waitMsMax":"8","startMs":"1570972180382","waitRatioMax":0.002694509936005389,"readRatioAvg":0.004378578646008757,"parallelInputs":"1","recordsRead":"255846","computeRatioAvg":0.015493432132030987,"writeMsAvg":"49","status":"COMPLETE","writeMsMax":"49","computeMsAvg":"46","shuffleOutputBytesSpilled":"0","writeRatioMax":0.016503873358033008,"readMsAvg":"13","waitRatioAvg":0.002694509936005389,"completedParallelInputs":"1","computeRatioMax":0.015493432132030987,"name":"S0C: Join+","shuffleOutputBytes":"7107","recordsWritten":"100","readRatioMax":0.004378578646008757,"steps":[{"kind":"READ","substeps":["$1:ca_address_sk, $2:ca_city","FROM customer_address"]},{"kind":"READ","substeps":["$170, $171, $172, $173, $174, $175, $176, $177","FROM __stage0B_output"]},{"kind":"SORT","substeps":["$181 ASC, $183 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["not_equal($187, $182)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $175"]},{"kind":"WRITE","substeps":["$190, $191, $192, $193, $194, $195, $196, $197","TO __stage0C_output"]}],"writeRatioAvg":0.016503873358033008},{"readMsMax":"0","computeMsMax":"7","inputStages":["12"],"waitMsAvg":"3","id":"13","endMs":"1570972180747","waitMsMax":"3","startMs":"1570972180409","waitRatioMax":0.0010104412260020209,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0023576961940047153,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002694509936005389,"readMsAvg":"0","waitRatioAvg":0.0010104412260020209,"completedParallelInputs":"1","computeRatioMax":0.0023576961940047153,"name":"S0D: Output","shuffleOutputBytes":"7107","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$190, $191, $192, $193, $194, $195, $196, $197","FROM __stage0C_output"]},{"kind":"SORT","substeps":["$192 ASC, $194 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$200, $201, $202, $203, $204, $205, $206, $207","TO __stage0D_output"]}],"writeRatioAvg":0.002694509936005389}],"estimatedBytesProcessed":"2013099252","timeline":[{"totalSlotMs":"1043","activeUnits":"10","completedUnits":"4","elapsedMs":"843","pendingUnits":"10"},{"totalSlotMs":"37558","activeUnits":"5","completedUnits":"14","elapsedMs":"3348","pendingUnits":"3"},{"totalSlotMs":"59604","activeUnits":"101","completedUnits":"116","elapsedMs":"3952","pendingUnits":"102"},{"totalSlotMs":"70924","activeUnits":"101","completedUnits":"218","elapsedMs":"6235","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"2013265920","totalPartitionsProcessed":"0","totalBytesProcessed":"2013099252","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570972182700"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query68_1570972175"},"etag":"XjkLJTnaAT4Dj/IfV45pgA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query68_1570972175?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon745c9a61b390e6037aaf96a5ae75147281511c63","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query68\nSELECT c_last_name, \n c_first_name, \n ca_city, \n bought_city, \n ss_ticket_number, \n extended_price, \n extended_tax, \n list_price \nFROM (SELECT ss_ticket_number, \n ss_customer_sk, \n ca_city bought_city, \n Sum(ss_ext_sales_price) extended_price, \n Sum(ss_ext_list_price) list_price, \n Sum(ss_ext_tax) extended_tax \n FROM store_sales, \n date_dim, \n store, \n household_demographics, \n customer_address \n WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk \n AND store_sales.ss_store_sk = store.s_store_sk \n AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk \n AND store_sales.ss_addr_sk = customer_address.ca_address_sk \n AND date_dim.d_dom BETWEEN 1 AND 2 \n AND ( household_demographics.hd_dep_count = 8 \n OR household_demographics.hd_vehicle_count = 3 ) \n AND date_dim.d_year IN ( 1998, 1998 + 1, 1998 + 2 ) \n AND store.s_city IN ( 'Fairview', 'Midway' ) \n GROUP BY ss_ticket_number, \n ss_customer_sk, \n ss_addr_sk, \n ca_city) dn, \n customer, \n customer_address current_addr \nWHERE ss_customer_sk = c_customer_sk \n AND customer.c_current_addr_sk = current_addr.ca_address_sk \n AND current_addr.ca_city <> bought_city \nORDER BY c_last_name, \n ss_ticket_number\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query68_1570972175","user_email":"nithish.sankaranarayanan@ulb.be"}
