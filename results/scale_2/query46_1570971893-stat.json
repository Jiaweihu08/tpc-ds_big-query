{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"40225","creationTime":"1570971894398","totalBytesProcessed":"1793048356","startTime":"1570971894587","query":{"totalSlotMs":"40225","queryPlan":[{"readMsMax":"14","computeMsMax":"201","waitMsAvg":"0","id":"0","endMs":"1570971895151","waitMsMax":"0","startMs":"1570971894706","waitRatioMax":0,"readRatioAvg":0.00619743249225321,"parallelInputs":"1","recordsRead":"250000","computeRatioAvg":0.08897742363877822,"writeMsAvg":"139","status":"COMPLETE","writeMsMax":"139","computeMsAvg":"201","shuffleOutputBytesSpilled":"0","writeRatioMax":0.061531651173085435,"readMsAvg":"14","waitRatioAvg":0,"completedParallelInputs":"1","computeRatioMax":0.08897742363877822,"name":"S00: Input","shuffleOutputBytes":"5642706","recordsWritten":"250000","readRatioMax":0.00619743249225321,"steps":[{"kind":"READ","substeps":["$20:ca_address_sk, $21:ca_city","FROM customer_address"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage00_output","BY HASH($20)"]}],"writeRatioAvg":0.061531651173085435},{"readMsMax":"33","computeMsMax":"9","waitMsAvg":"1","id":"1","endMs":"1570971894881","waitMsMax":"1","startMs":"1570971894781","waitRatioMax":0.0004426737494466578,"readRatioAvg":0.014608233731739707,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.00398406374501992,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0026560424966799467,"readMsAvg":"33","waitRatioAvg":0.0004426737494466578,"completedParallelInputs":"1","computeRatioMax":0.00398406374501992,"name":"S01: Input","shuffleOutputBytes":"16200","recordsWritten":"1800","readRatioMax":0.014608233731739707,"steps":[{"kind":"READ","substeps":["$30:hd_demo_sk, $31:hd_dep_count, $32:hd_vehicle_count","FROM household_demographics","WHERE or(equal($31, 6), equal($32, 0))"]},{"kind":"WRITE","substeps":["$30","TO __stage01_output","BY HASH($30)"]}],"writeRatioAvg":0.0026560424966799467},{"readMsMax":"17","computeMsMax":"6","waitMsAvg":"25","id":"2","endMs":"1570971894900","waitMsMax":"25","startMs":"1570971894825","waitRatioMax":0.011066843736166445,"readRatioAvg":0.007525453740593183,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.0026560424966799467,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0026560424966799467,"readMsAvg":"17","waitRatioAvg":0.011066843736166445,"completedParallelInputs":"1","computeRatioMax":0.0026560424966799467,"name":"S02: Input","shuffleOutputBytes":"324","recordsWritten":"36","readRatioMax":0.007525453740593183,"steps":[{"kind":"READ","substeps":["$50:s_store_sk, $51:s_city","FROM store","WHERE in($51, 'Midway', 'Fairview', 'Fairview', 'Fairview', 'Fairview')"]},{"kind":"WRITE","substeps":["$50","TO __stage02_output","BY HASH($50)"]}],"writeRatioAvg":0.0026560424966799467},{"readMsMax":"15","computeMsMax":"11","waitMsAvg":"55","id":"3","endMs":"1570971894919","waitMsMax":"55","startMs":"1570971894870","waitRatioMax":0.02434705621956618,"readRatioAvg":0.006640106241699867,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004869411243913236,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003098716246126605,"readMsAvg":"15","waitRatioAvg":0.02434705621956618,"completedParallelInputs":"1","computeRatioMax":0.004869411243913236,"name":"S03: Input","shuffleOutputBytes":"2826","recordsWritten":"314","readRatioMax":0.006640106241699867,"steps":[{"kind":"READ","substeps":["$60:d_date_sk, $61:d_year, $62:d_dow","FROM date_dim","WHERE and(in($62, 6, 0), in($61, 2000, 2001, 2002))"]},{"kind":"WRITE","substeps":["$60","TO __stage03_output","BY HASH($60)"]}],"writeRatioAvg":0.003098716246126605},{"readMsMax":"100","computeMsMax":"2259","inputStages":["0","1","2","3"],"waitMsAvg":"1","id":"6","endMs":"1570971896794","waitMsMax":"1","startMs":"1570971895189","waitRatioMax":0.0004426737494466578,"readRatioAvg":0.021691013722886232,"parallelInputs":"10","recordsRead":"31323612","computeRatioAvg":0.8521469676848162,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"50","computeMsAvg":"1925","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02213368747233289,"readMsAvg":"49","waitRatioAvg":0.0004426737494466578,"completedParallelInputs":"10","computeRatioMax":1,"name":"S06: Join+","shuffleOutputBytes":"10519009","recordsWritten":"179875","readRatioMax":0.04426737494466578,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_hdemo_sk, $43:ss_addr_sk, $44:ss_store_sk, $45:ss_ticket_number, $46:ss_coupon_amt, $47:ss_net_profit","FROM store_sales"]},{"kind":"READ","substeps":["$60","FROM __stage03_output"]},{"kind":"READ","substeps":["$50","FROM __stage02_output"]},{"kind":"READ","substeps":["$30","FROM __stage01_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $150 := $142, $151 := $140, $152 := $141, $153 := $145","$80 := SUM($143)","$81 := SUM($144)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $131 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $111 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $93 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $60"]},{"kind":"WRITE","substeps":["$153, $151, $152, $150, $80, $81","TO __stage06_output","BY HASH($150, $151, $152, $153)"]}],"writeRatioAvg":0.004869411243913236},{"readMsMax":"0","computeMsMax":"213","inputStages":["6"],"waitMsAvg":"1","id":"9","endMs":"1570971896999","waitMsMax":"1","startMs":"1570971896844","waitRatioMax":0.0004426737494466578,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"179875","computeRatioAvg":0.09428950863213811,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"213","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009296148738379814,"readMsAvg":"0","waitRatioAvg":0.0004426737494466578,"completedParallelInputs":"1","computeRatioMax":0.09428950863213811,"name":"S09: Aggregate","shuffleOutputBytes":"1316830","recordsWritten":"26560","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$153, $151, $152, $150, $80, $81","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $160 := $150, $161 := $151, $162 := $152, $163 := $153","$70 := SUM($80)","$71 := SUM($81)"]},{"kind":"WRITE","substeps":["$70, $71, $160, $161, $163","TO __stage09_output","BY HASH($161)"]}],"writeRatioAvg":0.009296148738379814},{"readMsMax":"0","computeMsMax":"8","inputStages":["9"],"waitMsAvg":"1","id":"10","endMs":"1570971897125","waitMsMax":"3","startMs":"1570971897026","waitRatioMax":0.0013280212483399733,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"26560","computeRatioAvg":0.002213368747233289,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009296148738379814,"readMsAvg":"0","waitRatioAvg":0.0004426737494466578,"completedParallelInputs":"100","computeRatioMax":0.0035413899955732625,"name":"S0A: Coalesce","shuffleOutputBytes":"1316830","recordsWritten":"26560","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage09_output"]}],"writeRatioAvg":0.007082779991146525},{"readMsMax":"20","computeMsMax":"301","inputStages":["10"],"waitMsAvg":"1","id":"11","endMs":"1570971897332","waitMsMax":"1","startMs":"1570971897041","waitRatioMax":0.0004426737494466578,"readRatioAvg":0.008853474988933156,"parallelInputs":"1","recordsRead":"526560","computeRatioAvg":0.133244798583444,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"301","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009738822487826471,"readMsAvg":"20","waitRatioAvg":0.0004426737494466578,"completedParallelInputs":"1","computeRatioMax":0.133244798583444,"name":"S0B: Join","shuffleOutputBytes":"1880873","recordsWritten":"26560","readRatioMax":0.008853474988933156,"steps":[{"kind":"READ","substeps":["$10:c_customer_sk, $11:c_current_addr_sk, $12:c_first_name, $13:c_last_name","FROM customer"]},{"kind":"READ","substeps":["$70, $71, $160, $161, $163","FROM __stage0A_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $10 = $161"]},{"kind":"WRITE","substeps":["$170, $171, $172, $173, $174, $175, $176","TO __stage0B_output","BY HASH($174)"]}],"writeRatioAvg":0.009738822487826471},{"readMsMax":"0","computeMsMax":"9","inputStages":["11"],"waitMsAvg":"2","id":"12","endMs":"1570971897436","waitMsMax":"4","startMs":"1570971897339","waitRatioMax":0.0017706949977866313,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"26560","computeRatioAvg":0.0026560424966799467,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012837538733953076,"readMsAvg":"0","waitRatioAvg":0.0008853474988933156,"completedParallelInputs":"100","computeRatioMax":0.00398406374501992,"name":"S0C: Coalesce","shuffleOutputBytes":"1880873","recordsWritten":"26560","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0B_output"]}],"writeRatioAvg":0.007525453740593183},{"readMsMax":"16","computeMsMax":"102","inputStages":["12"],"waitMsAvg":"4","id":"13","endMs":"1570971897513","waitMsMax":"4","startMs":"1570971897343","waitRatioMax":0.0017706949977866313,"readRatioAvg":0.007082779991146525,"parallelInputs":"1","recordsRead":"276560","computeRatioAvg":0.0451527224435591,"writeMsAvg":"2","status":"COMPLETE","writeMsMax":"2","computeMsAvg":"102","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0008853474988933156,"readMsAvg":"16","waitRatioAvg":0.0017706949977866313,"completedParallelInputs":"1","computeRatioMax":0.0451527224435591,"name":"S0D: Join+","shuffleOutputBytes":"5722","recordsWritten":"100","readRatioMax":0.007082779991146525,"steps":[{"kind":"READ","substeps":["$1:ca_address_sk, $2:ca_city","FROM customer_address"]},{"kind":"READ","substeps":["$170, $171, $172, $173, $174, $175, $176","FROM __stage0C_output"]},{"kind":"SORT","substeps":["$181 ASC, $180 ASC, $186 ASC, $182 ASC, $183 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["not_equal($186, $182)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $174"]},{"kind":"WRITE","substeps":["$190, $191, $192, $193, $194, $195, $196","TO __stage0D_output"]}],"writeRatioAvg":0.0008853474988933156},{"readMsMax":"0","computeMsMax":"5","inputStages":["13"],"waitMsAvg":"1","id":"14","endMs":"1570971897554","waitMsMax":"1","startMs":"1570971897358","waitRatioMax":0.0004426737494466578,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.002213368747233289,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0035413899955732625,"readMsAvg":"0","waitRatioAvg":0.0004426737494466578,"completedParallelInputs":"1","computeRatioMax":0.002213368747233289,"name":"S0E: Output","shuffleOutputBytes":"5722","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$190, $191, $192, $193, $194, $195, $196","FROM __stage0D_output"]},{"kind":"SORT","substeps":["$192 ASC, $191 ASC, $190 ASC, $193 ASC, $194 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$200, $201, $202, $203, $204, $205, $206","TO __stage0E_output"]}],"writeRatioAvg":0.0035413899955732625}],"estimatedBytesProcessed":"1793048356","timeline":[{"totalSlotMs":"1633","activeUnits":"10","completedUnits":"4","elapsedMs":"621","pendingUnits":"10"},{"totalSlotMs":"29818","activeUnits":"4","completedUnits":"115","elapsedMs":"2595","pendingUnits":"2"},{"totalSlotMs":"40225","activeUnits":"0","completedUnits":"218","elapsedMs":"3249","pendingUnits":"0"},{"totalSlotMs":"40225","activeUnits":"0","completedUnits":"218","elapsedMs":"4425","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"1793064960","totalPartitionsProcessed":"0","totalBytesProcessed":"1793048356","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_10"}]},"endTime":"1570971899054"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query46_1570971893"},"etag":"PPkUBrUfzAIi1cgHky3N+Q==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query46_1570971893?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon00f1e19ce68925c22db4855c7a23d66db1a8a95b","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query46\nSELECT c_last_name, \n c_first_name, \n ca_city, \n bought_city, \n ss_ticket_number, \n amt, \n profit \nFROM (SELECT ss_ticket_number, \n ss_customer_sk, \n ca_city bought_city, \n Sum(ss_coupon_amt) amt, \n Sum(ss_net_profit) profit \n FROM store_sales, \n date_dim, \n store, \n household_demographics, \n customer_address \n WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk \n AND store_sales.ss_store_sk = store.s_store_sk \n AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk \n AND store_sales.ss_addr_sk = customer_address.ca_address_sk \n AND ( household_demographics.hd_dep_count = 6 \n OR household_demographics.hd_vehicle_count = 0 ) \n AND date_dim.d_dow IN ( 6, 0 ) \n AND date_dim.d_year IN ( 2000, 2000 + 1, 2000 + 2 ) \n AND store.s_city IN ( 'Midway', 'Fairview', 'Fairview', \n 'Fairview', \n 'Fairview' ) \n GROUP BY ss_ticket_number, \n ss_customer_sk, \n ss_addr_sk, \n ca_city) dn, \n customer, \n customer_address current_addr \nWHERE ss_customer_sk = c_customer_sk \n AND customer.c_current_addr_sk = current_addr.ca_address_sk \n AND current_addr.ca_city <> bought_city \nORDER BY c_last_name, \n c_first_name, \n ca_city, \n bought_city, \n ss_ticket_number\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query46_1570971893","user_email":"nithish.sankaranarayanan@ulb.be"}
