{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"125156","creationTime":"1570971580709","totalBytesProcessed":"4214108864","startTime":"1570971580837","query":{"totalSlotMs":"125156","queryPlan":[{"readMsMax":"8","computeMsMax":"5","waitMsAvg":"18","id":"0","endMs":"1570971581078","waitMsMax":"18","startMs":"1570971581020","waitRatioMax":0.0018427518427518428,"readRatioAvg":0.000819000819000819,"parallelInputs":"1","recordsRead":"10","computeRatioAvg":0.0005118755118755119,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0029688779688779687,"readMsAvg":"8","waitRatioAvg":0.0018427518427518428,"completedParallelInputs":"1","computeRatioMax":0.0005118755118755119,"name":"S00: Input","shuffleOutputBytes":"90","recordsWritten":"10","readRatioMax":0.000819000819000819,"steps":[{"kind":"READ","substeps":["$1:w_warehouse_sk","FROM warehouse"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.0029688779688779687},{"readMsMax":"39","computeMsMax":"184","waitMsAvg":"16","id":"1","endMs":"1570971581334","waitMsMax":"16","startMs":"1570971581031","waitRatioMax":0.001638001638001638,"readRatioAvg":0.003992628992628993,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.018837018837018837,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"184","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0010237510237510238,"readMsAvg":"39","waitRatioAvg":0.001638001638001638,"completedParallelInputs":"1","computeRatioMax":0.018837018837018837,"name":"S01: Input","shuffleOutputBytes":"7999124","recordsWritten":"102000","readRatioMax":0.003992628992628993,"steps":[{"kind":"READ","substeps":["$10:i_item_sk, $11:i_brand, $12:i_class, $13:i_category, $14:i_product_name","FROM item"]},{"kind":"WRITE","substeps":["$10, $11, $12, $13, $14","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.0010237510237510238},{"readMsMax":"10","computeMsMax":"10","waitMsAvg":"44","id":"2","endMs":"1570971581146","waitMsMax":"44","startMs":"1570971581073","waitRatioMax":0.0045045045045045045,"readRatioAvg":0.0010237510237510238,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0010237510237510238,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.000819000819000819,"readMsAvg":"10","waitRatioAvg":0.0045045045045045045,"completedParallelInputs":"1","computeRatioMax":0.0010237510237510238,"name":"S02: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.0010237510237510238,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_month_seq","FROM date_dim","WHERE between($31, 1205, 1216)"]},{"kind":"WRITE","substeps":["$30","TO __stage02_output","BY HASH($30)"]}],"writeRatioAvg":0.000819000819000819},{"readMsMax":"43","computeMsMax":"9768","inputStages":["0","1","2"],"waitMsAvg":"1","id":"5","endMs":"1570971586945","waitMsMax":"2","startMs":"1570971581385","waitRatioMax":0.00020475020475020476,"readRatioAvg":0.0031736281736281734,"parallelInputs":"14","recordsRead":"134543250","computeRatioAvg":0.8647624897624898,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"110","computeMsAvg":"8447","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01126126126126126,"readMsAvg":"31","waitRatioAvg":0.00010237510237510238,"completedParallelInputs":"14","computeRatioMax":1,"name":"S05: Join+","shuffleOutputBytes":"81391566","recordsWritten":"951328","readRatioMax":0.004402129402129402,"steps":[{"kind":"READ","substeps":["$20:inv_date_sk, $21:inv_item_sk, $22:inv_warehouse_sk, $23:inv_quantity_on_hand","FROM inventory"]},{"kind":"READ","substeps":["$30","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11, $12, $13, $14","FROM __stage01_output"]},{"kind":"READ","substeps":["$1","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $90 := $83, $91 := $80, $92 := $81, $93 := $82","$50 := SHARD_AVG($84)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $70 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $60 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $30"]},{"kind":"WRITE","substeps":["$91, $92, $93, $90, $50","TO __stage05_output","BY HASH($90, $91, $92, $93)"]}],"writeRatioAvg":0.0022522522522522522},{"readMsMax":"0","computeMsMax":"1912","inputStages":["5"],"waitMsAvg":"1","id":"6","endMs":"1570971588048","waitMsMax":"1","startMs":"1570971586979","waitRatioMax":0.00010237510237510238,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"951328","computeRatioAvg":0.19574119574119575,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"1912","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0004095004095004095,"readMsAvg":"0","waitRatioAvg":0.00010237510237510238,"completedParallelInputs":"1","computeRatioMax":0.19574119574119575,"name":"S06: Sort+","shuffleOutputBytes":"7907","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$91, $92, $93, $90, $50","FROM __stage05_output"]},{"kind":"SORT","substeps":["$40 ASC, $100 ASC, $101 ASC, $102 ASC, $103 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $100 := $90, $101 := $91, $102 := $92, $103 := $93","$40 := ROOT_AVG($50)"]},{"kind":"WRITE","substeps":["$110, $111, $112, $113, $114","TO __stage06_output"]}],"writeRatioAvg":0.0004095004095004095},{"readMsMax":"0","computeMsMax":"3","inputStages":["6"],"waitMsAvg":"0","id":"7","endMs":"1570971588071","waitMsMax":"0","startMs":"1570971587056","waitRatioMax":0,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0003071253071253071,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"3","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0003071253071253071,"readMsAvg":"0","waitRatioAvg":0,"completedParallelInputs":"1","computeRatioMax":0.0003071253071253071,"name":"S07: Output","shuffleOutputBytes":"7907","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110, $111, $112, $113, $114","FROM __stage06_output"]},{"kind":"SORT","substeps":["$114 ASC, $113 ASC, $110 ASC, $111 ASC, $112 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$120, $121, $122, $123, $124","TO __stage07_output"]}],"writeRatioAvg":0.0003071253071253071}],"estimatedBytesProcessed":"4214108864","timeline":[{"totalSlotMs":"1519","activeUnits":"14","completedUnits":"3","elapsedMs":"683","pendingUnits":"14"},{"totalSlotMs":"115505","activeUnits":"11","completedUnits":"10","elapsedMs":"5337","pendingUnits":"7"},{"totalSlotMs":"122633","activeUnits":"2","completedUnits":"17","elapsedMs":"6609","pendingUnits":"2"},{"totalSlotMs":"125156","activeUnits":"2","completedUnits":"19","elapsedMs":"7630","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"4214226944","totalPartitionsProcessed":"0","totalBytesProcessed":"4214108864","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"warehouse","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"inventory","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_10"}]},"endTime":"1570971588496"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query22_1570971579"},"etag":"TjxPxE2SryUC2qRi4zFKbQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query22_1570971579?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon5629417047b6b43f6418be9e7e8bcb2fa9d0d800","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query22\nSELECT i_product_name, \n i_brand, \n i_class, \n i_category, \n Avg(inv_quantity_on_hand) qoh \nFROM inventory, \n date_dim, \n item, \n warehouse \nWHERE inv_date_sk = d_date_sk \n AND inv_item_sk = i_item_sk \n AND inv_warehouse_sk = w_warehouse_sk \n AND d_month_seq BETWEEN 1205 AND 1205 + 11 \nGROUP BY i_product_name, i_brand, i_class, i_category \nORDER BY qoh, \n i_product_name, \n i_brand, \n i_class, \n i_category\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query22_1570971579","user_email":"nithish.sankaranarayanan@ulb.be"}
