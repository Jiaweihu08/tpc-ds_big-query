{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"72460","creationTime":"1570971328535","totalBytesProcessed":"346813133","startTime":"1570971328715","query":{"totalSlotMs":"72460","queryPlan":[{"readMsMax":"80","computeMsMax":"59","waitMsAvg":"1","id":"0","endMs":"1570971329051","waitMsMax":"1","startMs":"1570971328914","waitRatioMax":0.0002805836139169473,"readRatioAvg":0.02244668911335578,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.01655443322109989,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"59","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001964085297418631,"readMsAvg":"80","waitRatioAvg":0.0002805836139169473,"completedParallelInputs":"1","computeRatioMax":0.01655443322109989,"name":"S00: Input","shuffleOutputBytes":"2201906","recordsWritten":"73049","readRatioMax":0.02244668911335578,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_week_seq, $52:d_day_name","FROM date_dim"]},{"kind":"WRITE","substeps":["$50, $51, $52","TO __stage00_output","BY HASH($50)"]}],"writeRatioAvg":0.001964085297418631},{"readMsMax":"21","computeMsMax":"61","waitMsAvg":"27","id":"2","endMs":"1570971329183","waitMsMax":"27","startMs":"1570971328974","waitRatioMax":0.007575757575757576,"readRatioAvg":0.005892255892255892,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.01711560044893378,"writeMsAvg":"92","status":"COMPLETE","writeMsMax":"92","computeMsAvg":"61","shuffleOutputBytesSpilled":"0","writeRatioMax":0.025813692480359147,"readMsAvg":"21","waitRatioAvg":0.007575757575757576,"completedParallelInputs":"1","computeRatioMax":0.01711560044893378,"name":"S02: Input","shuffleOutputBytes":"2201906","recordsWritten":"73049","readRatioMax":0.005892255892255892,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_week_seq, $22:d_day_name","FROM date_dim"]},{"kind":"WRITE","substeps":["$20, $21, $22","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.025813692480359147},{"readMsMax":"125","computeMsMax":"3564","inputStages":["0"],"waitMsAvg":"1","id":"4","endMs":"1570971331062","waitMsMax":"1","startMs":"1570971329129","waitRatioMax":0.0002805836139169473,"readRatioAvg":0.02048260381593715,"parallelInputs":"12","recordsRead":"22474941","computeRatioAvg":0.627104377104377,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"2235","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0016835016835016834,"readMsAvg":"73","waitRatioAvg":0.0002805836139169473,"completedParallelInputs":"12","computeRatioMax":1,"name":"S04: Join+","shuffleOutputBytes":"226208","recordsWritten":"3152","readRatioMax":0.035072951739618406,"steps":[{"kind":"READ","substeps":["$60:ws_sold_date_sk, $61:ws_ext_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$70:cs_sold_date_sk, $71:cs_ext_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$50, $51, $52","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $221","$140 := SUM($156)","$141 := SUM($155)","$142 := SUM($154)","$143 := SUM($153)","$144 := SUM($152)","$145 := SUM($151)","$146 := SUM($150)"]},{"kind":"COMPUTE","substeps":["$150 := case_no_value(equal($222, 'Saturday'), $220, NULL)","$151 := case_no_value(equal($222, 'Friday'), $220, NULL)","$152 := case_no_value(equal($222, 'Thursday'), $220, NULL)","$153 := case_no_value(equal($222, 'Wednesday'), $220, NULL)","$154 := case_no_value(equal($222, 'Tuesday'), $220, NULL)","$155 := case_no_value(equal($222, 'Monday'), $220, NULL)","$156 := case_no_value(equal($222, 'Sunday'), $220, NULL)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $170 = $50"]},{"kind":"WRITE","substeps":["$230, $140, $141, $142, $143, $144, $145, $146","TO __stage04_output","BY HASH($230)"]}],"writeRatioAvg":0.0014029180695847362},{"readMsMax":"48","computeMsMax":"2717","inputStages":["2"],"waitMsAvg":"2","id":"5","endMs":"1570971330796","waitMsMax":"2","startMs":"1570971329264","waitRatioMax":0.0005611672278338945,"readRatioAvg":0.007856341189674524,"parallelInputs":"12","recordsRead":"22474941","computeRatioAvg":0.6613355780022446,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"2357","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002244668911335578,"readMsAvg":"28","waitRatioAvg":0.0005611672278338945,"completedParallelInputs":"12","computeRatioMax":0.7623456790123457,"name":"S05: Join+","shuffleOutputBytes":"226208","recordsWritten":"3152","readRatioMax":0.013468013468013467,"steps":[{"kind":"READ","substeps":["$30:ws_sold_date_sk, $31:ws_ext_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$40:cs_sold_date_sk, $41:cs_ext_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$20, $21, $22","FROM __stage02_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $181","$120 := SUM($136)","$121 := SUM($135)","$122 := SUM($134)","$123 := SUM($133)","$124 := SUM($132)","$125 := SUM($131)","$126 := SUM($130)"]},{"kind":"COMPUTE","substeps":["$130 := case_no_value(equal($182, 'Saturday'), $180, NULL)","$131 := case_no_value(equal($182, 'Friday'), $180, NULL)","$132 := case_no_value(equal($182, 'Thursday'), $180, NULL)","$133 := case_no_value(equal($182, 'Wednesday'), $180, NULL)","$134 := case_no_value(equal($182, 'Tuesday'), $180, NULL)","$135 := case_no_value(equal($182, 'Monday'), $180, NULL)","$136 := case_no_value(equal($182, 'Sunday'), $180, NULL)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $160 = $20"]},{"kind":"WRITE","substeps":["$190, $120, $121, $122, $123, $124, $125, $126","TO __stage05_output","BY HASH($190)"]}],"writeRatioAvg":0.0016835016835016834},{"readMsMax":"0","computeMsMax":"10","inputStages":["4"],"waitMsAvg":"1","id":"7","endMs":"1570971331320","waitMsMax":"1","startMs":"1570971331268","waitRatioMax":0.0002805836139169473,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"3152","computeRatioAvg":0.0028058361391694723,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006734006734006734,"readMsAvg":"0","waitRatioAvg":0.0002805836139169473,"completedParallelInputs":"1","computeRatioMax":0.0028058361391694723,"name":"S07: Aggregate","shuffleOutputBytes":"18920","recordsWritten":"263","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$230, $140, $141, $142, $143, $144, $145, $146","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230","$110 := SUM($140)","$111 := SUM($141)","$112 := SUM($142)","$113 := SUM($143)","$114 := SUM($144)","$115 := SUM($145)","$116 := SUM($146)"]},{"kind":"WRITE","substeps":["$110, $111, $112, $113, $114, $115, $116, $240","TO __stage07_output","BY HASH($240)"]}],"writeRatioAvg":0.006734006734006734},{"readMsMax":"6","computeMsMax":"8","waitMsAvg":"1","id":"8","endMs":"1570971331336","waitMsMax":"1","startMs":"1570971331285","waitRatioMax":0.0002805836139169473,"readRatioAvg":0.0016835016835016834,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.002244668911335578,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006172839506172839,"readMsAvg":"6","waitRatioAvg":0.0002805836139169473,"completedParallelInputs":"1","computeRatioMax":0.002244668911335578,"name":"S08: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.0016835016835016834,"steps":[{"kind":"READ","substeps":["$1:d_week_seq, $2:d_year","FROM date_dim","WHERE equal($2, 1998)"]},{"kind":"WRITE","substeps":["$1","TO __stage08_output","BY HASH($1)"]}],"writeRatioAvg":0.006172839506172839},{"readMsMax":"0","computeMsMax":"8","inputStages":["7"],"waitMsAvg":"1","id":"10","endMs":"1570971331457","waitMsMax":"4","startMs":"1570971331336","waitRatioMax":0.001122334455667789,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"263","computeRatioAvg":0.001122334455667789,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"83","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.023288439955106623,"readMsAvg":"0","waitRatioAvg":0.0002805836139169473,"completedParallelInputs":"100","computeRatioMax":0.002244668911335578,"name":"S0A: Coalesce","shuffleOutputBytes":"18920","recordsWritten":"263","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage07_output"]}],"writeRatioAvg":0.007856341189674524},{"readMsMax":"0","computeMsMax":"10","inputStages":["5","8"],"waitMsAvg":"1","id":"12","endMs":"1570971331439","waitMsMax":"1","startMs":"1570971331390","waitRatioMax":0.0002805836139169473,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"3517","computeRatioAvg":0.0028058361391694723,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005050505050505051,"readMsAvg":"0","waitRatioAvg":0.0002805836139169473,"completedParallelInputs":"1","computeRatioMax":0.0028058361391694723,"name":"S0C: Join+","shuffleOutputBytes":"26200","recordsWritten":"365","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$190, $120, $121, $122, $123, $124, $125, $126","FROM __stage05_output"]},{"kind":"READ","substeps":["$1","FROM __stage08_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $200 = $1"]},{"kind":"AGGREGATE","substeps":["GROUP BY $200 := $190","$100 := SUM($120)","$101 := SUM($121)","$102 := SUM($122)","$103 := SUM($123)","$104 := SUM($124)","$105 := SUM($125)","$106 := SUM($126)"]},{"kind":"WRITE","substeps":["$210, $211, $212, $213, $214, $215, $216, $217","TO __stage0C_output","BY HASH($210)"]}],"writeRatioAvg":0.005050505050505051},{"readMsMax":"0","computeMsMax":"8","inputStages":["12"],"waitMsAvg":"2","id":"13","endMs":"1570971331555","waitMsMax":"4","startMs":"1570971331447","waitRatioMax":0.001122334455667789,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"365","computeRatioAvg":0.001122334455667789,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"43","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012065095398428732,"readMsAvg":"0","waitRatioAvg":0.0005611672278338945,"completedParallelInputs":"100","computeRatioMax":0.002244668911335578,"name":"S0D: Coalesce","shuffleOutputBytes":"26200","recordsWritten":"365","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0C_output"]}],"writeRatioAvg":0.005050505050505051},{"readMsMax":"8","computeMsMax":"18","inputStages":["10","13"],"waitMsAvg":"1","id":"14","endMs":"1570971333361","waitMsMax":"1","startMs":"1570971331473","waitRatioMax":0.0002805836139169473,"readRatioAvg":0.002244668911335578,"parallelInputs":"1","recordsRead":"73677","computeRatioAvg":0.005050505050505051,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0016835016835016834,"readMsAvg":"8","waitRatioAvg":0.0002805836139169473,"completedParallelInputs":"1","computeRatioMax":0.005050505050505051,"name":"S0E: Join+","shuffleOutputBytes":"180376","recordsWritten":"2513","readRatioMax":0.002244668911335578,"steps":[{"kind":"READ","substeps":["$10:d_week_seq, $11:d_year","FROM date_dim","WHERE equal($11, 1999)"]},{"kind":"READ","substeps":["$110, $111, $112, $113, $114, $115, $116, $240","FROM __stage0A_output"]},{"kind":"READ","substeps":["$210, $211, $212, $213, $214, $215, $216, $217","FROM __stage0D_output"]},{"kind":"COMPUTE","substeps":["$80 := round(divide($261, $268), 2)","$81 := round(divide($262, $269), 2)","$82 := round(divide($263, $270), 2)","$83 := round(divide($264, $271), 2)","$84 := round(divide($265, $272), 2)","$85 := round(divide($266, $273), 2)","$86 := round(divide($267, $274), 2)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $90 = $210"]},{"kind":"COMPUTE","substeps":["$90 := subtract($250, 53)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $10 = $240"]},{"kind":"WRITE","substeps":["$260, $80, $81, $82, $83, $84, $85, $86","TO __stage0E_output"]}],"writeRatioAvg":0.0016835016835016834},{"readMsMax":"0","computeMsMax":"6","inputStages":["14"],"waitMsAvg":"1","id":"15","endMs":"1570971333801","waitMsMax":"1","startMs":"1570971333749","waitRatioMax":0.0002805836139169473,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2513","computeRatioAvg":0.0016835016835016834,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00813692480359147,"readMsAvg":"0","waitRatioAvg":0.0002805836139169473,"completedParallelInputs":"1","computeRatioMax":0.0016835016835016834,"name":"S0F: Output","shuffleOutputBytes":"180376","recordsWritten":"2513","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$260, $80, $81, $82, $83, $84, $85, $86","FROM __stage0E_output"]},{"kind":"SORT","substeps":["$260 ASC"]},{"kind":"WRITE","substeps":["$280, $281, $282, $283, $284, $285, $286, $287","TO __stage0F_output"]}],"writeRatioAvg":0.00813692480359147}],"estimatedBytesProcessed":"346813133","timeline":[{"totalSlotMs":"2813","activeUnits":"24","completedUnits":"2","elapsedMs":"700","pendingUnits":"24"},{"totalSlotMs":"59625","activeUnits":"4","completedUnits":"26","elapsedMs":"2583","pendingUnits":"4"},{"totalSlotMs":"71688","activeUnits":"1","completedUnits":"229","elapsedMs":"3095","pendingUnits":"1"},{"totalSlotMs":"72460","activeUnits":"1","completedUnits":"231","elapsedMs":"5270","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"347078656","totalPartitionsProcessed":"0","totalBytesProcessed":"346813133","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_10"}]},"endTime":"1570971334014"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query2_1570971327"},"etag":"i19pXkwqQs/QYnXcT8shlg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query2_1570971327?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon0d7e00757c0cba1dac80da8e190ac5bf85c3bc45","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query2\nWITH wscs \n AS (SELECT sold_date_sk, \n sales_price \n FROM (SELECT ws_sold_date_sk sold_date_sk, \n ws_ext_sales_price sales_price \n FROM web_sales) \n UNION ALL \n (SELECT cs_sold_date_sk sold_date_sk, \n cs_ext_sales_price sales_price \n FROM catalog_sales)), \n wswscs \n AS (SELECT d_week_seq, \n Sum(CASE \n WHEN ( d_day_name = 'Sunday' ) THEN sales_price \n ELSE NULL \n END) sun_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Monday' ) THEN sales_price \n ELSE NULL \n END) mon_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Tuesday' ) THEN sales_price \n ELSE NULL \n END) tue_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Wednesday' ) THEN sales_price \n ELSE NULL \n END) wed_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Thursday' ) THEN sales_price \n ELSE NULL \n END) thu_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Friday' ) THEN sales_price \n ELSE NULL \n END) fri_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Saturday' ) THEN sales_price \n ELSE NULL \n END) sat_sales \n FROM wscs, \n date_dim \n WHERE d_date_sk = sold_date_sk \n GROUP BY d_week_seq) \nSELECT d_week_seq1, \n Round(sun_sales1 / sun_sales2, 2), \n Round(mon_sales1 / mon_sales2, 2), \n Round(tue_sales1 / tue_sales2, 2), \n Round(wed_sales1 / wed_sales2, 2), \n Round(thu_sales1 / thu_sales2, 2), \n Round(fri_sales1 / fri_sales2, 2), \n Round(sat_sales1 / sat_sales2, 2) \nFROM (SELECT wswscs.d_week_seq d_week_seq1, \n sun_sales sun_sales1, \n mon_sales mon_sales1, \n tue_sales tue_sales1, \n wed_sales wed_sales1, \n thu_sales thu_sales1, \n fri_sales fri_sales1, \n sat_sales sat_sales1 \n FROM wswscs, \n date_dim \n WHERE date_dim.d_week_seq = wswscs.d_week_seq \n AND d_year = 1998) y, \n (SELECT wswscs.d_week_seq d_week_seq2, \n sun_sales sun_sales2, \n mon_sales mon_sales2, \n tue_sales tue_sales2, \n wed_sales wed_sales2, \n thu_sales thu_sales2, \n fri_sales fri_sales2, \n sat_sales sat_sales2 \n FROM wswscs, \n date_dim \n WHERE date_dim.d_week_seq = wswscs.d_week_seq \n AND d_year = 1998 + 1) z \nWHERE d_week_seq1 = d_week_seq2 - 53 \nORDER BY d_week_seq1;\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query2_1570971327","user_email":"nithish.sankaranarayanan@ulb.be"}
