{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"20530","creationTime":"1570971559219","totalBytesProcessed":"1130515867","startTime":"1570971559421","query":{"totalSlotMs":"20530","queryPlan":[{"readMsMax":"39","computeMsMax":"8","waitMsAvg":"2","id":"0","endMs":"1570971559753","waitMsMax":"2","startMs":"1570971559610","waitRatioMax":0.0008646779074794639,"readRatioAvg":0.016861219195849545,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.0034587116299178555,"writeMsAvg":"81","status":"COMPLETE","writeMsMax":"81","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03501945525291829,"readMsAvg":"39","waitRatioAvg":0.0008646779074794639,"completedParallelInputs":"1","computeRatioMax":0.0034587116299178555,"name":"S00: Input","shuffleOutputBytes":"1938","recordsWritten":"102","readRatioMax":0.016861219195849545,"steps":[{"kind":"READ","substeps":["$1:s_store_sk, $2:s_zip","FROM store"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.03501945525291829},{"readMsMax":"15","computeMsMax":"162","waitMsAvg":"28","id":"1","endMs":"1570971560272","waitMsMax":"28","startMs":"1570971559653","waitRatioMax":0.012105490704712495,"readRatioAvg":0.00648508430609598,"parallelInputs":"1","recordsRead":"250000","computeRatioAvg":0.07003891050583658,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"16","computeMsAvg":"162","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006917423259835711,"readMsAvg":"15","waitRatioAvg":0.012105490704712495,"completedParallelInputs":"1","computeRatioMax":0.07003891050583658,"name":"S01: Input","shuffleOutputBytes":"4683076","recordsWritten":"250000","readRatioMax":0.00648508430609598,"steps":[{"kind":"READ","substeps":["$10:ca_address_sk, $11:ca_zip","FROM customer_address"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.006917423259835711},{"readMsMax":"17","computeMsMax":"399","waitMsAvg":"55","id":"2","endMs":"1570971560158","waitMsMax":"55","startMs":"1570971559696","waitRatioMax":0.023778642455685256,"readRatioAvg":0.007349762213575443,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.17250324254215305,"writeMsAvg":"79","status":"COMPLETE","writeMsMax":"79","computeMsAvg":"399","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03415477734543882,"readMsAvg":"17","waitRatioAvg":0.023778642455685256,"completedParallelInputs":"1","computeRatioMax":0.17250324254215305,"name":"S02: Input","shuffleOutputBytes":"9000000","recordsWritten":"500000","readRatioMax":0.007349762213575443,"steps":[{"kind":"READ","substeps":["$20:c_customer_sk, $21:c_current_addr_sk","FROM customer"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.03415477734543882},{"readMsMax":"49","computeMsMax":"13","waitMsAvg":"51","id":"3","endMs":"1570971559773","waitMsMax":"51","startMs":"1570971559704","waitRatioMax":0.02204928664072633,"readRatioAvg":0.021184608733246867,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.005620406398616515,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0017293558149589277,"readMsAvg":"49","waitRatioAvg":0.02204928664072633,"completedParallelInputs":"1","computeRatioMax":0.005620406398616515,"name":"S03: Input","shuffleOutputBytes":"56569","recordsWritten":"878","readRatioMax":0.021184608733246867,"steps":[{"kind":"READ","substeps":["$40:i_item_sk, $41:i_brand_id, $42:i_brand, $43:i_manufact_id, $44:i_manufact, $45:i_manager_id","FROM item","WHERE equal($45, 38)"]},{"kind":"WRITE","substeps":["$40, $41, $42, $43, $44","TO __stage03_output","BY HASH($40)"]}],"writeRatioAvg":0.0017293558149589277},{"readMsMax":"24","computeMsMax":"11","waitMsAvg":"73","id":"5","endMs":"1570971559804","waitMsMax":"73","startMs":"1570971559754","waitRatioMax":0.03156074362300043,"readRatioAvg":0.010376134889753566,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004755728491137051,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"12","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005188067444876783,"readMsAvg":"24","waitRatioAvg":0.03156074362300043,"completedParallelInputs":"1","computeRatioMax":0.004755728491137051,"name":"S05: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.010376134889753566,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year, $52:d_moy","FROM date_dim","WHERE and(equal($52, 12), equal($51, 1998))"]},{"kind":"WRITE","substeps":["$50","TO __stage05_output","BY HASH($50)"]}],"writeRatioAvg":0.005188067444876783},{"readMsMax":"49","computeMsMax":"2313","inputStages":["0","1","2","3","5"],"waitMsAvg":"7","id":"8","endMs":"1570971561847","waitMsMax":"7","startMs":"1570971560451","waitRatioMax":0.0030263726761781237,"readRatioAvg":0.015131863380890618,"parallelInputs":"10","recordsRead":"36312222","computeRatioAvg":0.7868568958063121,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"1820","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0025940337224383916,"readMsAvg":"35","waitRatioAvg":0.0030263726761781237,"completedParallelInputs":"10","computeRatioMax":1,"name":"S08: Join+","shuffleOutputBytes":"228111","recordsWritten":"3540","readRatioMax":0.021184608733246867,"steps":[{"kind":"READ","substeps":["$30:ss_sold_date_sk, $31:ss_item_sk, $32:ss_customer_sk, $33:ss_store_sk, $34:ss_ext_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$50","FROM __stage05_output"]},{"kind":"READ","substeps":["$40, $41, $42, $43, $44","FROM __stage03_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage01_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $130 := $123, $131 := $122, $132 := $124, $133 := $125","$70 := SUM($121)"]},{"kind":"FILTER","substeps":["not_equal(substr($120, 1, 5), substr($126, 1, 5))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $110 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $106 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $90 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $80 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $30 = $50"]},{"kind":"WRITE","substeps":["$131, $130, $132, $133, $70","TO __stage08_output","BY HASH($130, $131, $132, $133)"]}],"writeRatioAvg":0.00216169476869866},{"readMsMax":"0","computeMsMax":"8","inputStages":["8"],"waitMsAvg":"1","id":"9","endMs":"1570971562062","waitMsMax":"1","startMs":"1570971561878","waitRatioMax":0.00043233895373973193,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"3540","computeRatioAvg":0.0034587116299178555,"writeMsAvg":"153","status":"COMPLETE","writeMsMax":"153","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.06614785992217899,"readMsAvg":"0","waitRatioAvg":0.00043233895373973193,"completedParallelInputs":"1","computeRatioMax":0.0034587116299178555,"name":"S09: Sort+","shuffleOutputBytes":"6454","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$131, $130, $132, $133, $70","FROM __stage08_output"]},{"kind":"SORT","substeps":["$60 DESC, $140 ASC, $141 ASC, $142 ASC, $143 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $140 := $130, $141 := $131, $142 := $132, $143 := $133","$60 := SUM($70)"]},{"kind":"WRITE","substeps":["$150, $151, $152, $153, $154","TO __stage09_output"]}],"writeRatioAvg":0.06614785992217899},{"readMsMax":"0","computeMsMax":"6","inputStages":["9"],"waitMsAvg":"6","id":"10","endMs":"1570971562072","waitMsMax":"6","startMs":"1570971561974","waitRatioMax":0.0025940337224383916,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0025940337224383916,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0025940337224383916,"readMsAvg":"0","waitRatioAvg":0.0025940337224383916,"completedParallelInputs":"1","computeRatioMax":0.0025940337224383916,"name":"S0A: Output","shuffleOutputBytes":"6454","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$150, $151, $152, $153, $154","FROM __stage09_output"]},{"kind":"SORT","substeps":["$154 DESC, $151 ASC, $150 ASC, $152 ASC, $153 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$160, $161, $162, $163, $164","TO __stage0A_output"]}],"writeRatioAvg":0.0025940337224383916}],"estimatedBytesProcessed":"1130515867","timeline":[{"totalSlotMs":"2572","activeUnits":"12","completedUnits":"3","elapsedMs":"692","pendingUnits":"12"},{"totalSlotMs":"4707","activeUnits":"10","completedUnits":"5","elapsedMs":"1239","pendingUnits":"10"},{"totalSlotMs":"20530","activeUnits":"2","completedUnits":"17","elapsedMs":"2808","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"1131413504","totalPartitionsProcessed":"0","totalBytesProcessed":"1130515867","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570971562300"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query19_1570971558"},"etag":"Vl6t/nOViTxQ1GuRf3MlCw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query19_1570971558?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon0eb07e5ff7f8abe04ae15ae2e7aa5c28f260c79e","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query19\nSELECT i_brand_id brand_id, \n i_brand brand, \n i_manufact_id, \n i_manufact, \n Sum(ss_ext_sales_price) ext_price \nFROM date_dim, \n store_sales, \n item, \n customer, \n customer_address, \n store \nWHERE d_date_sk = ss_sold_date_sk \n AND ss_item_sk = i_item_sk \n AND i_manager_id = 38 \n AND d_moy = 12 \n AND d_year = 1998 \n AND ss_customer_sk = c_customer_sk \n AND c_current_addr_sk = ca_address_sk \n AND Substr(ca_zip, 1, 5) <> Substr(s_zip, 1, 5) \n AND ss_store_sk = s_store_sk \nGROUP BY i_brand, \n i_brand_id, \n i_manufact_id, \n i_manufact \nORDER BY ext_price DESC, \n i_brand, \n i_brand_id, \n i_manufact_id, \n i_manufact\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query19_1570971558","user_email":"nithish.sankaranarayanan@ulb.be"}
