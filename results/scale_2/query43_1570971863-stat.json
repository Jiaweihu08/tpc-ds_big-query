{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"17667","creationTime":"1570971864685","totalBytesProcessed":"661975767","startTime":"1570971864883","query":{"totalSlotMs":"17667","queryPlan":[{"readMsMax":"17","computeMsMax":"11","waitMsAvg":"1","id":"0","endMs":"1570971865495","waitMsMax":"1","startMs":"1570971865109","waitRatioMax":0.001002004008016032,"readRatioAvg":0.017034068136272545,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.011022044088176353,"writeMsAvg":"189","status":"COMPLETE","writeMsMax":"189","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.18937875751503006,"readMsAvg":"17","waitRatioAvg":0.001002004008016032,"completedParallelInputs":"1","computeRatioMax":0.011022044088176353,"name":"S00: Input","shuffleOutputBytes":"1440","recordsWritten":"37","readRatioMax":0.017034068136272545,"steps":[{"kind":"READ","substeps":["$10:s_store_sk, $11:s_store_id, $12:s_store_name, $13:s_gmt_offset","FROM store","WHERE equal($13, -5)"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.18937875751503006},{"readMsMax":"10","computeMsMax":"7","waitMsAvg":"22","id":"2","endMs":"1570971865888","waitMsMax":"22","startMs":"1570971865327","waitRatioMax":0.022044088176352707,"readRatioAvg":0.01002004008016032,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0070140280561122245,"writeMsAvg":"540","status":"COMPLETE","writeMsMax":"540","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.5410821643286573,"readMsAvg":"10","waitRatioAvg":0.022044088176352707,"completedParallelInputs":"1","computeRatioMax":0.0070140280561122245,"name":"S02: Input","shuffleOutputBytes":"7717","recordsWritten":"365","readRatioMax":0.01002004008016032,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $22:d_day_name, $21:d_year","FROM date_dim","WHERE equal($21, 2002)"]},{"kind":"WRITE","substeps":["$20, $22","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.5410821643286573},{"readMsMax":"61","computeMsMax":"998","inputStages":["0","2"],"waitMsAvg":"2","id":"3","endMs":"1570971866738","waitMsMax":"2","startMs":"1570971866026","waitRatioMax":0.002004008016032064,"readRatioAvg":0.031062124248496994,"parallelInputs":"10","recordsRead":"28806132","computeRatioAvg":0.8547094188376754,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"853","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009018036072144289,"readMsAvg":"31","waitRatioAvg":0.002004008016032064,"completedParallelInputs":"10","computeRatioMax":1,"name":"S03: Join+","shuffleOutputBytes":"15800","recordsWritten":"170","readRatioMax":0.061122244488977955,"steps":[{"kind":"READ","substeps":["$1:ss_sold_date_sk, $2:ss_store_sk, $3:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$20, $22","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $90 := $83, $91 := $82","$40 := SUM($56)","$41 := SUM($55)","$42 := SUM($54)","$43 := SUM($53)","$44 := SUM($52)","$45 := SUM($51)","$46 := SUM($50)"]},{"kind":"COMPUTE","substeps":["$50 := case_no_value(equal($81, 'Saturday'), $80, NULL)","$51 := case_no_value(equal($81, 'Friday'), $80, NULL)","$52 := case_no_value(equal($81, 'Thursday'), $80, NULL)","$53 := case_no_value(equal($81, 'Wednesday'), $80, NULL)","$54 := case_no_value(equal($81, 'Tuesday'), $80, NULL)","$55 := case_no_value(equal($81, 'Monday'), $80, NULL)","$56 := case_no_value(equal($81, 'Sunday'), $80, NULL)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $71 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $20"]},{"kind":"WRITE","substeps":["$91, $90, $40, $41, $42, $43, $44, $45, $46","TO __stage03_output","BY HASH($90, $91)"]}],"writeRatioAvg":0.004008016032064128},{"readMsMax":"0","computeMsMax":"4","inputStages":["3"],"waitMsAvg":"1","id":"4","endMs":"1570971866753","waitMsMax":"1","startMs":"1570971866743","waitRatioMax":0.001002004008016032,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"170","computeRatioAvg":0.004008016032064128,"writeMsAvg":"1","status":"COMPLETE","writeMsMax":"1","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001002004008016032,"readMsAvg":"0","waitRatioAvg":0.001002004008016032,"completedParallelInputs":"1","computeRatioMax":0.004008016032064128,"name":"S04: Sort+","shuffleOutputBytes":"1580","recordsWritten":"17","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$91, $90, $40, $41, $42, $43, $44, $45, $46","FROM __stage03_output"]},{"kind":"SORT","substeps":["$100 ASC, $101 ASC, $30 ASC, $31 ASC, $32 ASC, $33 ASC, $34 ASC, $35 ASC, $36 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $100 := $90, $101 := $91","$30 := SUM($40)","$31 := SUM($41)","$32 := SUM($42)","$33 := SUM($43)","$34 := SUM($44)","$35 := SUM($45)","$36 := SUM($46)"]},{"kind":"WRITE","substeps":["$110, $111, $112, $113, $114, $115, $116, $117, $118","TO __stage04_output"]}],"writeRatioAvg":0.001002004008016032},{"readMsMax":"0","computeMsMax":"6","inputStages":["4"],"waitMsAvg":"1","id":"5","endMs":"1570971866823","waitMsMax":"1","startMs":"1570971866758","waitRatioMax":0.001002004008016032,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"17","computeRatioAvg":0.006012024048096192,"writeMsAvg":"41","status":"COMPLETE","writeMsMax":"41","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.041082164328657314,"readMsAvg":"0","waitRatioAvg":0.001002004008016032,"completedParallelInputs":"1","computeRatioMax":0.006012024048096192,"name":"S05: Output","shuffleOutputBytes":"1580","recordsWritten":"17","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110, $111, $112, $113, $114, $115, $116, $117, $118","FROM __stage04_output"]},{"kind":"SORT","substeps":["$111 ASC, $110 ASC, $112 ASC, $113 ASC, $114 ASC, $115 ASC, $116 ASC, $117 ASC, $118 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$120, $121, $122, $123, $124, $125, $126, $127, $128","TO __stage05_output"]}],"writeRatioAvg":0.041082164328657314}],"estimatedBytesProcessed":"661975767","timeline":[{"totalSlotMs":"1579","activeUnits":"11","completedUnits":"1","elapsedMs":"727","pendingUnits":"11"},{"totalSlotMs":"17667","activeUnits":"10","completedUnits":"14","elapsedMs":"2088","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"662700032","totalPartitionsProcessed":"0","totalBytesProcessed":"661975767","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570971867016"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query43_1570971863"},"etag":"p2soWF6QTjrIB+2iCT+XyQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query43_1570971863?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon9d78d10dd5ef630a4dcc07d1ce739a152ee51b80","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query43\nSELECT s_store_name, \n s_store_id, \n Sum(CASE \n WHEN ( d_day_name = 'Sunday' ) THEN ss_sales_price \n ELSE NULL \n END) sun_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Monday' ) THEN ss_sales_price \n ELSE NULL \n END) mon_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Tuesday' ) THEN ss_sales_price \n ELSE NULL \n END) tue_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Wednesday' ) THEN ss_sales_price \n ELSE NULL \n END) wed_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Thursday' ) THEN ss_sales_price \n ELSE NULL \n END) thu_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Friday' ) THEN ss_sales_price \n ELSE NULL \n END) fri_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Saturday' ) THEN ss_sales_price \n ELSE NULL \n END) sat_sales \nFROM date_dim, \n store_sales, \n store \nWHERE d_date_sk = ss_sold_date_sk \n AND s_store_sk = ss_store_sk \n AND s_gmt_offset = -5 \n AND d_year = 2002 \nGROUP BY s_store_name, \n s_store_id \nORDER BY s_store_name, \n s_store_id, \n sun_sales, \n mon_sales, \n tue_sales, \n wed_sales, \n thu_sales, \n fri_sales, \n sat_sales\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query43_1570971863","user_email":"nithish.sankaranarayanan@ulb.be"}
