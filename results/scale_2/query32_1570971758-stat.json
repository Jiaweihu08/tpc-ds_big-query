{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"40447","creationTime":"1570971759399","totalBytesProcessed":"347477004","startTime":"1570971759576","query":{"totalSlotMs":"40447","queryPlan":[{"readMsMax":"8","computeMsMax":"18","waitMsAvg":"1","id":"0","endMs":"1570971759831","waitMsMax":"1","startMs":"1570971759730","waitRatioMax":0.0008340283569641367,"readRatioAvg":0.006672226855713094,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.015012510425354461,"writeMsAvg":"35","status":"COMPLETE","writeMsMax":"35","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.029190992493744787,"readMsAvg":"8","waitRatioAvg":0.0008340283569641367,"completedParallelInputs":"1","computeRatioMax":0.015012510425354461,"name":"S00: Input","shuffleOutputBytes":"828","recordsWritten":"92","readRatioMax":0.006672226855713094,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $11:d_date","FROM date_dim","WHERE between(CAST($11 AS DATE), 11385, 11476)"]},{"kind":"WRITE","substeps":["$10","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.029190992493744787},{"readMsMax":"13","computeMsMax":"22","waitMsAvg":"19","id":"2","endMs":"1570971759911","waitMsMax":"19","startMs":"1570971759813","waitRatioMax":0.0158465387823186,"readRatioAvg":0.010842368640533779,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.01834862385321101,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"22","shuffleOutputBytesSpilled":"0","writeRatioMax":0.016680567139282735,"readMsAvg":"13","waitRatioAvg":0.0158465387823186,"completedParallelInputs":"1","computeRatioMax":0.01834862385321101,"name":"S02: Input","shuffleOutputBytes":"828","recordsWritten":"92","readRatioMax":0.010842368640533779,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_date","FROM date_dim","WHERE between(CAST($31 AS DATE), 11385, 11476)"]},{"kind":"WRITE","substeps":["$30","TO __stage02_output","BY HASH($30)"]}],"writeRatioAvg":0.016680567139282735},{"readMsMax":"9","computeMsMax":"7","waitMsAvg":"9","id":"3","endMs":"1570971759915","waitMsMax":"9","startMs":"1570971759821","waitRatioMax":0.007506255212677231,"readRatioAvg":0.007506255212677231,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.005838198498748957,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"28","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02335279399499583,"readMsAvg":"9","waitRatioAvg":0.007506255212677231,"completedParallelInputs":"1","computeRatioMax":0.005838198498748957,"name":"S03: Input","shuffleOutputBytes":"819","recordsWritten":"91","readRatioMax":0.007506255212677231,"steps":[{"kind":"READ","substeps":["$40:i_item_sk, $41:i_manufact_id","FROM item","WHERE equal($41, 610)"]},{"kind":"WRITE","substeps":["$40","TO __stage03_output","BY HASH($40)"]}],"writeRatioAvg":0.02335279399499583},{"readMsMax":"38","computeMsMax":"774","inputStages":["0"],"waitMsAvg":"1","id":"5","endMs":"1570971761491","waitMsMax":"2","startMs":"1570971759906","waitRatioMax":0.0016680567139282735,"readRatioAvg":0.02585487906588824,"parallelInputs":"8","recordsRead":"14398059","computeRatioAvg":0.5379482902418682,"writeMsAvg":"1067","status":"COMPLETE","writeMsMax":"1199","computeMsAvg":"645","shuffleOutputBytesSpilled":"0","writeRatioMax":1,"readMsAvg":"31","waitRatioAvg":0.0008340283569641367,"completedParallelInputs":"8","computeRatioMax":0.6455379482902419,"name":"S05: Join","shuffleOutputBytes":"7511246","recordsWritten":"417767","readRatioMax":0.0316930775646372,"steps":[{"kind":"READ","substeps":["$1:cs_sold_date_sk, $2:cs_item_sk, $3:cs_ext_discount_amt","FROM catalog_sales"]},{"kind":"READ","substeps":["$10","FROM __stage00_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $10"]},{"kind":"WRITE","substeps":["$120, $121","TO __stage05_output","BY HASH($120)"]}],"writeRatioAvg":0.8899082568807339},{"readMsMax":"0","computeMsMax":"11","inputStages":["5"],"waitMsAvg":"1","id":"6","endMs":"1570971761783","waitMsMax":"3","startMs":"1570971761494","waitRatioMax":0.0025020850708924102,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"417767","computeRatioAvg":0.006672226855713094,"writeMsAvg":"42","status":"COMPLETE","writeMsMax":"101","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08423686405337781,"readMsAvg":"0","waitRatioAvg":0.0008340283569641367,"completedParallelInputs":"100","computeRatioMax":0.009174311926605505,"name":"S06: Coalesce","shuffleOutputBytes":"7511246","recordsWritten":"417767","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage05_output"]}],"writeRatioAvg":0.03502919099249374},{"readMsMax":"44","computeMsMax":"997","inputStages":["6","2","3"],"waitMsAvg":"4","id":"7","endMs":"1570971762265","waitMsMax":"5","startMs":"1570971761523","waitRatioMax":0.004170141784820684,"readRatioAvg":0.025020850708924104,"parallelInputs":"8","recordsRead":"17740923","computeRatioAvg":0.6972477064220184,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"836","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004170141784820684,"readMsAvg":"30","waitRatioAvg":0.003336113427856547,"completedParallelInputs":"8","computeRatioMax":0.8315262718932444,"name":"S07: Join+","shuffleOutputBytes":"21580","recordsWritten":"380","readRatioMax":0.03669724770642202,"steps":[{"kind":"READ","substeps":["$20:cs_sold_date_sk, $21:cs_item_sk, $22:cs_ext_discount_amt","FROM catalog_sales"]},{"kind":"READ","substeps":["$40","FROM __stage03_output"]},{"kind":"READ","substeps":["$30","FROM __stage02_output"]},{"kind":"READ","substeps":["$120, $121","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $140 := $131","$80 := SHARD_AVG($132)","$81 := ANY_VALUE($130)"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $111 = $120"]},{"kind":"COMPUTE","substeps":["$90 := UNIQUE_ROW_ID()"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $100 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $21 = $40"]},{"kind":"WRITE","substeps":["$80, $81, $140","TO __stage07_output","BY HASH($140)"]}],"writeRatioAvg":0.003336113427856547},{"readMsMax":"0","computeMsMax":"4","inputStages":["7"],"waitMsAvg":"1","id":"8","endMs":"1570971762373","waitMsMax":"1","startMs":"1570971762361","waitRatioMax":0.0008340283569641367,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"380","computeRatioAvg":0.003336113427856547,"writeMsAvg":"2","status":"COMPLETE","writeMsMax":"2","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0016680567139282735,"readMsAvg":"0","waitRatioAvg":0.0008340283569641367,"completedParallelInputs":"1","computeRatioMax":0.003336113427856547,"name":"S08: Aggregate+","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$80, $81, $140","FROM __stage07_output"]},{"kind":"AGGREGATE","substeps":["$60 := SUM($71)"]},{"kind":"FILTER","substeps":["greater($71, multiply(1.3, $70))"]},{"kind":"AGGREGATE","substeps":["GROUP BY $150 := $140","$70 := ROOT_AVG($80)","$71 := ANY_VALUE($81)"]},{"kind":"WRITE","substeps":["$60","TO __stage08_output"]}],"writeRatioAvg":0.0016680567139282735},{"readMsMax":"0","computeMsMax":"5","inputStages":["8"],"waitMsAvg":"1","id":"9","endMs":"1570971762546","waitMsMax":"1","startMs":"1570971762376","waitRatioMax":0.0008340283569641367,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.004170141784820684,"writeMsAvg":"158","status":"COMPLETE","writeMsMax":"158","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.1317764804003336,"readMsAvg":"0","waitRatioAvg":0.0008340283569641367,"completedParallelInputs":"1","computeRatioMax":0.004170141784820684,"name":"S09: Output","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$60","FROM __stage08_output"]},{"kind":"LIMIT","substeps":["100"]},{"kind":"AGGREGATE","substeps":["$50 := SUM($60)"]},{"kind":"WRITE","substeps":["$50","TO __stage09_output"]}],"writeRatioAvg":0.1317764804003336}],"estimatedBytesProcessed":"347477004","timeline":[{"totalSlotMs":"2370","activeUnits":"8","completedUnits":"3","elapsedMs":"655","pendingUnits":"8"},{"totalSlotMs":"36575","activeUnits":"91","completedUnits":"111","elapsedMs":"2524","pendingUnits":"8"},{"totalSlotMs":"40447","activeUnits":"8","completedUnits":"121","elapsedMs":"3208","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"348127232","totalPartitionsProcessed":"0","totalBytesProcessed":"347477004","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_10"}]},"endTime":"1570971762850"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query32_1570971758"},"etag":"N4WoFas5FpRHLyUwZiAr/w==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query32_1570971758?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon994cf005192594429b9fbc88fddefff90c89f96c","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query32\nSELECT \n Sum(cs_ext_discount_amt) AS excess_discount_amount\nFROM catalog_sales , \n item , \n date_dim \nWHERE i_manufact_id = 610 \nAND i_item_sk = cs_item_sk \nAND Cast(d_date AS DATE) BETWEEN Cast('2001-03-04' AS DATE) AND ( \n Cast('2001-06-03' AS DATE)) \nAND d_date_sk = cs_sold_date_sk \nAND cs_ext_discount_amt > \n ( \n SELECT 1.3 benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results warmup avg(cs_ext_discount_amt) \n FROM catalog_sales , \n date_dim \n WHERE cs_item_sk = i_item_sk \n AND Cast(d_date AS DATE) BETWEEN Cast('2001-03-04' AS DATE) AND ( \n Cast('2001-06-03' AS DATE)) \n AND d_date_sk = cs_sold_date_sk ) \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query32_1570971758","user_email":"nithish.sankaranarayanan@ulb.be"}
