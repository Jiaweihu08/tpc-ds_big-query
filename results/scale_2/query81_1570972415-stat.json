{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"36814","creationTime":"1570972416912","totalBytesProcessed":"100910349","startTime":"1570972417023","query":{"totalSlotMs":"36814","queryPlan":[{"readMsMax":"18","computeMsMax":"7","waitMsAvg":"23","id":"1","endMs":"1570972417403","waitMsMax":"23","startMs":"1570972417206","waitRatioMax":0.016016713091922007,"readRatioAvg":0.012534818941504178,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004874651810584958,"writeMsAvg":"168","status":"COMPLETE","writeMsMax":"168","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.116991643454039,"readMsAvg":"18","waitRatioAvg":0.016016713091922007,"completedParallelInputs":"1","computeRatioMax":0.004874651810584958,"name":"S01: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.012534818941504178,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_year","FROM date_dim","WHERE equal($81, 1999)"]},{"kind":"WRITE","substeps":["$80","TO __stage01_output","BY HASH($80)"]}],"writeRatioAvg":0.116991643454039},{"readMsMax":"12","computeMsMax":"124","waitMsAvg":"71","id":"3","endMs":"1570972418035","waitMsMax":"71","startMs":"1570972417293","waitRatioMax":0.04944289693593315,"readRatioAvg":0.008356545961002786,"parallelInputs":"1","recordsRead":"250000","computeRatioAvg":0.08635097493036212,"writeMsAvg":"62","status":"COMPLETE","writeMsMax":"62","computeMsAvg":"124","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04317548746518106,"readMsAvg":"12","waitRatioAvg":0.04944289693593315,"completedParallelInputs":"1","computeRatioMax":0.08635097493036212,"name":"S03: Input","shuffleOutputBytes":"3955444","recordsWritten":"250000","readRatioMax":0.008356545961002786,"steps":[{"kind":"READ","substeps":["$30:ca_address_sk, $31:ca_state","FROM customer_address"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage03_output","BY HASH($30)"]}],"writeRatioAvg":0.04317548746518106},{"readMsMax":"50","computeMsMax":"7","waitMsAvg":"22","id":"4","endMs":"1570972417411","waitMsMax":"22","startMs":"1570972417342","waitRatioMax":0.01532033426183844,"readRatioAvg":0.034818941504178275,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004874651810584958,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002785515320334262,"readMsAvg":"50","waitRatioAvg":0.01532033426183844,"completedParallelInputs":"1","computeRatioMax":0.004874651810584958,"name":"S04: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.034818941504178275,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year","FROM date_dim","WHERE equal($51, 1999)"]},{"kind":"WRITE","substeps":["$50","TO __stage04_output","BY HASH($50)"]}],"writeRatioAvg":0.002785515320334262},{"readMsMax":"25","computeMsMax":"839","inputStages":["1"],"waitMsAvg":"1","id":"6","endMs":"1570972418014","waitMsMax":"1","startMs":"1570972417503","waitRatioMax":0.0006963788300835655,"readRatioAvg":0.017409470752089137,"parallelInputs":"1","recordsRead":"1440167","computeRatioAvg":0.5842618384401114,"writeMsAvg":"31","status":"COMPLETE","writeMsMax":"31","computeMsAvg":"839","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02158774373259053,"readMsAvg":"25","waitRatioAvg":0.0006963788300835655,"completedParallelInputs":"1","computeRatioMax":0.5842618384401114,"name":"S06: Join","shuffleOutputBytes":"7516975","recordsWritten":"280133","readRatioMax":0.017409470752089137,"steps":[{"kind":"READ","substeps":["$70:cr_returned_date_sk, $71:cr_returning_customer_sk, $72:cr_returning_addr_sk, $73:cr_return_amt_inc_tax","FROM catalog_returns"]},{"kind":"READ","substeps":["$80","FROM __stage01_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $70 = $80"]},{"kind":"WRITE","substeps":["$210, $211, $212","TO __stage06_output","BY HASH($211)"]}],"writeRatioAvg":0.02158774373259053},{"readMsMax":"0","computeMsMax":"11","inputStages":["6"],"waitMsAvg":"2","id":"8","endMs":"1570972418194","waitMsMax":"4","startMs":"1570972418075","waitRatioMax":0.002785515320334262,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"280133","computeRatioAvg":0.004874651810584958,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"56","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03899721448467967,"readMsAvg":"0","waitRatioAvg":0.001392757660167131,"completedParallelInputs":"100","computeRatioMax":0.00766016713091922,"name":"S08: Coalesce","shuffleOutputBytes":"7516975","recordsWritten":"280133","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage06_output"]}],"writeRatioAvg":0.01532033426183844},{"readMsMax":"11","computeMsMax":"1167","inputStages":["8"],"waitMsAvg":"1","id":"9","endMs":"1570972418769","waitMsMax":"1","startMs":"1570972418100","waitRatioMax":0.0006963788300835655,"readRatioAvg":0.00766016713091922,"parallelInputs":"1","recordsRead":"530133","computeRatioAvg":0.8126740947075209,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"1167","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01532033426183844,"readMsAvg":"11","waitRatioAvg":0.0006963788300835655,"completedParallelInputs":"1","computeRatioMax":0.8126740947075209,"name":"S09: Join+","shuffleOutputBytes":"6791911","recordsWritten":"274125","readRatioMax":0.00766016713091922,"steps":[{"kind":"READ","substeps":["$60:ca_address_sk, $61:ca_state","FROM customer_address"]},{"kind":"READ","substeps":["$210, $211, $212","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $220, $231 := $222","$140 := SUM($221)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $60 = $211"]},{"kind":"WRITE","substeps":["$231, $230, $140","TO __stage09_output","BY HASH($230, $231)"]}],"writeRatioAvg":0.01532033426183844},{"readMsMax":"39","computeMsMax":"1436","inputStages":["3","4"],"waitMsAvg":"1","id":"10","endMs":"1570972419166","waitMsMax":"1","startMs":"1570972418204","waitRatioMax":0.0006963788300835655,"readRatioAvg":0.027158774373259052,"parallelInputs":"1","recordsRead":"1690167","computeRatioAvg":1,"writeMsAvg":"38","status":"COMPLETE","writeMsMax":"38","computeMsAvg":"1436","shuffleOutputBytesSpilled":"0","writeRatioMax":0.026462395543175487,"readMsAvg":"39","waitRatioAvg":0.0006963788300835655,"completedParallelInputs":"1","computeRatioMax":1,"name":"S0A: Join+","shuffleOutputBytes":"6791911","recordsWritten":"274125","readRatioMax":0.027158774373259052,"steps":[{"kind":"READ","substeps":["$40:cr_returned_date_sk, $41:cr_returning_customer_sk, $42:cr_returning_addr_sk, $43:cr_return_amt_inc_tax","FROM catalog_returns"]},{"kind":"READ","substeps":["$50","FROM __stage04_output"]},{"kind":"READ","substeps":["$30, $31","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $170 := $160, $171 := $162","$120 := SUM($161)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $151 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $50"]},{"kind":"WRITE","substeps":["$171, $170, $120","TO __stage0A_output","BY HASH($170, $171)"]}],"writeRatioAvg":0.026462395543175487},{"readMsMax":"0","computeMsMax":"404","inputStages":["9"],"waitMsAvg":"1","id":"11","endMs":"1570972419253","waitMsMax":"1","startMs":"1570972419009","waitRatioMax":0.0006963788300835655,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"274125","computeRatioAvg":0.28133704735376047,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"404","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004178272980501393,"readMsAvg":"0","waitRatioAvg":0.0006963788300835655,"completedParallelInputs":"1","computeRatioMax":0.28133704735376047,"name":"S0B: Aggregate","shuffleOutputBytes":"1242","recordsWritten":"52","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$231, $230, $140","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $250 := $241","$110 := SHARD_AVG($130)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230, $241 := $231","$130 := SUM($140)"]},{"kind":"WRITE","substeps":["$250, $110","TO __stage0B_output","BY HASH($250)"]}],"writeRatioAvg":0.004178272980501393},{"readMsMax":"73","computeMsMax":"61","waitMsAvg":"2","id":"12","endMs":"1570972419505","waitMsMax":"2","startMs":"1570972419344","waitRatioMax":0.001392757660167131,"readRatioAvg":0.05083565459610028,"parallelInputs":"1","recordsRead":"250000","computeRatioAvg":0.04247910863509749,"writeMsAvg":"37","status":"COMPLETE","writeMsMax":"37","computeMsAvg":"61","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02576601671309192,"readMsAvg":"73","waitRatioAvg":0.001392757660167131,"completedParallelInputs":"1","computeRatioMax":0.04247910863509749,"name":"S0C: Input","shuffleOutputBytes":"2820932","recordsWritten":"19905","readRatioMax":0.05083565459610028,"steps":[{"kind":"READ","substeps":["$1:ca_address_sk, $2:ca_street_number, $3:ca_street_name, $4:ca_street_type, $5:ca_suite_number, $6:ca_city, $7:ca_county, $8:ca_state, $9:ca_zip, $10:ca_country, $11:ca_gmt_offset, $12:ca_location_type","FROM customer_address","WHERE equal($8, 'TX')"]},{"kind":"WRITE","substeps":["$1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12","TO __stage0C_output","BY HASH($1)"]}],"writeRatioAvg":0.02576601671309192},{"readMsMax":"0","computeMsMax":"11","inputStages":["11"],"waitMsAvg":"1","id":"13","endMs":"1570972419522","waitMsMax":"1","startMs":"1570972419359","waitRatioMax":0.0006963788300835655,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"52","computeRatioAvg":0.00766016713091922,"writeMsAvg":"147","status":"COMPLETE","writeMsMax":"147","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.10236768802228412,"readMsAvg":"0","waitRatioAvg":0.0006963788300835655,"completedParallelInputs":"1","computeRatioMax":0.00766016713091922,"name":"S0D: Aggregate","shuffleOutputBytes":"816","recordsWritten":"51","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$250, $110","FROM __stage0B_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $260 := $250","$90 := ROOT_AVG($110)"]},{"kind":"WRITE","substeps":["$90, $260","TO __stage0D_output","BY HASH($260)"]}],"writeRatioAvg":0.10236768802228412},{"readMsMax":"0","computeMsMax":"539","inputStages":["10"],"waitMsAvg":"0","id":"15","endMs":"1570972419785","waitMsMax":"0","startMs":"1570972419495","waitRatioMax":0,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"274125","computeRatioAvg":0.3753481894150418,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"539","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0201949860724234,"readMsAvg":"0","waitRatioAvg":0,"completedParallelInputs":"1","computeRatioMax":0.3753481894150418,"name":"S0F: Aggregate","shuffleOutputBytes":"6791041","recordsWritten":"274073","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$171, $170, $120","FROM __stage0A_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $170, $181 := $171","$100 := SUM($120)"]},{"kind":"WRITE","substeps":["$100, $180, $181","TO __stage0F_output","BY HASH($180)"]}],"writeRatioAvg":0.0201949860724234},{"readMsMax":"0","computeMsMax":"11","inputStages":["15"],"waitMsAvg":"1","id":"16","endMs":"1570972419987","waitMsMax":"4","startMs":"1570972419847","waitRatioMax":0.002785515320334262,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"274073","computeRatioAvg":0.004874651810584958,"writeMsAvg":"45","status":"COMPLETE","writeMsMax":"83","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.057799442896935935,"readMsAvg":"0","waitRatioAvg":0.0006963788300835655,"completedParallelInputs":"100","computeRatioMax":0.00766016713091922,"name":"S10: Coalesce","shuffleOutputBytes":"6791041","recordsWritten":"274073","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0F_output"]}],"writeRatioAvg":0.031337047353760444},{"readMsMax":"0","computeMsMax":"7","inputStages":["13"],"waitMsAvg":"3","id":"17","endMs":"1570972419952","waitMsMax":"5","startMs":"1570972419847","waitRatioMax":0.003481894150417827,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"51","computeRatioAvg":0.002785515320334262,"writeMsAvg":"43","status":"COMPLETE","writeMsMax":"62","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04317548746518106,"readMsAvg":"0","waitRatioAvg":0.0020891364902506965,"completedParallelInputs":"100","computeRatioMax":0.004874651810584958,"name":"S11: Coalesce","shuffleOutputBytes":"816","recordsWritten":"51","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0D_output"]}],"writeRatioAvg":0.029944289693593314},{"readMsMax":"42","computeMsMax":"1009","inputStages":["12","17","16"],"waitMsAvg":"5","id":"18","endMs":"1570972420502","waitMsMax":"5","startMs":"1570972419853","waitRatioMax":0.003481894150417827,"readRatioAvg":0.02924791086350975,"parallelInputs":"1","recordsRead":"794029","computeRatioAvg":0.7026462395543176,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"3","computeMsAvg":"1009","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0020891364902506965,"readMsAvg":"42","waitRatioAvg":0.003481894150417827,"completedParallelInputs":"1","computeRatioMax":0.7026462395543176,"name":"S12: Join+","shuffleOutputBytes":"19048","recordsWritten":"100","readRatioMax":0.02924791086350975,"steps":[{"kind":"READ","substeps":["$20:c_customer_sk, $21:c_customer_id, $22:c_current_addr_sk, $23:c_salutation, $24:c_first_name, $25:c_last_name","FROM customer"]},{"kind":"READ","substeps":["$100, $180, $181","FROM __stage10_output"]},{"kind":"READ","substeps":["$90, $260","FROM __stage11_output"]},{"kind":"READ","substeps":["$1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12","FROM __stage0C_output"]},{"kind":"SORT","substeps":["$290 ASC, $291 ASC, $292 ASC, $293 ASC, $295 ASC, $296 ASC, $297 ASC, $298 ASC, $299 ASC, $300 ASC, $301 ASC, $302 ASC, $303 ASC, $304 ASC, $305 ASC, $294 ASC","LIMIT 100"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $271 = $1"]},{"kind":"FILTER","substeps":["greater($275, multiply($276, 1.2))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $190 = $260"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $180"]},{"kind":"WRITE","substeps":["$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $322, $323, $324, $325","TO __stage12_output"]}],"writeRatioAvg":0.0020891364902506965},{"readMsMax":"0","computeMsMax":"4","inputStages":["18"],"waitMsAvg":"0","id":"19","endMs":"1570972420607","waitMsMax":"0","startMs":"1570972419926","waitRatioMax":0,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.002785515320334262,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004178272980501393,"readMsAvg":"0","waitRatioAvg":0,"completedParallelInputs":"1","computeRatioMax":0.002785515320334262,"name":"S13: Output","shuffleOutputBytes":"19048","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $322, $323, $324, $325","FROM __stage12_output"]},{"kind":"SORT","substeps":["$321 ASC, $322 ASC, $323 ASC, $324 ASC, $310 ASC, $311 ASC, $312 ASC, $313 ASC, $314 ASC, $315 ASC, $316 ASC, $317 ASC, $318 ASC, $319 ASC, $320 ASC, $325 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$330, $331, $332, $333, $334, $335, $336, $337, $338, $339, $340, $341, $342, $343, $344, $345","TO __stage13_output"]}],"writeRatioAvg":0.004178272980501393}],"estimatedBytesProcessed":"100910349","timeline":[{"totalSlotMs":"967","activeUnits":"4","completedUnits":"2","elapsedMs":"642","pendingUnits":"4"},{"totalSlotMs":"15317","activeUnits":"2","completedUnits":"107","elapsedMs":"2247","pendingUnits":"0"},{"totalSlotMs":"35547","activeUnits":"2","completedUnits":"310","elapsedMs":"3326","pendingUnits":"2"},{"totalSlotMs":"36814","activeUnits":"2","completedUnits":"312","elapsedMs":"3855","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"101711872","totalPartitionsProcessed":"0","totalBytesProcessed":"100910349","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_10"}]},"endTime":"1570972420902"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query81_1570972415"},"etag":"WEfPfgxq7b+xdEojAravNA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query81_1570972415?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonf43da4791abd4f40addd81e7678bda480179be52","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"\n-- query81\nWITH customer_total_return \n AS (SELECT cr_returning_customer_sk AS ctr_customer_sk, \n ca_state AS ctr_state, \n Sum(cr_return_amt_inc_tax) AS ctr_total_return \n FROM catalog_returns, \n date_dim, \n customer_address \n WHERE cr_returned_date_sk = d_date_sk \n AND d_year = 1999 \n AND cr_returning_addr_sk = ca_address_sk \n GROUP BY cr_returning_customer_sk, \n ca_state),\nhigh_return AS (\n SELECT ctr_state AS hr_state, Avg(ctr_total_return) benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results warmup 1.2 AS hr_limit\n FROM customer_total_return \n GROUP BY ctr_state\n)\nSELECT c_customer_id, \n c_salutation, \n c_first_name, \n c_last_name, \n ca_street_number, \n ca_street_name, \n ca_street_type, \n ca_suite_number, \n ca_city, \n ca_county, \n ca_state, \n ca_zip, \n ca_country, \n ca_gmt_offset, \n ca_location_type, \n ctr_total_return \nFROM customer_total_return, \n high_return,\n customer_address, \n customer\nWHERE ctr_state = hr_state \n AND ctr_customer_sk = c_customer_sk \n AND ca_address_sk = c_current_addr_sk \n AND ca_state = 'TX' \n AND ctr_total_return > hr_limit\nORDER BY c_customer_id, \n c_salutation, \n c_first_name, \n c_last_name, \n ca_street_number, \n ca_street_name, \n ca_street_type, \n ca_suite_number, \n ca_city, \n ca_county, \n ca_state, \n ca_zip, \n ca_country, \n ca_gmt_offset, \n ca_location_type, \n ctr_total_return\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query81_1570972415","user_email":"nithish.sankaranarayanan@ulb.be"}
