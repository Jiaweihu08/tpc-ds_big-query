{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"18788","creationTime":"1570972527970","totalBytesProcessed":"110278383","startTime":"1570972528169","query":{"totalSlotMs":"18788","queryPlan":[{"readMsMax":"8","computeMsMax":"9","waitMsAvg":"1","id":"0","endMs":"1570972528601","waitMsMax":"1","startMs":"1570972528400","waitRatioMax":0.0007739938080495357,"readRatioAvg":0.006191950464396285,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.00696594427244582,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.014705882352941176,"readMsAvg":"8","waitRatioAvg":0.0007739938080495357,"completedParallelInputs":"1","computeRatioMax":0.00696594427244582,"name":"S00: Input","shuffleOutputBytes":"10800","recordsWritten":"1200","readRatioMax":0.006191950464396285,"steps":[{"kind":"READ","substeps":["$1:hd_demo_sk, $2:hd_buy_potential","FROM household_demographics","WHERE like($2, 'Unknown%')"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.014705882352941176},{"readMsMax":"27","computeMsMax":"437","waitMsAvg":"21","id":"1","endMs":"1570972528734","waitMsMax":"21","startMs":"1570972528442","waitRatioMax":0.016253869969040248,"readRatioAvg":0.02089783281733746,"parallelInputs":"1","recordsRead":"1920800","computeRatioAvg":0.3382352941176471,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"437","shuffleOutputBytesSpilled":"0","writeRatioMax":0.015479876160990712,"readMsAvg":"27","waitRatioAvg":0.016253869969040248,"completedParallelInputs":"1","computeRatioMax":0.3382352941176471,"name":"S01: Input","shuffleOutputBytes":"3402560","recordsWritten":"109760","readRatioMax":0.02089783281733746,"steps":[{"kind":"READ","substeps":["$10:cd_demo_sk, $11:cd_marital_status, $12:cd_education_status","FROM customer_demographics","WHERE or(and(equal($11, 'M'), equal($12, 'Unknown')), and(equal($11, 'W'), equal($12, 'Advanced Degree')))"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.015479876160990712},{"readMsMax":"12","computeMsMax":"28","waitMsAvg":"42","id":"2","endMs":"1570972528734","waitMsMax":"42","startMs":"1570972528485","waitRatioMax":0.032507739938080496,"readRatioAvg":0.009287925696594427,"parallelInputs":"1","recordsRead":"250000","computeRatioAvg":0.021671826625386997,"writeMsAvg":"64","status":"COMPLETE","writeMsMax":"64","computeMsAvg":"28","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04953560371517028,"readMsAvg":"12","waitRatioAvg":0.032507739938080496,"completedParallelInputs":"1","computeRatioMax":0.021671826625386997,"name":"S02: Input","shuffleOutputBytes":"244611","recordsWritten":"27179","readRatioMax":0.009287925696594427,"steps":[{"kind":"READ","substeps":["$30:ca_address_sk, $31:ca_gmt_offset","FROM customer_address","WHERE equal($31, -7)"]},{"kind":"WRITE","substeps":["$30","TO __stage02_output","BY HASH($30)"]}],"writeRatioAvg":0.04953560371517028},{"readMsMax":"41","computeMsMax":"688","waitMsAvg":"1","id":"3","endMs":"1570972529597","waitMsMax":"1","startMs":"1570972528531","waitRatioMax":0.0007739938080495357,"readRatioAvg":0.03173374613003096,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.5325077399380805,"writeMsAvg":"156","status":"COMPLETE","writeMsMax":"156","computeMsAvg":"688","shuffleOutputBytesSpilled":"0","writeRatioMax":0.12074303405572756,"readMsAvg":"41","waitRatioAvg":0.0007739938080495357,"completedParallelInputs":"1","computeRatioMax":0.5325077399380805,"name":"S03: Input","shuffleOutputBytes":"17720704","recordsWritten":"500000","readRatioMax":0.03173374613003096,"steps":[{"kind":"READ","substeps":["$20:c_customer_sk, $21:c_current_cdemo_sk, $22:c_current_hdemo_sk, $23:c_current_addr_sk","FROM customer"]},{"kind":"WRITE","substeps":["$20, $21, $22, $23","TO __stage03_output","BY HASH($20)"]}],"writeRatioAvg":0.12074303405572756},{"readMsMax":"16","computeMsMax":"8","waitMsAvg":"14","id":"4","endMs":"1570972528783","waitMsMax":"14","startMs":"1570972528572","waitRatioMax":0.010835913312693499,"readRatioAvg":0.01238390092879257,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.006191950464396285,"writeMsAvg":"183","status":"COMPLETE","writeMsMax":"183","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.141640866873065,"readMsAvg":"16","waitRatioAvg":0.010835913312693499,"completedParallelInputs":"1","computeRatioMax":0.006191950464396285,"name":"S04: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.01238390092879257,"steps":[{"kind":"READ","substeps":["$60:d_date_sk, $61:d_year, $62:d_moy","FROM date_dim","WHERE and(equal($61, 1999), equal($62, 12))"]},{"kind":"WRITE","substeps":["$60","TO __stage04_output","BY HASH($60)"]}],"writeRatioAvg":0.141640866873065},{"readMsMax":"31","computeMsMax":"6","waitMsAvg":"1","id":"6","endMs":"1570972528793","waitMsMax":"1","startMs":"1570972528690","waitRatioMax":0.0007739938080495357,"readRatioAvg":0.023993808049535603,"parallelInputs":"1","recordsRead":"24","computeRatioAvg":0.0046439628482972135,"writeMsAvg":"31","status":"COMPLETE","writeMsMax":"31","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.023993808049535603,"readMsAvg":"31","waitRatioAvg":0.0007739938080495357,"completedParallelInputs":"1","computeRatioMax":0.0046439628482972135,"name":"S06: Input","shuffleOutputBytes":"1591","recordsWritten":"24","readRatioMax":0.023993808049535603,"steps":[{"kind":"READ","substeps":["$40:cc_call_center_sk, $41:cc_call_center_id, $42:cc_name, $43:cc_manager","FROM call_center"]},{"kind":"WRITE","substeps":["$40, $41, $42, $43","TO __stage06_output","BY HASH($40)"]}],"writeRatioAvg":0.023993808049535603},{"readMsMax":"0","computeMsMax":"14","inputStages":["1"],"waitMsAvg":"1","id":"8","endMs":"1570972529832","waitMsMax":"3","startMs":"1570972529637","waitRatioMax":0.0023219814241486067,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"109760","computeRatioAvg":0.003869969040247678,"writeMsAvg":"71","status":"COMPLETE","writeMsMax":"178","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.13777089783281735,"readMsAvg":"0","waitRatioAvg":0.0007739938080495357,"completedParallelInputs":"100","computeRatioMax":0.010835913312693499,"name":"S08: Coalesce","shuffleOutputBytes":"3402560","recordsWritten":"109760","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage01_output"]}],"writeRatioAvg":0.05495356037151703},{"readMsMax":"33","computeMsMax":"1292","inputStages":["6","8","0","2","3","4"],"waitMsAvg":"1","id":"9","endMs":"1570972530473","waitMsMax":"1","startMs":"1570972529692","waitRatioMax":0.0007739938080495357,"readRatioAvg":0.025541795665634675,"parallelInputs":"1","recordsRead":"2077996","computeRatioAvg":1,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"3","computeMsAvg":"1292","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0023219814241486067,"readMsAvg":"33","waitRatioAvg":0.0007739938080495357,"completedParallelInputs":"1","computeRatioMax":1,"name":"S09: Join+","shuffleOutputBytes":"1076","recordsWritten":"12","readRatioMax":0.025541795665634675,"steps":[{"kind":"READ","substeps":["$50:cr_returned_date_sk, $51:cr_returning_customer_sk, $52:cr_call_center_sk, $53:cr_net_loss","FROM catalog_returns"]},{"kind":"READ","substeps":["$40, $41, $42, $43","FROM __stage06_output"]},{"kind":"READ","substeps":["$60","FROM __stage04_output"]},{"kind":"READ","substeps":["$20, $21, $22, $23","FROM __stage03_output"]},{"kind":"READ","substeps":["$30","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage08_output"]},{"kind":"READ","substeps":["$1","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $172, $181 := $173, $182 := $174, $183 := $170, $184 := $171","$80 := SUM($175)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $160 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $140 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $126 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $113 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $93 = $60"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $52 = $40"]},{"kind":"WRITE","substeps":["$183, $184, $180, $181, $182, $80","TO __stage09_output","BY HASH($180, $181, $182, $183, $184)"]}],"writeRatioAvg":0.0023219814241486067},{"readMsMax":"0","computeMsMax":"9","inputStages":["9"],"waitMsAvg":"1","id":"10","endMs":"1570972530686","waitMsMax":"1","startMs":"1570972530631","waitRatioMax":0.0007739938080495357,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.00696594427244582,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"26","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.020123839009287926,"readMsAvg":"0","waitRatioAvg":0.0007739938080495357,"completedParallelInputs":"1","computeRatioMax":0.00696594427244582,"name":"S0A: Aggregate","shuffleOutputBytes":"804","recordsWritten":"12","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$183, $184, $180, $181, $182, $80","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $180, $191 := $181, $192 := $182, $193 := $183, $194 := $184","$70 := SUM($80)"]},{"kind":"WRITE","substeps":["$190, $191, $192, $70","TO __stage0A_output"]}],"writeRatioAvg":0.020123839009287926},{"readMsMax":"0","computeMsMax":"8","inputStages":["10"],"waitMsAvg":"1","id":"11","endMs":"1570972530896","waitMsMax":"1","startMs":"1570972530698","waitRatioMax":0.0007739938080495357,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"12","computeRatioAvg":0.006191950464396285,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"26","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.020123839009287926,"readMsAvg":"0","waitRatioAvg":0.0007739938080495357,"completedParallelInputs":"1","computeRatioMax":0.006191950464396285,"name":"S0B: Output","shuffleOutputBytes":"804","recordsWritten":"12","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$190, $191, $192, $70","FROM __stage0A_output"]},{"kind":"SORT","substeps":["$70 DESC"]},{"kind":"WRITE","substeps":["$200, $201, $202, $203","TO __stage0B_output"]}],"writeRatioAvg":0.020123839009287926}],"estimatedBytesProcessed":"110278383","timeline":[{"totalSlotMs":"1702","activeUnits":"2","completedUnits":"5","elapsedMs":"731","pendingUnits":"2"},{"totalSlotMs":"17363","activeUnits":"1","completedUnits":"106","elapsedMs":"1930","pendingUnits":"1"},{"totalSlotMs":"18788","activeUnits":"1","completedUnits":"109","elapsedMs":"3012","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"111149056","totalPartitionsProcessed":"0","totalBytesProcessed":"110278383","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"call_center","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer_demographics","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_10"}]},"endTime":"1570972531207"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query91_1570972526"},"etag":"FxEDZ0/T8BaUvH1NCaHZiQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query91_1570972526?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anoncf8df2cbd2832c99bb4dd0883beaa74de750b17a","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query91\nSELECT cc_call_center_id Call_Center, \n cc_name Call_Center_Name, \n cc_manager Manager, \n Sum(cr_net_loss) Returns_Loss \nFROM call_center, \n catalog_returns, \n date_dim, \n customer, \n customer_address, \n customer_demographics, \n household_demographics \nWHERE cr_call_center_sk = cc_call_center_sk \n AND cr_returned_date_sk = d_date_sk \n AND cr_returning_customer_sk = c_customer_sk \n AND cd_demo_sk = c_current_cdemo_sk \n AND hd_demo_sk = c_current_hdemo_sk \n AND ca_address_sk = c_current_addr_sk \n AND d_year = 1999 \n AND d_moy = 12 \n AND ( ( cd_marital_status = 'M' \n AND cd_education_status = 'Unknown' ) \n OR ( cd_marital_status = 'W' \n AND cd_education_status = 'Advanced Degree' ) ) \n AND hd_buy_potential LIKE 'Unknown%' \n AND ca_gmt_offset = -7 \nGROUP BY cc_call_center_id, \n cc_name, \n cc_manager, \n cd_marital_status, \n cd_education_status \nORDER BY Sum(cr_net_loss) DESC; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query91_1570972526","user_email":"nithish.sankaranarayanan@ulb.be"}
