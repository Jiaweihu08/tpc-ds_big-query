{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"39063","creationTime":"1570972094051","totalBytesProcessed":"897582190","startTime":"1570972094208","query":{"totalSlotMs":"39063","queryPlan":[{"readMsMax":"46","computeMsMax":"7","waitMsAvg":"1","id":"0","endMs":"1570972094422","waitMsMax":"1","startMs":"1570972094359","waitRatioMax":0.0005373455131649651,"readRatioAvg":0.024717893605588393,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.0037614185921547557,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0032240730789897904,"readMsAvg":"46","waitRatioAvg":0.0005373455131649651,"completedParallelInputs":"1","computeRatioMax":0.0037614185921547557,"name":"S00: Input","shuffleOutputBytes":"918","recordsWritten":"102","readRatioMax":0.024717893605588393,"steps":[{"kind":"READ","substeps":["$1:s_store_sk","FROM store"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.0032240730789897904},{"readMsMax":"13","computeMsMax":"8","waitMsAvg":"28","id":"1","endMs":"1570972095729","waitMsMax":"28","startMs":"1570972094401","waitRatioMax":0.015045674368619023,"readRatioAvg":0.006985491671144546,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004298764105319721,"writeMsAvg":"1303","status":"COMPLETE","writeMsMax":"1303","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.7001612036539495,"readMsAvg":"13","waitRatioAvg":0.015045674368619023,"completedParallelInputs":"1","computeRatioMax":0.004298764105319721,"name":"S01: Input","shuffleOutputBytes":"6588","recordsWritten":"366","readRatioMax":0.006985491671144546,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $22:d_moy, $21:d_month_seq","FROM date_dim","WHERE in($21, 1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211)"]},{"kind":"WRITE","substeps":["$20, $22","TO __stage01_output","BY HASH($20)"]}],"writeRatioAvg":0.7001612036539495},{"readMsMax":"17","computeMsMax":"36","waitMsAvg":"1","id":"3","endMs":"1570972094528","waitMsMax":"1","startMs":"1570972094481","waitRatioMax":0.0005373455131649651,"readRatioAvg":0.009134873723804407,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.01934443847393874,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"36","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0026867275658248252,"readMsAvg":"17","waitRatioAvg":0.0005373455131649651,"completedParallelInputs":"1","computeRatioMax":0.01934443847393874,"name":"S03: Input","shuffleOutputBytes":"95050","recordsWritten":"5281","readRatioMax":0.009134873723804407,"steps":[{"kind":"READ","substeps":["$30:i_item_sk, $34:i_manager_id, $31:i_brand, $32:i_class, $33:i_category","FROM item","WHERE or(and(in($33, 'Books', 'Children', 'Electronics'), in($32, 'personal', 'portable', 'reference', 'self-help'), ...), ...)"]},{"kind":"WRITE","substeps":["$30, $34","TO __stage03_output","BY HASH($30)"]}],"writeRatioAvg":0.0026867275658248252},{"readMsMax":"92","computeMsMax":"1861","inputStages":["0","1","3"],"waitMsAvg":"1","id":"5","endMs":"1570972097056","waitMsMax":"6","startMs":"1570972095802","waitRatioMax":0.0032240730789897904,"readRatioAvg":0.022568511552928532,"parallelInputs":"10","recordsRead":"28859602","computeRatioAvg":0.8344975819451907,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"1553","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009134873723804407,"readMsAvg":"42","waitRatioAvg":0.0005373455131649651,"completedParallelInputs":"10","computeRatioMax":1,"name":"S05: Join+","shuffleOutputBytes":"313098","recordsWritten":"11598","readRatioMax":0.049435787211176786,"steps":[{"kind":"READ","substeps":["$10:ss_sold_date_sk, $11:ss_item_sk, $12:ss_store_sk, $13:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$30, $34","FROM __stage03_output"]},{"kind":"READ","substeps":["$20, $22","FROM __stage01_output"]},{"kind":"READ","substeps":["$1","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $110 := $102, $111 := $101","$60 := SUM($100)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $90 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $81 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $11 = $30"]},{"kind":"WRITE","substeps":["$111, $110, $60","TO __stage05_output","BY HASH($110, $111)"]}],"writeRatioAvg":0.0037614185921547557},{"readMsMax":"0","computeMsMax":"10","inputStages":["5"],"waitMsAvg":"1","id":"6","endMs":"1570972097138","waitMsMax":"1","startMs":"1570972097089","waitRatioMax":0.0005373455131649651,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"11598","computeRatioAvg":0.0053734551316496505,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012358946802794197,"readMsAvg":"0","waitRatioAvg":0.0005373455131649651,"completedParallelInputs":"1","computeRatioMax":0.0053734551316496505,"name":"S06: Aggregate","shuffleOutputBytes":"21402","recordsWritten":"1189","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$111, $110, $60","FROM __stage05_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $120 := $110, $121 := $111","$50 := SUM($60)"]},{"kind":"WRITE","substeps":["$120, $50","TO __stage06_output","BY HASH($120)"]}],"writeRatioAvg":0.012358946802794197},{"readMsMax":"0","computeMsMax":"12","inputStages":["6"],"waitMsAvg":"1","id":"7","endMs":"1570972097306","waitMsMax":"1","startMs":"1570972097144","waitRatioMax":0.0005373455131649651,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1189","computeRatioAvg":0.006448146157979581,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"12","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006448146157979581,"readMsAvg":"0","waitRatioAvg":0.0005373455131649651,"completedParallelInputs":"1","computeRatioMax":0.006448146157979581,"name":"S07: Sort+","shuffleOutputBytes":"2700","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$120, $50","FROM __stage06_output"]},{"kind":"SORT","substeps":["$140 ASC, $40 ASC, $141 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["greater(case_no_value(greater($40, 0), divide(abs(subtract($141, $40)), $40), NULL), 0.1)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$40 := AVG($131) OVER (PARTITION BY $130 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)"]},{"kind":"SORT","substeps":["$120 ASC"]},{"kind":"WRITE","substeps":["$150, $151, $152","TO __stage07_output"]}],"writeRatioAvg":0.006448146157979581},{"readMsMax":"0","computeMsMax":"5","inputStages":["7"],"waitMsAvg":"1","id":"8","endMs":"1570972097358","waitMsMax":"1","startMs":"1570972097172","waitRatioMax":0.0005373455131649651,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0026867275658248252,"writeMsAvg":"45","status":"COMPLETE","writeMsMax":"45","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02418054809242343,"readMsAvg":"0","waitRatioAvg":0.0005373455131649651,"completedParallelInputs":"1","computeRatioMax":0.0026867275658248252,"name":"S08: Output","shuffleOutputBytes":"2700","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$150, $151, $152","FROM __stage07_output"]},{"kind":"SORT","substeps":["$150 ASC, $151 ASC, $152 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$160, $161, $162","TO __stage08_output"]}],"writeRatioAvg":0.02418054809242343}],"estimatedBytesProcessed":"897582190","timeline":[{"totalSlotMs":"2640","activeUnits":"11","completedUnits":"2","elapsedMs":"653","pendingUnits":"11"},{"totalSlotMs":"19782","activeUnits":"10","completedUnits":"3","elapsedMs":"1627","pendingUnits":"10"},{"totalSlotMs":"39063","activeUnits":"4","completedUnits":"16","elapsedMs":"3326","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"898629632","totalPartitionsProcessed":"0","totalBytesProcessed":"897582190","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570972097562"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query63_1570972092"},"etag":"rA23yfihwD9bI8X+N5YHeg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query63_1570972092?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon4bd57dd22213dd7da7b91da0cf1320ee5cdc91fd","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query63\nSELECT benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results warmup \nFROM (SELECT i_manager_id, \n Sum(ss_sales_price) sum_sales, \n Avg(Sum(ss_sales_price)) \n OVER ( \n partition BY i_manager_id) avg_monthly_sales \n FROM item, \n store_sales, \n date_dim, \n store \n WHERE ss_item_sk = i_item_sk \n AND ss_sold_date_sk = d_date_sk \n AND ss_store_sk = s_store_sk \n AND d_month_seq IN ( 1200, 1200 + 1, 1200 + 2, 1200 + 3, \n 1200 + 4, 1200 + 5, 1200 + 6, 1200 + 7, \n 1200 + 8, 1200 + 9, 1200 + 10, 1200 + 11 ) \n AND ( ( i_category IN ( 'Books', 'Children', 'Electronics' ) \n AND i_class IN ( 'personal', 'portable', 'reference', \n 'self-help' ) \n AND i_brand IN ( 'scholaramalgamalg #14', \n 'scholaramalgamalg #7' \n , \n 'exportiunivamalg #9', \n 'scholaramalgamalg #9' ) \n ) \n OR ( i_category IN ( 'Women', 'Music', 'Men' ) \n AND i_class IN ( 'accessories', 'classical', \n 'fragrances', \n 'pants' ) \n AND i_brand IN ( 'amalgimporto #1', \n 'edu packscholar #1', \n 'exportiimporto #1', \n 'importoamalg #1' ) ) ) \n GROUP BY i_manager_id, \n d_moy) tmp1 \nWHERE CASE \n WHEN avg_monthly_sales > 0 THEN Abs (sum_sales - avg_monthly_sales) / \n avg_monthly_sales \n ELSE NULL \n END > 0.1 \nORDER BY i_manager_id, \n avg_monthly_sales, \n sum_sales\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query63_1570972092","user_email":"nithish.sankaranarayanan@ulb.be"}
