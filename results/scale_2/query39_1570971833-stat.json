{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"232083","creationTime":"1570971834339","totalBytesProcessed":"4208834171","startTime":"1570971834470","query":{"totalSlotMs":"232083","queryPlan":[{"readMsMax":"9","computeMsMax":"6","waitMsAvg":"1","id":"0","endMs":"1570971834732","waitMsMax":"1","startMs":"1570971834637","waitRatioMax":0.00011892020454275182,"readRatioAvg":0.0010702818408847663,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0007135212272565109,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0008324414317992627,"readMsAvg":"9","waitRatioAvg":0.00011892020454275182,"completedParallelInputs":"1","computeRatioMax":0.0007135212272565109,"name":"S00: Input","shuffleOutputBytes":"504","recordsWritten":"28","readRatioMax":0.0010702818408847663,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $32:d_moy, $31:d_year","FROM date_dim","WHERE and(equal($31, 2002), equal($32, 2))"]},{"kind":"WRITE","substeps":["$30, $32","TO __stage00_output","BY HASH($30)"]}],"writeRatioAvg":0.0008324414317992627},{"readMsMax":"28","computeMsMax":"7","waitMsAvg":"31","id":"1","endMs":"1570971834765","waitMsMax":"31","startMs":"1570971834678","waitRatioMax":0.003686526340825306,"readRatioAvg":0.003329765727197051,"parallelInputs":"1","recordsRead":"10","computeRatioAvg":0.0008324414317992627,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0008324414317992627,"readMsAvg":"28","waitRatioAvg":0.003686526340825306,"completedParallelInputs":"1","computeRatioMax":0.0008324414317992627,"name":"S01: Input","shuffleOutputBytes":"299","recordsWritten":"10","readRatioMax":0.003329765727197051,"steps":[{"kind":"READ","substeps":["$20:w_warehouse_sk, $21:w_warehouse_name","FROM warehouse"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage01_output","BY HASH($20)"]}],"writeRatioAvg":0.0008324414317992627},{"readMsMax":"11","computeMsMax":"49","waitMsAvg":"61","id":"2","endMs":"1570971834898","waitMsMax":"61","startMs":"1570971834721","waitRatioMax":0.007254132477107861,"readRatioAvg":0.0013081222499702698,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.005827090022594839,"writeMsAvg":"133","status":"COMPLETE","writeMsMax":"133","computeMsAvg":"49","shuffleOutputBytesSpilled":"0","writeRatioMax":0.015816387204185992,"readMsAvg":"11","waitRatioAvg":0.007254132477107861,"completedParallelInputs":"1","computeRatioMax":0.005827090022594839,"name":"S02: Input","shuffleOutputBytes":"918000","recordsWritten":"102000","readRatioMax":0.0013081222499702698,"steps":[{"kind":"READ","substeps":["$70:i_item_sk","FROM item"]},{"kind":"WRITE","substeps":["$70","TO __stage02_output","BY HASH($70)"]}],"writeRatioAvg":0.015816387204185992},{"readMsMax":"7","computeMsMax":"9","waitMsAvg":"70","id":"4","endMs":"1570971834842","waitMsMax":"70","startMs":"1570971834761","waitRatioMax":0.008324414317992627,"readRatioAvg":0.0008324414317992627,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0010702818408847663,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0024973242953977882,"readMsAvg":"7","waitRatioAvg":0.008324414317992627,"completedParallelInputs":"1","computeRatioMax":0.0010702818408847663,"name":"S04: Input","shuffleOutputBytes":"558","recordsWritten":"31","readRatioMax":0.0008324414317992627,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $12:d_moy, $11:d_year","FROM date_dim","WHERE and(equal($11, 2002), equal($12, 1))"]},{"kind":"WRITE","substeps":["$10, $12","TO __stage04_output","BY HASH($10)"]}],"writeRatioAvg":0.0024973242953977882},{"readMsMax":"8","computeMsMax":"6","waitMsAvg":"56","id":"5","endMs":"1570971834835","waitMsMax":"56","startMs":"1570971834761","waitRatioMax":0.006659531454394102,"readRatioAvg":0.0009513616363420145,"parallelInputs":"1","recordsRead":"10","computeRatioAvg":0.0007135212272565109,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0008324414317992627,"readMsAvg":"8","waitRatioAvg":0.006659531454394102,"completedParallelInputs":"1","computeRatioMax":0.0007135212272565109,"name":"S05: Input","shuffleOutputBytes":"299","recordsWritten":"10","readRatioMax":0.0009513616363420145,"steps":[{"kind":"READ","substeps":["$1:w_warehouse_sk, $2:w_warehouse_name","FROM warehouse"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage05_output","BY HASH($1)"]}],"writeRatioAvg":0.0008324414317992627},{"readMsMax":"16","computeMsMax":"51","waitMsAvg":"44","id":"6","endMs":"1570971834958","waitMsMax":"44","startMs":"1570971834761","waitRatioMax":0.005232488999881079,"readRatioAvg":0.001902723272684029,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.006064930431680342,"writeMsAvg":"147","status":"COMPLETE","writeMsMax":"147","computeMsAvg":"51","shuffleOutputBytesSpilled":"0","writeRatioMax":0.017481270067784518,"readMsAvg":"16","waitRatioAvg":0.005232488999881079,"completedParallelInputs":"1","computeRatioMax":0.006064930431680342,"name":"S06: Input","shuffleOutputBytes":"918000","recordsWritten":"102000","readRatioMax":0.001902723272684029,"steps":[{"kind":"READ","substeps":["$50:i_item_sk","FROM item"]},{"kind":"WRITE","substeps":["$50","TO __stage06_output","BY HASH($50)"]}],"writeRatioAvg":0.017481270067784518},{"readMsMax":"49","computeMsMax":"8409","inputStages":["0","1","2"],"waitMsAvg":"1","id":"8","endMs":"1570971839451","waitMsMax":"1","startMs":"1570971835000","waitRatioMax":0.00011892020454275182,"readRatioAvg":0.0034486859317398024,"parallelInputs":"14","recordsRead":"134538532","computeRatioAvg":0.8783446307527649,"writeMsAvg":"32","status":"COMPLETE","writeMsMax":"161","computeMsAvg":"7386","shuffleOutputBytesSpilled":"0","writeRatioMax":0.019146152931383043,"readMsAvg":"29","waitRatioAvg":0.00011892020454275182,"completedParallelInputs":"14","computeRatioMax":1,"name":"S08: Join+","shuffleOutputBytes":"159612342","recordsWritten":"1831682","readRatioMax":0.005827090022594839,"steps":[{"kind":"READ","substeps":["$60:inv_date_sk, $61:inv_item_sk, $62:inv_warehouse_sk, $63:inv_quantity_on_hand","FROM inventory"]},{"kind":"READ","substeps":["$70","FROM __stage02_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage01_output"]},{"kind":"READ","substeps":["$30, $32","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $260 := $251, $261 := $250, $262 := $253, $263 := $254","$130 := VAR_POP($150)","$131 := SHARD_AVG($252)"]},{"kind":"COMPUTE","substeps":["$150 := CAST($252 AS DOUBLE)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $230 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $221 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $61 = $70"]},{"kind":"WRITE","substeps":["$261, $260, $263, $262, $130, $131","TO __stage08_output","BY HASH($260, $261, $262, $263)"]}],"writeRatioAvg":0.003805446545368058},{"readMsMax":"57","computeMsMax":"8337","inputStages":["4","5","6"],"waitMsAvg":"1","id":"9","endMs":"1570971839859","waitMsMax":"2","startMs":"1570971835027","waitRatioMax":0.00023784040908550363,"readRatioAvg":0.003686526340825306,"parallelInputs":"14","recordsRead":"134538574","computeRatioAvg":0.841360447139969,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"37","computeMsAvg":"7075","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0044000475680818175,"readMsAvg":"31","waitRatioAvg":0.00011892020454275182,"completedParallelInputs":"14","computeRatioMax":0.9914377452729218,"name":"S09: Join+","shuffleOutputBytes":"192875233","recordsWritten":"2211443","readRatioMax":0.0067784516589368534,"steps":[{"kind":"READ","substeps":["$40:inv_date_sk, $41:inv_item_sk, $42:inv_warehouse_sk, $43:inv_quantity_on_hand","FROM inventory"]},{"kind":"READ","substeps":["$50","FROM __stage06_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage05_output"]},{"kind":"READ","substeps":["$10, $12","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $200 := $191, $201 := $190, $202 := $193, $203 := $194","$120 := VAR_POP($140)","$121 := SHARD_AVG($192)"]},{"kind":"COMPUTE","substeps":["$140 := CAST($192 AS DOUBLE)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $170 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $161 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $41 = $50"]},{"kind":"WRITE","substeps":["$201, $200, $203, $202, $120, $121","TO __stage09_output","BY HASH($200, $201, $202, $203)"]}],"writeRatioAvg":0.0024973242953977882},{"readMsMax":"0","computeMsMax":"1800","inputStages":["9"],"waitMsAvg":"1","id":"10","endMs":"1570971839919","waitMsMax":"1","startMs":"1570971838881","waitRatioMax":0.00011892020454275182,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1275273","computeRatioAvg":0.21405636817695325,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"1800","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0009513616363420145,"readMsAvg":"0","waitRatioAvg":0.00011892020454275182,"completedParallelInputs":"1","computeRatioMax":0.21405636817695325,"name":"S0A: Repartition","shuffleOutputBytes":"111994132","recordsWritten":"1275273","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage09_output"]}],"writeRatioAvg":0.0009513616363420145},{"readMsMax":"0","computeMsMax":"1589","inputStages":["8"],"waitMsAvg":"1","id":"11","endMs":"1570971839816","waitMsMax":"1","startMs":"1570971839010","waitRatioMax":0.00011892020454275182,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1162316","computeRatioAvg":0.18896420501843264,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"1589","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0010702818408847663,"readMsAvg":"0","waitRatioAvg":0.00011892020454275182,"completedParallelInputs":"1","computeRatioMax":0.18896420501843264,"name":"S0B: Repartition","shuffleOutputBytes":"101618570","recordsWritten":"1162316","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage08_output"]}],"writeRatioAvg":0.0010702818408847663},{"readMsMax":"0","computeMsMax":"495","inputStages":["10","9"],"waitMsAvg":"56","id":"13","endMs":"1570971840295","waitMsMax":"64","startMs":"1570971839986","waitRatioMax":0.007610893090736116,"readRatioAvg":0,"parallelInputs":"10","recordsRead":"2211443","computeRatioAvg":0.04970864549887026,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"418","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0008324414317992627,"readMsAvg":"0","waitRatioAvg":0.006659531454394102,"completedParallelInputs":"10","computeRatioMax":0.05886550124866215,"name":"S0D: Aggregate+","shuffleOutputBytes":"1109565","recordsWritten":"24657","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$201, $200, $203, $202, $120, $121","FROM __stage09_output"]},{"kind":"COMPUTE","substeps":["$80 := case_with_value($101, 0, NULL, divide($100, $101))"]},{"kind":"FILTER","substeps":["greater(case_with_value($101, 0, 0, divide($100, $101)), 1)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203","$100 := ROOT_STDDEV_SAMP($120)","$101 := ROOT_AVG($121)"]},{"kind":"WRITE","substeps":["$80, $101, $211, $212, $213","TO __stage0D_output","BY HASH($212, $211)"]}],"writeRatioAvg":0.0007135212272565109},{"readMsMax":"0","computeMsMax":"9","inputStages":["13"],"waitMsAvg":"4","id":"14","endMs":"1570971840406","waitMsMax":"10","startMs":"1570971840301","waitRatioMax":0.0011892020454275182,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"24657","computeRatioAvg":0.00047568081817100726,"writeMsAvg":"34","status":"COMPLETE","writeMsMax":"63","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007491972886193364,"readMsAvg":"0","waitRatioAvg":0.00047568081817100726,"completedParallelInputs":"100","computeRatioMax":0.0010702818408847663,"name":"S0E: Coalesce","shuffleOutputBytes":"1109565","recordsWritten":"24657","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0D_output"]}],"writeRatioAvg":0.004043286954453561},{"readMsMax":"0","computeMsMax":"434","inputStages":["11","8","14"],"waitMsAvg":"2","id":"15","endMs":"1570971840680","waitMsMax":"6","startMs":"1570971840331","waitRatioMax":0.0007135212272565109,"readRatioAvg":0,"parallelInputs":"10","recordsRead":"2078252","computeRatioAvg":0.04411939588536092,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"371","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0009513616363420145,"readMsAvg":"0","waitRatioAvg":0.00023784040908550363,"completedParallelInputs":"10","computeRatioMax":0.05161136877155429,"name":"S0F: Join+","shuffleOutputBytes":"155250","recordsWritten":"1725","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$261, $260, $263, $262, $130, $131","FROM __stage08_output"]},{"kind":"READ","substeps":["$80, $101, $211, $212, $213","FROM __stage0E_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $272 = $212, $271 = $211"]},{"kind":"COMPUTE","substeps":["$90 := case_with_value($111, 0, NULL, divide($110, $111))"]},{"kind":"FILTER","substeps":["greater(case_with_value($111, 0, 0, divide($110, $111)), 1)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263","$110 := ROOT_STDDEV_SAMP($130)","$111 := ROOT_AVG($131)"]},{"kind":"WRITE","substeps":["$280, $281, $285, $286, $282, $287, $283, $288, $284, $289","TO __stage0F_output"]}],"writeRatioAvg":0.0005946010227137591},{"readMsMax":"0","computeMsMax":"10","inputStages":["15"],"waitMsAvg":"3","id":"16","endMs":"1570971840768","waitMsMax":"3","startMs":"1570971840690","waitRatioMax":0.00035676061362825543,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1725","computeRatioAvg":0.0011892020454275182,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0028540849090260435,"readMsAvg":"0","waitRatioAvg":0.00035676061362825543,"completedParallelInputs":"1","computeRatioMax":0.0011892020454275182,"name":"S10: Output","shuffleOutputBytes":"155250","recordsWritten":"1725","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$280, $281, $285, $286, $282, $287, $283, $288, $284, $289","FROM __stage0F_output"]},{"kind":"SORT","substeps":["$280 ASC, $282 ASC, $281 ASC, $284 ASC, $283 ASC, $286 ASC, $289 ASC, $288 ASC"]},{"kind":"WRITE","substeps":["$290, $291, $292, $293, $294, $295, $296, $297, $298, $299","TO __stage10_output"]}],"writeRatioAvg":0.0028540849090260435}],"estimatedBytesProcessed":"4208834171","timeline":[{"totalSlotMs":"3214","activeUnits":"28","completedUnits":"6","elapsedMs":"668","pendingUnits":"28"},{"totalSlotMs":"45688","activeUnits":"29","completedUnits":"6","elapsedMs":"1677","pendingUnits":"28"},{"totalSlotMs":"203490","activeUnits":"20","completedUnits":"29","elapsedMs":"4851","pendingUnits":"7"},{"totalSlotMs":"226618","activeUnits":"10","completedUnits":"146","elapsedMs":"6432","pendingUnits":"10"},{"totalSlotMs":"232083","completedUnits":"157","elapsedMs":"6453","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"4208984064","totalPartitionsProcessed":"0","totalBytesProcessed":"4208834171","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"warehouse","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"inventory","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_10"}]},"endTime":"1570971840952"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query39_1570971833"},"etag":"TgNHlb1pBPUZu7uTbkIbxg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query39_1570971833?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonccca4e3743d7030b5d8fd8f84eb201e44bf7f085","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query39\nWITH inv \n AS (SELECT w_warehouse_name, \n w_warehouse_sk, \n i_item_sk, \n d_moy, \n stdev, \n mean, \n CASE mean \n WHEN 0 THEN NULL \n ELSE stdev / mean \n END cov \n FROM (SELECT w_warehouse_name, \n w_warehouse_sk, \n i_item_sk, \n d_moy, \n Stddev_samp(inv_quantity_on_hand) stdev, \n Avg(inv_quantity_on_hand) mean \n FROM inventory, \n item, \n warehouse, \n date_dim \n WHERE inv_item_sk = i_item_sk \n AND inv_warehouse_sk = w_warehouse_sk \n AND inv_date_sk = d_date_sk \n AND d_year = 2002 \n GROUP BY w_warehouse_name, \n w_warehouse_sk, \n i_item_sk, \n d_moy) foo \n WHERE CASE mean \n WHEN 0 THEN 0 \n ELSE stdev / mean \n END > 1) \nSELECT inv1.w_warehouse_sk, \n inv1.i_item_sk, \n inv1.d_moy, \n inv1.mean, \n inv1.cov, \n inv2.w_warehouse_sk AS w_warehouse_sk_2, \n inv2.i_item_sk AS i_item_sk_2, \n inv2.d_moy AS d_moy_2, \n inv2.mean AS mean_2, \n inv2.cov AS cov_2 \nFROM inv inv1, \n inv inv2 \nWHERE inv1.i_item_sk = inv2.i_item_sk \n AND inv1.w_warehouse_sk = inv2.w_warehouse_sk \n AND inv1.d_moy = 1 \n AND inv2.d_moy = 1 + 1 \nORDER BY inv1.w_warehouse_sk, \n inv1.i_item_sk, \n inv1.d_moy, \n inv1.mean, \n inv1.cov, \n inv2.d_moy, \n inv2.mean, \n inv2.cov; "},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query39_1570971833","user_email":"nithish.sankaranarayanan@ulb.be"}
