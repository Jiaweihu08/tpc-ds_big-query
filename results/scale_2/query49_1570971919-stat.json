{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"54736","creationTime":"1570971921065","totalBytesProcessed":"2536363808","startTime":"1570971921197","query":{"totalSlotMs":"54736","queryPlan":[{"readMsMax":"19","computeMsMax":"13","waitMsAvg":"49","id":"0","endMs":"1570971921690","waitMsMax":"49","startMs":"1570971921449","waitRatioMax":0.036404160475482915,"readRatioAvg":0.01411589895988113,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.009658246656760773,"writeMsAvg":"203","status":"COMPLETE","writeMsMax":"203","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.15081723625557206,"readMsAvg":"19","waitRatioAvg":0.036404160475482915,"completedParallelInputs":"1","computeRatioMax":0.009658246656760773,"name":"S00: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.01411589895988113,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_year, $22:d_moy","FROM date_dim","WHERE and(equal($21, 1999), equal($22, 12))"]},{"kind":"WRITE","substeps":["$20","TO __stage00_output","BY HASH($20)"]}],"writeRatioAvg":0.15081723625557206},{"readMsMax":"70","computeMsMax":"275","waitMsAvg":"81","id":"1","endMs":"1570971921747","waitMsMax":"81","startMs":"1570971921508","waitRatioMax":0.060178306092124816,"readRatioAvg":0.05200594353640416,"parallelInputs":"1","recordsRead":"2878330","computeRatioAvg":0.20430906389301634,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"12","computeMsAvg":"275","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008915304606240713,"readMsAvg":"70","waitRatioAvg":0.060178306092124816,"completedParallelInputs":"1","computeRatioMax":0.20430906389301634,"name":"S01: Input","shuffleOutputBytes":"166896","recordsWritten":"4658","readRatioMax":0.05200594353640416,"steps":[{"kind":"READ","substeps":["$80:sr_item_sk, $81:sr_ticket_number, $82:sr_return_quantity, $83:sr_return_amt","FROM store_returns","WHERE greater($83, 10000)"]},{"kind":"WRITE","substeps":["$80, $81, $82, $83","TO __stage01_output","BY HASH($81, $80)"]}],"writeRatioAvg":0.008915304606240713},{"readMsMax":"16","computeMsMax":"9","waitMsAvg":"2","id":"3","endMs":"1570971921625","waitMsMax":"2","startMs":"1570971921549","waitRatioMax":0.0014858841010401188,"readRatioAvg":0.01188707280832095,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.006686478454680535,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005200594353640416,"readMsAvg":"16","waitRatioAvg":0.0014858841010401188,"completedParallelInputs":"1","computeRatioMax":0.006686478454680535,"name":"S03: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.01188707280832095,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $11:d_year, $12:d_moy","FROM date_dim","WHERE and(equal($11, 1999), equal($12, 12))"]},{"kind":"WRITE","substeps":["$10","TO __stage03_output","BY HASH($10)"]}],"writeRatioAvg":0.005200594353640416},{"readMsMax":"112","computeMsMax":"181","waitMsAvg":"24","id":"4","endMs":"1570971921803","waitMsMax":"24","startMs":"1570971921590","waitRatioMax":0.017830609212481426,"readRatioAvg":0.08320950965824665,"parallelInputs":"1","recordsRead":"1439802","computeRatioAvg":0.13447251114413075,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"181","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003714710252600297,"readMsAvg":"112","waitRatioAvg":0.017830609212481426,"completedParallelInputs":"1","computeRatioMax":0.13447251114413075,"name":"S04: Input","shuffleOutputBytes":"447996","recordsWritten":"12471","readRatioMax":0.08320950965824665,"steps":[{"kind":"READ","substeps":["$60:cr_item_sk, $61:cr_order_number, $62:cr_return_quantity, $63:cr_return_amount","FROM catalog_returns","WHERE greater($63, 10000)"]},{"kind":"WRITE","substeps":["$60, $61, $62, $63","TO __stage04_output","BY HASH($61, $60)"]}],"writeRatioAvg":0.003714710252600297},{"readMsMax":"9","computeMsMax":"8","waitMsAvg":"29","id":"6","endMs":"1570971921709","waitMsMax":"29","startMs":"1570971921626","waitRatioMax":0.021545319465081723,"readRatioAvg":0.006686478454680535,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.005943536404160475,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01411589895988113,"readMsAvg":"9","waitRatioAvg":0.021545319465081723,"completedParallelInputs":"1","computeRatioMax":0.005943536404160475,"name":"S06: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.006686478454680535,"steps":[{"kind":"READ","substeps":["$1:d_date_sk, $2:d_year, $3:d_moy","FROM date_dim","WHERE and(equal($2, 1999), equal($3, 12))"]},{"kind":"WRITE","substeps":["$1","TO __stage06_output","BY HASH($1)"]}],"writeRatioAvg":0.01411589895988113},{"readMsMax":"100","computeMsMax":"90","waitMsAvg":"30","id":"7","endMs":"1570971921812","waitMsMax":"30","startMs":"1570971921647","waitRatioMax":0.022288261515601784,"readRatioAvg":0.07429420505200594,"parallelInputs":"1","recordsRead":"720202","computeRatioAvg":0.06686478454680535,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"90","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006686478454680535,"readMsAvg":"100","waitRatioAvg":0.022288261515601784,"completedParallelInputs":"1","computeRatioMax":0.06686478454680535,"name":"S07: Input","shuffleOutputBytes":"214520","recordsWritten":"5990","readRatioMax":0.07429420505200594,"steps":[{"kind":"READ","substeps":["$40:wr_item_sk, $41:wr_order_number, $42:wr_return_quantity, $43:wr_return_amt","FROM web_returns","WHERE greater($43, 10000)"]},{"kind":"WRITE","substeps":["$40, $41, $42, $43","TO __stage07_output","BY HASH($41, $40)"]}],"writeRatioAvg":0.006686478454680535},{"readMsMax":"0","computeMsMax":"10","inputStages":["1"],"waitMsAvg":"33","id":"9","endMs":"1570971921928","waitMsMax":"38","startMs":"1570971921808","waitRatioMax":0.02823179791976226,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"4658","computeRatioAvg":0.003714710252600297,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"38","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02823179791976226,"readMsAvg":"0","waitRatioAvg":0.02451708766716196,"completedParallelInputs":"100","computeRatioMax":0.007429420505200594,"name":"S09: Coalesce","shuffleOutputBytes":"166896","recordsWritten":"4658","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage01_output"]}],"writeRatioAvg":0.017087667161961365},{"readMsMax":"224","computeMsMax":"1346","inputStages":["0","9"],"waitMsAvg":"51","id":"10","endMs":"1570971922913","waitMsMax":"57","startMs":"1570971921859","waitRatioMax":0.04234769687964339,"readRatioAvg":0.1151560178306092,"parallelInputs":"10","recordsRead":"28849002","computeRatioAvg":0.8826151560178306,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"1188","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007429420505200594,"readMsAvg":"155","waitRatioAvg":0.03789004457652303,"completedParallelInputs":"10","computeRatioMax":1,"name":"S0A: Join+","shuffleOutputBytes":"6165","recordsWritten":"137","readRatioMax":0.1664190193164933,"steps":[{"kind":"READ","substeps":["$70:ss_sold_date_sk, $71:ss_item_sk, $72:ss_ticket_number, $73:ss_quantity, $74:ss_net_paid, $75:ss_net_profit","FROM store_sales","WHERE and(greater($75, 1), greater($74, 0), greater($73, 0))"]},{"kind":"READ","substeps":["$80, $81, $82, $83","FROM __stage09_output"]},{"kind":"READ","substeps":["$20","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $570 := $560","$270 := SUM($300)","$271 := SUM($301)","$272 := SUM($302)","$273 := SUM($303)"]},{"kind":"COMPUTE","substeps":["$300 := coalesce($563, 0)","$301 := coalesce($561, 0)","$302 := coalesce($564, 0)","$303 := coalesce($562, 0)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $540 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $72 = $81, $71 = $80"]},{"kind":"WRITE","substeps":["$570, $270, $271, $272, $273","TO __stage0A_output","BY HASH($570)"]}],"writeRatioAvg":0.004457652303120356},{"readMsMax":"0","computeMsMax":"9","inputStages":["4"],"waitMsAvg":"39","id":"11","endMs":"1570971922150","waitMsMax":"63","startMs":"1570971921858","waitRatioMax":0.046805349182763745,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"12471","computeRatioAvg":0.004457652303120356,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"50","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03714710252600297,"readMsAvg":"0","waitRatioAvg":0.02897473997028232,"completedParallelInputs":"100","computeRatioMax":0.006686478454680535,"name":"S0B: Coalesce","shuffleOutputBytes":"447996","recordsWritten":"12471","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage04_output"]}],"writeRatioAvg":0.008915304606240713},{"readMsMax":"229","computeMsMax":"991","inputStages":["3","11"],"waitMsAvg":"42","id":"12","endMs":"1570971922817","waitMsMax":"43","startMs":"1570971921916","waitRatioMax":0.03194650817236255,"readRatioAvg":0.0988112927191679,"parallelInputs":"8","recordsRead":"14497339","computeRatioAvg":0.7072808320950966,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"952","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005943536404160475,"readMsAvg":"133","waitRatioAvg":0.031203566121842496,"completedParallelInputs":"8","computeRatioMax":0.736255572065379,"name":"S0C: Join+","shuffleOutputBytes":"17775","recordsWritten":"395","readRatioMax":0.17013372956909362,"steps":[{"kind":"READ","substeps":["$50:cs_sold_date_sk, $51:cs_item_sk, $52:cs_order_number, $53:cs_quantity, $54:cs_net_paid, $55:cs_net_profit","FROM catalog_sales","WHERE and(greater($55, 1), greater($54, 0), greater($53, 0))"]},{"kind":"READ","substeps":["$60, $61, $62, $63","FROM __stage0B_output"]},{"kind":"READ","substeps":["$10","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $460 := $450","$260 := SUM($290)","$261 := SUM($291)","$262 := SUM($292)","$263 := SUM($293)"]},{"kind":"COMPUTE","substeps":["$290 := coalesce($453, 0)","$291 := coalesce($451, 0)","$292 := coalesce($454, 0)","$293 := coalesce($452, 0)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $430 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $52 = $61, $51 = $60"]},{"kind":"WRITE","substeps":["$460, $260, $261, $262, $263","TO __stage0C_output","BY HASH($460)"]}],"writeRatioAvg":0.004457652303120356},{"readMsMax":"237","computeMsMax":"981","inputStages":["6","7"],"waitMsAvg":"20","id":"13","endMs":"1570971922765","waitMsMax":"24","startMs":"1570971921999","waitRatioMax":0.017830609212481426,"readRatioAvg":0.11292719167904904,"parallelInputs":"4","recordsRead":"7225114","computeRatioAvg":0.6939078751857355,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"934","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005200594353640416,"readMsAvg":"152","waitRatioAvg":0.014858841010401188,"completedParallelInputs":"4","computeRatioMax":0.7288261515601783,"name":"S0D: Join+","shuffleOutputBytes":"8280","recordsWritten":"184","readRatioMax":0.1760772659732541,"steps":[{"kind":"READ","substeps":["$30:ws_sold_date_sk, $31:ws_item_sk, $32:ws_order_number, $33:ws_quantity, $34:ws_net_paid, $35:ws_net_profit","FROM web_sales","WHERE and(greater($35, 1), greater($34, 0), greater($33, 0))"]},{"kind":"READ","substeps":["$40, $41, $42, $43","FROM __stage07_output"]},{"kind":"READ","substeps":["$1","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $350 := $340","$250 := SUM($280)","$251 := SUM($281)","$252 := SUM($282)","$253 := SUM($283)"]},{"kind":"COMPUTE","substeps":["$280 := coalesce($343, 0)","$281 := coalesce($341, 0)","$282 := coalesce($344, 0)","$283 := coalesce($342, 0)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $320 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $32 = $41, $31 = $40"]},{"kind":"WRITE","substeps":["$350, $250, $251, $252, $253","TO __stage0D_output","BY HASH($350)"]}],"writeRatioAvg":0.003714710252600297},{"readMsMax":"0","computeMsMax":"4","inputStages":["13"],"waitMsAvg":"10","id":"14","endMs":"1570971922947","waitMsMax":"10","startMs":"1570971922789","waitRatioMax":0.007429420505200594,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"184","computeRatioAvg":0.0029717682020802376,"writeMsAvg":"148","status":"COMPLETE","writeMsMax":"148","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.1099554234769688,"readMsAvg":"0","waitRatioAvg":0.007429420505200594,"completedParallelInputs":"1","computeRatioMax":0.0029717682020802376,"name":"S0E: Aggregate+","shuffleOutputBytes":"4941","recordsWritten":"183","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$350, $250, $251, $252, $253","FROM __stage0D_output"]},{"kind":"COMPUTE","substeps":["$190 := divide(CAST($220 AS DOUBLE), CAST($221 AS DOUBLE))","$191 := divide($222, $223)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $360 := $350","$220 := SUM($250)","$221 := SUM($251)","$222 := SUM($252)","$223 := SUM($253)"]},{"kind":"WRITE","substeps":["$360, $190, $191","TO __stage0E_output"]}],"writeRatioAvg":0.1099554234769688},{"readMsMax":"0","computeMsMax":"7","inputStages":["12"],"waitMsAvg":"41","id":"15","endMs":"1570971923007","waitMsMax":"41","startMs":"1570971922890","waitRatioMax":0.030460624071322436,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"395","computeRatioAvg":0.005200594353640416,"writeMsAvg":"53","status":"COMPLETE","writeMsMax":"53","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03937592867756315,"readMsAvg":"0","waitRatioAvg":0.030460624071322436,"completedParallelInputs":"1","computeRatioMax":0.005200594353640416,"name":"S0F: Aggregate+","shuffleOutputBytes":"10665","recordsWritten":"395","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$460, $260, $261, $262, $263","FROM __stage0C_output"]},{"kind":"COMPUTE","substeps":["$200 := divide(CAST($230 AS DOUBLE), CAST($231 AS DOUBLE))","$201 := divide($232, $233)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $470 := $460","$230 := SUM($260)","$231 := SUM($261)","$232 := SUM($262)","$233 := SUM($263)"]},{"kind":"WRITE","substeps":["$470, $200, $201","TO __stage0F_output"]}],"writeRatioAvg":0.03937592867756315},{"readMsMax":"0","computeMsMax":"4","inputStages":["10"],"waitMsAvg":"23","id":"16","endMs":"1570971923022","waitMsMax":"23","startMs":"1570971922947","waitRatioMax":0.017087667161961365,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"137","computeRatioAvg":0.0029717682020802376,"writeMsAvg":"53","status":"COMPLETE","writeMsMax":"53","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03937592867756315,"readMsAvg":"0","waitRatioAvg":0.017087667161961365,"completedParallelInputs":"1","computeRatioMax":0.0029717682020802376,"name":"S10: Aggregate+","shuffleOutputBytes":"3699","recordsWritten":"137","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$570, $270, $271, $272, $273","FROM __stage0A_output"]},{"kind":"COMPUTE","substeps":["$210 := divide(CAST($240 AS DOUBLE), CAST($241 AS DOUBLE))","$211 := divide($242, $243)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $580 := $570","$240 := SUM($270)","$241 := SUM($271)","$242 := SUM($272)","$243 := SUM($273)"]},{"kind":"WRITE","substeps":["$580, $210, $211","TO __stage10_output"]}],"writeRatioAvg":0.03937592867756315},{"readMsMax":"0","computeMsMax":"6","inputStages":["14","15","16"],"waitMsAvg":"63","id":"17","endMs":"1570971923031","waitMsMax":"83","startMs":"1570971922947","waitRatioMax":0.061664190193164936,"readRatioAvg":0,"parallelInputs":"3","recordsRead":"715","computeRatioAvg":0.003714710252600297,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0029717682020802376,"readMsAvg":"0","waitRatioAvg":0.046805349182763745,"completedParallelInputs":"3","computeRatioMax":0.004457652303120356,"name":"S11: Sort+","shuffleOutputBytes":"1846","recordsWritten":"40","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$360, $190, $191","FROM __stage0E_output"]},{"kind":"READ","substeps":["$470, $200, $201","FROM __stage0F_output"]},{"kind":"READ","substeps":["$580, $210, $211","FROM __stage10_output"]},{"kind":"SORT","substeps":["$100 ASC, $401 ASC, $130 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$100 := 'web'"]},{"kind":"FILTER","substeps":["or(less_or_equal($401, 10), less_or_equal($130, 10))"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$130 := RANK() OVER (ORDER BY $393 ASC)"]},{"kind":"SORT","substeps":["$382 ASC"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$160 := RANK() OVER (ORDER BY $371 ASC)"]},{"kind":"SORT","substeps":["$190 ASC"]},{"kind":"SORT","substeps":["$110 ASC, $511 ASC, $140 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$110 := 'catalog'"]},{"kind":"FILTER","substeps":["or(less_or_equal($511, 10), less_or_equal($140, 10))"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$140 := RANK() OVER (ORDER BY $503 ASC)"]},{"kind":"SORT","substeps":["$492 ASC"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$170 := RANK() OVER (ORDER BY $481 ASC)"]},{"kind":"SORT","substeps":["$200 ASC"]},{"kind":"SORT","substeps":["$120 ASC, $621 ASC, $150 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$120 := 'store'"]},{"kind":"FILTER","substeps":["or(less_or_equal($621, 10), less_or_equal($150, 10))"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$150 := RANK() OVER (ORDER BY $613 ASC)"]},{"kind":"SORT","substeps":["$602 ASC"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$180 := RANK() OVER (ORDER BY $591 ASC)"]},{"kind":"SORT","substeps":["$210 ASC"]},{"kind":"WRITE","substeps":["$90, $91, $92, $93, $94","TO __stage11_output"]}],"writeRatioAvg":0.002228826151560178},{"readMsMax":"0","computeMsMax":"5","inputStages":["17"],"waitMsAvg":"60","id":"18","endMs":"1570971923277","waitMsMax":"60","startMs":"1570971923008","waitRatioMax":0.04457652303120357,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"40","computeRatioAvg":0.003714710252600297,"writeMsAvg":"130","status":"COMPLETE","writeMsMax":"130","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.09658246656760773,"readMsAvg":"0","waitRatioAvg":0.04457652303120357,"completedParallelInputs":"1","computeRatioMax":0.003714710252600297,"name":"S12: Output","shuffleOutputBytes":"1846","recordsWritten":"40","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$90, $91, $92, $93, $94","FROM __stage11_output"]},{"kind":"SORT","substeps":["$90 ASC, $93 ASC, $94 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$640, $641, $642, $643, $644","TO __stage12_output"]}],"writeRatioAvg":0.09658246656760773}],"estimatedBytesProcessed":"2536363808","timeline":[{"totalSlotMs":"8449","activeUnits":"118","completedUnits":"106","elapsedMs":"753","pendingUnits":"122"},{"totalSlotMs":"54736","activeUnits":"22","completedUnits":"235","elapsedMs":"2221","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"2536505344","totalPartitionsProcessed":"0","totalBytesProcessed":"2536363808","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_returns","datasetId":"scale_10"}]},"endTime":"1570971923441"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query49_1570971919"},"etag":"7ElmF+/Zkih8Tff5I395fg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query49_1570971919?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonbf341146da1821ab63ece31a7283df5fe9b3c83a","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query49\nSELECT 'web' AS channel, \n web.item, \n web.return_ratio, \n web.return_rank, \n web.currency_rank \nFROM (SELECT item, \n return_ratio, \n currency_ratio, \n Rank() \n OVER ( \n ORDER BY return_ratio) AS return_rank, \n Rank() \n OVER ( \n ORDER BY currency_ratio) AS currency_rank \n FROM (SELECT ws.ws_item_sk AS item, \n ( Sum(COALESCE(wr.wr_return_quantity, 0)) / \n Sum(COALESCE(ws.ws_quantity, 0)) ) AS \n return_ratio, \n ( Sum(COALESCE(wr.wr_return_amt, 0)) / \n Sum(COALESCE(ws.ws_net_paid, 0)) ) AS currency_ratio \n FROM web_sales ws \n LEFT OUTER JOIN web_returns wr \n ON ( ws.ws_order_number = wr.wr_order_number \n AND ws.ws_item_sk = wr.wr_item_sk ), \n date_dim \n WHERE wr.wr_return_amt > 10000 \n AND ws.ws_net_profit > 1 \n AND ws.ws_net_paid > 0 \n AND ws.ws_quantity > 0 \n AND ws_sold_date_sk = d_date_sk \n AND d_year = 1999 \n AND d_moy = 12 \n GROUP BY ws.ws_item_sk) in_web) web \nWHERE ( web.return_rank <= 10 \n OR web.currency_rank <= 10 ) \nUNION ALL \nSELECT 'catalog' AS channel, \n catalog.item, \n catalog.return_ratio, \n catalog.return_rank, \n catalog.currency_rank \nFROM (SELECT item, \n return_ratio, \n currency_ratio, \n Rank() \n OVER ( \n ORDER BY return_ratio) AS return_rank, \n Rank() \n OVER ( \n ORDER BY currency_ratio) AS currency_rank \n FROM (SELECT cs.cs_item_sk AS \n item, \n ( Sum(COALESCE(cr.cr_return_quantity, 0)) / \n Sum(COALESCE(cs.cs_quantity, 0)) ) AS \n return_ratio, \n ( Sum(COALESCE(cr.cr_return_amount, 0)) / \n Sum(COALESCE(cs.cs_net_paid, 0)) ) AS \n currency_ratio \n FROM catalog_sales cs \n LEFT OUTER JOIN catalog_returns cr \n ON ( cs.cs_order_number = cr.cr_order_number \n AND cs.cs_item_sk = cr.cr_item_sk ), \n date_dim \n WHERE cr.cr_return_amount > 10000 \n AND cs.cs_net_profit > 1 \n AND cs.cs_net_paid > 0 \n AND cs.cs_quantity > 0 \n AND cs_sold_date_sk = d_date_sk \n AND d_year = 1999 \n AND d_moy = 12 \n GROUP BY cs.cs_item_sk) in_cat) catalog \nWHERE ( catalog.return_rank <= 10 \n OR catalog.currency_rank <= 10 ) \nUNION ALL\nSELECT 'store' AS channel, \n store.item, \n store.return_ratio, \n store.return_rank, \n store.currency_rank \nFROM (SELECT item, \n return_ratio, \n currency_ratio, \n Rank() \n OVER ( \n ORDER BY return_ratio) AS return_rank, \n Rank() \n OVER ( \n ORDER BY currency_ratio) AS currency_rank \n FROM (SELECT sts.ss_item_sk AS \n item, \n ( Sum(COALESCE(sr.sr_return_quantity, 0)) / \n Sum(COALESCE(sts.ss_quantity, 0)) ) AS \n return_ratio, \n ( Sum(COALESCE(sr.sr_return_amt, 0)) \n / Sum(COALESCE(sts.ss_net_paid, 0)) ) AS \n currency_ratio \n FROM store_sales sts \n LEFT OUTER JOIN store_returns sr \n ON ( sts.ss_ticket_number = \n sr.sr_ticket_number \n AND sts.ss_item_sk = sr.sr_item_sk ), \n date_dim \n WHERE sr.sr_return_amt > 10000 \n AND sts.ss_net_profit > 1 \n AND sts.ss_net_paid > 0 \n AND sts.ss_quantity > 0 \n AND ss_sold_date_sk = d_date_sk \n AND d_year = 1999 \n AND d_moy = 12 \n GROUP BY sts.ss_item_sk) in_store) store \nWHERE ( store.return_rank <= 10 \n OR store.currency_rank <= 10 ) \nORDER BY 1, \n 4, \n 5\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query49_1570971919","user_email":"nithish.sankaranarayanan@ulb.be"}
