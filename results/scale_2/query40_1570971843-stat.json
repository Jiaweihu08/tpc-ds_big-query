{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"63959","creationTime":"1570971844717","totalBytesProcessed":"613416964","startTime":"1570971844986","query":{"totalSlotMs":"63959","queryPlan":[{"readMsMax":"10","computeMsMax":"19","waitMsAvg":"3","id":"0","endMs":"1570971845194","waitMsMax":"3","startMs":"1570971845150","waitRatioMax":0.0006448839208942391,"readRatioAvg":0.0021496130696474634,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.00408426483233018,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0010748065348237317,"readMsAvg":"10","waitRatioAvg":0.0006448839208942391,"completedParallelInputs":"1","computeRatioMax":0.00408426483233018,"name":"S00: Input","shuffleOutputBytes":"1488","recordsWritten":"62","readRatioMax":0.0021496130696474634,"steps":[{"kind":"READ","substeps":["$1:d_date_sk, $2:d_date","FROM date_dim","WHERE between(CAST($2 AS DATE), 11808, 11869)"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.0010748065348237317},{"readMsMax":"12","computeMsMax":"22","waitMsAvg":"21","id":"1","endMs":"1570971845385","waitMsMax":"21","startMs":"1570971845183","waitRatioMax":0.0045141874462596735,"readRatioAvg":0.0025795356835769563,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.004729148753224419,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"22","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0012897678417884782,"readMsAvg":"12","waitRatioAvg":0.0045141874462596735,"completedParallelInputs":"1","computeRatioMax":0.004729148753224419,"name":"S01: Input","shuffleOutputBytes":"193770","recordsWritten":"6459","readRatioMax":0.0025795356835769563,"steps":[{"kind":"READ","substeps":["$20:i_item_sk, $21:i_item_id, $22:i_current_price","FROM item","WHERE between($22, 0.99, 1.49)"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage01_output","BY HASH($20)"]}],"writeRatioAvg":0.0012897678417884782},{"readMsMax":"39","computeMsMax":"6","waitMsAvg":"19","id":"2","endMs":"1570971845426","waitMsMax":"19","startMs":"1570971845194","waitRatioMax":0.00408426483233018,"readRatioAvg":0.008383490971625107,"parallelInputs":"1","recordsRead":"10","computeRatioAvg":0.0012897678417884782,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0010748065348237317,"readMsAvg":"39","waitRatioAvg":0.00408426483233018,"completedParallelInputs":"1","computeRatioMax":0.0012897678417884782,"name":"S02: Input","shuffleOutputBytes":"160","recordsWritten":"10","readRatioMax":0.008383490971625107,"steps":[{"kind":"READ","substeps":["$10:w_warehouse_sk, $11:w_state","FROM warehouse"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage02_output","BY HASH($10)"]}],"writeRatioAvg":0.0010748065348237317},{"readMsMax":"81","computeMsMax":"2135","waitMsAvg":"42","id":"3","endMs":"1570971846341","waitMsMax":"42","startMs":"1570971845231","waitRatioMax":0.009028374892519347,"readRatioAvg":0.017411865864144453,"parallelInputs":"1","recordsRead":"1439802","computeRatioAvg":0.45894239036973344,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"16","computeMsAvg":"2135","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0034393809114359416,"readMsAvg":"81","waitRatioAvg":0.009028374892519347,"completedParallelInputs":"1","computeRatioMax":0.45894239036973344,"name":"S03: Input","shuffleOutputBytes":"38643646","recordsWritten":"1439802","readRatioMax":0.017411865864144453,"steps":[{"kind":"READ","substeps":["$40:cr_item_sk, $41:cr_order_number, $42:cr_refunded_cash","FROM catalog_returns"]},{"kind":"WRITE","substeps":["$40, $41, $42","TO __stage03_output","BY HASH($41, $40)"]}],"writeRatioAvg":0.0034393809114359416},{"readMsMax":"0","computeMsMax":"25","inputStages":["3"],"waitMsAvg":"1","id":"4","endMs":"1570971846920","waitMsMax":"3","startMs":"1570971846452","waitRatioMax":0.0006448839208942391,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1439802","computeRatioAvg":0.0034393809114359416,"writeMsAvg":"163","status":"COMPLETE","writeMsMax":"296","computeMsAvg":"16","shuffleOutputBytesSpilled":"0","writeRatioMax":0.06362854686156492,"readMsAvg":"0","waitRatioAvg":0.00021496130696474635,"completedParallelInputs":"100","computeRatioMax":0.005374032674118658,"name":"S04: Coalesce","shuffleOutputBytes":"38643646","recordsWritten":"1439802","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage03_output"]}],"writeRatioAvg":0.03503869303525366},{"readMsMax":"54","computeMsMax":"4652","inputStages":["0","1","2","4"],"waitMsAvg":"2","id":"5","endMs":"1570971849847","waitMsMax":"2","startMs":"1570971846515","waitRatioMax":0.0004299226139294927,"readRatioAvg":0.008598452278589854,"parallelInputs":"8","recordsRead":"25967987","computeRatioAvg":0.8884350816852966,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"4133","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00408426483233018,"readMsAvg":"40","waitRatioAvg":0.0004299226139294927,"completedParallelInputs":"8","computeRatioMax":1,"name":"S05: Join+","shuffleOutputBytes":"697876","recordsWritten":"15174","readRatioMax":0.011607910576096303,"steps":[{"kind":"READ","substeps":["$30:cs_sold_date_sk, $31:cs_warehouse_sk, $32:cs_item_sk, $33:cs_order_number, $34:cs_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$40, $41, $42","FROM __stage04_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage02_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage01_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $120 := $110, $121 := $111","$60 := SUM($71)","$61 := SUM($70)"]},{"kind":"COMPUTE","substeps":["$70 := case_no_value(greater_or_equal(CAST($114 AS DATE), 11839), subtract($112, coalesce($113, 0)), 0)","$71 := case_no_value(less(CAST($114 AS DATE), 11839), subtract($112, coalesce($113, 0)), 0)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $101 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $91 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $81 = $10"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $33 = $41, $32 = $40"]},{"kind":"WRITE","substeps":["$120, $121, $60, $61","TO __stage05_output","BY HASH($120, $121)"]}],"writeRatioAvg":0.0012897678417884782},{"readMsMax":"0","computeMsMax":"18","inputStages":["5"],"waitMsAvg":"1","id":"6","endMs":"1570971849915","waitMsMax":"1","startMs":"1570971849857","waitRatioMax":0.00021496130696474635,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"15174","computeRatioAvg":0.003869303525365434,"writeMsAvg":"39","status":"COMPLETE","writeMsMax":"39","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008383490971625107,"readMsAvg":"0","waitRatioAvg":0.00021496130696474635,"completedParallelInputs":"1","computeRatioMax":0.003869303525365434,"name":"S06: Sort+","shuffleOutputBytes":"4600","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$120, $121, $60, $61","FROM __stage05_output"]},{"kind":"SORT","substeps":["$130 ASC, $131 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $130 := $120, $131 := $121","$50 := SUM($60)","$51 := SUM($61)"]},{"kind":"WRITE","substeps":["$140, $141, $142, $143","TO __stage06_output"]}],"writeRatioAvg":0.008383490971625107},{"readMsMax":"0","computeMsMax":"5","inputStages":["6"],"waitMsAvg":"1","id":"7","endMs":"1570971849993","waitMsMax":"1","startMs":"1570971849879","waitRatioMax":0.00021496130696474635,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0010748065348237317,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0010748065348237317,"readMsAvg":"0","waitRatioAvg":0.00021496130696474635,"completedParallelInputs":"1","computeRatioMax":0.0010748065348237317,"name":"S07: Output","shuffleOutputBytes":"4600","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$140, $141, $142, $143","FROM __stage06_output"]},{"kind":"SORT","substeps":["$140 ASC, $141 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$150, $151, $152, $153","TO __stage07_output"]}],"writeRatioAvg":0.0010748065348237317}],"estimatedBytesProcessed":"613416964","timeline":[{"totalSlotMs":"556","activeUnits":"1","completedUnits":"3","elapsedMs":"669","pendingUnits":"1"},{"totalSlotMs":"35277","activeUnits":"24","completedUnits":"104","elapsedMs":"2358","pendingUnits":"8"},{"totalSlotMs":"63959","activeUnits":"6","completedUnits":"114","elapsedMs":"5165","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"614465536","totalPartitionsProcessed":"0","totalBytesProcessed":"613416964","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"warehouse","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_10"}]},"endTime":"1570971850176"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query40_1570971843"},"etag":"oSnApoL3ovlsGsD6oxfgpA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query40_1570971843?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon5048bfed30f0f2b9d19f5744992534128f85c4b9","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query40\nSELECT\n w_state , \n i_item_id , \n Sum( \n CASE \n WHEN ( \n Cast(d_date AS DATE) < Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) \n ELSE 0 \n END) AS sales_before , \n Sum( \n CASE \n WHEN ( \n Cast(d_date AS DATE) >= Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) \n ELSE 0 \n END) AS sales_after \nFROM catalog_sales \nLEFT OUTER JOIN catalog_returns \nON ( \n cs_order_number = cr_order_number \n AND cs_item_sk = cr_item_sk) , \n warehouse , \n item , \n date_dim \nWHERE i_current_price BETWEEN 0.99 AND 1.49 \nAND i_item_sk = cs_item_sk \nAND cs_warehouse_sk = w_warehouse_sk \nAND cs_sold_date_sk = d_date_sk \nAND Cast(d_date AS DATE) BETWEEN (Cast ('2002-05-01' AS DATE)) AND cast ('2002-07-01' AS date)\nGROUP BY w_state, \n i_item_id \nORDER BY w_state, \n i_item_id \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query40_1570971843","user_email":"nithish.sankaranarayanan@ulb.be"}
