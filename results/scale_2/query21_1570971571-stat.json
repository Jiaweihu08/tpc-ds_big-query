{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"65057","creationTime":"1570971572832","totalBytesProcessed":"4211191735","startTime":"1570971572938","query":{"totalSlotMs":"65057","queryPlan":[{"readMsMax":"9","computeMsMax":"19","waitMsAvg":"3","id":"0","endMs":"1570971573190","waitMsMax":"3","startMs":"1570971573140","waitRatioMax":0.0005822981366459627,"readRatioAvg":0.0017468944099378882,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.003687888198757764,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"12","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002329192546583851,"readMsAvg":"9","waitRatioAvg":0.0005822981366459627,"completedParallelInputs":"1","computeRatioMax":0.003687888198757764,"name":"S00: Input","shuffleOutputBytes":"1488","recordsWritten":"62","readRatioMax":0.0017468944099378882,"steps":[{"kind":"READ","substeps":["$1:d_date_sk, $2:d_date","FROM date_dim","WHERE between(CAST($2 AS DATE), 11060, 11121)"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.002329192546583851},{"readMsMax":"24","computeMsMax":"26","waitMsAvg":"8","id":"1","endMs":"1570971573306","waitMsMax":"8","startMs":"1570971573174","waitRatioMax":0.0015527950310559005,"readRatioAvg":0.004658385093167702,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.005046583850931677,"writeMsAvg":"75","status":"COMPLETE","writeMsMax":"75","computeMsAvg":"26","shuffleOutputBytesSpilled":"0","writeRatioMax":0.014557453416149068,"readMsAvg":"24","waitRatioAvg":0.0015527950310559005,"completedParallelInputs":"1","computeRatioMax":0.005046583850931677,"name":"S01: Input","shuffleOutputBytes":"193770","recordsWritten":"6459","readRatioMax":0.004658385093167702,"steps":[{"kind":"READ","substeps":["$30:i_item_sk, $31:i_item_id, $32:i_current_price","FROM item","WHERE between($32, 0.99, 1.49)"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage01_output","BY HASH($30)"]}],"writeRatioAvg":0.014557453416149068},{"readMsMax":"19","computeMsMax":"4","waitMsAvg":"2","id":"2","endMs":"1570971573392","waitMsMax":"2","startMs":"1570971573190","waitRatioMax":0.00038819875776397513,"readRatioAvg":0.003687888198757764,"parallelInputs":"1","recordsRead":"10","computeRatioAvg":0.0007763975155279503,"writeMsAvg":"176","status":"COMPLETE","writeMsMax":"176","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.034161490683229816,"readMsAvg":"19","waitRatioAvg":0.00038819875776397513,"completedParallelInputs":"1","computeRatioMax":0.0007763975155279503,"name":"S02: Input","shuffleOutputBytes":"299","recordsWritten":"10","readRatioMax":0.003687888198757764,"steps":[{"kind":"READ","substeps":["$20:w_warehouse_sk, $21:w_warehouse_name","FROM warehouse"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.034161490683229816},{"readMsMax":"117","computeMsMax":"5152","inputStages":["0","1","2"],"waitMsAvg":"1","id":"4","endMs":"1570971576253","waitMsMax":"1","startMs":"1570971573488","waitRatioMax":0.00019409937888198756,"readRatioAvg":0.012422360248447204,"parallelInputs":"14","recordsRead":"133201434","computeRatioAvg":0.8608307453416149,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"33","computeMsAvg":"4435","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00640527950310559,"readMsAvg":"64","waitRatioAvg":0.00019409937888198756,"completedParallelInputs":"14","computeRatioMax":1,"name":"S04: Join+","shuffleOutputBytes":"13074381","recordsWritten":"219376","readRatioMax":0.022709627329192548,"steps":[{"kind":"READ","substeps":["$10:inv_date_sk, $11:inv_item_sk, $12:inv_warehouse_sk, $13:inv_quantity_on_hand","FROM inventory"]},{"kind":"READ","substeps":["$20, $21","FROM __stage02_output"]},{"kind":"READ","substeps":["$30, $31","FROM __stage01_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $100 := $91, $101 := $92","$50 := SUM($61)","$51 := SUM($60)"]},{"kind":"COMPUTE","substeps":["$60 := case_no_value(greater_or_equal(CAST($93 AS DATE), 11090), $90, 0)","$61 := case_no_value(less(CAST($93 AS DATE), 11090), $90, 0)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $80 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $71 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $12 = $20"]},{"kind":"WRITE","substeps":["$100, $101, $50, $51","TO __stage04_output","BY HASH($100, $101)"]}],"writeRatioAvg":0.001358695652173913},{"readMsMax":"0","computeMsMax":"250","inputStages":["4"],"waitMsAvg":"1","id":"5","endMs":"1570971576489","waitMsMax":"1","startMs":"1570971576273","waitRatioMax":0.00019409937888198756,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"219376","computeRatioAvg":0.048524844720496896,"writeMsAvg":"69","status":"COMPLETE","writeMsMax":"69","computeMsAvg":"250","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013392857142857142,"readMsAvg":"0","waitRatioAvg":0.00019409937888198756,"completedParallelInputs":"1","computeRatioMax":0.048524844720496896,"name":"S05: Sort+","shuffleOutputBytes":"5400","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$100, $101, $50, $51","FROM __stage04_output"]},{"kind":"SORT","substeps":["$110 ASC, $111 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["between(case_no_value(greater($40, 0), divide(CAST($41 AS DOUBLE), CAST($40 AS DOUBLE)), NULL), 0.66666666666666663, 1.5)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $110 := $100, $111 := $101","$40 := SUM($50)","$41 := SUM($51)"]},{"kind":"WRITE","substeps":["$120, $121, $122, $123","TO __stage05_output"]}],"writeRatioAvg":0.013392857142857142},{"readMsMax":"0","computeMsMax":"4","inputStages":["5"],"waitMsAvg":"1","id":"6","endMs":"1570971576516","waitMsMax":"1","startMs":"1570971576287","waitRatioMax":0.00019409937888198756,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0007763975155279503,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007763975155279503,"readMsAvg":"0","waitRatioAvg":0.00019409937888198756,"completedParallelInputs":"1","computeRatioMax":0.0007763975155279503,"name":"S06: Output","shuffleOutputBytes":"5400","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$120, $121, $122, $123","FROM __stage05_output"]},{"kind":"SORT","substeps":["$120 ASC, $121 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$130, $131, $132, $133","TO __stage06_output"]}],"writeRatioAvg":0.0007763975155279503}],"estimatedBytesProcessed":"4211191735","timeline":[{"totalSlotMs":"1725","activeUnits":"14","completedUnits":"3","elapsedMs":"702","pendingUnits":"14"},{"totalSlotMs":"65057","activeUnits":"5","completedUnits":"19","elapsedMs":"3807","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"4212129792","totalPartitionsProcessed":"0","totalBytesProcessed":"4211191735","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"warehouse","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"inventory","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_10"}]},"endTime":"1570971576777"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query21_1570971571"},"etag":"IWNeyTe1nTXl9pjHLCVJ7w==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query21_1570971571?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon51624f4a497a63595a2247c74bf063fbe6f7ccd0","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query21\nSELECT\n benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results warmup \nFROM ( \n SELECT w_warehouse_name , \n i_item_id , \n Sum( \n CASE \n WHEN ( \n Cast(d_date AS DATE) < Cast ('2000-05-13' AS DATE)) THEN inv_quantity_on_hand \n ELSE 0 \n END) AS inv_before , \n Sum( \n CASE \n WHEN ( \n Cast(d_date AS DATE) >= Cast ('2000-05-13' AS DATE)) THEN inv_quantity_on_hand \n ELSE 0 \n END) AS inv_after \n FROM inventory , \n warehouse , \n item , \n date_dim \n WHERE i_current_price BETWEEN 0.99 AND 1.49 \n AND i_item_sk = inv_item_sk \n AND inv_warehouse_sk = w_warehouse_sk \n AND inv_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN (Cast ('2000-04-13' AS DATE)) AND ( \n cast ('2000-06-13' AS date)) \n GROUP BY w_warehouse_name, \n i_item_id) x \nWHERE ( \n CASE \n WHEN inv_before > 0 THEN inv_after / inv_before \n ELSE NULL \n END) BETWEEN 2.0/3.0 AND 3.0/2.0 \nORDER BY w_warehouse_name , \n i_item_id \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query21_1570971571","user_email":"nithish.sankaranarayanan@ulb.be"}
