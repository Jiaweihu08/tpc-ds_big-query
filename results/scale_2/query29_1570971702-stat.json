{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"496419","creationTime":"1570971703851","totalBytesProcessed":"1927556006","startTime":"1570971703969","query":{"totalSlotMs":"496419","queryPlan":[{"readMsMax":"70","computeMsMax":"387","waitMsAvg":"2","id":"0","endMs":"1570971704807","waitMsMax":"2","startMs":"1570971704278","waitRatioMax":0.00023724792408066428,"readRatioAvg":0.00830367734282325,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.045907473309608544,"writeMsAvg":"48","status":"COMPLETE","writeMsMax":"48","computeMsAvg":"387","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0056939501779359435,"readMsAvg":"70","waitRatioAvg":0.00023724792408066428,"completedParallelInputs":"1","computeRatioMax":0.045907473309608544,"name":"S00: Input","shuffleOutputBytes":"13796356","recordsWritten":"102000","readRatioMax":0.00830367734282325,"steps":[{"kind":"READ","substeps":["$1:i_item_sk, $2:i_item_id, $3:i_item_desc","FROM item"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.0056939501779359435},{"readMsMax":"23","computeMsMax":"8","waitMsAvg":"1","id":"1","endMs":"1570971704481","waitMsMax":"1","startMs":"1570971704359","waitRatioMax":0.00011862396204033214,"readRatioAvg":0.0027283511269276394,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.0009489916963226571,"writeMsAvg":"75","status":"COMPLETE","writeMsMax":"75","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008896797153024912,"readMsAvg":"23","waitRatioAvg":0.00011862396204033214,"completedParallelInputs":"1","computeRatioMax":0.0009489916963226571,"name":"S01: Input","shuffleOutputBytes":"3964","recordsWritten":"102","readRatioMax":0.0027283511269276394,"steps":[{"kind":"READ","substeps":["$10:s_store_sk, $11:s_store_id, $12:s_store_name","FROM store"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.008896797153024912},{"readMsMax":"14","computeMsMax":"9","waitMsAvg":"18","id":"2","endMs":"1570971704525","waitMsMax":"18","startMs":"1570971704401","waitRatioMax":0.002135231316725979,"readRatioAvg":0.00166073546856465,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0010676156583629894,"writeMsAvg":"48","status":"COMPLETE","writeMsMax":"48","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0056939501779359435,"readMsAvg":"14","waitRatioAvg":0.002135231316725979,"completedParallelInputs":"1","computeRatioMax":0.0010676156583629894,"name":"S02: Input","shuffleOutputBytes":"9864","recordsWritten":"1096","readRatioMax":0.00166073546856465,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_year","FROM date_dim","WHERE in($21, 1998, 1999, 2000)"]},{"kind":"WRITE","substeps":["$20","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.0056939501779359435},{"readMsMax":"13","computeMsMax":"8","waitMsAvg":"2","id":"3","endMs":"1570971704540","waitMsMax":"2","startMs":"1570971704455","waitRatioMax":0.00023724792408066428,"readRatioAvg":0.0015421115065243178,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0009489916963226571,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007117437722419929,"readMsAvg":"13","waitRatioAvg":0.00023724792408066428,"completedParallelInputs":"1","computeRatioMax":0.0009489916963226571,"name":"S03: Input","shuffleOutputBytes":"1098","recordsWritten":"122","readRatioMax":0.0015421115065243178,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_year, $32:d_moy","FROM date_dim","WHERE and(between($32, 4, 7), equal($31, 1998))"]},{"kind":"WRITE","substeps":["$30","TO __stage03_output","BY HASH($30)"]}],"writeRatioAvg":0.0007117437722419929},{"readMsMax":"7","computeMsMax":"9","waitMsAvg":"3","id":"4","endMs":"1570971704542","waitMsMax":"3","startMs":"1570971704481","waitRatioMax":0.00035587188612099647,"readRatioAvg":0.000830367734282325,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0010676156583629894,"writeMsAvg":"34","status":"COMPLETE","writeMsMax":"34","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004033214709371293,"readMsAvg":"7","waitRatioAvg":0.00035587188612099647,"completedParallelInputs":"1","computeRatioMax":0.0010676156583629894,"name":"S04: Input","shuffleOutputBytes":"270","recordsWritten":"30","readRatioMax":0.000830367734282325,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year, $52:d_moy","FROM date_dim","WHERE and(equal($52, 4), equal($51, 1998))"]},{"kind":"WRITE","substeps":["$50","TO __stage04_output","BY HASH($50)"]}],"writeRatioAvg":0.004033214709371293},{"readMsMax":"37","computeMsMax":"5039","waitMsAvg":"12","id":"6","endMs":"1570971707034","waitMsMax":"12","startMs":"1570971704541","waitRatioMax":0.0014234875444839859,"readRatioAvg":0.0043890865954922895,"parallelInputs":"1","recordsRead":"2878330","computeRatioAvg":0.5977461447212337,"writeMsAvg":"38","status":"COMPLETE","writeMsMax":"38","computeMsAvg":"5039","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0045077105575326215,"readMsAvg":"37","waitRatioAvg":0.0014234875444839859,"completedParallelInputs":"1","computeRatioMax":0.5977461447212337,"name":"S06: Input","shuffleOutputBytes":"124157137","recordsWritten":"2776885","readRatioMax":0.0043890865954922895,"steps":[{"kind":"READ","substeps":["$70:sr_returned_date_sk, $71:sr_item_sk, $72:sr_customer_sk, $73:sr_ticket_number, $74:sr_return_quantity","FROM store_returns"]},{"kind":"WRITE","substeps":["$70, $71, $72, $73, $74","TO __stage06_output","BY HASH($72, $71, $73)"]}],"writeRatioAvg":0.0045077105575326215},{"readMsMax":"0","computeMsMax":"44","inputStages":["6"],"waitMsAvg":"15","id":"8","endMs":"1570971709889","waitMsMax":"31","startMs":"1570971707145","waitRatioMax":0.0036773428232502966,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2776885","computeRatioAvg":0.004151838671411625,"writeMsAvg":"188","status":"COMPLETE","writeMsMax":"436","computeMsAvg":"35","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05172004744958482,"readMsAvg":"0","waitRatioAvg":0.0017793594306049821,"completedParallelInputs":"100","computeRatioMax":0.005219454329774615,"name":"S08: Coalesce","shuffleOutputBytes":"124157137","recordsWritten":"2776885","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage06_output"]}],"writeRatioAvg":0.022301304863582443},{"readMsMax":"53","computeMsMax":"8430","inputStages":["8"],"waitMsAvg":"1","id":"9","endMs":"1570971723403","waitMsMax":"2","startMs":"1570971707254","waitRatioMax":0.00023724792408066428,"readRatioAvg":0.003914590747330961,"parallelInputs":"10","recordsRead":"56570962","computeRatioAvg":0.8418742586002372,"writeMsAvg":"33","status":"COMPLETE","writeMsMax":"45","computeMsAvg":"7097","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005338078291814947,"readMsAvg":"33","waitRatioAvg":0.00011862396204033214,"completedParallelInputs":"10","computeRatioMax":1,"name":"S09: Join","shuffleOutputBytes":"149094648","recordsWritten":"2095625","readRatioMax":0.006287069988137604,"steps":[{"kind":"READ","substeps":["$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_customer_sk, $63:ss_store_sk, $64:ss_ticket_number, $65:ss_quantity","FROM store_sales"]},{"kind":"READ","substeps":["$70, $71, $72, $73, $74","FROM __stage08_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $62 = $72, $61 = $71, $64 = $73"]},{"kind":"WRITE","substeps":["$100, $101, $102, $103, $104, $105, $106, $107","TO __stage09_output","BY HASH($106, $105)"]}],"writeRatioAvg":0.003914590747330961},{"readMsMax":"0","computeMsMax":"42","inputStages":["9"],"waitMsAvg":"3","id":"10","endMs":"1570971724314","waitMsMax":"6","startMs":"1570971723466","waitRatioMax":0.0007117437722419929,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2095625","computeRatioAvg":0.004033214709371293,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"154","computeMsAvg":"34","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01826809015421115,"readMsAvg":"0","waitRatioAvg":0.00035587188612099647,"completedParallelInputs":"100","computeRatioMax":0.00498220640569395,"name":"S0A: Coalesce","shuffleOutputBytes":"149094648","recordsWritten":"2095625","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage09_output"]}],"writeRatioAvg":0.0033214709371293},{"readMsMax":"41","computeMsMax":"5874","inputStages":["1","2","3","4","10"],"waitMsAvg":"3","id":"11","endMs":"1570971729102","waitMsMax":"5","startMs":"1570971723488","waitRatioMax":0.0005931198102016608,"readRatioAvg":0.0037959667852906285,"parallelInputs":"8","recordsRead":"31170483","computeRatioAvg":0.5952550415183867,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"5018","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0010676156583629894,"readMsAvg":"32","waitRatioAvg":0.00035587188612099647,"completedParallelInputs":"8","computeRatioMax":0.6967971530249111,"name":"S0B: Join","shuffleOutputBytes":"395","recordsWritten":"6","readRatioMax":0.004863582443653618,"steps":[{"kind":"READ","substeps":["$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_quantity","FROM catalog_sales"]},{"kind":"READ","substeps":["$100, $101, $102, $103, $104, $105, $106, $107","FROM __stage0A_output"]},{"kind":"READ","substeps":["$50","FROM __stage04_output"]},{"kind":"READ","substeps":["$30","FROM __stage03_output"]},{"kind":"READ","substeps":["$20","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage01_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $162 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $150 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $135 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $110 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $41 = $106, $42 = $105"]},{"kind":"WRITE","substeps":["$170, $171, $172, $173, $174, $175","TO __stage0B_output","BY HASH($171)"]}],"writeRatioAvg":0.0005931198102016608},{"readMsMax":"0","computeMsMax":"432","inputStages":["0"],"waitMsAvg":"28","id":"12","endMs":"1570971729469","waitMsMax":"28","startMs":"1570971729212","waitRatioMax":0.0033214709371293,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.05124555160142349,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"25","computeMsAvg":"432","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0029655990510083037,"readMsAvg":"0","waitRatioAvg":0.0033214709371293,"completedParallelInputs":"1","computeRatioMax":0.05124555160142349,"name":"S0C: Repartition","shuffleOutputBytes":"13796356","recordsWritten":"102000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage00_output"]}],"writeRatioAvg":0.0029655990510083037},{"readMsMax":"0","computeMsMax":"11","inputStages":["12","0","11"],"waitMsAvg":"3","id":"13","endMs":"1570971730748","waitMsMax":"6","startMs":"1570971730640","waitRatioMax":0.0007117437722419929,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"6251","computeRatioAvg":0.0007117437722419929,"writeMsAvg":"13","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003202846975088968,"readMsAvg":"0","waitRatioAvg":0.00035587188612099647,"completedParallelInputs":"100","computeRatioMax":0.0013048635824436537,"name":"S0D: Join+","shuffleOutputBytes":"1073","recordsWritten":"6","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$170, $171, $172, $173, $174, $175","FROM __stage0B_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $185, $191 := $186, $192 := $180, $193 := $181","$90 := SHARD_AVG($183)","$91 := SHARD_AVG($184)","$92 := SHARD_AVG($182)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH EACH ON $171 = $1"]},{"kind":"WRITE","substeps":["$190, $191, $192, $193, $90, $91, $92","TO __stage0D_output","BY HASH($190, $191, $192, $193)"]}],"writeRatioAvg":0.0015421115065243178},{"readMsMax":"0","computeMsMax":"3","inputStages":["13"],"waitMsAvg":"1","id":"14","endMs":"1570971730944","waitMsMax":"1","startMs":"1570971730769","waitRatioMax":0.00011862396204033214,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"6","computeRatioAvg":0.00035587188612099647,"writeMsAvg":"156","status":"COMPLETE","writeMsMax":"156","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.018505338078291814,"readMsAvg":"0","waitRatioAvg":0.00011862396204033214,"completedParallelInputs":"1","computeRatioMax":0.00035587188612099647,"name":"S0E: Sort+","shuffleOutputBytes":"947","recordsWritten":"6","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$190, $191, $192, $193, $90, $91, $92","FROM __stage0D_output"]},{"kind":"SORT","substeps":["$200 ASC, $201 ASC, $202 ASC, $203 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $200 := $190, $201 := $191, $202 := $192, $203 := $193","$80 := ROOT_AVG($90)","$81 := ROOT_AVG($91)","$82 := ROOT_AVG($92)"]},{"kind":"WRITE","substeps":["$210, $211, $212, $213, $214, $215, $216","TO __stage0E_output"]}],"writeRatioAvg":0.018505338078291814},{"readMsMax":"0","computeMsMax":"6","inputStages":["14"],"waitMsAvg":"2","id":"15","endMs":"1570971731513","waitMsMax":"2","startMs":"1570971730850","waitRatioMax":0.00023724792408066428,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"6","computeRatioAvg":0.0007117437722419929,"writeMsAvg":"554","status":"COMPLETE","writeMsMax":"554","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.065717674970344,"readMsAvg":"0","waitRatioAvg":0.00023724792408066428,"completedParallelInputs":"1","computeRatioMax":0.0007117437722419929,"name":"S0F: Output","shuffleOutputBytes":"947","recordsWritten":"6","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$210, $211, $212, $213, $214, $215, $216","FROM __stage0E_output"]},{"kind":"SORT","substeps":["$210 ASC, $211 ASC, $212 ASC, $213 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$220, $221, $222, $223, $224, $225, $226","TO __stage0F_output"]}],"writeRatioAvg":0.065717674970344}],"estimatedBytesProcessed":"1927556006","timeline":[{"totalSlotMs":"2426","activeUnits":"20","completedUnits":"4","elapsedMs":"810","pendingUnits":"20"},{"totalSlotMs":"46393","activeUnits":"19","completedUnits":"13","elapsedMs":"2271","pendingUnits":"11"},{"totalSlotMs":"86105","activeUnits":"87","completedUnits":"37","elapsedMs":"3567","pendingUnits":"87"},{"totalSlotMs":"255142","activeUnits":"53","completedUnits":"112","elapsedMs":"5842","pendingUnits":"12"},{"totalSlotMs":"260319","activeUnits":"10","completedUnits":"114","elapsedMs":"6370","pendingUnits":"10"},{"totalSlotMs":"376348","activeUnits":"9","completedUnits":"122","elapsedMs":"18910","pendingUnits":"2"},{"totalSlotMs":"430943","activeUnits":"107","completedUnits":"193","elapsedMs":"20187","pendingUnits":"31"},{"totalSlotMs":"440765","activeUnits":"8","completedUnits":"216","elapsedMs":"20689","pendingUnits":"8"},{"totalSlotMs":"482241","activeUnits":"6","completedUnits":"221","elapsedMs":"24385","pendingUnits":"3"},{"totalSlotMs":"488429","activeUnits":"2","completedUnits":"225","elapsedMs":"25634","pendingUnits":"0"},{"totalSlotMs":"496419","activeUnits":"1","completedUnits":"327","elapsedMs":"27739","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"1928331264","totalPartitionsProcessed":"0","totalBytesProcessed":"1927556006","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570971731735"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query29_1570971702"},"etag":"dTpLLCZEZmVB867sPcW/LQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query29_1570971702?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anoneaebe74a6fadb039c69392a8fe7d7ab799d68b7c","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query29\nSELECT i_item_id, \n i_item_desc, \n s_store_id, \n s_store_name, \n Avg(ss_quantity) AS store_sales_quantity, \n Avg(sr_return_quantity) AS store_returns_quantity, \n Avg(cs_quantity) AS catalog_sales_quantity \nFROM store_sales, \n store_returns, \n catalog_sales, \n date_dim d1, \n date_dim d2, \n date_dim d3, \n store, \n item \nWHERE d1.d_moy = 4 \n AND d1.d_year = 1998 \n AND d1.d_date_sk = ss_sold_date_sk \n AND i_item_sk = ss_item_sk \n AND s_store_sk = ss_store_sk \n AND ss_customer_sk = sr_customer_sk \n AND ss_item_sk = sr_item_sk \n AND ss_ticket_number = sr_ticket_number \n AND sr_returned_date_sk = d2.d_date_sk \n AND d2.d_moy BETWEEN 4 AND 4 + 3 \n AND d2.d_year = 1998 \n AND sr_customer_sk = cs_bill_customer_sk \n AND sr_item_sk = cs_item_sk \n AND cs_sold_date_sk = d3.d_date_sk \n AND d3.d_year IN ( 1998, 1998 + 1, 1998 + 2 ) \nGROUP BY i_item_id, \n i_item_desc, \n s_store_id, \n s_store_name \nORDER BY i_item_id, \n i_item_desc, \n s_store_id, \n s_store_name\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query29_1570971702","user_email":"nithish.sankaranarayanan@ulb.be"}
