{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"36919","creationTime":"1570972393993","totalBytesProcessed":"1784391582","startTime":"1570972394112","query":{"totalSlotMs":"36919","queryPlan":[{"readMsMax":"9","computeMsMax":"7","waitMsAvg":"1","id":"0","endMs":"1570972394297","waitMsMax":"1","startMs":"1570972394259","waitRatioMax":0.000445632798573975,"readRatioAvg":0.004010695187165776,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.0031194295900178253,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00267379679144385,"readMsAvg":"9","waitRatioAvg":0.000445632798573975,"completedParallelInputs":"1","computeRatioMax":0.0031194295900178253,"name":"S00: Input","shuffleOutputBytes":"6480","recordsWritten":"720","readRatioMax":0.004010695187165776,"steps":[{"kind":"READ","substeps":["$10:hd_demo_sk, $11:hd_dep_count, $12:hd_vehicle_count","FROM household_demographics","WHERE or(equal($11, 8), greater($12, 4))"]},{"kind":"WRITE","substeps":["$10","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.00267379679144385},{"readMsMax":"26","computeMsMax":"8","waitMsAvg":"22","id":"1","endMs":"1570972394510","waitMsMax":"22","startMs":"1570972394294","waitRatioMax":0.00980392156862745,"readRatioAvg":0.011586452762923352,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.0035650623885918,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00267379679144385,"readMsAvg":"26","waitRatioAvg":0.00980392156862745,"completedParallelInputs":"1","computeRatioMax":0.0035650623885918,"name":"S01: Input","shuffleOutputBytes":"2234","recordsWritten":"96","readRatioMax":0.011586452762923352,"steps":[{"kind":"READ","substeps":["$30:s_store_sk, $32:s_city, $31:s_number_employees","FROM store","WHERE between($31, 200, 295)"]},{"kind":"WRITE","substeps":["$30, $32","TO __stage01_output","BY HASH($30)"]}],"writeRatioAvg":0.00267379679144385},{"readMsMax":"12","computeMsMax":"9","waitMsAvg":"9","id":"2","endMs":"1570972394585","waitMsMax":"9","startMs":"1570972394297","waitRatioMax":0.004010695187165776,"readRatioAvg":0.0053475935828877,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004010695187165776,"writeMsAvg":"87","status":"COMPLETE","writeMsMax":"87","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03877005347593583,"readMsAvg":"12","waitRatioAvg":0.004010695187165776,"completedParallelInputs":"1","computeRatioMax":0.004010695187165776,"name":"S02: Input","shuffleOutputBytes":"1413","recordsWritten":"157","readRatioMax":0.0053475935828877,"steps":[{"kind":"READ","substeps":["$40:d_date_sk, $41:d_year, $42:d_dow","FROM date_dim","WHERE and(equal($42, 1), in($41, 2000, 2001, 2002))"]},{"kind":"WRITE","substeps":["$40","TO __stage02_output","BY HASH($40)"]}],"writeRatioAvg":0.03877005347593583},{"readMsMax":"138","computeMsMax":"2244","inputStages":["0","1","2"],"waitMsAvg":"1","id":"4","endMs":"1570972396387","waitMsMax":"7","startMs":"1570972394696","waitRatioMax":0.0031194295900178253,"readRatioAvg":0.029857397504456328,"parallelInputs":"10","recordsRead":"28811842","computeRatioAvg":0.8328877005347594,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"71","computeMsAvg":"1869","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03163992869875223,"readMsAvg":"67","waitRatioAvg":0.000445632798573975,"completedParallelInputs":"10","computeRatioMax":1,"name":"S04: Join+","shuffleOutputBytes":"7891802","recordsWritten":"132831","readRatioMax":0.06149732620320856,"steps":[{"kind":"READ","substeps":["$20:ss_sold_date_sk, $21:ss_customer_sk, $22:ss_hdemo_sk, $23:ss_addr_sk, $24:ss_store_sk, $25:ss_ticket_number, $26:ss_coupon_amt, $27:ss_net_profit","FROM store_sales"]},{"kind":"READ","substeps":["$40","FROM __stage02_output"]},{"kind":"READ","substeps":["$30, $32","FROM __stage01_output"]},{"kind":"READ","substeps":["$10","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $120 := $112, $121 := $110, $122 := $111, $123 := $115","$70 := SUM($113)","$71 := SUM($114)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $91 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $83 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $40"]},{"kind":"WRITE","substeps":["$121, $122, $120, $123, $70, $71","TO __stage04_output","BY HASH($120, $121, $122, $123)"]}],"writeRatioAvg":0.009358288770053475},{"readMsMax":"0","computeMsMax":"130","inputStages":["4"],"waitMsAvg":"1","id":"6","endMs":"1570972396604","waitMsMax":"1","startMs":"1570972396498","waitRatioMax":0.000445632798573975,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"132831","computeRatioAvg":0.057932263814616754,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"130","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008912655971479501,"readMsAvg":"0","waitRatioAvg":0.000445632798573975,"completedParallelInputs":"1","computeRatioMax":0.057932263814616754,"name":"S06: Aggregate","shuffleOutputBytes":"1013109","recordsWritten":"20075","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$121, $122, $120, $123, $70, $71","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $130 := $120, $131 := $121, $132 := $122, $133 := $123","$60 := SUM($70)","$61 := SUM($71)"]},{"kind":"WRITE","substeps":["$60, $61, $130, $131, $133","TO __stage06_output","BY HASH($131)"]}],"writeRatioAvg":0.008912655971479501},{"readMsMax":"0","computeMsMax":"9","inputStages":["6"],"waitMsAvg":"2","id":"7","endMs":"1570972396800","waitMsMax":"4","startMs":"1570972396616","waitRatioMax":0.0017825311942959,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"20075","computeRatioAvg":0.0022281639928698753,"writeMsAvg":"103","status":"COMPLETE","writeMsMax":"169","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.07531194295900179,"readMsAvg":"0","waitRatioAvg":0.00089126559714795,"completedParallelInputs":"100","computeRatioMax":0.004010695187165776,"name":"S07: Coalesce","shuffleOutputBytes":"1013109","recordsWritten":"20075","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage06_output"]}],"writeRatioAvg":0.04590017825311943},{"readMsMax":"27","computeMsMax":"205","inputStages":["7"],"waitMsAvg":"4","id":"8","endMs":"1570972396917","waitMsMax":"4","startMs":"1570972396620","waitRatioMax":0.0017825311942959,"readRatioAvg":0.012032085561497326,"parallelInputs":"1","recordsRead":"520075","computeRatioAvg":0.09135472370766488,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"205","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00267379679144385,"readMsAvg":"27","waitRatioAvg":0.0017825311942959,"completedParallelInputs":"1","computeRatioMax":0.09135472370766488,"name":"S08: Join+","shuffleOutputBytes":"4341","recordsWritten":"100","readRatioMax":0.012032085561497326,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_first_name, $3:c_last_name","FROM customer"]},{"kind":"READ","substeps":["$60, $61, $130, $131, $133","FROM __stage07_output"]},{"kind":"SORT","substeps":["$145 ASC, $144 ASC, $50 ASC, $143 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$50 := substr($141, 1, 30)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $131"]},{"kind":"WRITE","substeps":["$150, $151, $152, $153, $154, $155","TO __stage08_output"]}],"writeRatioAvg":0.00267379679144385},{"readMsMax":"0","computeMsMax":"7","inputStages":["8"],"waitMsAvg":"1","id":"9","endMs":"1570972396975","waitMsMax":"1","startMs":"1570972396672","waitRatioMax":0.000445632798573975,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0031194295900178253,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004901960784313725,"readMsAvg":"0","waitRatioAvg":0.000445632798573975,"completedParallelInputs":"1","computeRatioMax":0.0031194295900178253,"name":"S09: Output","shuffleOutputBytes":"4341","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$150, $151, $152, $153, $154, $155","FROM __stage08_output"]},{"kind":"SORT","substeps":["$151 ASC, $150 ASC, $153 ASC, $155 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$160, $161, $162, $163, $164, $165","TO __stage09_output"]}],"writeRatioAvg":0.004901960784313725}],"estimatedBytesProcessed":"1784391582","timeline":[{"totalSlotMs":"1809","activeUnits":"10","completedUnits":"3","elapsedMs":"648","pendingUnits":"10"},{"totalSlotMs":"36588","activeUnits":"2","completedUnits":"114","elapsedMs":"2777","pendingUnits":"2"},{"totalSlotMs":"36919","activeUnits":"2","completedUnits":"116","elapsedMs":"3041","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"1784676352","totalPartitionsProcessed":"0","totalBytesProcessed":"1784391582","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570972397178"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query79_1570972392"},"etag":"+GRRWtNYyCUX4nklxywiNA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query79_1570972392?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon3bbb0c051f07b04130df3f1c14dcd5d320ff4795","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query79\nSELECT c_last_name, \n c_first_name, \n Substr(s_city, 1, 30), \n ss_ticket_number, \n amt, \n profit \nFROM (SELECT ss_ticket_number, \n ss_customer_sk, \n store.s_city, \n Sum(ss_coupon_amt) amt, \n Sum(ss_net_profit) profit \n FROM store_sales, \n date_dim, \n store, \n household_demographics \n WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk \n AND store_sales.ss_store_sk = store.s_store_sk \n AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk \n AND ( household_demographics.hd_dep_count = 8 \n OR household_demographics.hd_vehicle_count > 4 ) \n AND date_dim.d_dow = 1 \n AND date_dim.d_year IN ( 2000, 2000 + 1, 2000 + 2 ) \n AND store.s_number_employees BETWEEN 200 AND 295 \n GROUP BY ss_ticket_number, \n ss_customer_sk, \n ss_addr_sk, \n store.s_city) ms, \n customer \nWHERE ss_customer_sk = c_customer_sk \nORDER BY c_last_name, \n c_first_name, \n Substr(s_city, 1, 30), \n profit\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query79_1570972392","user_email":"nithish.sankaranarayanan@ulb.be"}
