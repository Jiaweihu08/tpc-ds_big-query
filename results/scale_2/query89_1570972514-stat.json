{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"15684","creationTime":"1570972516122","totalBytesProcessed":"896769810","startTime":"1570972516281","query":{"totalSlotMs":"15684","queryPlan":[{"readMsMax":"20","computeMsMax":"6","waitMsAvg":"2","id":"0","endMs":"1570972516577","waitMsMax":"2","startMs":"1570972516525","waitRatioMax":0.0010025062656641604,"readRatioAvg":0.010025062656641603,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.0030075187969924814,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0035087719298245615,"readMsAvg":"20","waitRatioAvg":0.0010025062656641604,"completedParallelInputs":"1","computeRatioMax":0.0030075187969924814,"name":"S00: Input","shuffleOutputBytes":"3046","recordsWritten":"102","readRatioMax":0.010025062656641603,"steps":[{"kind":"READ","substeps":["$1:s_store_sk, $2:s_store_name, $3:s_company_name","FROM store"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.0035087719298245615},{"readMsMax":"10","computeMsMax":"10","waitMsAvg":"20","id":"1","endMs":"1570972516770","waitMsMax":"20","startMs":"1570972516568","waitRatioMax":0.010025062656641603,"readRatioAvg":0.005012531328320802,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.005012531328320802,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010526315789473684,"readMsAvg":"10","waitRatioAvg":0.010025062656641603,"completedParallelInputs":"1","computeRatioMax":0.005012531328320802,"name":"S01: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.005012531328320802,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $22:d_moy, $21:d_year","FROM date_dim","WHERE in($21, 2002)"]},{"kind":"WRITE","substeps":["$20, $22","TO __stage01_output","BY HASH($20)"]}],"writeRatioAvg":0.010526315789473684},{"readMsMax":"17","computeMsMax":"43","waitMsAvg":"22","id":"3","endMs":"1570972516798","waitMsMax":"22","startMs":"1570972516607","waitRatioMax":0.011027568922305764,"readRatioAvg":0.008521303258145364,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.02155388471177945,"writeMsAvg":"95","status":"COMPLETE","writeMsMax":"95","computeMsAvg":"43","shuffleOutputBytesSpilled":"0","writeRatioMax":0.047619047619047616,"readMsAvg":"17","waitRatioAvg":0.011027568922305764,"completedParallelInputs":"1","computeRatioMax":0.02155388471177945,"name":"S03: Input","shuffleOutputBytes":"505054","recordsWritten":"9649","readRatioMax":0.008521303258145364,"steps":[{"kind":"READ","substeps":["$30:i_item_sk, $31:i_brand, $32:i_class, $33:i_category","FROM item","WHERE or(and(in($33, 'Home', 'Men', 'Sports'), in($32, 'paint', 'accessories', 'fitness')), ...)"]},{"kind":"WRITE","substeps":["$30, $31, $32, $33","TO __stage03_output","BY HASH($30)"]}],"writeRatioAvg":0.047619047619047616},{"readMsMax":"41","computeMsMax":"1995","inputStages":["0","1","3"],"waitMsAvg":"1","id":"4","endMs":"1570972517977","waitMsMax":"1","startMs":"1570972516843","waitRatioMax":0.0005012531328320802,"readRatioAvg":0.015538847117794486,"parallelInputs":"10","recordsRead":"28903272","computeRatioAvg":0.7914786967418547,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"1579","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005012531328320802,"readMsAvg":"31","waitRatioAvg":0.0005012531328320802,"completedParallelInputs":"10","computeRatioMax":1,"name":"S04: Join+","shuffleOutputBytes":"3011613","recordsWritten":"36576","readRatioMax":0.02055137844611529,"steps":[{"kind":"READ","substeps":["$10:ss_sold_date_sk, $11:ss_item_sk, $12:ss_store_sk, $13:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$30, $31, $32, $33","FROM __stage03_output"]},{"kind":"READ","substeps":["$20, $22","FROM __stage01_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $110 := $104, $111 := $103, $112 := $102, $113 := $105, $114 := $106, $115 := $101","$70 := SUM($100)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $90 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $83 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $11 = $30"]},{"kind":"WRITE","substeps":["$113, $114, $115, $112, $111, $110, $70","TO __stage04_output","BY HASH($110, $111, $112, $113, $114, $115)"]}],"writeRatioAvg":0.0040100250626566416},{"readMsMax":"0","computeMsMax":"47","inputStages":["4"],"waitMsAvg":"1","id":"5","endMs":"1570972518080","waitMsMax":"1","startMs":"1570972518024","waitRatioMax":0.0005012531328320802,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"36576","computeRatioAvg":0.02355889724310777,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"47","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004511278195488722,"readMsAvg":"0","waitRatioAvg":0.0005012531328320802,"completedParallelInputs":"1","computeRatioMax":0.02355889724310777,"name":"S05: Aggregate","shuffleOutputBytes":"344263","recordsWritten":"4207","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$113, $114, $115, $112, $111, $110, $70","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $120 := $110, $121 := $111, $122 := $112, $123 := $113, $124 := $114, $125 := $115","$60 := SUM($70)"]},{"kind":"WRITE","substeps":["$123, $124, $125, $122, $121, $120, $60","TO __stage05_output","BY HASH($120, $122, $123, $124)"]}],"writeRatioAvg":0.004511278195488722},{"readMsMax":"0","computeMsMax":"0","inputStages":["5"],"waitMsAvg":"0","id":"6","endMs":"1570972518430","waitMsMax":"0","startMs":"1570972518092","waitRatioMax":0,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"0","computeRatioAvg":0,"writeMsAvg":"0","status":"COMPLETE","writeMsMax":"0","computeMsAvg":"0","shuffleOutputBytesSpilled":"0","writeRatioMax":0,"readMsAvg":"0","waitRatioAvg":0,"completedParallelInputs":"0","computeRatioMax":0,"name":"S06: Sort+","shuffleOutputBytes":"0","recordsWritten":"0","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$123, $124, $125, $122, $121, $120, $60","FROM __stage05_output"]},{"kind":"SORT","substeps":["$40 ASC, $140 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$40 := subtract($146, $50)"]},{"kind":"FILTER","substeps":["greater(case_no_value(not_equal($50, 0), divide(abs(subtract($146, $50)), $50), NULL), 0.1)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$50 := AVG($136) OVER (PARTITION BY $135, $133, $130, $131 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)"]},{"kind":"SORT","substeps":["$120 ASC, $122 ASC, $123 ASC, $124 ASC"]},{"kind":"WRITE","substeps":["$150, $151, $152, $153, $154, $155, $156, $157, $158","TO __stage06_output"]}],"writeRatioAvg":0},{"readMsMax":"0","computeMsMax":"4","inputStages":["6"],"waitMsAvg":"1","id":"7","endMs":"1570972518395","waitMsMax":"1","startMs":"1570972518105","waitRatioMax":0.0005012531328320802,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0020050125313283208,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0040100250626566416,"readMsAvg":"0","waitRatioAvg":0.0005012531328320802,"completedParallelInputs":"1","computeRatioMax":0.0020050125313283208,"name":"S07: Output","shuffleOutputBytes":"9113","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$150, $151, $152, $153, $154, $155, $156, $157, $158","FROM __stage06_output"]},{"kind":"SORT","substeps":["$156 ASC, $150 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$160, $161, $162, $163, $164, $165, $166, $167","TO __stage07_output"]}],"writeRatioAvg":0.0040100250626566416}],"estimatedBytesProcessed":"896769810","timeline":[{"totalSlotMs":"2422","activeUnits":"10","completedUnits":"3","elapsedMs":"745","pendingUnits":"10"},{"totalSlotMs":"15684","activeUnits":"1","completedUnits":"15","elapsedMs":"2418","pendingUnits":"1"}],"statementType":"SELECT","totalBytesBilled":"897581056","totalPartitionsProcessed":"0","totalBytesProcessed":"896769810","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_10"}]},"endTime":"1570972518734"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query89_1570972514"},"etag":"rp6stC9KjndfX4MF3vTtzw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query89_1570972514?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonaac3b69e81124251c9df0e60e108533dabf8407f","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query89\nSELECT benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results warmup \nFROM (SELECT i_category, \n i_class, \n i_brand, \n s_store_name, \n s_company_name, \n d_moy, \n Sum(ss_sales_price) sum_sales, \n Avg(Sum(ss_sales_price)) \n OVER ( \n partition BY i_category, i_brand, s_store_name, s_company_name \n ) \n avg_monthly_sales \n FROM item, \n store_sales, \n date_dim, \n store \n WHERE ss_item_sk = i_item_sk \n AND ss_sold_date_sk = d_date_sk \n AND ss_store_sk = s_store_sk \n AND d_year IN ( 2002 ) \n AND ( ( i_category IN ( 'Home', 'Men', 'Sports' ) \n AND i_class IN ( 'paint', 'accessories', 'fitness' ) ) \n OR ( i_category IN ( 'Shoes', 'Jewelry', 'Women' ) \n AND i_class IN ( 'mens', 'pendants', 'swimwear' ) ) ) \n GROUP BY i_category, \n i_class, \n i_brand, \n s_store_name, \n s_company_name, \n d_moy) tmp1 \nWHERE CASE \n WHEN ( avg_monthly_sales <> 0 ) THEN ( \n Abs(sum_sales - avg_monthly_sales) / avg_monthly_sales ) \n ELSE NULL \n END > 0.1 \nORDER BY sum_sales - avg_monthly_sales, \n s_store_name\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query89_1570972514","user_email":"nithish.sankaranarayanan@ulb.be"}
