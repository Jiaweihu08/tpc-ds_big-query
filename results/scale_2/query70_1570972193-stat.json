{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"20051","creationTime":"1570972194578","totalBytesProcessed":"661304639","startTime":"1570972194683","query":{"totalSlotMs":"20051","queryPlan":[{"readMsMax":"8","computeMsMax":"6","waitMsAvg":"28","id":"0","endMs":"1570972194913","waitMsMax":"28","startMs":"1570972194844","waitRatioMax":0.029411764705882353,"readRatioAvg":0.008403361344537815,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0063025210084033615,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0063025210084033615,"readMsAvg":"8","waitRatioAvg":0.029411764705882353,"completedParallelInputs":"1","computeRatioMax":0.0063025210084033615,"name":"S00: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.008403361344537815,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_month_seq","FROM date_dim","WHERE between($51, 1200, 1211)"]},{"kind":"WRITE","substeps":["$50","TO __stage00_output","BY HASH($50)"]}],"writeRatioAvg":0.0063025210084033615},{"readMsMax":"43","computeMsMax":"3","waitMsAvg":"83","id":"1","endMs":"1570972195015","waitMsMax":"83","startMs":"1570972194913","waitRatioMax":0.08718487394957983,"readRatioAvg":0.045168067226890755,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.0031512605042016808,"writeMsAvg":"52","status":"COMPLETE","writeMsMax":"52","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0546218487394958,"readMsAvg":"43","waitRatioAvg":0.08718487394957983,"completedParallelInputs":"1","computeRatioMax":0.0031512605042016808,"name":"S01: Input","shuffleOutputBytes":"1632","recordsWritten":"102","readRatioMax":0.045168067226890755,"steps":[{"kind":"READ","substeps":["$40:s_store_sk, $41:s_state","FROM store"]},{"kind":"WRITE","substeps":["$40, $41","TO __stage01_output","BY HASH($40)"]}],"writeRatioAvg":0.0546218487394958},{"readMsMax":"72","computeMsMax":"896","inputStages":["0","1"],"waitMsAvg":"152","id":"3","endMs":"1570972195762","waitMsMax":"153","startMs":"1570972195210","waitRatioMax":0.16071428571428573,"readRatioAvg":0.03361344537815126,"parallelInputs":"10","recordsRead":"28806792","computeRatioAvg":0.8434873949579832,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"803","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005252100840336135,"readMsAvg":"32","waitRatioAvg":0.15966386554621848,"completedParallelInputs":"10","computeRatioMax":0.9411764705882353,"name":"S03: Join+","shuffleOutputBytes":"480","recordsWritten":"30","readRatioMax":0.07563025210084033,"steps":[{"kind":"READ","substeps":["$30:ss_sold_date_sk, $31:ss_store_sk, $32:ss_net_profit","FROM store_sales"]},{"kind":"READ","substeps":["$40, $41","FROM __stage01_output"]},{"kind":"READ","substeps":["$50","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $160 := $151","$110 := SUM($150)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $140 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $31 = $40"]},{"kind":"WRITE","substeps":["$160, $110","TO __stage03_output","BY HASH($160)"]}],"writeRatioAvg":0.004201680672268907},{"readMsMax":"0","computeMsMax":"9","inputStages":["3"],"waitMsAvg":"40","id":"4","endMs":"1570972195901","waitMsMax":"40","startMs":"1570972195819","waitRatioMax":0.04201680672268908,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"30","computeRatioAvg":0.009453781512605041,"writeMsAvg":"13","status":"COMPLETE","writeMsMax":"13","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01365546218487395,"readMsAvg":"0","waitRatioAvg":0.04201680672268908,"completedParallelInputs":"1","computeRatioMax":0.009453781512605041,"name":"S04: Aggregate","shuffleOutputBytes":"48","recordsWritten":"3","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$160, $110","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $170 := $160","$100 := SUM($110)"]},{"kind":"WRITE","substeps":["$170, $100","TO __stage04_output","BY HASH($170)"]}],"writeRatioAvg":0.01365546218487395},{"readMsMax":"0","computeMsMax":"5","inputStages":["4"],"waitMsAvg":"303","id":"5","endMs":"1570972196413","waitMsMax":"303","startMs":"1570972196235","waitRatioMax":0.3182773109243697,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"3","computeRatioAvg":0.005252100840336135,"writeMsAvg":"166","status":"COMPLETE","writeMsMax":"166","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.17436974789915966,"readMsAvg":"0","waitRatioAvg":0.3182773109243697,"completedParallelInputs":"1","computeRatioMax":0.005252100840336135,"name":"S05: Sort+","shuffleOutputBytes":"21","recordsWritten":"3","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$170, $100","FROM __stage04_output"]},{"kind":"FILTER","substeps":["less_or_equal($90, 5)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$90 := RANK() OVER (PARTITION BY $180 ORDER BY $181 DESC)"]},{"kind":"SORT","substeps":["$170 ASC, $100 DESC"]},{"kind":"WRITE","substeps":["$190","TO __stage05_output","BY HASH($190)"]}],"writeRatioAvg":0.17436974789915966},{"readMsMax":"5","computeMsMax":"6","waitMsAvg":"462","id":"6","endMs":"1570972196490","waitMsMax":"462","startMs":"1570972196413","waitRatioMax":0.4852941176470588,"readRatioAvg":0.005252100840336135,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.0063025210084033615,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01995798319327731,"readMsAvg":"5","waitRatioAvg":0.4852941176470588,"completedParallelInputs":"1","computeRatioMax":0.0063025210084033615,"name":"S06: Input","shuffleOutputBytes":"3633","recordsWritten":"102","readRatioMax":0.005252100840336135,"steps":[{"kind":"READ","substeps":["$1:s_store_sk, $2:s_county, $3:s_state","FROM store"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage06_output","BY HASH($1)"]}],"writeRatioAvg":0.01995798319327731},{"readMsMax":"9","computeMsMax":"6","waitMsAvg":"525","id":"7","endMs":"1570972196588","waitMsMax":"525","startMs":"1570972196491","waitRatioMax":0.5514705882352942,"readRatioAvg":0.009453781512605041,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0063025210084033615,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02100840336134454,"readMsAvg":"9","waitRatioAvg":0.5514705882352942,"completedParallelInputs":"1","computeRatioMax":0.0063025210084033615,"name":"S07: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.009453781512605041,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_month_seq","FROM date_dim","WHERE between($21, 1200, 1211)"]},{"kind":"WRITE","substeps":["$20","TO __stage07_output","BY HASH($20)"]}],"writeRatioAvg":0.02100840336134454},{"readMsMax":"0","computeMsMax":"5","inputStages":["5"],"waitMsAvg":"146","id":"9","endMs":"1570972196806","waitMsMax":"208","startMs":"1570972196636","waitRatioMax":0.2184873949579832,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"3","computeRatioAvg":0.0031512605042016808,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"142","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.14915966386554622,"readMsAvg":"0","waitRatioAvg":0.15336134453781514,"completedParallelInputs":"100","computeRatioMax":0.005252100840336135,"name":"S09: Coalesce","shuffleOutputBytes":"21","recordsWritten":"3","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage05_output"]}],"writeRatioAvg":0.0063025210084033615},{"readMsMax":"36","computeMsMax":"952","inputStages":["9","6","7"],"waitMsAvg":"207","id":"10","endMs":"1570972197527","waitMsMax":"435","startMs":"1570972196800","waitRatioMax":0.4569327731092437,"readRatioAvg":0.026260504201680673,"parallelInputs":"10","recordsRead":"28806822","computeRatioAvg":0.8403361344537815,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"75","computeMsAvg":"800","shuffleOutputBytesSpilled":"0","writeRatioMax":0.07878151260504201,"readMsAvg":"25","waitRatioAvg":0.21743697478991597,"completedParallelInputs":"10","computeRatioMax":1,"name":"S0A: Join+","shuffleOutputBytes":"1070","recordsWritten":"30","readRatioMax":0.037815126050420166,"steps":[{"kind":"READ","substeps":["$10:ss_sold_date_sk, $11:ss_store_sk, $12:ss_net_profit","FROM store_sales"]},{"kind":"READ","substeps":["$20","FROM __stage07_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage06_output"]},{"kind":"READ","substeps":["$190","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $210 := $201, $211 := $200","$80 := SUM($202)"]},{"kind":"JOIN","substeps":["SEMI HASH JOIN EACH WITH ALL ON $132 = $190"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $120 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $10 = $20"]},{"kind":"WRITE","substeps":["$211, $210, $80","TO __stage0A_output","BY HASH($210, $211)"]}],"writeRatioAvg":0.012605042016806723},{"readMsMax":"0","computeMsMax":"6","inputStages":["10"],"waitMsAvg":"329","id":"11","endMs":"1570972197958","waitMsMax":"329","startMs":"1570972197884","waitRatioMax":0.34558823529411764,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"30","computeRatioAvg":0.0063025210084033615,"writeMsAvg":"38","status":"COMPLETE","writeMsMax":"38","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03991596638655462,"readMsAvg":"0","waitRatioAvg":0.34558823529411764,"completedParallelInputs":"1","computeRatioMax":0.0063025210084033615,"name":"S0B: Aggregate","shuffleOutputBytes":"107","recordsWritten":"3","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$211, $210, $80","FROM __stage0A_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $220 := $210, $221 := $211","$70 := SUM($80)"]},{"kind":"WRITE","substeps":["$221, $220, $70","TO __stage0B_output","BY HASH($220, $221)"]}],"writeRatioAvg":0.03991596638655462},{"readMsMax":"0","computeMsMax":"8","inputStages":["11"],"waitMsAvg":"277","id":"12","endMs":"1570972198373","waitMsMax":"277","startMs":"1570972198252","waitRatioMax":0.29096638655462187,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"3","computeRatioAvg":0.008403361344537815,"writeMsAvg":"73","status":"COMPLETE","writeMsMax":"73","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.07668067226890757,"readMsAvg":"0","waitRatioAvg":0.29096638655462187,"completedParallelInputs":"1","computeRatioMax":0.008403361344537815,"name":"S0C: Sort+","shuffleOutputBytes":"134","recordsWritten":"3","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$221, $220, $70","FROM __stage0B_output"]},{"kind":"SORT","substeps":["$241 ASC, $60 ASC","LIMIT 100"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$60 := RANK() OVER (PARTITION BY $231, $230 ORDER BY $232 DESC)"]},{"kind":"SORT","substeps":["$220 ASC, $221 ASC, $70 DESC"]},{"kind":"WRITE","substeps":["$250, $251, $252, $253","TO __stage0C_output"]}],"writeRatioAvg":0.07668067226890757},{"readMsMax":"0","computeMsMax":"10","inputStages":["12"],"waitMsAvg":"383","id":"13","endMs":"1570972198417","waitMsMax":"383","startMs":"1570972198373","waitRatioMax":0.4023109243697479,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"3","computeRatioAvg":0.01050420168067227,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.023109243697478993,"readMsAvg":"0","waitRatioAvg":0.4023109243697479,"completedParallelInputs":"1","computeRatioMax":0.01050420168067227,"name":"S0D: Output","shuffleOutputBytes":"134","recordsWritten":"3","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$250, $251, $252, $253","FROM __stage0C_output"]},{"kind":"SORT","substeps":["$251 ASC, $252 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$260, $261, $262, $263","TO __stage0D_output"]}],"writeRatioAvg":0.023109243697478993}],"estimatedBytesProcessed":"661304639","timeline":[{"totalSlotMs":"661","activeUnits":"10","completedUnits":"2","elapsedMs":"662","pendingUnits":"10"},{"totalSlotMs":"10427","activeUnits":"9","completedUnits":"48","elapsedMs":"2053","pendingUnits":"78"},{"totalSlotMs":"19736","activeUnits":"8","completedUnits":"126","elapsedMs":"3066","pendingUnits":"1"},{"totalSlotMs":"20051","activeUnits":"1","completedUnits":"129","elapsedMs":"3863","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"661651456","totalPartitionsProcessed":"0","totalBytesProcessed":"661304639","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570972198569"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query70_1570972193"},"etag":"Z2Dlwd5vj3vS3FsPesK1EQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query70_1570972193?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon5768293eb01bfe2e5dd5c3b569480d98824c6397","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query70\nSELECT Sum(ss_net_profit) AS total_sum, \n s_state, \n s_county, \n Rank() \n OVER ( \n PARTITION BY s_state, s_county\n ORDER BY Sum(ss_net_profit) DESC) AS rank_within_parent \nFROM store_sales, \n date_dim d1, \n store \nWHERE d1.d_month_seq BETWEEN 1200 AND 1200 + 11 \n AND d1.d_date_sk = ss_sold_date_sk \n AND s_store_sk = ss_store_sk \n AND s_state IN (SELECT s_state \n FROM (SELECT s_state AS \n s_state, \n Rank() \n OVER ( \n partition BY s_state \n ORDER BY Sum(ss_net_profit) DESC) AS \n ranking \n FROM store_sales, \n store, \n date_dim \n WHERE d_month_seq BETWEEN 1200 AND 1200 + 11 \n AND d_date_sk = ss_sold_date_sk \n AND s_store_sk = ss_store_sk \n GROUP BY s_state) tmp1 \n WHERE ranking <= 5) \nGROUP BY s_state, s_county \nORDER BY s_state, \n rank_within_parent\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query70_1570972193","user_email":"nithish.sankaranarayanan@ulb.be"}
