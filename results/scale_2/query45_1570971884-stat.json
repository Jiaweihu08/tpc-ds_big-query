{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"58732","creationTime":"1570971885269","totalBytesProcessed":"247463364","startTime":"1570971885426","query":{"totalSlotMs":"58732","queryPlan":[{"readMsMax":"16","computeMsMax":"24","waitMsAvg":"1","id":"0","endMs":"1570971885637","waitMsMax":"1","startMs":"1570971885579","waitRatioMax":0.00021654395842355997,"readRatioAvg":0.0034647033347769596,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.00519705500216544,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"24","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0017323516673884798,"readMsAvg":"16","waitRatioAvg":0.00021654395842355997,"completedParallelInputs":"1","computeRatioMax":0.00519705500216544,"name":"S00: Input","shuffleOutputBytes":"300","recordsWritten":"10","readRatioMax":0.0034647033347769596,"steps":[{"kind":"READ","substeps":["$21:i_item_id, $20:i_item_sk","FROM item","WHERE in($20, 2, 3, 5, 7, 11, 13, 17, 19, 23, 29)"]},{"kind":"COMPUTE","substeps":["$160 := 1"]},{"kind":"WRITE","substeps":["$21, $160","TO __stage00_output","BY HASH($21)"]}],"writeRatioAvg":0.0017323516673884798},{"readMsMax":"11","computeMsMax":"120","waitMsAvg":"22","id":"1","endMs":"1570971885859","waitMsMax":"22","startMs":"1570971885618","waitRatioMax":0.004763967085318319,"readRatioAvg":0.0023819835426591596,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.0259852750108272,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"120","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0045474231268947595,"readMsAvg":"11","waitRatioAvg":0.004763967085318319,"completedParallelInputs":"1","computeRatioMax":0.0259852750108272,"name":"S01: Input","shuffleOutputBytes":"3060000","recordsWritten":"102000","readRatioMax":0.0023819835426591596,"steps":[{"kind":"READ","substeps":["$10:i_item_sk, $11:i_item_id","FROM item"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.0045474231268947595},{"readMsMax":"13","computeMsMax":"12","waitMsAvg":"1","id":"2","endMs":"1570971885869","waitMsMax":"1","startMs":"1570971885639","waitRatioMax":0.00021654395842355997,"readRatioAvg":0.00281507145950628,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.00259852750108272,"writeMsAvg":"66","status":"COMPLETE","writeMsMax":"66","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01429190125595496,"readMsAvg":"13","waitRatioAvg":0.00021654395842355997,"completedParallelInputs":"1","computeRatioMax":0.00259852750108272,"name":"S02: Input","shuffleOutputBytes":"819","recordsWritten":"91","readRatioMax":0.00281507145950628,"steps":[{"kind":"READ","substeps":["$40:d_date_sk, $41:d_year, $42:d_qoy","FROM date_dim","WHERE and(equal($42, 1), equal($41, 2000))"]},{"kind":"WRITE","substeps":["$40","TO __stage02_output","BY HASH($40)"]}],"writeRatioAvg":0.01429190125595496},{"readMsMax":"16","computeMsMax":"207","waitMsAvg":"35","id":"3","endMs":"1570971886946","waitMsMax":"35","startMs":"1570971885705","waitRatioMax":0.007579038544824599,"readRatioAvg":0.0034647033347769596,"parallelInputs":"1","recordsRead":"250000","computeRatioAvg":0.04482459939367692,"writeMsAvg":"404","status":"COMPLETE","writeMsMax":"404","computeMsAvg":"207","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08748375920311824,"readMsAvg":"16","waitRatioAvg":0.007579038544824599,"completedParallelInputs":"1","computeRatioMax":0.04482459939367692,"name":"S03: Input","shuffleOutputBytes":"6388520","recordsWritten":"250000","readRatioMax":0.0034647033347769596,"steps":[{"kind":"READ","substeps":["$30:ca_address_sk, $31:ca_state, $32:ca_zip","FROM customer_address"]},{"kind":"WRITE","substeps":["$30, $31, $32","TO __stage03_output","BY HASH($30)"]}],"writeRatioAvg":0.08748375920311824},{"readMsMax":"20","computeMsMax":"268","waitMsAvg":"8","id":"4","endMs":"1570971886558","waitMsMax":"8","startMs":"1570971885705","waitRatioMax":0.0017323516673884798,"readRatioAvg":0.0043308791684712,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.058033780857514074,"writeMsAvg":"30","status":"COMPLETE","writeMsMax":"30","computeMsAvg":"268","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0064963187527068,"readMsAvg":"20","waitRatioAvg":0.0017323516673884798,"completedParallelInputs":"1","computeRatioMax":0.058033780857514074,"name":"S04: Input","shuffleOutputBytes":"9000000","recordsWritten":"500000","readRatioMax":0.0043308791684712,"steps":[{"kind":"READ","substeps":["$60:c_customer_sk, $61:c_current_addr_sk","FROM customer"]},{"kind":"WRITE","substeps":["$60, $61","TO __stage04_output","BY HASH($60)"]}],"writeRatioAvg":0.0064963187527068},{"readMsMax":"10","computeMsMax":"15","waitMsAvg":"2","id":"6","endMs":"1570971885746","waitMsMax":"2","startMs":"1570971885722","waitRatioMax":0.00043308791684711995,"readRatioAvg":0.0021654395842356,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.0032481593763534,"writeMsAvg":"2","status":"COMPLETE","writeMsMax":"2","computeMsAvg":"15","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00043308791684711995,"readMsAvg":"10","waitRatioAvg":0.00043308791684711995,"completedParallelInputs":"1","computeRatioMax":0.0032481593763534,"name":"S06: Input","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.0021654395842356,"steps":[{"kind":"READ","substeps":["$2:i_item_id, $1:i_item_sk","FROM item","WHERE in($1, 2, 3, 5, 7, 11, 13, 17, 19, 23, 29)"]},{"kind":"AGGREGATE","substeps":["$110 := SUM($130)"]},{"kind":"COMPUTE","substeps":["$130 := if(is_null($2), 1, 0)"]},{"kind":"WRITE","substeps":["$110","TO __stage06_output"]}],"writeRatioAvg":0.00043308791684711995},{"readMsMax":"0","computeMsMax":"3","inputStages":["6"],"waitMsAvg":"2","id":"7","endMs":"1570971885918","waitMsMax":"2","startMs":"1570971885721","waitRatioMax":0.00043308791684711995,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.00064963187527068,"writeMsAvg":"153","status":"COMPLETE","writeMsMax":"153","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.033131225638804676,"readMsAvg":"0","waitRatioAvg":0.00043308791684711995,"completedParallelInputs":"1","computeRatioMax":0.00064963187527068,"name":"S07: Aggregate","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["$90 := SUM($110)"]},{"kind":"WRITE","substeps":["$90","TO __stage07_output"]}],"writeRatioAvg":0.033131225638804676},{"readMsMax":"0","computeMsMax":"11","inputStages":["0"],"waitMsAvg":"1","id":"9","endMs":"1570971887633","waitMsMax":"3","startMs":"1570971887193","waitRatioMax":0.00064963187527068,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"10","computeRatioAvg":0.0015158077089649198,"writeMsAvg":"177","status":"COMPLETE","writeMsMax":"253","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05478562148116067,"readMsAvg":"0","waitRatioAvg":0.00021654395842355997,"completedParallelInputs":"100","computeRatioMax":0.0023819835426591596,"name":"S09: Coalesce","shuffleOutputBytes":"300","recordsWritten":"10","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage00_output"]}],"writeRatioAvg":0.03832828064097012},{"readMsMax":"29","computeMsMax":"4618","inputStages":["9","1","2","3","4"],"waitMsAvg":"1","id":"10","endMs":"1570971889857","waitMsMax":"1","startMs":"1570971887375","waitRatioMax":0.00021654395842355997,"readRatioAvg":0.005413598960588999,"parallelInputs":"4","recordsRead":"10609434","computeRatioAvg":0.9140320485058467,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"40","computeMsAvg":"4221","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0086617583369424,"readMsAvg":"25","waitRatioAvg":0.00021654395842355997,"completedParallelInputs":"4","computeRatioMax":1,"name":"S0A: Join+","shuffleOutputBytes":"18348014","recordsWritten":"220114","readRatioMax":0.006279774794283239,"steps":[{"kind":"READ","substeps":["$50:ws_sold_date_sk, $51:ws_item_sk, $52:ws_bill_customer_sk, $53:ws_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$60, $61","FROM __stage04_output"]},{"kind":"READ","substeps":["$30, $31, $32","FROM __stage03_output"]},{"kind":"READ","substeps":["$40","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage01_output"]},{"kind":"READ","substeps":["$21, $160","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $224","$120 := ANY_VALUE($140)","$121 := ANY_VALUE($220)","$122 := ANY_VALUE($221)","$123 := ANY_VALUE($222)","$124 := ANY_VALUE($223)"]},{"kind":"COMPUTE","substeps":["$140 := not(is_null($225))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $213 = $21"]},{"kind":"COMPUTE","substeps":["$150 := UNIQUE_ROW_ID()"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $202 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $180 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $173 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $52 = $60"]},{"kind":"WRITE","substeps":["$120, $121, $122, $123, $124, $230","TO __stage0A_output","BY HASH($230)"]}],"writeRatioAvg":0.0034647033347769596},{"readMsMax":"0","computeMsMax":"488","inputStages":["7","10"],"waitMsAvg":"1","id":"11","endMs":"1570971890206","waitMsMax":"1","startMs":"1570971889903","waitRatioMax":0.00021654395842355997,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"220115","computeRatioAvg":0.10567345171069727,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"488","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00129926375054136,"readMsAvg":"0","waitRatioAvg":0.00021654395842355997,"completedParallelInputs":"1","computeRatioMax":0.10567345171069727,"name":"S0B: Aggregate+","shuffleOutputBytes":"1175","recordsWritten":"46","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$90","FROM __stage07_output"]},{"kind":"READ","substeps":["$120, $121, $122, $123, $124, $230","FROM __stage0A_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $250 := $103, $251 := $102","$80 := SUM($104)"]},{"kind":"FILTER","substeps":["or(in(substr($103, 1, 5), '85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792'), ...)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230","$100 := ANY_VALUE($120)","$101 := ANY_VALUE($121)","$102 := ANY_VALUE($122)","$103 := ANY_VALUE($123)","$104 := ANY_VALUE($124)"]},{"kind":"WRITE","substeps":["$80, $251, $250","TO __stage0B_output","BY HASH($250, $251)"]}],"writeRatioAvg":0.00129926375054136},{"readMsMax":"0","computeMsMax":"5","inputStages":["11"],"waitMsAvg":"1","id":"12","endMs":"1570971890309","waitMsMax":"1","startMs":"1570971890231","waitRatioMax":0.00021654395842355997,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"46","computeRatioAvg":0.0010827197921178,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"28","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006063230835859679,"readMsAvg":"0","waitRatioAvg":0.00021654395842355997,"completedParallelInputs":"1","computeRatioMax":0.0010827197921178,"name":"S0C: Sort+","shuffleOutputBytes":"1175","recordsWritten":"46","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$80, $251, $250","FROM __stage0B_output"]},{"kind":"SORT","substeps":["$260 ASC, $261 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $260 := $250, $261 := $251","$70 := SUM($80)"]},{"kind":"WRITE","substeps":["$270, $271, $272","TO __stage0C_output"]}],"writeRatioAvg":0.006063230835859679},{"readMsMax":"0","computeMsMax":"4","inputStages":["12"],"waitMsAvg":"1","id":"13","endMs":"1570971890319","waitMsMax":"1","startMs":"1570971890252","waitRatioMax":0.00021654395842355997,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"46","computeRatioAvg":0.0008661758336942399,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0010827197921178,"readMsAvg":"0","waitRatioAvg":0.00021654395842355997,"completedParallelInputs":"1","computeRatioMax":0.0008661758336942399,"name":"S0D: Output","shuffleOutputBytes":"1175","recordsWritten":"46","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$270, $271, $272","FROM __stage0C_output"]},{"kind":"SORT","substeps":["$272 ASC, $271 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$280, $281, $282","TO __stage0D_output"]}],"writeRatioAvg":0.0010827197921178}],"estimatedBytesProcessed":"247463364","timeline":[{"totalSlotMs":"1968","activeUnits":"6","completedUnits":"5","elapsedMs":"654","pendingUnits":"6"},{"totalSlotMs":"40265","activeUnits":"4","completedUnits":"107","elapsedMs":"2269","pendingUnits":"4"},{"totalSlotMs":"58732","activeUnits":"1","completedUnits":"114","elapsedMs":"5041","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"247463936","totalPartitionsProcessed":"0","totalBytesProcessed":"247463364","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_10"}]},"endTime":"1570971890502"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query45_1570971884"},"etag":"yCLkx/oawwTRc/NS1enJmg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query45_1570971884?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonb12e3197519307cdf6c5b33da558b6b412bfd411","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query45\nSELECT ca_zip, \n ca_state, \n Sum(ws_sales_price) \nFROM web_sales, \n customer, \n customer_address, \n date_dim, \n item \nWHERE ws_bill_customer_sk = c_customer_sk \n AND c_current_addr_sk = ca_address_sk \n AND ws_item_sk = i_item_sk \n AND ( Substr(ca_zip, 1, 5) IN ( '85669', '86197', '88274', '83405', \n '86475', '85392', '85460', '80348', \n '81792' ) \n OR i_item_id IN (SELECT i_item_id \n FROM item \n WHERE i_item_sk IN ( 2, 3, 5, 7, \n 11, 13, 17, 19, \n 23, 29 )) ) \n AND ws_sold_date_sk = d_date_sk \n AND d_qoy = 1 \n AND d_year = 2000 \nGROUP BY ca_zip, \n ca_state \nORDER BY ca_zip, \n ca_state\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query45_1570971884","user_email":"nithish.sankaranarayanan@ulb.be"}
