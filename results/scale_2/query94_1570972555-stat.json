{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"63617","creationTime":"1570972556633","totalBytesProcessed":"413380470","startTime":"1570972556949","query":{"totalSlotMs":"63617","queryPlan":[{"readMsMax":"16","computeMsMax":"442","waitMsAvg":"1","id":"0","endMs":"1570972557480","waitMsMax":"1","startMs":"1570972557190","waitRatioMax":0.0006510416666666666,"readRatioAvg":0.010416666666666666,"parallelInputs":"1","recordsRead":"720202","computeRatioAvg":0.2877604166666667,"writeMsAvg":"64","status":"COMPLETE","writeMsMax":"64","computeMsAvg":"442","shuffleOutputBytesSpilled":"0","writeRatioMax":0.041666666666666664,"readMsAvg":"16","waitRatioAvg":0.0006510416666666666,"completedParallelInputs":"1","computeRatioMax":0.2877604166666667,"name":"S00: Input","shuffleOutputBytes":"6481818","recordsWritten":"720202","readRatioMax":0.010416666666666666,"steps":[{"kind":"READ","substeps":["$1:wr_order_number","FROM web_returns"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.041666666666666664},{"readMsMax":"28","computeMsMax":"1536","waitMsAvg":"22","id":"1","endMs":"1570972558218","waitMsMax":"33","startMs":"1570972557232","waitRatioMax":0.021484375,"readRatioAvg":0.016927083333333332,"parallelInputs":"4","recordsRead":"7201030","computeRatioAvg":0.9427083333333334,"writeMsAvg":"149","status":"COMPLETE","writeMsMax":"233","computeMsAvg":"1448","shuffleOutputBytesSpilled":"0","writeRatioMax":0.15169270833333334,"readMsAvg":"26","waitRatioAvg":0.014322916666666666,"completedParallelInputs":"4","computeRatioMax":1,"name":"S01: Input","shuffleOutputBytes":"129604572","recordsWritten":"7201030","readRatioMax":0.018229166666666668,"steps":[{"kind":"READ","substeps":["$10:ws_warehouse_sk, $11:ws_order_number","FROM web_sales"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage01_output","BY HASH($11)"]}],"writeRatioAvg":0.09700520833333333},{"readMsMax":"23","computeMsMax":"7","waitMsAvg":"1","id":"2","endMs":"1570972557403","waitMsMax":"1","startMs":"1570972557322","waitRatioMax":0.0006510416666666666,"readRatioAvg":0.014973958333333334,"parallelInputs":"1","recordsRead":"42","computeRatioAvg":0.004557291666666667,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00390625,"readMsAvg":"23","waitRatioAvg":0.0006510416666666666,"completedParallelInputs":"1","computeRatioMax":0.004557291666666667,"name":"S02: Input","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.014973958333333334,"steps":[{"kind":"READ","substeps":["$20:web_site_sk, $21:web_company_name","FROM web_site","WHERE equal($21, 'pri')"]},{"kind":"WRITE","substeps":["$20","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.00390625},{"readMsMax":"19","computeMsMax":"10","waitMsAvg":"25","id":"3","endMs":"1570972557446","waitMsMax":"25","startMs":"1570972557363","waitRatioMax":0.016276041666666668,"readRatioAvg":0.012369791666666666,"parallelInputs":"1","recordsRead":"250000","computeRatioAvg":0.006510416666666667,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0032552083333333335,"readMsAvg":"19","waitRatioAvg":0.016276041666666668,"completedParallelInputs":"1","computeRatioMax":0.006510416666666667,"name":"S03: Input","shuffleOutputBytes":"39078","recordsWritten":"4342","readRatioMax":0.012369791666666666,"steps":[{"kind":"READ","substeps":["$40:ca_address_sk, $41:ca_state","FROM customer_address","WHERE equal($41, 'MT')"]},{"kind":"WRITE","substeps":["$40","TO __stage03_output","BY HASH($40)"]}],"writeRatioAvg":0.0032552083333333335},{"readMsMax":"10","computeMsMax":"17","waitMsAvg":"26","id":"4","endMs":"1570972557483","waitMsMax":"26","startMs":"1570972557404","waitRatioMax":0.016927083333333332,"readRatioAvg":0.006510416666666667,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.011067708333333334,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"17","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004557291666666667,"readMsAvg":"10","waitRatioAvg":0.016927083333333332,"completedParallelInputs":"1","computeRatioMax":0.011067708333333334,"name":"S04: Input","shuffleOutputBytes":"558","recordsWritten":"62","readRatioMax":0.006510416666666667,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_date","FROM date_dim","WHERE between(CAST($51 AS DATE), 11017, 11078)"]},{"kind":"WRITE","substeps":["$50","TO __stage04_output","BY HASH($50)"]}],"writeRatioAvg":0.004557291666666667},{"readMsMax":"193","computeMsMax":"1118","inputStages":["2","3","4"],"waitMsAvg":"1","id":"6","endMs":"1570972558536","waitMsMax":"1","startMs":"1570972557668","waitRatioMax":0.0006510416666666666,"readRatioAvg":0.08984375,"parallelInputs":"4","recordsRead":"7218650","computeRatioAvg":0.6451822916666666,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"13","computeMsAvg":"991","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008463541666666666,"readMsAvg":"138","waitRatioAvg":0.0006510416666666666,"completedParallelInputs":"4","computeRatioMax":0.7278645833333334,"name":"S06: Join","shuffleOutputBytes":"6984","recordsWritten":"194","readRatioMax":0.12565104166666666,"steps":[{"kind":"READ","substeps":["$30:ws_ship_date_sk, $31:ws_ship_addr_sk, $32:ws_web_site_sk, $33:ws_warehouse_sk, $34:ws_order_number, $35:ws_ext_ship_cost, $36:ws_net_profit","FROM web_sales"]},{"kind":"READ","substeps":["$50","FROM __stage04_output"]},{"kind":"READ","substeps":["$40","FROM __stage03_output"]},{"kind":"READ","substeps":["$20","FROM __stage02_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $190 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $180 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $30 = $50"]},{"kind":"WRITE","substeps":["$200, $201, $202, $203","TO __stage06_output","BY HASH($201)"]}],"writeRatioAvg":0.00390625},{"readMsMax":"0","computeMsMax":"13","inputStages":["0"],"waitMsAvg":"2","id":"7","endMs":"1570972558901","waitMsMax":"4","startMs":"1570972558540","waitRatioMax":0.0026041666666666665,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"720202","computeRatioAvg":0.005208333333333333,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"110","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.07161458333333333,"readMsAvg":"0","waitRatioAvg":0.0013020833333333333,"completedParallelInputs":"100","computeRatioMax":0.008463541666666666,"name":"S07: Coalesce","shuffleOutputBytes":"6481818","recordsWritten":"720202","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage00_output"]}],"writeRatioAvg":0.013020833333333334},{"readMsMax":"0","computeMsMax":"388","inputStages":["7","1","6"],"waitMsAvg":"1","id":"8","endMs":"1570972558914","waitMsMax":"3","startMs":"1570972558562","waitRatioMax":0.001953125,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"62574400","computeRatioAvg":0.146484375,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"225","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005859375,"readMsAvg":"0","waitRatioAvg":0.0006510416666666666,"completedParallelInputs":"100","computeRatioMax":0.2526041666666667,"name":"S08: Join+","shuffleOutputBytes":"2276","recordsWritten":"97","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$200, $201, $202, $203","FROM __stage06_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage01_output"]},{"kind":"READ","substeps":["$1","FROM __stage07_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $170, $231 := $150","$140 := SUM($152)","$141 := SUM($151)"]},{"kind":"COMPUTE","substeps":["$150 := if(equal($170, 1), $220, NULL)","$151 := if(equal($170, 0), $222, NULL)","$152 := if(equal($170, 0), $221, NULL)"]},{"kind":"COMPUTE","substeps":["$160 := ARRAY<...>"]},{"kind":"JOIN","substeps":["ANTI HASH JOIN EACH WITH ALL ON $211 = $1"]},{"kind":"JOIN","substeps":["SEMI HASH JOIN EACH WITH EACH ON $201 = $11"]},{"kind":"WRITE","substeps":["$140, $141, $231, $230","TO __stage08_output","BY HASH($230, $231)"]}],"writeRatioAvg":0.001953125},{"readMsMax":"0","computeMsMax":"4","inputStages":["8"],"waitMsAvg":"1","id":"9","endMs":"1570972559039","waitMsMax":"1","startMs":"1570972559022","waitRatioMax":0.0006510416666666666,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"97","computeRatioAvg":0.0026041666666666665,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"3","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001953125,"readMsAvg":"0","waitRatioAvg":0.0006510416666666666,"completedParallelInputs":"1","computeRatioMax":0.0026041666666666665,"name":"S09: Aggregate+","shuffleOutputBytes":"56","recordsWritten":"2","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$140, $141, $231, $230","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $250 := $240","$110 := COUNT($122)","$111 := ANY_VALUE($121)","$112 := ANY_VALUE($120)"]},{"kind":"COMPUTE","substeps":["$120 := if(equal($240, 0), $131, NULL)","$121 := if(equal($240, 0), $130, NULL)","$122 := if(equal($240, 1), $241, NULL)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230, $241 := $231","$130 := SUM($140)","$131 := SUM($141)"]},{"kind":"WRITE","substeps":["$110, $111, $112, $250","TO __stage09_output","BY HASH($250)"]}],"writeRatioAvg":0.001953125},{"readMsMax":"0","computeMsMax":"6","inputStages":["9"],"waitMsAvg":"2","id":"10","endMs":"1570972559119","waitMsMax":"2","startMs":"1570972559054","waitRatioMax":0.0013020833333333333,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2","computeRatioAvg":0.00390625,"writeMsAvg":"15","status":"COMPLETE","writeMsMax":"15","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009765625,"readMsAvg":"0","waitRatioAvg":0.0013020833333333333,"completedParallelInputs":"1","computeRatioMax":0.00390625,"name":"S0A: Aggregate+","shuffleOutputBytes":"27","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110, $111, $112, $250","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["$80 := ANY_VALUE($92)","$81 := ANY_VALUE($91)","$82 := ANY_VALUE($90)"]},{"kind":"COMPUTE","substeps":["$90 := if(equal($260, 0), $102, NULL)","$91 := if(equal($260, 0), $101, NULL)","$92 := if(equal($260, 1), $100, NULL)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $260 := $250","$100 := SUM_OF_COUNTS($110)","$101 := ANY_VALUE($111)","$102 := ANY_VALUE($112)"]},{"kind":"WRITE","substeps":["$80, $81, $82","TO __stage0A_output"]}],"writeRatioAvg":0.009765625},{"readMsMax":"0","computeMsMax":"5","inputStages":["10"],"waitMsAvg":"1","id":"11","endMs":"1570972559146","waitMsMax":"1","startMs":"1570972559070","waitRatioMax":0.0006510416666666666,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.0032552083333333335,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00390625,"readMsAvg":"0","waitRatioAvg":0.0006510416666666666,"completedParallelInputs":"1","computeRatioMax":0.0032552083333333335,"name":"S0B: Output","shuffleOutputBytes":"27","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$80, $81, $82","FROM __stage0A_output"]},{"kind":"SORT","substeps":["$60 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$60 := if(is_null($70), 0, $70)"]},{"kind":"AGGREGATE","substeps":["$70 := ANY_VALUE($80)","$71 := ANY_VALUE($81)","$72 := ANY_VALUE($82)"]},{"kind":"WRITE","substeps":["$270, $271, $272","TO __stage0B_output"]}],"writeRatioAvg":0.00390625}],"estimatedBytesProcessed":"413380470","timeline":[{"totalSlotMs":"2050","activeUnits":"8","completedUnits":"4","elapsedMs":"743","pendingUnits":"8"},{"totalSlotMs":"63617","activeUnits":"100","completedUnits":"215","elapsedMs":"2372","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"414187520","totalPartitionsProcessed":"0","totalBytesProcessed":"413380470","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_site","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_returns","datasetId":"scale_10"}]},"endTime":"1570972559359"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query94_1570972555"},"etag":"rpoZDetnc9EutVnUakS2OA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query94_1570972555?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon4bb61e8648434c3f176a45bbb5dc4bea63ee070b","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query94\nSELECT \n Count(DISTINCT ws_order_number) AS order_count, \n Sum(ws_ext_ship_cost) AS total_shipping_cost , \n Sum(ws_net_profit) AS total_net_profit\nFROM web_sales ws1 , \n date_dim , \n customer_address , \n web_site \nWHERE Cast(d_date AS DATE) BETWEEN Cast('2000-3-01' AS DATE) AND ( \n Cast('2000-5-01' AS DATE)) \nAND ws1.ws_ship_date_sk = d_date_sk \nAND ws1.ws_ship_addr_sk = ca_address_sk \nAND ca_state = 'MT' \nAND ws1.ws_web_site_sk = web_site_sk \nAND web_company_name = 'pri' \nAND EXISTS \n ( \n SELECT benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results warmup \n FROM web_sales ws2 \n WHERE ws1.ws_order_number = ws2.ws_order_number \n AND ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) \nAND NOT EXISTS \n ( \n SELECT benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results warmup \n FROM web_returns wr1 \n WHERE ws1.ws_order_number = wr1.wr_order_number) \nORDER BY count(DISTINCT ws_order_number) \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query94_1570972555","user_email":"nithish.sankaranarayanan@ulb.be"}
