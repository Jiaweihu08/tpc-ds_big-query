{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"221804","creationTime":"1570971902527","totalBytesProcessed":"895774581","startTime":"1570971902653","query":{"totalSlotMs":"221804","queryPlan":[{"readMsMax":"9","computeMsMax":"5","waitMsAvg":"1","id":"0","endMs":"1570971902991","waitMsMax":"1","startMs":"1570971902916","waitRatioMax":0.00016545334215751158,"readRatioAvg":0.0014890800794176043,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.0008272667107875579,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0028127068166776967,"readMsAvg":"9","waitRatioAvg":0.00016545334215751158,"completedParallelInputs":"1","computeRatioMax":0.0008272667107875579,"name":"S00: Input","shuffleOutputBytes":"3046","recordsWritten":"102","readRatioMax":0.0014890800794176043,"steps":[{"kind":"READ","substeps":["$80:s_store_sk, $81:s_store_name, $82:s_company_name","FROM store"]},{"kind":"WRITE","substeps":["$80, $81, $82","TO __stage00_output","BY HASH($80)"]}],"writeRatioAvg":0.0028127068166776967},{"readMsMax":"13","computeMsMax":"15","waitMsAvg":"26","id":"1","endMs":"1570971903139","waitMsMax":"26","startMs":"1570971902961","waitRatioMax":0.004301786896095301,"readRatioAvg":0.0021508934480476507,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.002481800132362674,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"15","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001158173395102581,"readMsAvg":"13","waitRatioAvg":0.004301786896095301,"completedParallelInputs":"1","computeRatioMax":0.002481800132362674,"name":"S01: Input","shuffleOutputBytes":"11529","recordsWritten":"427","readRatioMax":0.0021508934480476507,"steps":[{"kind":"READ","substeps":["$110:d_date_sk, $111:d_year, $112:d_moy","FROM date_dim","WHERE or(equal($111, 1999), and(equal($111, 1998), equal($112, 12)), and(equal($111, 2000), equal($112, 1)))"]},{"kind":"WRITE","substeps":["$110, $111, $112","TO __stage01_output","BY HASH($110)"]}],"writeRatioAvg":0.001158173395102581},{"readMsMax":"9","computeMsMax":"97","waitMsAvg":"35","id":"3","endMs":"1570971903214","waitMsMax":"35","startMs":"1570971903005","waitRatioMax":0.005790866975512905,"readRatioAvg":0.0014890800794176043,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.016048974189278625,"writeMsAvg":"142","status":"COMPLETE","writeMsMax":"142","computeMsAvg":"97","shuffleOutputBytesSpilled":"0","writeRatioMax":0.023494374586366645,"readMsAvg":"9","waitRatioAvg":0.005790866975512905,"completedParallelInputs":"1","computeRatioMax":0.016048974189278625,"name":"S03: Input","shuffleOutputBytes":"4180043","recordsWritten":"102000","readRatioMax":0.0014890800794176043,"steps":[{"kind":"READ","substeps":["$90:i_item_sk, $91:i_brand, $92:i_category","FROM item"]},{"kind":"WRITE","substeps":["$90, $91, $92","TO __stage03_output","BY HASH($90)"]}],"writeRatioAvg":0.023494374586366645},{"readMsMax":"6","computeMsMax":"5","waitMsAvg":"14","id":"4","endMs":"1570971903195","waitMsMax":"14","startMs":"1570971903006","waitRatioMax":0.002316346790205162,"readRatioAvg":0.0009927200529450694,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.0008272667107875579,"writeMsAvg":"172","status":"COMPLETE","writeMsMax":"172","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.028457974851091992,"readMsAvg":"6","waitRatioAvg":0.002316346790205162,"completedParallelInputs":"1","computeRatioMax":0.0008272667107875579,"name":"S04: Input","shuffleOutputBytes":"3046","recordsWritten":"102","readRatioMax":0.0009927200529450694,"steps":[{"kind":"READ","substeps":["$10:s_store_sk, $11:s_store_name, $12:s_company_name","FROM store"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage04_output","BY HASH($10)"]}],"writeRatioAvg":0.028457974851091992},{"readMsMax":"11","computeMsMax":"14","waitMsAvg":"1","id":"5","endMs":"1570971903198","waitMsMax":"1","startMs":"1570971903010","waitRatioMax":0.00016545334215751158,"readRatioAvg":0.0018199867637326275,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.002316346790205162,"writeMsAvg":"160","status":"COMPLETE","writeMsMax":"160","computeMsAvg":"14","shuffleOutputBytesSpilled":"0","writeRatioMax":0.026472534745201854,"readMsAvg":"11","waitRatioAvg":0.00016545334215751158,"completedParallelInputs":"1","computeRatioMax":0.002316346790205162,"name":"S05: Input","shuffleOutputBytes":"11529","recordsWritten":"427","readRatioMax":0.0018199867637326275,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_year, $72:d_moy","FROM date_dim","WHERE or(equal($71, 1999), and(equal($71, 1998), equal($72, 12)), and(equal($71, 2000), equal($72, 1)))"]},{"kind":"WRITE","substeps":["$70, $71, $72","TO __stage05_output","BY HASH($70)"]}],"writeRatioAvg":0.026472534745201854},{"readMsMax":"9","computeMsMax":"83","waitMsAvg":"2","id":"7","endMs":"1570971903216","waitMsMax":"2","startMs":"1570971903139","waitRatioMax":0.00033090668431502316,"readRatioAvg":0.0014890800794176043,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.01373262739907346,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"83","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0018199867637326275,"readMsAvg":"9","waitRatioAvg":0.00033090668431502316,"completedParallelInputs":"1","computeRatioMax":0.01373262739907346,"name":"S07: Input","shuffleOutputBytes":"4180043","recordsWritten":"102000","readRatioMax":0.0014890800794176043,"steps":[{"kind":"READ","substeps":["$50:i_item_sk, $51:i_brand, $52:i_category","FROM item"]},{"kind":"WRITE","substeps":["$50, $51, $52","TO __stage07_output","BY HASH($50)"]}],"writeRatioAvg":0.0018199867637326275},{"readMsMax":"5","computeMsMax":"6","waitMsAvg":"1","id":"8","endMs":"1570971903241","waitMsMax":"1","startMs":"1570971903158","waitRatioMax":0.00016545334215751158,"readRatioAvg":0.0008272667107875579,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.0009927200529450694,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00314361350099272,"readMsAvg":"5","waitRatioAvg":0.00016545334215751158,"completedParallelInputs":"1","computeRatioMax":0.0009927200529450694,"name":"S08: Input","shuffleOutputBytes":"3046","recordsWritten":"102","readRatioMax":0.0008272667107875579,"steps":[{"kind":"READ","substeps":["$1:s_store_sk, $2:s_store_name, $3:s_company_name","FROM store"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage08_output","BY HASH($1)"]}],"writeRatioAvg":0.00314361350099272},{"readMsMax":"70","computeMsMax":"20","waitMsAvg":"1","id":"9","endMs":"1570971903271","waitMsMax":"1","startMs":"1570971903177","waitRatioMax":0.00016545334215751158,"readRatioAvg":0.01158173395102581,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0033090668431502318,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"20","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0006618133686300463,"readMsAvg":"70","waitRatioAvg":0.00016545334215751158,"completedParallelInputs":"1","computeRatioMax":0.0033090668431502318,"name":"S09: Input","shuffleOutputBytes":"11529","recordsWritten":"427","readRatioMax":0.01158173395102581,"steps":[{"kind":"READ","substeps":["$40:d_date_sk, $41:d_year, $42:d_moy","FROM date_dim","WHERE or(equal($41, 1999), and(equal($41, 1998), equal($42, 12)), and(equal($41, 2000), equal($42, 1)))"]},{"kind":"WRITE","substeps":["$40, $41, $42","TO __stage09_output","BY HASH($40)"]}],"writeRatioAvg":0.0006618133686300463},{"readMsMax":"14","computeMsMax":"90","waitMsAvg":"1","id":"11","endMs":"1570971903281","waitMsMax":"1","startMs":"1570971903208","waitRatioMax":0.00016545334215751158,"readRatioAvg":0.002316346790205162,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.014890800794176042,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"90","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0013236267372600927,"readMsAvg":"14","waitRatioAvg":0.00016545334215751158,"completedParallelInputs":"1","computeRatioMax":0.014890800794176042,"name":"S0B: Input","shuffleOutputBytes":"4180043","recordsWritten":"102000","readRatioMax":0.002316346790205162,"steps":[{"kind":"READ","substeps":["$20:i_item_sk, $21:i_brand, $22:i_category","FROM item"]},{"kind":"WRITE","substeps":["$20, $21, $22","TO __stage0B_output","BY HASH($20)"]}],"writeRatioAvg":0.0013236267372600927},{"readMsMax":"46","computeMsMax":"6044","inputStages":["0","1","3"],"waitMsAvg":"1","id":"12","endMs":"1570971906720","waitMsMax":"2","startMs":"1570971903255","waitRatioMax":0.00033090668431502316,"readRatioAvg":0.0054599602911978825,"parallelInputs":"10","recordsRead":"29827402","computeRatioAvg":0.8034414295168762,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"36","computeMsAvg":"4856","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005956320317670417,"readMsAvg":"33","waitRatioAvg":0.00016545334215751158,"completedParallelInputs":"10","computeRatioMax":1,"name":"S0C: Join+","shuffleOutputBytes":"80956710","recordsWritten":"1000877","readRatioMax":0.007610853739245533,"steps":[{"kind":"READ","substeps":["$100:ss_sold_date_sk, $101:ss_item_sk, $102:ss_store_sk, $103:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$90, $91, $92","FROM __stage03_output"]},{"kind":"READ","substeps":["$110, $111, $112","FROM __stage01_output"]},{"kind":"READ","substeps":["$80, $81, $82","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $290 := $281, $291 := $280, $292 := $285, $293 := $286, $294 := $283, $295 := $284","$240 := SUM($282)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $272 = $80"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $252 = $110"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $101 = $90"]},{"kind":"WRITE","substeps":["$292, $293, $291, $290, $294, $295, $240","TO __stage0C_output","BY HASH($290, $291, $292, $293, $294, $295)"]}],"writeRatioAvg":0.004632693580410324},{"readMsMax":"41","computeMsMax":"5502","inputStages":["4","5","7"],"waitMsAvg":"1","id":"13","endMs":"1570971906358","waitMsMax":"2","startMs":"1570971903357","waitRatioMax":0.00033090668431502316,"readRatioAvg":0.004798146922567836,"parallelInputs":"10","recordsRead":"29827402","computeRatioAvg":0.7877233620119126,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"35","computeMsAvg":"4761","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005790866975512905,"readMsAvg":"29","waitRatioAvg":0.00016545334215751158,"completedParallelInputs":"10","computeRatioMax":0.9103242885506287,"name":"S0D: Join+","shuffleOutputBytes":"80956710","recordsWritten":"1000877","readRatioMax":0.0067835870284579745,"steps":[{"kind":"READ","substeps":["$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_store_sk, $63:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$50, $51, $52","FROM __stage07_output"]},{"kind":"READ","substeps":["$70, $71, $72","FROM __stage05_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $390 := $381, $391 := $380, $392 := $385, $393 := $386, $394 := $383, $395 := $384","$220 := SUM($382)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $372 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $352 = $70"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $61 = $50"]},{"kind":"WRITE","substeps":["$392, $393, $391, $390, $394, $395, $220","TO __stage0D_output","BY HASH($390, $391, $392, $393, $394, $395)"]}],"writeRatioAvg":0.003970880211780278},{"readMsMax":"58","computeMsMax":"5755","inputStages":["8","9","11"],"waitMsAvg":"2","id":"14","endMs":"1570971906724","waitMsMax":"4","startMs":"1570971903380","waitRatioMax":0.0006618133686300463,"readRatioAvg":0.005625413633355393,"parallelInputs":"10","recordsRead":"29827402","computeRatioAvg":0.7779616148246195,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"4702","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003970880211780278,"readMsAvg":"34","waitRatioAvg":0.00033090668431502316,"completedParallelInputs":"10","computeRatioMax":0.9521839841164792,"name":"S0E: Join+","shuffleOutputBytes":"80956710","recordsWritten":"1000877","readRatioMax":0.009596293845135672,"steps":[{"kind":"READ","substeps":["$30:ss_sold_date_sk, $31:ss_item_sk, $32:ss_store_sk, $33:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$20, $21, $22","FROM __stage0B_output"]},{"kind":"READ","substeps":["$40, $41, $42","FROM __stage09_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $480 := $471, $481 := $470, $482 := $475, $483 := $476, $484 := $473, $485 := $474","$210 := SUM($472)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $462 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $442 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $31 = $20"]},{"kind":"WRITE","substeps":["$482, $483, $481, $480, $484, $485, $210","TO __stage0E_output","BY HASH($480, $481, $482, $483, $484, $485)"]}],"writeRatioAvg":0.0018199867637326275},{"readMsMax":"0","computeMsMax":"2278","inputStages":["13"],"waitMsAvg":"1","id":"15","endMs":"1570971907623","waitMsMax":"1","startMs":"1570971906442","waitRatioMax":0.00016545334215751158,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1000877","computeRatioAvg":0.3769027134348114,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"26","computeMsAvg":"2278","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004301786896095301,"readMsAvg":"0","waitRatioAvg":0.00016545334215751158,"completedParallelInputs":"1","computeRatioMax":0.3769027134348114,"name":"S0F: Aggregate","shuffleOutputBytes":"10180404","recordsWritten":"125874","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$392, $393, $391, $390, $394, $395, $220","FROM __stage0D_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $400 := $390, $401 := $391, $402 := $392, $403 := $393, $404 := $394, $405 := $395","$200 := SUM($220)"]},{"kind":"WRITE","substeps":["$402, $403, $401, $400, $404, $405, $200","TO __stage0F_output","BY HASH($400, $401, $402, $403)"]}],"writeRatioAvg":0.004301786896095301},{"readMsMax":"0","computeMsMax":"2067","inputStages":["12"],"waitMsAvg":"2","id":"16","endMs":"1570971907881","waitMsMax":"2","startMs":"1570971906808","waitRatioMax":0.00033090668431502316,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1000877","computeRatioAvg":0.34199205823957646,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"25","computeMsAvg":"2067","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00413633355393779,"readMsAvg":"0","waitRatioAvg":0.00033090668431502316,"completedParallelInputs":"1","computeRatioMax":0.34199205823957646,"name":"S10: Aggregate","shuffleOutputBytes":"10180404","recordsWritten":"125874","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$292, $293, $291, $290, $294, $295, $240","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $300 := $290, $301 := $291, $302 := $292, $303 := $293, $304 := $294, $305 := $295","$230 := SUM($240)"]},{"kind":"WRITE","substeps":["$302, $303, $301, $300, $304, $305, $230","TO __stage10_output","BY HASH($300, $301, $302, $303, $304)"]}],"writeRatioAvg":0.00413633355393779},{"readMsMax":"0","computeMsMax":"2212","inputStages":["14"],"waitMsAvg":"1","id":"17","endMs":"1570971908022","waitMsMax":"1","startMs":"1570971906827","waitRatioMax":0.00016545334215751158,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1000877","computeRatioAvg":0.36598279285241564,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"26","computeMsAvg":"2212","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004301786896095301,"readMsAvg":"0","waitRatioAvg":0.00016545334215751158,"completedParallelInputs":"1","computeRatioMax":0.36598279285241564,"name":"S11: Aggregate","shuffleOutputBytes":"10180404","recordsWritten":"125874","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$482, $483, $481, $480, $484, $485, $210","FROM __stage0E_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $490 := $480, $491 := $481, $492 := $482, $493 := $483, $494 := $484, $495 := $485","$180 := SUM($210)"]},{"kind":"WRITE","substeps":["$492, $493, $491, $490, $494, $495, $180","TO __stage11_output","BY HASH($490, $491, $492, $493)"]}],"writeRatioAvg":0.004301786896095301},{"readMsMax":"0","computeMsMax":"892","inputStages":["16"],"waitMsAvg":"1","id":"18","endMs":"1570971908857","waitMsMax":"1","startMs":"1570971908254","waitRatioMax":0.00016545334215751158,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"125874","computeRatioAvg":0.14758438120450032,"writeMsAvg":"100","status":"COMPLETE","writeMsMax":"100","computeMsAvg":"892","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01654533421575116,"readMsAvg":"0","waitRatioAvg":0.00016545334215751158,"completedParallelInputs":"1","computeRatioMax":0.14758438120450032,"name":"S12: Sort+","shuffleOutputBytes":"11313238","recordsWritten":"125874","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$302, $303, $301, $300, $304, $305, $230","FROM __stage10_output"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$190 := AVG($316) OVER (PARTITION BY $313, $312, $310, $311, $314 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)"]},{"kind":"SORT","substeps":["$300 ASC, $301 ASC, $302 ASC, $303 ASC, $304 ASC"]},{"kind":"WRITE","substeps":["$320, $321, $322, $323, $324, $325, $190, $326","TO __stage12_output","BY HASH($323, $322, $320, $321)"]}],"writeRatioAvg":0.01654533421575116},{"readMsMax":"0","computeMsMax":"940","inputStages":["17"],"waitMsAvg":"2","id":"19","endMs":"1570971909599","waitMsMax":"2","startMs":"1570971909005","waitRatioMax":0.00033090668431502316,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"125874","computeRatioAvg":0.1555261416280609,"writeMsAvg":"53","status":"COMPLETE","writeMsMax":"53","computeMsAvg":"940","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008769027134348115,"readMsAvg":"0","waitRatioAvg":0.00033090668431502316,"completedParallelInputs":"1","computeRatioMax":0.1555261416280609,"name":"S13: Sort+","shuffleOutputBytes":"8707272","recordsWritten":"120054","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$492, $493, $491, $490, $494, $495, $180","FROM __stage11_output"]},{"kind":"COMPUTE","substeps":["$130 := subtract($150, 1)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$150 := RANK() OVER (PARTITION BY $503, $502, $500, $501 ORDER BY $504 ASC, $505 ASC)"]},{"kind":"SORT","substeps":["$490 ASC, $491 ASC, $492 ASC, $493 ASC, $494 ASC, $495 ASC"]},{"kind":"WRITE","substeps":["$130, $510, $511, $512, $513, $514","TO __stage13_output","BY HASH($513, $512, $510, $511, $130)"]}],"writeRatioAvg":0.008769027134348115},{"readMsMax":"0","computeMsMax":"497","inputStages":["18"],"waitMsAvg":"5","id":"21","endMs":"1570971909326","waitMsMax":"5","startMs":"1570971909039","waitRatioMax":0.0008272667107875579,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"125874","computeRatioAvg":0.08223031105228326,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"497","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0038054268696227664,"readMsAvg":"0","waitRatioAvg":0.0008272667107875579,"completedParallelInputs":"1","computeRatioMax":0.08223031105228326,"name":"S15: Sort+","shuffleOutputBytes":"9439660","recordsWritten":"94887","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$320, $321, $322, $323, $324, $325, $190, $326","FROM __stage12_output"]},{"kind":"FILTER","substeps":["and(equal($344, 1999), greater($346, 0), ...)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$160 := RANK() OVER (PARTITION BY $333, $332, $330, $331 ORDER BY $334 ASC, $335 ASC)"]},{"kind":"SORT","substeps":["$323 ASC, $322 ASC, $320 ASC, $321 ASC, $324 ASC, $325 ASC"]},{"kind":"WRITE","substeps":["$160, $340, $341, $342, $343, $344, $345, $346, $347","TO __stage15_output","BY HASH($343, $342, $340, $341, $160)"]}],"writeRatioAvg":0.0038054268696227664},{"readMsMax":"0","computeMsMax":"11","inputStages":["21"],"waitMsAvg":"7","id":"22","endMs":"1570971910053","waitMsMax":"12","startMs":"1570971909361","waitRatioMax":0.001985440105890139,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"94887","computeRatioAvg":0.001158173395102581,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"62","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010258107213765718,"readMsAvg":"0","waitRatioAvg":0.001158173395102581,"completedParallelInputs":"100","computeRatioMax":0.0018199867637326275,"name":"S16: Coalesce","shuffleOutputBytes":"9439660","recordsWritten":"94887","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage15_output"]}],"writeRatioAvg":0.0029781601588352085},{"readMsMax":"0","computeMsMax":"11","inputStages":["19"],"waitMsAvg":"2","id":"24","endMs":"1570971909920","waitMsMax":"5","startMs":"1570971909663","waitRatioMax":0.0008272667107875579,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"120054","computeRatioAvg":0.001158173395102581,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"45","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007445400397088021,"readMsAvg":"0","waitRatioAvg":0.00033090668431502316,"completedParallelInputs":"100","computeRatioMax":0.0018199867637326275,"name":"S18: Coalesce","shuffleOutputBytes":"8707272","recordsWritten":"120054","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage13_output"]}],"writeRatioAvg":0.0028127068166776967},{"readMsMax":"0","computeMsMax":"1530","inputStages":["15","24","22"],"waitMsAvg":"5","id":"25","endMs":"1570971910845","waitMsMax":"5","startMs":"1570971909668","waitRatioMax":0.0008272667107875579,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"340815","computeRatioAvg":0.25314361350099274,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"1530","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0008272667107875579,"readMsAvg":"0","waitRatioAvg":0.0008272667107875579,"completedParallelInputs":"1","computeRatioMax":0.25314361350099274,"name":"S19: Join+","shuffleOutputBytes":"7297","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$402, $403, $401, $400, $404, $405, $200","FROM __stage0F_output"]},{"kind":"READ","substeps":["$160, $340, $341, $342, $343, $344, $345, $346, $347","FROM __stage16_output"]},{"kind":"READ","substeps":["$130, $510, $511, $512, $513, $514","FROM __stage18_output"]},{"kind":"SORT","substeps":["$120 ASC, $522 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$120 := subtract($525, $523)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $433 = $513, $432 = $512, $430 = $510, $431 = $511, $436 = $130"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $423 = $343, $422 = $342, $420 = $340, $421 = $341, $140 = $160"]},{"kind":"COMPUTE","substeps":["$140 := add($170, 1)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$170 := RANK() OVER (PARTITION BY $413, $412, $410, $411 ORDER BY $414 ASC, $415 ASC)"]},{"kind":"SORT","substeps":["$400 ASC, $401 ASC, $402 ASC, $403 ASC, $404 ASC, $405 ASC"]},{"kind":"WRITE","substeps":["$530, $531, $532, $533, $534, $535, $536, $537","TO __stage19_output"]}],"writeRatioAvg":0.0008272667107875579},{"readMsMax":"0","computeMsMax":"5","inputStages":["25"],"waitMsAvg":"4","id":"26","endMs":"1570971911069","waitMsMax":"4","startMs":"1570971909686","waitRatioMax":0.0006618133686300463,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0008272667107875579,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0014890800794176043,"readMsAvg":"0","waitRatioAvg":0.0006618133686300463,"completedParallelInputs":"1","computeRatioMax":0.0008272667107875579,"name":"S1A: Output","shuffleOutputBytes":"6397","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$530, $531, $532, $533, $534, $535, $536, $537","FROM __stage19_output"]},{"kind":"SORT","substeps":["$533 ASC, $532 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$540, $541, $542, $543, $544, $545, $546","TO __stage1A_output"]}],"writeRatioAvg":0.0014890800794176043}],"estimatedBytesProcessed":"895774581","timeline":[{"totalSlotMs":"3269","activeUnits":"30","completedUnits":"9","elapsedMs":"768","pendingUnits":"30"},{"totalSlotMs":"144536","activeUnits":"26","completedUnits":"29","elapsedMs":"3448","pendingUnits":"10"},{"totalSlotMs":"156929","activeUnits":"5","completedUnits":"39","elapsedMs":"4570","pendingUnits":"3"},{"totalSlotMs":"162188","activeUnits":"1","completedUnits":"42","elapsedMs":"6103","pendingUnits":"1"},{"totalSlotMs":"198379","activeUnits":"89","completedUnits":"160","elapsedMs":"7211","pendingUnits":"87"},{"totalSlotMs":"221804","activeUnits":"2","completedUnits":"247","elapsedMs":"8695","pendingUnits":"0"},{"totalSlotMs":"221804","activeUnits":"0","completedUnits":"247","elapsedMs":"8889","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"896532480","totalPartitionsProcessed":"0","totalBytesProcessed":"895774581","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570971911565"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query47_1570971901"},"etag":"eXh8Vqequr/lKCZTMc/TKQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query47_1570971901?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon605d57e7bfbef298cf376c4640e694be5303c581","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query47\nWITH v1 \n AS (SELECT i_category, \n i_brand, \n s_store_name, \n s_company_name, \n d_year, \n d_moy, \n Sum(ss_sales_price) sum_sales, \n Avg(Sum(ss_sales_price)) \n OVER ( \n partition BY i_category, i_brand, s_store_name, \n s_company_name, \n d_year) \n avg_monthly_sales, \n Rank() \n OVER ( \n partition BY i_category, i_brand, s_store_name, \n s_company_name \n ORDER BY d_year, d_moy) rn \n FROM item, \n store_sales, \n date_dim, \n store \n WHERE ss_item_sk = i_item_sk \n AND ss_sold_date_sk = d_date_sk \n AND ss_store_sk = s_store_sk \n AND ( d_year = 1999 \n OR ( d_year = 1999 - 1 \n AND d_moy = 12 ) \n OR ( d_year = 1999 + 1 \n AND d_moy = 1 ) ) \n GROUP BY i_category, \n i_brand, \n s_store_name, \n s_company_name, \n d_year, \n d_moy), \n v2 \n AS (SELECT v1.i_category, \n v1.d_year, \n v1.d_moy, \n v1.avg_monthly_sales, \n v1.sum_sales, \n v1_lag.sum_sales psum, \n v1_lead.sum_sales nsum \n FROM v1, \n v1 v1_lag, \n v1 v1_lead \n WHERE v1.i_category = v1_lag.i_category \n AND v1.i_category = v1_lead.i_category \n AND v1.i_brand = v1_lag.i_brand \n AND v1.i_brand = v1_lead.i_brand \n AND v1.s_store_name = v1_lag.s_store_name \n AND v1.s_store_name = v1_lead.s_store_name \n AND v1.s_company_name = v1_lag.s_company_name \n AND v1.s_company_name = v1_lead.s_company_name \n AND v1.rn = v1_lag.rn + 1 \n AND v1.rn = v1_lead.rn - 1) \nSELECT benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results warmup \nFROM v2 \nWHERE d_year = 1999 \n AND avg_monthly_sales > 0 \n AND CASE \n WHEN avg_monthly_sales > 0 THEN Abs(sum_sales - avg_monthly_sales) \n / \n avg_monthly_sales \n ELSE NULL \n END > 0.1 \nORDER BY sum_sales - avg_monthly_sales, \n 3\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query47_1570971901","user_email":"nithish.sankaranarayanan@ulb.be"}
