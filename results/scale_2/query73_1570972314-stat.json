{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"144989","creationTime":"1570972315892","totalBytesProcessed":"1128285040","startTime":"1570972316096","query":{"totalSlotMs":"144989","queryPlan":[{"readMsMax":"25","computeMsMax":"9","waitMsAvg":"1","id":"0","endMs":"1570972316320","waitMsMax":"1","startMs":"1570972316277","waitRatioMax":0.001040582726326743,"readRatioAvg":0.026014568158168574,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.009365244536940686,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006243496357960458,"readMsAvg":"25","waitRatioAvg":0.001040582726326743,"completedParallelInputs":"1","computeRatioMax":0.009365244536940686,"name":"S00: Input","shuffleOutputBytes":"9360","recordsWritten":"1040","readRatioMax":0.026014568158168574,"steps":[{"kind":"READ","substeps":["$10:hd_demo_sk, $11:hd_buy_potential, $12:hd_dep_count, $13:hd_vehicle_count","FROM household_demographics","WHERE and(or(equal($11, '>10000'), equal($11, '0-500')), greater($13, 0), ...)"]},{"kind":"WRITE","substeps":["$10","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.006243496357960458},{"readMsMax":"23","computeMsMax":"8","waitMsAvg":"24","id":"1","endMs":"1570972316542","waitMsMax":"24","startMs":"1570972316318","waitRatioMax":0.02497398543184183,"readRatioAvg":0.023933402705515087,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.008324661810613945,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005202913631633715,"readMsAvg":"23","waitRatioAvg":0.02497398543184183,"completedParallelInputs":"1","computeRatioMax":0.008324661810613945,"name":"S01: Input","shuffleOutputBytes":"306","recordsWritten":"34","readRatioMax":0.023933402705515087,"steps":[{"kind":"READ","substeps":["$30:s_store_sk, $31:s_county","FROM store","WHERE in($31, 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County')"]},{"kind":"WRITE","substeps":["$30","TO __stage01_output","BY HASH($30)"]}],"writeRatioAvg":0.005202913631633715},{"readMsMax":"10","computeMsMax":"10","waitMsAvg":"11","id":"2","endMs":"1570972316483","waitMsMax":"11","startMs":"1570972316321","waitRatioMax":0.011446409989594173,"readRatioAvg":0.01040582726326743,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.01040582726326743,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006243496357960458,"readMsAvg":"10","waitRatioAvg":0.011446409989594173,"completedParallelInputs":"1","computeRatioMax":0.01040582726326743,"name":"S02: Input","shuffleOutputBytes":"648","recordsWritten":"72","readRatioMax":0.01040582726326743,"steps":[{"kind":"READ","substeps":["$40:d_date_sk, $41:d_year, $42:d_dom","FROM date_dim","WHERE and(between($42, 1, 2), in($41, 2000, 2001, 2002))"]},{"kind":"WRITE","substeps":["$40","TO __stage02_output","BY HASH($40)"]}],"writeRatioAvg":0.006243496357960458},{"readMsMax":"78","computeMsMax":"961","inputStages":["0","1","2"],"waitMsAvg":"1","id":"5","endMs":"1570972317226","waitMsMax":"1","startMs":"1570972316600","waitRatioMax":0.001040582726326743,"readRatioAvg":0.05202913631633715,"parallelInputs":"10","recordsRead":"28813572","computeRatioAvg":0.8917793964620188,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"16","computeMsAvg":"857","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01664932362122789,"readMsAvg":"50","waitRatioAvg":0.001040582726326743,"completedParallelInputs":"10","computeRatioMax":1,"name":"S05: Join+","shuffleOutputBytes":"840124","recordsWritten":"31204","readRatioMax":0.08116545265348596,"steps":[{"kind":"READ","substeps":["$20:ss_sold_date_sk, $21:ss_customer_sk, $22:ss_hdemo_sk, $23:ss_store_sk, $24:ss_ticket_number","FROM store_sales"]},{"kind":"READ","substeps":["$40","FROM __stage02_output"]},{"kind":"READ","substeps":["$30","FROM __stage01_output"]},{"kind":"READ","substeps":["$10","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $100 := $91, $101 := $90","$60 := COUNT_STAR()"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $81 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $72 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $40"]},{"kind":"WRITE","substeps":["$101, $100, $60","TO __stage05_output","BY HASH($100, $101)"]}],"writeRatioAvg":0.006243496357960458},{"readMsMax":"0","computeMsMax":"20","inputStages":["5"],"waitMsAvg":"3","id":"7","endMs":"1570972317349","waitMsMax":"3","startMs":"1570972317267","waitRatioMax":0.003121748178980229,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"31204","computeRatioAvg":0.02081165452653486,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"20","shuffleOutputBytesSpilled":"0","writeRatioMax":0.019771071800208116,"readMsAvg":"0","waitRatioAvg":0.003121748178980229,"completedParallelInputs":"1","computeRatioMax":0.02081165452653486,"name":"S07: Aggregate+","shuffleOutputBytes":"270","recordsWritten":"10","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$101, $100, $60","FROM __stage05_output"]},{"kind":"FILTER","substeps":["between($50, 1, 5)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $110 := $100, $111 := $101","$50 := SUM_OF_COUNTS($60)"]},{"kind":"WRITE","substeps":["$50, $110, $111","TO __stage07_output","BY HASH($111)"]}],"writeRatioAvg":0.019771071800208116},{"readMsMax":"0","computeMsMax":"13","inputStages":["7"],"waitMsAvg":"2","id":"8","endMs":"1570972318989","waitMsMax":"6","startMs":"1570972317363","waitRatioMax":0.006243496357960458,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"10","computeRatioAvg":0.006243496357960458,"writeMsAvg":"37","status":"COMPLETE","writeMsMax":"83","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08636836628511967,"readMsAvg":"0","waitRatioAvg":0.002081165452653486,"completedParallelInputs":"100","computeRatioMax":0.013527575442247659,"name":"S08: Coalesce","shuffleOutputBytes":"270","recordsWritten":"10","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage07_output"]}],"writeRatioAvg":0.03850156087408949},{"readMsMax":"30","computeMsMax":"154","inputStages":["8"],"waitMsAvg":"2","id":"9","endMs":"1570972319111","waitMsMax":"2","startMs":"1570972317396","waitRatioMax":0.002081165452653486,"readRatioAvg":0.031217481789802288,"parallelInputs":"1","recordsRead":"500010","computeRatioAvg":0.16024973985431842,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"154","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004162330905306972,"readMsAvg":"30","waitRatioAvg":0.002081165452653486,"completedParallelInputs":"1","computeRatioMax":0.16024973985431842,"name":"S09: Join","shuffleOutputBytes":"552","recordsWritten":"10","readRatioMax":0.031217481789802288,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_salutation, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag","FROM customer"]},{"kind":"READ","substeps":["$50, $110, $111","FROM __stage08_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $111"]},{"kind":"WRITE","substeps":["$122, $123, $124, $125, $120, $121","TO __stage09_output"]}],"writeRatioAvg":0.004162330905306972},{"readMsMax":"0","computeMsMax":"6","inputStages":["9"],"waitMsAvg":"1","id":"10","endMs":"1570972319397","waitMsMax":"1","startMs":"1570972319344","waitRatioMax":0.001040582726326743,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"10","computeRatioAvg":0.006243496357960458,"writeMsAvg":"31","status":"COMPLETE","writeMsMax":"31","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03225806451612903,"readMsAvg":"0","waitRatioAvg":0.001040582726326743,"completedParallelInputs":"1","computeRatioMax":0.006243496357960458,"name":"S0A: Output","shuffleOutputBytes":"552","recordsWritten":"10","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$122, $123, $124, $125, $120, $121","FROM __stage09_output"]},{"kind":"SORT","substeps":["$121 DESC, $124 ASC"]},{"kind":"WRITE","substeps":["$130, $131, $132, $133, $134, $135","TO __stage0A_output"]}],"writeRatioAvg":0.03225806451612903}],"estimatedBytesProcessed":"1128285040","timeline":[{"totalSlotMs":"1462","activeUnits":"10","completedUnits":"3","elapsedMs":"682","pendingUnits":"10"},{"totalSlotMs":"13088","activeUnits":"101","completedUnits":"14","elapsedMs":"1428","pendingUnits":"101"},{"totalSlotMs":"144989","activeUnits":"1","completedUnits":"116","elapsedMs":"3483","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"1129316352","totalPartitionsProcessed":"0","totalBytesProcessed":"1128285040","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570972319621"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query73_1570972314"},"etag":"oFwLPgSCDjBCmwa/Hw+acA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query73_1570972314?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anond596bce55b22c7b9d8515d5a672a8a2dfe599f50","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query73\nSELECT c_last_name, \n c_first_name, \n c_salutation, \n c_preferred_cust_flag, \n ss_ticket_number, \n cnt \nFROM (SELECT ss_ticket_number, \n ss_customer_sk, \n Count(*) cnt \n FROM store_sales, \n date_dim, \n store, \n household_demographics \n WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk \n AND store_sales.ss_store_sk = store.s_store_sk \n AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk \n AND date_dim.d_dom BETWEEN 1 AND 2 \n AND ( household_demographics.hd_buy_potential = '>10000' \n OR household_demographics.hd_buy_potential = '0-500' ) \n AND household_demographics.hd_vehicle_count > 0 \n AND CASE \n WHEN household_demographics.hd_vehicle_count > 0 THEN \n household_demographics.hd_dep_count / \n household_demographics.hd_vehicle_count \n ELSE NULL \n END > 1 \n AND date_dim.d_year IN ( 2000, 2000 + 1, 2000 + 2 ) \n AND store.s_county IN ( 'Williamson County', 'Williamson County', \n 'Williamson County', \n 'Williamson County' \n ) \n GROUP BY ss_ticket_number, \n ss_customer_sk) dj, \n customer \nWHERE ss_customer_sk = c_customer_sk \n AND cnt BETWEEN 1 AND 5 \nORDER BY cnt DESC, \n c_last_name ASC; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query73_1570972314","user_email":"nithish.sankaranarayanan@ulb.be"}
