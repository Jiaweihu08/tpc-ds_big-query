{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"10753","creationTime":"1570972356905","totalBytesProcessed":"1583319904","startTime":"1570972357064","query":{"totalSlotMs":"10753","queryPlan":[{"readMsMax":"14","computeMsMax":"50","waitMsAvg":"1","id":"0","endMs":"1570972357269","waitMsMax":"1","startMs":"1570972357216","waitRatioMax":0.0016181229773462784,"readRatioAvg":0.022653721682847898,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.08090614886731391,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"50","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012944983818770227,"readMsAvg":"14","waitRatioAvg":0.0016181229773462784,"completedParallelInputs":"1","computeRatioMax":0.08090614886731391,"name":"S00: Input","shuffleOutputBytes":"1972323","recordsWritten":"73049","readRatioMax":0.022653721682847898,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_year, $22:d_qoy","FROM date_dim"]},{"kind":"WRITE","substeps":["$20, $21, $22","TO __stage00_output","BY HASH($20)"]}],"writeRatioAvg":0.012944983818770227},{"readMsMax":"10","computeMsMax":"67","waitMsAvg":"25","id":"1","endMs":"1570972357322","waitMsMax":"25","startMs":"1570972357258","waitRatioMax":0.040453074433656956,"readRatioAvg":0.016181229773462782,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.10841423948220065,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"67","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01779935275080906,"readMsAvg":"10","waitRatioAvg":0.040453074433656956,"completedParallelInputs":"1","computeRatioMax":0.10841423948220065,"name":"S01: Input","shuffleOutputBytes":"2027460","recordsWritten":"102000","readRatioMax":0.016181229773462782,"steps":[{"kind":"READ","substeps":["$50:i_item_sk, $51:i_category","FROM item"]},{"kind":"WRITE","substeps":["$50, $51","TO __stage01_output","BY HASH($50)"]}],"writeRatioAvg":0.01779935275080906},{"readMsMax":"11","computeMsMax":"51","waitMsAvg":"30","id":"3","endMs":"1570972357484","waitMsMax":"30","startMs":"1570972357302","waitRatioMax":0.04854368932038835,"readRatioAvg":0.01779935275080906,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0825242718446602,"writeMsAvg":"141","status":"COMPLETE","writeMsMax":"141","computeMsAvg":"51","shuffleOutputBytesSpilled":"0","writeRatioMax":0.22815533980582525,"readMsAvg":"11","waitRatioAvg":0.04854368932038835,"completedParallelInputs":"1","computeRatioMax":0.0825242718446602,"name":"S03: Input","shuffleOutputBytes":"1972323","recordsWritten":"73049","readRatioMax":0.01779935275080906,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $11:d_year, $12:d_qoy","FROM date_dim"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage03_output","BY HASH($10)"]}],"writeRatioAvg":0.22815533980582525},{"readMsMax":"16","computeMsMax":"91","waitMsAvg":"12","id":"4","endMs":"1570972357520","waitMsMax":"12","startMs":"1570972357302","waitRatioMax":0.019417475728155338,"readRatioAvg":0.025889967637540454,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.14724919093851133,"writeMsAvg":"151","status":"COMPLETE","writeMsMax":"151","computeMsAvg":"91","shuffleOutputBytesSpilled":"0","writeRatioMax":0.24433656957928804,"readMsAvg":"16","waitRatioAvg":0.019417475728155338,"completedParallelInputs":"1","computeRatioMax":0.14724919093851133,"name":"S04: Input","shuffleOutputBytes":"2027460","recordsWritten":"102000","readRatioMax":0.025889967637540454,"steps":[{"kind":"READ","substeps":["$40:i_item_sk, $41:i_category","FROM item"]},{"kind":"WRITE","substeps":["$40, $41","TO __stage04_output","BY HASH($40)"]}],"writeRatioAvg":0.24433656957928804},{"readMsMax":"9","computeMsMax":"54","waitMsAvg":"3","id":"6","endMs":"1570972357456","waitMsMax":"3","startMs":"1570972357404","waitRatioMax":0.0048543689320388345,"readRatioAvg":0.014563106796116505,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.08737864077669903,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"54","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012944983818770227,"readMsAvg":"9","waitRatioAvg":0.0048543689320388345,"completedParallelInputs":"1","computeRatioMax":0.08737864077669903,"name":"S06: Input","shuffleOutputBytes":"1972323","recordsWritten":"73049","readRatioMax":0.014563106796116505,"steps":[{"kind":"READ","substeps":["$1:d_date_sk, $2:d_year, $3:d_qoy","FROM date_dim"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage06_output","BY HASH($1)"]}],"writeRatioAvg":0.012944983818770227},{"readMsMax":"11","computeMsMax":"60","waitMsAvg":"1","id":"7","endMs":"1570972357471","waitMsMax":"1","startMs":"1570972357416","waitRatioMax":0.0016181229773462784,"readRatioAvg":0.01779935275080906,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.0970873786407767,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"60","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01779935275080906,"readMsAvg":"11","waitRatioAvg":0.0016181229773462784,"completedParallelInputs":"1","computeRatioMax":0.0970873786407767,"name":"S07: Input","shuffleOutputBytes":"2027460","recordsWritten":"102000","readRatioMax":0.01779935275080906,"steps":[{"kind":"READ","substeps":["$30:i_item_sk, $31:i_category","FROM item"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage07_output","BY HASH($30)"]}],"writeRatioAvg":0.01779935275080906},{"readMsMax":"196","computeMsMax":"618","inputStages":["0","1","3","7","4","6"],"waitMsAvg":"1","id":"9","endMs":"1570972358108","waitMsMax":"1","startMs":"1570972357566","waitRatioMax":0.0016181229773462784,"readRatioAvg":0.0825242718446602,"parallelInputs":"22","recordsRead":"54251543","computeRatioAvg":0.540453074433657,"writeMsAvg":"13","status":"COMPLETE","writeMsMax":"162","computeMsAvg":"334","shuffleOutputBytesSpilled":"0","writeRatioMax":0.2621359223300971,"readMsAvg":"51","waitRatioAvg":0.0016181229773462784,"completedParallelInputs":"22","computeRatioMax":1,"name":"S09: Join+","shuffleOutputBytes":"339261","recordsWritten":"4552","readRatioMax":0.31715210355987056,"steps":[{"kind":"READ","substeps":["$60:ss_sold_date_sk, $61:ss_item_sk, $63:ss_ext_sales_price, $62:ss_hdemo_sk","FROM store_sales","WHERE is_null($62)"]},{"kind":"READ","substeps":["$30, $31","FROM __stage07_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage06_output"]},{"kind":"READ","substeps":["$70:ws_sold_date_sk, $71:ws_item_sk, $73:ws_ext_sales_price, $72:ws_ship_hdemo_sk","FROM web_sales","WHERE is_null($72)"]},{"kind":"READ","substeps":["$40, $41","FROM __stage04_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage03_output"]},{"kind":"READ","substeps":["$80:cs_sold_date_sk, $82:cs_item_sk, $83:cs_ext_sales_price, $81:cs_warehouse_sk","FROM catalog_sales","WHERE is_null($81)"]},{"kind":"READ","substeps":["$50, $51","FROM __stage01_output"]},{"kind":"READ","substeps":["$20, $21, $22","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $210 := $110, $211 := $111, $212 := $112, $213 := $113, $214 := $114","$100 := COUNT_STAR()","$101 := SUM($115)"]},{"kind":"COMPUTE","substeps":["$120 := 'store'","$121 := 'ss_hdemo_sk'"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $150 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $61 = $30"]},{"kind":"COMPUTE","substeps":["$130 := 'web'","$131 := 'ws_ship_hdemo_sk'"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $170 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $71 = $40"]},{"kind":"COMPUTE","substeps":["$140 := 'catalog'","$141 := 'cs_warehouse_sk'"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $190 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $82 = $50"]},{"kind":"WRITE","substeps":["$100, $101, $210, $211, $212, $213, $214","TO __stage09_output","BY HASH($210, $211, $212, $213, $214)"]}],"writeRatioAvg":0.021035598705501618},{"readMsMax":"0","computeMsMax":"10","inputStages":["9"],"waitMsAvg":"1","id":"10","endMs":"1570972358289","waitMsMax":"1","startMs":"1570972358123","waitRatioMax":0.0016181229773462784,"readRatioAvg":0,"parallelInputs":"2","recordsRead":"4552","computeRatioAvg":0.014563106796116505,"writeMsAvg":"112","status":"COMPLETE","writeMsMax":"117","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.18932038834951456,"readMsAvg":"0","waitRatioAvg":0.0016181229773462784,"completedParallelInputs":"2","computeRatioMax":0.016181229773462782,"name":"S0A: Sort+","shuffleOutputBytes":"15586","recordsWritten":"200","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$100, $101, $210, $211, $212, $213, $214","FROM __stage09_output"]},{"kind":"SORT","substeps":["$220 ASC, $221 ASC, $222 ASC, $223 ASC, $224 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $220 := $210, $221 := $211, $222 := $212, $223 := $213, $224 := $214","$90 := SUM_OF_COUNTS($100)","$91 := SUM($101)"]},{"kind":"WRITE","substeps":["$230, $231, $232, $233, $234, $235, $236","TO __stage0A_output"]}],"writeRatioAvg":0.18122977346278318},{"readMsMax":"0","computeMsMax":"5","inputStages":["10"],"waitMsAvg":"4","id":"11","endMs":"1570972358383","waitMsMax":"4","startMs":"1570972358158","waitRatioMax":0.006472491909385114,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"200","computeRatioAvg":0.008090614886731391,"writeMsAvg":"33","status":"COMPLETE","writeMsMax":"33","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05339805825242718,"readMsAvg":"0","waitRatioAvg":0.006472491909385114,"completedParallelInputs":"1","computeRatioMax":0.008090614886731391,"name":"S0B: Output","shuffleOutputBytes":"7783","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$230, $231, $232, $233, $234, $235, $236","FROM __stage0A_output"]},{"kind":"SORT","substeps":["$232 ASC, $233 ASC, $234 ASC, $235 ASC, $236 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$240, $241, $242, $243, $244, $245, $246","TO __stage0B_output"]}],"writeRatioAvg":0.05339805825242718}],"estimatedBytesProcessed":"1583319904","timeline":[{"totalSlotMs":"3805","activeUnits":"20","completedUnits":"8","elapsedMs":"653","pendingUnits":"20"},{"totalSlotMs":"10436","activeUnits":"3","completedUnits":"28","elapsedMs":"1162","pendingUnits":"3"},{"totalSlotMs":"10753","activeUnits":"3","completedUnits":"31","elapsedMs":"2620","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"1583349760","totalPartitionsProcessed":"0","totalBytesProcessed":"1583319904","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570972359710"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query76_1570972355"},"etag":"E1fsVr7KpK0b+ZpT68LfAw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query76_1570972355?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon49253e0c71e3173b5d120b8cfedcc54667fd3a24","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query76\nSELECT channel, \n col_name, \n d_year, \n d_qoy, \n i_category, \n Count(*) sales_cnt, \n Sum(ext_sales_price) sales_amt \nFROM (SELECT 'store' AS channel, \n 'ss_hdemo_sk' col_name, \n d_year, \n d_qoy, \n i_category, \n ss_ext_sales_price ext_sales_price \n FROM store_sales, \n item, \n date_dim \n WHERE ss_hdemo_sk IS NULL \n AND ss_sold_date_sk = d_date_sk \n AND ss_item_sk = i_item_sk \n UNION ALL \n SELECT 'web' AS channel, \n 'ws_ship_hdemo_sk' col_name, \n d_year, \n d_qoy, \n i_category, \n ws_ext_sales_price ext_sales_price \n FROM web_sales, \n item, \n date_dim \n WHERE ws_ship_hdemo_sk IS NULL \n AND ws_sold_date_sk = d_date_sk \n AND ws_item_sk = i_item_sk \n UNION ALL \n SELECT 'catalog' AS channel, \n 'cs_warehouse_sk' col_name, \n d_year, \n d_qoy, \n i_category, \n cs_ext_sales_price ext_sales_price \n FROM catalog_sales, \n item, \n date_dim \n WHERE cs_warehouse_sk IS NULL \n AND cs_sold_date_sk = d_date_sk \n AND cs_item_sk = i_item_sk) foo \nGROUP BY channel, \n col_name, \n d_year, \n d_qoy, \n i_category \nORDER BY channel, \n col_name, \n d_year, \n d_qoy, \n i_category\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query76_1570972355","user_email":"nithish.sankaranarayanan@ulb.be"}
