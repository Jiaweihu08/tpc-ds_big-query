{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"542152","creationTime":"1570992599578","totalBytesProcessed":"6094791364","startTime":"1570992599759","query":{"totalSlotMs":"542152","queryPlan":[{"readMsMax":"21","computeMsMax":"20","waitMsAvg":"1","id":"0","endMs":"1570992600063","waitMsMax":"1","startMs":"1570992600012","waitRatioMax":1.9322177995903697e-05,"readRatioAvg":0.0004057657379139777,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.00038644355991807397,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"20","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00015457742396722958,"readMsAvg":"21","waitRatioAvg":1.9322177995903697e-05,"completedParallelInputs":"1","computeRatioMax":0.00038644355991807397,"name":"S00: Input","shuffleOutputBytes":"1488","recordsWritten":"62","readRatioMax":0.0004057657379139777,"steps":[{"kind":"READ","substeps":["$1:d_date_sk, $2:d_date","FROM date_dim","WHERE between(CAST($2 AS DATE), 11808, 11869)"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.00015457742396722958},{"readMsMax":"16","computeMsMax":"31","waitMsAvg":"25","id":"1","endMs":"1570992600123","waitMsMax":"25","startMs":"1570992600055","waitRatioMax":0.00048305444989759245,"readRatioAvg":0.00030915484793445915,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.0005989875178730147,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"31","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00036712138192217025,"readMsAvg":"16","waitRatioAvg":0.00048305444989759245,"completedParallelInputs":"1","computeRatioMax":0.0005989875178730147,"name":"S01: Input","shuffleOutputBytes":"383490","recordsWritten":"12783","readRatioMax":0.00030915484793445915,"steps":[{"kind":"READ","substeps":["$20:i_item_sk, $21:i_item_id, $22:i_current_price","FROM item","WHERE between($22, 0.99, 1.49)"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage01_output","BY HASH($20)"]}],"writeRatioAvg":0.00036712138192217025},{"readMsMax":"11","computeMsMax":"10","waitMsAvg":"14","id":"2","endMs":"1570992600257","waitMsMax":"14","startMs":"1570992600063","waitRatioMax":0.00027051049194265177,"readRatioAvg":0.00021254395795494067,"parallelInputs":"1","recordsRead":"15","computeRatioAvg":0.00019322177995903698,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00044441009390578507,"readMsAvg":"11","waitRatioAvg":0.00027051049194265177,"completedParallelInputs":"1","computeRatioMax":0.00019322177995903698,"name":"S02: Input","shuffleOutputBytes":"234","recordsWritten":"15","readRatioMax":0.00021254395795494067,"steps":[{"kind":"READ","substeps":["$10:w_warehouse_sk, $11:w_state","FROM warehouse"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage02_output","BY HASH($10)"]}],"writeRatioAvg":0.00044441009390578507},{"readMsMax":"167","computeMsMax":"3653","waitMsAvg":"30","id":"3","endMs":"1570992602701","waitMsMax":"31","startMs":"1570992600098","waitRatioMax":0.0005989875178730147,"readRatioAvg":0.0022220504695289254,"parallelInputs":"6","recordsRead":"14398596","computeRatioAvg":0.05943501951539978,"writeMsAvg":"124","status":"COMPLETE","writeMsMax":"413","computeMsAvg":"3076","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007980059512308228,"readMsAvg":"115","waitRatioAvg":0.000579665339877111,"completedParallelInputs":"6","computeRatioMax":0.07058391621903622,"name":"S03: Input","shuffleOutputBytes":"386462828","recordsWritten":"14398596","readRatioMax":0.0032268037253159174,"steps":[{"kind":"READ","substeps":["$40:cr_item_sk, $41:cr_order_number, $42:cr_refunded_cash","FROM catalog_returns"]},{"kind":"WRITE","substeps":["$40, $41, $42","TO __stage03_output","BY HASH($41, $40)"]}],"writeRatioAvg":0.002395950071492059},{"readMsMax":"86","computeMsMax":"2153","waitMsAvg":"2","id":"4","endMs":"1570992602164","waitMsMax":"4","startMs":"1570992600654","waitRatioMax":7.728871198361479e-05,"readRatioAvg":0.0008115314758279554,"parallelInputs":"141","recordsRead":"144010451","computeRatioAvg":0.03222939289716737,"writeMsAvg":"53","status":"COMPLETE","writeMsMax":"640","computeMsAvg":"1668","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012366193917378367,"readMsAvg":"42","waitRatioAvg":3.8644355991807394e-05,"completedParallelInputs":"141","computeRatioMax":0.04160064922518066,"name":"S04: Input","shuffleOutputBytes":"6463183863","recordsWritten":"144010451","readRatioMax":0.001661707307647718,"steps":[{"kind":"READ","substeps":["$30:cs_sold_date_sk, $31:cs_warehouse_sk, $32:cs_item_sk, $33:cs_order_number, $34:cs_sales_price","FROM catalog_sales"]},{"kind":"WRITE","substeps":["$30, $31, $32, $33, $34","TO __stage04_output","BY HASH($33, $32)"]}],"writeRatioAvg":0.001024075433782896},{"readMsMax":"0","computeMsMax":"1816","inputStages":["0","1","2","3","4"],"waitMsAvg":"3","id":"5","endMs":"1570992655320","waitMsMax":"6","startMs":"1570992602801","waitRatioMax":0.0001159330679754222,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"159695047","computeRatioAvg":0.025543919310584688,"writeMsAvg":"528","status":"COMPLETE","writeMsMax":"51754","computeMsAvg":"1322","shuffleOutputBytesSpilled":"0","writeRatioMax":1,"readMsAvg":"0","waitRatioAvg":5.79665339877111e-05,"completedParallelInputs":"100","computeRatioMax":0.03508907524056112,"name":"S05: Join+","shuffleOutputBytes":"7779310","recordsWritten":"170650","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$30, $31, $32, $33, $34","FROM __stage04_output"]},{"kind":"READ","substeps":["$40, $41, $42","FROM __stage03_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage02_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage01_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $120 := $110, $121 := $111","$60 := SUM($71)","$61 := SUM($70)"]},{"kind":"COMPUTE","substeps":["$70 := case_no_value(greater_or_equal(CAST($114 AS DATE), 11839), subtract($112, coalesce($113, 0)), 0)","$71 := case_no_value(less(CAST($114 AS DATE), 11839), subtract($112, coalesce($113, 0)), 0)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $101 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $91 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $81 = $10"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH EACH ON $33 = $41, $32 = $40"]},{"kind":"WRITE","substeps":["$120, $121, $60, $61","TO __stage05_output","BY HASH($120, $121)"]}],"writeRatioAvg":0.010202109981837152},{"readMsMax":"0","computeMsMax":"20","inputStages":["5"],"waitMsAvg":"1","id":"6","endMs":"1570992657482","waitMsMax":"2","startMs":"1570992657256","waitRatioMax":3.8644355991807394e-05,"readRatioAvg":0,"parallelInputs":"14","recordsRead":"170650","computeRatioAvg":0.0002898326699385555,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"15","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0004637322719016888,"readMsAvg":"0","waitRatioAvg":1.9322177995903697e-05,"completedParallelInputs":"14","computeRatioMax":0.00038644355991807397,"name":"S06: Sort+","shuffleOutputBytes":"55992","recordsWritten":"1400","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$120, $121, $60, $61","FROM __stage05_output"]},{"kind":"SORT","substeps":["$130 ASC, $131 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $130 := $120, $131 := $121","$50 := SUM($60)","$51 := SUM($61)"]},{"kind":"WRITE","substeps":["$140, $141, $142, $143","TO __stage06_output"]}],"writeRatioAvg":0.00038644355991807397},{"readMsMax":"0","computeMsMax":"10","inputStages":["6"],"waitMsAvg":"1","id":"7","endMs":"1570992657537","waitMsMax":"1","startMs":"1570992657275","waitRatioMax":1.9322177995903697e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1400","computeRatioAvg":0.00019322177995903698,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00021254395795494067,"readMsAvg":"0","waitRatioAvg":1.9322177995903697e-05,"completedParallelInputs":"1","computeRatioMax":0.00019322177995903698,"name":"S07: Output","shuffleOutputBytes":"3992","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$140, $141, $142, $143","FROM __stage06_output"]},{"kind":"SORT","substeps":["$140 ASC, $141 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$150, $151, $152, $153","TO __stage07_output"]}],"writeRatioAvg":0.00021254395795494067}],"estimatedBytesProcessed":"6094791364","timeline":[{"totalSlotMs":"1879","activeUnits":"6","completedUnits":"3","elapsedMs":"754","pendingUnits":"6"},{"totalSlotMs":"190493","activeUnits":"147","completedUnits":"140","elapsedMs":"2077","pendingUnits":"10"},{"totalSlotMs":"223127","activeUnits":"100","completedUnits":"150","elapsedMs":"3444","pendingUnits":"100"},{"totalSlotMs":"333971","activeUnits":"8","completedUnits":"249","elapsedMs":"4659","pendingUnits":"1"},{"totalSlotMs":"336004","activeUnits":"3","completedUnits":"249","elapsedMs":"5302","pendingUnits":"1"},{"totalSlotMs":"539266","activeUnits":"0","completedUnits":"250","elapsedMs":"56064","pendingUnits":"0"},{"totalSlotMs":"542152","activeUnits":"0","completedUnits":"265","elapsedMs":"57959","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"6095372288","totalPartitionsProcessed":"0","totalBytesProcessed":"6094791364","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"warehouse","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_100"}]},"endTime":"1570992657755"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query40_1570992597"},"etag":"+gOA8Lk1Q8Y7ujc3xzhCCQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query40_1570992597?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon2e3495605bed5a7316a99c638dfc69b11de85e7c","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query40\nSELECT\n w_state , \n i_item_id , \n Sum( \n CASE \n WHEN ( \n Cast(d_date AS DATE) < Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) \n ELSE 0 \n END) AS sales_before , \n Sum( \n CASE \n WHEN ( \n Cast(d_date AS DATE) >= Cast ('2002-06-01' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash,0) \n ELSE 0 \n END) AS sales_after \nFROM catalog_sales \nLEFT OUTER JOIN catalog_returns \nON ( \n cs_order_number = cr_order_number \n AND cs_item_sk = cr_item_sk) , \n warehouse , \n item , \n date_dim \nWHERE i_current_price BETWEEN 0.99 AND 1.49 \nAND i_item_sk = cs_item_sk \nAND cs_warehouse_sk = w_warehouse_sk \nAND cs_sold_date_sk = d_date_sk \nAND Cast(d_date AS DATE) BETWEEN (Cast ('2002-05-01' AS DATE)) AND cast ('2002-07-01' AS date)\nGROUP BY w_state, \n i_item_id \nORDER BY w_state, \n i_item_id \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query40_1570992597","user_email":"nithish.sankaranarayanan@ulb.be"}
