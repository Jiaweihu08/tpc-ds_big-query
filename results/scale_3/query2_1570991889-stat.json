{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"528652","creationTime":"1570991891517","totalBytesProcessed":"3422365157","startTime":"1570991891653","query":{"totalSlotMs":"528652","queryPlan":[{"readMsMax":"55","computeMsMax":"69","waitMsAvg":"1","id":"0","endMs":"1570991892377","waitMsMax":"1","startMs":"1570991891824","waitRatioMax":0.000725689404934688,"readRatioAvg":0.03991291727140784,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.050072568940493466,"writeMsAvg":"437","status":"COMPLETE","writeMsMax":"437","computeMsAvg":"69","shuffleOutputBytesSpilled":"0","writeRatioMax":0.31712626995645865,"readMsAvg":"55","waitRatioAvg":0.000725689404934688,"completedParallelInputs":"1","computeRatioMax":0.050072568940493466,"name":"S00: Input","shuffleOutputBytes":"2201906","recordsWritten":"73049","readRatioMax":0.03991291727140784,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_week_seq, $52:d_day_name","FROM date_dim"]},{"kind":"WRITE","substeps":["$50, $51, $52","TO __stage00_output","BY HASH($50)"]}],"writeRatioAvg":0.31712626995645865},{"readMsMax":"20","computeMsMax":"77","waitMsAvg":"13","id":"2","endMs":"1570991892124","waitMsMax":"13","startMs":"1570991891968","waitRatioMax":0.009433962264150943,"readRatioAvg":0.01451378809869376,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.05587808417997097,"writeMsAvg":"51","status":"COMPLETE","writeMsMax":"51","computeMsAvg":"77","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03701015965166909,"readMsAvg":"20","waitRatioAvg":0.009433962264150943,"completedParallelInputs":"1","computeRatioMax":0.05587808417997097,"name":"S02: Input","shuffleOutputBytes":"2201906","recordsWritten":"73049","readRatioMax":0.01451378809869376,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_week_seq, $22:d_day_name","FROM date_dim"]},{"kind":"WRITE","substeps":["$20, $21, $22","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.03701015965166909},{"readMsMax":"193","computeMsMax":"1378","inputStages":["2"],"waitMsAvg":"261","id":"4","endMs":"1570991893822","waitMsMax":"284","startMs":"1570991892355","waitRatioMax":0.20609579100145137,"readRatioAvg":0.06676342525399129,"parallelInputs":"233","recordsRead":"231504943","computeRatioAvg":0.7227866473149492,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"558","computeMsAvg":"996","shuffleOutputBytesSpilled":"0","writeRatioMax":0.40493468795355586,"readMsAvg":"92","waitRatioAvg":0.18940493468795355,"completedParallelInputs":"233","computeRatioMax":1,"name":"S04: Join+","shuffleOutputBytes":"1749664","recordsWritten":"24508","readRatioMax":0.14005805515239478,"steps":[{"kind":"READ","substeps":["$30:ws_sold_date_sk, $31:ws_ext_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$40:cs_sold_date_sk, $41:cs_ext_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$20, $21, $22","FROM __stage02_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $181","$120 := SUM($136)","$121 := SUM($135)","$122 := SUM($134)","$123 := SUM($133)","$124 := SUM($132)","$125 := SUM($131)","$126 := SUM($130)"]},{"kind":"COMPUTE","substeps":["$130 := case_no_value(equal($182, 'Saturday'), $180, NULL)","$131 := case_no_value(equal($182, 'Friday'), $180, NULL)","$132 := case_no_value(equal($182, 'Thursday'), $180, NULL)","$133 := case_no_value(equal($182, 'Wednesday'), $180, NULL)","$134 := case_no_value(equal($182, 'Tuesday'), $180, NULL)","$135 := case_no_value(equal($182, 'Monday'), $180, NULL)","$136 := case_no_value(equal($182, 'Sunday'), $180, NULL)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $160 = $20"]},{"kind":"WRITE","substeps":["$190, $120, $121, $122, $123, $124, $125, $126","TO __stage04_output","BY HASH($190)"]}],"writeRatioAvg":0.005805515239477504},{"readMsMax":"82","computeMsMax":"1360","inputStages":["0"],"waitMsAvg":"2","id":"5","endMs":"1570991893969","waitMsMax":"4","startMs":"1570991892611","waitRatioMax":0.002902757619738752,"readRatioAvg":0.016690856313497822,"parallelInputs":"233","recordsRead":"231504943","computeRatioAvg":0.7438316400580551,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"138","computeMsAvg":"1025","shuffleOutputBytesSpilled":"0","writeRatioMax":0.10014513788098693,"readMsAvg":"23","waitRatioAvg":0.001451378809869376,"completedParallelInputs":"233","computeRatioMax":0.9869375907111756,"name":"S05: Join+","shuffleOutputBytes":"1749664","recordsWritten":"24508","readRatioMax":0.059506531204644414,"steps":[{"kind":"READ","substeps":["$60:ws_sold_date_sk, $61:ws_ext_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$70:cs_sold_date_sk, $71:cs_ext_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$50, $51, $52","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $221","$140 := SUM($156)","$141 := SUM($155)","$142 := SUM($154)","$143 := SUM($153)","$144 := SUM($152)","$145 := SUM($151)","$146 := SUM($150)"]},{"kind":"COMPUTE","substeps":["$150 := case_no_value(equal($222, 'Saturday'), $220, NULL)","$151 := case_no_value(equal($222, 'Friday'), $220, NULL)","$152 := case_no_value(equal($222, 'Thursday'), $220, NULL)","$153 := case_no_value(equal($222, 'Wednesday'), $220, NULL)","$154 := case_no_value(equal($222, 'Tuesday'), $220, NULL)","$155 := case_no_value(equal($222, 'Monday'), $220, NULL)","$156 := case_no_value(equal($222, 'Sunday'), $220, NULL)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $170 = $50"]},{"kind":"WRITE","substeps":["$230, $140, $141, $142, $143, $144, $145, $146","TO __stage05_output","BY HASH($230)"]}],"writeRatioAvg":0.013062409288824383},{"readMsMax":"12","computeMsMax":"8","waitMsAvg":"2","id":"6","endMs":"1570991894078","waitMsMax":"2","startMs":"1570991894023","waitRatioMax":0.001451378809869376,"readRatioAvg":0.008708272859216255,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.005805515239477504,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.015965166908563134,"readMsAvg":"12","waitRatioAvg":0.001451378809869376,"completedParallelInputs":"1","computeRatioMax":0.005805515239477504,"name":"S06: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.008708272859216255,"steps":[{"kind":"READ","substeps":["$10:d_week_seq, $11:d_year","FROM date_dim","WHERE equal($11, 1999)"]},{"kind":"WRITE","substeps":["$10","TO __stage06_output","BY HASH($10)"]}],"writeRatioAvg":0.015965166908563134},{"readMsMax":"9","computeMsMax":"11","waitMsAvg":"1","id":"8","endMs":"1570991894243","waitMsMax":"1","startMs":"1570991894059","waitRatioMax":0.000725689404934688,"readRatioAvg":0.006531204644412192,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.007982583454281567,"writeMsAvg":"111","status":"COMPLETE","writeMsMax":"111","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08055152394775036,"readMsAvg":"9","waitRatioAvg":0.000725689404934688,"completedParallelInputs":"1","computeRatioMax":0.007982583454281567,"name":"S08: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.006531204644412192,"steps":[{"kind":"READ","substeps":["$1:d_week_seq, $2:d_year","FROM date_dim","WHERE equal($2, 1998)"]},{"kind":"WRITE","substeps":["$1","TO __stage08_output","BY HASH($1)"]}],"writeRatioAvg":0.08055152394775036},{"readMsMax":"0","computeMsMax":"13","inputStages":["4","8"],"waitMsAvg":"1","id":"11","endMs":"1570991894447","waitMsMax":"2","startMs":"1570991894343","waitRatioMax":0.001451378809869376,"readRatioAvg":0,"parallelInputs":"23","recordsRead":"32903","computeRatioAvg":0.006531204644412192,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"14","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010159651669085631,"readMsAvg":"0","waitRatioAvg":0.000725689404934688,"completedParallelInputs":"23","computeRatioMax":0.009433962264150943,"name":"S0B: Join+","shuffleOutputBytes":"26200","recordsWritten":"365","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$190, $120, $121, $122, $123, $124, $125, $126","FROM __stage04_output"]},{"kind":"READ","substeps":["$1","FROM __stage08_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $200 = $1"]},{"kind":"AGGREGATE","substeps":["GROUP BY $200 := $190","$100 := SUM($120)","$101 := SUM($121)","$102 := SUM($122)","$103 := SUM($123)","$104 := SUM($124)","$105 := SUM($125)","$106 := SUM($126)"]},{"kind":"WRITE","substeps":["$210, $211, $212, $213, $214, $215, $216, $217","TO __stage0B_output","BY HASH($210)"]}],"writeRatioAvg":0.005805515239477504},{"readMsMax":"0","computeMsMax":"9","inputStages":["11"],"waitMsAvg":"5","id":"12","endMs":"1570991894698","waitMsMax":"6","startMs":"1570991894464","waitRatioMax":0.0043541364296081275,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"365","computeRatioAvg":0.00362844702467344,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"43","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.031204644412191583,"readMsAvg":"0","waitRatioAvg":0.00362844702467344,"completedParallelInputs":"100","computeRatioMax":0.006531204644412192,"name":"S0C: Coalesce","shuffleOutputBytes":"26200","recordsWritten":"365","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0B_output"]}],"writeRatioAvg":0.013788098693759071},{"readMsMax":"0","computeMsMax":"16","inputStages":["5","6","12"],"waitMsAvg":"6","id":"13","endMs":"1570991895416","waitMsMax":"7","startMs":"1570991894482","waitRatioMax":0.0050798258345428155,"readRatioAvg":0,"parallelInputs":"23","recordsRead":"40933","computeRatioAvg":0.007982583454281567,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"80","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05805515239477504,"readMsAvg":"0","waitRatioAvg":0.0043541364296081275,"completedParallelInputs":"23","computeRatioMax":0.011611030478955007,"name":"S0D: Join+","shuffleOutputBytes":"180376","recordsWritten":"2513","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$230, $140, $141, $142, $143, $144, $145, $146","FROM __stage05_output"]},{"kind":"READ","substeps":["$10","FROM __stage06_output"]},{"kind":"READ","substeps":["$210, $211, $212, $213, $214, $215, $216, $217","FROM __stage0C_output"]},{"kind":"COMPUTE","substeps":["$80 := round(divide($261, $268), 2)","$81 := round(divide($262, $269), 2)","$82 := round(divide($263, $270), 2)","$83 := round(divide($264, $271), 2)","$84 := round(divide($265, $272), 2)","$85 := round(divide($266, $273), 2)","$86 := round(divide($267, $274), 2)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $90 = $210"]},{"kind":"COMPUTE","substeps":["$90 := subtract($250, 53)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $240 = $10"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230","$110 := SUM($140)","$111 := SUM($141)","$112 := SUM($142)","$113 := SUM($143)","$114 := SUM($144)","$115 := SUM($145)","$116 := SUM($146)"]},{"kind":"WRITE","substeps":["$260, $80, $81, $82, $83, $84, $85, $86","TO __stage0D_output"]}],"writeRatioAvg":0.006531204644412192},{"readMsMax":"0","computeMsMax":"10","inputStages":["13"],"waitMsAvg":"2","id":"14","endMs":"1570991895522","waitMsMax":"2","startMs":"1570991895430","waitRatioMax":0.001451378809869376,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2513","computeRatioAvg":0.00725689404934688,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0050798258345428155,"readMsAvg":"0","waitRatioAvg":0.001451378809869376,"completedParallelInputs":"1","computeRatioMax":0.00725689404934688,"name":"S0E: Output","shuffleOutputBytes":"180376","recordsWritten":"2513","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$260, $80, $81, $82, $83, $84, $85, $86","FROM __stage0D_output"]},{"kind":"SORT","substeps":["$260 ASC"]},{"kind":"WRITE","substeps":["$280, $281, $282, $283, $284, $285, $286, $287","TO __stage0E_output"]}],"writeRatioAvg":0.0050798258345428155}],"estimatedBytesProcessed":"3422365157","timeline":[{"totalSlotMs":"4633","activeUnits":"27","completedUnits":"1","elapsedMs":"672","pendingUnits":"467"},{"totalSlotMs":"473098","activeUnits":"464","completedUnits":"440","elapsedMs":"1712","pendingUnits":"28"},{"totalSlotMs":"500275","activeUnits":"46","completedUnits":"470","elapsedMs":"2719","pendingUnits":"46"},{"totalSlotMs":"528652","activeUnits":"22","completedUnits":"617","elapsedMs":"4157","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"3422552064","totalPartitionsProcessed":"0","totalBytesProcessed":"3422365157","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_100"}]},"endTime":"1570991895845"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query2_1570991889"},"etag":"SrOeDygNA5UIrrr9af7xTQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query2_1570991889?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon3df0b458bbbb0f006dc6903f189481a7e2f1a102","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query2\nWITH wscs \n AS (SELECT sold_date_sk, \n sales_price \n FROM (SELECT ws_sold_date_sk sold_date_sk, \n ws_ext_sales_price sales_price \n FROM web_sales) \n UNION ALL \n (SELECT cs_sold_date_sk sold_date_sk, \n cs_ext_sales_price sales_price \n FROM catalog_sales)), \n wswscs \n AS (SELECT d_week_seq, \n Sum(CASE \n WHEN ( d_day_name = 'Sunday' ) THEN sales_price \n ELSE NULL \n END) sun_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Monday' ) THEN sales_price \n ELSE NULL \n END) mon_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Tuesday' ) THEN sales_price \n ELSE NULL \n END) tue_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Wednesday' ) THEN sales_price \n ELSE NULL \n END) wed_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Thursday' ) THEN sales_price \n ELSE NULL \n END) thu_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Friday' ) THEN sales_price \n ELSE NULL \n END) fri_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Saturday' ) THEN sales_price \n ELSE NULL \n END) sat_sales \n FROM wscs, \n date_dim \n WHERE d_date_sk = sold_date_sk \n GROUP BY d_week_seq) \nSELECT d_week_seq1, \n Round(sun_sales1 / sun_sales2, 2), \n Round(mon_sales1 / mon_sales2, 2), \n Round(tue_sales1 / tue_sales2, 2), \n Round(wed_sales1 / wed_sales2, 2), \n Round(thu_sales1 / thu_sales2, 2), \n Round(fri_sales1 / fri_sales2, 2), \n Round(sat_sales1 / sat_sales2, 2) \nFROM (SELECT wswscs.d_week_seq d_week_seq1, \n sun_sales sun_sales1, \n mon_sales mon_sales1, \n tue_sales tue_sales1, \n wed_sales wed_sales1, \n thu_sales thu_sales1, \n fri_sales fri_sales1, \n sat_sales sat_sales1 \n FROM wswscs, \n date_dim \n WHERE date_dim.d_week_seq = wswscs.d_week_seq \n AND d_year = 1998) y, \n (SELECT wswscs.d_week_seq d_week_seq2, \n sun_sales sun_sales2, \n mon_sales mon_sales2, \n tue_sales tue_sales2, \n wed_sales wed_sales2, \n thu_sales thu_sales2, \n fri_sales fri_sales2, \n sat_sales sat_sales2 \n FROM wswscs, \n date_dim \n WHERE date_dim.d_week_seq = wswscs.d_week_seq \n AND d_year = 1998 + 1) z \nWHERE d_week_seq1 = d_week_seq2 - 53 \nORDER BY d_week_seq1;\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query2_1570991889","user_email":"nithish.sankaranarayanan@ulb.be"}
