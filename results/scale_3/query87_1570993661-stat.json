{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"1913160","creationTime":"1570993663041","totalBytesProcessed":"7775774924","startTime":"1570993663168","query":{"totalSlotMs":"1913160","queryPlan":[{"readMsMax":"22","computeMsMax":"2392","waitMsAvg":"1","id":"0","endMs":"1570993664778","waitMsMax":"1","startMs":"1570993663367","waitRatioMax":0.00014771048744460856,"readRatioAvg":0.0032496307237813884,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.3533234859675037,"writeMsAvg":"153","status":"COMPLETE","writeMsMax":"153","computeMsAvg":"2392","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02259970457902511,"readMsAvg":"22","waitRatioAvg":0.00014771048744460856,"completedParallelInputs":"1","computeRatioMax":0.3533234859675037,"name":"S00: Input","shuffleOutputBytes":"60541144","recordsWritten":"2000000","readRatioMax":0.0032496307237813884,"steps":[{"kind":"READ","substeps":["$20:c_customer_sk, $21:c_first_name, $22:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$20, $21, $22","TO __stage00_output","BY HASH($20)"]}],"writeRatioAvg":0.02259970457902511},{"readMsMax":"14","computeMsMax":"11","waitMsAvg":"3","id":"1","endMs":"1570993664150","waitMsMax":"3","startMs":"1570993663482","waitRatioMax":0.0004431314623338257,"readRatioAvg":0.00206794682422452,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0016248153618906942,"writeMsAvg":"640","status":"COMPLETE","writeMsMax":"640","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.09453471196454949,"readMsAvg":"14","waitRatioAvg":0.0004431314623338257,"completedParallelInputs":"1","computeRatioMax":0.0016248153618906942,"name":"S01: Input","shuffleOutputBytes":"8760","recordsWritten":"365","readRatioMax":0.00206794682422452,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_date, $82:d_month_seq","FROM date_dim","WHERE between($82, 1188, 1199)"]},{"kind":"WRITE","substeps":["$80, $81","TO __stage01_output","BY HASH($80)"]}],"writeRatioAvg":0.09453471196454949},{"readMsMax":"22","computeMsMax":"2468","waitMsAvg":"26","id":"3","endMs":"1570993665103","waitMsMax":"26","startMs":"1570993663772","waitRatioMax":0.0038404726735598227,"readRatioAvg":0.0032496307237813884,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.36454948301329393,"writeMsAvg":"140","status":"COMPLETE","writeMsMax":"140","computeMsAvg":"2468","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0206794682422452,"readMsAvg":"22","waitRatioAvg":0.0038404726735598227,"completedParallelInputs":"1","computeRatioMax":0.36454948301329393,"name":"S03: Input","shuffleOutputBytes":"60541144","recordsWritten":"2000000","readRatioMax":0.0032496307237813884,"steps":[{"kind":"READ","substeps":["$10:c_customer_sk, $11:c_first_name, $12:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage03_output","BY HASH($10)"]}],"writeRatioAvg":0.0206794682422452},{"readMsMax":"14","computeMsMax":"10","waitMsAvg":"4","id":"4","endMs":"1570993664178","waitMsMax":"4","startMs":"1570993663831","waitRatioMax":0.0005908419497784342,"readRatioAvg":0.00206794682422452,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0014771048744460858,"writeMsAvg":"148","status":"COMPLETE","writeMsMax":"148","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02186115214180207,"readMsAvg":"14","waitRatioAvg":0.0005908419497784342,"completedParallelInputs":"1","computeRatioMax":0.0014771048744460858,"name":"S04: Input","shuffleOutputBytes":"8760","recordsWritten":"365","readRatioMax":0.00206794682422452,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_date, $72:d_month_seq","FROM date_dim","WHERE between($72, 1188, 1199)"]},{"kind":"WRITE","substeps":["$70, $71","TO __stage04_output","BY HASH($70)"]}],"writeRatioAvg":0.02186115214180207},{"readMsMax":"39","computeMsMax":"2853","waitMsAvg":"24","id":"6","endMs":"1570993665578","waitMsMax":"24","startMs":"1570993664011","waitRatioMax":0.0035450516986706058,"readRatioAvg":0.005760709010339734,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.42141802067946826,"writeMsAvg":"70","status":"COMPLETE","writeMsMax":"70","computeMsAvg":"2853","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0103397341211226,"readMsAvg":"39","waitRatioAvg":0.0035450516986706058,"completedParallelInputs":"1","computeRatioMax":0.42141802067946826,"name":"S06: Input","shuffleOutputBytes":"60541144","recordsWritten":"2000000","readRatioMax":0.005760709010339734,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_first_name, $3:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage06_output","BY HASH($1)"]}],"writeRatioAvg":0.0103397341211226},{"readMsMax":"13","computeMsMax":"13","waitMsAvg":"46","id":"7","endMs":"1570993664344","waitMsMax":"46","startMs":"1570993664123","waitRatioMax":0.006794682422451994,"readRatioAvg":0.0019202363367799113,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0019202363367799113,"writeMsAvg":"15","status":"COMPLETE","writeMsMax":"15","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0022156573116691287,"readMsAvg":"13","waitRatioAvg":0.006794682422451994,"completedParallelInputs":"1","computeRatioMax":0.0019202363367799113,"name":"S07: Input","shuffleOutputBytes":"8760","recordsWritten":"365","readRatioMax":0.0019202363367799113,"steps":[{"kind":"READ","substeps":["$60:d_date_sk, $61:d_date, $62:d_month_seq","FROM date_dim","WHERE between($62, 1188, 1199)"]},{"kind":"WRITE","substeps":["$60, $61","TO __stage07_output","BY HASH($60)"]}],"writeRatioAvg":0.0022156573116691287},{"readMsMax":"0","computeMsMax":"31","inputStages":["0"],"waitMsAvg":"1","id":"12","endMs":"1570993665370","waitMsMax":"3","startMs":"1570993664888","waitRatioMax":0.0004431314623338257,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2000000","computeRatioAvg":0.0035450516986706058,"writeMsAvg":"186","status":"COMPLETE","writeMsMax":"395","computeMsAvg":"24","shuffleOutputBytesSpilled":"0","writeRatioMax":0.058345642540620385,"readMsAvg":"0","waitRatioAvg":0.00014771048744460856,"completedParallelInputs":"100","computeRatioMax":0.004579025110782866,"name":"S0C: Coalesce","shuffleOutputBytes":"60541144","recordsWritten":"2000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage00_output"]}],"writeRatioAvg":0.027474150664697192},{"readMsMax":"31","computeMsMax":"3173","inputStages":["12","1"],"waitMsAvg":"2","id":"13","endMs":"1570993668617","waitMsMax":"5","startMs":"1570993664966","waitRatioMax":0.0007385524372230429,"readRatioAvg":0.0022156573116691287,"parallelInputs":"141","recordsRead":"202061916","computeRatioAvg":0.093205317577548,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"263","computeMsAvg":"631","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03884785819793205,"readMsAvg":"15","waitRatioAvg":0.0002954209748892171,"completedParallelInputs":"141","computeRatioMax":0.468685376661743,"name":"S0D: Join+","shuffleOutputBytes":"110912439","recordsWritten":"3025490","readRatioMax":0.004579025110782866,"steps":[{"kind":"READ","substeps":["$50:cs_sold_date_sk, $51:cs_bill_customer_sk","FROM catalog_sales"]},{"kind":"READ","substeps":["$80, $81","FROM __stage01_output"]},{"kind":"READ","substeps":["$20, $21, $22","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $172, $181 := $171, $182 := $170"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $160 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $50 = $80"]},{"kind":"WRITE","substeps":["$181, $180, $182","TO __stage0D_output","BY HASH($180, $181, $182)"]}],"writeRatioAvg":0.00103397341211226},{"readMsMax":"0","computeMsMax":"33","inputStages":["3"],"waitMsAvg":"1","id":"14","endMs":"1570993665976","waitMsMax":"4","startMs":"1570993665164","waitRatioMax":0.0005908419497784342,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2000000","computeRatioAvg":0.003692762186115214,"writeMsAvg":"64","status":"COMPLETE","writeMsMax":"206","computeMsAvg":"25","shuffleOutputBytesSpilled":"0","writeRatioMax":0.030428360413589366,"readMsAvg":"0","waitRatioAvg":0.00014771048744460856,"completedParallelInputs":"100","computeRatioMax":0.0048744460856720824,"name":"S0E: Coalesce","shuffleOutputBytes":"60541144","recordsWritten":"2000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage03_output"]}],"writeRatioAvg":0.009453471196454948},{"readMsMax":"48","computeMsMax":"3351","inputStages":["14","4"],"waitMsAvg":"2","id":"15","endMs":"1570993667790","waitMsMax":"7","startMs":"1570993665193","waitRatioMax":0.00103397341211226,"readRatioAvg":0.0029542097488921715,"parallelInputs":"184","recordsRead":"649940083","computeRatioAvg":0.3431314623338257,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"93","computeMsAvg":"2323","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013737075332348596,"readMsAvg":"20","waitRatioAvg":0.0002954209748892171,"completedParallelInputs":"184","computeRatioMax":0.49497784342688333,"name":"S0F: Join+","shuffleOutputBytes":"169707583","recordsWritten":"4658284","readRatioMax":0.0070901033973412115,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_customer_sk","FROM store_sales"]},{"kind":"READ","substeps":["$70, $71","FROM __stage04_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage0E_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $140 := $132, $141 := $131, $142 := $130"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $120 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $70"]},{"kind":"WRITE","substeps":["$141, $140, $142","TO __stage0F_output","BY HASH($140, $141, $142)"]}],"writeRatioAvg":0.00103397341211226},{"readMsMax":"0","computeMsMax":"35","inputStages":["6"],"waitMsAvg":"1","id":"16","endMs":"1570993666398","waitMsMax":"3","startMs":"1570993665697","waitRatioMax":0.0004431314623338257,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2000000","computeRatioAvg":0.003692762186115214,"writeMsAvg":"36","status":"COMPLETE","writeMsMax":"160","computeMsAvg":"25","shuffleOutputBytesSpilled":"0","writeRatioMax":0.023633677991137372,"readMsAvg":"0","waitRatioAvg":0.00014771048744460856,"completedParallelInputs":"100","computeRatioMax":0.0051698670605613,"name":"S10: Coalesce","shuffleOutputBytes":"60541144","recordsWritten":"2000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage06_output"]}],"writeRatioAvg":0.005317577548005908},{"readMsMax":"45","computeMsMax":"3238","inputStages":["16","7"],"waitMsAvg":"2","id":"17","endMs":"1570993676047","waitMsMax":"3","startMs":"1570993665719","waitRatioMax":0.0004431314623338257,"readRatioAvg":0.0022156573116691287,"parallelInputs":"92","recordsRead":"254507655","computeRatioAvg":0.3251107828655835,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"80","computeMsAvg":"2201","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011816838995568686,"readMsAvg":"15","waitRatioAvg":0.0002954209748892171,"completedParallelInputs":"92","computeRatioMax":0.47828655834564254,"name":"S11: Join+","shuffleOutputBytes":"42529684","recordsWritten":"1169282","readRatioMax":0.0066469719350073855,"steps":[{"kind":"READ","substeps":["$30:ws_sold_date_sk, $31:ws_bill_customer_sk","FROM web_sales"]},{"kind":"READ","substeps":["$60, $61","FROM __stage07_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage10_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $222, $231 := $221, $232 := $220"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $210 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $30 = $60"]},{"kind":"WRITE","substeps":["$231, $230, $232","TO __stage11_output","BY HASH($230, $231, $232)"]}],"writeRatioAvg":0.0029542097488921715},{"readMsMax":"0","computeMsMax":"391","inputStages":["17"],"waitMsAvg":"1","id":"18","endMs":"1570993676340","waitMsMax":"1","startMs":"1570993676077","waitRatioMax":0.00014771048744460856,"readRatioAvg":0,"parallelInputs":"9","recordsRead":"1169282","computeRatioAvg":0.05110782865583456,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"34","computeMsAvg":"346","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005022156573116691,"readMsAvg":"0","waitRatioAvg":0.00014771048744460856,"completedParallelInputs":"9","computeRatioMax":0.05775480059084195,"name":"S12: Aggregate","shuffleOutputBytes":"40682300","recordsWritten":"1100320","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$231, $230, $232","FROM __stage11_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230, $241 := $231, $242 := $232"]},{"kind":"WRITE","substeps":["$240, $241, $242","TO __stage12_output","BY HASH($240, $241, $242)"]}],"writeRatioAvg":0.003988183161004431},{"readMsMax":"0","computeMsMax":"611","inputStages":["13"],"waitMsAvg":"1","id":"19","endMs":"1570993676472","waitMsMax":"1","startMs":"1570993676098","waitRatioMax":0.00014771048744460856,"readRatioAvg":0,"parallelInputs":"14","recordsRead":"3025490","computeRatioAvg":0.08124076809453472,"writeMsAvg":"34","status":"COMPLETE","writeMsMax":"93","computeMsAvg":"550","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013737075332348596,"readMsAvg":"0","waitRatioAvg":0.00014771048744460856,"completedParallelInputs":"14","computeRatioMax":0.09025110782865584,"name":"S13: Aggregate","shuffleOutputBytes":"108250700","recordsWritten":"2927935","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$181, $180, $182","FROM __stage0D_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $180, $191 := $181, $192 := $182"]},{"kind":"WRITE","substeps":["$190, $191, $192","TO __stage13_output","BY HASH($190, $191, $192)"]}],"writeRatioAvg":0.005022156573116691},{"readMsMax":"0","computeMsMax":"43","inputStages":["19"],"waitMsAvg":"2","id":"20","endMs":"1570993677132","waitMsMax":"3","startMs":"1570993676483","waitRatioMax":0.0004431314623338257,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2927935","computeRatioAvg":0.004726735598227474,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"36","computeMsAvg":"32","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005317577548005908,"readMsAvg":"0","waitRatioAvg":0.0002954209748892171,"completedParallelInputs":"100","computeRatioMax":0.006351550960118168,"name":"S14: Coalesce","shuffleOutputBytes":"108250700","recordsWritten":"2927935","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage13_output"]}],"writeRatioAvg":0.0031019202363367798},{"readMsMax":"0","computeMsMax":"6770","inputStages":["15","20"],"waitMsAvg":"1","id":"21","endMs":"1570993680612","waitMsMax":"2","startMs":"1570993676500","waitRatioMax":0.0002954209748892171,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"57361114","computeRatioAvg":0.7961595273264401,"writeMsAvg":"31","status":"COMPLETE","writeMsMax":"41","computeMsAvg":"5390","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006056129985228951,"readMsAvg":"0","waitRatioAvg":0.00014771048744460856,"completedParallelInputs":"18","computeRatioMax":1,"name":"S15: Join+","shuffleOutputBytes":"155003973","recordsWritten":"4227558","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$141, $140, $142","FROM __stage0F_output"]},{"kind":"READ","substeps":["$190, $191, $192","FROM __stage14_output"]},{"kind":"JOIN","substeps":["ANTI HASH JOIN EACH WITH ALL ON $150 = $190, $151 = $191, $152 = $192"]},{"kind":"AGGREGATE","substeps":["GROUP BY $150 := $140, $151 := $141, $152 := $142"]},{"kind":"WRITE","substeps":["$200, $201, $202","TO __stage15_output","BY HASH($201, $200, $202)"]}],"writeRatioAvg":0.004579025110782866},{"readMsMax":"0","computeMsMax":"58","inputStages":["18","21"],"waitMsAvg":"1","id":"22","endMs":"1570993680890","waitMsMax":"2","startMs":"1570993680641","waitRatioMax":0.0002954209748892171,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"5327878","computeRatioAvg":0.005022156573116691,"writeMsAvg":"128","status":"COMPLETE","writeMsMax":"200","computeMsAvg":"34","shuffleOutputBytesSpilled":"0","writeRatioMax":0.029542097488921712,"readMsAvg":"0","waitRatioAvg":0.00014771048744460856,"completedParallelInputs":"100","computeRatioMax":0.008567208271787297,"name":"S16: Join+","shuffleOutputBytes":"900","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$200, $201, $202","FROM __stage15_output"]},{"kind":"READ","substeps":["$240, $241, $242","FROM __stage12_output"]},{"kind":"AGGREGATE","substeps":["$100 := COUNT($110)"]},{"kind":"COMPUTE","substeps":["$110 := 1"]},{"kind":"JOIN","substeps":["ANTI HASH JOIN EACH WITH EACH ON $201 = $240, $200 = $241, $202 = $242"]},{"kind":"WRITE","substeps":["$100","TO __stage16_output"]}],"writeRatioAvg":0.018906942392909895},{"readMsMax":"0","computeMsMax":"6","inputStages":["22"],"waitMsAvg":"6","id":"23","endMs":"1570993680908","waitMsMax":"6","startMs":"1570993680731","waitRatioMax":0.0008862629246676514,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0008862629246676514,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0008862629246676514,"readMsAvg":"0","waitRatioAvg":0.0008862629246676514,"completedParallelInputs":"1","computeRatioMax":0.0008862629246676514,"name":"S17: Output","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$100","FROM __stage16_output"]},{"kind":"AGGREGATE","substeps":["$90 := SUM_OF_COUNTS($100)"]},{"kind":"WRITE","substeps":["$90","TO __stage17_output"]}],"writeRatioAvg":0.0008862629246676514}],"estimatedBytesProcessed":"7775774924","timeline":[{"totalSlotMs":"1096","activeUnits":"33","completedUnits":"0","elapsedMs":"700","pendingUnits":"329"},{"totalSlotMs":"166108","activeUnits":"316","completedUnits":"418","elapsedMs":"1708","pendingUnits":"5"},{"totalSlotMs":"387905","activeUnits":"418","completedUnits":"305","elapsedMs":"2732","pendingUnits":"418"},{"totalSlotMs":"962732","activeUnits":"306","completedUnits":"580","elapsedMs":"4061","pendingUnits":"143"},{"totalSlotMs":"1120910","activeUnits":"123","completedUnits":"622","elapsedMs":"5124","pendingUnits":"101"},{"totalSlotMs":"1165323","activeUnits":"92","completedUnits":"631","elapsedMs":"5635","pendingUnits":"92"},{"totalSlotMs":"1420112","activeUnits":"93","completedUnits":"631","elapsedMs":"8417","pendingUnits":"92"},{"totalSlotMs":"1744232","activeUnits":"76","completedUnits":"703","elapsedMs":"12114","pendingUnits":"20"},{"totalSlotMs":"1765297","activeUnits":"16","completedUnits":"730","elapsedMs":"13159","pendingUnits":"16"},{"totalSlotMs":"1811255","activeUnits":"42","completedUnits":"846","elapsedMs":"14326","pendingUnits":"18"},{"totalSlotMs":"1892776","activeUnits":"15","completedUnits":"856","elapsedMs":"17022","pendingUnits":"8"},{"totalSlotMs":"1913160","activeUnits":"100","completedUnits":"965","elapsedMs":"17924","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"7776239616","totalPartitionsProcessed":"0","totalBytesProcessed":"7775774924","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_100"}]},"endTime":"1570993681112"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query87_1570993661"},"etag":"KXVeJh4zzAO8StwbkjPEZA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query87_1570993661?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anond378f118e1030e3522b46532006bbe5de8cc7048","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query87\nwith store_customers as (\n select distinct c_last_name as sc_last, c_first_name as sc_first, d_date as sc_date\n from store_sales, date_dim, customer\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_customer_sk = customer.c_customer_sk\n and d_month_seq between 1188 and 1188+11\n),\ncatalog_customers as (\n select distinct c_last_name as cc_last, c_first_name as cc_first, d_date as cc_date\n from catalog_sales, date_dim, customer\n where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1188 and 1188+11\n),\nweb_customers as (\n select distinct c_last_name as wc_last, c_first_name as wc_first, d_date as wc_date\n from web_sales, date_dim, customer\n where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1188 and 1188+11\n)\nselect count(1) \nfrom store_customers \nwhere not exists (\n select 1 from catalog_customers \n where sc_last = cc_last and sc_first = cc_first and sc_date = cc_date\n)\nand not exists (\n select 1 from web_customers \n where sc_last = wc_last and sc_first = wc_first and sc_date = wc_date\n);\n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query87_1570993661","user_email":"nithish.sankaranarayanan@ulb.be"}
