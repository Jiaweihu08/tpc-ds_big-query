{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"191584","creationTime":"1570972466992","totalBytesProcessed":"798244160","startTime":"1570972467153","query":{"totalSlotMs":"191584","queryPlan":[{"readMsMax":"27","computeMsMax":"493","waitMsAvg":"2","id":"0","endMs":"1570972467745","waitMsMax":"2","startMs":"1570972467301","waitRatioMax":0.00032362459546925567,"readRatioAvg":0.004368932038834952,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.07977346278317152,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"493","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003883495145631068,"readMsAvg":"27","waitRatioAvg":0.00032362459546925567,"completedParallelInputs":"1","computeRatioMax":0.07977346278317152,"name":"S00: Input","shuffleOutputBytes":"15134188","recordsWritten":"500000","readRatioMax":0.004368932038834952,"steps":[{"kind":"READ","substeps":["$20:c_customer_sk, $21:c_first_name, $22:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$20, $21, $22","TO __stage00_output","BY HASH($20)"]}],"writeRatioAvg":0.003883495145631068},{"readMsMax":"17","computeMsMax":"12","waitMsAvg":"22","id":"1","endMs":"1570972467391","waitMsMax":"22","startMs":"1570972467340","waitRatioMax":0.0035598705501618125,"readRatioAvg":0.002750809061488673,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.001941747572815534,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0012944983818770227,"readMsAvg":"17","waitRatioAvg":0.0035598705501618125,"completedParallelInputs":"1","computeRatioMax":0.001941747572815534,"name":"S01: Input","shuffleOutputBytes":"8760","recordsWritten":"365","readRatioMax":0.002750809061488673,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_date, $82:d_month_seq","FROM date_dim","WHERE between($82, 1188, 1199)"]},{"kind":"WRITE","substeps":["$80, $81","TO __stage01_output","BY HASH($80)"]}],"writeRatioAvg":0.0012944983818770227},{"readMsMax":"28","computeMsMax":"612","waitMsAvg":"46","id":"3","endMs":"1570972467947","waitMsMax":"46","startMs":"1570972467391","waitRatioMax":0.00744336569579288,"readRatioAvg":0.004530744336569579,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.09902912621359224,"writeMsAvg":"84","status":"COMPLETE","writeMsMax":"84","computeMsAvg":"612","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013592233009708738,"readMsAvg":"28","waitRatioAvg":0.00744336569579288,"completedParallelInputs":"1","computeRatioMax":0.09902912621359224,"name":"S03: Input","shuffleOutputBytes":"15134188","recordsWritten":"500000","readRatioMax":0.004530744336569579,"steps":[{"kind":"READ","substeps":["$10:c_customer_sk, $11:c_first_name, $12:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage03_output","BY HASH($10)"]}],"writeRatioAvg":0.013592233009708738},{"readMsMax":"13","computeMsMax":"7","waitMsAvg":"36","id":"4","endMs":"1570972467570","waitMsMax":"36","startMs":"1570972467398","waitRatioMax":0.005825242718446602,"readRatioAvg":0.002103559870550162,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0011326860841423948,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.000970873786407767,"readMsAvg":"13","waitRatioAvg":0.005825242718446602,"completedParallelInputs":"1","computeRatioMax":0.0011326860841423948,"name":"S04: Input","shuffleOutputBytes":"8760","recordsWritten":"365","readRatioMax":0.002103559870550162,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_date, $72:d_month_seq","FROM date_dim","WHERE between($72, 1188, 1199)"]},{"kind":"WRITE","substeps":["$70, $71","TO __stage04_output","BY HASH($70)"]}],"writeRatioAvg":0.000970873786407767},{"readMsMax":"18","computeMsMax":"10","waitMsAvg":"12","id":"7","endMs":"1570972467632","waitMsMax":"12","startMs":"1570972467421","waitRatioMax":0.001941747572815534,"readRatioAvg":0.002912621359223301,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0016181229773462784,"writeMsAvg":"180","status":"COMPLETE","writeMsMax":"180","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02912621359223301,"readMsAvg":"18","waitRatioAvg":0.001941747572815534,"completedParallelInputs":"1","computeRatioMax":0.0016181229773462784,"name":"S07: Input","shuffleOutputBytes":"8760","recordsWritten":"365","readRatioMax":0.002912621359223301,"steps":[{"kind":"READ","substeps":["$60:d_date_sk, $61:d_date, $62:d_month_seq","FROM date_dim","WHERE between($62, 1188, 1199)"]},{"kind":"WRITE","substeps":["$60, $61","TO __stage07_output","BY HASH($60)"]}],"writeRatioAvg":0.02912621359223301},{"readMsMax":"29","computeMsMax":"643","inputStages":["7"],"waitMsAvg":"1","id":"11","endMs":"1570972468130","waitMsMax":"1","startMs":"1570972467703","waitRatioMax":0.00016181229773462783,"readRatioAvg":0.0040453074433656954,"parallelInputs":"4","recordsRead":"7202490","computeRatioAvg":0.09174757281553399,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"31","computeMsAvg":"567","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005016181229773463,"readMsAvg":"25","waitRatioAvg":0.00016181229773462783,"completedParallelInputs":"4","computeRatioMax":0.1040453074433657,"name":"S0B: Join","shuffleOutputBytes":"34661232","recordsWritten":"1444218","readRatioMax":0.004692556634304207,"steps":[{"kind":"READ","substeps":["$30:ws_sold_date_sk, $31:ws_bill_customer_sk","FROM web_sales"]},{"kind":"READ","substeps":["$60, $61","FROM __stage07_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $30 = $60"]},{"kind":"WRITE","substeps":["$210, $211","TO __stage0B_output","BY HASH($210)"]}],"writeRatioAvg":0.004207119741100324},{"readMsMax":"34","computeMsMax":"2003","inputStages":["0","1"],"waitMsAvg":"1","id":"12","endMs":"1570972468939","waitMsMax":"1","startMs":"1570972467868","waitRatioMax":0.00016181229773462783,"readRatioAvg":0.004368932038834952,"parallelInputs":"8","recordsRead":"18400243","computeRatioAvg":0.2815533980582524,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"1740","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002912621359223301,"readMsAvg":"27","waitRatioAvg":0.00016181229773462783,"completedParallelInputs":"8","computeRatioMax":0.32411003236245955,"name":"S0C: Join+","shuffleOutputBytes":"61200979","recordsWritten":"1672734","readRatioMax":0.005501618122977346,"steps":[{"kind":"READ","substeps":["$50:cs_sold_date_sk, $51:cs_bill_customer_sk","FROM catalog_sales"]},{"kind":"READ","substeps":["$80, $81","FROM __stage01_output"]},{"kind":"READ","substeps":["$20, $21, $22","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $172, $181 := $171, $182 := $170"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $160 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $50 = $80"]},{"kind":"WRITE","substeps":["$181, $180, $182","TO __stage0C_output","BY HASH($180, $181, $182)"]}],"writeRatioAvg":0.001941747572815534},{"readMsMax":"32","computeMsMax":"2586","inputStages":["3","4"],"waitMsAvg":"2","id":"13","endMs":"1570972469560","waitMsMax":"3","startMs":"1570972468075","waitRatioMax":0.0004854368932038835,"readRatioAvg":0.00372168284789644,"parallelInputs":"10","recordsRead":"33805762","computeRatioAvg":0.38462783171521037,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"51","computeMsAvg":"2377","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00825242718446602,"readMsAvg":"23","waitRatioAvg":0.00032362459546925567,"completedParallelInputs":"10","computeRatioMax":0.4184466019417476,"name":"S0D: Join+","shuffleOutputBytes":"116953865","recordsWritten":"3195352","readRatioMax":0.005177993527508091,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_customer_sk","FROM store_sales"]},{"kind":"READ","substeps":["$70, $71","FROM __stage04_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $140 := $132, $141 := $131, $142 := $130"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $120 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $70"]},{"kind":"WRITE","substeps":["$141, $140, $142","TO __stage0D_output","BY HASH($140, $141, $142)"]}],"writeRatioAvg":0.00372168284789644},{"readMsMax":"0","computeMsMax":"18","inputStages":["11"],"waitMsAvg":"7","id":"14","endMs":"1570972468403","waitMsMax":"9","startMs":"1570972468152","waitRatioMax":0.0014563106796116505,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1444218","computeRatioAvg":0.002103559870550162,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"73","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011812297734627832,"readMsAvg":"0","waitRatioAvg":0.0011326860841423948,"completedParallelInputs":"100","computeRatioMax":0.002912621359223301,"name":"S0E: Coalesce","shuffleOutputBytes":"34661232","recordsWritten":"1444218","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0B_output"]}],"writeRatioAvg":0.0030744336569579287},{"readMsMax":"23","computeMsMax":"2626","inputStages":["14"],"waitMsAvg":"2","id":"15","endMs":"1570972469705","waitMsMax":"2","startMs":"1570972468164","waitRatioMax":0.00032362459546925567,"readRatioAvg":0.00372168284789644,"parallelInputs":"1","recordsRead":"1944218","computeRatioAvg":0.4249190938511327,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"2626","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004368932038834952,"readMsAvg":"23","waitRatioAvg":0.00032362459546925567,"completedParallelInputs":"1","computeRatioMax":0.4249190938511327,"name":"S0F: Join+","shuffleOutputBytes":"4325612","recordsWritten":"118352","readRatioMax":0.00372168284789644,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_first_name, $3:c_last_name","FROM customer"]},{"kind":"READ","substeps":["$210, $211","FROM __stage0E_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $222, $231 := $221, $232 := $220"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $210"]},{"kind":"WRITE","substeps":["$231, $230, $232","TO __stage0F_output","BY HASH($230, $231, $232)"]}],"writeRatioAvg":0.004368932038834952},{"readMsMax":"0","computeMsMax":"368","inputStages":["15"],"waitMsAvg":"4","id":"16","endMs":"1570972470436","waitMsMax":"4","startMs":"1570972470211","waitRatioMax":0.0006472491909385113,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"118352","computeRatioAvg":0.05954692556634304,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"28","computeMsAvg":"368","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004530744336569579,"readMsAvg":"0","waitRatioAvg":0.0006472491909385113,"completedParallelInputs":"1","computeRatioMax":0.05954692556634304,"name":"S10: Aggregate","shuffleOutputBytes":"4205856","recordsWritten":"113789","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$231, $230, $232","FROM __stage0F_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230, $241 := $231, $242 := $232"]},{"kind":"WRITE","substeps":["$240, $241, $242","TO __stage10_output","BY HASH($240, $241, $242)"]}],"writeRatioAvg":0.004530744336569579},{"readMsMax":"0","computeMsMax":"2515","inputStages":["12"],"waitMsAvg":"4","id":"17","endMs":"1570972471642","waitMsMax":"4","startMs":"1570972470224","waitRatioMax":0.0006472491909385113,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1672734","computeRatioAvg":0.406957928802589,"writeMsAvg":"34","status":"COMPLETE","writeMsMax":"34","computeMsAvg":"2515","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005501618122977346,"readMsAvg":"0","waitRatioAvg":0.0006472491909385113,"completedParallelInputs":"1","computeRatioMax":0.406957928802589,"name":"S11: Aggregate","shuffleOutputBytes":"11108019","recordsWritten":"300462","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$181, $180, $182","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $180, $191 := $181, $192 := $182"]},{"kind":"WRITE","substeps":["$190, $191, $192","TO __stage11_output","BY HASH($190, $191, $192)"]}],"writeRatioAvg":0.005501618122977346},{"readMsMax":"0","computeMsMax":"12","inputStages":["17"],"waitMsAvg":"2","id":"18","endMs":"1570972472346","waitMsMax":"4","startMs":"1570972471661","waitRatioMax":0.0006472491909385113,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"300462","computeRatioAvg":0.0012944983818770227,"writeMsAvg":"37","status":"COMPLETE","writeMsMax":"60","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009708737864077669,"readMsAvg":"0","waitRatioAvg":0.00032362459546925567,"completedParallelInputs":"100","computeRatioMax":0.001941747572815534,"name":"S12: Coalesce","shuffleOutputBytes":"11108019","recordsWritten":"300462","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage11_output"]}],"writeRatioAvg":0.00598705501618123},{"readMsMax":"0","computeMsMax":"11","inputStages":["16"],"waitMsAvg":"4","id":"19","endMs":"1570972471929","waitMsMax":"7","startMs":"1570972471661","waitRatioMax":0.0011326860841423948,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"113789","computeRatioAvg":0.0011326860841423948,"writeMsAvg":"48","status":"COMPLETE","writeMsMax":"64","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010355987055016181,"readMsAvg":"0","waitRatioAvg":0.0006472491909385113,"completedParallelInputs":"100","computeRatioMax":0.0017799352750809063,"name":"S13: Coalesce","shuffleOutputBytes":"4205856","recordsWritten":"113789","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage10_output"]}],"writeRatioAvg":0.007766990291262136},{"readMsMax":"0","computeMsMax":"6180","inputStages":["13","19","18"],"waitMsAvg":"6","id":"20","endMs":"1570972485132","waitMsMax":"6","startMs":"1570972471669","waitRatioMax":0.000970873786407767,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"3609603","computeRatioAvg":1,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"6180","shuffleOutputBytesSpilled":"0","writeRatioMax":0.000970873786407767,"readMsAvg":"0","waitRatioAvg":0.000970873786407767,"completedParallelInputs":"1","computeRatioMax":1,"name":"S14: Join+","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$141, $140, $142","FROM __stage0D_output"]},{"kind":"READ","substeps":["$190, $191, $192","FROM __stage12_output"]},{"kind":"READ","substeps":["$240, $241, $242","FROM __stage13_output"]},{"kind":"AGGREGATE","substeps":["$100 := COUNT($110)"]},{"kind":"COMPUTE","substeps":["$110 := 1"]},{"kind":"JOIN","substeps":["ANTI HASH JOIN EACH WITH ALL ON $201 = $240, $200 = $241, $202 = $242"]},{"kind":"JOIN","substeps":["ANTI HASH JOIN EACH WITH ALL ON $150 = $190, $151 = $191, $152 = $192"]},{"kind":"AGGREGATE","substeps":["GROUP BY $150 := $140, $151 := $141, $152 := $142"]},{"kind":"WRITE","substeps":["$100","TO __stage14_output"]}],"writeRatioAvg":0.000970873786407767},{"readMsMax":"0","computeMsMax":"6","inputStages":["20"],"waitMsAvg":"1","id":"21","endMs":"1570972485572","waitMsMax":"1","startMs":"1570972471687","waitRatioMax":0.00016181229773462783,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.000970873786407767,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.000970873786407767,"readMsAvg":"0","waitRatioAvg":0.00016181229773462783,"completedParallelInputs":"1","computeRatioMax":0.000970873786407767,"name":"S15: Output","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$100","FROM __stage14_output"]},{"kind":"AGGREGATE","substeps":["$90 := SUM_OF_COUNTS($100)"]},{"kind":"WRITE","substeps":["$90","TO __stage15_output"]}],"writeRatioAvg":0.000970873786407767}],"estimatedBytesProcessed":"798244160","timeline":[{"totalSlotMs":"4854","activeUnits":"24","completedUnits":"4","elapsedMs":"650","pendingUnits":"24"},{"totalSlotMs":"61601","activeUnits":"33","completedUnits":"114","elapsedMs":"1719","pendingUnits":"14"},{"totalSlotMs":"84385","activeUnits":"5","completedUnits":"128","elapsedMs":"2734","pendingUnits":"0"},{"totalSlotMs":"85627","activeUnits":"1","completedUnits":"129","elapsedMs":"3560","pendingUnits":"1"},{"totalSlotMs":"167572","activeUnits":"51","completedUnits":"330","elapsedMs":"5528","pendingUnits":"2"},{"totalSlotMs":"191584","activeUnits":"0","completedUnits":"332","elapsedMs":"18482","pendingUnits":"0"},{"totalSlotMs":"191584","activeUnits":"0","completedUnits":"332","elapsedMs":"20111","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"799014912","totalPartitionsProcessed":"0","totalBytesProcessed":"798244160","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_10"}]},"endTime":"1570972487291"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query87_1570972465"},"etag":"5vqCon4R1HztF/Qk6THY4g==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query87_1570972465?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonf7fba88848ec78ffd14cedf85d0d5f5c9e17dce3","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query87\nwith store_customers as (\n select distinct c_last_name as sc_last, c_first_name as sc_first, d_date as sc_date\n from store_sales, date_dim, customer\n where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n and store_sales.ss_customer_sk = customer.c_customer_sk\n and d_month_seq between 1188 and 1188+11\n),\ncatalog_customers as (\n select distinct c_last_name as cc_last, c_first_name as cc_first, d_date as cc_date\n from catalog_sales, date_dim, customer\n where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1188 and 1188+11\n),\nweb_customers as (\n select distinct c_last_name as wc_last, c_first_name as wc_first, d_date as wc_date\n from web_sales, date_dim, customer\n where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n and d_month_seq between 1188 and 1188+11\n)\nselect count(1) \nfrom store_customers \nwhere not exists (\n select 1 from catalog_customers \n where sc_last = cc_last and sc_first = cc_first and sc_date = cc_date\n)\nand not exists (\n select 1 from web_customers \n where sc_last = wc_last and sc_first = wc_first and sc_date = wc_date\n);\n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query87_1570972465","user_email":"nithish.sankaranarayanan@ulb.be"}
