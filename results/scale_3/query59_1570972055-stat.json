{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"172723","creationTime":"1570972056292","totalBytesProcessed":"662559343","startTime":"1570972056477","query":{"totalSlotMs":"172723","queryPlan":[{"readMsMax":"14","computeMsMax":"66","waitMsAvg":"86","id":"0","endMs":"1570972058995","waitMsMax":"86","startMs":"1570972058337","waitRatioMax":0.017615731257681278,"readRatioAvg":0.0028676771814829987,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.013519049569848422,"writeMsAvg":"599","status":"COMPLETE","writeMsMax":"599","computeMsAvg":"66","shuffleOutputBytesSpilled":"0","writeRatioMax":0.12269561655059402,"readMsAvg":"14","waitRatioAvg":0.017615731257681278,"completedParallelInputs":"1","computeRatioMax":0.013519049569848422,"name":"S00: Input","shuffleOutputBytes":"2201906","recordsWritten":"73049","readRatioMax":0.0028676771814829987,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_week_seq, $72:d_day_name","FROM date_dim"]},{"kind":"WRITE","substeps":["$70, $71, $72","TO __stage00_output","BY HASH($70)"]}],"writeRatioAvg":0.12269561655059402},{"readMsMax":"12","computeMsMax":"64","waitMsAvg":"2","id":"2","endMs":"1570972059059","waitMsMax":"2","startMs":"1570972058427","waitRatioMax":0.00040966816878328555,"readRatioAvg":0.0024580090126997134,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.013109381401065138,"writeMsAvg":"576","status":"COMPLETE","writeMsMax":"576","computeMsAvg":"64","shuffleOutputBytesSpilled":"0","writeRatioMax":0.11798443260958623,"readMsAvg":"12","waitRatioAvg":0.00040966816878328555,"completedParallelInputs":"1","computeRatioMax":0.013109381401065138,"name":"S02: Input","shuffleOutputBytes":"2201906","recordsWritten":"73049","readRatioMax":0.0024580090126997134,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_week_seq, $52:d_day_name","FROM date_dim"]},{"kind":"WRITE","substeps":["$50, $51, $52","TO __stage02_output","BY HASH($50)"]}],"writeRatioAvg":0.11798443260958623},{"readMsMax":"37","computeMsMax":"4882","inputStages":["0"],"waitMsAvg":"37","id":"4","endMs":"1570972061958","waitMsMax":"39","startMs":"1570972059152","waitRatioMax":0.007988529291274069,"readRatioAvg":0.005735354362965997,"parallelInputs":"10","recordsRead":"29532602","computeRatioAvg":0.9266693977877919,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"31","computeMsAvg":"4524","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006349856616140926,"readMsAvg":"28","waitRatioAvg":0.007578861122490782,"completedParallelInputs":"10","computeRatioMax":1,"name":"S04: Join+","shuffleOutputBytes":"10968536","recordsWritten":"136240","readRatioMax":0.007578861122490782,"steps":[{"kind":"READ","substeps":["$60:ss_sold_date_sk, $61:ss_store_sk, $62:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$70, $71, $72","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $222, $231 := $220","$140 := SUM($156)","$141 := SUM($155)","$142 := SUM($154)","$143 := SUM($153)","$144 := SUM($152)","$145 := SUM($151)","$146 := SUM($150)"]},{"kind":"COMPUTE","substeps":["$150 := case_no_value(equal($223, 'Saturday'), $221, NULL)","$151 := case_no_value(equal($223, 'Friday'), $221, NULL)","$152 := case_no_value(equal($223, 'Thursday'), $221, NULL)","$153 := case_no_value(equal($223, 'Wednesday'), $221, NULL)","$154 := case_no_value(equal($223, 'Tuesday'), $221, NULL)","$155 := case_no_value(equal($223, 'Monday'), $221, NULL)","$156 := case_no_value(equal($223, 'Sunday'), $221, NULL)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $60 = $70"]},{"kind":"WRITE","substeps":["$231, $230, $140, $141, $142, $143, $144, $145, $146","TO __stage04_output","BY HASH($230, $231)"]}],"writeRatioAvg":0.004916018025399427},{"readMsMax":"35","computeMsMax":"4556","inputStages":["2"],"waitMsAvg":"44","id":"5","endMs":"1570972062036","waitMsMax":"45","startMs":"1570972059395","waitRatioMax":0.009217533797623925,"readRatioAvg":0.005120852109791069,"parallelInputs":"10","recordsRead":"29532602","computeRatioAvg":0.8717738631708316,"writeMsAvg":"31","status":"COMPLETE","writeMsMax":"87","computeMsAvg":"4256","shuffleOutputBytesSpilled":"0","writeRatioMax":0.017820565342072922,"readMsAvg":"25","waitRatioAvg":0.009012699713232281,"completedParallelInputs":"10","computeRatioMax":0.9332240884883245,"name":"S05: Join+","shuffleOutputBytes":"10968536","recordsWritten":"136240","readRatioMax":0.007169192953707497,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_store_sk, $42:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$50, $51, $52","FROM __stage02_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $170 := $162, $171 := $160","$120 := SUM($136)","$121 := SUM($135)","$122 := SUM($134)","$123 := SUM($133)","$124 := SUM($132)","$125 := SUM($131)","$126 := SUM($130)"]},{"kind":"COMPUTE","substeps":["$130 := case_no_value(equal($163, 'Saturday'), $161, NULL)","$131 := case_no_value(equal($163, 'Friday'), $161, NULL)","$132 := case_no_value(equal($163, 'Thursday'), $161, NULL)","$133 := case_no_value(equal($163, 'Wednesday'), $161, NULL)","$134 := case_no_value(equal($163, 'Tuesday'), $161, NULL)","$135 := case_no_value(equal($163, 'Monday'), $161, NULL)","$136 := case_no_value(equal($163, 'Sunday'), $161, NULL)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $50"]},{"kind":"WRITE","substeps":["$171, $170, $120, $121, $122, $123, $124, $125, $126","TO __stage05_output","BY HASH($170, $171)"]}],"writeRatioAvg":0.006349856616140926},{"readMsMax":"10","computeMsMax":"8","waitMsAvg":"61","id":"6","endMs":"1570972062325","waitMsMax":"61","startMs":"1570972062209","waitRatioMax":0.01249487914789021,"readRatioAvg":0.0020483408439164277,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0016386726751331422,"writeMsAvg":"53","status":"COMPLETE","writeMsMax":"53","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010856206472757066,"readMsAvg":"10","waitRatioAvg":0.01249487914789021,"completedParallelInputs":"1","computeRatioMax":0.0016386726751331422,"name":"S06: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.0020483408439164277,"steps":[{"kind":"READ","substeps":["$31:d_week_seq, $30:d_month_seq","FROM date_dim","WHERE between($30, 1208, 1219)"]},{"kind":"WRITE","substeps":["$31","TO __stage06_output","BY HASH($31)"]}],"writeRatioAvg":0.010856206472757066},{"readMsMax":"29","computeMsMax":"8","waitMsAvg":"35","id":"7","endMs":"1570972062681","waitMsMax":"35","startMs":"1570972062325","waitRatioMax":0.007169192953707497,"readRatioAvg":0.00594018844735764,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.0016386726751331422,"writeMsAvg":"145","status":"COMPLETE","writeMsMax":"145","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0297009422367882,"readMsAvg":"29","waitRatioAvg":0.007169192953707497,"completedParallelInputs":"1","computeRatioMax":0.0016386726751331422,"name":"S07: Input","shuffleOutputBytes":"3060","recordsWritten":"102","readRatioMax":0.00594018844735764,"steps":[{"kind":"READ","substeps":["$20:s_store_sk, $21:s_store_id","FROM store"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage07_output","BY HASH($20)"]}],"writeRatioAvg":0.0297009422367882},{"readMsMax":"11","computeMsMax":"10","waitMsAvg":"58","id":"9","endMs":"1570972062977","waitMsMax":"58","startMs":"1570972062621","waitRatioMax":0.01188037689471528,"readRatioAvg":0.0022531749283080703,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0020483408439164277,"writeMsAvg":"197","status":"COMPLETE","writeMsMax":"197","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.040352314625153624,"readMsAvg":"11","waitRatioAvg":0.01188037689471528,"completedParallelInputs":"1","computeRatioMax":0.0020483408439164277,"name":"S09: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.0022531749283080703,"steps":[{"kind":"READ","substeps":["$11:d_week_seq, $10:d_month_seq","FROM date_dim","WHERE between($10, 1196, 1207)"]},{"kind":"WRITE","substeps":["$11","TO __stage09_output","BY HASH($11)"]}],"writeRatioAvg":0.040352314625153624},{"readMsMax":"0","computeMsMax":"182","inputStages":["5"],"waitMsAvg":"9","id":"11","endMs":"1570972063096","waitMsMax":"9","startMs":"1570972062900","waitRatioMax":0.0018435067595247848,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"136240","computeRatioAvg":0.03727980335927898,"writeMsAvg":"30","status":"COMPLETE","writeMsMax":"30","computeMsAvg":"182","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0061450225317492835,"readMsAvg":"0","waitRatioAvg":0.0018435067595247848,"completedParallelInputs":"1","computeRatioMax":0.03727980335927898,"name":"S0B: Aggregate","shuffleOutputBytes":"1077834","recordsWritten":"13362","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$171, $170, $120, $121, $122, $123, $124, $125, $126","FROM __stage05_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $170, $181 := $171","$100 := SUM($120)","$101 := SUM($121)","$102 := SUM($122)","$103 := SUM($123)","$104 := SUM($124)","$105 := SUM($125)","$106 := SUM($126)"]},{"kind":"WRITE","substeps":["$100, $101, $102, $103, $104, $105, $106, $180, $181","TO __stage0B_output","BY HASH($181)"]}],"writeRatioAvg":0.0061450225317492835},{"readMsMax":"0","computeMsMax":"176","inputStages":["4","6","7"],"waitMsAvg":"75","id":"12","endMs":"1570972063389","waitMsMax":"75","startMs":"1570972063080","waitRatioMax":0.015362556329373207,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"136707","computeRatioAvg":0.036050798852929125,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"176","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004506349856616141,"readMsAvg":"0","waitRatioAvg":0.015362556329373207,"completedParallelInputs":"1","computeRatioMax":0.036050798852929125,"name":"S0C: Join+","shuffleOutputBytes":"1728339","recordsWritten":"18615","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$231, $230, $140, $141, $142, $143, $144, $145, $146","FROM __stage04_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage07_output"]},{"kind":"READ","substeps":["$31","FROM __stage06_output"]},{"kind":"COMPUTE","substeps":["$90 := subtract($271, 52)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $250 = $31"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $241 = $20"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230, $241 := $231","$110 := SUM($140)","$111 := SUM($141)","$112 := SUM($142)","$113 := SUM($143)","$114 := SUM($144)","$115 := SUM($145)","$116 := SUM($146)"]},{"kind":"WRITE","substeps":["$90, $270, $272, $273, $274, $275, $276, $277, $278","TO __stage0C_output","BY HASH($270, $90)"]}],"writeRatioAvg":0.004506349856616141},{"readMsMax":"0","computeMsMax":"10","inputStages":["11"],"waitMsAvg":"172","id":"13","endMs":"1570972063577","waitMsMax":"191","startMs":"1570972063229","waitRatioMax":0.03912331011880377,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"13362","computeRatioAvg":0.0012290045063498567,"writeMsAvg":"73","status":"COMPLETE","writeMsMax":"207","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.042400655469070056,"readMsAvg":"0","waitRatioAvg":0.035231462515362556,"completedParallelInputs":"100","computeRatioMax":0.0020483408439164277,"name":"S0D: Coalesce","shuffleOutputBytes":"1077834","recordsWritten":"13362","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0B_output"]}],"writeRatioAvg":0.014952888160589923},{"readMsMax":"0","computeMsMax":"11","inputStages":["12"],"waitMsAvg":"66","id":"15","endMs":"1570972064459","waitMsMax":"74","startMs":"1570972063483","waitRatioMax":0.015157722244981565,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"18615","computeRatioAvg":0.0012290045063498567,"writeMsAvg":"180","status":"COMPLETE","writeMsMax":"446","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.09135600163867268,"readMsAvg":"0","waitRatioAvg":0.013519049569848422,"completedParallelInputs":"100","computeRatioMax":0.0022531749283080703,"name":"S0F: Coalesce","shuffleOutputBytes":"1728339","recordsWritten":"18615","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0C_output"]}],"writeRatioAvg":0.0368701351904957},{"readMsMax":"6","computeMsMax":"89","inputStages":["15","9","13"],"waitMsAvg":"73","id":"16","endMs":"1570972065032","waitMsMax":"73","startMs":"1570972063520","waitRatioMax":0.014952888160589923,"readRatioAvg":0.0012290045063498567,"parallelInputs":"1","recordsRead":"32445","computeRatioAvg":0.018230233510856206,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"89","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0010241704219582138,"readMsAvg":"6","waitRatioAvg":0.014952888160589923,"completedParallelInputs":"1","computeRatioMax":0.018230233510856206,"name":"S10: Join+","shuffleOutputBytes":"10200","recordsWritten":"100","readRatioMax":0.0012290045063498567,"steps":[{"kind":"READ","substeps":["$1:s_store_sk, $2:s_store_id, $3:s_store_name","FROM store"]},{"kind":"READ","substeps":["$100, $101, $102, $103, $104, $105, $106, $180, $181","FROM __stage0D_output"]},{"kind":"READ","substeps":["$11","FROM __stage09_output"]},{"kind":"READ","substeps":["$90, $270, $272, $273, $274, $275, $276, $277, $278","FROM __stage0F_output"]},{"kind":"COMPUTE","substeps":["$80 := divide($303, $310)","$81 := divide($304, $311)","$82 := divide($305, $312)","$83 := divide($306, $313)","$84 := divide($307, $314)","$85 := divide($308, $315)","$86 := divide($309, $316)"]},{"kind":"SORT","substeps":["$281 ASC, $280 ASC, $282 ASC","LIMIT 100"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $210 = $270, $212 = $90"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $190 = $11"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $181"]},{"kind":"WRITE","substeps":["$300, $301, $302, $80, $81, $82, $83, $84, $85, $86","TO __stage10_output"]}],"writeRatioAvg":0.0010241704219582138},{"readMsMax":"0","computeMsMax":"4","inputStages":["16"],"waitMsAvg":"9","id":"17","endMs":"1570972065190","waitMsMax":"9","startMs":"1570972063643","waitRatioMax":0.0018435067595247848,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0008193363375665711,"writeMsAvg":"13","status":"COMPLETE","writeMsMax":"13","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002662843097091356,"readMsAvg":"0","waitRatioAvg":0.0018435067595247848,"completedParallelInputs":"1","computeRatioMax":0.0008193363375665711,"name":"S11: Output","shuffleOutputBytes":"10200","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$300, $301, $302, $80, $81, $82, $83, $84, $85, $86","FROM __stage10_output"]},{"kind":"SORT","substeps":["$301 ASC, $300 ASC, $302 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$320, $321, $322, $323, $324, $325, $326, $327, $328, $329","TO __stage11_output"]}],"writeRatioAvg":0.002662843097091356}],"estimatedBytesProcessed":"662559343","timeline":[{"totalSlotMs":"3477","activeUnits":"22","completedUnits":"0","elapsedMs":"2360","pendingUnits":"22"},{"totalSlotMs":"10485","activeUnits":"20","completedUnits":"2","elapsedMs":"3020","pendingUnits":"20"},{"totalSlotMs":"91709","activeUnits":"6","completedUnits":"23","elapsedMs":"5920","pendingUnits":"2"},{"totalSlotMs":"115814","activeUnits":"101","completedUnits":"127","elapsedMs":"7104","pendingUnits":"102"},{"totalSlotMs":"172168","activeUnits":"70","completedUnits":"227","elapsedMs":"8173","pendingUnits":"2"},{"totalSlotMs":"172723","activeUnits":"2","completedUnits":"229","elapsedMs":"9523","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"662700032","totalPartitionsProcessed":"0","totalBytesProcessed":"662559343","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570972066032"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query59_1570972055"},"etag":"Lbw+wg5rZOWCOd2PRYzcZg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query59_1570972055?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon4dd015cf33112f89c2c1f51f72e1bacbfaef7943","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query59\nWITH wss \n AS (SELECT d_week_seq, \n ss_store_sk, \n Sum(CASE \n WHEN ( d_day_name = 'Sunday' ) THEN ss_sales_price \n ELSE NULL \n END) sun_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Monday' ) THEN ss_sales_price \n ELSE NULL \n END) mon_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Tuesday' ) THEN ss_sales_price \n ELSE NULL \n END) tue_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Wednesday' ) THEN ss_sales_price \n ELSE NULL \n END) wed_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Thursday' ) THEN ss_sales_price \n ELSE NULL \n END) thu_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Friday' ) THEN ss_sales_price \n ELSE NULL \n END) fri_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Saturday' ) THEN ss_sales_price \n ELSE NULL \n END) sat_sales \n FROM store_sales, \n date_dim \n WHERE d_date_sk = ss_sold_date_sk \n GROUP BY d_week_seq, \n ss_store_sk) \nSELECT s_store_name1, \n s_store_id1, \n d_week_seq1, \n sun_sales1 / sun_sales2, \n mon_sales1 / mon_sales2, \n tue_sales1 / tue_sales2, \n wed_sales1 / wed_sales2, \n thu_sales1 / thu_sales2, \n fri_sales1 / fri_sales2, \n sat_sales1 / sat_sales2 \nFROM (SELECT s_store_name s_store_name1, \n wss.d_week_seq d_week_seq1, \n s_store_id s_store_id1, \n sun_sales sun_sales1, \n mon_sales mon_sales1, \n tue_sales tue_sales1, \n wed_sales wed_sales1, \n thu_sales thu_sales1, \n fri_sales fri_sales1, \n sat_sales sat_sales1 \n FROM wss, \n store, \n date_dim d \n WHERE d.d_week_seq = wss.d_week_seq \n AND ss_store_sk = s_store_sk \n AND d_month_seq BETWEEN 1196 AND 1196 + 11) y, \n (SELECT s_store_name s_store_name2, \n wss.d_week_seq d_week_seq2, \n s_store_id s_store_id2, \n sun_sales sun_sales2, \n mon_sales mon_sales2, \n tue_sales tue_sales2, \n wed_sales wed_sales2, \n thu_sales thu_sales2, \n fri_sales fri_sales2, \n sat_sales sat_sales2 \n FROM wss, \n store, \n date_dim d \n WHERE d.d_week_seq = wss.d_week_seq \n AND ss_store_sk = s_store_sk \n AND d_month_seq BETWEEN 1196 + 12 AND 1196 + 23) x \nWHERE s_store_id1 = s_store_id2 \n AND d_week_seq1 = d_week_seq2 - 52 \nORDER BY s_store_name1, \n s_store_id1, \n d_week_seq1\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query59_1570972055","user_email":"nithish.sankaranarayanan@ulb.be"}
