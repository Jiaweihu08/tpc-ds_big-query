{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"111277","creationTime":"1570972541283","totalBytesProcessed":"1211473294","startTime":"1570972541492","query":{"totalSlotMs":"111277","queryPlan":[{"readMsMax":"27","computeMsMax":"9","waitMsAvg":"21","id":"0","endMs":"1570972541922","waitMsMax":"21","startMs":"1570972541696","waitRatioMax":0.0026064291920069507,"readRatioAvg":0.0033511232468660794,"parallelInputs":"1","recordsRead":"45","computeRatioAvg":0.001117041082288693,"writeMsAvg":"163","status":"COMPLETE","writeMsMax":"163","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02023085515700633,"readMsAvg":"27","waitRatioAvg":0.0026064291920069507,"completedParallelInputs":"1","computeRatioMax":0.001117041082288693,"name":"S00: Input","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.0033511232468660794,"steps":[{"kind":"READ","substeps":["$20:r_reason_sk, $21:r_reason_desc","FROM reason","WHERE equal($21, 'reason 38')"]},{"kind":"WRITE","substeps":["$20","TO __stage00_output","BY HASH($20)"]}],"writeRatioAvg":0.02023085515700633},{"readMsMax":"28","computeMsMax":"4873","waitMsAvg":"40","id":"1","endMs":"1570972544336","waitMsMax":"40","startMs":"1570972541730","waitRatioMax":0.004964627032394192,"readRatioAvg":0.0034752389226759338,"parallelInputs":"1","recordsRead":"2878330","computeRatioAvg":0.6048156882214224,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"4873","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0021099664887675312,"readMsAvg":"28","waitRatioAvg":0.004964627032394192,"completedParallelInputs":"1","computeRatioMax":0.6048156882214224,"name":"S01: Input","shuffleOutputBytes":"102006032","recordsWritten":"2878330","readRatioMax":0.0034752389226759338,"steps":[{"kind":"READ","substeps":["$10:sr_item_sk, $11:sr_reason_sk, $12:sr_ticket_number, $13:sr_return_quantity","FROM store_returns"]},{"kind":"WRITE","substeps":["$10, $11, $12, $13","TO __stage01_output","BY HASH($10, $12)"]}],"writeRatioAvg":0.0021099664887675312},{"readMsMax":"0","computeMsMax":"39","inputStages":["1"],"waitMsAvg":"3","id":"2","endMs":"1570972544867","waitMsMax":"6","startMs":"1570972544345","waitRatioMax":0.0007446940548591287,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2878330","computeRatioAvg":0.0035993545984857886,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"87","computeMsAvg":"29","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010798063795457367,"readMsAvg":"0","waitRatioAvg":0.00037234702742956435,"completedParallelInputs":"100","computeRatioMax":0.004840511356584336,"name":"S02: Coalesce","shuffleOutputBytes":"102006032","recordsWritten":"2878330","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage01_output"]}],"writeRatioAvg":0.0026064291920069507},{"readMsMax":"107","computeMsMax":"8057","inputStages":["0","2"],"waitMsAvg":"1","id":"3","endMs":"1570972549259","waitMsMax":"6","startMs":"1570972544366","waitRatioMax":0.0007446940548591287,"readRatioAvg":0.006081668114682885,"parallelInputs":"10","recordsRead":"57585422","computeRatioAvg":0.9026933101650738,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"7273","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0013652724339084025,"readMsAvg":"49","waitRatioAvg":0.00012411567580985477,"completedParallelInputs":"10","computeRatioMax":1,"name":"S03: Join+","shuffleOutputBytes":"1034132","recordsWritten":"58374","readRatioMax":0.013280377311654462,"steps":[{"kind":"READ","substeps":["$1:ss_item_sk, $2:ss_customer_sk, $3:ss_ticket_number, $4:ss_quantity, $5:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$10, $11, $12, $13","FROM __stage02_output"]},{"kind":"READ","substeps":["$20","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $80 := $70","$40 := SUM($50)"]},{"kind":"COMPUTE","substeps":["$50 := case_no_value(not(is_null($73)), multiply(CAST(subtract($71, $73) AS DOUBLE), $72), multiply(CAST($71 AS DOUBLE), $72))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $63 = $20"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $1 = $10, $3 = $12"]},{"kind":"WRITE","substeps":["$80, $40","TO __stage03_output","BY HASH($80)"]}],"writeRatioAvg":0.0007446940548591287},{"readMsMax":"0","computeMsMax":"34","inputStages":["3"],"waitMsAvg":"1","id":"4","endMs":"1570972549457","waitMsMax":"1","startMs":"1570972549261","waitRatioMax":0.00012411567580985477,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"58374","computeRatioAvg":0.0042199329775350625,"writeMsAvg":"106","status":"COMPLETE","writeMsMax":"106","computeMsAvg":"34","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013156261635844607,"readMsAvg":"0","waitRatioAvg":0.00012411567580985477,"completedParallelInputs":"1","computeRatioMax":0.0042199329775350625,"name":"S04: Sort+","shuffleOutputBytes":"1000","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$80, $40","FROM __stage03_output"]},{"kind":"SORT","substeps":["$30 ASC, $90 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $90 := $80","$30 := SUM($40)"]},{"kind":"WRITE","substeps":["$100, $101","TO __stage04_output"]}],"writeRatioAvg":0.013156261635844607},{"readMsMax":"0","computeMsMax":"5","inputStages":["4"],"waitMsAvg":"1","id":"5","endMs":"1570972549441","waitMsMax":"1","startMs":"1570972549344","waitRatioMax":0.00012411567580985477,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.000620578379049274,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007446940548591287,"readMsAvg":"0","waitRatioAvg":0.00012411567580985477,"completedParallelInputs":"1","computeRatioMax":0.000620578379049274,"name":"S05: Output","shuffleOutputBytes":"1000","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$100, $101","FROM __stage04_output"]},{"kind":"SORT","substeps":["$101 ASC, $100 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$110, $111","TO __stage05_output"]}],"writeRatioAvg":0.0007446940548591287}],"estimatedBytesProcessed":"1211473294","timeline":[{"totalSlotMs":"1200","activeUnits":"1","completedUnits":"1","elapsedMs":"705","pendingUnits":"1"},{"totalSlotMs":"37890","activeUnits":"13","completedUnits":"102","elapsedMs":"3877","pendingUnits":"10"},{"totalSlotMs":"47985","activeUnits":"12","completedUnits":"102","elapsedMs":"4515","pendingUnits":"10"},{"totalSlotMs":"110946","activeUnits":"9","completedUnits":"112","elapsedMs":"7830","pendingUnits":"2"},{"totalSlotMs":"111277","activeUnits":"1","completedUnits":"114","elapsedMs":"9732","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"1212153856","totalPartitionsProcessed":"0","totalBytesProcessed":"1211473294","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"reason","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570972551257"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query93_1570972539"},"etag":"dinmSaLvwI2J2AL6SR3I1w==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query93_1570972539?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon913bb0657ac9701bafde8ed7845fd488e6b5aa41","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query93\nSELECT ss_customer_sk, \n Sum(act_sales) sumsales \nFROM (SELECT ss_item_sk, \n ss_ticket_number, \n ss_customer_sk, \n CASE \n WHEN sr_return_quantity IS NOT NULL THEN \n ( ss_quantity - sr_return_quantity ) benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results warmup ss_sales_price \n ELSE ( ss_quantity benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results warmup ss_sales_price ) \n END act_sales \n FROM store_sales \n LEFT OUTER JOIN store_returns \n ON ( sr_item_sk = ss_item_sk \n AND sr_ticket_number = ss_ticket_number ), \n reason \n WHERE sr_reason_sk = r_reason_sk \n AND r_reason_desc = 'reason 38') t \nGROUP BY ss_customer_sk \nORDER BY sumsales, \n ss_customer_sk\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query93_1570972539","user_email":"nithish.sankaranarayanan@ulb.be"}
