{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"216942","creationTime":"1570993288507","totalBytesProcessed":"15573988862","startTime":"1570993288737","query":{"totalSlotMs":"216942","queryPlan":[{"readMsMax":"9","computeMsMax":"20","waitMsAvg":"2","id":"0","endMs":"1570993289130","waitMsMax":"2","startMs":"1570993289079","waitRatioMax":0.0017873100983020554,"readRatioAvg":0.00804289544235925,"parallelInputs":"1","recordsRead":"86400","computeRatioAvg":0.017873100983020553,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"20","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005361930294906166,"readMsAvg":"9","waitRatioAvg":0.0017873100983020554,"completedParallelInputs":"1","computeRatioMax":0.017873100983020553,"name":"S00: Input","shuffleOutputBytes":"680400","recordsWritten":"25200","readRatioMax":0.00804289544235925,"steps":[{"kind":"READ","substeps":["$1:t_time_sk, $2:t_hour, $3:t_minute, $4:t_meal_time","FROM time_dim","WHERE or(equal($4, 'breakfast'), equal($4, 'dinner'))"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.005361930294906166},{"readMsMax":"17","computeMsMax":"18","waitMsAvg":"14","id":"1","endMs":"1570993289359","waitMsMax":"14","startMs":"1570993289121","waitRatioMax":0.012511170688114389,"readRatioAvg":0.01519213583556747,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.0160857908847185,"writeMsAvg":"41","status":"COMPLETE","writeMsMax":"41","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03663985701519214,"readMsAvg":"17","waitRatioAvg":0.012511170688114389,"completedParallelInputs":"1","computeRatioMax":0.0160857908847185,"name":"S01: Input","shuffleOutputBytes":"147766","recordsWritten":"3777","readRatioMax":0.01519213583556747,"steps":[{"kind":"READ","substeps":["$10:i_item_sk, $11:i_brand_id, $12:i_brand, $13:i_manager_id","FROM item","WHERE equal($13, 1)"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.03663985701519214},{"readMsMax":"8","computeMsMax":"8","waitMsAvg":"4","id":"2","endMs":"1570993289332","waitMsMax":"4","startMs":"1570993289131","waitRatioMax":0.0035746201966041107,"readRatioAvg":0.0071492403932082215,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0071492403932082215,"writeMsAvg":"141","status":"COMPLETE","writeMsMax":"141","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.1260053619302949,"readMsAvg":"8","waitRatioAvg":0.0035746201966041107,"completedParallelInputs":"1","computeRatioMax":0.0071492403932082215,"name":"S02: Input","shuffleOutputBytes":"270","recordsWritten":"30","readRatioMax":0.0071492403932082215,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_year, $72:d_moy","FROM date_dim","WHERE and(equal($72, 11), equal($71, 2001))"]},{"kind":"WRITE","substeps":["$70","TO __stage02_output","BY HASH($70)"]}],"writeRatioAvg":0.1260053619302949},{"readMsMax":"21","computeMsMax":"14","waitMsAvg":"1","id":"4","endMs":"1570993289540","waitMsMax":"1","startMs":"1570993289240","waitRatioMax":0.0008936550491510277,"readRatioAvg":0.01876675603217158,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.012511170688114389,"writeMsAvg":"97","status":"COMPLETE","writeMsMax":"97","computeMsAvg":"14","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08668453976764968,"readMsAvg":"21","waitRatioAvg":0.0008936550491510277,"completedParallelInputs":"1","computeRatioMax":0.012511170688114389,"name":"S04: Input","shuffleOutputBytes":"270","recordsWritten":"30","readRatioMax":0.01876675603217158,"steps":[{"kind":"READ","substeps":["$60:d_date_sk, $61:d_year, $62:d_moy","FROM date_dim","WHERE and(equal($62, 11), equal($61, 2001))"]},{"kind":"WRITE","substeps":["$60","TO __stage04_output","BY HASH($60)"]}],"writeRatioAvg":0.08668453976764968},{"readMsMax":"11","computeMsMax":"13","waitMsAvg":"1","id":"6","endMs":"1570993289590","waitMsMax":"1","startMs":"1570993289395","waitRatioMax":0.0008936550491510277,"readRatioAvg":0.009830205540661306,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.01161751563896336,"writeMsAvg":"33","status":"COMPLETE","writeMsMax":"33","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.029490616621983913,"readMsAvg":"11","waitRatioAvg":0.0008936550491510277,"completedParallelInputs":"1","computeRatioMax":0.01161751563896336,"name":"S06: Input","shuffleOutputBytes":"270","recordsWritten":"30","readRatioMax":0.009830205540661306,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year, $52:d_moy","FROM date_dim","WHERE and(equal($52, 11), equal($51, 2001))"]},{"kind":"WRITE","substeps":["$50","TO __stage06_output","BY HASH($50)"]}],"writeRatioAvg":0.029490616621983913},{"readMsMax":"134","computeMsMax":"1119","inputStages":["0","2","4","6","1"],"waitMsAvg":"3","id":"8","endMs":"1570993290455","waitMsMax":"8","startMs":"1570993289735","waitRatioMax":0.0071492403932082215,"readRatioAvg":0.032171581769437,"parallelInputs":"417","recordsRead":"504512496","computeRatioAvg":0.3449508489722967,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"139","computeMsAvg":"386","shuffleOutputBytesSpilled":"0","writeRatioMax":0.12421805183199285,"readMsAvg":"36","waitRatioAvg":0.002680965147453083,"completedParallelInputs":"417","computeRatioMax":1,"name":"S08: Join+","shuffleOutputBytes":"6131922","recordsWritten":"107326","readRatioMax":0.11974977658623771,"steps":[{"kind":"READ","substeps":["$20:ws_sold_date_sk, $21:ws_sold_time_sk, $22:ws_item_sk, $23:ws_ext_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$50","FROM __stage06_output"]},{"kind":"READ","substeps":["$30:cs_sold_date_sk, $31:cs_sold_time_sk, $32:cs_item_sk, $33:cs_ext_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$60","FROM __stage04_output"]},{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_sold_time_sk, $42:ss_item_sk, $43:ss_ext_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$70","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage01_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $181, $191 := $180, $192 := $183, $193 := $184","$90 := SUM($182)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $173 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $101 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $30 = $60"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $70"]},{"kind":"WRITE","substeps":["$192, $193, $191, $190, $90","TO __stage08_output","BY HASH($190, $191, $192, $193)"]}],"writeRatioAvg":0.010723860589812333},{"readMsMax":"0","computeMsMax":"20","inputStages":["8"],"waitMsAvg":"1","id":"9","endMs":"1570993290740","waitMsMax":"1","startMs":"1570993290525","waitRatioMax":0.0008936550491510277,"readRatioAvg":0,"parallelInputs":"41","recordsRead":"107326","computeRatioAvg":0.01161751563896336,"writeMsAvg":"102","status":"COMPLETE","writeMsMax":"122","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.10902591599642537,"readMsAvg":"0","waitRatioAvg":0.0008936550491510277,"completedParallelInputs":"41","computeRatioMax":0.017873100983020553,"name":"S09: Aggregate","shuffleOutputBytes":"4001697","recordsWritten":"70178","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$192, $193, $191, $190, $90","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $200 := $190, $201 := $191, $202 := $192, $203 := $193","$80 := SUM($90)"]},{"kind":"WRITE","substeps":["$202, $203, $201, $200, $80","TO __stage09_output"]}],"writeRatioAvg":0.09115281501340483},{"readMsMax":"0","computeMsMax":"291","inputStages":["9"],"waitMsAvg":"113","id":"10","endMs":"1570993291167","waitMsMax":"113","startMs":"1570993290860","waitRatioMax":0.10098302055406613,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"70178","computeRatioAvg":0.26005361930294907,"writeMsAvg":"136","status":"COMPLETE","writeMsMax":"136","computeMsAvg":"291","shuffleOutputBytesSpilled":"0","writeRatioMax":0.12153708668453976,"readMsAvg":"0","waitRatioAvg":0.10098302055406613,"completedParallelInputs":"1","computeRatioMax":0.26005361930294907,"name":"S0A: Output","shuffleOutputBytes":"3510859","recordsWritten":"70178","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$202, $203, $201, $200, $80","FROM __stage09_output"]},{"kind":"SORT","substeps":["$80 DESC, $201 ASC"]},{"kind":"WRITE","substeps":["$210, $211, $212, $213, $214","TO __stage0A_output"]}],"writeRatioAvg":0.12153708668453976}],"estimatedBytesProcessed":"15573988862","timeline":[{"totalSlotMs":"31973","activeUnits":"93","completedUnits":"4","elapsedMs":"844","pendingUnits":"93"},{"totalSlotMs":"209359","activeUnits":"172","completedUnits":"422","elapsedMs":"1857","pendingUnits":"41"},{"totalSlotMs":"216942","activeUnits":"0","completedUnits":"464","elapsedMs":"3282","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"15574499328","totalPartitionsProcessed":"0","totalBytesProcessed":"15573988862","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"time_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_100"}]},"endTime":"1570993292112"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query71_1570993287"},"etag":"uGu/jxpQ2g7bhgkCmalMNg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query71_1570993287?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonac32660a4bc53890bff9e32433bf31c6d6957566","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query71\nSELECT i_brand_id brand_id, \n i_brand brand, \n t_hour, \n t_minute, \n Sum(ext_price) ext_price \nFROM item, \n (SELECT ws_ext_sales_price AS ext_price, \n ws_sold_date_sk AS sold_date_sk, \n ws_item_sk AS sold_item_sk, \n ws_sold_time_sk AS time_sk \n FROM web_sales, \n date_dim \n WHERE d_date_sk = ws_sold_date_sk \n AND d_moy = 11 \n AND d_year = 2001 \n UNION ALL \n SELECT cs_ext_sales_price AS ext_price, \n cs_sold_date_sk AS sold_date_sk, \n cs_item_sk AS sold_item_sk, \n cs_sold_time_sk AS time_sk \n FROM catalog_sales, \n date_dim \n WHERE d_date_sk = cs_sold_date_sk \n AND d_moy = 11 \n AND d_year = 2001 \n UNION ALL \n SELECT ss_ext_sales_price AS ext_price, \n ss_sold_date_sk AS sold_date_sk, \n ss_item_sk AS sold_item_sk, \n ss_sold_time_sk AS time_sk \n FROM store_sales, \n date_dim \n WHERE d_date_sk = ss_sold_date_sk \n AND d_moy = 11 \n AND d_year = 2001) AS tmp, \n time_dim \nWHERE sold_item_sk = i_item_sk \n AND i_manager_id = 1 \n AND time_sk = t_time_sk \n AND ( t_meal_time = 'breakfast' \n OR t_meal_time = 'dinner' ) \nGROUP BY i_brand, \n i_brand_id, \n t_hour, \n t_minute \nORDER BY ext_price DESC, \n i_brand_id; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query71_1570993287","user_email":"nithish.sankaranarayanan@ulb.be"}
