{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"42113","creationTime":"1570971915052","totalBytesProcessed":"1591468666","startTime":"1570971915337","query":{"totalSlotMs":"42113","queryPlan":[{"readMsMax":"14","computeMsMax":"8","waitMsAvg":"1","id":"0","endMs":"1570971915647","waitMsMax":"1","startMs":"1570971915573","waitRatioMax":0.0006341154090044388,"readRatioAvg":0.008877615726062143,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0050729232720355105,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004438807863031071,"readMsAvg":"14","waitRatioAvg":0.0006341154090044388,"completedParallelInputs":"1","computeRatioMax":0.0050729232720355105,"name":"S00: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.008877615726062143,"steps":[{"kind":"READ","substeps":["$1:d_date_sk, $2:d_year","FROM date_dim","WHERE equal($2, 1999)"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.004438807863031071},{"readMsMax":"12","computeMsMax":"41","waitMsAvg":"24","id":"1","endMs":"1570971915664","waitMsMax":"24","startMs":"1570971915616","waitRatioMax":0.015218769816106531,"readRatioAvg":0.007609384908053266,"parallelInputs":"1","recordsRead":"250000","computeRatioAvg":0.02599873176918199,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"41","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0050729232720355105,"readMsAvg":"12","waitRatioAvg":0.015218769816106531,"completedParallelInputs":"1","computeRatioMax":0.02599873176918199,"name":"S01: Input","shuffleOutputBytes":"1067328","recordsWritten":"66708","readRatioMax":0.007609384908053266,"steps":[{"kind":"READ","substeps":["$10:ca_address_sk, $11:ca_state, $12:ca_country","FROM customer_address","WHERE and(equal($12, 'United States'), or(in($11, 'TX', 'NE', 'MO'), in($11, 'CO', 'TN', 'ND'), in($11, 'OK', 'PA', 'CA')))"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.0050729232720355105},{"readMsMax":"64","computeMsMax":"632","waitMsAvg":"37","id":"2","endMs":"1570971916037","waitMsMax":"37","startMs":"1570971915648","waitRatioMax":0.023462270133164237,"readRatioAvg":0.040583386176284084,"parallelInputs":"1","recordsRead":"1920800","computeRatioAvg":0.40076093849080535,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"632","shuffleOutputBytesSpilled":"0","writeRatioMax":0.015218769816106531,"readMsAvg":"64","waitRatioAvg":0.023462270133164237,"completedParallelInputs":"1","computeRatioMax":0.40076093849080535,"name":"S02: Input","shuffleOutputBytes":"15640800","recordsWritten":"493920","readRatioMax":0.040583386176284084,"steps":[{"kind":"READ","substeps":["$30:cd_demo_sk, $31:cd_marital_status, $32:cd_education_status","FROM customer_demographics","WHERE and(or(equal($31, 'W'), equal($31, 'M'), equal($31, 'D')), ...)"]},{"kind":"WRITE","substeps":["$30, $31, $32","TO __stage02_output","BY HASH($30)"]}],"writeRatioAvg":0.015218769816106531},{"readMsMax":"26","computeMsMax":"7","waitMsAvg":"34","id":"3","endMs":"1570971915839","waitMsMax":"34","startMs":"1570971915659","waitRatioMax":0.02155992390615092,"readRatioAvg":0.016487000634115408,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.004438807863031071,"writeMsAvg":"142","status":"COMPLETE","writeMsMax":"142","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.09004438807863031,"readMsAvg":"26","waitRatioAvg":0.02155992390615092,"completedParallelInputs":"1","computeRatioMax":0.004438807863031071,"name":"S03: Input","shuffleOutputBytes":"918","recordsWritten":"102","readRatioMax":0.016487000634115408,"steps":[{"kind":"READ","substeps":["$20:s_store_sk","FROM store"]},{"kind":"WRITE","substeps":["$20","TO __stage03_output","BY HASH($20)"]}],"writeRatioAvg":0.09004438807863031},{"readMsMax":"0","computeMsMax":"13","inputStages":["2"],"waitMsAvg":"1","id":"6","endMs":"1570971916366","waitMsMax":"6","startMs":"1570971916067","waitRatioMax":0.003804692454026633,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"493920","computeRatioAvg":0.0050729232720355105,"writeMsAvg":"46","status":"COMPLETE","writeMsMax":"116","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0735573874445149,"readMsAvg":"0","waitRatioAvg":0.0006341154090044388,"completedParallelInputs":"100","computeRatioMax":0.008243500317057704,"name":"S06: Coalesce","shuffleOutputBytes":"15640800","recordsWritten":"493920","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage02_output"]}],"writeRatioAvg":0.029169308814204185},{"readMsMax":"115","computeMsMax":"1577","inputStages":["0","1","6","3"],"waitMsAvg":"5","id":"7","endMs":"1570971917146","waitMsMax":"6","startMs":"1570971916075","waitRatioMax":0.003804692454026633,"readRatioAvg":0.032339885859226376,"parallelInputs":"10","recordsRead":"34413062","computeRatioAvg":0.9340519974635384,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"3","computeMsAvg":"1473","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0019023462270133164,"readMsAvg":"51","waitRatioAvg":0.0031705770450221942,"completedParallelInputs":"10","computeRatioMax":1,"name":"S07: Join+","shuffleOutputBytes":"90","recordsWritten":"10","readRatioMax":0.07292327203551047,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_cdemo_sk, $42:ss_addr_sk, $43:ss_store_sk, $44:ss_quantity, $45:ss_sales_price, $46:ss_net_profit","FROM store_sales","WHERE and(or(between($45, 100, 150), between($45, 50, 100), between($45, 150, 200)), ...)"]},{"kind":"READ","substeps":["$20","FROM __stage03_output"]},{"kind":"READ","substeps":["$30, $31, $32","FROM __stage06_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage01_output"]},{"kind":"READ","substeps":["$1","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["$60 := SUM($120)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $110 = $1"]},{"kind":"FILTER","substeps":["or(and(in($113, 'TX', 'NE', 'MO'), between($112, 0, 2000)), and(in($113, 'CO', 'TN', 'ND'), between($112, 150, 3000)), ...)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $91 = $10"]},{"kind":"FILTER","substeps":["or(and(equal($95, 'W'), equal($96, 'Secondary'), between($93, 100, 150)), ...)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $71 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $43 = $20"]},{"kind":"WRITE","substeps":["$60","TO __stage07_output"]}],"writeRatioAvg":0.0019023462270133164},{"readMsMax":"0","computeMsMax":"5","inputStages":["7"],"waitMsAvg":"1","id":"8","endMs":"1570971917218","waitMsMax":"1","startMs":"1570971916095","waitRatioMax":0.0006341154090044388,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"10","computeRatioAvg":0.0031705770450221942,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.014584654407102092,"readMsAvg":"0","waitRatioAvg":0.0006341154090044388,"completedParallelInputs":"1","computeRatioMax":0.0031705770450221942,"name":"S08: Output","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$60","FROM __stage07_output"]},{"kind":"AGGREGATE","substeps":["$50 := SUM($60)"]},{"kind":"WRITE","substeps":["$50","TO __stage08_output"]}],"writeRatioAvg":0.014584654407102092}],"estimatedBytesProcessed":"1591468666","timeline":[{"totalSlotMs":"2488","activeUnits":"110","completedUnits":"4","elapsedMs":"741","pendingUnits":"111"},{"totalSlotMs":"27787","activeUnits":"110","completedUnits":"104","elapsedMs":"1259","pendingUnits":"11"},{"totalSlotMs":"42113","activeUnits":"11","completedUnits":"115","elapsedMs":"2239","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"1591738368","totalPartitionsProcessed":"0","totalBytesProcessed":"1591468666","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer_demographics","datasetId":"scale_10"}]},"endTime":"1570971917596"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query48_1570971913"},"etag":"ZBBaO2RnIUbcaOMHqTXrag==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query48_1570971913?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon5fdce83defb8d62f8cdd6926bcaada21164fe083","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query48\nSELECT Sum (ss_quantity) \nFROM store_sales, \n store, \n customer_demographics, \n customer_address, \n date_dim \nWHERE s_store_sk = ss_store_sk \n AND ss_sold_date_sk = d_date_sk \n AND d_year = 1999 \n AND ( ( cd_demo_sk = ss_cdemo_sk \n AND cd_marital_status = 'W' \n AND cd_education_status = 'Secondary' \n AND ss_sales_price BETWEEN 100.00 AND 150.00 ) \n OR ( cd_demo_sk = ss_cdemo_sk \n AND cd_marital_status = 'M' \n AND cd_education_status = 'Advanced Degree' \n AND ss_sales_price BETWEEN 50.00 AND 100.00 ) \n OR ( cd_demo_sk = ss_cdemo_sk \n AND cd_marital_status = 'D' \n AND cd_education_status = '2 yr Degree' \n AND ss_sales_price BETWEEN 150.00 AND 200.00 ) ) \n AND ( ( ss_addr_sk = ca_address_sk \n AND ca_country = 'United States' \n AND ca_state IN ( 'TX', 'NE', 'MO' ) \n AND ss_net_profit BETWEEN 0 AND 2000 ) \n OR ( ss_addr_sk = ca_address_sk \n AND ca_country = 'United States' \n AND ca_state IN ( 'CO', 'TN', 'ND' ) \n AND ss_net_profit BETWEEN 150 AND 3000 ) \n OR ( ss_addr_sk = ca_address_sk \n AND ca_country = 'United States' \n AND ca_state IN ( 'OK', 'PA', 'CA' ) \n AND ss_net_profit BETWEEN 50 AND 25000 ) ); \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query48_1570971913","user_email":"nithish.sankaranarayanan@ulb.be"}
