{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"83558","creationTime":"1570971549637","totalBytesProcessed":"1125183476","startTime":"1570971549808","query":{"totalSlotMs":"83558","queryPlan":[{"readMsMax":"35","computeMsMax":"1037","waitMsAvg":"1","id":"0","endMs":"1570971550658","waitMsMax":"1","startMs":"1570971549993","waitRatioMax":0.0001753155680224404,"readRatioAvg":0.006136044880785414,"parallelInputs":"1","recordsRead":"1920800","computeRatioAvg":0.1818022440392707,"writeMsAvg":"120","status":"COMPLETE","writeMsMax":"120","computeMsAvg":"1037","shuffleOutputBytesSpilled":"0","writeRatioMax":0.021037868162692847,"readMsAvg":"35","waitRatioAvg":0.0001753155680224404,"completedParallelInputs":"1","computeRatioMax":0.1818022440392707,"name":"S00: Input","shuffleOutputBytes":"17287200","recordsWritten":"1920800","readRatioMax":0.006136044880785414,"steps":[{"kind":"READ","substeps":["$1:cd_demo_sk","FROM customer_demographics"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.021037868162692847},{"readMsMax":"13","computeMsMax":"98","waitMsAvg":"24","id":"1","endMs":"1570971550274","waitMsMax":"24","startMs":"1570971550033","waitRatioMax":0.004207573632538569,"readRatioAvg":0.002279102384291725,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.017180925666199158,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"98","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0017531556802244039,"readMsAvg":"13","waitRatioAvg":0.004207573632538569,"completedParallelInputs":"1","computeRatioMax":0.017180925666199158,"name":"S01: Input","shuffleOutputBytes":"3060000","recordsWritten":"102000","readRatioMax":0.002279102384291725,"steps":[{"kind":"READ","substeps":["$10:i_item_sk, $11:i_item_id","FROM item"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.0017531556802244039},{"readMsMax":"19","computeMsMax":"160","waitMsAvg":"52","id":"2","endMs":"1570971550254","waitMsMax":"52","startMs":"1570971550076","waitRatioMax":0.0091164095371669,"readRatioAvg":0.0033309957924263674,"parallelInputs":"1","recordsRead":"1920800","computeRatioAvg":0.028050490883590462,"writeMsAvg":"50","status":"COMPLETE","writeMsMax":"50","computeMsAvg":"160","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00876577840112202,"readMsAvg":"19","waitRatioAvg":0.0091164095371669,"completedParallelInputs":"1","computeRatioMax":0.028050490883590462,"name":"S02: Input","shuffleOutputBytes":"2469600","recordsWritten":"137200","readRatioMax":0.0033309957924263674,"steps":[{"kind":"READ","substeps":["$20:cd_demo_sk, $23:cd_dep_count, $21:cd_gender, $22:cd_education_status","FROM customer_demographics","WHERE and(equal($21, 'F'), equal($22, 'Secondary'))"]},{"kind":"WRITE","substeps":["$20, $23","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.00876577840112202},{"readMsMax":"24","computeMsMax":"82","waitMsAvg":"80","id":"3","endMs":"1570971550325","waitMsMax":"80","startMs":"1570971550120","waitRatioMax":0.014025245441795231,"readRatioAvg":0.004207573632538569,"parallelInputs":"1","recordsRead":"250000","computeRatioAvg":0.014375876577840112,"writeMsAvg":"122","status":"COMPLETE","writeMsMax":"122","computeMsAvg":"82","shuffleOutputBytesSpilled":"0","writeRatioMax":0.021388499298737727,"readMsAvg":"24","waitRatioAvg":0.014025245441795231,"completedParallelInputs":"1","computeRatioMax":0.014375876577840112,"name":"S03: Input","shuffleOutputBytes":"3221398","recordsWritten":"61506","readRatioMax":0.004207573632538569,"steps":[{"kind":"READ","substeps":["$30:ca_address_sk, $31:ca_county, $32:ca_state, $33:ca_country","FROM customer_address","WHERE in($32, 'KS', 'IA', 'AL', 'UT', 'VA', 'NC', 'TX')"]},{"kind":"WRITE","substeps":["$30, $31, $32, $33","TO __stage03_output","BY HASH($30)"]}],"writeRatioAvg":0.021388499298737727},{"readMsMax":"11","computeMsMax":"7","waitMsAvg":"75","id":"4","endMs":"1570971550327","waitMsMax":"75","startMs":"1570971550127","waitRatioMax":0.013148667601683029,"readRatioAvg":0.0019284712482468443,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0012272089761570827,"writeMsAvg":"179","status":"COMPLETE","writeMsMax":"179","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03138148667601683,"readMsAvg":"11","waitRatioAvg":0.013148667601683029,"completedParallelInputs":"1","computeRatioMax":0.0012272089761570827,"name":"S04: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.0019284712482468443,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year","FROM date_dim","WHERE equal($51, 2001)"]},{"kind":"WRITE","substeps":["$50","TO __stage04_output","BY HASH($50)"]}],"writeRatioAvg":0.03138148667601683},{"readMsMax":"122","computeMsMax":"316","waitMsAvg":"64","id":"5","endMs":"1570971550649","waitMsMax":"64","startMs":"1570971550134","waitRatioMax":0.011220196353436185,"readRatioAvg":0.021388499298737727,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.05539971949509116,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"28","computeMsAvg":"316","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004908835904628331,"readMsAvg":"122","waitRatioAvg":0.011220196353436185,"completedParallelInputs":"1","computeRatioMax":0.05539971949509116,"name":"S05: Input","shuffleOutputBytes":"8506140","recordsWritten":"238199","readRatioMax":0.021388499298737727,"steps":[{"kind":"READ","substeps":["$60:c_customer_sk, $61:c_current_cdemo_sk, $62:c_current_addr_sk, $64:c_birth_year, $63:c_birth_month","FROM customer","WHERE in($63, 8, 4, 2, 5, 11, 9)"]},{"kind":"WRITE","substeps":["$60, $61, $62, $64","TO __stage05_output","BY HASH($60)"]}],"writeRatioAvg":0.004908835904628331},{"readMsMax":"0","computeMsMax":"12","inputStages":["2"],"waitMsAvg":"3","id":"7","endMs":"1570971550831","waitMsMax":"6","startMs":"1570971550723","waitRatioMax":0.0010518934081346423,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"137200","computeRatioAvg":0.0010518934081346423,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"31","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005434782608695652,"readMsAvg":"0","waitRatioAvg":0.0005259467040673212,"completedParallelInputs":"100","computeRatioMax":0.0021037868162692847,"name":"S07: Coalesce","shuffleOutputBytes":"2469600","recordsWritten":"137200","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage02_output"]}],"writeRatioAvg":0.003155680224403927},{"readMsMax":"0","computeMsMax":"20","inputStages":["0"],"waitMsAvg":"2","id":"9","endMs":"1570971551073","waitMsMax":"5","startMs":"1570971550835","waitRatioMax":0.0008765778401122019,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1920800","computeRatioAvg":0.002279102384291725,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"48","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008415147265077139,"readMsAvg":"0","waitRatioAvg":0.0003506311360448808,"completedParallelInputs":"100","computeRatioMax":0.0035063113604488078,"name":"S09: Coalesce","shuffleOutputBytes":"17287200","recordsWritten":"1920800","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage00_output"]}],"writeRatioAvg":0.003155680224403927},{"readMsMax":"506","computeMsMax":"5704","inputStages":["9","1","7","3","4","5"],"waitMsAvg":"1","id":"10","endMs":"1570971554323","waitMsMax":"5","startMs":"1570971550856","waitRatioMax":0.0008765778401122019,"readRatioAvg":0.07450911640953717,"parallelInputs":"8","recordsRead":"34077883","computeRatioAvg":0.8458976157082749,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"12","computeMsAvg":"4825","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0021037868162692847,"readMsAvg":"425","waitRatioAvg":0.0001753155680224404,"completedParallelInputs":"8","computeRatioMax":1,"name":"S0A: Join+","shuffleOutputBytes":"4031067","recordsWritten":"22870","readRatioMax":0.08870967741935484,"steps":[{"kind":"READ","substeps":["$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_bill_cdemo_sk, $43:cs_item_sk, $44:cs_quantity, $45:cs_list_price, $46:cs_sales_price, $47:cs_coupon_amt, $48:cs_net_profit","FROM catalog_sales"]},{"kind":"READ","substeps":["$60, $61, $62, $64","FROM __stage05_output"]},{"kind":"READ","substeps":["$50","FROM __stage04_output"]},{"kind":"READ","substeps":["$30, $31, $32, $33","FROM __stage03_output"]},{"kind":"READ","substeps":["$20, $23","FROM __stage07_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage01_output"]},{"kind":"READ","substeps":["$1","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $220 := $200, $221 := $204, $222 := $203, $223 := $202","$80 := SHARD_AVG($205)","$81 := SHARD_AVG($206)","$82 := SHARD_AVG($208)","$83 := SHARD_AVG($207)","$84 := SHARD_AVG($209)","$85 := SHARD_AVG($210)","$86 := SHARD_AVG($201)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $189 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $163 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $140 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $128 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $100 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $41 = $60"]},{"kind":"WRITE","substeps":["$220, $223, $222, $221, $80, $81, $82, $83, $84, $85, $86","TO __stage0A_output","BY HASH($220, $221, $222, $223)"]}],"writeRatioAvg":0.0010518934081346423},{"readMsMax":"0","computeMsMax":"80","inputStages":["10"],"waitMsAvg":"2","id":"11","endMs":"1570971554390","waitMsMax":"2","startMs":"1570971554328","waitRatioMax":0.0003506311360448808,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"22870","computeRatioAvg":0.014025245441795231,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"80","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0008765778401122019,"readMsAvg":"0","waitRatioAvg":0.0003506311360448808,"completedParallelInputs":"1","computeRatioMax":0.014025245441795231,"name":"S0B: Sort+","shuffleOutputBytes":"9663","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$220, $223, $222, $221, $80, $81, $82, $83, $84, $85, $86","FROM __stage0A_output"]},{"kind":"SORT","substeps":["$231 ASC, $232 ASC, $233 ASC, $230 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $220, $231 := $221, $232 := $222, $233 := $223","$70 := ROOT_AVG($80)","$71 := ROOT_AVG($81)","$72 := ROOT_AVG($82)","$73 := ROOT_AVG($83)","$74 := ROOT_AVG($84)","$75 := ROOT_AVG($85)","$76 := ROOT_AVG($86)"]},{"kind":"WRITE","substeps":["$240, $241, $242, $243, $244, $245, $246, $247, $248, $249, $250","TO __stage0B_output"]}],"writeRatioAvg":0.0008765778401122019},{"readMsMax":"0","computeMsMax":"6","inputStages":["11"],"waitMsAvg":"2","id":"12","endMs":"1570971554476","waitMsMax":"2","startMs":"1570971554348","waitRatioMax":0.0003506311360448808,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0010518934081346423,"writeMsAvg":"68","status":"COMPLETE","writeMsMax":"68","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011921458625525946,"readMsAvg":"0","waitRatioAvg":0.0003506311360448808,"completedParallelInputs":"1","computeRatioMax":0.0010518934081346423,"name":"S0C: Output","shuffleOutputBytes":"9663","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$240, $241, $242, $243, $244, $245, $246, $247, $248, $249, $250","FROM __stage0B_output"]},{"kind":"SORT","substeps":["$243 ASC, $242 ASC, $241 ASC, $240 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$260, $261, $262, $263, $264, $265, $266, $267, $268, $269, $270","TO __stage0C_output"]}],"writeRatioAvg":0.011921458625525946}],"estimatedBytesProcessed":"1125183476","timeline":[{"totalSlotMs":"2525","activeUnits":"10","completedUnits":"4","elapsedMs":"686","pendingUnits":"10"},{"totalSlotMs":"36392","activeUnits":"8","completedUnits":"206","elapsedMs":"1343","pendingUnits":"8"},{"totalSlotMs":"83558","activeUnits":"5","completedUnits":"216","elapsedMs":"4854","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"1126170624","totalPartitionsProcessed":"0","totalBytesProcessed":"1125183476","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer_demographics","datasetId":"scale_10"}]},"endTime":"1570971554688"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query18_1570971548"},"etag":"SebslYw/wHK6WUgZxMqapg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query18_1570971548?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon70f5b2cc79a691f9c7d5d1eefd88ff380f828766","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query18\nSELECT i_item_id, \n ca_country, \n ca_state, \n ca_county, \n Avg(cs_quantity) agg1, \n Avg(cs_list_price) agg2, \n Avg(cs_coupon_amt) agg3, \n Avg(cs_sales_price) agg4, \n Avg(cs_net_profit) agg5, \n Avg(c_birth_year) agg6, \n Avg(cd1.cd_dep_count) agg7 \nFROM catalog_sales, \n customer_demographics cd1, \n customer_demographics cd2, \n customer, \n customer_address, \n date_dim, \n item \nWHERE cs_sold_date_sk = d_date_sk \n AND cs_item_sk = i_item_sk \n AND cs_bill_cdemo_sk = cd1.cd_demo_sk \n AND cs_bill_customer_sk = c_customer_sk \n AND cd1.cd_gender = 'F' \n AND cd1.cd_education_status = 'Secondary' \n AND c_current_cdemo_sk = cd2.cd_demo_sk \n AND c_current_addr_sk = ca_address_sk \n AND c_birth_month IN ( 8, 4, 2, 5, \n 11, 9 ) \n AND d_year = 2001 \n AND ca_state IN ( 'KS', 'IA', 'AL', 'UT', \n 'VA', 'NC', 'TX' ) \nGROUP BY i_item_id, ca_country, ca_state, ca_county \nORDER BY ca_country, \n ca_state, \n ca_county, \n i_item_id\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query18_1570971548","user_email":"nithish.sankaranarayanan@ulb.be"}
