{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"74827","creationTime":"1570972079461","totalBytesProcessed":"1345974847","startTime":"1570972079829","query":{"totalSlotMs":"74827","queryPlan":[{"readMsMax":"22","computeMsMax":"26","waitMsAvg":"26","id":"1","endMs":"1570972081340","waitMsMax":"26","startMs":"1570972081170","waitRatioMax":0.012506012506012507,"readRatioAvg":0.010582010582010581,"parallelInputs":"1","recordsRead":"250000","computeRatioAvg":0.012506012506012507,"writeMsAvg":"76","status":"COMPLETE","writeMsMax":"76","computeMsAvg":"26","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03655603655603656,"readMsAvg":"22","waitRatioAvg":0.012506012506012507,"completedParallelInputs":"1","computeRatioMax":0.012506012506012507,"name":"S01: Input","shuffleOutputBytes":"244611","recordsWritten":"27179","readRatioMax":0.010582010582010581,"steps":[{"kind":"READ","substeps":["$50:ca_address_sk, $51:ca_gmt_offset","FROM customer_address","WHERE equal($51, -7)"]},{"kind":"WRITE","substeps":["$50","TO __stage01_output","BY HASH($50)"]}],"writeRatioAvg":0.03655603655603656},{"readMsMax":"18","computeMsMax":"389","waitMsAvg":"44","id":"2","endMs":"1570972081674","waitMsMax":"44","startMs":"1570972081212","waitRatioMax":0.021164021164021163,"readRatioAvg":0.008658008658008658,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.18710918710918711,"writeMsAvg":"86","status":"COMPLETE","writeMsMax":"86","computeMsAvg":"389","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04136604136604136,"readMsAvg":"18","waitRatioAvg":0.021164021164021163,"completedParallelInputs":"1","computeRatioMax":0.18710918710918711,"name":"S02: Input","shuffleOutputBytes":"9000000","recordsWritten":"500000","readRatioMax":0.008658008658008658,"steps":[{"kind":"READ","substeps":["$40:c_customer_sk, $41:c_current_addr_sk","FROM customer"]},{"kind":"WRITE","substeps":["$40, $41","TO __stage02_output","BY HASH($40)"]}],"writeRatioAvg":0.04136604136604136},{"readMsMax":"10","computeMsMax":"8","waitMsAvg":"14","id":"3","endMs":"1570972081346","waitMsMax":"14","startMs":"1570972081257","waitRatioMax":0.006734006734006734,"readRatioAvg":0.00481000481000481,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.003848003848003848,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00962000962000962,"readMsAvg":"10","waitRatioAvg":0.006734006734006734,"completedParallelInputs":"1","computeRatioMax":0.003848003848003848,"name":"S03: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.00481000481000481,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_year, $82:d_moy","FROM date_dim","WHERE and(equal($81, 2001), equal($82, 12))"]},{"kind":"WRITE","substeps":["$80","TO __stage03_output","BY HASH($80)"]}],"writeRatioAvg":0.00962000962000962},{"readMsMax":"0","computeMsMax":"5","waitMsAvg":"39","id":"4","endMs":"1570972081349","waitMsMax":"39","startMs":"1570972081301","waitRatioMax":0.01875901875901876,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"0","computeRatioAvg":0.002405002405002405,"writeMsAvg":"30","status":"COMPLETE","writeMsMax":"30","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01443001443001443,"readMsAvg":"0","waitRatioAvg":0.01875901875901876,"completedParallelInputs":"1","computeRatioMax":0.002405002405002405,"name":"S04: Input","shuffleOutputBytes":"0","recordsWritten":"0","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110:s_store_sk, $111:s_gmt_offset","FROM store","WHERE equal($111, -7)"]},{"kind":"WRITE","substeps":["$110","TO __stage04_output","BY HASH($110)"]}],"writeRatioAvg":0.01443001443001443},{"readMsMax":"11","computeMsMax":"14","waitMsAvg":"57","id":"6","endMs":"1570972081552","waitMsMax":"57","startMs":"1570972081350","waitRatioMax":0.027417027417027416,"readRatioAvg":0.005291005291005291,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.006734006734006734,"writeMsAvg":"178","status":"COMPLETE","writeMsMax":"178","computeMsAvg":"14","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08561808561808562,"readMsAvg":"11","waitRatioAvg":0.027417027417027416,"completedParallelInputs":"1","computeRatioMax":0.006734006734006734,"name":"S06: Input","shuffleOutputBytes":"91278","recordsWritten":"10142","readRatioMax":0.005291005291005291,"steps":[{"kind":"READ","substeps":["$1:i_item_sk, $2:i_category","FROM item","WHERE equal($2, 'Books')"]},{"kind":"WRITE","substeps":["$1","TO __stage06_output","BY HASH($1)"]}],"writeRatioAvg":0.08561808561808562},{"readMsMax":"12","computeMsMax":"23","waitMsAvg":"40","id":"7","endMs":"1570972081552","waitMsMax":"40","startMs":"1570972081351","waitRatioMax":0.01924001924001924,"readRatioAvg":0.005772005772005772,"parallelInputs":"1","recordsRead":"250000","computeRatioAvg":0.011063011063011063,"writeMsAvg":"155","status":"COMPLETE","writeMsMax":"155","computeMsAvg":"23","shuffleOutputBytesSpilled":"0","writeRatioMax":0.07455507455507455,"readMsAvg":"12","waitRatioAvg":0.01924001924001924,"completedParallelInputs":"1","computeRatioMax":0.011063011063011063,"name":"S07: Input","shuffleOutputBytes":"244611","recordsWritten":"27179","readRatioMax":0.005772005772005772,"steps":[{"kind":"READ","substeps":["$30:ca_address_sk, $31:ca_gmt_offset","FROM customer_address","WHERE equal($31, -7)"]},{"kind":"WRITE","substeps":["$30","TO __stage07_output","BY HASH($30)"]}],"writeRatioAvg":0.07455507455507455},{"readMsMax":"11","computeMsMax":"7","waitMsAvg":"10","id":"9","endMs":"1570972081564","waitMsMax":"10","startMs":"1570972081351","waitRatioMax":0.00481000481000481,"readRatioAvg":0.005291005291005291,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.003367003367003367,"writeMsAvg":"175","status":"COMPLETE","writeMsMax":"175","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08417508417508418,"readMsAvg":"11","waitRatioAvg":0.00481000481000481,"completedParallelInputs":"1","computeRatioMax":0.003367003367003367,"name":"S09: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.005291005291005291,"steps":[{"kind":"READ","substeps":["$60:d_date_sk, $61:d_year, $62:d_moy","FROM date_dim","WHERE and(equal($61, 2001), equal($62, 12))"]},{"kind":"WRITE","substeps":["$60","TO __stage09_output","BY HASH($60)"]}],"writeRatioAvg":0.08417508417508418},{"readMsMax":"17","computeMsMax":"9","waitMsAvg":"3","id":"10","endMs":"1570972081494","waitMsMax":"3","startMs":"1570972081447","waitRatioMax":0.001443001443001443,"readRatioAvg":0.008177008177008177,"parallelInputs":"1","recordsRead":"500","computeRatioAvg":0.004329004329004329,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002886002886002886,"readMsAvg":"17","waitRatioAvg":0.001443001443001443,"completedParallelInputs":"1","computeRatioMax":0.004329004329004329,"name":"S0A: Input","shuffleOutputBytes":"2196","recordsWritten":"244","readRatioMax":0.008177008177008177,"steps":[{"kind":"READ","substeps":["$100:p_promo_sk, $101:p_channel_dmail, $102:p_channel_email, $103:p_channel_tv","FROM promotion","WHERE or(equal($101, 'Y'), equal($102, 'Y'), equal($103, 'Y'))"]},{"kind":"WRITE","substeps":["$100","TO __stage0A_output","BY HASH($100)"]}],"writeRatioAvg":0.002886002886002886},{"readMsMax":"0","computeMsMax":"4","waitMsAvg":"1","id":"11","endMs":"1570972081541","waitMsMax":"1","startMs":"1570972081462","waitRatioMax":0.000481000481000481,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"0","computeRatioAvg":0.001924001924001924,"writeMsAvg":"30","status":"COMPLETE","writeMsMax":"30","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01443001443001443,"readMsAvg":"0","waitRatioAvg":0.000481000481000481,"completedParallelInputs":"1","computeRatioMax":0.001924001924001924,"name":"S0B: Input","shuffleOutputBytes":"0","recordsWritten":"0","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$120:s_store_sk, $121:s_gmt_offset","FROM store","WHERE equal($121, -7)"]},{"kind":"WRITE","substeps":["$120","TO __stage0B_output","BY HASH($120)"]}],"writeRatioAvg":0.01443001443001443},{"readMsMax":"109","computeMsMax":"2079","inputStages":["9","10","11"],"waitMsAvg":"2","id":"15","endMs":"1570972082767","waitMsMax":"2","startMs":"1570972081655","waitRatioMax":0.000962000962000962,"readRatioAvg":0.022126022126022125,"parallelInputs":"10","recordsRead":"28802112","computeRatioAvg":0.7792207792207793,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"1620","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002405002405002405,"readMsAvg":"46","waitRatioAvg":0.000962000962000962,"completedParallelInputs":"10","computeRatioMax":1,"name":"S0F: Join","shuffleOutputBytes":"0","recordsWritten":"0","readRatioMax":0.05242905242905243,"steps":[{"kind":"READ","substeps":["$90:ss_sold_date_sk, $91:ss_item_sk, $92:ss_customer_sk, $93:ss_store_sk, $94:ss_promo_sk, $95:ss_ext_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$120","FROM __stage0B_output"]},{"kind":"READ","substeps":["$100","FROM __stage0A_output"]},{"kind":"READ","substeps":["$60","FROM __stage09_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $200 = $60"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $183 = $100"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $93 = $120"]},{"kind":"WRITE","substeps":["$220, $221, $222","TO __stage0F_output","BY HASH($221)"]}],"writeRatioAvg":0.001443001443001443},{"readMsMax":"47","computeMsMax":"1761","inputStages":["1","2","3","4"],"waitMsAvg":"1","id":"16","endMs":"1570972082949","waitMsMax":"1","startMs":"1570972081786","waitRatioMax":0.000481000481000481,"readRatioAvg":0.016354016354016353,"parallelInputs":"10","recordsRead":"28802112","computeRatioAvg":0.6676286676286677,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"1388","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003848003848003848,"readMsAvg":"34","waitRatioAvg":0.000481000481000481,"completedParallelInputs":"10","computeRatioMax":0.847041847041847,"name":"S10: Join","shuffleOutputBytes":"0","recordsWritten":"0","readRatioMax":0.022607022607022607,"steps":[{"kind":"READ","substeps":["$70:ss_sold_date_sk, $71:ss_item_sk, $72:ss_customer_sk, $73:ss_store_sk, $74:ss_ext_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$110","FROM __stage04_output"]},{"kind":"READ","substeps":["$80","FROM __stage03_output"]},{"kind":"READ","substeps":["$40, $41","FROM __stage02_output"]},{"kind":"READ","substeps":["$50","FROM __stage01_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $302 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $291 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $270 = $80"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $73 = $110"]},{"kind":"WRITE","substeps":["$310, $311","TO __stage10_output","BY HASH($310)"]}],"writeRatioAvg":0.001443001443001443},{"readMsMax":"0","computeMsMax":"7","inputStages":["15"],"waitMsAvg":"6","id":"17","endMs":"1570972082990","waitMsMax":"9","startMs":"1570972082778","waitRatioMax":0.004329004329004329,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"0","computeRatioAvg":0.001443001443001443,"writeMsAvg":"163","status":"COMPLETE","writeMsMax":"194","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.09331409331409331,"readMsAvg":"0","waitRatioAvg":0.002886002886002886,"completedParallelInputs":"100","computeRatioMax":0.003367003367003367,"name":"S11: Coalesce","shuffleOutputBytes":"0","recordsWritten":"0","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0F_output"]}],"writeRatioAvg":0.0784030784030784},{"readMsMax":"18","computeMsMax":"60","inputStages":["6","7","17"],"waitMsAvg":"15","id":"18","endMs":"1570972083175","waitMsMax":"15","startMs":"1570972082788","waitRatioMax":0.007215007215007215,"readRatioAvg":0.008658008658008658,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.02886002886002886,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"60","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001924001924001924,"readMsAvg":"18","waitRatioAvg":0.007215007215007215,"completedParallelInputs":"1","computeRatioMax":0.02886002886002886,"name":"S12: Join+","shuffleOutputBytes":"1","recordsWritten":"1","readRatioMax":0.008658008658008658,"steps":[{"kind":"READ","substeps":["$20:c_customer_sk, $21:c_current_addr_sk","FROM customer"]},{"kind":"READ","substeps":["$220, $221, $222","FROM __stage11_output"]},{"kind":"READ","substeps":["$30","FROM __stage07_output"]},{"kind":"READ","substeps":["$1","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["$160 := SUM($250)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $240 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $232 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $221"]},{"kind":"WRITE","substeps":["$160","TO __stage12_output"]}],"writeRatioAvg":0.001924001924001924},{"readMsMax":"0","computeMsMax":"6","inputStages":["18"],"waitMsAvg":"14","id":"19","endMs":"1570972083235","waitMsMax":"14","startMs":"1570972082788","waitRatioMax":0.006734006734006734,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.002886002886002886,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003367003367003367,"readMsAvg":"0","waitRatioAvg":0.006734006734006734,"completedParallelInputs":"1","computeRatioMax":0.002886002886002886,"name":"S13: Aggregate","shuffleOutputBytes":"1","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$160","FROM __stage12_output"]},{"kind":"AGGREGATE","substeps":["$140 := SUM($160)"]},{"kind":"WRITE","substeps":["$140","TO __stage13_output"]}],"writeRatioAvg":0.003367003367003367},{"readMsMax":"0","computeMsMax":"9","inputStages":["16"],"waitMsAvg":"5","id":"20","endMs":"1570972083215","waitMsMax":"7","startMs":"1570972082960","waitRatioMax":0.003367003367003367,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"0","computeRatioAvg":0.002405002405002405,"writeMsAvg":"43","status":"COMPLETE","writeMsMax":"105","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.050505050505050504,"readMsAvg":"0","waitRatioAvg":0.002405002405002405,"completedParallelInputs":"100","computeRatioMax":0.004329004329004329,"name":"S14: Coalesce","shuffleOutputBytes":"0","recordsWritten":"0","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage10_output"]}],"writeRatioAvg":0.02068302068302068},{"readMsMax":"13","computeMsMax":"9","inputStages":["20"],"waitMsAvg":"6","id":"21","endMs":"1570972083375","waitMsMax":"6","startMs":"1570972082968","waitRatioMax":0.002886002886002886,"readRatioAvg":0.006253006253006253,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.004329004329004329,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"12","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005772005772005772,"readMsAvg":"13","waitRatioAvg":0.002886002886002886,"completedParallelInputs":"1","computeRatioMax":0.004329004329004329,"name":"S15: Join+","shuffleOutputBytes":"1","recordsWritten":"1","readRatioMax":0.006253006253006253,"steps":[{"kind":"READ","substeps":["$10:i_item_sk, $11:i_category","FROM item","WHERE equal($11, 'Books')"]},{"kind":"READ","substeps":["$310, $311","FROM __stage14_output"]},{"kind":"AGGREGATE","substeps":["$170 := SUM($320)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $10 = $310"]},{"kind":"WRITE","substeps":["$170","TO __stage15_output"]}],"writeRatioAvg":0.005772005772005772},{"readMsMax":"0","computeMsMax":"4","inputStages":["21"],"waitMsAvg":"5","id":"22","endMs":"1570972083410","waitMsMax":"5","startMs":"1570972082968","waitRatioMax":0.002405002405002405,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.001924001924001924,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003848003848003848,"readMsAvg":"0","waitRatioAvg":0.002405002405002405,"completedParallelInputs":"1","computeRatioMax":0.001924001924001924,"name":"S16: Aggregate","shuffleOutputBytes":"1","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$170","FROM __stage15_output"]},{"kind":"AGGREGATE","substeps":["$150 := SUM($170)"]},{"kind":"WRITE","substeps":["$150","TO __stage16_output"]}],"writeRatioAvg":0.003848003848003848},{"readMsMax":"0","computeMsMax":"10","inputStages":["19","22"],"waitMsAvg":"3","id":"23","endMs":"1570972083525","waitMsMax":"3","startMs":"1570972083468","waitRatioMax":0.001443001443001443,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2","computeRatioAvg":0.00481000481000481,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"25","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012025012025012025,"readMsAvg":"0","waitRatioAvg":0.001443001443001443,"completedParallelInputs":"1","computeRatioMax":0.00481000481000481,"name":"S17: Output","shuffleOutputBytes":"3","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$140","FROM __stage13_output"]},{"kind":"READ","substeps":["$150","FROM __stage16_output"]},{"kind":"SORT","substeps":["$330 ASC, $331 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$130 := multiply(divide($330, $331), 100)"]},{"kind":"JOIN","substeps":["CROSS ALL WITH ALL "]},{"kind":"WRITE","substeps":["$340, $341, $342","TO __stage17_output"]}],"writeRatioAvg":0.012025012025012025}],"estimatedBytesProcessed":"1345974847","timeline":[{"totalSlotMs":"2399","activeUnits":"13","completedUnits":"8","elapsedMs":"1802","pendingUnits":"23"},{"totalSlotMs":"39156","activeUnits":"107","completedUnits":"27","elapsedMs":"3054","pendingUnits":"105"},{"totalSlotMs":"74827","activeUnits":"1","completedUnits":"234","elapsedMs":"3987","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"1346371584","totalPartitionsProcessed":"0","totalBytesProcessed":"1345974847","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"promotion","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570972083990"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query61_1570972078"},"etag":"fxrhlpEf7nUVqNgQEdWMHg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query61_1570972078?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon2891d805ea7a9e58a6230a3483d317ca82618fbd","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query61\nSELECT promotions, \n total, \n promotions / \n total benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results warmup 100 \nFROM (SELECT Sum(ss_ext_sales_price) promotions \n FROM store_sales, \n store, \n promotion, \n date_dim, \n customer, \n customer_address, \n item \n WHERE ss_sold_date_sk = d_date_sk \n AND ss_store_sk = s_store_sk \n AND ss_promo_sk = p_promo_sk \n AND ss_customer_sk = c_customer_sk \n AND ca_address_sk = c_current_addr_sk \n AND ss_item_sk = i_item_sk \n AND ca_gmt_offset = -7 \n AND i_category = 'Books' \n AND ( p_channel_dmail = 'Y' \n OR p_channel_email = 'Y' \n OR p_channel_tv = 'Y' ) \n AND s_gmt_offset = -7 \n AND d_year = 2001 \n AND d_moy = 12) promotional_sales, \n (SELECT Sum(ss_ext_sales_price) total \n FROM store_sales, \n store, \n date_dim, \n customer, \n customer_address, \n item \n WHERE ss_sold_date_sk = d_date_sk \n AND ss_store_sk = s_store_sk \n AND ss_customer_sk = c_customer_sk \n AND ca_address_sk = c_current_addr_sk \n AND ss_item_sk = i_item_sk \n AND ca_gmt_offset = -7 \n AND i_category = 'Books' \n AND s_gmt_offset = -7 \n AND d_year = 2001 \n AND d_moy = 12) all_sales \nORDER BY promotions, \n total\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query61_1570972078","user_email":"nithish.sankaranarayanan@ulb.be"}
