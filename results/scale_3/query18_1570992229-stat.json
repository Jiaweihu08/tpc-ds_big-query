{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"980749","creationTime":"1570992230953","totalBytesProcessed":"10513864638","startTime":"1570992231142","query":{"totalSlotMs":"980749","queryPlan":[{"readMsMax":"26","computeMsMax":"1244","waitMsAvg":"1","id":"0","endMs":"1570992232348","waitMsMax":"1","startMs":"1570992231367","waitRatioMax":0.00022291573785109228,"readRatioAvg":0.0057958091841284,"parallelInputs":"1","recordsRead":"1920800","computeRatioAvg":0.2773071778867588,"writeMsAvg":"327","status":"COMPLETE","writeMsMax":"327","computeMsAvg":"1244","shuffleOutputBytesSpilled":"0","writeRatioMax":0.07289344627730718,"readMsAvg":"26","waitRatioAvg":0.00022291573785109228,"completedParallelInputs":"1","computeRatioMax":0.2773071778867588,"name":"S00: Input","shuffleOutputBytes":"17287200","recordsWritten":"1920800","readRatioMax":0.0057958091841284,"steps":[{"kind":"READ","substeps":["$1:cd_demo_sk","FROM customer_demographics"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.07289344627730718},{"readMsMax":"21","computeMsMax":"176","waitMsAvg":"16","id":"1","endMs":"1570992234216","waitMsMax":"16","startMs":"1570992231410","waitRatioMax":0.0035666518056174765,"readRatioAvg":0.004681230494872938,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.03923316986179224,"writeMsAvg":"2534","status":"COMPLETE","writeMsMax":"2534","computeMsAvg":"176","shuffleOutputBytesSpilled":"0","writeRatioMax":0.5648684797146678,"readMsAvg":"21","waitRatioAvg":0.0035666518056174765,"completedParallelInputs":"1","computeRatioMax":0.03923316986179224,"name":"S01: Input","shuffleOutputBytes":"6120000","recordsWritten":"204000","readRatioMax":0.004681230494872938,"steps":[{"kind":"READ","substeps":["$10:i_item_sk, $11:i_item_id","FROM item"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.5648684797146678},{"readMsMax":"20","computeMsMax":"152","waitMsAvg":"1","id":"2","endMs":"1570992231756","waitMsMax":"1","startMs":"1570992231483","waitRatioMax":0.00022291573785109228,"readRatioAvg":0.004458314757021846,"parallelInputs":"1","recordsRead":"1920800","computeRatioAvg":0.03388319215336603,"writeMsAvg":"134","status":"COMPLETE","writeMsMax":"134","computeMsAvg":"152","shuffleOutputBytesSpilled":"0","writeRatioMax":0.029870708872046365,"readMsAvg":"20","waitRatioAvg":0.00022291573785109228,"completedParallelInputs":"1","computeRatioMax":0.03388319215336603,"name":"S02: Input","shuffleOutputBytes":"2469600","recordsWritten":"137200","readRatioMax":0.004458314757021846,"steps":[{"kind":"READ","substeps":["$20:cd_demo_sk, $23:cd_dep_count, $21:cd_gender, $22:cd_education_status","FROM customer_demographics","WHERE and(equal($21, 'F'), equal($22, 'Secondary'))"]},{"kind":"WRITE","substeps":["$20, $23","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.029870708872046365},{"readMsMax":"33","computeMsMax":"384","waitMsAvg":"9","id":"3","endMs":"1570992231783","waitMsMax":"9","startMs":"1570992231525","waitRatioMax":0.0020062416406598305,"readRatioAvg":0.0073562193490860454,"parallelInputs":"1","recordsRead":"1000000","computeRatioAvg":0.08559964333481944,"writeMsAvg":"33","status":"COMPLETE","writeMsMax":"33","computeMsAvg":"384","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0073562193490860454,"readMsAvg":"33","waitRatioAvg":0.0020062416406598305,"completedParallelInputs":"1","computeRatioMax":0.08559964333481944,"name":"S03: Input","shuffleOutputBytes":"12860161","recordsWritten":"245541","readRatioMax":0.0073562193490860454,"steps":[{"kind":"READ","substeps":["$30:ca_address_sk, $31:ca_county, $32:ca_state, $33:ca_country","FROM customer_address","WHERE in($32, 'KS', 'IA', 'AL', 'UT', 'VA', 'NC', 'TX')"]},{"kind":"WRITE","substeps":["$30, $31, $32, $33","TO __stage03_output","BY HASH($30)"]}],"writeRatioAvg":0.0073562193490860454},{"readMsMax":"13","computeMsMax":"5","waitMsAvg":"38","id":"4","endMs":"1570992231773","waitMsMax":"38","startMs":"1570992231569","waitRatioMax":0.008470798038341507,"readRatioAvg":0.0028979045920642,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0011145786892554615,"writeMsAvg":"175","status":"COMPLETE","writeMsMax":"175","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03901025412394115,"readMsAvg":"13","waitRatioAvg":0.008470798038341507,"completedParallelInputs":"1","computeRatioMax":0.0011145786892554615,"name":"S04: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.0028979045920642,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year","FROM date_dim","WHERE equal($51, 2001)"]},{"kind":"WRITE","substeps":["$50","TO __stage04_output","BY HASH($50)"]}],"writeRatioAvg":0.03901025412394115},{"readMsMax":"84","computeMsMax":"1237","waitMsAvg":"56","id":"5","endMs":"1570992232398","waitMsMax":"56","startMs":"1570992231613","waitRatioMax":0.012483281319661168,"readRatioAvg":0.018724921979491754,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.2757467677218012,"writeMsAvg":"50","status":"COMPLETE","writeMsMax":"50","computeMsAvg":"1237","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011145786892554615,"readMsAvg":"84","waitRatioAvg":0.012483281319661168,"completedParallelInputs":"1","computeRatioMax":0.2757467677218012,"name":"S05: Input","shuffleOutputBytes":"34046076","recordsWritten":"953459","readRatioMax":0.018724921979491754,"steps":[{"kind":"READ","substeps":["$60:c_customer_sk, $61:c_current_cdemo_sk, $62:c_current_addr_sk, $64:c_birth_year, $63:c_birth_month","FROM customer","WHERE in($63, 8, 4, 2, 5, 11, 9)"]},{"kind":"WRITE","substeps":["$60, $61, $62, $64","TO __stage05_output","BY HASH($60)"]}],"writeRatioAvg":0.011145786892554615},{"readMsMax":"0","computeMsMax":"20","inputStages":["5"],"waitMsAvg":"2","id":"7","endMs":"1570992233357","waitMsMax":"6","startMs":"1570992232572","waitRatioMax":0.0013374944271065537,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"953459","computeRatioAvg":0.0026749888542131075,"writeMsAvg":"524","status":"COMPLETE","writeMsMax":"752","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.1676326348640214,"readMsAvg":"0","waitRatioAvg":0.00044583147570218456,"completedParallelInputs":"100","computeRatioMax":0.004458314757021846,"name":"S07: Coalesce","shuffleOutputBytes":"34046076","recordsWritten":"953459","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage05_output"]}],"writeRatioAvg":0.11680784663397235},{"readMsMax":"0","computeMsMax":"20","inputStages":["3"],"waitMsAvg":"5","id":"8","endMs":"1570992233453","waitMsMax":"7","startMs":"1570992232573","waitRatioMax":0.001560410164957646,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"245541","computeRatioAvg":0.0017833259028087382,"writeMsAvg":"275","status":"COMPLETE","writeMsMax":"676","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.1506910387873384,"readMsAvg":"0","waitRatioAvg":0.0011145786892554615,"completedParallelInputs":"100","computeRatioMax":0.004458314757021846,"name":"S08: Coalesce","shuffleOutputBytes":"12860161","recordsWritten":"245541","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage03_output"]}],"writeRatioAvg":0.06130182790905038},{"readMsMax":"0","computeMsMax":"12","inputStages":["2"],"waitMsAvg":"6","id":"9","endMs":"1570992233215","waitMsMax":"12","startMs":"1570992232572","waitRatioMax":0.0026749888542131075,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"137200","computeRatioAvg":0.001560410164957646,"writeMsAvg":"223","status":"COMPLETE","writeMsMax":"596","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.132857779759251,"readMsAvg":"0","waitRatioAvg":0.0013374944271065537,"completedParallelInputs":"100","computeRatioMax":0.0026749888542131075,"name":"S09: Coalesce","shuffleOutputBytes":"2469600","recordsWritten":"137200","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage02_output"]}],"writeRatioAvg":0.04971020954079358},{"readMsMax":"0","computeMsMax":"18","inputStages":["0"],"waitMsAvg":"1","id":"11","endMs":"1570992234867","waitMsMax":"3","startMs":"1570992234584","waitRatioMax":0.0006687472135532769,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1920800","computeRatioAvg":0.0028979045920642,"writeMsAvg":"54","status":"COMPLETE","writeMsMax":"119","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.026526972804279982,"readMsAvg":"0","waitRatioAvg":0.00022291573785109228,"completedParallelInputs":"100","computeRatioMax":0.004012483281319661,"name":"S0B: Coalesce","shuffleOutputBytes":"17287200","recordsWritten":"1920800","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage00_output"]}],"writeRatioAvg":0.012037449843958983},{"readMsMax":"317","computeMsMax":"4486","inputStages":["11","1","9","7","8","4"],"waitMsAvg":"2","id":"12","endMs":"1570992237534","waitMsMax":"13","startMs":"1570992234606","waitRatioMax":0.0028979045920642,"readRatioAvg":0.03031654034774855,"parallelInputs":"141","recordsRead":"351218324","computeRatioAvg":0.5276415514935354,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"60","computeMsAvg":"2367","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013374944271065538,"readMsAvg":"136","waitRatioAvg":0.00044583147570218456,"completedParallelInputs":"141","computeRatioMax":1,"name":"S0C: Join+","shuffleOutputBytes":"41201409","recordsWritten":"233905","readRatioMax":0.07066428889879625,"steps":[{"kind":"READ","substeps":["$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_bill_cdemo_sk, $43:cs_item_sk, $44:cs_quantity, $45:cs_list_price, $46:cs_sales_price, $47:cs_coupon_amt, $48:cs_net_profit","FROM catalog_sales"]},{"kind":"READ","substeps":["$60, $61, $62, $64","FROM __stage07_output"]},{"kind":"READ","substeps":["$50","FROM __stage04_output"]},{"kind":"READ","substeps":["$30, $31, $32, $33","FROM __stage08_output"]},{"kind":"READ","substeps":["$20, $23","FROM __stage09_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage01_output"]},{"kind":"READ","substeps":["$1","FROM __stage0B_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $220 := $200, $221 := $204, $222 := $203, $223 := $202","$80 := SHARD_AVG($205)","$81 := SHARD_AVG($206)","$82 := SHARD_AVG($208)","$83 := SHARD_AVG($207)","$84 := SHARD_AVG($209)","$85 := SHARD_AVG($210)","$86 := SHARD_AVG($201)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $189 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $163 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $140 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $128 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $100 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $41 = $60"]},{"kind":"WRITE","substeps":["$220, $223, $222, $221, $80, $81, $82, $83, $84, $85, $86","TO __stage0C_output","BY HASH($220, $221, $222, $223)"]}],"writeRatioAvg":0.0008916629514043691},{"readMsMax":"0","computeMsMax":"77","inputStages":["12"],"waitMsAvg":"1","id":"13","endMs":"1570992238686","waitMsMax":"1","startMs":"1570992237539","waitRatioMax":0.00022291573785109228,"readRatioAvg":0,"parallelInputs":"14","recordsRead":"233905","computeRatioAvg":0.014489522960321,"writeMsAvg":"85","status":"COMPLETE","writeMsMax":"121","computeMsAvg":"65","shuffleOutputBytesSpilled":"0","writeRatioMax":0.026972804279982165,"readMsAvg":"0","waitRatioAvg":0.00022291573785109228,"completedParallelInputs":"14","computeRatioMax":0.017164511814534107,"name":"S0D: Sort+","shuffleOutputBytes":"139386","recordsWritten":"1400","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$220, $223, $222, $221, $80, $81, $82, $83, $84, $85, $86","FROM __stage0C_output"]},{"kind":"SORT","substeps":["$231 ASC, $232 ASC, $233 ASC, $230 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $220, $231 := $221, $232 := $222, $233 := $223","$70 := ROOT_AVG($80)","$71 := ROOT_AVG($81)","$72 := ROOT_AVG($82)","$73 := ROOT_AVG($83)","$74 := ROOT_AVG($84)","$75 := ROOT_AVG($85)","$76 := ROOT_AVG($86)"]},{"kind":"WRITE","substeps":["$240, $241, $242, $243, $244, $245, $246, $247, $248, $249, $250","TO __stage0D_output"]}],"writeRatioAvg":0.018947837717342843},{"readMsMax":"0","computeMsMax":"9","inputStages":["13"],"waitMsAvg":"1","id":"14","endMs":"1570992239140","waitMsMax":"1","startMs":"1570992237594","waitRatioMax":0.00022291573785109228,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1400","computeRatioAvg":0.0020062416406598305,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0020062416406598305,"readMsAvg":"0","waitRatioAvg":0.00022291573785109228,"completedParallelInputs":"1","computeRatioMax":0.0020062416406598305,"name":"S0E: Output","shuffleOutputBytes":"9300","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$240, $241, $242, $243, $244, $245, $246, $247, $248, $249, $250","FROM __stage0D_output"]},{"kind":"SORT","substeps":["$243 ASC, $242 ASC, $241 ASC, $240 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$260, $261, $262, $263, $264, $265, $266, $267, $268, $269, $270","TO __stage0E_output"]}],"writeRatioAvg":0.0020062416406598305}],"estimatedBytesProcessed":"10513864638","timeline":[{"totalSlotMs":"1930","activeUnits":"144","completedUnits":"3","elapsedMs":"727","pendingUnits":"144"},{"totalSlotMs":"353935","activeUnits":"442","completedUnits":"305","elapsedMs":"2335","pendingUnits":"142"},{"totalSlotMs":"658815","activeUnits":"141","completedUnits":"406","elapsedMs":"3865","pendingUnits":"141"},{"totalSlotMs":"931947","activeUnits":"54","completedUnits":"520","elapsedMs":"5370","pendingUnits":"27"},{"totalSlotMs":"976446","activeUnits":"15","completedUnits":"547","elapsedMs":"6477","pendingUnits":"15"},{"totalSlotMs":"980749","activeUnits":"1","completedUnits":"562","elapsedMs":"8155","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"10514071552","totalPartitionsProcessed":"0","totalBytesProcessed":"10513864638","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer_demographics","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_100"}]},"endTime":"1570992239332"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query18_1570992229"},"etag":"fJTyVFiy3aOw7npChojrig==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query18_1570992229?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anone756a761b1241e70fe28e8070c53940ca778d6d1","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query18\nSELECT i_item_id, \n ca_country, \n ca_state, \n ca_county, \n Avg(cs_quantity) agg1, \n Avg(cs_list_price) agg2, \n Avg(cs_coupon_amt) agg3, \n Avg(cs_sales_price) agg4, \n Avg(cs_net_profit) agg5, \n Avg(c_birth_year) agg6, \n Avg(cd1.cd_dep_count) agg7 \nFROM catalog_sales, \n customer_demographics cd1, \n customer_demographics cd2, \n customer, \n customer_address, \n date_dim, \n item \nWHERE cs_sold_date_sk = d_date_sk \n AND cs_item_sk = i_item_sk \n AND cs_bill_cdemo_sk = cd1.cd_demo_sk \n AND cs_bill_customer_sk = c_customer_sk \n AND cd1.cd_gender = 'F' \n AND cd1.cd_education_status = 'Secondary' \n AND c_current_cdemo_sk = cd2.cd_demo_sk \n AND c_current_addr_sk = ca_address_sk \n AND c_birth_month IN ( 8, 4, 2, 5, \n 11, 9 ) \n AND d_year = 2001 \n AND ca_state IN ( 'KS', 'IA', 'AL', 'UT', \n 'VA', 'NC', 'TX' ) \nGROUP BY i_item_id, ca_country, ca_state, ca_county \nORDER BY ca_country, \n ca_state, \n ca_county, \n i_item_id\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query18_1570992229","user_email":"nithish.sankaranarayanan@ulb.be"}
