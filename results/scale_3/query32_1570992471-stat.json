{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"102042","creationTime":"1570992473749","totalBytesProcessed":"3449450700","startTime":"1570992473958","query":{"totalSlotMs":"102042","queryPlan":[{"readMsMax":"13","computeMsMax":"18","waitMsAvg":"3","id":"0","endMs":"1570992474176","waitMsMax":"3","startMs":"1570992474111","waitRatioMax":0.00264783759929391,"readRatioAvg":0.01147396293027361,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.01588702559576346,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01588702559576346,"readMsAvg":"13","waitRatioAvg":0.00264783759929391,"completedParallelInputs":"1","computeRatioMax":0.01588702559576346,"name":"S00: Input","shuffleOutputBytes":"828","recordsWritten":"92","readRatioMax":0.01147396293027361,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $11:d_date","FROM date_dim","WHERE between(CAST($11 AS DATE), 11385, 11476)"]},{"kind":"WRITE","substeps":["$10","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.01588702559576346},{"readMsMax":"12","computeMsMax":"21","waitMsAvg":"9","id":"2","endMs":"1570992474355","waitMsMax":"9","startMs":"1570992474164","waitRatioMax":0.00794351279788173,"readRatioAvg":0.01059135039717564,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.018534863195057368,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"21","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009708737864077669,"readMsAvg":"12","waitRatioAvg":0.00794351279788173,"completedParallelInputs":"1","computeRatioMax":0.018534863195057368,"name":"S02: Input","shuffleOutputBytes":"828","recordsWritten":"92","readRatioMax":0.01059135039717564,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_date","FROM date_dim","WHERE between(CAST($31 AS DATE), 11385, 11476)"]},{"kind":"WRITE","substeps":["$30","TO __stage02_output","BY HASH($30)"]}],"writeRatioAvg":0.009708737864077669},{"readMsMax":"17","computeMsMax":"9","waitMsAvg":"27","id":"3","endMs":"1570992474417","waitMsMax":"27","startMs":"1570992474199","waitRatioMax":0.02383053839364519,"readRatioAvg":0.01500441306266549,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.00794351279788173,"writeMsAvg":"186","status":"COMPLETE","writeMsMax":"186","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.1641659311562224,"readMsAvg":"17","waitRatioAvg":0.02383053839364519,"completedParallelInputs":"1","computeRatioMax":0.00794351279788173,"name":"S03: Input","shuffleOutputBytes":"1692","recordsWritten":"188","readRatioMax":0.01500441306266549,"steps":[{"kind":"READ","substeps":["$40:i_item_sk, $41:i_manufact_id","FROM item","WHERE equal($41, 610)"]},{"kind":"WRITE","substeps":["$40","TO __stage03_output","BY HASH($40)"]}],"writeRatioAvg":0.1641659311562224},{"readMsMax":"96","computeMsMax":"1133","inputStages":["0"],"waitMsAvg":"2","id":"5","endMs":"1570992475024","waitMsMax":"6","startMs":"1570992474315","waitRatioMax":0.00529567519858782,"readRatioAvg":0.02824360105913504,"parallelInputs":"141","recordsRead":"144023423","computeRatioAvg":0.1977052074139453,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"80","computeMsAvg":"224","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0706090026478376,"readMsAvg":"32","waitRatioAvg":0.00176522506619594,"completedParallelInputs":"141","computeRatioMax":1,"name":"S05: Join","shuffleOutputBytes":"75087270","recordsWritten":"4176163","readRatioMax":0.08473080317740513,"steps":[{"kind":"READ","substeps":["$1:cs_sold_date_sk, $2:cs_item_sk, $3:cs_ext_discount_amt","FROM catalog_sales"]},{"kind":"READ","substeps":["$10","FROM __stage00_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $10"]},{"kind":"WRITE","substeps":["$120, $121","TO __stage05_output","BY HASH($120)"]}],"writeRatioAvg":0.0088261253309797},{"readMsMax":"103","computeMsMax":"283","inputStages":["2","3"],"waitMsAvg":"2","id":"6","endMs":"1570992475102","waitMsMax":"4","startMs":"1570992474766","waitRatioMax":0.00353045013239188,"readRatioAvg":0.02824360105913504,"parallelInputs":"141","recordsRead":"144049931","computeRatioAvg":0.18358340688437777,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"70","computeMsAvg":"208","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0617828773168579,"readMsAvg":"32","waitRatioAvg":0.00176522506619594,"completedParallelInputs":"141","computeRatioMax":0.2497793468667255,"name":"S06: Join+","shuffleOutputBytes":"214642","recordsWritten":"4080","readRatioMax":0.09090909090909091,"steps":[{"kind":"READ","substeps":["$20:cs_sold_date_sk, $21:cs_item_sk, $22:cs_ext_discount_amt","FROM catalog_sales"]},{"kind":"READ","substeps":["$40","FROM __stage03_output"]},{"kind":"READ","substeps":["$30","FROM __stage02_output"]},{"kind":"COMPUTE","substeps":["$90 := UNIQUE_ROW_ID()"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $100 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $21 = $40"]},{"kind":"WRITE","substeps":["$90, $110, $111","TO __stage06_output","BY HASH($111)"]}],"writeRatioAvg":0.00353045013239188},{"readMsMax":"0","computeMsMax":"37","inputStages":["5","6"],"waitMsAvg":"2","id":"7","endMs":"1570992475259","waitMsMax":"8","startMs":"1570992475172","waitRatioMax":0.00706090026478376,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2635287","computeRatioAvg":0.0176522506619594,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"20","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00706090026478376,"readMsAvg":"0","waitRatioAvg":0.00176522506619594,"completedParallelInputs":"100","computeRatioMax":0.03265666372462489,"name":"S07: Join+","shuffleOutputBytes":"243202","recordsWritten":"4080","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$90, $110, $111","FROM __stage06_output"]},{"kind":"READ","substeps":["$120, $121","FROM __stage05_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $140 := $131","$80 := SHARD_AVG($132)","$81 := ANY_VALUE($130)"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH EACH ON $111 = $120"]},{"kind":"WRITE","substeps":["$80, $81, $140","TO __stage07_output","BY HASH($140)"]}],"writeRatioAvg":0.00353045013239188},{"readMsMax":"0","computeMsMax":"6","inputStages":["7"],"waitMsAvg":"1","id":"8","endMs":"1570992475306","waitMsMax":"2","startMs":"1570992475269","waitRatioMax":0.00176522506619594,"readRatioAvg":0,"parallelInputs":"28","recordsRead":"4080","computeRatioAvg":0.00353045013239188,"writeMsAvg":"2","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00529567519858782,"readMsAvg":"0","waitRatioAvg":0.00088261253309797,"completedParallelInputs":"28","computeRatioMax":0.00529567519858782,"name":"S08: Aggregate+","shuffleOutputBytes":"252","recordsWritten":"28","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$80, $81, $140","FROM __stage07_output"]},{"kind":"AGGREGATE","substeps":["$60 := SUM($71)"]},{"kind":"FILTER","substeps":["greater($71, multiply(1.3, $70))"]},{"kind":"AGGREGATE","substeps":["GROUP BY $150 := $140","$70 := ROOT_AVG($80)","$71 := ANY_VALUE($81)"]},{"kind":"WRITE","substeps":["$60","TO __stage08_output"]}],"writeRatioAvg":0.00176522506619594},{"readMsMax":"0","computeMsMax":"6","inputStages":["8"],"waitMsAvg":"2","id":"9","endMs":"1570992475391","waitMsMax":"2","startMs":"1570992475305","waitRatioMax":0.00176522506619594,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"28","computeRatioAvg":0.00529567519858782,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02118270079435128,"readMsAvg":"0","waitRatioAvg":0.00176522506619594,"completedParallelInputs":"1","computeRatioMax":0.00529567519858782,"name":"S09: Output","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$60","FROM __stage08_output"]},{"kind":"LIMIT","substeps":["100"]},{"kind":"AGGREGATE","substeps":["$50 := SUM($60)"]},{"kind":"WRITE","substeps":["$50","TO __stage09_output"]}],"writeRatioAvg":0.02118270079435128}],"estimatedBytesProcessed":"3449450700","timeline":[{"totalSlotMs":"46613","activeUnits":"10","completedUnits":"139","elapsedMs":"653","pendingUnits":"5"},{"totalSlotMs":"102042","activeUnits":"0","completedUnits":"414","elapsedMs":"1599","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"3449815040","totalPartitionsProcessed":"0","totalBytesProcessed":"3449450700","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_100"}]},"endTime":"1570992475595"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query32_1570992471"},"etag":"7qE073XlphpKA4njc7qJSQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query32_1570992471?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon6ac73d3070686877fb93bcbb0112934bcd364f15","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query32\nSELECT \n Sum(cs_ext_discount_amt) AS excess_discount_amount\nFROM catalog_sales , \n item , \n date_dim \nWHERE i_manufact_id = 610 \nAND i_item_sk = cs_item_sk \nAND Cast(d_date AS DATE) BETWEEN Cast('2001-03-04' AS DATE) AND ( \n Cast('2001-06-03' AS DATE)) \nAND d_date_sk = cs_sold_date_sk \nAND cs_ext_discount_amt > \n ( \n SELECT 1.3 benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results scale_2.zip warmup avg(cs_ext_discount_amt) \n FROM catalog_sales , \n date_dim \n WHERE cs_item_sk = i_item_sk \n AND Cast(d_date AS DATE) BETWEEN Cast('2001-03-04' AS DATE) AND ( \n Cast('2001-06-03' AS DATE)) \n AND d_date_sk = cs_sold_date_sk ) \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query32_1570992471","user_email":"nithish.sankaranarayanan@ulb.be"}
