{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"7383120","creationTime":"1570991908925","totalBytesProcessed":"23270636622","startTime":"1570991909150","query":{"totalSlotMs":"7383120","queryPlan":[{"readMsMax":"12","computeMsMax":"7","waitMsAvg":"1","id":"0","endMs":"1570991909611","waitMsMax":"1","startMs":"1570991909408","waitRatioMax":4.463488662738796e-05,"readRatioAvg":0.0005356186395286556,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0003124442063917158,"writeMsAvg":"181","status":"COMPLETE","writeMsMax":"181","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008078914479557222,"readMsAvg":"12","waitRatioAvg":4.463488662738796e-05,"completedParallelInputs":"1","computeRatioMax":0.0003124442063917158,"name":"S00: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0005356186395286556,"steps":[{"kind":"READ","substeps":["$180:d_date_sk, $181:d_year","FROM date_dim","WHERE equal($181, 2001)"]},{"kind":"WRITE","substeps":["$180, $181","TO __stage00_output","BY HASH($180)"]}],"writeRatioAvg":0.008078914479557222},{"readMsMax":"30","computeMsMax":"1817","waitMsAvg":"12","id":"2","endMs":"1570991910453","waitMsMax":"12","startMs":"1570991909553","waitRatioMax":0.0005356186395286556,"readRatioAvg":0.001339046598821639,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.08110158900196393,"writeMsAvg":"31","status":"COMPLETE","writeMsMax":"31","computeMsAvg":"1817","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001383681485449027,"readMsAvg":"30","waitRatioAvg":0.0005356186395286556,"completedParallelInputs":"1","computeRatioMax":0.08110158900196393,"name":"S02: Input","shuffleOutputBytes":"60000000","recordsWritten":"2000000","readRatioMax":0.001339046598821639,"steps":[{"kind":"READ","substeps":["$160:c_customer_sk, $161:c_customer_id","FROM customer"]},{"kind":"WRITE","substeps":["$160, $161","TO __stage02_output","BY HASH($160)"]}],"writeRatioAvg":0.001383681485449027},{"readMsMax":"17","computeMsMax":"8","waitMsAvg":"18","id":"3","endMs":"1570991909904","waitMsMax":"18","startMs":"1570991909575","waitRatioMax":0.0008034279592929834,"readRatioAvg":0.0007587930726655954,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0003570790930191037,"writeMsAvg":"297","status":"COMPLETE","writeMsMax":"297","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013256561328334226,"readMsAvg":"17","waitRatioAvg":0.0008034279592929834,"completedParallelInputs":"1","computeRatioMax":0.0003570790930191037,"name":"S03: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0007587930726655954,"steps":[{"kind":"READ","substeps":["$150:d_date_sk, $151:d_year","FROM date_dim","WHERE equal($151, 2001)"]},{"kind":"WRITE","substeps":["$150, $151","TO __stage03_output","BY HASH($150)"]}],"writeRatioAvg":0.013256561328334226},{"readMsMax":"42","computeMsMax":"2236","waitMsAvg":"5","id":"5","endMs":"1570991910711","waitMsMax":"5","startMs":"1570991909597","waitRatioMax":0.00022317443313693984,"readRatioAvg":0.0018746652383502945,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.09980360649883949,"writeMsAvg":"49","status":"COMPLETE","writeMsMax":"49","computeMsAvg":"2236","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00218710944474201,"readMsAvg":"42","waitRatioAvg":0.00022317443313693984,"completedParallelInputs":"1","computeRatioMax":0.09980360649883949,"name":"S05: Input","shuffleOutputBytes":"60000000","recordsWritten":"2000000","readRatioMax":0.0018746652383502945,"steps":[{"kind":"READ","substeps":["$130:c_customer_sk, $131:c_customer_id","FROM customer"]},{"kind":"WRITE","substeps":["$130, $131","TO __stage05_output","BY HASH($130)"]}],"writeRatioAvg":0.00218710944474201},{"readMsMax":"12","computeMsMax":"10","waitMsAvg":"197","id":"6","endMs":"1570991910116","waitMsMax":"197","startMs":"1570991909808","waitRatioMax":0.00879307266559543,"readRatioAvg":0.0005356186395286556,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.00044634886627387967,"writeMsAvg":"137","status":"COMPLETE","writeMsMax":"137","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006114979467952151,"readMsAvg":"12","waitRatioAvg":0.00879307266559543,"completedParallelInputs":"1","computeRatioMax":0.00044634886627387967,"name":"S06: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0005356186395286556,"steps":[{"kind":"READ","substeps":["$120:d_date_sk, $121:d_year","FROM date_dim","WHERE equal($121, 2002)"]},{"kind":"WRITE","substeps":["$120, $121","TO __stage06_output","BY HASH($120)"]}],"writeRatioAvg":0.006114979467952151},{"readMsMax":"23","computeMsMax":"2090","waitMsAvg":"165","id":"8","endMs":"1570991910952","waitMsMax":"165","startMs":"1570991909808","waitRatioMax":0.007364756293519015,"readRatioAvg":0.0010266023924299231,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.09328691305124084,"writeMsAvg":"49","status":"COMPLETE","writeMsMax":"49","computeMsAvg":"2090","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00218710944474201,"readMsAvg":"23","waitRatioAvg":0.007364756293519015,"completedParallelInputs":"1","computeRatioMax":0.09328691305124084,"name":"S08: Input","shuffleOutputBytes":"60000000","recordsWritten":"2000000","readRatioMax":0.0010266023924299231,"steps":[{"kind":"READ","substeps":["$100:c_customer_sk, $101:c_customer_id","FROM customer"]},{"kind":"WRITE","substeps":["$100, $101","TO __stage08_output","BY HASH($100)"]}],"writeRatioAvg":0.00218710944474201},{"readMsMax":"12","computeMsMax":"12","waitMsAvg":"147","id":"9","endMs":"1570991910014","waitMsMax":"147","startMs":"1570991909811","waitRatioMax":0.006561328334226031,"readRatioAvg":0.0005356186395286556,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0005356186395286556,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0009373326191751473,"readMsAvg":"12","waitRatioAvg":0.006561328334226031,"completedParallelInputs":"1","computeRatioMax":0.0005356186395286556,"name":"S09: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0005356186395286556,"steps":[{"kind":"READ","substeps":["$90:d_date_sk, $91:d_year","FROM date_dim","WHERE equal($91, 2002)"]},{"kind":"WRITE","substeps":["$90, $91","TO __stage09_output","BY HASH($90)"]}],"writeRatioAvg":0.0009373326191751473},{"readMsMax":"25","computeMsMax":"1943","waitMsAvg":"17","id":"11","endMs":"1570991910767","waitMsMax":"17","startMs":"1570991909808","waitRatioMax":0.0007587930726655954,"readRatioAvg":0.0011158721656846992,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.08672558471701482,"writeMsAvg":"35","status":"COMPLETE","writeMsMax":"35","computeMsAvg":"1943","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0015622210319585787,"readMsAvg":"25","waitRatioAvg":0.0007587930726655954,"completedParallelInputs":"1","computeRatioMax":0.08672558471701482,"name":"S0B: Input","shuffleOutputBytes":"60000000","recordsWritten":"2000000","readRatioMax":0.0011158721656846992,"steps":[{"kind":"READ","substeps":["$70:c_customer_sk, $71:c_customer_id","FROM customer"]},{"kind":"WRITE","substeps":["$70, $71","TO __stage0B_output","BY HASH($70)"]}],"writeRatioAvg":0.0015622210319585787},{"readMsMax":"13","computeMsMax":"9","waitMsAvg":"0","id":"12","endMs":"1570991910001","waitMsMax":"0","startMs":"1570991909809","waitRatioMax":0,"readRatioAvg":0.0005802535261560435,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0004017139796464917,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0008034279592929834,"readMsAvg":"13","waitRatioAvg":0,"completedParallelInputs":"1","computeRatioMax":0.0004017139796464917,"name":"S0C: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0005802535261560435,"steps":[{"kind":"READ","substeps":["$60:d_date_sk, $61:d_year","FROM date_dim","WHERE equal($61, 2001)"]},{"kind":"WRITE","substeps":["$60, $61","TO __stage0C_output","BY HASH($60)"]}],"writeRatioAvg":0.0008034279592929834},{"readMsMax":"41","computeMsMax":"2022","waitMsAvg":"3","id":"14","endMs":"1570991911136","waitMsMax":"3","startMs":"1570991909856","waitRatioMax":0.0001339046598821639,"readRatioAvg":0.0018300303517229067,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.09025174076057847,"writeMsAvg":"189","status":"COMPLETE","writeMsMax":"189","computeMsAvg":"2022","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008435993572576326,"readMsAvg":"41","waitRatioAvg":0.0001339046598821639,"completedParallelInputs":"1","computeRatioMax":0.09025174076057847,"name":"S0E: Input","shuffleOutputBytes":"60000000","recordsWritten":"2000000","readRatioMax":0.0018300303517229067,"steps":[{"kind":"READ","substeps":["$40:c_customer_sk, $41:c_customer_id","FROM customer"]},{"kind":"WRITE","substeps":["$40, $41","TO __stage0E_output","BY HASH($40)"]}],"writeRatioAvg":0.008435993572576326},{"readMsMax":"11","computeMsMax":"8","waitMsAvg":"1","id":"15","endMs":"1570991910050","waitMsMax":"1","startMs":"1570991909970","waitRatioMax":4.463488662738796e-05,"readRatioAvg":0.0004909837529012677,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0003570790930191037,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0004017139796464917,"readMsAvg":"11","waitRatioAvg":4.463488662738796e-05,"completedParallelInputs":"1","computeRatioMax":0.0003570790930191037,"name":"S0F: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0004909837529012677,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_year","FROM date_dim","WHERE equal($31, 2002)"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage0F_output","BY HASH($30)"]}],"writeRatioAvg":0.0004017139796464917},{"readMsMax":"25","computeMsMax":"1923","waitMsAvg":"1","id":"17","endMs":"1570991915600","waitMsMax":"1","startMs":"1570991910015","waitRatioMax":4.463488662738796e-05,"readRatioAvg":0.0011158721656846992,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.08583288698446706,"writeMsAvg":"4579","status":"COMPLETE","writeMsMax":"4579","computeMsAvg":"1923","shuffleOutputBytesSpilled":"0","writeRatioMax":0.2043831458668095,"readMsAvg":"25","waitRatioAvg":4.463488662738796e-05,"completedParallelInputs":"1","computeRatioMax":0.08583288698446706,"name":"S11: Input","shuffleOutputBytes":"60000000","recordsWritten":"2000000","readRatioMax":0.0011158721656846992,"steps":[{"kind":"READ","substeps":["$10:c_customer_sk, $11:c_customer_id","FROM customer"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage11_output","BY HASH($10)"]}],"writeRatioAvg":0.2043831458668095},{"readMsMax":"0","computeMsMax":"51","inputStages":["2"],"waitMsAvg":"9","id":"18","endMs":"1570991911309","waitMsMax":"32","startMs":"1570991910535","waitRatioMax":0.0014283163720764148,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2000000","computeRatioAvg":0.0009373326191751473,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"122","computeMsAvg":"21","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0054454561685413315,"readMsAvg":"0","waitRatioAvg":0.0004017139796464917,"completedParallelInputs":"100","computeRatioMax":0.0022763792179967862,"name":"S12: Coalesce","shuffleOutputBytes":"60000000","recordsWritten":"2000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage02_output"]}],"writeRatioAvg":0.001205141938939475},{"readMsMax":"148","computeMsMax":"3808","inputStages":["0","18"],"waitMsAvg":"14","id":"19","endMs":"1570991920925","waitMsMax":"20","startMs":"1570991910562","waitRatioMax":0.0008926977325477593,"readRatioAvg":0.0020978396714872345,"parallelInputs":"184","recordsRead":"649940083","computeRatioAvg":0.13551151580074985,"writeMsAvg":"62","status":"COMPLETE","writeMsMax":"5440","computeMsAvg":"3036","shuffleOutputBytesSpilled":"0","writeRatioMax":0.24281378325299055,"readMsAvg":"47","waitRatioAvg":0.0006248884127834316,"completedParallelInputs":"184","computeRatioMax":0.16996964827709338,"name":"S13: Join+","shuffleOutputBytes":"181125282","recordsWritten":"4644238","readRatioMax":0.006605963220853419,"steps":[{"kind":"READ","substeps":["$170:ss_sold_date_sk, $171:ss_customer_sk, $172:ss_ext_discount_amt, $173:ss_ext_sales_price, $174:ss_ext_wholesale_cost, $175:ss_ext_list_price","FROM store_sales"]},{"kind":"READ","substeps":["$160, $161","FROM __stage12_output"]},{"kind":"READ","substeps":["$180, $181","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $390 := $380, $391 := $385","$330 := SUM($360)"]},{"kind":"COMPUTE","substeps":["$360 := divide(add(subtract(subtract($384, $383), $381), $382), 2)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $371 = $180"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $171 = $160"]},{"kind":"WRITE","substeps":["$390, $391, $330","TO __stage13_output","BY HASH($390, $391)"]}],"writeRatioAvg":0.002767362970898054},{"readMsMax":"0","computeMsMax":"29","inputStages":["5"],"waitMsAvg":"5","id":"20","endMs":"1570991911761","waitMsMax":"7","startMs":"1570991910773","waitRatioMax":0.0003124442063917158,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2000000","computeRatioAvg":0.0008926977325477593,"writeMsAvg":"170","status":"COMPLETE","writeMsMax":"267","computeMsAvg":"20","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011917514729512586,"readMsAvg":"0","waitRatioAvg":0.00022317443313693984,"completedParallelInputs":"100","computeRatioMax":0.001294411712194251,"name":"S14: Coalesce","shuffleOutputBytes":"60000000","recordsWritten":"2000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage05_output"]}],"writeRatioAvg":0.007587930726655955},{"readMsMax":"102","computeMsMax":"4117","inputStages":["3","20"],"waitMsAvg":"2","id":"21","endMs":"1570991919913","waitMsMax":"5","startMs":"1570991910905","waitRatioMax":0.00022317443313693984,"readRatioAvg":0.0019639350116050706,"parallelInputs":"141","recordsRead":"426061916","computeRatioAvg":0.11587216568469916,"writeMsAvg":"15","status":"COMPLETE","writeMsMax":"395","computeMsAvg":"2596","shuffleOutputBytesSpilled":"0","writeRatioMax":0.017630780217818248,"readMsAvg":"44","waitRatioAvg":8.926977325477593e-05,"completedParallelInputs":"141","computeRatioMax":0.18376182824495627,"name":"S15: Join+","shuffleOutputBytes":"120712566","recordsWritten":"3095194","readRatioMax":0.0045527584359935725,"steps":[{"kind":"READ","substeps":["$140:cs_sold_date_sk, $141:cs_bill_customer_sk, $142:cs_ext_discount_amt, $143:cs_ext_sales_price, $144:cs_ext_wholesale_cost, $145:cs_ext_list_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$130, $131","FROM __stage14_output"]},{"kind":"READ","substeps":["$150, $151","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $480 := $470, $481 := $475","$320 := SUM($350)"]},{"kind":"COMPUTE","substeps":["$350 := divide(add(subtract(subtract($474, $473), $471), $472), 2)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $461 = $150"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $141 = $130"]},{"kind":"WRITE","substeps":["$480, $481, $320","TO __stage15_output","BY HASH($480, $481)"]}],"writeRatioAvg":0.0006695232994108195},{"readMsMax":"0","computeMsMax":"38","inputStages":["11"],"waitMsAvg":"1","id":"22","endMs":"1570991911893","waitMsMax":"3","startMs":"1570991910917","waitRatioMax":0.0001339046598821639,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2000000","computeRatioAvg":0.0009819675058025353,"writeMsAvg":"116","status":"COMPLETE","writeMsMax":"190","computeMsAvg":"22","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008480628459203714,"readMsAvg":"0","waitRatioAvg":4.463488662738796e-05,"completedParallelInputs":"100","computeRatioMax":0.0016961256918407428,"name":"S16: Coalesce","shuffleOutputBytes":"60000000","recordsWritten":"2000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0B_output"]}],"writeRatioAvg":0.005177646848777004},{"readMsMax":"305","computeMsMax":"3624","inputStages":["9","22"],"waitMsAvg":"3","id":"23","endMs":"1570991922656","waitMsMax":"9","startMs":"1570991910943","waitRatioMax":0.0004017139796464917,"readRatioAvg":0.0021424745581146223,"parallelInputs":"141","recordsRead":"426061916","computeRatioAvg":0.11524727727191574,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"401","computeMsAvg":"2582","shuffleOutputBytesSpilled":"0","writeRatioMax":0.017898589537582575,"readMsAvg":"48","waitRatioAvg":0.0001339046598821639,"completedParallelInputs":"141","computeRatioMax":0.161756829137654,"name":"S17: Join+","shuffleOutputBytes":"120716349","recordsWritten":"3095291","readRatioMax":0.01361364042135333,"steps":[{"kind":"READ","substeps":["$80:cs_sold_date_sk, $81:cs_bill_customer_sk, $82:cs_ext_discount_amt, $83:cs_ext_sales_price, $84:cs_ext_wholesale_cost, $85:cs_ext_list_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$70, $71","FROM __stage16_output"]},{"kind":"READ","substeps":["$90, $91","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $530 := $520, $531 := $525","$270 := SUM($300)"]},{"kind":"COMPUTE","substeps":["$300 := divide(add(subtract(subtract($524, $523), $521), $522), 2)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $511 = $90"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $81 = $70"]},{"kind":"WRITE","substeps":["$530, $531, $270","TO __stage17_output","BY HASH($530, $531)"]}],"writeRatioAvg":0.0007587930726655954},{"readMsMax":"0","computeMsMax":"32","inputStages":["8"],"waitMsAvg":"1","id":"24","endMs":"1570991911969","waitMsMax":"4","startMs":"1570991911044","waitRatioMax":0.00017853954650955185,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2000000","computeRatioAvg":0.0010266023924299231,"writeMsAvg":"148","status":"COMPLETE","writeMsMax":"213","computeMsAvg":"23","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009507230851633637,"readMsAvg":"0","waitRatioAvg":4.463488662738796e-05,"completedParallelInputs":"100","computeRatioMax":0.0014283163720764148,"name":"S18: Coalesce","shuffleOutputBytes":"60000000","recordsWritten":"2000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage08_output"]}],"writeRatioAvg":0.006605963220853419},{"readMsMax":"90","computeMsMax":"3883","inputStages":["6","24"],"waitMsAvg":"3","id":"25","endMs":"1570991915393","waitMsMax":"6","startMs":"1570991911193","waitRatioMax":0.0002678093197643278,"readRatioAvg":0.0020085698982324584,"parallelInputs":"184","recordsRead":"649940083","computeRatioAvg":0.134261738975183,"writeMsAvg":"39","status":"COMPLETE","writeMsMax":"1260","computeMsAvg":"3008","shuffleOutputBytesSpilled":"0","writeRatioMax":0.056239957150508835,"readMsAvg":"45","waitRatioAvg":0.0001339046598821639,"completedParallelInputs":"184","computeRatioMax":0.17331726477414747,"name":"S19: Join+","shuffleOutputBytes":"182144313","recordsWritten":"4670367","readRatioMax":0.004017139796464917,"steps":[{"kind":"READ","substeps":["$110:ss_sold_date_sk, $111:ss_customer_sk, $112:ss_ext_discount_amt, $113:ss_ext_sales_price, $114:ss_ext_wholesale_cost, $115:ss_ext_list_price","FROM store_sales"]},{"kind":"READ","substeps":["$100, $101","FROM __stage18_output"]},{"kind":"READ","substeps":["$120, $121","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $430 := $420, $431 := $425","$310 := SUM($340)"]},{"kind":"COMPUTE","substeps":["$340 := divide(add(subtract(subtract($424, $423), $421), $422), 2)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $411 = $120"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $111 = $100"]},{"kind":"WRITE","substeps":["$430, $431, $310","TO __stage19_output","BY HASH($430, $431)"]}],"writeRatioAvg":0.0017407605784681307},{"readMsMax":"0","computeMsMax":"31","inputStages":["14"],"waitMsAvg":"1","id":"26","endMs":"1570991913009","waitMsMax":"4","startMs":"1570991911201","waitRatioMax":0.00017853954650955185,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2000000","computeRatioAvg":0.0009373326191751473,"writeMsAvg":"182","status":"COMPLETE","writeMsMax":"289","computeMsAvg":"21","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012899482235315122,"readMsAvg":"0","waitRatioAvg":4.463488662738796e-05,"completedParallelInputs":"100","computeRatioMax":0.001383681485449027,"name":"S1A: Coalesce","shuffleOutputBytes":"60000000","recordsWritten":"2000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0E_output"]}],"writeRatioAvg":0.00812354936618461},{"readMsMax":"122","computeMsMax":"2823","inputStages":["12","26"],"waitMsAvg":"6","id":"27","endMs":"1570991919122","waitMsMax":"14","startMs":"1570991911318","waitRatioMax":0.0006248884127834316,"readRatioAvg":0.0020978396714872345,"parallelInputs":"92","recordsRead":"254507655","computeRatioAvg":0.10355293697554008,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"88","computeMsAvg":"2320","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003927870023210141,"readMsAvg":"47","waitRatioAvg":0.0002678093197643278,"completedParallelInputs":"92","computeRatioMax":0.12600428494911622,"name":"S1B: Join+","shuffleOutputBytes":"45346392","recordsWritten":"1162728","readRatioMax":0.0054454561685413315,"steps":[{"kind":"READ","substeps":["$50:ws_sold_date_sk, $51:ws_bill_customer_sk, $52:ws_ext_discount_amt, $53:ws_ext_sales_price, $54:ws_ext_wholesale_cost, $55:ws_ext_list_price","FROM web_sales"]},{"kind":"READ","substeps":["$40, $41","FROM __stage1A_output"]},{"kind":"READ","substeps":["$60, $61","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $580 := $570, $581 := $575","$240 := SUM($280)"]},{"kind":"COMPUTE","substeps":["$280 := divide(add(subtract(subtract($574, $573), $571), $572), 2)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $561 = $60"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $51 = $40"]},{"kind":"WRITE","substeps":["$580, $581, $240","TO __stage1B_output","BY HASH($580, $581)"]}],"writeRatioAvg":0.0011158721656846992},{"readMsMax":"0","computeMsMax":"27","inputStages":["17"],"waitMsAvg":"85","id":"28","endMs":"1570991916460","waitMsMax":"106","startMs":"1570991915746","waitRatioMax":0.004731297982503125,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2000000","computeRatioAvg":0.0008480628459203714,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"110","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004909837529012676,"readMsAvg":"0","waitRatioAvg":0.0037939653633279774,"completedParallelInputs":"100","computeRatioMax":0.001205141938939475,"name":"S1C: Coalesce","shuffleOutputBytes":"60000000","recordsWritten":"2000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage11_output"]}],"writeRatioAvg":0.0008480628459203714},{"readMsMax":"194","computeMsMax":"2825","inputStages":["15","28"],"waitMsAvg":"114","id":"29","endMs":"1570991925397","waitMsMax":"133","startMs":"1570991915795","waitRatioMax":0.005936439921442599,"readRatioAvg":0.002544188537761114,"parallelInputs":"92","recordsRead":"254507655","computeRatioAvg":0.10364220674879486,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"381","computeMsAvg":"2322","shuffleOutputBytesSpilled":"0","writeRatioMax":0.017005891805034815,"readMsAvg":"57","waitRatioAvg":0.005088377075522228,"completedParallelInputs":"92","computeRatioMax":0.126093554722371,"name":"S1D: Join+","shuffleOutputBytes":"45626373","recordsWritten":"1169907","readRatioMax":0.008659168005713265,"steps":[{"kind":"READ","substeps":["$20:ws_sold_date_sk, $21:ws_bill_customer_sk, $22:ws_ext_discount_amt, $23:ws_ext_sales_price, $24:ws_ext_wholesale_cost, $25:ws_ext_list_price","FROM web_sales"]},{"kind":"READ","substeps":["$10, $11","FROM __stage1C_output"]},{"kind":"READ","substeps":["$30, $31","FROM __stage0F_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $630 := $620, $631 := $625","$210 := SUM($230)"]},{"kind":"COMPUTE","substeps":["$230 := divide(add(subtract(subtract($624, $623), $621), $622), 2)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $611 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $21 = $10"]},{"kind":"WRITE","substeps":["$630, $631, $210","TO __stage1D_output","BY HASH($630, $631)"]}],"writeRatioAvg":0.0011158721656846992},{"readMsMax":"114","computeMsMax":"3142","waitMsAvg":"1","id":"30","endMs":"1570991933105","waitMsMax":"1","startMs":"1570991931565","waitRatioMax":4.463488662738796e-05,"readRatioAvg":0.005088377075522228,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.14024281378325298,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"3142","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0008034279592929834,"readMsAvg":"114","waitRatioAvg":4.463488662738796e-05,"completedParallelInputs":"1","computeRatioMax":0.14024281378325298,"name":"S1E: Input","shuffleOutputBytes":"96192074","recordsWritten":"2000000","readRatioMax":0.005088377075522228,"steps":[{"kind":"READ","substeps":["$1:c_customer_id, $2:c_first_name, $3:c_last_name, $4:c_preferred_cust_flag","FROM customer"]},{"kind":"WRITE","substeps":["$1, $2, $3, $4","TO __stage1E_output","BY HASH($1)"]}],"writeRatioAvg":0.0008034279592929834},{"readMsMax":"0","computeMsMax":"284","inputStages":["29"],"waitMsAvg":"1","id":"31","endMs":"1570991931959","waitMsMax":"2","startMs":"1570991931620","waitRatioMax":8.926977325477593e-05,"readRatioAvg":0,"parallelInputs":"9","recordsRead":"1169907","computeRatioAvg":0.011024816996964828,"writeMsAvg":"41","status":"COMPLETE","writeMsMax":"174","computeMsAvg":"247","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007766470273165506,"readMsAvg":"0","waitRatioAvg":4.463488662738796e-05,"completedParallelInputs":"9","computeRatioMax":0.012676307802178183,"name":"S1F: Aggregate","shuffleOutputBytes":"26631840","recordsWritten":"887728","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$630, $631, $210","FROM __stage1D_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $640 := $630, $641 := $631","$190 := SUM($210)"]},{"kind":"WRITE","substeps":["$190, $640","TO __stage1F_output","BY HASH($640)"]}],"writeRatioAvg":0.0018300303517229067},{"readMsMax":"0","computeMsMax":"276","inputStages":["27"],"waitMsAvg":"1","id":"32","endMs":"1570991954231","waitMsMax":"1","startMs":"1570991931657","waitRatioMax":4.463488662738796e-05,"readRatioAvg":0,"parallelInputs":"9","recordsRead":"1162728","computeRatioAvg":0.011247991430101767,"writeMsAvg":"20262","status":"COMPLETE","writeMsMax":"22404","computeMsAvg":"252","shuffleOutputBytesSpilled":"0","writeRatioMax":1,"readMsAvg":"0","waitRatioAvg":4.463488662738796e-05,"completedParallelInputs":"9","computeRatioMax":0.012319228709159078,"name":"S20: Aggregate+","shuffleOutputBytes":"26147220","recordsWritten":"871574","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$580, $581, $240","FROM __stage1B_output"]},{"kind":"FILTER","substeps":["greater($200, 0)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $590 := $580, $591 := $581","$200 := SUM($240)"]},{"kind":"WRITE","substeps":["$200, $590","TO __stage20_output","BY HASH($590)"]}],"writeRatioAvg":0.904392072844135},{"readMsMax":"0","computeMsMax":"425","inputStages":["23"],"waitMsAvg":"1","id":"33","endMs":"1570991933506","waitMsMax":"1","startMs":"1570991931671","waitRatioMax":4.463488662738796e-05,"readRatioAvg":0,"parallelInputs":"14","recordsRead":"3095291","computeRatioAvg":0.016871987145152652,"writeMsAvg":"212","status":"COMPLETE","writeMsMax":"1321","computeMsAvg":"378","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0589626852347795,"readMsAvg":"0","waitRatioAvg":4.463488662738796e-05,"completedParallelInputs":"14","computeRatioMax":0.018969826816639886,"name":"S21: Aggregate","shuffleOutputBytes":"47798730","recordsWritten":"1593291","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$530, $531, $270","FROM __stage17_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $540 := $530, $541 := $531","$220 := SUM($270)"]},{"kind":"WRITE","substeps":["$220, $540","TO __stage21_output","BY HASH($540)"]}],"writeRatioAvg":0.00946259596500625},{"readMsMax":"0","computeMsMax":"437","inputStages":["21"],"waitMsAvg":"2","id":"34","endMs":"1570991932197","waitMsMax":"3","startMs":"1570991931690","waitRatioMax":0.0001339046598821639,"readRatioAvg":0,"parallelInputs":"14","recordsRead":"3095194","computeRatioAvg":0.016336368505623994,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"65","computeMsAvg":"366","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002901267630780218,"readMsAvg":"0","waitRatioAvg":8.926977325477593e-05,"completedParallelInputs":"14","computeRatioMax":0.01950544545616854,"name":"S22: Aggregate+","shuffleOutputBytes":"46848810","recordsWritten":"1561627","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$480, $481, $320","FROM __stage15_output"]},{"kind":"FILTER","substeps":["greater($260, 0)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $490 := $480, $491 := $481","$260 := SUM($320)"]},{"kind":"WRITE","substeps":["$260, $490","TO __stage22_output","BY HASH($490)"]}],"writeRatioAvg":0.0011158721656846992},{"readMsMax":"0","computeMsMax":"477","inputStages":["25"],"waitMsAvg":"2","id":"35","endMs":"1570991932510","waitMsMax":"4","startMs":"1570991931710","waitRatioMax":0.00017853954650955185,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"4670367","computeRatioAvg":0.01798785931083735,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"41","computeMsAvg":"403","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0018300303517229067,"readMsAvg":"0","waitRatioAvg":8.926977325477593e-05,"completedParallelInputs":"18","computeRatioMax":0.02129084092126406,"name":"S23: Aggregate","shuffleOutputBytes":"54291210","recordsWritten":"1809707","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$430, $431, $310","FROM __stage19_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $440 := $430, $441 := $431","$250 := SUM($310)"]},{"kind":"WRITE","substeps":["$250, $440","TO __stage23_output","BY HASH($440)"]}],"writeRatioAvg":0.0011158721656846992},{"readMsMax":"0","computeMsMax":"24","inputStages":["35"],"waitMsAvg":"1","id":"37","endMs":"1570991934432","waitMsMax":"4","startMs":"1570991933868","waitRatioMax":0.00017853954650955185,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1809707","computeRatioAvg":0.0008034279592929834,"writeMsAvg":"37","status":"COMPLETE","writeMsMax":"199","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008882342438850206,"readMsAvg":"0","waitRatioAvg":4.463488662738796e-05,"completedParallelInputs":"100","computeRatioMax":0.0010712372790573112,"name":"S25: Coalesce","shuffleOutputBytes":"54291210","recordsWritten":"1809707","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage23_output"]}],"writeRatioAvg":0.0016514908052133548},{"readMsMax":"0","computeMsMax":"27","inputStages":["34"],"waitMsAvg":"10","id":"38","endMs":"1570991936336","waitMsMax":"20","startMs":"1570991933869","waitRatioMax":0.0008926977325477593,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1561627","computeRatioAvg":0.0008034279592929834,"writeMsAvg":"30","status":"COMPLETE","writeMsMax":"778","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.034725941796107836,"readMsAvg":"0","waitRatioAvg":0.00044634886627387967,"completedParallelInputs":"100","computeRatioMax":0.001205141938939475,"name":"S26: Coalesce","shuffleOutputBytes":"46848810","recordsWritten":"1561627","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage22_output"]}],"writeRatioAvg":0.001339046598821639},{"readMsMax":"0","computeMsMax":"25","inputStages":["33"],"waitMsAvg":"2","id":"40","endMs":"1570991936846","waitMsMax":"14","startMs":"1570991934347","waitRatioMax":0.0006248884127834316,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1593291","computeRatioAvg":0.0008480628459203714,"writeMsAvg":"40","status":"COMPLETE","writeMsMax":"816","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03642206748794858,"readMsAvg":"0","waitRatioAvg":8.926977325477593e-05,"completedParallelInputs":"100","computeRatioMax":0.0011158721656846992,"name":"S28: Coalesce","shuffleOutputBytes":"47798730","recordsWritten":"1593291","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage21_output"]}],"writeRatioAvg":0.0017853954650955187},{"readMsMax":"0","computeMsMax":"9880","inputStages":["19","40","38","37"],"waitMsAvg":"1","id":"41","endMs":"1570991960730","waitMsMax":"2","startMs":"1570991934370","waitRatioMax":8.926977325477593e-05,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"94007488","computeRatioAvg":0.3924745581146224,"writeMsAvg":"207","status":"COMPLETE","writeMsMax":"1462","computeMsAvg":"8793","shuffleOutputBytesSpilled":"0","writeRatioMax":0.06525620424924121,"readMsAvg":"0","waitRatioAvg":4.463488662738796e-05,"completedParallelInputs":"18","computeRatioMax":0.4409926798785931,"name":"S29: Join+","shuffleOutputBytes":"29834400","recordsWritten":"497240","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$390, $391, $330","FROM __stage13_output"]},{"kind":"READ","substeps":["$250, $440","FROM __stage25_output"]},{"kind":"READ","substeps":["$260, $490","FROM __stage26_output"]},{"kind":"READ","substeps":["$220, $540","FROM __stage28_output"]},{"kind":"FILTER","substeps":["greater(case_no_value(greater($553, 0), divide($555, $553), NULL), case_no_value(greater($554, 0), divide($552, $554), NULL))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $501 = $540"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $450 = $490"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $400 = $440"]},{"kind":"FILTER","substeps":["greater($290, 0)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $400 := $390, $401 := $391","$290 := SUM($330)"]},{"kind":"WRITE","substeps":["$550, $551, $553, $555","TO __stage29_output","BY HASH($551)"]}],"writeRatioAvg":0.009239421531869308},{"readMsMax":"0","computeMsMax":"23","inputStages":["31"],"waitMsAvg":"6","id":"42","endMs":"1570991962740","waitMsMax":"16","startMs":"1570991961875","waitRatioMax":0.0007141581860382074,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"887728","computeRatioAvg":0.0006248884127834316,"writeMsAvg":"116","status":"COMPLETE","writeMsMax":"183","computeMsAvg":"14","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008168184252811997,"readMsAvg":"0","waitRatioAvg":0.0002678093197643278,"completedParallelInputs":"100","computeRatioMax":0.0010266023924299231,"name":"S2A: Coalesce","shuffleOutputBytes":"26631840","recordsWritten":"887728","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage1F_output"]}],"writeRatioAvg":0.005177646848777004},{"readMsMax":"0","computeMsMax":"36","inputStages":["30"],"waitMsAvg":"24","id":"43","endMs":"1570991963679","waitMsMax":"35","startMs":"1570991961877","waitRatioMax":0.0015622210319585787,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2000000","computeRatioAvg":0.001294411712194251,"writeMsAvg":"105","status":"COMPLETE","writeMsMax":"1123","computeMsAvg":"29","shuffleOutputBytesSpilled":"0","writeRatioMax":0.050124977682556686,"readMsAvg":"0","waitRatioAvg":0.0010712372790573112,"completedParallelInputs":"100","computeRatioMax":0.0016068559185859668,"name":"S2B: Coalesce","shuffleOutputBytes":"96192074","recordsWritten":"2000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage1E_output"]}],"writeRatioAvg":0.004686663095875737},{"readMsMax":"0","computeMsMax":"7226","inputStages":["43","42","32","41"],"waitMsAvg":"47","id":"44","endMs":"1570991979808","waitMsMax":"54","startMs":"1570991961910","waitRatioMax":0.00241028387787895,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"290141614","computeRatioAvg":0.2510266023924299,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"5624","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0008480628459203714,"readMsAvg":"0","waitRatioAvg":0.0020978396714872345,"completedParallelInputs":"100","computeRatioMax":0.32253169076950544,"name":"S2C: Join+","shuffleOutputBytes":"480594","recordsWritten":"10000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$550, $551, $553, $555","FROM __stage29_output"]},{"kind":"READ","substeps":["$200, $590","FROM __stage20_output"]},{"kind":"READ","substeps":["$190, $640","FROM __stage2A_output"]},{"kind":"READ","substeps":["$1, $2, $3, $4","FROM __stage2B_output"]},{"kind":"SORT","substeps":["$660 ASC","LIMIT 100"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $650 = $1"]},{"kind":"FILTER","substeps":["greater(case_no_value(greater($653, 0), divide($652, $653), NULL), case_no_value(greater($651, 0), divide($654, $651), NULL))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $601 = $640"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH EACH ON $551 = $590"]},{"kind":"WRITE","substeps":["$670, $671, $672, $673","TO __stage2C_output"]}],"writeRatioAvg":0.0002678093197643278},{"readMsMax":"0","computeMsMax":"22","inputStages":["44"],"waitMsAvg":"1","id":"45","endMs":"1570991980614","waitMsMax":"1","startMs":"1570991962032","waitRatioMax":4.463488662738796e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"10000","computeRatioAvg":0.0009819675058025353,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"22","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0003570790930191037,"readMsAvg":"0","waitRatioAvg":4.463488662738796e-05,"completedParallelInputs":"1","computeRatioMax":0.0009819675058025353,"name":"S2D: Output","shuffleOutputBytes":"4805","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$670, $671, $672, $673","FROM __stage2C_output"]},{"kind":"SORT","substeps":["$673 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$680, $681, $682, $683","TO __stage2D_output"]}],"writeRatioAvg":0.0003570790930191037}],"estimatedBytesProcessed":"23270636622","timeline":[{"totalSlotMs":"4133","activeUnits":"750","completedUnits":"2","elapsedMs":"760","pendingUnits":"751"},{"totalSlotMs":"869226","activeUnits":"1010","completedUnits":"139","elapsedMs":"1869","pendingUnits":"1007"},{"totalSlotMs":"1661269","activeUnits":"1080","completedUnits":"500","elapsedMs":"2894","pendingUnits":"846"},{"totalSlotMs":"2538347","activeUnits":"853","completedUnits":"600","elapsedMs":"3956","pendingUnits":"746"},{"totalSlotMs":"3217904","activeUnits":"611","completedUnits":"780","elapsedMs":"5037","pendingUnits":"566"},{"totalSlotMs":"3795481","activeUnits":"573","completedUnits":"796","elapsedMs":"6066","pendingUnits":"550"},{"totalSlotMs":"4320009","activeUnits":"525","completedUnits":"923","elapsedMs":"7102","pendingUnits":"523"},{"totalSlotMs":"4753692","activeUnits":"427","completedUnits":"1081","elapsedMs":"8135","pendingUnits":"365"},{"totalSlotMs":"5210869","activeUnits":"346","completedUnits":"1134","elapsedMs":"9215","pendingUnits":"312"},{"totalSlotMs":"5544145","activeUnits":"161","completedUnits":"1382","elapsedMs":"10230","pendingUnits":"64"},{"totalSlotMs":"5613217","activeUnits":"34","completedUnits":"1429","elapsedMs":"11244","pendingUnits":"17"},{"totalSlotMs":"5635843","activeUnits":"20","completedUnits":"1439","elapsedMs":"12378","pendingUnits":"7"},{"totalSlotMs":"5645646","activeUnits":"8","completedUnits":"1444","elapsedMs":"13877","pendingUnits":"2"},{"totalSlotMs":"5648774","activeUnits":"6","completedUnits":"1444","elapsedMs":"15464","pendingUnits":"2"},{"totalSlotMs":"5652839","activeUnits":"0","completedUnits":"1446","elapsedMs":"16728","pendingUnits":"0"},{"totalSlotMs":"5688445","activeUnits":"40","completedUnits":"1510","elapsedMs":"23428","pendingUnits":"19"},{"totalSlotMs":"5702439","activeUnits":"17","completedUnits":"1516","elapsedMs":"24578","pendingUnits":"13"},{"totalSlotMs":"5801512","activeUnits":"219","completedUnits":"1610","elapsedMs":"25728","pendingUnits":"219"},{"totalSlotMs":"5994002","activeUnits":"188","completedUnits":"1749","elapsedMs":"27133","pendingUnits":"80"},{"totalSlotMs":"6030855","activeUnits":"30","completedUnits":"1802","elapsedMs":"28171","pendingUnits":"27"},{"totalSlotMs":"6195528","activeUnits":"26","completedUnits":"1807","elapsedMs":"37673","pendingUnits":"22"},{"totalSlotMs":"6211853","activeUnits":"18","completedUnits":"1811","elapsedMs":"38754","pendingUnits":"18"},{"totalSlotMs":"6229588","activeUnits":"17","completedUnits":"1812","elapsedMs":"40103","pendingUnits":"17"},{"totalSlotMs":"6258595","activeUnits":"16","completedUnits":"1813","elapsedMs":"42021","pendingUnits":"16"},{"totalSlotMs":"6295128","activeUnits":"10","completedUnits":"1822","elapsedMs":"44682","pendingUnits":"7"},{"totalSlotMs":"6305177","activeUnits":"6","completedUnits":"1826","elapsedMs":"46116","pendingUnits":"3"},{"totalSlotMs":"6312352","activeUnits":"4","completedUnits":"1828","elapsedMs":"47706","pendingUnits":"1"},{"totalSlotMs":"6319581","activeUnits":"0","completedUnits":"1829","elapsedMs":"52089","pendingUnits":"0"},{"totalSlotMs":"6456791","activeUnits":"292","completedUnits":"2024","elapsedMs":"53837","pendingUnits":"106"},{"totalSlotMs":"6506163","activeUnits":"101","completedUnits":"2029","elapsedMs":"54620","pendingUnits":"101"},{"totalSlotMs":"7207234","activeUnits":"86","completedUnits":"2058","elapsedMs":"62493","pendingUnits":"72"},{"totalSlotMs":"7284650","activeUnits":"66","completedUnits":"2097","elapsedMs":"63619","pendingUnits":"33"},{"totalSlotMs":"7322270","activeUnits":"39","completedUnits":"2116","elapsedMs":"64812","pendingUnits":"14"},{"totalSlotMs":"7333868","activeUnits":"19","completedUnits":"2120","elapsedMs":"65390","pendingUnits":"10"},{"totalSlotMs":"7372215","activeUnits":"15","completedUnits":"2126","elapsedMs":"67539","pendingUnits":"4"},{"totalSlotMs":"7374493","activeUnits":"3","completedUnits":"2128","elapsedMs":"68075","pendingUnits":"2"},{"totalSlotMs":"7383120","activeUnits":"1","completedUnits":"2130","elapsedMs":"71974","pendingUnits":"0"},{"totalSlotMs":"7383120","activeUnits":"0","completedUnits":"2130","elapsedMs":"73148","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"23271047168","totalPartitionsProcessed":"0","totalBytesProcessed":"23270636622","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_100"}]},"endTime":"1570991982780"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query4_1570991907"},"etag":"Q0mUp++tIUjnVjmcR9wgGg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query4_1570991907?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon5e889c6e940c54cd1009d1c1b562e11f638c6dea","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query4\nWITH year_total \n AS (SELECT c_customer_id customer_id, \n d_year dyear, \n Sum(( ( ss_ext_list_price - ss_ext_wholesale_cost \n - ss_ext_discount_amt \n ) \n + \n ss_ext_sales_price ) / 2) year_total, \n 's' sale_type \n FROM customer, \n store_sales, \n date_dim \n WHERE c_customer_sk = ss_customer_sk \n AND ss_sold_date_sk = d_date_sk \n GROUP BY c_customer_id, \n d_year \n UNION ALL \n SELECT c_customer_id customer_id, \n d_year dyear, \n Sum(( ( ( cs_ext_list_price \n - cs_ext_wholesale_cost \n - cs_ext_discount_amt \n ) + \n cs_ext_sales_price ) / 2 )) year_total, \n 'c' sale_type \n FROM customer, \n catalog_sales, \n date_dim \n WHERE c_customer_sk = cs_bill_customer_sk \n AND cs_sold_date_sk = d_date_sk \n GROUP BY c_customer_id, \n d_year \n UNION ALL \n SELECT c_customer_id customer_id, \n d_year dyear, \n Sum(( ( ( ws_ext_list_price \n - ws_ext_wholesale_cost \n - ws_ext_discount_amt \n ) + \n ws_ext_sales_price ) / 2 )) year_total, \n 'w' sale_type \n FROM customer, \n web_sales, \n date_dim \n WHERE c_customer_sk = ws_bill_customer_sk \n AND ws_sold_date_sk = d_date_sk \n GROUP BY c_customer_id, \n d_year) \nSELECT t_s_secyear.customer_id, \n customer.c_first_name, \n customer.c_last_name, \n customer.c_preferred_cust_flag \nFROM year_total t_s_firstyear, \n year_total t_s_secyear, \n year_total t_c_firstyear, \n year_total t_c_secyear, \n year_total t_w_firstyear, \n year_total t_w_secyear,\n customer\nWHERE t_s_secyear.customer_id = t_s_firstyear.customer_id \n AND t_s_firstyear.customer_id = t_c_secyear.customer_id \n AND t_s_firstyear.customer_id = t_c_firstyear.customer_id \n AND t_s_firstyear.customer_id = t_w_firstyear.customer_id \n AND t_s_firstyear.customer_id = t_w_secyear.customer_id \n AND t_s_secyear.customer_id = customer.c_customer_id\n AND t_s_firstyear.sale_type = 's' \n AND t_c_firstyear.sale_type = 'c' \n AND t_w_firstyear.sale_type = 'w' \n AND t_s_secyear.sale_type = 's' \n AND t_c_secyear.sale_type = 'c' \n AND t_w_secyear.sale_type = 'w' \n AND t_s_firstyear.dyear = 2001 \n AND t_s_secyear.dyear = 2001 + 1 \n AND t_c_firstyear.dyear = 2001 \n AND t_c_secyear.dyear = 2001 + 1 \n AND t_w_firstyear.dyear = 2001 \n AND t_w_secyear.dyear = 2001 + 1 \n AND t_s_firstyear.year_total > 0 \n AND t_c_firstyear.year_total > 0 \n AND t_w_firstyear.year_total > 0 \n AND CASE \n WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / \n t_c_firstyear.year_total \n ELSE NULL \n END > CASE \n WHEN t_s_firstyear.year_total > 0 THEN \n t_s_secyear.year_total / \n t_s_firstyear.year_total \n ELSE NULL \n END \n AND CASE \n WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / \n t_c_firstyear.year_total \n ELSE NULL \n END > CASE \n WHEN t_w_firstyear.year_total > 0 THEN \n t_w_secyear.year_total / \n t_w_firstyear.year_total \n ELSE NULL \n END \nORDER BY t_s_secyear.customer_id\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query4_1570991907","user_email":"nithish.sankaranarayanan@ulb.be"}
