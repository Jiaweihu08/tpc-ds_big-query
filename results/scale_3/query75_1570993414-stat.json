{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"918342","creationTime":"1570993415327","totalBytesProcessed":"21106002954","startTime":"1570993415748","query":{"totalSlotMs":"918342","queryPlan":[{"readMsMax":"45","computeMsMax":"3431","waitMsAvg":"6","id":"0","endMs":"1570993417869","waitMsMax":"13","startMs":"1570993416069","waitRatioMax":0.0025742574257425744,"readRatioAvg":0.006534653465346534,"parallelInputs":"3","recordsRead":"7048438","computeRatioAvg":0.6207920792079208,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"30","computeMsAvg":"3135","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005940594059405941,"readMsAvg":"33","waitRatioAvg":0.001188118811881188,"completedParallelInputs":"3","computeRatioMax":0.6794059405940595,"name":"S00: Input","shuffleOutputBytes":"248648384","recordsWritten":"7048438","readRatioMax":0.00891089108910891,"steps":[{"kind":"READ","substeps":["$50:wr_item_sk, $51:wr_order_number, $52:wr_return_quantity, $53:wr_return_amt","FROM web_returns"]},{"kind":"WRITE","substeps":["$50, $51, $52, $53","TO __stage00_output","BY HASH($51, $50)"]}],"writeRatioAvg":0.0049504950495049506},{"readMsMax":"11","computeMsMax":"7","waitMsAvg":"38","id":"1","endMs":"1570993416215","waitMsMax":"38","startMs":"1570993416125","waitRatioMax":0.0075247524752475245,"readRatioAvg":0.0021782178217821784,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.001386138613861386,"writeMsAvg":"53","status":"COMPLETE","writeMsMax":"53","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010495049504950496,"readMsAvg":"11","waitRatioAvg":0.0075247524752475245,"completedParallelInputs":"1","computeRatioMax":0.001386138613861386,"name":"S01: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0021782178217821784,"steps":[{"kind":"READ","substeps":["$170:d_date_sk, $171:d_year","FROM date_dim","WHERE equal($171, 2001)"]},{"kind":"WRITE","substeps":["$170, $171","TO __stage01_output","BY HASH($170)"]}],"writeRatioAvg":0.010495049504950496},{"readMsMax":"27","computeMsMax":"29","waitMsAvg":"60","id":"2","endMs":"1570993416244","waitMsMax":"60","startMs":"1570993416168","waitRatioMax":0.011881188118811881,"readRatioAvg":0.005346534653465347,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.0057425742574257425,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"29","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0039603960396039604,"readMsAvg":"27","waitRatioAvg":0.011881188118811881,"completedParallelInputs":"1","computeRatioMax":0.0057425742574257425,"name":"S02: Input","shuffleOutputBytes":"911050","recordsWritten":"20266","readRatioMax":0.005346534653465347,"steps":[{"kind":"READ","substeps":["$230:i_item_sk, $231:i_brand_id, $232:i_class_id, $233:i_category_id, $235:i_manufact_id, $234:i_category","FROM item","WHERE equal($234, 'Men')"]},{"kind":"WRITE","substeps":["$230, $231, $232, $233, $235","TO __stage02_output","BY HASH($230)"]}],"writeRatioAvg":0.0039603960396039604},{"readMsMax":"45","computeMsMax":"4664","waitMsAvg":"60","id":"4","endMs":"1570993418837","waitMsMax":"63","startMs":"1570993416245","waitRatioMax":0.012475247524752476,"readRatioAvg":0.007128712871287129,"parallelInputs":"9","recordsRead":"28191329","computeRatioAvg":0.8536633663366336,"writeMsAvg":"91","status":"COMPLETE","writeMsMax":"484","computeMsAvg":"4311","shuffleOutputBytesSpilled":"0","writeRatioMax":0.09584158415841584,"readMsAvg":"36","waitRatioAvg":0.011881188118811881,"completedParallelInputs":"9","computeRatioMax":0.9235643564356436,"name":"S04: Input","shuffleOutputBytes":"999095180","recordsWritten":"28191329","readRatioMax":0.00891089108910891,"steps":[{"kind":"READ","substeps":["$40:sr_item_sk, $41:sr_ticket_number, $42:sr_return_quantity, $43:sr_return_amt","FROM store_returns"]},{"kind":"WRITE","substeps":["$40, $41, $42, $43","TO __stage04_output","BY HASH($41, $40)"]}],"writeRatioAvg":0.01801980198019802},{"readMsMax":"10","computeMsMax":"9","waitMsAvg":"44","id":"5","endMs":"1570993416333","waitMsMax":"44","startMs":"1570993416253","waitRatioMax":0.008712871287128714,"readRatioAvg":0.0019801980198019802,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0017821782178217822,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001386138613861386,"readMsAvg":"10","waitRatioAvg":0.008712871287128714,"completedParallelInputs":"1","computeRatioMax":0.0017821782178217822,"name":"S05: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0019801980198019802,"steps":[{"kind":"READ","substeps":["$150:d_date_sk, $151:d_year","FROM date_dim","WHERE equal($151, 2001)"]},{"kind":"WRITE","substeps":["$150, $151","TO __stage05_output","BY HASH($150)"]}],"writeRatioAvg":0.001386138613861386},{"readMsMax":"19","computeMsMax":"29","waitMsAvg":"19","id":"6","endMs":"1570993416315","waitMsMax":"19","startMs":"1570993416254","waitRatioMax":0.0037623762376237622,"readRatioAvg":0.0037623762376237622,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.0057425742574257425,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"29","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0037623762376237622,"readMsAvg":"19","waitRatioAvg":0.0037623762376237622,"completedParallelInputs":"1","computeRatioMax":0.0057425742574257425,"name":"S06: Input","shuffleOutputBytes":"911050","recordsWritten":"20266","readRatioMax":0.0037623762376237622,"steps":[{"kind":"READ","substeps":["$220:i_item_sk, $221:i_brand_id, $222:i_class_id, $223:i_category_id, $225:i_manufact_id, $224:i_category","FROM item","WHERE equal($224, 'Men')"]},{"kind":"WRITE","substeps":["$220, $221, $222, $223, $225","TO __stage06_output","BY HASH($220)"]}],"writeRatioAvg":0.0037623762376237622},{"readMsMax":"65","computeMsMax":"4158","waitMsAvg":"15","id":"8","endMs":"1570993418725","waitMsMax":"17","startMs":"1570993416288","waitRatioMax":0.0033663366336633663,"readRatioAvg":0.008514851485148515,"parallelInputs":"6","recordsRead":"14398596","computeRatioAvg":0.717029702970297,"writeMsAvg":"49","status":"COMPLETE","writeMsMax":"78","computeMsAvg":"3621","shuffleOutputBytesSpilled":"0","writeRatioMax":0.015445544554455445,"readMsAvg":"43","waitRatioAvg":0.0029702970297029703,"completedParallelInputs":"6","computeRatioMax":0.8233663366336633,"name":"S08: Input","shuffleOutputBytes":"513747352","recordsWritten":"14398596","readRatioMax":0.01287128712871287,"steps":[{"kind":"READ","substeps":["$30:cr_item_sk, $31:cr_order_number, $32:cr_return_quantity, $33:cr_return_amount","FROM catalog_returns"]},{"kind":"WRITE","substeps":["$30, $31, $32, $33","TO __stage08_output","BY HASH($31, $30)"]}],"writeRatioAvg":0.009702970297029703},{"readMsMax":"8","computeMsMax":"10","waitMsAvg":"1","id":"9","endMs":"1570993416455","waitMsMax":"1","startMs":"1570993416293","waitRatioMax":0.00019801980198019803,"readRatioAvg":0.0015841584158415843,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0019801980198019802,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001386138613861386,"readMsAvg":"8","waitRatioAvg":0.00019801980198019803,"completedParallelInputs":"1","computeRatioMax":0.0019801980198019802,"name":"S09: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0015841584158415843,"steps":[{"kind":"READ","substeps":["$130:d_date_sk, $131:d_year","FROM date_dim","WHERE equal($131, 2001)"]},{"kind":"WRITE","substeps":["$130, $131","TO __stage09_output","BY HASH($130)"]}],"writeRatioAvg":0.001386138613861386},{"readMsMax":"15","computeMsMax":"35","waitMsAvg":"4","id":"10","endMs":"1570993416503","waitMsMax":"4","startMs":"1570993416309","waitRatioMax":0.0007920792079207921,"readRatioAvg":0.0029702970297029703,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.006930693069306931,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"35","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004554455445544554,"readMsAvg":"15","waitRatioAvg":0.0007920792079207921,"completedParallelInputs":"1","computeRatioMax":0.006930693069306931,"name":"S0A: Input","shuffleOutputBytes":"911050","recordsWritten":"20266","readRatioMax":0.0029702970297029703,"steps":[{"kind":"READ","substeps":["$210:i_item_sk, $211:i_brand_id, $212:i_class_id, $213:i_category_id, $215:i_manufact_id, $214:i_category","FROM item","WHERE equal($214, 'Men')"]},{"kind":"WRITE","substeps":["$210, $211, $212, $213, $215","TO __stage0A_output","BY HASH($210)"]}],"writeRatioAvg":0.004554455445544554},{"readMsMax":"41","computeMsMax":"3674","waitMsAvg":"1","id":"12","endMs":"1570993418383","waitMsMax":"1","startMs":"1570993416410","waitRatioMax":0.00019801980198019803,"readRatioAvg":0.007128712871287129,"parallelInputs":"3","recordsRead":"7048438","computeRatioAvg":0.6780198019801981,"writeMsAvg":"31","status":"COMPLETE","writeMsMax":"31","computeMsAvg":"3424","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006138613861386139,"readMsAvg":"36","waitRatioAvg":0.00019801980198019803,"completedParallelInputs":"3","computeRatioMax":0.7275247524752475,"name":"S0C: Input","shuffleOutputBytes":"248648384","recordsWritten":"7048438","readRatioMax":0.008118811881188119,"steps":[{"kind":"READ","substeps":["$20:wr_item_sk, $21:wr_order_number, $22:wr_return_quantity, $23:wr_return_amt","FROM web_returns"]},{"kind":"WRITE","substeps":["$20, $21, $22, $23","TO __stage0C_output","BY HASH($21, $20)"]}],"writeRatioAvg":0.006138613861386139},{"readMsMax":"20","computeMsMax":"10","waitMsAvg":"1","id":"13","endMs":"1570993416467","waitMsMax":"1","startMs":"1570993416427","waitRatioMax":0.00019801980198019803,"readRatioAvg":0.0039603960396039604,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0019801980198019802,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001386138613861386,"readMsAvg":"20","waitRatioAvg":0.00019801980198019803,"completedParallelInputs":"1","computeRatioMax":0.0019801980198019802,"name":"S0D: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0039603960396039604,"steps":[{"kind":"READ","substeps":["$110:d_date_sk, $111:d_year","FROM date_dim","WHERE equal($111, 2002)"]},{"kind":"WRITE","substeps":["$110, $111","TO __stage0D_output","BY HASH($110)"]}],"writeRatioAvg":0.001386138613861386},{"readMsMax":"16","computeMsMax":"31","waitMsAvg":"1","id":"14","endMs":"1570993416503","waitMsMax":"1","startMs":"1570993416444","waitRatioMax":0.00019801980198019803,"readRatioAvg":0.0031683168316831685,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.006138613861386139,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"31","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0035643564356435645,"readMsAvg":"16","waitRatioAvg":0.00019801980198019803,"completedParallelInputs":"1","computeRatioMax":0.006138613861386139,"name":"S0E: Input","shuffleOutputBytes":"911050","recordsWritten":"20266","readRatioMax":0.0031683168316831685,"steps":[{"kind":"READ","substeps":["$200:i_item_sk, $201:i_brand_id, $202:i_class_id, $203:i_category_id, $205:i_manufact_id, $204:i_category","FROM item","WHERE equal($204, 'Men')"]},{"kind":"WRITE","substeps":["$200, $201, $202, $203, $205","TO __stage0E_output","BY HASH($200)"]}],"writeRatioAvg":0.0035643564356435645},{"readMsMax":"49","computeMsMax":"5050","waitMsAvg":"1","id":"16","endMs":"1570993419097","waitMsMax":"1","startMs":"1570993416475","waitRatioMax":0.00019801980198019803,"readRatioAvg":0.007326732673267326,"parallelInputs":"9","recordsRead":"28191329","computeRatioAvg":0.8831683168316832,"writeMsAvg":"35","status":"COMPLETE","writeMsMax":"45","computeMsAvg":"4460","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00891089108910891,"readMsAvg":"37","waitRatioAvg":0.00019801980198019803,"completedParallelInputs":"9","computeRatioMax":1,"name":"S10: Input","shuffleOutputBytes":"999095180","recordsWritten":"28191329","readRatioMax":0.009702970297029703,"steps":[{"kind":"READ","substeps":["$10:sr_item_sk, $11:sr_ticket_number, $12:sr_return_quantity, $13:sr_return_amt","FROM store_returns"]},{"kind":"WRITE","substeps":["$10, $11, $12, $13","TO __stage10_output","BY HASH($11, $10)"]}],"writeRatioAvg":0.006930693069306931},{"readMsMax":"14","computeMsMax":"9","waitMsAvg":"1","id":"17","endMs":"1570993416581","waitMsMax":"1","startMs":"1570993416491","waitRatioMax":0.00019801980198019803,"readRatioAvg":0.002772277227722772,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0017821782178217822,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001386138613861386,"readMsAvg":"14","waitRatioAvg":0.00019801980198019803,"completedParallelInputs":"1","computeRatioMax":0.0017821782178217822,"name":"S11: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.002772277227722772,"steps":[{"kind":"READ","substeps":["$90:d_date_sk, $91:d_year","FROM date_dim","WHERE equal($91, 2002)"]},{"kind":"WRITE","substeps":["$90, $91","TO __stage11_output","BY HASH($90)"]}],"writeRatioAvg":0.001386138613861386},{"readMsMax":"23","computeMsMax":"38","waitMsAvg":"1","id":"18","endMs":"1570993416584","waitMsMax":"1","startMs":"1570993416510","waitRatioMax":0.00019801980198019803,"readRatioAvg":0.004554455445544554,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.0075247524752475245,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"38","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004356435643564357,"readMsAvg":"23","waitRatioAvg":0.00019801980198019803,"completedParallelInputs":"1","computeRatioMax":0.0075247524752475245,"name":"S12: Input","shuffleOutputBytes":"911050","recordsWritten":"20266","readRatioMax":0.004554455445544554,"steps":[{"kind":"READ","substeps":["$190:i_item_sk, $191:i_brand_id, $192:i_class_id, $193:i_category_id, $195:i_manufact_id, $194:i_category","FROM item","WHERE equal($194, 'Men')"]},{"kind":"WRITE","substeps":["$190, $191, $192, $193, $195","TO __stage12_output","BY HASH($190)"]}],"writeRatioAvg":0.004356435643564357},{"readMsMax":"38","computeMsMax":"3761","waitMsAvg":"7","id":"20","endMs":"1570993418414","waitMsMax":"8","startMs":"1570993416550","waitRatioMax":0.0015841584158415843,"readRatioAvg":0.006534653465346534,"parallelInputs":"6","recordsRead":"14398596","computeRatioAvg":0.683960396039604,"writeMsAvg":"39","status":"COMPLETE","writeMsMax":"49","computeMsAvg":"3454","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009702970297029703,"readMsAvg":"33","waitRatioAvg":0.001386138613861386,"completedParallelInputs":"6","computeRatioMax":0.7447524752475247,"name":"S14: Input","shuffleOutputBytes":"513747352","recordsWritten":"14398596","readRatioMax":0.0075247524752475245,"steps":[{"kind":"READ","substeps":["$1:cr_item_sk, $2:cr_order_number, $3:cr_return_quantity, $4:cr_return_amount","FROM catalog_returns"]},{"kind":"WRITE","substeps":["$1, $2, $3, $4","TO __stage14_output","BY HASH($2, $1)"]}],"writeRatioAvg":0.007722772277227723},{"readMsMax":"10","computeMsMax":"8","waitMsAvg":"1","id":"21","endMs":"1570993416623","waitMsMax":"1","startMs":"1570993416568","waitRatioMax":0.00019801980198019803,"readRatioAvg":0.0019801980198019802,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0015841584158415843,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0037623762376237622,"readMsAvg":"10","waitRatioAvg":0.00019801980198019803,"completedParallelInputs":"1","computeRatioMax":0.0015841584158415843,"name":"S15: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0019801980198019802,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_year","FROM date_dim","WHERE equal($71, 2002)"]},{"kind":"WRITE","substeps":["$70, $71","TO __stage15_output","BY HASH($70)"]}],"writeRatioAvg":0.0037623762376237622},{"readMsMax":"24","computeMsMax":"33","waitMsAvg":"1","id":"22","endMs":"1570993416667","waitMsMax":"1","startMs":"1570993416594","waitRatioMax":0.00019801980198019803,"readRatioAvg":0.004752475247524752,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.006534653465346534,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"33","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0039603960396039604,"readMsAvg":"24","waitRatioAvg":0.00019801980198019803,"completedParallelInputs":"1","computeRatioMax":0.006534653465346534,"name":"S16: Input","shuffleOutputBytes":"911050","recordsWritten":"20266","readRatioMax":0.004752475247524752,"steps":[{"kind":"READ","substeps":["$180:i_item_sk, $181:i_brand_id, $182:i_class_id, $183:i_category_id, $185:i_manufact_id, $184:i_category","FROM item","WHERE equal($184, 'Men')"]},{"kind":"WRITE","substeps":["$180, $181, $182, $183, $185","TO __stage16_output","BY HASH($180)"]}],"writeRatioAvg":0.0039603960396039604},{"readMsMax":"137","computeMsMax":"1053","inputStages":["5","6"],"waitMsAvg":"3","id":"25","endMs":"1570993417817","waitMsMax":"6","startMs":"1570993416759","waitRatioMax":0.001188118811881188,"readRatioAvg":0.007920792079207921,"parallelInputs":"184","recordsRead":"285669027","computeRatioAvg":0.1596039603960396,"writeMsAvg":"13","status":"COMPLETE","writeMsMax":"221","computeMsAvg":"806","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04376237623762376,"readMsAvg":"40","waitRatioAvg":0.000594059405940594,"completedParallelInputs":"184","computeRatioMax":0.2085148514851485,"name":"S19: Join","shuffleOutputBytes":"428550150","recordsWritten":"5319774","readRatioMax":0.02712871287128713,"steps":[{"kind":"READ","substeps":["$140:ss_sold_date_sk, $141:ss_item_sk, $142:ss_ticket_number, $143:ss_quantity, $144:ss_ext_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$220, $221, $222, $223, $225","FROM __stage06_output"]},{"kind":"READ","substeps":["$150, $151","FROM __stage05_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $580 = $150"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $141 = $220"]},{"kind":"WRITE","substeps":["$600, $601, $602, $603, $604, $605, $606, $607, $608","TO __stage19_output","BY HASH($601, $600)"]}],"writeRatioAvg":0.0025742574257425744},{"readMsMax":"116","computeMsMax":"844","inputStages":["9","10"],"waitMsAvg":"2","id":"26","endMs":"1570993417385","waitMsMax":"7","startMs":"1570993416815","waitRatioMax":0.001386138613861386,"readRatioAvg":0.008118811881188119,"parallelInputs":"141","recordsRead":"146919422","computeRatioAvg":0.09881188118811882,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"36","computeMsAvg":"499","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007128712871287129,"readMsAvg":"41","waitRatioAvg":0.00039603960396039607,"completedParallelInputs":"141","computeRatioMax":0.16712871287128714,"name":"S1A: Join","shuffleOutputBytes":"229346049","recordsWritten":"2835145","readRatioMax":0.02297029702970297,"steps":[{"kind":"READ","substeps":["$120:cs_sold_date_sk, $121:cs_item_sk, $122:cs_order_number, $123:cs_quantity, $124:cs_ext_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$210, $211, $212, $213, $215","FROM __stage0A_output"]},{"kind":"READ","substeps":["$130, $131","FROM __stage09_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $530 = $130"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $121 = $210"]},{"kind":"WRITE","substeps":["$550, $551, $552, $553, $554, $555, $556, $557, $558","TO __stage1A_output","BY HASH($551, $550)"]}],"writeRatioAvg":0.001188118811881188},{"readMsMax":"108","computeMsMax":"1454","inputStages":["17","18"],"waitMsAvg":"3","id":"27","endMs":"1570993417977","waitMsMax":"6","startMs":"1570993416838","waitRatioMax":0.001188118811881188,"readRatioAvg":0.008118811881188119,"parallelInputs":"184","recordsRead":"285669027","computeRatioAvg":0.1607920792079208,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"46","computeMsAvg":"812","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009108910891089108,"readMsAvg":"41","waitRatioAvg":0.000594059405940594,"completedParallelInputs":"184","computeRatioMax":0.2879207920792079,"name":"S1B: Join","shuffleOutputBytes":"431473001","recordsWritten":"5354913","readRatioMax":0.021386138613861388,"steps":[{"kind":"READ","substeps":["$80:ss_sold_date_sk, $81:ss_item_sk, $82:ss_ticket_number, $83:ss_quantity, $84:ss_ext_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$190, $191, $192, $193, $195","FROM __stage12_output"]},{"kind":"READ","substeps":["$90, $91","FROM __stage11_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $420 = $90"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $81 = $190"]},{"kind":"WRITE","substeps":["$440, $441, $442, $443, $444, $445, $446, $447, $448","TO __stage1B_output","BY HASH($441, $440)"]}],"writeRatioAvg":0.0021782178217821784},{"readMsMax":"89","computeMsMax":"544","inputStages":["1","2"],"waitMsAvg":"4","id":"28","endMs":"1570993417607","waitMsMax":"13","startMs":"1570993416992","waitRatioMax":0.0025742574257425744,"readRatioAvg":0.007920792079207921,"parallelInputs":"92","recordsRead":"72372127","computeRatioAvg":0.07881188118811881,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"87","computeMsAvg":"398","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01722772277227723,"readMsAvg":"40","waitRatioAvg":0.0007920792079207921,"completedParallelInputs":"92","computeRatioMax":0.10772277227722772,"name":"S1C: Join","shuffleOutputBytes":"112401180","recordsWritten":"1388852","readRatioMax":0.017623762376237622,"steps":[{"kind":"READ","substeps":["$160:ws_sold_date_sk, $161:ws_item_sk, $162:ws_order_number, $163:ws_quantity, $164:ws_ext_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$230, $231, $232, $233, $235","FROM __stage02_output"]},{"kind":"READ","substeps":["$170, $171","FROM __stage01_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $630 = $170"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $161 = $230"]},{"kind":"WRITE","substeps":["$650, $651, $652, $653, $654, $655, $656, $657, $658","TO __stage1C_output","BY HASH($651, $650)"]}],"writeRatioAvg":0.0033663366336633663},{"readMsMax":"92","computeMsMax":"785","inputStages":["21","22"],"waitMsAvg":"1","id":"29","endMs":"1570993417786","waitMsMax":"3","startMs":"1570993417001","waitRatioMax":0.000594059405940594,"readRatioAvg":0.007920792079207921,"parallelInputs":"141","recordsRead":"146919422","computeRatioAvg":0.09801980198019802,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"278","computeMsAvg":"495","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05504950495049505,"readMsAvg":"40","waitRatioAvg":0.00019801980198019803,"completedParallelInputs":"141","computeRatioMax":0.15544554455445544,"name":"S1D: Join","shuffleOutputBytes":"228970813","recordsWritten":"2829973","readRatioMax":0.018217821782178217,"steps":[{"kind":"READ","substeps":["$60:cs_sold_date_sk, $61:cs_item_sk, $62:cs_order_number, $63:cs_quantity, $64:cs_ext_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$180, $181, $182, $183, $185","FROM __stage16_output"]},{"kind":"READ","substeps":["$70, $71","FROM __stage15_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $370 = $70"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $61 = $180"]},{"kind":"WRITE","substeps":["$390, $391, $392, $393, $394, $395, $396, $397, $398","TO __stage1D_output","BY HASH($391, $390)"]}],"writeRatioAvg":0.0017821782178217822},{"readMsMax":"99","computeMsMax":"509","inputStages":["13","14"],"waitMsAvg":"5","id":"30","endMs":"1570993417849","waitMsMax":"7","startMs":"1570993417319","waitRatioMax":0.001386138613861386,"readRatioAvg":0.0075247524752475245,"parallelInputs":"92","recordsRead":"72372127","computeRatioAvg":0.07801980198019802,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"220","computeMsAvg":"394","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04356435643564356,"readMsAvg":"38","waitRatioAvg":0.0009900990099009901,"completedParallelInputs":"92","computeRatioMax":0.1007920792079208,"name":"S1E: Join","shuffleOutputBytes":"113251383","recordsWritten":"1399063","readRatioMax":0.019603960396039604,"steps":[{"kind":"READ","substeps":["$100:ws_sold_date_sk, $101:ws_item_sk, $102:ws_order_number, $103:ws_quantity, $104:ws_ext_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$200, $201, $202, $203, $205","FROM __stage0E_output"]},{"kind":"READ","substeps":["$110, $111","FROM __stage0D_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $470 = $110"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $101 = $200"]},{"kind":"WRITE","substeps":["$490, $491, $492, $493, $494, $495, $496, $497, $498","TO __stage1E_output","BY HASH($491, $490)"]}],"writeRatioAvg":0.0057425742574257425},{"readMsMax":"0","computeMsMax":"653","inputStages":["28","4","0","25","8","26"],"waitMsAvg":"43","id":"31","endMs":"1570993419656","waitMsMax":"89","startMs":"1570993418878","waitRatioMax":0.017623762376237622,"readRatioAvg":0,"parallelInputs":"300","recordsRead":"59182134","computeRatioAvg":0.049900990099009904,"writeMsAvg":"14","status":"COMPLETE","writeMsMax":"171","computeMsAvg":"252","shuffleOutputBytesSpilled":"0","writeRatioMax":0.033861386138613864,"readMsAvg":"0","waitRatioAvg":0.008514851485148515,"completedParallelInputs":"300","computeRatioMax":0.1293069306930693,"name":"S1F: Join+","shuffleOutputBytes":"126515080","recordsWritten":"2010600","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$550, $551, $552, $553, $554, $555, $556, $557, $558","FROM __stage1A_output"]},{"kind":"READ","substeps":["$30, $31, $32, $33","FROM __stage08_output"]},{"kind":"READ","substeps":["$600, $601, $602, $603, $604, $605, $606, $607, $608","FROM __stage19_output"]},{"kind":"READ","substeps":["$40, $41, $42, $43","FROM __stage04_output"]},{"kind":"READ","substeps":["$650, $651, $652, $653, $654, $655, $656, $657, $658","FROM __stage1C_output"]},{"kind":"READ","substeps":["$50, $51, $52, $53","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $670 := $300, $671 := $301, $672 := $302, $673 := $303, $674 := $304","$280 := SUM($305)","$281 := SUM($306)"]},{"kind":"COMPUTE","substeps":["$340 := subtract($560, coalesce($567, 0))","$341 := subtract($561, coalesce($568, 0))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH EACH ON $551 = $31, $550 = $30"]},{"kind":"COMPUTE","substeps":["$350 := subtract($610, coalesce($617, 0))","$351 := subtract($611, coalesce($618, 0))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH EACH ON $601 = $41, $600 = $40"]},{"kind":"COMPUTE","substeps":["$360 := subtract($660, coalesce($667, 0))","$361 := subtract($661, coalesce($668, 0))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH EACH ON $651 = $51, $650 = $50"]},{"kind":"WRITE","substeps":["$280, $281, $670, $671, $672, $673, $674","TO __stage1F_output","BY HASH($670, $671, $672, $673, $674)"]}],"writeRatioAvg":0.002772277227722772},{"readMsMax":"0","computeMsMax":"569","inputStages":["12","30","16","27","20","29"],"waitMsAvg":"2","id":"32","endMs":"1570993419782","waitMsMax":"6","startMs":"1570993419118","waitRatioMax":0.001188118811881188,"readRatioAvg":0,"parallelInputs":"300","recordsRead":"59222312","computeRatioAvg":0.049900990099009904,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"150","computeMsAvg":"252","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0297029702970297,"readMsAvg":"0","waitRatioAvg":0.00039603960396039607,"completedParallelInputs":"300","computeRatioMax":0.11267326732673268,"name":"S20: Join+","shuffleOutputBytes":"135846262","recordsWritten":"2158306","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$390, $391, $392, $393, $394, $395, $396, $397, $398","FROM __stage1D_output"]},{"kind":"READ","substeps":["$1, $2, $3, $4","FROM __stage14_output"]},{"kind":"READ","substeps":["$440, $441, $442, $443, $444, $445, $446, $447, $448","FROM __stage1B_output"]},{"kind":"READ","substeps":["$10, $11, $12, $13","FROM __stage10_output"]},{"kind":"READ","substeps":["$490, $491, $492, $493, $494, $495, $496, $497, $498","FROM __stage1E_output"]},{"kind":"READ","substeps":["$20, $21, $22, $23","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $510 := $290, $511 := $291, $512 := $292, $513 := $293, $514 := $294","$270 := SUM($295)","$271 := SUM($296)"]},{"kind":"COMPUTE","substeps":["$310 := subtract($400, coalesce($407, 0))","$311 := subtract($401, coalesce($408, 0))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH EACH ON $391 = $2, $390 = $1"]},{"kind":"COMPUTE","substeps":["$320 := subtract($450, coalesce($457, 0))","$321 := subtract($451, coalesce($458, 0))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH EACH ON $441 = $11, $440 = $10"]},{"kind":"COMPUTE","substeps":["$330 := subtract($500, coalesce($507, 0))","$331 := subtract($501, coalesce($508, 0))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH EACH ON $491 = $21, $490 = $20"]},{"kind":"WRITE","substeps":["$270, $271, $510, $511, $512, $513, $514","TO __stage20_output","BY HASH($510, $511, $512, $513, $514)"]}],"writeRatioAvg":0.004356435643564357},{"readMsMax":"0","computeMsMax":"43","inputStages":["31"],"waitMsAvg":"1","id":"33","endMs":"1570993419926","waitMsMax":"2","startMs":"1570993419838","waitRatioMax":0.00039603960396039607,"readRatioAvg":0,"parallelInputs":"43","recordsRead":"2010600","computeRatioAvg":0.006930693069306931,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"40","computeMsAvg":"35","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007920792079207921,"readMsAvg":"0","waitRatioAvg":0.00019801980198019803,"completedParallelInputs":"43","computeRatioMax":0.008514851485148515,"name":"S21: Aggregate","shuffleOutputBytes":"460719","recordsWritten":"7313","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$280, $281, $670, $671, $672, $673, $674","FROM __stage1F_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $680 := $670, $681 := $671, $682 := $672, $683 := $673, $684 := $674","$260 := SUM($280)","$261 := SUM($281)"]},{"kind":"WRITE","substeps":["$260, $261, $680, $681, $682, $683, $684","TO __stage21_output","BY HASH($681, $682, $683, $684)"]}],"writeRatioAvg":0.0019801980198019802},{"readMsMax":"0","computeMsMax":"9","inputStages":["33"],"waitMsAvg":"1","id":"35","endMs":"1570993420183","waitMsMax":"4","startMs":"1570993419943","waitRatioMax":0.0007920792079207921,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"7313","computeRatioAvg":0.001188118811881188,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"34","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006732673267326733,"readMsAvg":"0","waitRatioAvg":0.00019801980198019803,"completedParallelInputs":"100","computeRatioMax":0.0017821782178217822,"name":"S23: Coalesce","shuffleOutputBytes":"460719","recordsWritten":"7313","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage21_output"]}],"writeRatioAvg":0.0031683168316831685},{"readMsMax":"0","computeMsMax":"55","inputStages":["32","35"],"waitMsAvg":"6","id":"36","endMs":"1570993420426","waitMsMax":"7","startMs":"1570993419948","waitRatioMax":0.001386138613861386,"readRatioAvg":0,"parallelInputs":"43","recordsRead":"2472765","computeRatioAvg":0.008712871287128714,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"13","computeMsAvg":"44","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0025742574257425744,"readMsAvg":"0","waitRatioAvg":0.001188118811881188,"completedParallelInputs":"43","computeRatioMax":0.01089108910891089,"name":"S24: Join+","shuffleOutputBytes":"63360","recordsWritten":"704","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$270, $271, $510, $511, $512, $513, $514","FROM __stage20_output"]},{"kind":"READ","substeps":["$260, $261, $680, $681, $682, $683, $684","FROM __stage23_output"]},{"kind":"SORT","substeps":["$240 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$240 := subtract($690, $697)","$241 := subtract($691, $698)"]},{"kind":"FILTER","substeps":["less(divide(CAST($690 AS DOUBLE), CAST($697 AS DOUBLE)), 0.9)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $521 = $681, $522 = $682, $523 = $683, $524 = $684"]},{"kind":"AGGREGATE","substeps":["GROUP BY $520 := $510, $521 := $511, $522 := $512, $523 := $513, $524 := $514","$250 := SUM($270)","$251 := SUM($271)"]},{"kind":"WRITE","substeps":["$700, $701, $702, $703, $704, $705, $706, $707, $708, $709","TO __stage24_output"]}],"writeRatioAvg":0.0009900990099009901},{"readMsMax":"0","computeMsMax":"8","inputStages":["36"],"waitMsAvg":"1","id":"37","endMs":"1570993420436","waitMsMax":"1","startMs":"1570993419965","waitRatioMax":0.00019801980198019803,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"704","computeRatioAvg":0.0015841584158415843,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001188118811881188,"readMsAvg":"0","waitRatioAvg":0.00019801980198019803,"completedParallelInputs":"1","computeRatioMax":0.0015841584158415843,"name":"S25: Output","shuffleOutputBytes":"9000","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$700, $701, $702, $703, $704, $705, $706, $707, $708, $709","FROM __stage24_output"]},{"kind":"SORT","substeps":["$700 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$710, $711, $712, $713, $714, $715, $716, $717, $718, $719","TO __stage25_output"]}],"writeRatioAvg":0.001188118811881188}],"estimatedBytesProcessed":"21106002954","timeline":[{"totalSlotMs":"40837","activeUnits":"733","completedUnits":"8","elapsedMs":"825","pendingUnits":"733"},{"totalSlotMs":"630131","activeUnits":"768","completedUnits":"773","elapsedMs":"1855","pendingUnits":"109"},{"totalSlotMs":"718050","activeUnits":"31","completedUnits":"870","elapsedMs":"2915","pendingUnits":"12"},{"totalSlotMs":"888814","activeUnits":"393","completedUnits":"1474","elapsedMs":"3989","pendingUnits":"8"},{"totalSlotMs":"909988","activeUnits":"58","completedUnits":"1624","elapsedMs":"4440","pendingUnits":"45"},{"totalSlotMs":"918342","activeUnits":"46","completedUnits":"1669","elapsedMs":"11724","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"21106786304","totalPartitionsProcessed":"0","totalBytesProcessed":"21106002954","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"web_returns","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_100"}]},"endTime":"1570993427508"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query75_1570993414"},"etag":"Hcn2gTYNALOdL9Wm6dE8bA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query75_1570993414?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonf11d15d43bca04470c08e2d724befedea878e729","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query75\nWITH all_sales \n AS (SELECT d_year, \n i_brand_id, \n i_class_id, \n i_category_id, \n i_manufact_id, \n Sum(sales_cnt) AS sales_cnt, \n Sum(sales_amt) AS sales_amt \n FROM (SELECT d_year, \n i_brand_id, \n i_class_id, \n i_category_id, \n i_manufact_id, \n cs_quantity - COALESCE(cr_return_quantity, 0) AS \n sales_cnt, \n cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS \n sales_amt \n FROM catalog_sales \n JOIN item \n ON i_item_sk = cs_item_sk \n JOIN date_dim \n ON d_date_sk = cs_sold_date_sk \n LEFT JOIN catalog_returns \n ON ( cs_order_number = cr_order_number \n AND cs_item_sk = cr_item_sk ) \n WHERE i_category = 'Men' \n UNION ALL\n SELECT d_year, \n i_brand_id, \n i_class_id, \n i_category_id, \n i_manufact_id, \n ss_quantity - COALESCE(sr_return_quantity, 0) AS \n sales_cnt, \n ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS \n sales_amt \n FROM store_sales \n JOIN item \n ON i_item_sk = ss_item_sk \n JOIN date_dim \n ON d_date_sk = ss_sold_date_sk \n LEFT JOIN store_returns \n ON ( ss_ticket_number = sr_ticket_number \n AND ss_item_sk = sr_item_sk ) \n WHERE i_category = 'Men' \n UNION ALL\n SELECT d_year, \n i_brand_id, \n i_class_id, \n i_category_id, \n i_manufact_id, \n ws_quantity - COALESCE(wr_return_quantity, 0) AS \n sales_cnt, \n ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS \n sales_amt \n FROM web_sales \n JOIN item \n ON i_item_sk = ws_item_sk \n JOIN date_dim \n ON d_date_sk = ws_sold_date_sk \n LEFT JOIN web_returns \n ON ( ws_order_number = wr_order_number \n AND ws_item_sk = wr_item_sk ) \n WHERE i_category = 'Men') sales_detail \n GROUP BY d_year, \n i_brand_id, \n i_class_id, \n i_category_id, \n i_manufact_id) \nSELECT prev_yr.d_year AS prev_year, \n curr_yr.d_year AS year1, \n curr_yr.i_brand_id, \n curr_yr.i_class_id, \n curr_yr.i_category_id, \n curr_yr.i_manufact_id, \n prev_yr.sales_cnt AS prev_yr_cnt, \n curr_yr.sales_cnt AS curr_yr_cnt, \n curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, \n curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff \nFROM all_sales curr_yr, \n all_sales prev_yr \nWHERE curr_yr.i_brand_id = prev_yr.i_brand_id \n AND curr_yr.i_class_id = prev_yr.i_class_id \n AND curr_yr.i_category_id = prev_yr.i_category_id \n AND curr_yr.i_manufact_id = prev_yr.i_manufact_id \n AND curr_yr.d_year = 2002 \n AND prev_yr.d_year = 2002 - 1 \n AND curr_yr.sales_cnt / prev_yr.sales_cnt\n < 0.9 \nORDER BY sales_cnt_diff\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query75_1570993414","user_email":"nithish.sankaranarayanan@ulb.be"}
