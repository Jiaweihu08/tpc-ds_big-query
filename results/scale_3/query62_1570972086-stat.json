{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"8166","creationTime":"1570972087969","totalBytesProcessed":"289141049","startTime":"1570972088118","query":{"totalSlotMs":"8166","queryPlan":[{"readMsMax":"9","computeMsMax":"9","waitMsAvg":"1","id":"0","endMs":"1570972088456","waitMsMax":"1","startMs":"1570972088388","waitRatioMax":0.0005627462014631402,"readRatioAvg":0.005064715813168261,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.005064715813168261,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0033764772087788407,"readMsAvg":"9","waitRatioAvg":0.0005627462014631402,"completedParallelInputs":"1","computeRatioMax":0.005064715813168261,"name":"S00: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.005064715813168261,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $11:d_month_seq","FROM date_dim","WHERE between($11, 1222, 1233)"]},{"kind":"WRITE","substeps":["$10","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.0033764772087788407},{"readMsMax":"53","computeMsMax":"5","waitMsAvg":"26","id":"1","endMs":"1570972088493","waitMsMax":"26","startMs":"1570972088427","waitRatioMax":0.014631401238041642,"readRatioAvg":0.029825548677546426,"parallelInputs":"1","recordsRead":"42","computeRatioAvg":0.0028137310073157004,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0022509848058525606,"readMsAvg":"53","waitRatioAvg":0.014631401238041642,"completedParallelInputs":"1","computeRatioMax":0.0028137310073157004,"name":"S01: Input","shuffleOutputBytes":"840","recordsWritten":"42","readRatioMax":0.029825548677546426,"steps":[{"kind":"READ","substeps":["$1:web_site_sk, $2:web_name","FROM web_site"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage01_output","BY HASH($1)"]}],"writeRatioAvg":0.0022509848058525606},{"readMsMax":"28","computeMsMax":"6","waitMsAvg":"37","id":"2","endMs":"1570972088685","waitMsMax":"37","startMs":"1570972088456","waitRatioMax":0.020821609454136185,"readRatioAvg":0.015756893640967922,"parallelInputs":"1","recordsRead":"20","computeRatioAvg":0.0033764772087788407,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0033764772087788407,"readMsAvg":"28","waitRatioAvg":0.020821609454136185,"completedParallelInputs":"1","computeRatioMax":0.0033764772087788407,"name":"S02: Input","shuffleOutputBytes":"430","recordsWritten":"20","readRatioMax":0.015756893640967922,"steps":[{"kind":"READ","substeps":["$20:sm_ship_mode_sk, $21:sm_type","FROM ship_mode"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.0033764772087788407},{"readMsMax":"26","computeMsMax":"7","waitMsAvg":"34","id":"3","endMs":"1570972088607","waitMsMax":"34","startMs":"1570972088471","waitRatioMax":0.019133370849746763,"readRatioAvg":0.014631401238041642,"parallelInputs":"1","recordsRead":"10","computeRatioAvg":0.0039392234102419805,"writeMsAvg":"98","status":"COMPLETE","writeMsMax":"98","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05514912774338773,"readMsAvg":"26","waitRatioAvg":0.019133370849746763,"completedParallelInputs":"1","computeRatioMax":0.0039392234102419805,"name":"S03: Input","shuffleOutputBytes":"299","recordsWritten":"10","readRatioMax":0.014631401238041642,"steps":[{"kind":"READ","substeps":["$40:w_warehouse_sk, $41:w_warehouse_name","FROM warehouse"]},{"kind":"WRITE","substeps":["$40, $41","TO __stage03_output","BY HASH($40)"]}],"writeRatioAvg":0.05514912774338773},{"readMsMax":"41","computeMsMax":"1777","inputStages":["0","1","2","3"],"waitMsAvg":"2","id":"6","endMs":"1570972089842","waitMsMax":"2","startMs":"1570972088739","waitRatioMax":0.0011254924029262803,"readRatioAvg":0.016882386043894203,"parallelInputs":"4","recordsRead":"7202778","computeRatioAvg":0.9200900393922341,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"1635","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005064715813168261,"readMsAvg":"30","waitRatioAvg":0.0011254924029262803,"completedParallelInputs":"4","computeRatioMax":1,"name":"S06: Join+","shuffleOutputBytes":"150192","recordsWritten":"1680","readRatioMax":0.023072594259988744,"steps":[{"kind":"READ","substeps":["$30:ws_sold_date_sk, $31:ws_ship_date_sk, $32:ws_web_site_sk, $33:ws_ship_mode_sk, $34:ws_warehouse_sk","FROM web_sales"]},{"kind":"READ","substeps":["$40, $41","FROM __stage03_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage02_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage01_output"]},{"kind":"READ","substeps":["$10","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $120 := $70, $121 := $111, $122 := $110","$60 := SUM($75)","$61 := SUM($74)","$62 := SUM($73)","$63 := SUM($72)","$64 := SUM($71)"]},{"kind":"COMPUTE","substeps":["$70 := substr($114, 1, 20)","$71 := case_no_value(greater(subtract($113, $112), 120), 1, 0)","$72 := case_no_value(and(greater(subtract($113, $112), 90), less_or_equal(subtract($113, $112), 120)), 1, 0)","$73 := case_no_value(and(greater(subtract($113, $112), 60), less_or_equal(subtract($113, $112), 90)), 1, 0)","$74 := case_no_value(and(greater(subtract($113, $112), 30), less_or_equal(subtract($113, $112), 60)), 1, 0)","$75 := case_no_value(less_or_equal(subtract($113, $112), 30), 1, 0)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $102 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $92 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $83 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $34 = $40"]},{"kind":"WRITE","substeps":["$122, $121, $60, $61, $62, $63, $64, $120","TO __stage06_output","BY HASH($120, $121, $122)"]}],"writeRatioAvg":0.0039392234102419805},{"readMsMax":"0","computeMsMax":"7","inputStages":["6"],"waitMsAvg":"4","id":"7","endMs":"1570972089953","waitMsMax":"4","startMs":"1570972089865","waitRatioMax":0.0022509848058525606,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1680","computeRatioAvg":0.0039392234102419805,"writeMsAvg":"45","status":"COMPLETE","writeMsMax":"45","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.025323579065841307,"readMsAvg":"0","waitRatioAvg":0.0022509848058525606,"completedParallelInputs":"1","computeRatioMax":0.0039392234102419805,"name":"S07: Sort+","shuffleOutputBytes":"8828","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$122, $121, $60, $61, $62, $63, $64, $120","FROM __stage06_output"]},{"kind":"SORT","substeps":["$130 ASC, $131 ASC, $132 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $130 := $120, $131 := $121, $132 := $122","$50 := SUM($60)","$51 := SUM($61)","$52 := SUM($62)","$53 := SUM($63)","$54 := SUM($64)"]},{"kind":"WRITE","substeps":["$140, $141, $142, $143, $144, $145, $146, $147","TO __stage07_output"]}],"writeRatioAvg":0.025323579065841307},{"readMsMax":"0","computeMsMax":"9","inputStages":["7"],"waitMsAvg":"1","id":"8","endMs":"1570972089974","waitMsMax":"1","startMs":"1570972089885","waitRatioMax":0.0005627462014631402,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.005064715813168261,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"12","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006752954417557681,"readMsAvg":"0","waitRatioAvg":0.0005627462014631402,"completedParallelInputs":"1","computeRatioMax":0.005064715813168261,"name":"S08: Output","shuffleOutputBytes":"8828","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$140, $141, $142, $143, $144, $145, $146, $147","FROM __stage07_output"]},{"kind":"SORT","substeps":["$147 ASC, $141 ASC, $140 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$150, $151, $152, $153, $154, $155, $156, $157","TO __stage08_output"]}],"writeRatioAvg":0.006752954417557681}],"estimatedBytesProcessed":"289141049","timeline":[{"totalSlotMs":"500","activeUnits":"4","completedUnits":"4","elapsedMs":"771","pendingUnits":"4"},{"totalSlotMs":"8166","activeUnits":"4","completedUnits":"10","elapsedMs":"2005","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"289406976","totalPartitionsProcessed":"0","totalBytesProcessed":"289141049","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"warehouse","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_site","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"ship_mode","datasetId":"scale_10"}]},"endTime":"1570972090152"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query62_1570972086"},"etag":"ddJ2g0HeKI4rI5DeEpS6zw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query62_1570972086?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon96ee4c1ec524e017d62887d53de7ec724fbcc5e3","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query62\nSELECT Substr(w_warehouse_name, 1, 20), \n sm_type, \n web_name, \n Sum(CASE \n WHEN ( ws_ship_date_sk - ws_sold_date_sk <= 30 ) THEN 1 \n ELSE 0 \n END) AS days_30, \n Sum(CASE \n WHEN ( ws_ship_date_sk - ws_sold_date_sk > 30 ) \n AND ( ws_ship_date_sk - ws_sold_date_sk <= 60 ) THEN 1 \n ELSE 0 \n END) AS days_31_60, \n Sum(CASE \n WHEN ( ws_ship_date_sk - ws_sold_date_sk > 60 ) \n AND ( ws_ship_date_sk - ws_sold_date_sk <= 90 ) THEN 1 \n ELSE 0 \n END) AS days_61_90, \n Sum(CASE \n WHEN ( ws_ship_date_sk - ws_sold_date_sk > 90 ) \n AND ( ws_ship_date_sk - ws_sold_date_sk <= 120 ) THEN \n 1 \n ELSE 0 \n END) AS days_91_120, \n Sum(CASE \n WHEN ( ws_ship_date_sk - ws_sold_date_sk > 120 ) THEN 1 \n ELSE 0 \n END) AS days_over_120 \nFROM web_sales, \n warehouse, \n ship_mode, \n web_site, \n date_dim \nWHERE d_month_seq BETWEEN 1222 AND 1222 + 11 \n AND ws_ship_date_sk = d_date_sk \n AND ws_warehouse_sk = w_warehouse_sk \n AND ws_ship_mode_sk = sm_ship_mode_sk \n AND ws_web_site_sk = web_site_sk \nGROUP BY 1, \n sm_type, \n web_name \nORDER BY 1, \n sm_type, \n web_name\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query62_1570972086","user_email":"nithish.sankaranarayanan@ulb.be"}
