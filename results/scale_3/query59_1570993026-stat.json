{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"1101329","creationTime":"1570993029057","totalBytesProcessed":"6462883902","startTime":"1570993029172","query":{"totalSlotMs":"1101329","queryPlan":[{"readMsMax":"14","computeMsMax":"66","waitMsAvg":"1","id":"0","endMs":"1570993029396","waitMsMax":"1","startMs":"1570993029329","waitRatioMax":0.00028050490883590464,"readRatioAvg":0.003927068723702665,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.018513323983169707,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"12","computeMsAvg":"66","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0033660589060308557,"readMsAvg":"14","waitRatioAvg":0.00028050490883590464,"completedParallelInputs":"1","computeRatioMax":0.018513323983169707,"name":"S00: Input","shuffleOutputBytes":"2201906","recordsWritten":"73049","readRatioMax":0.003927068723702665,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_week_seq, $72:d_day_name","FROM date_dim"]},{"kind":"WRITE","substeps":["$70, $71, $72","TO __stage00_output","BY HASH($70)"]}],"writeRatioAvg":0.0033660589060308557},{"readMsMax":"13","computeMsMax":"70","waitMsAvg":"23","id":"2","endMs":"1570993029452","waitMsMax":"23","startMs":"1570993029385","waitRatioMax":0.0064516129032258064,"readRatioAvg":0.0036465638148667602,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.019635343618513323,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"12","computeMsAvg":"70","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0033660589060308557,"readMsAvg":"13","waitRatioAvg":0.0064516129032258064,"completedParallelInputs":"1","computeRatioMax":0.019635343618513323,"name":"S02: Input","shuffleOutputBytes":"2201906","recordsWritten":"73049","readRatioMax":0.0036465638148667602,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_week_seq, $52:d_day_name","FROM date_dim"]},{"kind":"WRITE","substeps":["$50, $51, $52","TO __stage02_output","BY HASH($50)"]}],"writeRatioAvg":0.0033660589060308557},{"readMsMax":"81","computeMsMax":"3565","inputStages":["0"],"waitMsAvg":"2","id":"4","endMs":"1570993031420","waitMsMax":"20","startMs":"1570993029522","waitRatioMax":0.005610098176718092,"readRatioAvg":0.006732117812061711,"parallelInputs":"184","recordsRead":"295313939","computeRatioAvg":0.6286115007012623,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"120","computeMsAvg":"2241","shuffleOutputBytesSpilled":"0","writeRatioMax":0.033660589060308554,"readMsAvg":"24","waitRatioAvg":0.0005610098176718093,"completedParallelInputs":"184","computeRatioMax":1,"name":"S04: Join+","shuffleOutputBytes":"360512095","recordsWritten":"8241247","readRatioMax":0.022720897615708276,"steps":[{"kind":"READ","substeps":["$60:ss_sold_date_sk, $61:ss_store_sk, $62:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$70, $71, $72","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $222, $231 := $220","$140 := SUM($156)","$141 := SUM($155)","$142 := SUM($154)","$143 := SUM($153)","$144 := SUM($152)","$145 := SUM($151)","$146 := SUM($150)"]},{"kind":"COMPUTE","substeps":["$150 := case_no_value(equal($223, 'Saturday'), $221, NULL)","$151 := case_no_value(equal($223, 'Friday'), $221, NULL)","$152 := case_no_value(equal($223, 'Thursday'), $221, NULL)","$153 := case_no_value(equal($223, 'Wednesday'), $221, NULL)","$154 := case_no_value(equal($223, 'Tuesday'), $221, NULL)","$155 := case_no_value(equal($223, 'Monday'), $221, NULL)","$156 := case_no_value(equal($223, 'Sunday'), $221, NULL)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $60 = $70"]},{"kind":"WRITE","substeps":["$231, $230, $140, $141, $142, $143, $144, $145, $146","TO __stage04_output","BY HASH($230, $231)"]}],"writeRatioAvg":0.005890603085553997},{"readMsMax":"91","computeMsMax":"2957","inputStages":["2"],"waitMsAvg":"3","id":"5","endMs":"1570993032252","waitMsMax":"5","startMs":"1570993029554","waitRatioMax":0.001402524544179523,"readRatioAvg":0.006732117812061711,"parallelInputs":"184","recordsRead":"295313939","computeRatioAvg":0.632258064516129,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"118","computeMsAvg":"2254","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03309957924263675,"readMsAvg":"24","waitRatioAvg":0.0008415147265077139,"completedParallelInputs":"184","computeRatioMax":0.82945301542777,"name":"S05: Join+","shuffleOutputBytes":"360512095","recordsWritten":"8241247","readRatioMax":0.025525946704067323,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_store_sk, $42:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$50, $51, $52","FROM __stage02_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $170 := $162, $171 := $160","$120 := SUM($136)","$121 := SUM($135)","$122 := SUM($134)","$123 := SUM($133)","$124 := SUM($132)","$125 := SUM($131)","$126 := SUM($130)"]},{"kind":"COMPUTE","substeps":["$130 := case_no_value(equal($163, 'Saturday'), $161, NULL)","$131 := case_no_value(equal($163, 'Friday'), $161, NULL)","$132 := case_no_value(equal($163, 'Thursday'), $161, NULL)","$133 := case_no_value(equal($163, 'Wednesday'), $161, NULL)","$134 := case_no_value(equal($163, 'Tuesday'), $161, NULL)","$135 := case_no_value(equal($163, 'Monday'), $161, NULL)","$136 := case_no_value(equal($163, 'Sunday'), $161, NULL)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $50"]},{"kind":"WRITE","substeps":["$171, $170, $120, $121, $122, $123, $124, $125, $126","TO __stage05_output","BY HASH($170, $171)"]}],"writeRatioAvg":0.005890603085553997},{"readMsMax":"15","computeMsMax":"13","waitMsAvg":"1","id":"6","endMs":"1570993043725","waitMsMax":"1","startMs":"1570993043657","waitRatioMax":0.00028050490883590464,"readRatioAvg":0.004207573632538569,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0036465638148667602,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0064516129032258064,"readMsAvg":"15","waitRatioAvg":0.00028050490883590464,"completedParallelInputs":"1","computeRatioMax":0.0036465638148667602,"name":"S06: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.004207573632538569,"steps":[{"kind":"READ","substeps":["$31:d_week_seq, $30:d_month_seq","FROM date_dim","WHERE between($30, 1208, 1219)"]},{"kind":"WRITE","substeps":["$31","TO __stage06_output","BY HASH($31)"]}],"writeRatioAvg":0.0064516129032258064},{"readMsMax":"20","computeMsMax":"7","waitMsAvg":"1","id":"7","endMs":"1570993043729","waitMsMax":"1","startMs":"1570993043680","waitRatioMax":0.00028050490883590464,"readRatioAvg":0.005610098176718092,"parallelInputs":"1","recordsRead":"402","computeRatioAvg":0.0019635343618513326,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0019635343618513326,"readMsAvg":"20","waitRatioAvg":0.00028050490883590464,"completedParallelInputs":"1","computeRatioMax":0.0019635343618513326,"name":"S07: Input","shuffleOutputBytes":"12060","recordsWritten":"402","readRatioMax":0.005610098176718092,"steps":[{"kind":"READ","substeps":["$20:s_store_sk, $21:s_store_id","FROM store"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage07_output","BY HASH($20)"]}],"writeRatioAvg":0.0019635343618513326},{"readMsMax":"10","computeMsMax":"9","waitMsAvg":"1","id":"9","endMs":"1570993043921","waitMsMax":"1","startMs":"1570993043712","waitRatioMax":0.00028050490883590464,"readRatioAvg":0.002805049088359046,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0025245441795231417,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008134642356241234,"readMsAvg":"10","waitRatioAvg":0.00028050490883590464,"completedParallelInputs":"1","computeRatioMax":0.0025245441795231417,"name":"S09: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.002805049088359046,"steps":[{"kind":"READ","substeps":["$11:d_week_seq, $10:d_month_seq","FROM date_dim","WHERE between($10, 1196, 1207)"]},{"kind":"WRITE","substeps":["$11","TO __stage09_output","BY HASH($11)"]}],"writeRatioAvg":0.008134642356241234},{"readMsMax":"14","computeMsMax":"12","waitMsAvg":"0","id":"10","endMs":"1570993043942","waitMsMax":"0","startMs":"1570993043725","waitRatioMax":0,"readRatioAvg":0.003927068723702665,"parallelInputs":"1","recordsRead":"402","computeRatioAvg":0.0033660589060308557,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"12","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0033660589060308557,"readMsAvg":"14","waitRatioAvg":0,"completedParallelInputs":"1","computeRatioMax":0.0033660589060308557,"name":"S0A: Input","shuffleOutputBytes":"15623","recordsWritten":"402","readRatioMax":0.003927068723702665,"steps":[{"kind":"READ","substeps":["$1:s_store_sk, $2:s_store_id, $3:s_store_name","FROM store"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage0A_output","BY HASH($1)"]}],"writeRatioAvg":0.0033660589060308557},{"readMsMax":"0","computeMsMax":"486","inputStages":["4","6","7"],"waitMsAvg":"1","id":"12","endMs":"1570993044145","waitMsMax":"1","startMs":"1570993043770","waitRatioMax":0.00028050490883590464,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"8255053","computeRatioAvg":0.1152875175315568,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"411","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007573632538569425,"readMsAvg":"0","waitRatioAvg":0.00028050490883590464,"completedParallelInputs":"18","computeRatioMax":0.13632538569424965,"name":"S0C: Join+","shuffleOutputBytes":"6811689","recordsWritten":"73365","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$231, $230, $140, $141, $142, $143, $144, $145, $146","FROM __stage04_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage07_output"]},{"kind":"READ","substeps":["$31","FROM __stage06_output"]},{"kind":"COMPUTE","substeps":["$90 := subtract($271, 52)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $250 = $31"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $241 = $20"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230, $241 := $231","$110 := SUM($140)","$111 := SUM($141)","$112 := SUM($142)","$113 := SUM($143)","$114 := SUM($144)","$115 := SUM($145)","$116 := SUM($146)"]},{"kind":"WRITE","substeps":["$90, $270, $272, $273, $274, $275, $276, $277, $278","TO __stage0C_output","BY HASH($270, $90)"]}],"writeRatioAvg":0.0025245441795231417},{"readMsMax":"0","computeMsMax":"11","inputStages":["12"],"waitMsAvg":"3","id":"14","endMs":"1570993044535","waitMsMax":"5","startMs":"1570993044155","waitRatioMax":0.001402524544179523,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"73365","computeRatioAvg":0.001402524544179523,"writeMsAvg":"125","status":"COMPLETE","writeMsMax":"205","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05750350631136045,"readMsAvg":"0","waitRatioAvg":0.0008415147265077139,"completedParallelInputs":"100","computeRatioMax":0.0030855539971949507,"name":"S0E: Coalesce","shuffleOutputBytes":"6811689","recordsWritten":"73365","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0C_output"]}],"writeRatioAvg":0.03506311360448808},{"readMsMax":"0","computeMsMax":"527","inputStages":["5","14","9","10"],"waitMsAvg":"6","id":"15","endMs":"1570993058196","waitMsMax":"6","startMs":"1570993044160","waitRatioMax":0.0016830294530154279,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"9575641","computeRatioAvg":0.12819074333800842,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"457","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002244039270687237,"readMsAvg":"0","waitRatioAvg":0.0016830294530154279,"completedParallelInputs":"18","computeRatioMax":0.14782608695652175,"name":"S0F: Join+","shuffleOutputBytes":"169184","recordsWritten":"1800","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$171, $170, $120, $121, $122, $123, $124, $125, $126","FROM __stage05_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage0A_output"]},{"kind":"READ","substeps":["$11","FROM __stage09_output"]},{"kind":"READ","substeps":["$90, $270, $272, $273, $274, $275, $276, $277, $278","FROM __stage0E_output"]},{"kind":"COMPUTE","substeps":["$80 := divide($303, $310)","$81 := divide($304, $311)","$82 := divide($305, $312)","$83 := divide($306, $313)","$84 := divide($307, $314)","$85 := divide($308, $315)","$86 := divide($309, $316)"]},{"kind":"SORT","substeps":["$281 ASC, $280 ASC, $282 ASC","LIMIT 100"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $210 = $270, $212 = $90"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $190 = $11"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $181 = $1"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $170, $181 := $171","$100 := SUM($120)","$101 := SUM($121)","$102 := SUM($122)","$103 := SUM($123)","$104 := SUM($124)","$105 := SUM($125)","$106 := SUM($126)"]},{"kind":"WRITE","substeps":["$300, $301, $302, $80, $81, $82, $83, $84, $85, $86","TO __stage0F_output"]}],"writeRatioAvg":0.001402524544179523},{"readMsMax":"0","computeMsMax":"10","inputStages":["15"],"waitMsAvg":"2","id":"16","endMs":"1570993058210","waitMsMax":"2","startMs":"1570993044215","waitRatioMax":0.0005610098176718093,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1800","computeRatioAvg":0.002805049088359046,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0019635343618513326,"readMsAvg":"0","waitRatioAvg":0.0005610098176718093,"completedParallelInputs":"1","computeRatioMax":0.002805049088359046,"name":"S10: Output","shuffleOutputBytes":"9400","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$300, $301, $302, $80, $81, $82, $83, $84, $85, $86","FROM __stage0F_output"]},{"kind":"SORT","substeps":["$301 ASC, $300 ASC, $302 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$320, $321, $322, $323, $324, $325, $326, $327, $328, $329","TO __stage10_output"]}],"writeRatioAvg":0.0019635343618513326}],"estimatedBytesProcessed":"6462883902","timeline":[{"totalSlotMs":"53588","activeUnits":"368","completedUnits":"2","elapsedMs":"658","pendingUnits":"368"},{"totalSlotMs":"834996","activeUnits":"102","completedUnits":"368","elapsedMs":"2197","pendingUnits":"2"},{"totalSlotMs":"837881","activeUnits":"2","completedUnits":"370","elapsedMs":"3582","pendingUnits":"0"},{"totalSlotMs":"873912","activeUnits":"118","completedUnits":"492","elapsedMs":"15545","pendingUnits":"19"},{"totalSlotMs":"1098439","activeUnits":"13","completedUnits":"506","elapsedMs":"28720","pendingUnits":"5"},{"totalSlotMs":"1101329","activeUnits":"0","completedUnits":"511","elapsedMs":"29224","pendingUnits":"0"},{"totalSlotMs":"1101329","activeUnits":"0","completedUnits":"511","elapsedMs":"30272","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"6463422464","totalPartitionsProcessed":"0","totalBytesProcessed":"6462883902","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_100"}]},"endTime":"1570993059477"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query59_1570993026"},"etag":"9I233WLvZFl2VcrVE6LKwQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query59_1570993026?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon385f3c87f9375e58d942700b62a0c6b97db047ce","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query59\nWITH wss \n AS (SELECT d_week_seq, \n ss_store_sk, \n Sum(CASE \n WHEN ( d_day_name = 'Sunday' ) THEN ss_sales_price \n ELSE NULL \n END) sun_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Monday' ) THEN ss_sales_price \n ELSE NULL \n END) mon_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Tuesday' ) THEN ss_sales_price \n ELSE NULL \n END) tue_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Wednesday' ) THEN ss_sales_price \n ELSE NULL \n END) wed_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Thursday' ) THEN ss_sales_price \n ELSE NULL \n END) thu_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Friday' ) THEN ss_sales_price \n ELSE NULL \n END) fri_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Saturday' ) THEN ss_sales_price \n ELSE NULL \n END) sat_sales \n FROM store_sales, \n date_dim \n WHERE d_date_sk = ss_sold_date_sk \n GROUP BY d_week_seq, \n ss_store_sk) \nSELECT s_store_name1, \n s_store_id1, \n d_week_seq1, \n sun_sales1 / sun_sales2, \n mon_sales1 / mon_sales2, \n tue_sales1 / tue_sales2, \n wed_sales1 / wed_sales2, \n thu_sales1 / thu_sales2, \n fri_sales1 / fri_sales2, \n sat_sales1 / sat_sales2 \nFROM (SELECT s_store_name s_store_name1, \n wss.d_week_seq d_week_seq1, \n s_store_id s_store_id1, \n sun_sales sun_sales1, \n mon_sales mon_sales1, \n tue_sales tue_sales1, \n wed_sales wed_sales1, \n thu_sales thu_sales1, \n fri_sales fri_sales1, \n sat_sales sat_sales1 \n FROM wss, \n store, \n date_dim d \n WHERE d.d_week_seq = wss.d_week_seq \n AND ss_store_sk = s_store_sk \n AND d_month_seq BETWEEN 1196 AND 1196 + 11) y, \n (SELECT s_store_name s_store_name2, \n wss.d_week_seq d_week_seq2, \n s_store_id s_store_id2, \n sun_sales sun_sales2, \n mon_sales mon_sales2, \n tue_sales tue_sales2, \n wed_sales wed_sales2, \n thu_sales thu_sales2, \n fri_sales fri_sales2, \n sat_sales sat_sales2 \n FROM wss, \n store, \n date_dim d \n WHERE d.d_week_seq = wss.d_week_seq \n AND ss_store_sk = s_store_sk \n AND d_month_seq BETWEEN 1196 + 12 AND 1196 + 23) x \nWHERE s_store_id1 = s_store_id2 \n AND d_week_seq1 = d_week_seq2 - 52 \nORDER BY s_store_name1, \n s_store_id1, \n d_week_seq1\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query59_1570993026","user_email":"nithish.sankaranarayanan@ulb.be"}
