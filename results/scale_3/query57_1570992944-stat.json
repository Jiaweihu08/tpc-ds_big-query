{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"2597823","creationTime":"1570992946801","totalBytesProcessed":"4599748405","startTime":"1570992946956","query":{"totalSlotMs":"2597823","queryPlan":[{"readMsMax":"19","computeMsMax":"12","waitMsAvg":"4","id":"0","endMs":"1570992976777","waitMsMax":"4","startMs":"1570992971699","waitRatioMax":0.00097442143727162,"readRatioAvg":0.004628501827040195,"parallelInputs":"1","recordsRead":"30","computeRatioAvg":0.00292326431181486,"writeMsAvg":"2912","status":"COMPLETE","writeMsMax":"2912","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.7093788063337393,"readMsAvg":"19","waitRatioAvg":0.00097442143727162,"completedParallelInputs":"1","computeRatioMax":0.00292326431181486,"name":"S00: Input","shuffleOutputBytes":"821","recordsWritten":"30","readRatioMax":0.004628501827040195,"steps":[{"kind":"READ","substeps":["$80:cc_call_center_sk, $81:cc_name","FROM call_center"]},{"kind":"WRITE","substeps":["$80, $81","TO __stage00_output","BY HASH($80)"]}],"writeRatioAvg":0.7093788063337393},{"readMsMax":"11","computeMsMax":"18","waitMsAvg":"1","id":"1","endMs":"1570992978771","waitMsMax":"1","startMs":"1570992972745","waitRatioMax":0.000243605359317905,"readRatioAvg":0.002679658952496955,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.00438489646772229,"writeMsAvg":"3899","status":"COMPLETE","writeMsMax":"3899","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.9498172959805116,"readMsAvg":"11","waitRatioAvg":0.000243605359317905,"completedParallelInputs":"1","computeRatioMax":0.00438489646772229,"name":"S01: Input","shuffleOutputBytes":"11556","recordsWritten":"428","readRatioMax":0.002679658952496955,"steps":[{"kind":"READ","substeps":["$110:d_date_sk, $111:d_year, $112:d_moy","FROM date_dim","WHERE or(equal($111, 2000), and(equal($111, 1999), equal($112, 12)), and(equal($111, 2001), equal($112, 1)))"]},{"kind":"WRITE","substeps":["$110, $111, $112","TO __stage01_output","BY HASH($110)"]}],"writeRatioAvg":0.9498172959805116},{"readMsMax":"9","computeMsMax":"155","waitMsAvg":"45","id":"3","endMs":"1570992979453","waitMsMax":"45","startMs":"1570992974159","waitRatioMax":0.010962241169305725,"readRatioAvg":0.002192448233861145,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.037758830694275276,"writeMsAvg":"2126","status":"COMPLETE","writeMsMax":"2126","computeMsAvg":"155","shuffleOutputBytesSpilled":"0","writeRatioMax":0.517904993909866,"readMsAvg":"9","waitRatioAvg":0.010962241169305725,"completedParallelInputs":"1","computeRatioMax":0.037758830694275276,"name":"S03: Input","shuffleOutputBytes":"8359844","recordsWritten":"204000","readRatioMax":0.002192448233861145,"steps":[{"kind":"READ","substeps":["$90:i_item_sk, $91:i_brand, $92:i_category","FROM item"]},{"kind":"WRITE","substeps":["$90, $91, $92","TO __stage03_output","BY HASH($90)"]}],"writeRatioAvg":0.517904993909866},{"readMsMax":"10","computeMsMax":"7","waitMsAvg":"53","id":"4","endMs":"1570992977456","waitMsMax":"53","startMs":"1570992974606","waitRatioMax":0.012911084043848964,"readRatioAvg":0.00243605359317905,"parallelInputs":"1","recordsRead":"30","computeRatioAvg":0.001705237515225335,"writeMsAvg":"1326","status":"COMPLETE","writeMsMax":"1326","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.32302070645554204,"readMsAvg":"10","waitRatioAvg":0.012911084043848964,"completedParallelInputs":"1","computeRatioMax":0.001705237515225335,"name":"S04: Input","shuffleOutputBytes":"821","recordsWritten":"30","readRatioMax":0.00243605359317905,"steps":[{"kind":"READ","substeps":["$10:cc_call_center_sk, $11:cc_name","FROM call_center"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage04_output","BY HASH($10)"]}],"writeRatioAvg":0.32302070645554204},{"readMsMax":"13","computeMsMax":"18","waitMsAvg":"25","id":"5","endMs":"1570992979138","waitMsMax":"25","startMs":"1570992974926","waitRatioMax":0.0060901339829476245,"readRatioAvg":0.003166869671132765,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.00438489646772229,"writeMsAvg":"2731","status":"COMPLETE","writeMsMax":"2731","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.6652862362971985,"readMsAvg":"13","waitRatioAvg":0.0060901339829476245,"completedParallelInputs":"1","computeRatioMax":0.00438489646772229,"name":"S05: Input","shuffleOutputBytes":"11556","recordsWritten":"428","readRatioMax":0.003166869671132765,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_year, $72:d_moy","FROM date_dim","WHERE or(equal($71, 2000), and(equal($71, 1999), equal($72, 12)), and(equal($71, 2001), equal($72, 1)))"]},{"kind":"WRITE","substeps":["$70, $71, $72","TO __stage05_output","BY HASH($70)"]}],"writeRatioAvg":0.6652862362971985},{"readMsMax":"11","computeMsMax":"149","waitMsAvg":"103","id":"7","endMs":"1570992979456","waitMsMax":"103","startMs":"1570992976025","waitRatioMax":0.025091352009744213,"readRatioAvg":0.002679658952496955,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.036297198538367846,"writeMsAvg":"1817","status":"COMPLETE","writeMsMax":"1817","computeMsAvg":"149","shuffleOutputBytesSpilled":"0","writeRatioMax":0.4426309378806334,"readMsAvg":"11","waitRatioAvg":0.025091352009744213,"completedParallelInputs":"1","computeRatioMax":0.036297198538367846,"name":"S07: Input","shuffleOutputBytes":"8359844","recordsWritten":"204000","readRatioMax":0.002679658952496955,"steps":[{"kind":"READ","substeps":["$50:i_item_sk, $51:i_brand, $52:i_category","FROM item"]},{"kind":"WRITE","substeps":["$50, $51, $52","TO __stage07_output","BY HASH($50)"]}],"writeRatioAvg":0.4426309378806334},{"readMsMax":"4","computeMsMax":"7","waitMsAvg":"62","id":"8","endMs":"1570992979961","waitMsMax":"62","startMs":"1570992976407","waitRatioMax":0.01510353227771011,"readRatioAvg":0.00097442143727162,"parallelInputs":"1","recordsRead":"30","computeRatioAvg":0.001705237515225335,"writeMsAvg":"2870","status":"COMPLETE","writeMsMax":"2870","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.6991473812423873,"readMsAvg":"4","waitRatioAvg":0.01510353227771011,"completedParallelInputs":"1","computeRatioMax":0.001705237515225335,"name":"S08: Input","shuffleOutputBytes":"821","recordsWritten":"30","readRatioMax":0.00097442143727162,"steps":[{"kind":"READ","substeps":["$1:cc_call_center_sk, $2:cc_name","FROM call_center"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage08_output","BY HASH($1)"]}],"writeRatioAvg":0.6991473812423873},{"readMsMax":"13","computeMsMax":"22","waitMsAvg":"110","id":"9","endMs":"1570992980655","waitMsMax":"110","startMs":"1570992977190","waitRatioMax":0.02679658952496955,"readRatioAvg":0.003166869671132765,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.00535931790499391,"writeMsAvg":"1876","status":"COMPLETE","writeMsMax":"1876","computeMsAvg":"22","shuffleOutputBytesSpilled":"0","writeRatioMax":0.4570036540803898,"readMsAvg":"13","waitRatioAvg":0.02679658952496955,"completedParallelInputs":"1","computeRatioMax":0.00535931790499391,"name":"S09: Input","shuffleOutputBytes":"11556","recordsWritten":"428","readRatioMax":0.003166869671132765,"steps":[{"kind":"READ","substeps":["$40:d_date_sk, $41:d_year, $42:d_moy","FROM date_dim","WHERE or(equal($41, 2000), and(equal($41, 1999), equal($42, 12)), and(equal($41, 2001), equal($42, 1)))"]},{"kind":"WRITE","substeps":["$40, $41, $42","TO __stage09_output","BY HASH($40)"]}],"writeRatioAvg":0.4570036540803898},{"readMsMax":"11","computeMsMax":"199","waitMsAvg":"1","id":"11","endMs":"1570992982002","waitMsMax":"1","startMs":"1570992978807","waitRatioMax":0.000243605359317905,"readRatioAvg":0.002679658952496955,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.04847746650426309,"writeMsAvg":"1598","status":"COMPLETE","writeMsMax":"1598","computeMsAvg":"199","shuffleOutputBytesSpilled":"0","writeRatioMax":0.3892813641900122,"readMsAvg":"11","waitRatioAvg":0.000243605359317905,"completedParallelInputs":"1","computeRatioMax":0.04847746650426309,"name":"S0B: Input","shuffleOutputBytes":"8359844","recordsWritten":"204000","readRatioMax":0.002679658952496955,"steps":[{"kind":"READ","substeps":["$20:i_item_sk, $21:i_brand, $22:i_category","FROM item"]},{"kind":"WRITE","substeps":["$20, $21, $22","TO __stage0B_output","BY HASH($20)"]}],"writeRatioAvg":0.3892813641900122},{"readMsMax":"183","computeMsMax":"2364","inputStages":["0","1","3"],"waitMsAvg":"9","id":"12","endMs":"1570992984004","waitMsMax":"20","startMs":"1570992981399","waitRatioMax":0.0048721071863581,"readRatioAvg":0.007551766138855055,"parallelInputs":"141","recordsRead":"172835849","computeRatioAvg":0.29037758830694277,"writeMsAvg":"87","status":"COMPLETE","writeMsMax":"303","computeMsAvg":"1192","shuffleOutputBytesSpilled":"0","writeRatioMax":0.07381242387332522,"readMsAvg":"31","waitRatioAvg":0.002192448233861145,"completedParallelInputs":"141","computeRatioMax":0.5758830694275274,"name":"S0C: Join+","shuffleOutputBytes":"50091684","recordsWritten":"642798","readRatioMax":0.044579780755176615,"steps":[{"kind":"READ","substeps":["$100:cs_sold_date_sk, $101:cs_call_center_sk, $102:cs_item_sk, $103:cs_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$90, $91, $92","FROM __stage03_output"]},{"kind":"READ","substeps":["$110, $111, $112","FROM __stage01_output"]},{"kind":"READ","substeps":["$80, $81","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $290 := $281, $291 := $280, $292 := $285, $293 := $283, $294 := $284","$240 := SUM($282)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $272 = $80"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $252 = $110"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $102 = $90"]},{"kind":"WRITE","substeps":["$292, $291, $290, $293, $294, $240","TO __stage0C_output","BY HASH($290, $291, $292, $293, $294)"]}],"writeRatioAvg":0.021193666260657735},{"readMsMax":"140","computeMsMax":"2269","inputStages":["4","5","7"],"waitMsAvg":"11","id":"13","endMs":"1570992984380","waitMsMax":"21","startMs":"1570992982002","waitRatioMax":0.005115712545676005,"readRatioAvg":0.00682095006090134,"parallelInputs":"141","recordsRead":"172835849","computeRatioAvg":0.2984165651644336,"writeMsAvg":"819","status":"COMPLETE","writeMsMax":"1363","computeMsAvg":"1225","shuffleOutputBytesSpilled":"0","writeRatioMax":0.3320341047503045,"readMsAvg":"28","waitRatioAvg":0.002679658952496955,"completedParallelInputs":"141","computeRatioMax":0.5527405602923264,"name":"S0D: Join+","shuffleOutputBytes":"50091684","recordsWritten":"642798","readRatioMax":0.0341047503045067,"steps":[{"kind":"READ","substeps":["$60:cs_sold_date_sk, $61:cs_call_center_sk, $62:cs_item_sk, $63:cs_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$50, $51, $52","FROM __stage07_output"]},{"kind":"READ","substeps":["$70, $71, $72","FROM __stage05_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $390 := $381, $391 := $380, $392 := $385, $393 := $383, $394 := $384","$220 := SUM($382)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $372 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $352 = $70"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $62 = $50"]},{"kind":"WRITE","substeps":["$392, $391, $390, $393, $394, $220","TO __stage0D_output","BY HASH($390, $391, $392, $393, $394)"]}],"writeRatioAvg":0.19951278928136418},{"readMsMax":"84","computeMsMax":"2180","inputStages":["8","9","11"],"waitMsAvg":"6","id":"14","endMs":"1570992984702","waitMsMax":"24","startMs":"1570992982965","waitRatioMax":0.00584652862362972,"readRatioAvg":0.007064555420219245,"parallelInputs":"141","recordsRead":"172835849","computeRatioAvg":0.29866017052375154,"writeMsAvg":"61","status":"COMPLETE","writeMsMax":"236","computeMsAvg":"1226","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05749086479902558,"readMsAvg":"29","waitRatioAvg":0.00146163215590743,"completedParallelInputs":"141","computeRatioMax":0.5310596833130329,"name":"S0E: Join+","shuffleOutputBytes":"50091684","recordsWritten":"642798","readRatioMax":0.02046285018270402,"steps":[{"kind":"READ","substeps":["$30:cs_sold_date_sk, $31:cs_call_center_sk, $32:cs_item_sk, $33:cs_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$20, $21, $22","FROM __stage0B_output"]},{"kind":"READ","substeps":["$40, $41, $42","FROM __stage09_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $480 := $471, $481 := $470, $482 := $475, $483 := $473, $484 := $474","$210 := SUM($472)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $462 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $442 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $32 = $20"]},{"kind":"WRITE","substeps":["$482, $481, $480, $483, $484, $210","TO __stage0E_output","BY HASH($480, $481, $482, $483, $484)"]}],"writeRatioAvg":0.014859926918392205},{"readMsMax":"0","computeMsMax":"89","inputStages":["12"],"waitMsAvg":"3","id":"15","endMs":"1570992985050","waitMsMax":"5","startMs":"1570992984466","waitRatioMax":0.001218026796589525,"readRatioAvg":0,"parallelInputs":"14","recordsRead":"642798","computeRatioAvg":0.018757612667478683,"writeMsAvg":"240","status":"COMPLETE","writeMsMax":"314","computeMsAvg":"77","shuffleOutputBytesSpilled":"0","writeRatioMax":0.07649208282582216,"readMsAvg":"0","waitRatioAvg":0.000730816077953715,"completedParallelInputs":"14","computeRatioMax":0.021680876979293544,"name":"S0F: Aggregate","shuffleOutputBytes":"15009653","recordsWritten":"193463","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$292, $291, $290, $293, $294, $240","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $300 := $290, $301 := $291, $302 := $292, $303 := $293, $304 := $294","$230 := SUM($240)"]},{"kind":"WRITE","substeps":["$302, $301, $300, $303, $304, $230","TO __stage0F_output","BY HASH($300, $301, $302, $303)"]}],"writeRatioAvg":0.058465286236297195},{"readMsMax":"0","computeMsMax":"98","inputStages":["13"],"waitMsAvg":"1","id":"16","endMs":"1570992985557","waitMsMax":"2","startMs":"1570992984821","waitRatioMax":0.00048721071863581,"readRatioAvg":0,"parallelInputs":"14","recordsRead":"642798","computeRatioAvg":0.01753958587088916,"writeMsAvg":"436","status":"COMPLETE","writeMsMax":"616","computeMsAvg":"72","shuffleOutputBytesSpilled":"0","writeRatioMax":0.15006090133982947,"readMsAvg":"0","waitRatioAvg":0.000243605359317905,"completedParallelInputs":"14","computeRatioMax":0.02387332521315469,"name":"S10: Aggregate","shuffleOutputBytes":"15009653","recordsWritten":"193463","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$392, $391, $390, $393, $394, $220","FROM __stage0D_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $400 := $390, $401 := $391, $402 := $392, $403 := $393, $404 := $394","$200 := SUM($220)"]},{"kind":"WRITE","substeps":["$402, $401, $400, $403, $404, $200","TO __stage10_output","BY HASH($400, $401, $402)"]}],"writeRatioAvg":0.10621193666260657},{"readMsMax":"0","computeMsMax":"96","inputStages":["14"],"waitMsAvg":"1","id":"17","endMs":"1570992989693","waitMsMax":"1","startMs":"1570992985051","waitRatioMax":0.000243605359317905,"readRatioAvg":0,"parallelInputs":"14","recordsRead":"642798","computeRatioAvg":0.01705237515225335,"writeMsAvg":"1274","status":"COMPLETE","writeMsMax":"4105","computeMsAvg":"70","shuffleOutputBytesSpilled":"0","writeRatioMax":1,"readMsAvg":"0","waitRatioAvg":0.000243605359317905,"completedParallelInputs":"14","computeRatioMax":0.02338611449451888,"name":"S11: Aggregate","shuffleOutputBytes":"15009653","recordsWritten":"193463","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$482, $481, $480, $483, $484, $210","FROM __stage0E_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $490 := $480, $491 := $481, $492 := $482, $493 := $483, $494 := $484","$180 := SUM($210)"]},{"kind":"WRITE","substeps":["$492, $491, $490, $493, $494, $180","TO __stage11_output","BY HASH($490, $491, $492)"]}],"writeRatioAvg":0.310353227771011},{"readMsMax":"0","computeMsMax":"101","inputStages":["15"],"waitMsAvg":"1","id":"18","endMs":"1570992985750","waitMsMax":"2","startMs":"1570992985302","waitRatioMax":0.00048721071863581,"readRatioAvg":0,"parallelInputs":"14","recordsRead":"193463","computeRatioAvg":0.019732034104750305,"writeMsAvg":"198","status":"COMPLETE","writeMsMax":"274","computeMsAvg":"81","shuffleOutputBytesSpilled":"0","writeRatioMax":0.06674786845310597,"readMsAvg":"0","waitRatioAvg":0.000243605359317905,"completedParallelInputs":"14","computeRatioMax":0.024604141291108404,"name":"S12: Sort+","shuffleOutputBytes":"16750812","recordsWritten":"193463","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$302, $301, $300, $303, $304, $230","FROM __stage0F_output"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$190 := AVG($315) OVER (PARTITION BY $312, $311, $310, $313 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)"]},{"kind":"SORT","substeps":["$300 ASC, $301 ASC, $302 ASC, $303 ASC"]},{"kind":"WRITE","substeps":["$320, $321, $322, $323, $324, $190, $325","TO __stage12_output","BY HASH($322, $321, $320)"]}],"writeRatioAvg":0.04823386114494519},{"readMsMax":"0","computeMsMax":"83","inputStages":["17"],"waitMsAvg":"1","id":"19","endMs":"1570992997882","waitMsMax":"2","startMs":"1570992997714","waitRatioMax":0.00048721071863581,"readRatioAvg":0,"parallelInputs":"14","recordsRead":"193463","computeRatioAvg":0.016808769792935444,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"41","computeMsAvg":"69","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009987819732034105,"readMsAvg":"0","waitRatioAvg":0.000243605359317905,"completedParallelInputs":"14","computeRatioMax":0.020219244823386114,"name":"S13: Sort+","shuffleOutputBytes":"12310883","recordsWritten":"176556","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$492, $491, $490, $493, $494, $180","FROM __stage11_output"]},{"kind":"COMPUTE","substeps":["$130 := subtract($150, 1)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$150 := RANK() OVER (PARTITION BY $502, $501, $500 ORDER BY $503 ASC, $504 ASC)"]},{"kind":"SORT","substeps":["$490 ASC, $491 ASC, $492 ASC, $493 ASC, $494 ASC"]},{"kind":"WRITE","substeps":["$130, $510, $511, $512, $513","TO __stage13_output","BY HASH($512, $511, $510, $130)"]}],"writeRatioAvg":0.00535931790499391},{"readMsMax":"0","computeMsMax":"103","inputStages":["16"],"waitMsAvg":"1","id":"20","endMs":"1570992997954","waitMsMax":"2","startMs":"1570992997741","waitRatioMax":0.00048721071863581,"readRatioAvg":0,"parallelInputs":"14","recordsRead":"193463","computeRatioAvg":0.020706455542021926,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"85","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006577344701583435,"readMsAvg":"0","waitRatioAvg":0.000243605359317905,"completedParallelInputs":"14","computeRatioMax":0.025091352009744213,"name":"S14: Sort+","shuffleOutputBytes":"12310883","recordsWritten":"176556","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$402, $401, $400, $403, $404, $200","FROM __stage10_output"]},{"kind":"COMPUTE","substeps":["$140 := add($170, 1)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$170 := RANK() OVER (PARTITION BY $412, $411, $410 ORDER BY $413 ASC, $414 ASC)"]},{"kind":"SORT","substeps":["$400 ASC, $401 ASC, $402 ASC, $403 ASC, $404 ASC"]},{"kind":"WRITE","substeps":["$140, $420, $421, $422, $423","TO __stage14_output","BY HASH($422, $421, $420, $140)"]}],"writeRatioAvg":0.0048721071863581},{"readMsMax":"0","computeMsMax":"12","inputStages":["20"],"waitMsAvg":"2","id":"22","endMs":"1570992998533","waitMsMax":"6","startMs":"1570992997966","waitRatioMax":0.00146163215590743,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"176556","computeRatioAvg":0.001705237515225335,"writeMsAvg":"46","status":"COMPLETE","writeMsMax":"62","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01510353227771011,"readMsAvg":"0","waitRatioAvg":0.00048721071863581,"completedParallelInputs":"100","computeRatioMax":0.00292326431181486,"name":"S16: Coalesce","shuffleOutputBytes":"12310883","recordsWritten":"176556","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage14_output"]}],"writeRatioAvg":0.01120584652862363},{"readMsMax":"0","computeMsMax":"12","inputStages":["19"],"waitMsAvg":"10","id":"23","endMs":"1570992998389","waitMsMax":"15","startMs":"1570992997967","waitRatioMax":0.0036540803897685747,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"176556","computeRatioAvg":0.00194884287454324,"writeMsAvg":"73","status":"COMPLETE","writeMsMax":"332","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08087697929354445,"readMsAvg":"0","waitRatioAvg":0.00243605359317905,"completedParallelInputs":"100","computeRatioMax":0.00292326431181486,"name":"S17: Coalesce","shuffleOutputBytes":"12310883","recordsWritten":"176556","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage13_output"]}],"writeRatioAvg":0.017783191230207065},{"readMsMax":"0","computeMsMax":"653","inputStages":["18","23","22"],"waitMsAvg":"15","id":"24","endMs":"1570992999617","waitMsMax":"16","startMs":"1570992997981","waitRatioMax":0.00389768574908648,"readRatioAvg":0,"parallelInputs":"14","recordsRead":"5137031","computeRatioAvg":0.1366626065773447,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"561","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0048721071863581,"readMsAvg":"0","waitRatioAvg":0.0036540803897685747,"completedParallelInputs":"14","computeRatioMax":0.15907429963459196,"name":"S18: Join+","shuffleOutputBytes":"105827","recordsWritten":"1400","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$320, $321, $322, $323, $324, $190, $325","FROM __stage12_output"]},{"kind":"READ","substeps":["$140, $420, $421, $422, $423","FROM __stage16_output"]},{"kind":"READ","substeps":["$130, $510, $511, $512, $513","FROM __stage17_output"]},{"kind":"SORT","substeps":["$120 ASC, $522 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$120 := subtract($524, $522)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $432 = $512, $431 = $511, $430 = $510, $434 = $130"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $342 = $422, $341 = $421, $340 = $420, $160 = $140"]},{"kind":"FILTER","substeps":["and(equal($343, 2000), greater($344, 0), ...)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$160 := RANK() OVER (PARTITION BY $332, $331, $330 ORDER BY $333 ASC, $334 ASC)"]},{"kind":"SORT","substeps":["$322 ASC, $321 ASC, $320 ASC, $323 ASC, $324 ASC"]},{"kind":"WRITE","substeps":["$530, $531, $532, $533, $534, $535, $536","TO __stage18_output"]}],"writeRatioAvg":0.00146163215590743},{"readMsMax":"0","computeMsMax":"7","inputStages":["24"],"waitMsAvg":"1","id":"25","endMs":"1570992999723","waitMsMax":"1","startMs":"1570992997997","waitRatioMax":0.000243605359317905,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1400","computeRatioAvg":0.001705237515225335,"writeMsAvg":"72","status":"COMPLETE","writeMsMax":"72","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01753958587088916,"readMsAvg":"0","waitRatioAvg":0.000243605359317905,"completedParallelInputs":"1","computeRatioMax":0.001705237515225335,"name":"S19: Output","shuffleOutputBytes":"6666","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$530, $531, $532, $533, $534, $535, $536","FROM __stage18_output"]},{"kind":"SORT","substeps":["$532 ASC, $534 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$540, $541, $542, $543, $544, $545","TO __stage19_output"]}],"writeRatioAvg":0.01753958587088916}],"estimatedBytesProcessed":"4599748405","timeline":[{"totalSlotMs":"79","activeUnits":"1","completedUnits":"0","elapsedMs":"25244","pendingUnits":"2"},{"totalSlotMs":"5357","activeUnits":"34","completedUnits":"0","elapsedMs":"27247","pendingUnits":"145"},{"totalSlotMs":"50071","activeUnits":"98","completedUnits":"0","elapsedMs":"28263","pendingUnits":"287"},{"totalSlotMs":"186288","activeUnits":"162","completedUnits":"0","elapsedMs":"29283","pendingUnits":"289"},{"totalSlotMs":"372034","activeUnits":"289","completedUnits":"1","elapsedMs":"30310","pendingUnits":"430"},{"totalSlotMs":"544387","activeUnits":"429","completedUnits":"2","elapsedMs":"31002","pendingUnits":"430"},{"totalSlotMs":"1298804","activeUnits":"421","completedUnits":"81","elapsedMs":"32823","pendingUnits":"351"},{"totalSlotMs":"1605002","activeUnits":"285","completedUnits":"49","elapsedMs":"33876","pendingUnits":"383"},{"totalSlotMs":"1762616","activeUnits":"144","completedUnits":"148","elapsedMs":"34889","pendingUnits":"284"},{"totalSlotMs":"2062064","activeUnits":"318","completedUnits":"132","elapsedMs":"36050","pendingUnits":"300"},{"totalSlotMs":"2465031","activeUnits":"284","completedUnits":"358","elapsedMs":"37408","pendingUnits":"88"},{"totalSlotMs":"2502233","activeUnits":"34","completedUnits":"454","elapsedMs":"38506","pendingUnits":"34"},{"totalSlotMs":"2512160","activeUnits":"6","completedUnits":"482","elapsedMs":"39008","pendingUnits":"6"},{"totalSlotMs":"2526198","activeUnits":"5","completedUnits":"488","elapsedMs":"42778","pendingUnits":"0"},{"totalSlotMs":"2583689","activeUnits":"99","completedUnits":"716","elapsedMs":"51768","pendingUnits":"15"},{"totalSlotMs":"2597823","activeUnits":"3","completedUnits":"731","elapsedMs":"53276","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"4600102912","totalPartitionsProcessed":"0","totalBytesProcessed":"4599748405","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"call_center","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_100"}]},"endTime":"1570993000266"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query57_1570992944"},"etag":"MGxwiX+jzu5tILKnfAXO4Q==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query57_1570992944?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anond1eeec49f0baf4d289d556a8d238b726d1ddd25d","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query57\nWITH v1 \n AS (SELECT i_category, \n i_brand, \n cc_name, \n d_year, \n d_moy, \n Sum(cs_sales_price) sum_sales \n , \n Avg(Sum(cs_sales_price)) \n OVER ( \n partition BY i_category, i_brand, cc_name, d_year) \n avg_monthly_sales \n , \n Rank() \n OVER ( \n partition BY i_category, i_brand, cc_name \n ORDER BY d_year, d_moy) rn \n FROM item, \n catalog_sales, \n date_dim, \n call_center \n WHERE cs_item_sk = i_item_sk \n AND cs_sold_date_sk = d_date_sk \n AND cc_call_center_sk = cs_call_center_sk \n AND ( d_year = 2000 \n OR ( d_year = 2000 - 1 \n AND d_moy = 12 ) \n OR ( d_year = 2000 + 1 \n AND d_moy = 1 ) ) \n GROUP BY i_category, \n i_brand, \n cc_name, \n d_year, \n d_moy), \n v2 \n AS (SELECT v1.i_brand, \n v1.d_year, \n v1.avg_monthly_sales, \n v1.sum_sales, \n v1_lag.sum_sales psum, \n v1_lead.sum_sales nsum \n FROM v1, \n v1 v1_lag, \n v1 v1_lead \n WHERE v1.i_category = v1_lag.i_category \n AND v1.i_category = v1_lead.i_category \n AND v1.i_brand = v1_lag.i_brand \n AND v1.i_brand = v1_lead.i_brand \n AND v1. cc_name = v1_lag. cc_name \n AND v1. cc_name = v1_lead. cc_name \n AND v1.rn = v1_lag.rn + 1 \n AND v1.rn = v1_lead.rn - 1) \nSELECT benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results scale_2.zip warmup \nFROM v2 \nWHERE d_year = 2000 \n AND avg_monthly_sales > 0 \n AND CASE \n WHEN avg_monthly_sales > 0 THEN Abs(sum_sales - avg_monthly_sales) \n / \n avg_monthly_sales \n ELSE NULL \n END > 0.1 \nORDER BY sum_sales - avg_monthly_sales, \n 3\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query57_1570992944","user_email":"nithish.sankaranarayanan@ulb.be"}
