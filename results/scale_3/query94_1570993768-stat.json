{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"621401","creationTime":"1570993769880","totalBytesProcessed":"4015575343","startTime":"1570993770929","query":{"totalSlotMs":"621401","queryPlan":[{"readMsMax":"24","computeMsMax":"1481","waitMsAvg":"8","id":"0","endMs":"1570993772344","waitMsMax":"15","startMs":"1570993771393","waitRatioMax":0.0030413625304136255,"readRatioAvg":0.004257907542579075,"parallelInputs":"3","recordsRead":"7048438","computeRatioAvg":0.29318734793187345,"writeMsAvg":"173","status":"COMPLETE","writeMsMax":"189","computeMsAvg":"1446","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03832116788321168,"readMsAvg":"21","waitRatioAvg":0.0016220600162206002,"completedParallelInputs":"3","computeRatioMax":0.3002838605028386,"name":"S00: Input","shuffleOutputBytes":"63435942","recordsWritten":"7048438","readRatioMax":0.004866180048661801,"steps":[{"kind":"READ","substeps":["$1:wr_order_number","FROM web_returns"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.03507704785077048},{"readMsMax":"45","computeMsMax":"757","waitMsAvg":"340","id":"1","endMs":"1570993772252","waitMsMax":"378","startMs":"1570993771449","waitRatioMax":0.07664233576642336,"readRatioAvg":0.0040551500405515,"parallelInputs":"92","recordsRead":"70474075","computeRatioAvg":0.12469586374695864,"writeMsAvg":"44","status":"COMPLETE","writeMsMax":"74","computeMsAvg":"615","shuffleOutputBytesSpilled":"0","writeRatioMax":0.015004055150040552,"readMsAvg":"20","waitRatioAvg":0.0689375506893755,"completedParallelInputs":"92","computeRatioMax":0.15348742903487428,"name":"S01: Input","shuffleOutputBytes":"1268392662","recordsWritten":"70474075","readRatioMax":0.009124087591240875,"steps":[{"kind":"READ","substeps":["$10:ws_warehouse_sk, $11:ws_order_number","FROM web_sales"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage01_output","BY HASH($11)"]}],"writeRatioAvg":0.008921330089213302},{"readMsMax":"16","computeMsMax":"7","waitMsAvg":"43","id":"2","endMs":"1570993771675","waitMsMax":"43","startMs":"1570993771464","waitRatioMax":0.008718572587185726,"readRatioAvg":0.0032441200324412004,"parallelInputs":"1","recordsRead":"24","computeRatioAvg":0.001419302514193025,"writeMsAvg":"31","status":"COMPLETE","writeMsMax":"31","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0062854825628548255,"readMsAvg":"16","waitRatioAvg":0.008718572587185726,"completedParallelInputs":"1","computeRatioMax":0.001419302514193025,"name":"S02: Input","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.0032441200324412004,"steps":[{"kind":"READ","substeps":["$20:web_site_sk, $21:web_company_name","FROM web_site","WHERE equal($21, 'pri')"]},{"kind":"WRITE","substeps":["$20","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.0062854825628548255},{"readMsMax":"16","computeMsMax":"21","waitMsAvg":"36","id":"3","endMs":"1570993771656","waitMsMax":"36","startMs":"1570993771471","waitRatioMax":0.0072992700729927005,"readRatioAvg":0.0032441200324412004,"parallelInputs":"1","recordsRead":"1000000","computeRatioAvg":0.004257907542579075,"writeMsAvg":"150","status":"COMPLETE","writeMsMax":"150","computeMsAvg":"21","shuffleOutputBytesSpilled":"0","writeRatioMax":0.030413625304136254,"readMsAvg":"16","waitRatioAvg":0.0072992700729927005,"completedParallelInputs":"1","computeRatioMax":0.004257907542579075,"name":"S03: Input","shuffleOutputBytes":"155583","recordsWritten":"17287","readRatioMax":0.0032441200324412004,"steps":[{"kind":"READ","substeps":["$40:ca_address_sk, $41:ca_state","FROM customer_address","WHERE equal($41, 'MT')"]},{"kind":"WRITE","substeps":["$40","TO __stage03_output","BY HASH($40)"]}],"writeRatioAvg":0.030413625304136254},{"readMsMax":"12","computeMsMax":"20","waitMsAvg":"24","id":"4","endMs":"1570993771665","waitMsMax":"24","startMs":"1570993771479","waitRatioMax":0.004866180048661801,"readRatioAvg":0.0024330900243309003,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0040551500405515,"writeMsAvg":"157","status":"COMPLETE","writeMsMax":"157","computeMsAvg":"20","shuffleOutputBytesSpilled":"0","writeRatioMax":0.031832927818329276,"readMsAvg":"12","waitRatioAvg":0.004866180048661801,"completedParallelInputs":"1","computeRatioMax":0.0040551500405515,"name":"S04: Input","shuffleOutputBytes":"558","recordsWritten":"62","readRatioMax":0.0024330900243309003,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_date","FROM date_dim","WHERE between(CAST($51 AS DATE), 11017, 11078)"]},{"kind":"WRITE","substeps":["$50","TO __stage04_output","BY HASH($50)"]}],"writeRatioAvg":0.031832927818329276},{"readMsMax":"0","computeMsMax":"12","inputStages":["3"],"waitMsAvg":"87","id":"6","endMs":"1570993771933","waitMsMax":"95","startMs":"1570993771762","waitRatioMax":0.019261962692619625,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"17287","computeRatioAvg":0.001419302514193025,"writeMsAvg":"84","status":"COMPLETE","writeMsMax":"112","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0227088402270884,"readMsAvg":"0","waitRatioAvg":0.017639902676399026,"completedParallelInputs":"100","computeRatioMax":0.0024330900243309003,"name":"S06: Coalesce","shuffleOutputBytes":"155583","recordsWritten":"17287","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage03_output"]}],"writeRatioAvg":0.0170316301703163},{"readMsMax":"212","computeMsMax":"645","inputStages":["2","6","4"],"waitMsAvg":"26","id":"8","endMs":"1570993772543","waitMsMax":"32","startMs":"1570993771781","waitRatioMax":0.006488240064882401,"readRatioAvg":0.022911597729115978,"parallelInputs":"92","recordsRead":"72070275","computeRatioAvg":0.10381184103811841,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"512","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005474452554744526,"readMsAvg":"113","waitRatioAvg":0.0052716950527169504,"completedParallelInputs":"92","computeRatioMax":0.1307785888077859,"name":"S08: Join","shuffleOutputBytes":"118044","recordsWritten":"3279","readRatioMax":0.042984590429845905,"steps":[{"kind":"READ","substeps":["$30:ws_ship_date_sk, $31:ws_ship_addr_sk, $32:ws_web_site_sk, $33:ws_warehouse_sk, $34:ws_order_number, $35:ws_ext_ship_cost, $36:ws_net_profit","FROM web_sales"]},{"kind":"READ","substeps":["$50","FROM __stage04_output"]},{"kind":"READ","substeps":["$40","FROM __stage06_output"]},{"kind":"READ","substeps":["$20","FROM __stage02_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $190 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $180 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $30 = $50"]},{"kind":"WRITE","substeps":["$200, $201, $202, $203","TO __stage08_output","BY HASH($201)"]}],"writeRatioAvg":0.001013787510137875},{"readMsMax":"0","computeMsMax":"45","inputStages":["0"],"waitMsAvg":"3","id":"9","endMs":"1570993772996","waitMsMax":"5","startMs":"1570993772360","waitRatioMax":0.001013787510137875,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"7048438","computeRatioAvg":0.006893755068937551,"writeMsAvg":"44","status":"COMPLETE","writeMsMax":"180","computeMsAvg":"34","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0364963503649635,"readMsAvg":"0","waitRatioAvg":0.0006082725060827251,"completedParallelInputs":"100","computeRatioMax":0.009124087591240875,"name":"S09: Coalesce","shuffleOutputBytes":"63435942","recordsWritten":"7048438","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage00_output"]}],"writeRatioAvg":0.008921330089213302},{"readMsMax":"0","computeMsMax":"4932","inputStages":["9","1","8"],"waitMsAvg":"1","id":"10","endMs":"1570993777100","waitMsMax":"4","startMs":"1570993772636","waitRatioMax":0.0008110300081103001,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"775321154","computeRatioAvg":0.759529602595296,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"69","computeMsAvg":"3746","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013990267639902677,"readMsAvg":"0","waitRatioAvg":0.00020275750202757503,"completedParallelInputs":"100","computeRatioMax":1,"name":"S0A: Join+","shuffleOutputBytes":"18320","recordsWritten":"876","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$200, $201, $202, $203","FROM __stage08_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage01_output"]},{"kind":"READ","substeps":["$1","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $170, $231 := $150","$140 := SUM($152)","$141 := SUM($151)"]},{"kind":"COMPUTE","substeps":["$150 := if(equal($170, 1), $220, NULL)","$151 := if(equal($170, 0), $222, NULL)","$152 := if(equal($170, 0), $221, NULL)"]},{"kind":"COMPUTE","substeps":["$160 := ARRAY<...>"]},{"kind":"JOIN","substeps":["ANTI HASH JOIN EACH WITH ALL ON $211 = $1"]},{"kind":"JOIN","substeps":["SEMI HASH JOIN EACH WITH EACH ON $201 = $11"]},{"kind":"WRITE","substeps":["$140, $141, $231, $230","TO __stage0A_output","BY HASH($230, $231)"]}],"writeRatioAvg":0.0016220600162206002},{"readMsMax":"0","computeMsMax":"8","inputStages":["10"],"waitMsAvg":"5","id":"11","endMs":"1570993777348","waitMsMax":"5","startMs":"1570993777134","waitRatioMax":0.001013787510137875,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"876","computeRatioAvg":0.001013787510137875,"writeMsAvg":"158","status":"COMPLETE","writeMsMax":"192","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.038929440389294405,"readMsAvg":"0","waitRatioAvg":0.001013787510137875,"completedParallelInputs":"18","computeRatioMax":0.0016220600162206002,"name":"S0B: Aggregate+","shuffleOutputBytes":"396","recordsWritten":"19","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$140, $141, $231, $230","FROM __stage0A_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $250 := $240","$110 := COUNT($122)","$111 := ANY_VALUE($121)","$112 := ANY_VALUE($120)"]},{"kind":"COMPUTE","substeps":["$120 := if(equal($240, 0), $131, NULL)","$121 := if(equal($240, 0), $130, NULL)","$122 := if(equal($240, 1), $241, NULL)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230, $241 := $231","$130 := SUM($140)","$131 := SUM($141)"]},{"kind":"WRITE","substeps":["$110, $111, $112, $250","TO __stage0B_output","BY HASH($250)"]}],"writeRatioAvg":0.03203568532035685},{"readMsMax":"0","computeMsMax":"5","inputStages":["11"],"waitMsAvg":"1","id":"12","endMs":"1570993777404","waitMsMax":"1","startMs":"1570993777351","waitRatioMax":0.00020275750202757503,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"19","computeRatioAvg":0.001013787510137875,"writeMsAvg":"30","status":"COMPLETE","writeMsMax":"30","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006082725060827251,"readMsAvg":"0","waitRatioAvg":0.00020275750202757503,"completedParallelInputs":"1","computeRatioMax":0.001013787510137875,"name":"S0C: Aggregate+","shuffleOutputBytes":"27","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110, $111, $112, $250","FROM __stage0B_output"]},{"kind":"AGGREGATE","substeps":["$80 := ANY_VALUE($92)","$81 := ANY_VALUE($91)","$82 := ANY_VALUE($90)"]},{"kind":"COMPUTE","substeps":["$90 := if(equal($260, 0), $102, NULL)","$91 := if(equal($260, 0), $101, NULL)","$92 := if(equal($260, 1), $100, NULL)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $260 := $250","$100 := SUM_OF_COUNTS($110)","$101 := ANY_VALUE($111)","$102 := ANY_VALUE($112)"]},{"kind":"WRITE","substeps":["$80, $81, $82","TO __stage0C_output"]}],"writeRatioAvg":0.006082725060827251},{"readMsMax":"0","computeMsMax":"10","inputStages":["12"],"waitMsAvg":"1","id":"13","endMs":"1570993777582","waitMsMax":"1","startMs":"1570993777369","waitRatioMax":0.00020275750202757503,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.00202757502027575,"writeMsAvg":"118","status":"COMPLETE","writeMsMax":"118","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.023925385239253853,"readMsAvg":"0","waitRatioAvg":0.00020275750202757503,"completedParallelInputs":"1","computeRatioMax":0.00202757502027575,"name":"S0D: Output","shuffleOutputBytes":"27","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$80, $81, $82","FROM __stage0C_output"]},{"kind":"SORT","substeps":["$60 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$60 := if(is_null($70), 0, $70)"]},{"kind":"AGGREGATE","substeps":["$70 := ANY_VALUE($80)","$71 := ANY_VALUE($81)","$72 := ANY_VALUE($82)"]},{"kind":"WRITE","substeps":["$270, $271, $272","TO __stage0D_output"]}],"writeRatioAvg":0.023925385239253853}],"estimatedBytesProcessed":"4015575343","timeline":[{"totalSlotMs":"9434","activeUnits":"278","completedUnits":"12","elapsedMs":"967","pendingUnits":"278"},{"totalSlotMs":"162539","activeUnits":"121","completedUnits":"369","elapsedMs":"1985","pendingUnits":"121"},{"totalSlotMs":"245387","activeUnits":"101","completedUnits":"390","elapsedMs":"2526","pendingUnits":"100"},{"totalSlotMs":"615421","activeUnits":"40","completedUnits":"487","elapsedMs":"5708","pendingUnits":"3"},{"totalSlotMs":"621401","activeUnits":"8","completedUnits":"510","elapsedMs":"6852","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"4016046080","totalPartitionsProcessed":"0","totalBytesProcessed":"4015575343","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_returns","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_site","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_100"}]},"endTime":"1570993777810"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query94_1570993768"},"etag":"4WKdILHjhOIln7RzTIQbag==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query94_1570993768?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon58c4617c43d763d9cf40b4eef5f2f3162dbb8119","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query94\nSELECT \n Count(DISTINCT ws_order_number) AS order_count, \n Sum(ws_ext_ship_cost) AS total_shipping_cost , \n Sum(ws_net_profit) AS total_net_profit\nFROM web_sales ws1 , \n date_dim , \n customer_address , \n web_site \nWHERE Cast(d_date AS DATE) BETWEEN Cast('2000-3-01' AS DATE) AND ( \n Cast('2000-5-01' AS DATE)) \nAND ws1.ws_ship_date_sk = d_date_sk \nAND ws1.ws_ship_addr_sk = ca_address_sk \nAND ca_state = 'MT' \nAND ws1.ws_web_site_sk = web_site_sk \nAND web_company_name = 'pri' \nAND EXISTS \n ( \n SELECT benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results scale_2.zip warmup \n FROM web_sales ws2 \n WHERE ws1.ws_order_number = ws2.ws_order_number \n AND ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) \nAND NOT EXISTS \n ( \n SELECT benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results scale_2.zip warmup \n FROM web_returns wr1 \n WHERE ws1.ws_order_number = wr1.wr_order_number) \nORDER BY count(DISTINCT ws_order_number) \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query94_1570993768","user_email":"nithish.sankaranarayanan@ulb.be"}
