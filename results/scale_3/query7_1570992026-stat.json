{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"296857","creationTime":"1570992027624","totalBytesProcessed":"17385134479","startTime":"1570992027821","query":{"totalSlotMs":"296857","queryPlan":[{"readMsMax":"23","computeMsMax":"9","waitMsAvg":"1","id":"0","endMs":"1570992028128","waitMsMax":"1","startMs":"1570992028026","waitRatioMax":6.665333599946678e-05,"readRatioAvg":0.0015330267279877357,"parallelInputs":"1","recordsRead":"1000","computeRatioAvg":0.0005998800239952009,"writeMsAvg":"56","status":"COMPLETE","writeMsMax":"56","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003732586815970139,"readMsAvg":"23","waitRatioAvg":6.665333599946678e-05,"completedParallelInputs":"1","computeRatioMax":0.0005998800239952009,"name":"S00: Input","shuffleOutputBytes":"8982","recordsWritten":"998","readRatioMax":0.0015330267279877357,"steps":[{"kind":"READ","substeps":["$10:p_promo_sk, $11:p_channel_email, $12:p_channel_event","FROM promotion","WHERE or(equal($11, 'N'), equal($12, 'N'))"]},{"kind":"WRITE","substeps":["$10","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.003732586815970139},{"readMsMax":"58","computeMsMax":"159","waitMsAvg":"25","id":"1","endMs":"1570992028410","waitMsMax":"25","startMs":"1570992028066","waitRatioMax":0.0016663333999866693,"readRatioAvg":0.0038658934879690727,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.010597880423915218,"writeMsAvg":"14","status":"COMPLETE","writeMsMax":"14","computeMsAvg":"159","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0009331467039925348,"readMsAvg":"58","waitRatioAvg":0.0016663333999866693,"completedParallelInputs":"1","computeRatioMax":0.010597880423915218,"name":"S01: Input","shuffleOutputBytes":"6120000","recordsWritten":"204000","readRatioMax":0.0038658934879690727,"steps":[{"kind":"READ","substeps":["$1:i_item_sk, $2:i_item_id","FROM item"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage01_output","BY HASH($1)"]}],"writeRatioAvg":0.0009331467039925348},{"readMsMax":"12","computeMsMax":"10","waitMsAvg":"58","id":"2","endMs":"1570992028255","waitMsMax":"58","startMs":"1570992028113","waitRatioMax":0.0038658934879690727,"readRatioAvg":0.0007998400319936012,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0006665333599946677,"writeMsAvg":"76","status":"COMPLETE","writeMsMax":"76","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0050656535359594745,"readMsAvg":"12","waitRatioAvg":0.0038658934879690727,"completedParallelInputs":"1","computeRatioMax":0.0006665333599946677,"name":"S02: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.0007998400319936012,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_year","FROM date_dim","WHERE equal($31, 1998)"]},{"kind":"WRITE","substeps":["$30","TO __stage02_output","BY HASH($30)"]}],"writeRatioAvg":0.0050656535359594745},{"readMsMax":"86","computeMsMax":"41","waitMsAvg":"60","id":"3","endMs":"1570992028313","waitMsMax":"60","startMs":"1570992028128","waitRatioMax":0.003999200159968006,"readRatioAvg":0.005732186895954143,"parallelInputs":"1","recordsRead":"1920800","computeRatioAvg":0.0027327867759781377,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"41","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0015330267279877357,"readMsAvg":"86","waitRatioAvg":0.003999200159968006,"completedParallelInputs":"1","computeRatioMax":0.0027327867759781377,"name":"S03: Input","shuffleOutputBytes":"246960","recordsWritten":"27440","readRatioMax":0.005732186895954143,"steps":[{"kind":"READ","substeps":["$40:cd_demo_sk, $41:cd_gender, $42:cd_marital_status, $43:cd_education_status","FROM customer_demographics","WHERE and(equal($41, 'F'), equal($42, 'W'), equal($43, '2 yr Degree'))"]},{"kind":"WRITE","substeps":["$40","TO __stage03_output","BY HASH($40)"]}],"writeRatioAvg":0.0015330267279877357},{"readMsMax":"0","computeMsMax":"8","inputStages":["3"],"waitMsAvg":"1","id":"5","endMs":"1570992028447","waitMsMax":"2","startMs":"1570992028343","waitRatioMax":0.00013330667199893355,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"27440","computeRatioAvg":0.00033326667999733386,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"57","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003799240151969606,"readMsAvg":"0","waitRatioAvg":6.665333599946678e-05,"completedParallelInputs":"100","computeRatioMax":0.0005332266879957342,"name":"S05: Coalesce","shuffleOutputBytes":"246960","recordsWritten":"27440","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage03_output"]}],"writeRatioAvg":0.0012664133839898686},{"readMsMax":"268","computeMsMax":"1736","inputStages":["0","1","2","5"],"waitMsAvg":"3","id":"7","endMs":"1570992044376","waitMsMax":"5","startMs":"1570992028515","waitRatioMax":0.00033326667999733386,"readRatioAvg":0.004065853495967473,"parallelInputs":"184","recordsRead":"324708675","computeRatioAvg":0.08884889688728921,"writeMsAvg":"90","status":"COMPLETE","writeMsMax":"15003","computeMsAvg":"1333","shuffleOutputBytesSpilled":"0","writeRatioMax":1,"readMsAvg":"61","waitRatioAvg":0.0001999600079984003,"completedParallelInputs":"184","computeRatioMax":0.11571019129507432,"name":"S07: Join+","shuffleOutputBytes":"60968405","recordsWritten":"720356","readRatioMax":0.017863094047857096,"steps":[{"kind":"READ","substeps":["$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_cdemo_sk, $23:ss_promo_sk, $24:ss_quantity, $25:ss_list_price, $26:ss_sales_price, $27:ss_coupon_amt","FROM store_sales"]},{"kind":"READ","substeps":["$40","FROM __stage05_output"]},{"kind":"READ","substeps":["$30","FROM __stage02_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage01_output"]},{"kind":"READ","substeps":["$10","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $140 := $130","$60 := SHARD_AVG($131)","$61 := SHARD_AVG($132)","$62 := SHARD_AVG($134)","$63 := SHARD_AVG($133)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $110 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $100 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $80 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $22 = $40"]},{"kind":"WRITE","substeps":["$140, $60, $61, $62, $63","TO __stage07_output","BY HASH($140)"]}],"writeRatioAvg":0.00599880023995201},{"readMsMax":"0","computeMsMax":"90","inputStages":["7"],"waitMsAvg":"8","id":"8","endMs":"1570992045396","waitMsMax":"10","startMs":"1570992045315","waitRatioMax":0.0006665333599946677,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"720356","computeRatioAvg":0.00433246683996534,"writeMsAvg":"13","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"65","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0013997200559888023,"readMsAvg":"0","waitRatioAvg":0.0005332266879957342,"completedParallelInputs":"18","computeRatioMax":0.00599880023995201,"name":"S08: Sort+","shuffleOutputBytes":"102600","recordsWritten":"1800","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$140, $60, $61, $62, $63","FROM __stage07_output"]},{"kind":"SORT","substeps":["$150 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $150 := $140","$50 := ROOT_AVG($60)","$51 := ROOT_AVG($61)","$52 := ROOT_AVG($62)","$53 := ROOT_AVG($63)"]},{"kind":"WRITE","substeps":["$160, $161, $162, $163, $164","TO __stage08_output"]}],"writeRatioAvg":0.0008664933679930681},{"readMsMax":"0","computeMsMax":"8","inputStages":["8"],"waitMsAvg":"1","id":"9","endMs":"1570992045403","waitMsMax":"1","startMs":"1570992045338","waitRatioMax":6.665333599946678e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1800","computeRatioAvg":0.0005332266879957342,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0003999200159968006,"readMsAvg":"0","waitRatioAvg":6.665333599946678e-05,"completedParallelInputs":"1","computeRatioMax":0.0005332266879957342,"name":"S09: Output","shuffleOutputBytes":"5700","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$160, $161, $162, $163, $164","FROM __stage08_output"]},{"kind":"SORT","substeps":["$160 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$170, $171, $172, $173, $174","TO __stage09_output"]}],"writeRatioAvg":0.0003999200159968006}],"estimatedBytesProcessed":"17385134479","timeline":[{"totalSlotMs":"12655","activeUnits":"184","completedUnits":"104","elapsedMs":"706","pendingUnits":"184"},{"totalSlotMs":"264204","activeUnits":"16","completedUnits":"287","elapsedMs":"2249","pendingUnits":"1"},{"totalSlotMs":"265802","activeUnits":"3","completedUnits":"287","elapsedMs":"3009","pendingUnits":"1"},{"totalSlotMs":"296857","activeUnits":"0","completedUnits":"307","elapsedMs":"17755","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"17385390080","totalPartitionsProcessed":"0","totalBytesProcessed":"17385134479","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer_demographics","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"promotion","datasetId":"scale_100"}]},"endTime":"1570992045605"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query7_1570992026"},"etag":"cOA0d98nWTmXjkZVrF6Fxw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query7_1570992026?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon0573bd3a1a90ca93822eec46d801740a57f335e6","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query7\nSELECT i_item_id, \n Avg(ss_quantity) agg1, \n Avg(ss_list_price) agg2, \n Avg(ss_coupon_amt) agg3, \n Avg(ss_sales_price) agg4 \nFROM store_sales, \n customer_demographics, \n date_dim, \n item, \n promotion \nWHERE ss_sold_date_sk = d_date_sk \n AND ss_item_sk = i_item_sk \n AND ss_cdemo_sk = cd_demo_sk \n AND ss_promo_sk = p_promo_sk \n AND cd_gender = 'F' \n AND cd_marital_status = 'W' \n AND cd_education_status = '2 yr Degree' \n AND ( p_channel_email = 'N' \n OR p_channel_event = 'N' ) \n AND d_year = 1998 \nGROUP BY i_item_id \nORDER BY i_item_id\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query7_1570992026","user_email":"nithish.sankaranarayanan@ulb.be"}
