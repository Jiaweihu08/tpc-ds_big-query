{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"109815","creationTime":"1570992492004","totalBytesProcessed":"10933657540","startTime":"1570992492235","query":{"totalSlotMs":"109815","queryPlan":[{"readMsMax":"39","computeMsMax":"9","waitMsAvg":"3","id":"0","endMs":"1570992492636","waitMsMax":"3","startMs":"1570992492525","waitRatioMax":0.004054054054054054,"readRatioAvg":0.052702702702702706,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.012162162162162163,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02702702702702703,"readMsAvg":"39","waitRatioAvg":0.004054054054054054,"completedParallelInputs":"1","computeRatioMax":0.012162162162162163,"name":"S00: Input","shuffleOutputBytes":"4680","recordsWritten":"520","readRatioMax":0.052702702702702706,"steps":[{"kind":"READ","substeps":["$10:hd_demo_sk, $11:hd_buy_potential, $12:hd_dep_count, $13:hd_vehicle_count","FROM household_demographics","WHERE and(or(equal($11, '>10000'), equal($11, 'unknown')), greater($13, 0), ...)"]},{"kind":"WRITE","substeps":["$10","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.02702702702702703},{"readMsMax":"68","computeMsMax":"10","waitMsAvg":"2","id":"1","endMs":"1570992492676","waitMsMax":"2","startMs":"1570992492576","waitRatioMax":0.002702702702702703,"readRatioAvg":0.0918918918918919,"parallelInputs":"1","recordsRead":"402","computeRatioAvg":0.013513513513513514,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"12","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.016216216216216217,"readMsAvg":"68","waitRatioAvg":0.002702702702702703,"completedParallelInputs":"1","computeRatioMax":0.013513513513513514,"name":"S01: Input","shuffleOutputBytes":"387","recordsWritten":"43","readRatioMax":0.0918918918918919,"steps":[{"kind":"READ","substeps":["$30:s_store_sk, $31:s_county","FROM store","WHERE in($31, 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', ...)"]},{"kind":"WRITE","substeps":["$30","TO __stage01_output","BY HASH($30)"]}],"writeRatioAvg":0.016216216216216217},{"readMsMax":"12","computeMsMax":"10","waitMsAvg":"15","id":"2","endMs":"1570992492774","waitMsMax":"15","startMs":"1570992492615","waitRatioMax":0.02027027027027027,"readRatioAvg":0.016216216216216217,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.013513513513513514,"writeMsAvg":"133","status":"COMPLETE","writeMsMax":"133","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.17972972972972973,"readMsAvg":"12","waitRatioAvg":0.02027027027027027,"completedParallelInputs":"1","computeRatioMax":0.013513513513513514,"name":"S02: Input","shuffleOutputBytes":"2268","recordsWritten":"252","readRatioMax":0.016216216216216217,"steps":[{"kind":"READ","substeps":["$40:d_date_sk, $41:d_year, $42:d_dom","FROM date_dim","WHERE and(or(between($42, 1, 3), between($42, 25, 28)), in($41, 1999, 2000, 2001))"]},{"kind":"WRITE","substeps":["$40","TO __stage02_output","BY HASH($40)"]}],"writeRatioAvg":0.17972972972972973},{"readMsMax":"133","computeMsMax":"588","inputStages":["0","1","2"],"waitMsAvg":"3","id":"4","endMs":"1570992493526","waitMsMax":"9","startMs":"1570992492816","waitRatioMax":0.012162162162162163,"readRatioAvg":0.043243243243243246,"parallelInputs":"184","recordsRead":"282022883","computeRatioAvg":0.6229729729729729,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"111","computeMsAvg":"461","shuffleOutputBytesSpilled":"0","writeRatioMax":0.15,"readMsAvg":"32","waitRatioAvg":0.004054054054054054,"completedParallelInputs":"184","computeRatioMax":0.7945945945945946,"name":"S04: Join+","shuffleOutputBytes":"589875","recordsWritten":"22241","readRatioMax":0.17972972972972973,"steps":[{"kind":"READ","substeps":["$20:ss_sold_date_sk, $21:ss_customer_sk, $22:ss_hdemo_sk, $23:ss_store_sk, $24:ss_ticket_number","FROM store_sales"]},{"kind":"READ","substeps":["$40","FROM __stage02_output"]},{"kind":"READ","substeps":["$30","FROM __stage01_output"]},{"kind":"READ","substeps":["$10","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $100 := $91, $101 := $90","$60 := COUNT_STAR()"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $81 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $72 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $40"]},{"kind":"WRITE","substeps":["$101, $100, $60","TO __stage04_output","BY HASH($100, $101)"]}],"writeRatioAvg":0.00945945945945946},{"readMsMax":"0","computeMsMax":"13","inputStages":["4"],"waitMsAvg":"1","id":"6","endMs":"1570992493896","waitMsMax":"2","startMs":"1570992493664","waitRatioMax":0.002702702702702703,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"22241","computeRatioAvg":0.010810810810810811,"writeMsAvg":"163","status":"COMPLETE","writeMsMax":"197","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.2662162162162162,"readMsAvg":"0","waitRatioAvg":0.0013513513513513514,"completedParallelInputs":"18","computeRatioMax":0.01756756756756757,"name":"S06: Aggregate+","shuffleOutputBytes":"55188","recordsWritten":"2044","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$101, $100, $60","FROM __stage04_output"]},{"kind":"FILTER","substeps":["between($50, 15, 20)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $110 := $100, $111 := $101","$50 := SUM_OF_COUNTS($60)"]},{"kind":"WRITE","substeps":["$50, $110, $111","TO __stage06_output","BY HASH($111)"]}],"writeRatioAvg":0.22027027027027027},{"readMsMax":"0","computeMsMax":"10","inputStages":["6"],"waitMsAvg":"1","id":"7","endMs":"1570992494376","waitMsMax":"4","startMs":"1570992494113","waitRatioMax":0.005405405405405406,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2044","computeRatioAvg":0.006756756756756757,"writeMsAvg":"50","status":"COMPLETE","writeMsMax":"66","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0891891891891892,"readMsAvg":"0","waitRatioAvg":0.0013513513513513514,"completedParallelInputs":"100","computeRatioMax":0.013513513513513514,"name":"S07: Coalesce","shuffleOutputBytes":"55188","recordsWritten":"2044","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage06_output"]}],"writeRatioAvg":0.06756756756756757},{"readMsMax":"46","computeMsMax":"740","inputStages":["7"],"waitMsAvg":"3","id":"8","endMs":"1570992494893","waitMsMax":"3","startMs":"1570992494139","waitRatioMax":0.004054054054054054,"readRatioAvg":0.062162162162162166,"parallelInputs":"1","recordsRead":"2002044","computeRatioAvg":1,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"740","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006756756756756757,"readMsAvg":"46","waitRatioAvg":0.004054054054054054,"completedParallelInputs":"1","computeRatioMax":1,"name":"S08: Join","shuffleOutputBytes":"108370","recordsWritten":"2044","readRatioMax":0.062162162162162166,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_salutation, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag","FROM customer"]},{"kind":"READ","substeps":["$50, $110, $111","FROM __stage07_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $111"]},{"kind":"WRITE","substeps":["$122, $123, $124, $125, $120, $121","TO __stage08_output"]}],"writeRatioAvg":0.006756756756756757},{"readMsMax":"0","computeMsMax":"9","inputStages":["8"],"waitMsAvg":"1","id":"9","endMs":"1570992495208","waitMsMax":"1","startMs":"1570992495012","waitRatioMax":0.0013513513513513514,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2044","computeRatioAvg":0.012162162162162163,"writeMsAvg":"180","status":"COMPLETE","writeMsMax":"180","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.24324324324324326,"readMsAvg":"0","waitRatioAvg":0.0013513513513513514,"completedParallelInputs":"1","computeRatioMax":0.012162162162162163,"name":"S09: Output","shuffleOutputBytes":"108370","recordsWritten":"2044","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$122, $123, $124, $125, $120, $121","FROM __stage08_output"]},{"kind":"SORT","substeps":["$124 ASC, $123 ASC, $122 ASC, $125 DESC"]},{"kind":"WRITE","substeps":["$130, $131, $132, $133, $134, $135","TO __stage09_output"]}],"writeRatioAvg":0.24324324324324326}],"estimatedBytesProcessed":"10933657540","timeline":[{"totalSlotMs":"10887","activeUnits":"184","completedUnits":"3","elapsedMs":"791","pendingUnits":"184"},{"totalSlotMs":"91926","activeUnits":"1","completedUnits":"205","elapsedMs":"1855","pendingUnits":"1"},{"totalSlotMs":"109815","activeUnits":"1","completedUnits":"307","elapsedMs":"3303","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"10934550528","totalPartitionsProcessed":"0","totalBytesProcessed":"10933657540","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_100"}]},"endTime":"1570992495583"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query34_1570992489"},"etag":"/ffiqPL31MI5xUujcA0wRg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query34_1570992489?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon6a74013a5fbb7595dae16adb418906fde5a58e00","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query34\nSELECT c_last_name, \n c_first_name, \n c_salutation, \n c_preferred_cust_flag, \n ss_ticket_number, \n cnt \nFROM (SELECT ss_ticket_number, \n ss_customer_sk, \n Count(*) cnt \n FROM store_sales, \n date_dim, \n store, \n household_demographics \n WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk \n AND store_sales.ss_store_sk = store.s_store_sk \n AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk \n AND ( date_dim.d_dom BETWEEN 1 AND 3 \n OR date_dim.d_dom BETWEEN 25 AND 28 ) \n AND ( household_demographics.hd_buy_potential = '>10000' \n OR household_demographics.hd_buy_potential = 'unknown' ) \n AND household_demographics.hd_vehicle_count > 0 \n AND ( CASE \n WHEN household_demographics.hd_vehicle_count > 0 THEN \n household_demographics.hd_dep_count / \n household_demographics.hd_vehicle_count \n ELSE NULL \n END ) > 1.2 \n AND date_dim.d_year IN ( 1999, 1999 + 1, 1999 + 2 ) \n AND store.s_county IN ( 'Williamson County', 'Williamson County', \n 'Williamson County', \n 'Williamson County' \n , \n 'Williamson County', 'Williamson County', \n 'Williamson County', \n 'Williamson County' \n ) \n GROUP BY ss_ticket_number, \n ss_customer_sk) dn, \n customer \nWHERE ss_customer_sk = c_customer_sk \n AND cnt BETWEEN 15 AND 20 \nORDER BY c_last_name, \n c_first_name, \n c_salutation, \n c_preferred_cust_flag DESC; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query34_1570992489","user_email":"nithish.sankaranarayanan@ulb.be"}
