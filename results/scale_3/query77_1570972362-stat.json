{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"68951","creationTime":"1570972364333","totalBytesProcessed":"1727294172","startTime":"1570972364621","query":{"totalSlotMs":"68951","queryPlan":[{"readMsMax":"22","computeMsMax":"5","waitMsAvg":"1","id":"0","endMs":"1570972364947","waitMsMax":"1","startMs":"1570972364893","waitRatioMax":0.00078003120124805,"readRatioAvg":0.0171606864274571,"parallelInputs":"1","recordsRead":"200","computeRatioAvg":0.0039001560062402497,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0062402496099844,"readMsAvg":"22","waitRatioAvg":0.00078003120124805,"completedParallelInputs":"1","computeRatioMax":0.0039001560062402497,"name":"S00: Input","shuffleOutputBytes":"1800","recordsWritten":"200","readRatioMax":0.0171606864274571,"steps":[{"kind":"READ","substeps":["$50:wp_web_page_sk","FROM web_page"]},{"kind":"WRITE","substeps":["$50","TO __stage00_output","BY HASH($50)"]}],"writeRatioAvg":0.0062402496099844},{"readMsMax":"10","computeMsMax":"15","waitMsAvg":"27","id":"1","endMs":"1570972365116","waitMsMax":"27","startMs":"1570972364937","waitRatioMax":0.02106084243369735,"readRatioAvg":0.0078003120124804995,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.01170046801872075,"writeMsAvg":"155","status":"COMPLETE","writeMsMax":"155","computeMsAvg":"15","shuffleOutputBytesSpilled":"0","writeRatioMax":0.12090483619344773,"readMsAvg":"10","waitRatioAvg":0.02106084243369735,"completedParallelInputs":"1","computeRatioMax":0.01170046801872075,"name":"S01: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.0078003120124804995,"steps":[{"kind":"READ","substeps":["$150:d_date_sk, $151:d_date","FROM date_dim","WHERE between(CAST($151 AS DATE), 11550, 11580)"]},{"kind":"WRITE","substeps":["$150","TO __stage01_output","BY HASH($150)"]}],"writeRatioAvg":0.12090483619344773},{"readMsMax":"10","computeMsMax":"6","waitMsAvg":"1","id":"3","endMs":"1570972365075","waitMsMax":"1","startMs":"1570972365024","waitRatioMax":0.00078003120124805,"readRatioAvg":0.0078003120124804995,"parallelInputs":"1","recordsRead":"200","computeRatioAvg":0.0046801872074883,"writeMsAvg":"13","status":"COMPLETE","writeMsMax":"13","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01014040561622465,"readMsAvg":"10","waitRatioAvg":0.00078003120124805,"completedParallelInputs":"1","computeRatioMax":0.0046801872074883,"name":"S03: Input","shuffleOutputBytes":"1800","recordsWritten":"200","readRatioMax":0.0078003120124804995,"steps":[{"kind":"READ","substeps":["$40:wp_web_page_sk","FROM web_page"]},{"kind":"WRITE","substeps":["$40","TO __stage03_output","BY HASH($40)"]}],"writeRatioAvg":0.01014040561622465},{"readMsMax":"14","computeMsMax":"18","waitMsAvg":"1","id":"4","endMs":"1570972365110","waitMsMax":"1","startMs":"1570972365059","waitRatioMax":0.00078003120124805,"readRatioAvg":0.0109204368174727,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.014040561622464899,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0046801872074883,"readMsAvg":"14","waitRatioAvg":0.00078003120124805,"completedParallelInputs":"1","computeRatioMax":0.014040561622464899,"name":"S04: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.0109204368174727,"steps":[{"kind":"READ","substeps":["$140:d_date_sk, $141:d_date","FROM date_dim","WHERE between(CAST($141 AS DATE), 11550, 11580)"]},{"kind":"WRITE","substeps":["$140","TO __stage04_output","BY HASH($140)"]}],"writeRatioAvg":0.0046801872074883},{"readMsMax":"25","computeMsMax":"16","waitMsAvg":"1","id":"6","endMs":"1570972365305","waitMsMax":"1","startMs":"1570972365095","waitRatioMax":0.00078003120124805,"readRatioAvg":0.01950078003120125,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0124804992199688,"writeMsAvg":"170","status":"COMPLETE","writeMsMax":"170","computeMsAvg":"16","shuffleOutputBytesSpilled":"0","writeRatioMax":0.13260530421216848,"readMsAvg":"25","waitRatioAvg":0.00078003120124805,"completedParallelInputs":"1","computeRatioMax":0.0124804992199688,"name":"S06: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.01950078003120125,"steps":[{"kind":"READ","substeps":["$90:d_date_sk, $91:d_date","FROM date_dim","WHERE between(CAST($91 AS DATE), 11550, 11580)"]},{"kind":"WRITE","substeps":["$90","TO __stage06_output","BY HASH($90)"]}],"writeRatioAvg":0.13260530421216848},{"readMsMax":"20","computeMsMax":"20","waitMsAvg":"1","id":"8","endMs":"1570972365254","waitMsMax":"1","startMs":"1570972365204","waitRatioMax":0.00078003120124805,"readRatioAvg":0.015600624024960999,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.015600624024960999,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"20","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0062402496099844,"readMsAvg":"20","waitRatioAvg":0.00078003120124805,"completedParallelInputs":"1","computeRatioMax":0.015600624024960999,"name":"S08: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.015600624024960999,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_date","FROM date_dim","WHERE between(CAST($81 AS DATE), 11550, 11580)"]},{"kind":"WRITE","substeps":["$80","TO __stage08_output","BY HASH($80)"]}],"writeRatioAvg":0.0062402496099844},{"readMsMax":"19","computeMsMax":"6","waitMsAvg":"1","id":"10","endMs":"1570972365288","waitMsMax":"1","startMs":"1570972365239","waitRatioMax":0.00078003120124805,"readRatioAvg":0.014820592823712949,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.0046801872074883,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0046801872074883,"readMsAvg":"19","waitRatioAvg":0.00078003120124805,"completedParallelInputs":"1","computeRatioMax":0.0046801872074883,"name":"S0A: Input","shuffleOutputBytes":"918","recordsWritten":"102","readRatioMax":0.014820592823712949,"steps":[{"kind":"READ","substeps":["$10:s_store_sk","FROM store"]},{"kind":"WRITE","substeps":["$10","TO __stage0A_output","BY HASH($10)"]}],"writeRatioAvg":0.0046801872074883},{"readMsMax":"9","computeMsMax":"19","waitMsAvg":"2","id":"11","endMs":"1570972365419","waitMsMax":"2","startMs":"1570972365258","waitRatioMax":0.0015600624024961,"readRatioAvg":0.0070202808112324495,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.014820592823712949,"writeMsAvg":"87","status":"COMPLETE","writeMsMax":"87","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.06786271450858035,"readMsAvg":"9","waitRatioAvg":0.0015600624024961,"completedParallelInputs":"1","computeRatioMax":0.014820592823712949,"name":"S0B: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.0070202808112324495,"steps":[{"kind":"READ","substeps":["$130:d_date_sk, $131:d_date","FROM date_dim","WHERE between(CAST($131 AS DATE), 11550, 11580)"]},{"kind":"WRITE","substeps":["$130","TO __stage0B_output","BY HASH($130)"]}],"writeRatioAvg":0.06786271450858035},{"readMsMax":"6","computeMsMax":"6","waitMsAvg":"1","id":"13","endMs":"1570972365493","waitMsMax":"1","startMs":"1570972365370","waitRatioMax":0.00078003120124805,"readRatioAvg":0.0046801872074883,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.0046801872074883,"writeMsAvg":"107","status":"COMPLETE","writeMsMax":"107","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08346333853354135,"readMsAvg":"6","waitRatioAvg":0.00078003120124805,"completedParallelInputs":"1","computeRatioMax":0.0046801872074883,"name":"S0D: Input","shuffleOutputBytes":"918","recordsWritten":"102","readRatioMax":0.0046801872074883,"steps":[{"kind":"READ","substeps":["$1:s_store_sk","FROM store"]},{"kind":"WRITE","substeps":["$1","TO __stage0D_output","BY HASH($1)"]}],"writeRatioAvg":0.08346333853354135},{"readMsMax":"9","computeMsMax":"22","waitMsAvg":"1","id":"14","endMs":"1570972365681","waitMsMax":"1","startMs":"1570972365463","waitRatioMax":0.00078003120124805,"readRatioAvg":0.0070202808112324495,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0171606864274571,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"22","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0171606864274571,"readMsAvg":"9","waitRatioAvg":0.00078003120124805,"completedParallelInputs":"1","computeRatioMax":0.0171606864274571,"name":"S0E: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.0070202808112324495,"steps":[{"kind":"READ","substeps":["$120:d_date_sk, $121:d_date","FROM date_dim","WHERE between(CAST($121 AS DATE), 11550, 11580)"]},{"kind":"WRITE","substeps":["$120","TO __stage0E_output","BY HASH($120)"]}],"writeRatioAvg":0.0171606864274571},{"readMsMax":"35","computeMsMax":"593","inputStages":["3","4"],"waitMsAvg":"1","id":"16","endMs":"1570972367290","waitMsMax":"1","startMs":"1570972365597","waitRatioMax":0.00078003120124805,"readRatioAvg":0.0234009360374415,"parallelInputs":"4","recordsRead":"7201954","computeRatioAvg":0.421996879875195,"writeMsAvg":"803","status":"COMPLETE","writeMsMax":"1282","computeMsAvg":"541","shuffleOutputBytesSpilled":"0","writeRatioMax":1,"readMsAvg":"30","waitRatioAvg":0.00078003120124805,"completedParallelInputs":"4","computeRatioMax":0.4625585023400936,"name":"S10: Join+","shuffleOutputBytes":"10908","recordsWritten":"404","readRatioMax":0.027301092043681748,"steps":[{"kind":"READ","substeps":["$100:ws_sold_date_sk, $101:ws_web_page_sk, $102:ws_ext_sales_price, $103:ws_net_profit","FROM web_sales"]},{"kind":"READ","substeps":["$140","FROM __stage04_output"]},{"kind":"READ","substeps":["$40","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $520 := $512","$320 := SUM($510)","$321 := SUM($511)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $500 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $100 = $140"]},{"kind":"WRITE","substeps":["$520, $320, $321","TO __stage10_output","BY HASH($520)"]}],"writeRatioAvg":0.6263650546021841},{"readMsMax":"34","computeMsMax":"316","inputStages":["0","1"],"waitMsAvg":"1","id":"17","endMs":"1570972365837","waitMsMax":"1","startMs":"1570972365623","waitRatioMax":0.00078003120124805,"readRatioAvg":0.0265210608424337,"parallelInputs":"1","recordsRead":"720433","computeRatioAvg":0.24648985959438377,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"316","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0046801872074883,"readMsAvg":"34","waitRatioAvg":0.00078003120124805,"completedParallelInputs":"1","computeRatioMax":0.24648985959438377,"name":"S11: Join+","shuffleOutputBytes":"3618","recordsWritten":"134","readRatioMax":0.0265210608424337,"steps":[{"kind":"READ","substeps":["$110:wr_returned_date_sk, $111:wr_web_page_sk, $112:wr_return_amt, $113:wr_net_loss","FROM web_returns"]},{"kind":"READ","substeps":["$150","FROM __stage01_output"]},{"kind":"READ","substeps":["$50","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $560 := $552","$330 := SUM($550)","$331 := SUM($551)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $540 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $110 = $150"]},{"kind":"WRITE","substeps":["$560, $330, $331","TO __stage11_output","BY HASH($560)"]}],"writeRatioAvg":0.0046801872074883},{"readMsMax":"47","computeMsMax":"648","inputStages":["8"],"waitMsAvg":"1","id":"18","endMs":"1570972366129","waitMsMax":"1","startMs":"1570972365704","waitRatioMax":0.00078003120124805,"readRatioAvg":0.027301092043681748,"parallelInputs":"8","recordsRead":"14397571","computeRatioAvg":0.4118564742589704,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"528","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0078003120124804995,"readMsAvg":"35","waitRatioAvg":0.00078003120124805,"completedParallelInputs":"8","computeRatioMax":0.5054602184087363,"name":"S12: Join+","shuffleOutputBytes":"2744","recordsWritten":"104","readRatioMax":0.036661466458658344,"steps":[{"kind":"READ","substeps":["$20:cs_sold_date_sk, $21:cs_call_center_sk, $22:cs_ext_sales_price, $23:cs_net_profit","FROM catalog_sales"]},{"kind":"READ","substeps":["$80","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $440 := $430","$300 := SUM($431)","$301 := SUM($432)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $80"]},{"kind":"WRITE","substeps":["$440, $300, $301","TO __stage12_output","BY HASH($440)"]}],"writeRatioAvg":0.00546021840873635},{"readMsMax":"39","computeMsMax":"539","inputStages":["6"],"waitMsAvg":"1","id":"19","endMs":"1570972366184","waitMsMax":"1","startMs":"1570972365830","waitRatioMax":0.00078003120124805,"readRatioAvg":0.030421216848673948,"parallelInputs":"1","recordsRead":"1439833","computeRatioAvg":0.4204368174726989,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"539","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00546021840873635,"readMsAvg":"39","waitRatioAvg":0.00078003120124805,"completedParallelInputs":"1","computeRatioMax":0.4204368174726989,"name":"S13: Join+","shuffleOutputBytes":"451","recordsWritten":"17","readRatioMax":0.030421216848673948,"steps":[{"kind":"READ","substeps":["$30:cr_returned_date_sk, $31:cr_call_center_sk, $32:cr_return_amount, $33:cr_net_loss","FROM catalog_returns"]},{"kind":"READ","substeps":["$90","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $470 := $460","$310 := SUM($461)","$311 := SUM($462)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $30 = $90"]},{"kind":"WRITE","substeps":["$470, $310, $311","TO __stage13_output","BY HASH($470)"]}],"writeRatioAvg":0.00546021840873635},{"readMsMax":"24","computeMsMax":"1048","inputStages":["10","11"],"waitMsAvg":"1","id":"20","endMs":"1570972366435","waitMsMax":"1","startMs":"1570972365863","waitRatioMax":0.00078003120124805,"readRatioAvg":0.0187207488299532,"parallelInputs":"1","recordsRead":"2878463","computeRatioAvg":0.8174726989079563,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"1048","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0046801872074883,"readMsAvg":"24","waitRatioAvg":0.00078003120124805,"completedParallelInputs":"1","computeRatioMax":0.8174726989079563,"name":"S14: Join+","shuffleOutputBytes":"1377","recordsWritten":"51","readRatioMax":0.0187207488299532,"steps":[{"kind":"READ","substeps":["$70:sr_returned_date_sk, $71:sr_store_sk, $72:sr_return_amt, $73:sr_net_loss","FROM store_returns"]},{"kind":"READ","substeps":["$130","FROM __stage0B_output"]},{"kind":"READ","substeps":["$10","FROM __stage0A_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $400 := $392","$290 := SUM($390)","$291 := SUM($391)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $380 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $70 = $130"]},{"kind":"WRITE","substeps":["$400, $290, $291","TO __stage14_output","BY HASH($400)"]}],"writeRatioAvg":0.0046801872074883},{"readMsMax":"69","computeMsMax":"863","inputStages":["13","14"],"waitMsAvg":"1","id":"21","endMs":"1570972366479","waitMsMax":"1","startMs":"1570972365959","waitRatioMax":0.00078003120124805,"readRatioAvg":0.02574102964118565,"parallelInputs":"10","recordsRead":"28803442","computeRatioAvg":0.5834633385335414,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"748","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00546021840873635,"readMsAvg":"33","waitRatioAvg":0.00078003120124805,"completedParallelInputs":"10","computeRatioMax":0.6731669266770671,"name":"S15: Join+","shuffleOutputBytes":"13770","recordsWritten":"510","readRatioMax":0.05382215288611544,"steps":[{"kind":"READ","substeps":["$60:ss_sold_date_sk, $61:ss_store_sk, $62:ss_ext_sales_price, $63:ss_net_profit","FROM store_sales"]},{"kind":"READ","substeps":["$120","FROM __stage0E_output"]},{"kind":"READ","substeps":["$1","FROM __stage0D_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $360 := $352","$280 := SUM($350)","$281 := SUM($351)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $340 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $60 = $120"]},{"kind":"WRITE","substeps":["$360, $280, $281","TO __stage15_output","BY HASH($360)"]}],"writeRatioAvg":0.0046801872074883},{"readMsMax":"0","computeMsMax":"7","inputStages":["17"],"waitMsAvg":"1","id":"22","endMs":"1570972367366","waitMsMax":"1","startMs":"1570972367312","waitRatioMax":0.00078003120124805,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"134","computeRatioAvg":0.00546021840873635,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02106084243369735,"readMsAvg":"0","waitRatioAvg":0.00078003120124805,"completedParallelInputs":"1","computeRatioMax":0.00546021840873635,"name":"S16: Aggregate","shuffleOutputBytes":"3618","recordsWritten":"134","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$560, $330, $331","FROM __stage11_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $570 := $560","$270 := SUM($330)","$271 := SUM($331)"]},{"kind":"WRITE","substeps":["$270, $271, $570","TO __stage16_output","BY HASH($570)"]}],"writeRatioAvg":0.02106084243369735},{"readMsMax":"0","computeMsMax":"7","inputStages":["19"],"waitMsAvg":"1","id":"23","endMs":"1570972367398","waitMsMax":"1","startMs":"1570972367328","waitRatioMax":0.00078003120124805,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"17","computeRatioAvg":0.00546021840873635,"writeMsAvg":"14","status":"COMPLETE","writeMsMax":"14","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0109204368174727,"readMsAvg":"0","waitRatioAvg":0.00078003120124805,"completedParallelInputs":"1","computeRatioMax":0.00546021840873635,"name":"S17: Aggregate","shuffleOutputBytes":"306","recordsWritten":"17","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$470, $310, $311","FROM __stage13_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $480 := $470","$250 := SUM($310)","$251 := SUM($311)"]},{"kind":"WRITE","substeps":["$250, $251","TO __stage17_output"]}],"writeRatioAvg":0.0109204368174727},{"readMsMax":"0","computeMsMax":"9","inputStages":["18"],"waitMsAvg":"2","id":"24","endMs":"1570972367422","waitMsMax":"2","startMs":"1570972367345","waitRatioMax":0.0015600624024961,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"104","computeRatioAvg":0.0070202808112324495,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0070202808112324495,"readMsAvg":"0","waitRatioAvg":0.0015600624024961,"completedParallelInputs":"1","computeRatioMax":0.0070202808112324495,"name":"S18: Aggregate","shuffleOutputBytes":"343","recordsWritten":"13","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$440, $300, $301","FROM __stage12_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $450 := $440","$240 := SUM($300)","$241 := SUM($301)"]},{"kind":"WRITE","substeps":["$240, $241, $450","TO __stage18_output"]}],"writeRatioAvg":0.0070202808112324495},{"readMsMax":"0","computeMsMax":"7","inputStages":["20"],"waitMsAvg":"1","id":"25","endMs":"1570972367451","waitMsMax":"1","startMs":"1570972367360","waitRatioMax":0.00078003120124805,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"51","computeRatioAvg":0.00546021840873635,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02106084243369735,"readMsAvg":"0","waitRatioAvg":0.00078003120124805,"completedParallelInputs":"1","computeRatioMax":0.00546021840873635,"name":"S19: Aggregate","shuffleOutputBytes":"1377","recordsWritten":"51","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$400, $290, $291","FROM __stage14_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $410 := $400","$230 := SUM($290)","$231 := SUM($291)"]},{"kind":"WRITE","substeps":["$230, $231, $410","TO __stage19_output","BY HASH($410)"]}],"writeRatioAvg":0.02106084243369735},{"readMsMax":"0","computeMsMax":"8","inputStages":["22"],"waitMsAvg":"1","id":"26","endMs":"1570972367496","waitMsMax":"3","startMs":"1570972367369","waitRatioMax":0.00234009360374415,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"134","computeRatioAvg":0.0039001560062402497,"writeMsAvg":"31","status":"COMPLETE","writeMsMax":"113","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08814352574102964,"readMsAvg":"0","waitRatioAvg":0.00078003120124805,"completedParallelInputs":"100","computeRatioMax":0.0062402496099844,"name":"S1A: Coalesce","shuffleOutputBytes":"3618","recordsWritten":"134","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage16_output"]}],"writeRatioAvg":0.02418096723868955},{"readMsMax":"0","computeMsMax":"6","inputStages":["24"],"waitMsAvg":"1","id":"27","endMs":"1570972367653","waitMsMax":"2","startMs":"1570972367439","waitRatioMax":0.0015600624024961,"readRatioAvg":0,"parallelInputs":"40","recordsRead":"13","computeRatioAvg":0.00234009360374415,"writeMsAvg":"171","status":"COMPLETE","writeMsMax":"197","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.15366614664586584,"readMsAvg":"0","waitRatioAvg":0.00078003120124805,"completedParallelInputs":"40","computeRatioMax":0.0046801872074883,"name":"S1B: Coalesce","shuffleOutputBytes":"343","recordsWritten":"13","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage18_output"]}],"writeRatioAvg":0.13338533541341654},{"readMsMax":"0","computeMsMax":"12","inputStages":["25"],"waitMsAvg":"2","id":"28","endMs":"1570972367741","waitMsMax":"5","startMs":"1570972367470","waitRatioMax":0.0039001560062402497,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"51","computeRatioAvg":0.0031201248049922,"writeMsAvg":"167","status":"COMPLETE","writeMsMax":"209","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.16302652106084242,"readMsAvg":"0","waitRatioAvg":0.0015600624024961,"completedParallelInputs":"100","computeRatioMax":0.0093603744149766,"name":"S1C: Coalesce","shuffleOutputBytes":"1377","recordsWritten":"51","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage19_output"]}],"writeRatioAvg":0.13026521060842433},{"readMsMax":"0","computeMsMax":"12","inputStages":["21","16","26","23","27","28"],"waitMsAvg":"2","id":"29","endMs":"1570972367823","waitMsMax":"3","startMs":"1570972367543","waitRatioMax":0.00234009360374415,"readRatioAvg":0,"parallelInputs":"42","recordsRead":"1298","computeRatioAvg":0.0062402496099844,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"52","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0405616224648986,"readMsAvg":"0","waitRatioAvg":0.0015600624024961,"completedParallelInputs":"42","computeRatioMax":0.0093603744149766,"name":"S1D: Join+","shuffleOutputBytes":"18086","recordsWritten":"334","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$360, $280, $281","FROM __stage15_output"]},{"kind":"READ","substeps":["$230, $231, $410","FROM __stage1C_output"]},{"kind":"READ","substeps":["$240, $241, $450","FROM __stage1B_output"]},{"kind":"READ","substeps":["$250, $251","FROM __stage17_output"]},{"kind":"READ","substeps":["$520, $320, $321","FROM __stage10_output"]},{"kind":"READ","substeps":["$270, $271, $570","FROM __stage1A_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $590 := $180, $591 := $181","$170 := SUM($182)","$171 := SUM($183)","$172 := SUM($184)"]},{"kind":"COMPUTE","substeps":["$190 := 'store channel'","$191 := coalesce($423, 0)","$192 := subtract($422, coalesce($424, 0))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $370 = $410"]},{"kind":"AGGREGATE","substeps":["GROUP BY $370 := $360","$220 := SUM($280)","$221 := SUM($281)"]},{"kind":"COMPUTE","substeps":["$200 := 'catalog channel'","$201 := subtract($492, $494)"]},{"kind":"JOIN","substeps":["CROSS EACH WITH EACH "]},{"kind":"COMPUTE","substeps":["$210 := 'web channel'","$211 := coalesce($583, 0)","$212 := subtract($582, coalesce($584, 0))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $530 = $570"]},{"kind":"AGGREGATE","substeps":["GROUP BY $530 := $520","$260 := SUM($320)","$261 := SUM($321)"]},{"kind":"WRITE","substeps":["$170, $171, $172, $590, $591","TO __stage1D_output","BY HASH($590, $591)"]}],"writeRatioAvg":0.01950078003120125},{"readMsMax":"0","computeMsMax":"6","inputStages":["29"],"waitMsAvg":"1","id":"30","endMs":"1570972368086","waitMsMax":"1","startMs":"1570972367836","waitRatioMax":0.00078003120124805,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"334","computeRatioAvg":0.0046801872074883,"writeMsAvg":"66","status":"COMPLETE","writeMsMax":"66","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0514820592823713,"readMsAvg":"0","waitRatioAvg":0.00078003120124805,"completedParallelInputs":"1","computeRatioMax":0.0046801872074883,"name":"S1E: Sort+","shuffleOutputBytes":"5346","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$170, $171, $172, $590, $591","FROM __stage1D_output"]},{"kind":"SORT","substeps":["$600 ASC, $601 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $600 := $590, $601 := $591","$160 := SUM($170)","$161 := SUM($171)","$162 := SUM($172)"]},{"kind":"WRITE","substeps":["$610, $611, $612, $613, $614","TO __stage1E_output"]}],"writeRatioAvg":0.0514820592823713},{"readMsMax":"0","computeMsMax":"6","inputStages":["30"],"waitMsAvg":"1","id":"31","endMs":"1570972368109","waitMsMax":"1","startMs":"1570972367892","waitRatioMax":0.00078003120124805,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0046801872074883,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00546021840873635,"readMsAvg":"0","waitRatioAvg":0.00078003120124805,"completedParallelInputs":"1","computeRatioMax":0.0046801872074883,"name":"S1F: Output","shuffleOutputBytes":"5346","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$610, $611, $612, $613, $614","FROM __stage1E_output"]},{"kind":"SORT","substeps":["$613 ASC, $614 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$620, $621, $622, $623, $624","TO __stage1F_output"]}],"writeRatioAvg":0.00546021840873635}],"estimatedBytesProcessed":"1727294172","timeline":[{"totalSlotMs":"1446","activeUnits":"17","completedUnits":"7","elapsedMs":"776","pendingUnits":"18"},{"totalSlotMs":"22937","activeUnits":"14","completedUnits":"31","elapsedMs":"1844","pendingUnits":"4"},{"totalSlotMs":"36168","activeUnits":"182","completedUnits":"139","elapsedMs":"2950","pendingUnits":"182"},{"totalSlotMs":"68951","activeUnits":"1","completedUnits":"323","elapsedMs":"3709","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"1728053248","totalPartitionsProcessed":"0","totalBytesProcessed":"1727294172","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_page","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_returns","datasetId":"scale_10"}]},"endTime":"1570972368365"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query77_1570972362"},"etag":"HMHyv7UgrrBLG8Uoqvi5vg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query77_1570972362?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonbdea75dbacfd59b81f0020c5b01560e17f4a1fb8","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"\n-- query77\nWITH ss AS \n( \n SELECT s_store_sk, \n Sum(ss_ext_sales_price) AS sales, \n Sum(ss_net_profit) AS profit \n FROM store_sales, \n date_dim, \n store \n WHERE ss_sold_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN Cast('2001-08-16' AS DATE) AND ( \n Cast('2001-09-15' AS DATE)) \n AND ss_store_sk = s_store_sk \n GROUP BY s_store_sk) , sr AS \n( \n SELECT s_store_sk, \n sum(sr_return_amt) AS returns1, \n sum(sr_net_loss) AS profit_loss \n FROM store_returns, \n date_dim, \n store \n WHERE sr_returned_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2001-08-16' AS date) AND ( \n Cast('2001-09-15' AS DATE)) \n AND sr_store_sk = s_store_sk \n GROUP BY s_store_sk), cs AS \n( \n SELECT cs_call_center_sk, \n sum(cs_ext_sales_price) AS sales, \n sum(cs_net_profit) AS profit \n FROM catalog_sales, \n date_dim \n WHERE cs_sold_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2001-08-16' AS date) AND ( \n Cast('2001-09-15' AS DATE)) \n GROUP BY cs_call_center_sk ), cr AS \n( \n SELECT cr_call_center_sk, \n sum(cr_return_amount) AS returns1, \n sum(cr_net_loss) AS profit_loss \n FROM catalog_returns, \n date_dim \n WHERE cr_returned_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2001-08-16' AS date) AND ( \n Cast('2001-09-15' AS DATE)) \n GROUP BY cr_call_center_sk ), ws AS \n( \n SELECT wp_web_page_sk, \n sum(ws_ext_sales_price) AS sales, \n sum(ws_net_profit) AS profit \n FROM web_sales, \n date_dim, \n web_page \n WHERE ws_sold_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2001-08-16' AS date) AND ( \n Cast('2001-09-15' AS DATE)) \n AND ws_web_page_sk = wp_web_page_sk \n GROUP BY wp_web_page_sk), wr AS \n( \n SELECT wp_web_page_sk, \n sum(wr_return_amt) AS returns1, \n sum(wr_net_loss) AS profit_loss \n FROM web_returns, \n date_dim, \n web_page \n WHERE wr_returned_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2001-08-16' AS date) AND ( \n Cast('2001-09-15' AS DATE)) \n AND wr_web_page_sk = wp_web_page_sk \n GROUP BY wp_web_page_sk) \nSELECT\n channel , \n id , \n sum(sales) AS sales , \n sum(returns1) AS returns1 , \n sum(profit) AS profit \nFROM ( \n SELECT 'store channel' AS channel , \n ss.s_store_sk AS id , \n sales , \n COALESCE(returns1, 0) AS returns1 , \n (profit - COALESCE(profit_loss,0)) AS profit \n FROM ss \n LEFT JOIN sr \n ON ss.s_store_sk = sr.s_store_sk \n UNION ALL \n SELECT 'catalog channel' AS channel , \n cs_call_center_sk AS id , \n sales , \n returns1 , \n (profit - profit_loss) AS profit \n FROM cs , \n cr \n UNION ALL \n SELECT 'web channel' AS channel , \n ws.wp_web_page_sk AS id , \n sales , \n COALESCE(returns1, 0) returns1 , \n (profit - COALESCE(profit_loss,0)) AS profit \n FROM ws \n LEFT JOIN wr \n ON ws.wp_web_page_sk = wr.wp_web_page_sk ) x \nGROUP BY channel, id\nORDER BY channel , \n id \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query77_1570972362","user_email":"nithish.sankaranarayanan@ulb.be"}
