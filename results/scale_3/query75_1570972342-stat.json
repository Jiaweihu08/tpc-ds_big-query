{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"724699","creationTime":"1570972343629","totalBytesProcessed":"2147826680","startTime":"1570972343855","query":{"totalSlotMs":"724699","queryPlan":[{"readMsMax":"31","computeMsMax":"1155","waitMsAvg":"1","id":"0","endMs":"1570972345352","waitMsMax":"1","startMs":"1570972344110","waitRatioMax":0.0001923076923076923,"readRatioAvg":0.005961538461538462,"parallelInputs":"1","recordsRead":"720202","computeRatioAvg":0.2221153846153846,"writeMsAvg":"81","status":"COMPLETE","writeMsMax":"81","computeMsAvg":"1155","shuffleOutputBytesSpilled":"0","writeRatioMax":0.015576923076923077,"readMsAvg":"31","waitRatioAvg":0.0001923076923076923,"completedParallelInputs":"1","computeRatioMax":0.2221153846153846,"name":"S00: Input","shuffleOutputBytes":"25408080","recordsWritten":"720202","readRatioMax":0.005961538461538462,"steps":[{"kind":"READ","substeps":["$50:wr_item_sk, $51:wr_order_number, $52:wr_return_quantity, $53:wr_return_amt","FROM web_returns"]},{"kind":"WRITE","substeps":["$50, $51, $52, $53","TO __stage00_output","BY HASH($51, $50)"]}],"writeRatioAvg":0.015576923076923077},{"readMsMax":"14","computeMsMax":"8","waitMsAvg":"21","id":"1","endMs":"1570972344200","waitMsMax":"21","startMs":"1570972344151","waitRatioMax":0.0040384615384615385,"readRatioAvg":0.002692307692307692,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0015384615384615385,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0017307692307692308,"readMsAvg":"14","waitRatioAvg":0.0040384615384615385,"completedParallelInputs":"1","computeRatioMax":0.0015384615384615385,"name":"S01: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.002692307692307692,"steps":[{"kind":"READ","substeps":["$170:d_date_sk, $171:d_year","FROM date_dim","WHERE equal($171, 2001)"]},{"kind":"WRITE","substeps":["$170, $171","TO __stage01_output","BY HASH($170)"]}],"writeRatioAvg":0.0017307692307692308},{"readMsMax":"12","computeMsMax":"18","waitMsAvg":"47","id":"2","endMs":"1570972344241","waitMsMax":"47","startMs":"1570972344194","waitRatioMax":0.009038461538461539,"readRatioAvg":0.002307692307692308,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.0034615384615384616,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001346153846153846,"readMsAvg":"12","waitRatioAvg":0.009038461538461539,"completedParallelInputs":"1","computeRatioMax":0.0034615384615384616,"name":"S02: Input","shuffleOutputBytes":"455797","recordsWritten":"10137","readRatioMax":0.002307692307692308,"steps":[{"kind":"READ","substeps":["$230:i_item_sk, $231:i_brand_id, $232:i_class_id, $233:i_category_id, $235:i_manufact_id, $234:i_category","FROM item","WHERE equal($234, 'Men')"]},{"kind":"WRITE","substeps":["$230, $231, $232, $233, $235","TO __stage02_output","BY HASH($230)"]}],"writeRatioAvg":0.001346153846153846},{"readMsMax":"36","computeMsMax":"4180","waitMsAvg":"53","id":"4","endMs":"1570972346499","waitMsMax":"53","startMs":"1570972344237","waitRatioMax":0.010192307692307691,"readRatioAvg":0.006923076923076923,"parallelInputs":"1","recordsRead":"2878330","computeRatioAvg":0.8038461538461539,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"16","computeMsAvg":"4180","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003076923076923077,"readMsAvg":"36","waitRatioAvg":0.010192307692307691,"completedParallelInputs":"1","computeRatioMax":0.8038461538461539,"name":"S04: Input","shuffleOutputBytes":"102008208","recordsWritten":"2878330","readRatioMax":0.006923076923076923,"steps":[{"kind":"READ","substeps":["$40:sr_item_sk, $41:sr_ticket_number, $42:sr_return_quantity, $43:sr_return_amt","FROM store_returns"]},{"kind":"WRITE","substeps":["$40, $41, $42, $43","TO __stage04_output","BY HASH($41, $40)"]}],"writeRatioAvg":0.003076923076923077},{"readMsMax":"15","computeMsMax":"8","waitMsAvg":"37","id":"5","endMs":"1570972344342","waitMsMax":"37","startMs":"1570972344238","waitRatioMax":0.007115384615384615,"readRatioAvg":0.0028846153846153848,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0015384615384615385,"writeMsAvg":"68","status":"COMPLETE","writeMsMax":"68","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013076923076923076,"readMsAvg":"15","waitRatioAvg":0.007115384615384615,"completedParallelInputs":"1","computeRatioMax":0.0015384615384615385,"name":"S05: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0028846153846153848,"steps":[{"kind":"READ","substeps":["$150:d_date_sk, $151:d_year","FROM date_dim","WHERE equal($151, 2001)"]},{"kind":"WRITE","substeps":["$150, $151","TO __stage05_output","BY HASH($150)"]}],"writeRatioAvg":0.013076923076923076},{"readMsMax":"17","computeMsMax":"20","waitMsAvg":"16","id":"6","endMs":"1570972344459","waitMsMax":"16","startMs":"1570972344238","waitRatioMax":0.003076923076923077,"readRatioAvg":0.003269230769230769,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.0038461538461538464,"writeMsAvg":"186","status":"COMPLETE","writeMsMax":"186","computeMsAvg":"20","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03576923076923077,"readMsAvg":"17","waitRatioAvg":0.003076923076923077,"completedParallelInputs":"1","computeRatioMax":0.0038461538461538464,"name":"S06: Input","shuffleOutputBytes":"455797","recordsWritten":"10137","readRatioMax":0.003269230769230769,"steps":[{"kind":"READ","substeps":["$220:i_item_sk, $221:i_brand_id, $222:i_class_id, $223:i_category_id, $225:i_manufact_id, $224:i_category","FROM item","WHERE equal($224, 'Men')"]},{"kind":"WRITE","substeps":["$220, $221, $222, $223, $225","TO __stage06_output","BY HASH($220)"]}],"writeRatioAvg":0.03576923076923077},{"readMsMax":"31","computeMsMax":"2158","waitMsAvg":"1","id":"8","endMs":"1570972345368","waitMsMax":"1","startMs":"1570972344256","waitRatioMax":0.0001923076923076923,"readRatioAvg":0.005961538461538462,"parallelInputs":"1","recordsRead":"1439802","computeRatioAvg":0.415,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"2158","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004615384615384616,"readMsAvg":"31","waitRatioAvg":0.0001923076923076923,"completedParallelInputs":"1","computeRatioMax":0.415,"name":"S08: Input","shuffleOutputBytes":"51371656","recordsWritten":"1439802","readRatioMax":0.005961538461538462,"steps":[{"kind":"READ","substeps":["$30:cr_item_sk, $31:cr_order_number, $32:cr_return_quantity, $33:cr_return_amount","FROM catalog_returns"]},{"kind":"WRITE","substeps":["$30, $31, $32, $33","TO __stage08_output","BY HASH($31, $30)"]}],"writeRatioAvg":0.004615384615384616},{"readMsMax":"11","computeMsMax":"7","waitMsAvg":"3","id":"9","endMs":"1570972344374","waitMsMax":"3","startMs":"1570972344331","waitRatioMax":0.000576923076923077,"readRatioAvg":0.0021153846153846153,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.001346153846153846,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001346153846153846,"readMsAvg":"11","waitRatioAvg":0.000576923076923077,"completedParallelInputs":"1","computeRatioMax":0.001346153846153846,"name":"S09: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0021153846153846153,"steps":[{"kind":"READ","substeps":["$130:d_date_sk, $131:d_year","FROM date_dim","WHERE equal($131, 2001)"]},{"kind":"WRITE","substeps":["$130, $131","TO __stage09_output","BY HASH($130)"]}],"writeRatioAvg":0.001346153846153846},{"readMsMax":"16","computeMsMax":"20","waitMsAvg":"2","id":"10","endMs":"1570972344381","waitMsMax":"2","startMs":"1570972344343","waitRatioMax":0.0003846153846153846,"readRatioAvg":0.003076923076923077,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.0038461538461538464,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"20","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0009615384615384616,"readMsAvg":"16","waitRatioAvg":0.0003846153846153846,"completedParallelInputs":"1","computeRatioMax":0.0038461538461538464,"name":"S0A: Input","shuffleOutputBytes":"455797","recordsWritten":"10137","readRatioMax":0.003076923076923077,"steps":[{"kind":"READ","substeps":["$210:i_item_sk, $211:i_brand_id, $212:i_class_id, $213:i_category_id, $215:i_manufact_id, $214:i_category","FROM item","WHERE equal($214, 'Men')"]},{"kind":"WRITE","substeps":["$210, $211, $212, $213, $215","TO __stage0A_output","BY HASH($210)"]}],"writeRatioAvg":0.0009615384615384616},{"readMsMax":"36","computeMsMax":"1244","waitMsAvg":"1","id":"12","endMs":"1570972345732","waitMsMax":"1","startMs":"1570972344373","waitRatioMax":0.0001923076923076923,"readRatioAvg":0.006923076923076923,"parallelInputs":"1","recordsRead":"720202","computeRatioAvg":0.23923076923076922,"writeMsAvg":"50","status":"COMPLETE","writeMsMax":"50","computeMsAvg":"1244","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009615384615384616,"readMsAvg":"36","waitRatioAvg":0.0001923076923076923,"completedParallelInputs":"1","computeRatioMax":0.23923076923076922,"name":"S0C: Input","shuffleOutputBytes":"25408080","recordsWritten":"720202","readRatioMax":0.006923076923076923,"steps":[{"kind":"READ","substeps":["$20:wr_item_sk, $21:wr_order_number, $22:wr_return_quantity, $23:wr_return_amt","FROM web_returns"]},{"kind":"WRITE","substeps":["$20, $21, $22, $23","TO __stage0C_output","BY HASH($21, $20)"]}],"writeRatioAvg":0.009615384615384616},{"readMsMax":"10","computeMsMax":"9","waitMsAvg":"1","id":"13","endMs":"1570972344442","waitMsMax":"1","startMs":"1570972344387","waitRatioMax":0.0001923076923076923,"readRatioAvg":0.0019230769230769232,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0017307692307692308,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0040384615384615385,"readMsAvg":"10","waitRatioAvg":0.0001923076923076923,"completedParallelInputs":"1","computeRatioMax":0.0017307692307692308,"name":"S0D: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0019230769230769232,"steps":[{"kind":"READ","substeps":["$110:d_date_sk, $111:d_year","FROM date_dim","WHERE equal($111, 2002)"]},{"kind":"WRITE","substeps":["$110, $111","TO __stage0D_output","BY HASH($110)"]}],"writeRatioAvg":0.0040384615384615385},{"readMsMax":"13","computeMsMax":"19","waitMsAvg":"1","id":"14","endMs":"1570972344449","waitMsMax":"1","startMs":"1570972344402","waitRatioMax":0.0001923076923076923,"readRatioAvg":0.0025,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.003653846153846154,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001153846153846154,"readMsAvg":"13","waitRatioAvg":0.0001923076923076923,"completedParallelInputs":"1","computeRatioMax":0.003653846153846154,"name":"S0E: Input","shuffleOutputBytes":"455797","recordsWritten":"10137","readRatioMax":0.0025,"steps":[{"kind":"READ","substeps":["$200:i_item_sk, $201:i_brand_id, $202:i_class_id, $203:i_category_id, $205:i_manufact_id, $204:i_category","FROM item","WHERE equal($204, 'Men')"]},{"kind":"WRITE","substeps":["$200, $201, $202, $203, $205","TO __stage0E_output","BY HASH($200)"]}],"writeRatioAvg":0.001153846153846154},{"readMsMax":"27","computeMsMax":"5200","waitMsAvg":"1","id":"16","endMs":"1570972346964","waitMsMax":"1","startMs":"1570972344434","waitRatioMax":0.0001923076923076923,"readRatioAvg":0.005192307692307692,"parallelInputs":"1","recordsRead":"2878330","computeRatioAvg":1,"writeMsAvg":"15","status":"COMPLETE","writeMsMax":"15","computeMsAvg":"5200","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0028846153846153848,"readMsAvg":"27","waitRatioAvg":0.0001923076923076923,"completedParallelInputs":"1","computeRatioMax":1,"name":"S10: Input","shuffleOutputBytes":"102008208","recordsWritten":"2878330","readRatioMax":0.005192307692307692,"steps":[{"kind":"READ","substeps":["$10:sr_item_sk, $11:sr_ticket_number, $12:sr_return_quantity, $13:sr_return_amt","FROM store_returns"]},{"kind":"WRITE","substeps":["$10, $11, $12, $13","TO __stage10_output","BY HASH($11, $10)"]}],"writeRatioAvg":0.0028846153846153848},{"readMsMax":"9","computeMsMax":"7","waitMsAvg":"1","id":"17","endMs":"1570972344511","waitMsMax":"1","startMs":"1570972344453","waitRatioMax":0.0001923076923076923,"readRatioAvg":0.0017307692307692308,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.001346153846153846,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"26","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005,"readMsAvg":"9","waitRatioAvg":0.0001923076923076923,"completedParallelInputs":"1","computeRatioMax":0.001346153846153846,"name":"S11: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0017307692307692308,"steps":[{"kind":"READ","substeps":["$90:d_date_sk, $91:d_year","FROM date_dim","WHERE equal($91, 2002)"]},{"kind":"WRITE","substeps":["$90, $91","TO __stage11_output","BY HASH($90)"]}],"writeRatioAvg":0.005},{"readMsMax":"11","computeMsMax":"19","waitMsAvg":"1","id":"18","endMs":"1570972344518","waitMsMax":"1","startMs":"1570972344471","waitRatioMax":0.0001923076923076923,"readRatioAvg":0.0021153846153846153,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.003653846153846154,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0017307692307692308,"readMsAvg":"11","waitRatioAvg":0.0001923076923076923,"completedParallelInputs":"1","computeRatioMax":0.003653846153846154,"name":"S12: Input","shuffleOutputBytes":"455797","recordsWritten":"10137","readRatioMax":0.0021153846153846153,"steps":[{"kind":"READ","substeps":["$190:i_item_sk, $191:i_brand_id, $192:i_class_id, $193:i_category_id, $195:i_manufact_id, $194:i_category","FROM item","WHERE equal($194, 'Men')"]},{"kind":"WRITE","substeps":["$190, $191, $192, $193, $195","TO __stage12_output","BY HASH($190)"]}],"writeRatioAvg":0.0017307692307692308},{"readMsMax":"19","computeMsMax":"2362","waitMsAvg":"2","id":"20","endMs":"1570972345785","waitMsMax":"2","startMs":"1570972344502","waitRatioMax":0.0003846153846153846,"readRatioAvg":0.003653846153846154,"parallelInputs":"1","recordsRead":"1439802","computeRatioAvg":0.4542307692307692,"writeMsAvg":"36","status":"COMPLETE","writeMsMax":"36","computeMsAvg":"2362","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006923076923076923,"readMsAvg":"19","waitRatioAvg":0.0003846153846153846,"completedParallelInputs":"1","computeRatioMax":0.4542307692307692,"name":"S14: Input","shuffleOutputBytes":"51371656","recordsWritten":"1439802","readRatioMax":0.003653846153846154,"steps":[{"kind":"READ","substeps":["$1:cr_item_sk, $2:cr_order_number, $3:cr_return_quantity, $4:cr_return_amount","FROM catalog_returns"]},{"kind":"WRITE","substeps":["$1, $2, $3, $4","TO __stage14_output","BY HASH($2, $1)"]}],"writeRatioAvg":0.006923076923076923},{"readMsMax":"8","computeMsMax":"8","waitMsAvg":"1","id":"21","endMs":"1570972344746","waitMsMax":"1","startMs":"1570972344514","waitRatioMax":0.0001923076923076923,"readRatioAvg":0.0015384615384615385,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0015384615384615385,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0038461538461538464,"readMsAvg":"8","waitRatioAvg":0.0001923076923076923,"completedParallelInputs":"1","computeRatioMax":0.0015384615384615385,"name":"S15: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0015384615384615385,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_year","FROM date_dim","WHERE equal($71, 2002)"]},{"kind":"WRITE","substeps":["$70, $71","TO __stage15_output","BY HASH($70)"]}],"writeRatioAvg":0.0038461538461538464},{"readMsMax":"14","computeMsMax":"22","waitMsAvg":"1","id":"22","endMs":"1570972344721","waitMsMax":"1","startMs":"1570972344529","waitRatioMax":0.0001923076923076923,"readRatioAvg":0.002692307692307692,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.004230769230769231,"writeMsAvg":"161","status":"COMPLETE","writeMsMax":"161","computeMsAvg":"22","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03096153846153846,"readMsAvg":"14","waitRatioAvg":0.0001923076923076923,"completedParallelInputs":"1","computeRatioMax":0.004230769230769231,"name":"S16: Input","shuffleOutputBytes":"455797","recordsWritten":"10137","readRatioMax":0.002692307692307692,"steps":[{"kind":"READ","substeps":["$180:i_item_sk, $181:i_brand_id, $182:i_class_id, $183:i_category_id, $185:i_manufact_id, $184:i_category","FROM item","WHERE equal($184, 'Men')"]},{"kind":"WRITE","substeps":["$180, $181, $182, $183, $185","TO __stage16_output","BY HASH($180)"]}],"writeRatioAvg":0.03096153846153846},{"readMsMax":"0","computeMsMax":"25","inputStages":["8"],"waitMsAvg":"2","id":"25","endMs":"1570972345906","waitMsMax":"3","startMs":"1570972345539","waitRatioMax":0.000576923076923077,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1439802","computeRatioAvg":0.0034615384615384616,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"165","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03173076923076923,"readMsAvg":"0","waitRatioAvg":0.0003846153846153846,"completedParallelInputs":"100","computeRatioMax":0.004807692307692308,"name":"S19: Coalesce","shuffleOutputBytes":"51371656","recordsWritten":"1439802","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage08_output"]}],"writeRatioAvg":0.003653846153846154},{"readMsMax":"0","computeMsMax":"24","inputStages":["20"],"waitMsAvg":"4","id":"26","endMs":"1570972346432","waitMsMax":"9","startMs":"1570972346136","waitRatioMax":0.0017307692307692308,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1439802","computeRatioAvg":0.003653846153846154,"writeMsAvg":"181","status":"COMPLETE","writeMsMax":"210","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04038461538461539,"readMsAvg":"0","waitRatioAvg":0.0007692307692307692,"completedParallelInputs":"100","computeRatioMax":0.004615384615384616,"name":"S1A: Coalesce","shuffleOutputBytes":"51371656","recordsWritten":"1439802","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage14_output"]}],"writeRatioAvg":0.03480769230769231},{"readMsMax":"47","computeMsMax":"2325","inputStages":["5","6"],"waitMsAvg":"1","id":"27","endMs":"1570972347750","waitMsMax":"2","startMs":"1570972346542","waitRatioMax":0.0003846153846153846,"readRatioAvg":0.006730769230769231,"parallelInputs":"10","recordsRead":"28907132","computeRatioAvg":0.3569230769230769,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"1856","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004423076923076923,"readMsAvg":"35","waitRatioAvg":0.0001923076923076923,"completedParallelInputs":"10","computeRatioMax":0.44711538461538464,"name":"S1B: Join","shuffleOutputBytes":"43855683","recordsWritten":"544347","readRatioMax":0.009038461538461539,"steps":[{"kind":"READ","substeps":["$140:ss_sold_date_sk, $141:ss_item_sk, $142:ss_ticket_number, $143:ss_quantity, $144:ss_ext_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$220, $221, $222, $223, $225","FROM __stage06_output"]},{"kind":"READ","substeps":["$150, $151","FROM __stage05_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $580 = $150"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $141 = $220"]},{"kind":"WRITE","substeps":["$600, $601, $602, $603, $604, $605, $606, $607, $608","TO __stage1B_output","BY HASH($601, $600)"]}],"writeRatioAvg":0.0017307692307692308},{"readMsMax":"41","computeMsMax":"2695","inputStages":["17","18"],"waitMsAvg":"1","id":"28","endMs":"1570972348426","waitMsMax":"1","startMs":"1570972347003","waitRatioMax":0.0001923076923076923,"readRatioAvg":0.005961538461538462,"parallelInputs":"10","recordsRead":"28907132","computeRatioAvg":0.36923076923076925,"writeMsAvg":"14","status":"COMPLETE","writeMsMax":"28","computeMsAvg":"1920","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005384615384615384,"readMsAvg":"31","waitRatioAvg":0.0001923076923076923,"completedParallelInputs":"10","computeRatioMax":0.5182692307692308,"name":"S1C: Join","shuffleOutputBytes":"44165958","recordsWritten":"548158","readRatioMax":0.007884615384615384,"steps":[{"kind":"READ","substeps":["$80:ss_sold_date_sk, $81:ss_item_sk, $82:ss_ticket_number, $83:ss_quantity, $84:ss_ext_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$190, $191, $192, $193, $195","FROM __stage12_output"]},{"kind":"READ","substeps":["$90, $91","FROM __stage11_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $420 = $90"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $81 = $190"]},{"kind":"WRITE","substeps":["$440, $441, $442, $443, $444, $445, $446, $447, $448","TO __stage1C_output","BY HASH($441, $440)"]}],"writeRatioAvg":0.002692307692307692},{"readMsMax":"48","computeMsMax":"4429","inputStages":["0","4","1","9","27","25","2","10"],"waitMsAvg":"1","id":"29","endMs":"1570972350411","waitMsMax":"4","startMs":"1570972347853","waitRatioMax":0.0007692307692307692,"readRatioAvg":0.000576923076923077,"parallelInputs":"112","recordsRead":"267067502","computeRatioAvg":0.5182692307692308,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"217","computeMsAvg":"2695","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04173076923076923,"readMsAvg":"3","waitRatioAvg":0.0001923076923076923,"completedParallelInputs":"112","computeRatioMax":0.8517307692307692,"name":"S1D: Join+","shuffleOutputBytes":"21177472","recordsWritten":"337336","readRatioMax":0.009230769230769232,"steps":[{"kind":"READ","substeps":["$120:cs_sold_date_sk, $121:cs_item_sk, $122:cs_order_number, $123:cs_quantity, $124:cs_ext_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$210, $211, $212, $213, $215","FROM __stage0A_output"]},{"kind":"READ","substeps":["$130, $131","FROM __stage09_output"]},{"kind":"READ","substeps":["$30, $31, $32, $33","FROM __stage19_output"]},{"kind":"READ","substeps":["$600, $601, $602, $603, $604, $605, $606, $607, $608","FROM __stage1B_output"]},{"kind":"READ","substeps":["$40, $41, $42, $43","FROM __stage04_output"]},{"kind":"READ","substeps":["$160:ws_sold_date_sk, $161:ws_item_sk, $162:ws_order_number, $163:ws_quantity, $164:ws_ext_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$230, $231, $232, $233, $235","FROM __stage02_output"]},{"kind":"READ","substeps":["$170, $171","FROM __stage01_output"]},{"kind":"READ","substeps":["$50, $51, $52, $53","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $670 := $300, $671 := $301, $672 := $302, $673 := $303, $674 := $304","$280 := SUM($305)","$281 := SUM($306)"]},{"kind":"COMPUTE","substeps":["$340 := subtract($560, coalesce($567, 0))","$341 := subtract($561, coalesce($568, 0))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $551 = $31, $550 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $530 = $130"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $121 = $210"]},{"kind":"COMPUTE","substeps":["$350 := subtract($610, coalesce($617, 0))","$351 := subtract($611, coalesce($618, 0))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH EACH ON $601 = $41, $600 = $40"]},{"kind":"COMPUTE","substeps":["$360 := subtract($660, coalesce($667, 0))","$361 := subtract($661, coalesce($668, 0))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $651 = $51, $650 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $630 = $170"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $161 = $230"]},{"kind":"WRITE","substeps":["$280, $281, $670, $671, $672, $673, $674","TO __stage1D_output","BY HASH($670, $671, $672, $673, $674)"]}],"writeRatioAvg":0.0034615384615384616},{"readMsMax":"75","computeMsMax":"4287","inputStages":["12","13","14","21","26","16","28","22"],"waitMsAvg":"2","id":"30","endMs":"1570972351335","waitMsMax":"3","startMs":"1570972348627","waitRatioMax":0.000576923076923077,"readRatioAvg":0.0007692307692307692,"parallelInputs":"112","recordsRead":"267071313","computeRatioAvg":0.5146153846153846,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"462","computeMsAvg":"2676","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08884615384615385,"readMsAvg":"4","waitRatioAvg":0.0003846153846153846,"completedParallelInputs":"112","computeRatioMax":0.8244230769230769,"name":"S1E: Join+","shuffleOutputBytes":"22142308","recordsWritten":"352676","readRatioMax":0.014423076923076924,"steps":[{"kind":"READ","substeps":["$60:cs_sold_date_sk, $61:cs_item_sk, $62:cs_order_number, $63:cs_quantity, $64:cs_ext_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$180, $181, $182, $183, $185","FROM __stage16_output"]},{"kind":"READ","substeps":["$70, $71","FROM __stage15_output"]},{"kind":"READ","substeps":["$1, $2, $3, $4","FROM __stage1A_output"]},{"kind":"READ","substeps":["$440, $441, $442, $443, $444, $445, $446, $447, $448","FROM __stage1C_output"]},{"kind":"READ","substeps":["$10, $11, $12, $13","FROM __stage10_output"]},{"kind":"READ","substeps":["$100:ws_sold_date_sk, $101:ws_item_sk, $102:ws_order_number, $103:ws_quantity, $104:ws_ext_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$200, $201, $202, $203, $205","FROM __stage0E_output"]},{"kind":"READ","substeps":["$110, $111","FROM __stage0D_output"]},{"kind":"READ","substeps":["$20, $21, $22, $23","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $510 := $290, $511 := $291, $512 := $292, $513 := $293, $514 := $294","$270 := SUM($295)","$271 := SUM($296)"]},{"kind":"COMPUTE","substeps":["$310 := subtract($400, coalesce($407, 0))","$311 := subtract($401, coalesce($408, 0))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $391 = $2, $390 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $370 = $70"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $61 = $180"]},{"kind":"COMPUTE","substeps":["$320 := subtract($450, coalesce($457, 0))","$321 := subtract($451, coalesce($458, 0))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH EACH ON $441 = $11, $440 = $10"]},{"kind":"COMPUTE","substeps":["$330 := subtract($500, coalesce($507, 0))","$331 := subtract($501, coalesce($508, 0))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $491 = $21, $490 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $470 = $110"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $101 = $200"]},{"kind":"WRITE","substeps":["$270, $271, $510, $511, $512, $513, $514","TO __stage1E_output","BY HASH($510, $511, $512, $513, $514)"]}],"writeRatioAvg":0.0017307692307692308},{"readMsMax":"0","computeMsMax":"116","inputStages":["30"],"waitMsAvg":"1","id":"32","endMs":"1570972351694","waitMsMax":"1","startMs":"1570972351605","waitRatioMax":0.0001923076923076923,"readRatioAvg":0,"parallelInputs":"2","recordsRead":"352676","computeRatioAvg":0.020384615384615383,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"106","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0015384615384615385,"readMsAvg":"0","waitRatioAvg":0.0001923076923076923,"completedParallelInputs":"2","computeRatioMax":0.022307692307692306,"name":"S20: Aggregate","shuffleOutputBytes":"273042","recordsWritten":"4334","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$270, $271, $510, $511, $512, $513, $514","FROM __stage1E_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $520 := $510, $521 := $511, $522 := $512, $523 := $513, $524 := $514","$250 := SUM($270)","$251 := SUM($271)"]},{"kind":"WRITE","substeps":["$250, $251, $520, $521, $522, $523, $524","TO __stage20_output","BY HASH($521, $522, $523, $524)"]}],"writeRatioAvg":0.001346153846153846},{"readMsMax":"0","computeMsMax":"9","inputStages":["32"],"waitMsAvg":"1","id":"33","endMs":"1570972351812","waitMsMax":"2","startMs":"1570972351705","waitRatioMax":0.0003846153846153846,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"4334","computeRatioAvg":0.0009615384615384616,"writeMsAvg":"41","status":"COMPLETE","writeMsMax":"63","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012115384615384615,"readMsAvg":"0","waitRatioAvg":0.0001923076923076923,"completedParallelInputs":"100","computeRatioMax":0.0017307692307692308,"name":"S21: Coalesce","shuffleOutputBytes":"273042","recordsWritten":"4334","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage20_output"]}],"writeRatioAvg":0.007884615384615384},{"readMsMax":"0","computeMsMax":"123","inputStages":["29","33"],"waitMsAvg":"3","id":"34","endMs":"1570972351949","waitMsMax":"3","startMs":"1570972351708","waitRatioMax":0.000576923076923077,"readRatioAvg":0,"parallelInputs":"2","recordsRead":"346004","computeRatioAvg":0.021923076923076924,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"114","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001153846153846154,"readMsAvg":"0","waitRatioAvg":0.000576923076923077,"completedParallelInputs":"2","computeRatioMax":0.023653846153846154,"name":"S22: Join+","shuffleOutputBytes":"18000","recordsWritten":"200","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$280, $281, $670, $671, $672, $673, $674","FROM __stage1D_output"]},{"kind":"READ","substeps":["$250, $251, $520, $521, $522, $523, $524","FROM __stage21_output"]},{"kind":"SORT","substeps":["$240 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$240 := subtract($690, $697)","$241 := subtract($691, $698)"]},{"kind":"FILTER","substeps":["less(divide(CAST($690 AS DOUBLE), CAST($697 AS DOUBLE)), 0.9)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $681 = $521, $682 = $522, $683 = $523, $684 = $524"]},{"kind":"AGGREGATE","substeps":["GROUP BY $680 := $670, $681 := $671, $682 := $672, $683 := $673, $684 := $674","$260 := SUM($280)","$261 := SUM($281)"]},{"kind":"WRITE","substeps":["$700, $701, $702, $703, $704, $705, $706, $707, $708, $709","TO __stage22_output"]}],"writeRatioAvg":0.0009615384615384616},{"readMsMax":"0","computeMsMax":"6","inputStages":["34"],"waitMsAvg":"1","id":"35","endMs":"1570972352000","waitMsMax":"1","startMs":"1570972351731","waitRatioMax":0.0001923076923076923,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"200","computeRatioAvg":0.001153846153846154,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001153846153846154,"readMsAvg":"0","waitRatioAvg":0.0001923076923076923,"completedParallelInputs":"1","computeRatioMax":0.001153846153846154,"name":"S23: Output","shuffleOutputBytes":"9000","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$700, $701, $702, $703, $704, $705, $706, $707, $708, $709","FROM __stage22_output"]},{"kind":"SORT","substeps":["$700 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$710, $711, $712, $713, $714, $715, $716, $717, $718, $719","TO __stage23_output"]}],"writeRatioAvg":0.001153846153846154}],"estimatedBytesProcessed":"2147826680","timeline":[{"totalSlotMs":"3595","activeUnits":"16","completedUnits":"10","elapsedMs":"756","pendingUnits":"16"},{"totalSlotMs":"30751","activeUnits":"6","completedUnits":"114","elapsedMs":"1999","pendingUnits":"4"},{"totalSlotMs":"59390","activeUnits":"47","completedUnits":"217","elapsedMs":"3052","pendingUnits":"11"},{"totalSlotMs":"87916","activeUnits":"119","completedUnits":"231","elapsedMs":"4142","pendingUnits":"119"},{"totalSlotMs":"335871","activeUnits":"217","completedUnits":"246","elapsedMs":"5291","pendingUnits":"216"},{"totalSlotMs":"658116","activeUnits":"140","completedUnits":"405","elapsedMs":"6296","pendingUnits":"57"},{"totalSlotMs":"717602","activeUnits":"14","completedUnits":"461","elapsedMs":"7434","pendingUnits":"1"},{"totalSlotMs":"724699","activeUnits":"3","completedUnits":"567","elapsedMs":"8717","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"2148532224","totalPartitionsProcessed":"0","totalBytesProcessed":"2147826680","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_returns","datasetId":"scale_10"}]},"endTime":"1570972352604"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query75_1570972342"},"etag":"xBkSSoF23jk+2B+ahr0huA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query75_1570972342?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon51b3ad470d5991e4ee49453e8941d0fbabfb1cfa","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query75\nWITH all_sales \n AS (SELECT d_year, \n i_brand_id, \n i_class_id, \n i_category_id, \n i_manufact_id, \n Sum(sales_cnt) AS sales_cnt, \n Sum(sales_amt) AS sales_amt \n FROM (SELECT d_year, \n i_brand_id, \n i_class_id, \n i_category_id, \n i_manufact_id, \n cs_quantity - COALESCE(cr_return_quantity, 0) AS \n sales_cnt, \n cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS \n sales_amt \n FROM catalog_sales \n JOIN item \n ON i_item_sk = cs_item_sk \n JOIN date_dim \n ON d_date_sk = cs_sold_date_sk \n LEFT JOIN catalog_returns \n ON ( cs_order_number = cr_order_number \n AND cs_item_sk = cr_item_sk ) \n WHERE i_category = 'Men' \n UNION ALL\n SELECT d_year, \n i_brand_id, \n i_class_id, \n i_category_id, \n i_manufact_id, \n ss_quantity - COALESCE(sr_return_quantity, 0) AS \n sales_cnt, \n ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS \n sales_amt \n FROM store_sales \n JOIN item \n ON i_item_sk = ss_item_sk \n JOIN date_dim \n ON d_date_sk = ss_sold_date_sk \n LEFT JOIN store_returns \n ON ( ss_ticket_number = sr_ticket_number \n AND ss_item_sk = sr_item_sk ) \n WHERE i_category = 'Men' \n UNION ALL\n SELECT d_year, \n i_brand_id, \n i_class_id, \n i_category_id, \n i_manufact_id, \n ws_quantity - COALESCE(wr_return_quantity, 0) AS \n sales_cnt, \n ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS \n sales_amt \n FROM web_sales \n JOIN item \n ON i_item_sk = ws_item_sk \n JOIN date_dim \n ON d_date_sk = ws_sold_date_sk \n LEFT JOIN web_returns \n ON ( ws_order_number = wr_order_number \n AND ws_item_sk = wr_item_sk ) \n WHERE i_category = 'Men') sales_detail \n GROUP BY d_year, \n i_brand_id, \n i_class_id, \n i_category_id, \n i_manufact_id) \nSELECT prev_yr.d_year AS prev_year, \n curr_yr.d_year AS year1, \n curr_yr.i_brand_id, \n curr_yr.i_class_id, \n curr_yr.i_category_id, \n curr_yr.i_manufact_id, \n prev_yr.sales_cnt AS prev_yr_cnt, \n curr_yr.sales_cnt AS curr_yr_cnt, \n curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, \n curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff \nFROM all_sales curr_yr, \n all_sales prev_yr \nWHERE curr_yr.i_brand_id = prev_yr.i_brand_id \n AND curr_yr.i_class_id = prev_yr.i_class_id \n AND curr_yr.i_category_id = prev_yr.i_category_id \n AND curr_yr.i_manufact_id = prev_yr.i_manufact_id \n AND curr_yr.d_year = 2002 \n AND prev_yr.d_year = 2002 - 1 \n AND curr_yr.sales_cnt / prev_yr.sales_cnt\n < 0.9 \nORDER BY sales_cnt_diff\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query75_1570972342","user_email":"nithish.sankaranarayanan@ulb.be"}
