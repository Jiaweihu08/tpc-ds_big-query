{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"131452","creationTime":"1570993830894","totalBytesProcessed":"5732788799","startTime":"1570993831038","query":{"totalSlotMs":"131452","queryPlan":[{"readMsMax":"12","computeMsMax":"8","waitMsAvg":"1","id":"0","endMs":"1570993831258","waitMsMax":"1","startMs":"1570993831212","waitRatioMax":0.0004144218814753419,"readRatioAvg":0.004973062577704103,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.003315375051802735,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0037297969332780773,"readMsAvg":"12","waitRatioAvg":0.0004144218814753419,"completedParallelInputs":"1","computeRatioMax":0.003315375051802735,"name":"S00: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.004973062577704103,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $11:d_month_seq","FROM date_dim","WHERE between($11, 1200, 1211)"]},{"kind":"WRITE","substeps":["$10","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.0037297969332780773},{"readMsMax":"16","computeMsMax":"6","waitMsAvg":"21","id":"1","endMs":"1570993831345","waitMsMax":"21","startMs":"1570993831255","waitRatioMax":0.00870285951098218,"readRatioAvg":0.00663075010360547,"parallelInputs":"1","recordsRead":"30","computeRatioAvg":0.0024865312888520514,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"12","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004973062577704103,"readMsAvg":"16","waitRatioAvg":0.00870285951098218,"completedParallelInputs":"1","computeRatioMax":0.0024865312888520514,"name":"S01: Input","shuffleOutputBytes":"821","recordsWritten":"30","readRatioMax":0.00663075010360547,"steps":[{"kind":"READ","substeps":["$1:cc_call_center_sk, $2:cc_name","FROM call_center"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage01_output","BY HASH($1)"]}],"writeRatioAvg":0.004973062577704103},{"readMsMax":"22","computeMsMax":"9","waitMsAvg":"1","id":"2","endMs":"1570993831361","waitMsMax":"1","startMs":"1570993831259","waitRatioMax":0.0004144218814753419,"readRatioAvg":0.009117281392457521,"parallelInputs":"1","recordsRead":"20","computeRatioAvg":0.0037297969332780773,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007045171985080812,"readMsAvg":"22","waitRatioAvg":0.0004144218814753419,"completedParallelInputs":"1","computeRatioMax":0.0037297969332780773,"name":"S02: Input","shuffleOutputBytes":"430","recordsWritten":"20","readRatioMax":0.009117281392457521,"steps":[{"kind":"READ","substeps":["$20:sm_ship_mode_sk, $21:sm_type","FROM ship_mode"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.007045171985080812},{"readMsMax":"20","computeMsMax":"7","waitMsAvg":"29","id":"3","endMs":"1570993831411","waitMsMax":"29","startMs":"1570993831306","waitRatioMax":0.012018234562784915,"readRatioAvg":0.008288437629506838,"parallelInputs":"1","recordsRead":"15","computeRatioAvg":0.002900953170327393,"writeMsAvg":"31","status":"COMPLETE","writeMsMax":"31","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0128470783257356,"readMsAvg":"20","waitRatioAvg":0.012018234562784915,"completedParallelInputs":"1","computeRatioMax":0.002900953170327393,"name":"S03: Input","shuffleOutputBytes":"440","recordsWritten":"15","readRatioMax":0.008288437629506838,"steps":[{"kind":"READ","substeps":["$40:w_warehouse_sk, $41:w_warehouse_name","FROM warehouse"]},{"kind":"WRITE","substeps":["$40, $41","TO __stage03_output","BY HASH($40)"]}],"writeRatioAvg":0.0128470783257356},{"readMsMax":"84","computeMsMax":"2413","inputStages":["0","1","2","3"],"waitMsAvg":"1","id":"5","endMs":"1570993833116","waitMsMax":"6","startMs":"1570993831539","waitRatioMax":0.0024865312888520514,"readRatioAvg":0.009117281392457521,"parallelInputs":"141","recordsRead":"144071222","computeRatioAvg":0.32366348943224205,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"53","computeMsAvg":"781","shuffleOutputBytesSpilled":"0","writeRatioMax":0.021964359718193122,"readMsAvg":"22","waitRatioAvg":0.0004144218814753419,"completedParallelInputs":"141","computeRatioMax":1,"name":"S05: Join+","shuffleOutputBytes":"5297188","recordsWritten":"55199","readRatioMax":0.03481143804392872,"steps":[{"kind":"READ","substeps":["$30:cs_sold_date_sk, $31:cs_ship_date_sk, $32:cs_call_center_sk, $33:cs_ship_mode_sk, $34:cs_warehouse_sk","FROM catalog_sales"]},{"kind":"READ","substeps":["$40, $41","FROM __stage03_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage02_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage01_output"]},{"kind":"READ","substeps":["$10","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $120 := $70, $121 := $111, $122 := $110","$60 := SUM($75)","$61 := SUM($74)","$62 := SUM($73)","$63 := SUM($72)","$64 := SUM($71)"]},{"kind":"COMPUTE","substeps":["$70 := substr($114, 1, 20)","$71 := case_no_value(greater(subtract($113, $112), 120), 1, 0)","$72 := case_no_value(and(greater(subtract($113, $112), 90), less_or_equal(subtract($113, $112), 120)), 1, 0)","$73 := case_no_value(and(greater(subtract($113, $112), 60), less_or_equal(subtract($113, $112), 90)), 1, 0)","$74 := case_no_value(and(greater(subtract($113, $112), 30), less_or_equal(subtract($113, $112), 60)), 1, 0)","$75 := case_no_value(less_or_equal(subtract($113, $112), 30), 1, 0)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $102 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $92 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $83 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $34 = $40"]},{"kind":"WRITE","substeps":["$122, $121, $60, $61, $62, $63, $64, $120","TO __stage05_output","BY HASH($120, $121, $122)"]}],"writeRatioAvg":0.003315375051802735},{"readMsMax":"0","computeMsMax":"14","inputStages":["5"],"waitMsAvg":"1","id":"6","endMs":"1570993833787","waitMsMax":"1","startMs":"1570993833665","waitRatioMax":0.0004144218814753419,"readRatioAvg":0,"parallelInputs":"14","recordsRead":"55199","computeRatioAvg":0.0037297969332780773,"writeMsAvg":"46","status":"COMPLETE","writeMsMax":"55","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.022793203481143803,"readMsAvg":"0","waitRatioAvg":0.0004144218814753419,"completedParallelInputs":"14","computeRatioMax":0.005801906340654786,"name":"S06: Sort+","shuffleOutputBytes":"124492","recordsWritten":"1296","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$122, $121, $60, $61, $62, $63, $64, $120","FROM __stage05_output"]},{"kind":"SORT","substeps":["$130 ASC, $131 ASC, $132 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $130 := $120, $131 := $121, $132 := $122","$50 := SUM($60)","$51 := SUM($61)","$52 := SUM($62)","$53 := SUM($63)","$54 := SUM($64)"]},{"kind":"WRITE","substeps":["$140, $141, $142, $143, $144, $145, $146, $147","TO __stage06_output"]}],"writeRatioAvg":0.019063406547865726},{"readMsMax":"0","computeMsMax":"6","inputStages":["6"],"waitMsAvg":"1","id":"7","endMs":"1570993833804","waitMsMax":"1","startMs":"1570993833689","waitRatioMax":0.0004144218814753419,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1296","computeRatioAvg":0.0024865312888520514,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0045586406962287605,"readMsAvg":"0","waitRatioAvg":0.0004144218814753419,"completedParallelInputs":"1","computeRatioMax":0.0024865312888520514,"name":"S07: Output","shuffleOutputBytes":"9145","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$140, $141, $142, $143, $144, $145, $146, $147","FROM __stage06_output"]},{"kind":"SORT","substeps":["$147 ASC, $141 ASC, $140 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$150, $151, $152, $153, $154, $155, $156, $157","TO __stage07_output"]}],"writeRatioAvg":0.0045586406962287605}],"estimatedBytesProcessed":"5732788799","timeline":[{"totalSlotMs":"6356","activeUnits":"141","completedUnits":"4","elapsedMs":"674","pendingUnits":"141"},{"totalSlotMs":"127131","activeUnits":"28","completedUnits":"142","elapsedMs":"1781","pendingUnits":"3"},{"totalSlotMs":"131452","activeUnits":"0","completedUnits":"160","elapsedMs":"2914","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"5733613568","totalPartitionsProcessed":"0","totalBytesProcessed":"5732788799","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"call_center","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"warehouse","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"ship_mode","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_100"}]},"endTime":"1570993833980"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query99_1570993829"},"etag":"MBTEgH7dYxMhanCXk25RkQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query99_1570993829?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anond12c2e378ab414cdc956ad6133224ad184283428","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"\n\n-- query99\nSELECT Substr(w_warehouse_name, 1, 20), \n sm_type, \n cc_name, \n Sum(CASE \n WHEN ( cs_ship_date_sk - cs_sold_date_sk <= 30 ) THEN 1 \n ELSE 0 \n END) AS days_30, \n Sum(CASE \n WHEN ( cs_ship_date_sk - cs_sold_date_sk > 30 ) \n AND ( cs_ship_date_sk - cs_sold_date_sk <= 60 ) THEN 1 \n ELSE 0 \n END) AS days_31_60, \n Sum(CASE \n WHEN ( cs_ship_date_sk - cs_sold_date_sk > 60 ) \n AND ( cs_ship_date_sk - cs_sold_date_sk <= 90 ) THEN 1 \n ELSE 0 \n END) AS days_61_90, \n Sum(CASE \n WHEN ( cs_ship_date_sk - cs_sold_date_sk > 90 ) \n AND ( cs_ship_date_sk - cs_sold_date_sk <= 120 ) THEN \n 1 \n ELSE 0 \n END) AS days_91_120, \n Sum(CASE \n WHEN ( cs_ship_date_sk - cs_sold_date_sk > 120 ) THEN 1 \n ELSE 0 \n END) AS days_over_120 \nFROM catalog_sales, \n warehouse, \n ship_mode, \n call_center, \n date_dim \nWHERE d_month_seq BETWEEN 1200 AND 1200 + 11 \n AND cs_ship_date_sk = d_date_sk \n AND cs_warehouse_sk = w_warehouse_sk \n AND cs_ship_mode_sk = sm_ship_mode_sk \n AND cs_call_center_sk = cc_call_center_sk \nGROUP BY 1, 2, 3\nORDER BY 1, 2, 3\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query99_1570993829","user_email":"nithish.sankaranarayanan@ulb.be"}
