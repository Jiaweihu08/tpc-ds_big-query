{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"270299","creationTime":"1570992265431","totalBytesProcessed":"3477544011","startTime":"1570992265539","query":{"totalSlotMs":"270299","queryPlan":[{"readMsMax":"23","computeMsMax":"20","waitMsAvg":"1","id":"0","endMs":"1570992265806","waitMsMax":"1","startMs":"1570992265749","waitRatioMax":0.0005998800239952009,"readRatioAvg":0.013797240551889621,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.01199760047990402,"writeMsAvg":"13","status":"COMPLETE","writeMsMax":"13","computeMsAvg":"20","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007798440311937612,"readMsAvg":"23","waitRatioAvg":0.0005998800239952009,"completedParallelInputs":"1","computeRatioMax":0.01199760047990402,"name":"S00: Input","shuffleOutputBytes":"261","recordsWritten":"29","readRatioMax":0.013797240551889621,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $11:d_date","FROM date_dim","WHERE between(CAST($11 AS DATE), 11356, 11384)"]},{"kind":"WRITE","substeps":["$10","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.007798440311937612},{"readMsMax":"38","computeMsMax":"290","waitMsAvg":"27","id":"1","endMs":"1570992266569","waitMsMax":"27","startMs":"1570992265791","waitRatioMax":0.016196760647870425,"readRatioAvg":0.022795440911817635,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.1739652069586083,"writeMsAvg":"53","status":"COMPLETE","writeMsMax":"53","computeMsAvg":"290","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03179364127174565,"readMsAvg":"38","waitRatioAvg":0.016196760647870425,"completedParallelInputs":"1","computeRatioMax":0.1739652069586083,"name":"S01: Input","shuffleOutputBytes":"10489071","recordsWritten":"61327","readRatioMax":0.022795440911817635,"steps":[{"kind":"READ","substeps":["$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_class, $25:i_category","FROM item","WHERE in($25, 'Children', 'Women', 'Electronics')"]},{"kind":"WRITE","substeps":["$20, $21, $22, $23, $24, $25","TO __stage01_output","BY HASH($20)"]}],"writeRatioAvg":0.03179364127174565},{"readMsMax":"151","computeMsMax":"1667","inputStages":["0","1"],"waitMsAvg":"2","id":"3","endMs":"1570992267604","waitMsMax":"4","startMs":"1570992266677","waitRatioMax":0.0023995200959808036,"readRatioAvg":0.020395920815836834,"parallelInputs":"141","recordsRead":"152661647","computeRatioAvg":0.4871025794841032,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"207","computeMsAvg":"812","shuffleOutputBytesSpilled":"0","writeRatioMax":0.1241751649670066,"readMsAvg":"34","waitRatioAvg":0.0011997600479904018,"completedParallelInputs":"141","computeRatioMax":1,"name":"S03: Join+","shuffleOutputBytes":"10680555","recordsWritten":"62511","readRatioMax":0.09058188362327535,"steps":[{"kind":"READ","substeps":["$1:cs_sold_date_sk, $2:cs_item_sk, $3:cs_ext_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$20, $21, $22, $23, $24, $25","FROM __stage01_output"]},{"kind":"READ","substeps":["$10","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $90 := $81, $91 := $82, $92 := $85, $93 := $84, $94 := $83","$60 := SUM($80)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $70 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $2 = $20"]},{"kind":"WRITE","substeps":["$90, $91, $94, $93, $92, $60","TO __stage03_output","BY HASH($90, $91, $92, $93, $94)"]}],"writeRatioAvg":0.004799040191961607},{"readMsMax":"0","computeMsMax":"29","inputStages":["3"],"waitMsAvg":"1","id":"4","endMs":"1570992267905","waitMsMax":"2","startMs":"1570992267632","waitRatioMax":0.0011997600479904018,"readRatioAvg":0,"parallelInputs":"14","recordsRead":"62511","computeRatioAvg":0.014397120575884824,"writeMsAvg":"32","status":"COMPLETE","writeMsMax":"118","computeMsAvg":"24","shuffleOutputBytesSpilled":"0","writeRatioMax":0.07078584283143372,"readMsAvg":"0","waitRatioAvg":0.0005998800239952009,"completedParallelInputs":"14","computeRatioMax":0.01739652069586083,"name":"S04: Aggregate","shuffleOutputBytes":"5210189","recordsWritten":"30485","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$90, $91, $94, $93, $92, $60","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $100 := $90, $101 := $91, $102 := $92, $103 := $93, $104 := $94","$50 := SUM($60)"]},{"kind":"WRITE","substeps":["$100, $101, $104, $103, $102, $50","TO __stage04_output","BY HASH($103)"]}],"writeRatioAvg":0.01919616076784643},{"readMsMax":"0","computeMsMax":"19","inputStages":["4"],"waitMsAvg":"1","id":"5","endMs":"1570992268032","waitMsMax":"1","startMs":"1570992267946","waitRatioMax":0.0005998800239952009,"readRatioAvg":0,"parallelInputs":"14","recordsRead":"30485","computeRatioAvg":0.0065986802639472104,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"14","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008398320335932814,"readMsAvg":"0","waitRatioAvg":0.0005998800239952009,"completedParallelInputs":"14","computeRatioMax":0.011397720455908818,"name":"S05: Sort+","shuffleOutputBytes":"233756","recordsWritten":"1300","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$100, $101, $104, $103, $102, $50","FROM __stage04_output"]},{"kind":"SORT","substeps":["$124 ASC, $123 ASC, $120 ASC, $121 ASC, $30 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$30 := divide(multiply($125, 100), $40)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$40 := SUM($115) OVER (PARTITION BY $113 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)"]},{"kind":"SORT","substeps":["$103 ASC"]},{"kind":"WRITE","substeps":["$130, $131, $132, $133, $134, $135, $136","TO __stage05_output"]}],"writeRatioAvg":0.007198560287942412},{"readMsMax":"0","computeMsMax":"10","inputStages":["5"],"waitMsAvg":"1","id":"6","endMs":"1570992268100","waitMsMax":"1","startMs":"1570992267962","waitRatioMax":0.0005998800239952009,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1300","computeRatioAvg":0.00599880023995201,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005398920215956809,"readMsAvg":"0","waitRatioAvg":0.0005998800239952009,"completedParallelInputs":"1","computeRatioMax":0.00599880023995201,"name":"S06: Output","shuffleOutputBytes":"16608","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$130, $131, $132, $133, $134, $135, $136","FROM __stage05_output"]},{"kind":"SORT","substeps":["$134 ASC, $133 ASC, $130 ASC, $131 ASC, $135 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$140, $141, $142, $143, $144, $145, $146","TO __stage06_output"]}],"writeRatioAvg":0.005398920215956809}],"estimatedBytesProcessed":"3477544011","timeline":[{"totalSlotMs":"35838","activeUnits":"142","completedUnits":"1","elapsedMs":"711","pendingUnits":"142"},{"totalSlotMs":"263382","activeUnits":"141","completedUnits":"140","elapsedMs":"1942","pendingUnits":"3"},{"totalSlotMs":"270299","activeUnits":"3","completedUnits":"172","elapsedMs":"2724","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"3478126592","totalPartitionsProcessed":"0","totalBytesProcessed":"3477544011","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_100"}]},"endTime":"1570992268291"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query20_1570992263"},"etag":"VWB23O7FuxmQe0GGly2lFw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query20_1570992263?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon9a8cad94b9351feddd082c1d8d766298f9d2d577","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query20\nSELECT \n i_item_id , \n i_item_desc , \n i_category , \n i_class , \n i_current_price , \n Sum(cs_ext_sales_price) AS itemrevenue ,\n Sum(cs_ext_sales_price)*100/Sum(Sum(cs_ext_sales_price)) OVER (partition BY i_class) AS revenueratio\nFROM catalog_sales , \n item , \n date_dim \nWHERE cs_item_sk = i_item_sk \nAND i_category IN ('Children', \n 'Women', \n 'Electronics') \nAND cs_sold_date_sk = d_date_sk \nAND Cast(d_date AS DATE) BETWEEN Cast('2001-02-03' AS DATE) AND ( \n Cast('2001-03-03' AS DATE)) \nGROUP BY i_item_id , \n i_item_desc , \n i_category , \n i_class , \n i_current_price \nORDER BY i_category , \n i_class , \n i_item_id , \n i_item_desc , \n revenueratio \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query20_1570992263","user_email":"nithish.sankaranarayanan@ulb.be"}
