{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"259717","creationTime":"1570993634694","totalBytesProcessed":"4452789674","startTime":"1570993635070","query":{"totalSlotMs":"259717","queryPlan":[{"readMsMax":"18","computeMsMax":"8","waitMsAvg":"1","id":"0","endMs":"1570993635386","waitMsMax":"1","startMs":"1570993635309","waitRatioMax":0.0001353729524840937,"readRatioAvg":0.0024367131447136864,"parallelInputs":"1","recordsRead":"55","computeRatioAvg":0.0010829836198727495,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.000812237714904562,"readMsAvg":"18","waitRatioAvg":0.0001353729524840937,"completedParallelInputs":"1","computeRatioMax":0.0010829836198727495,"name":"S00: Input","shuffleOutputBytes":"1528","recordsWritten":"55","readRatioMax":0.0024367131447136864,"steps":[{"kind":"READ","substeps":["$1:r_reason_sk, $2:r_reason_desc","FROM reason"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.000812237714904562},{"readMsMax":"10","computeMsMax":"15","waitMsAvg":"28","id":"1","endMs":"1570993635566","waitMsMax":"28","startMs":"1570993635350","waitRatioMax":0.003790442669554623,"readRatioAvg":0.0013537295248409367,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0020305942872614054,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"15","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0009476106673886557,"readMsAvg":"10","waitRatioAvg":0.003790442669554623,"completedParallelInputs":"1","computeRatioMax":0.0020305942872614054,"name":"S01: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.0013537295248409367,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $11:d_year","FROM date_dim","WHERE equal($11, 2001)"]},{"kind":"WRITE","substeps":["$10","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.0009476106673886557},{"readMsMax":"20","computeMsMax":"227","waitMsAvg":"48","id":"2","endMs":"1570993635697","waitMsMax":"48","startMs":"1570993635387","waitRatioMax":0.006497901719236496,"readRatioAvg":0.0027074590496818734,"parallelInputs":"1","recordsRead":"1000000","computeRatioAvg":0.030729660213889266,"writeMsAvg":"179","status":"COMPLETE","writeMsMax":"179","computeMsAvg":"227","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02423175849465277,"readMsAvg":"20","waitRatioAvg":0.006497901719236496,"completedParallelInputs":"1","computeRatioMax":0.030729660213889266,"name":"S02: Input","shuffleOutputBytes":"3603520","recordsWritten":"225220","readRatioMax":0.0027074590496818734,"steps":[{"kind":"READ","substeps":["$20:ca_address_sk, $21:ca_state, $22:ca_country","FROM customer_address","WHERE and(equal($22, 'United States'), or(in($21, 'KY', 'ME', 'IL'), in($21, 'OK', 'NE', 'MN'), in($21, 'FL', 'WI', 'KS')))"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.02423175849465277},{"readMsMax":"17","computeMsMax":"578","waitMsAvg":"39","id":"3","endMs":"1570993637168","waitMsMax":"39","startMs":"1570993635394","waitRatioMax":0.0052795451468796535,"readRatioAvg":0.0023013401922295927,"parallelInputs":"1","recordsRead":"1920800","computeRatioAvg":0.07824556653580615,"writeMsAvg":"1281","status":"COMPLETE","writeMsMax":"1281","computeMsAvg":"578","shuffleOutputBytesSpilled":"0","writeRatioMax":0.173412752132124,"readMsAvg":"17","waitRatioAvg":0.0052795451468796535,"completedParallelInputs":"1","computeRatioMax":0.07824556653580615,"name":"S03: Input","shuffleOutputBytes":"14982240","recordsWritten":"493920","readRatioMax":0.0023013401922295927,"steps":[{"kind":"READ","substeps":["$30:cd_demo_sk, $31:cd_marital_status, $32:cd_education_status","FROM customer_demographics","WHERE and(or(equal($32, 'Primary'), equal($32, 'Secondary'), equal($32, 'Advanced Degree')), ...)"]},{"kind":"WRITE","substeps":["$30, $31, $32","TO __stage03_output","BY HASH($30, $31, $32)"]}],"writeRatioAvg":0.173412752132124},{"readMsMax":"17","computeMsMax":"546","waitMsAvg":"22","id":"4","endMs":"1570993635820","waitMsMax":"22","startMs":"1570993635394","waitRatioMax":0.0029782049546500607,"readRatioAvg":0.0023013401922295927,"parallelInputs":"1","recordsRead":"1920800","computeRatioAvg":0.07391363205631515,"writeMsAvg":"145","status":"COMPLETE","writeMsMax":"145","computeMsAvg":"546","shuffleOutputBytesSpilled":"0","writeRatioMax":0.019629078110193585,"readMsAvg":"17","waitRatioAvg":0.0029782049546500607,"completedParallelInputs":"1","computeRatioMax":0.07391363205631515,"name":"S04: Input","shuffleOutputBytes":"14982240","recordsWritten":"493920","readRatioMax":0.0023013401922295927,"steps":[{"kind":"READ","substeps":["$50:cd_demo_sk, $51:cd_marital_status, $52:cd_education_status","FROM customer_demographics","WHERE and(or(equal($51, 'W'), equal($51, 'D'), equal($51, 'M')), ...)"]},{"kind":"WRITE","substeps":["$50, $51, $52","TO __stage04_output","BY HASH($50)"]}],"writeRatioAvg":0.019629078110193585},{"readMsMax":"19","computeMsMax":"10","waitMsAvg":"1","id":"5","endMs":"1570993635591","waitMsMax":"1","startMs":"1570993635480","waitRatioMax":0.0001353729524840937,"readRatioAvg":0.0025720860971977797,"parallelInputs":"1","recordsRead":"2040","computeRatioAvg":0.0013537295248409367,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003925815622038717,"readMsAvg":"19","waitRatioAvg":0.0001353729524840937,"completedParallelInputs":"1","computeRatioMax":0.0013537295248409367,"name":"S05: Input","shuffleOutputBytes":"18360","recordsWritten":"2040","readRatioMax":0.0025720860971977797,"steps":[{"kind":"READ","substeps":["$40:wp_web_page_sk","FROM web_page"]},{"kind":"WRITE","substeps":["$40","TO __stage05_output","BY HASH($40)"]}],"writeRatioAvg":0.003925815622038717},{"readMsMax":"124","computeMsMax":"312","waitMsAvg":"1","id":"7","endMs":"1570993635964","waitMsMax":"3","startMs":"1570993635546","waitRatioMax":0.000406118857452281,"readRatioAvg":0.007310139434141058,"parallelInputs":"92","recordsRead":"70474075","computeRatioAvg":0.0320833897387302,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"237","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003248950859618248,"readMsAvg":"54","waitRatioAvg":0.0001353729524840937,"completedParallelInputs":"92","computeRatioMax":0.04223636117503723,"name":"S07: Input","shuffleOutputBytes":"157796566","recordsWritten":"2504826","readRatioMax":0.016786246108027616,"steps":[{"kind":"READ","substeps":["$70:ws_sold_date_sk, $71:ws_item_sk, $72:ws_web_page_sk, $73:ws_order_number, $74:ws_quantity, $75:ws_sales_price, $76:ws_net_profit","FROM web_sales","WHERE and(or(between($75, 100, 150), between($75, 50, 100), between($75, 150, 200)), ...)"]},{"kind":"WRITE","substeps":["$70, $71, $72, $73, $74, $75, $76","TO __stage07_output","BY HASH($71, $73)"]}],"writeRatioAvg":0.0010829836198727495},{"readMsMax":"0","computeMsMax":"52","inputStages":["7"],"waitMsAvg":"1","id":"8","endMs":"1570993638232","waitMsMax":"4","startMs":"1570993635994","waitRatioMax":0.0005414918099363748,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2504826","computeRatioAvg":0.005550291051847841,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"83","computeMsAvg":"41","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011235955056179775,"readMsAvg":"0","waitRatioAvg":0.0001353729524840937,"completedParallelInputs":"100","computeRatioMax":0.007039393529172871,"name":"S08: Coalesce","shuffleOutputBytes":"157796566","recordsWritten":"2504826","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage07_output"]}],"writeRatioAvg":0.003384323812102342},{"readMsMax":"91","computeMsMax":"7387","inputStages":["5","8"],"waitMsAvg":"4","id":"9","endMs":"1570993645016","waitMsMax":"4","startMs":"1570993636021","waitRatioMax":0.0005414918099363748,"readRatioAvg":0.009340733721402464,"parallelInputs":"3","recordsRead":"14569036","computeRatioAvg":0.9558684174901855,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"40","computeMsAvg":"7061","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005414918099363747,"readMsAvg":"69","waitRatioAvg":0.0005414918099363748,"completedParallelInputs":"3","computeRatioMax":1,"name":"S09: Join","shuffleOutputBytes":"21273262","recordsWritten":"238891","readRatioMax":0.012318938676052524,"steps":[{"kind":"READ","substeps":["$60:wr_item_sk, $61:wr_refunded_cdemo_sk, $62:wr_refunded_addr_sk, $63:wr_returning_cdemo_sk, $64:wr_reason_sk, $65:wr_order_number, $66:wr_fee, $67:wr_refunded_cash","FROM web_returns"]},{"kind":"READ","substeps":["$70, $71, $72, $73, $74, $75, $76","FROM __stage08_output"]},{"kind":"READ","substeps":["$40","FROM __stage05_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $111 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $60 = $71, $65 = $73"]},{"kind":"WRITE","substeps":["$130, $131, $132, $133, $134, $135, $136, $137, $138, $139","TO __stage09_output","BY HASH($130)"]}],"writeRatioAvg":0.0029782049546500607},{"readMsMax":"0","computeMsMax":"11","inputStages":["2"],"waitMsAvg":"1","id":"10","endMs":"1570993646110","waitMsMax":"3","startMs":"1570993645869","waitRatioMax":0.000406118857452281,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"225220","computeRatioAvg":0.0009476106673886557,"writeMsAvg":"117","status":"COMPLETE","writeMsMax":"155","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02098280763503452,"readMsAvg":"0","waitRatioAvg":0.0001353729524840937,"completedParallelInputs":"100","computeRatioMax":0.0014891024773250304,"name":"S0A: Coalesce","shuffleOutputBytes":"3603520","recordsWritten":"225220","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage02_output"]}],"writeRatioAvg":0.01583863544063896},{"readMsMax":"0","computeMsMax":"957","inputStages":["0","1","10","3","4","9"],"waitMsAvg":"2","id":"11","endMs":"1570993646610","waitMsMax":"4","startMs":"1570993645999","waitRatioMax":0.0005414918099363748,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"72687986","computeRatioAvg":0.09733315283606335,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"719","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0029782049546500607,"readMsAvg":"0","waitRatioAvg":0.0002707459049681874,"completedParallelInputs":"100","computeRatioMax":0.12955191552727766,"name":"S0B: Join+","shuffleOutputBytes":"10760","recordsWritten":"163","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$130, $131, $132, $133, $134, $135, $136, $137, $138, $139","FROM __stage09_output"]},{"kind":"READ","substeps":["$50, $51, $52","FROM __stage04_output"]},{"kind":"READ","substeps":["$30, $31, $32","FROM __stage03_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage0A_output"]},{"kind":"READ","substeps":["$10","FROM __stage01_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $223","$100 := SHARD_AVG($222)","$101 := SHARD_AVG($221)","$102 := SHARD_AVG($220)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $210 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $193 = $10"]},{"kind":"FILTER","substeps":["or(and(in($196, 'KY', 'ME', 'IL'), between($195, 100, 200)), and(in($196, 'OK', 'NE', 'MN'), between($195, 150, 300)), ...)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $170 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $151 = $30, $159 = $31, $160 = $32"]},{"kind":"FILTER","substeps":["or(and(equal($159, 'W'), equal($160, 'Primary'), between($157, 100, 150)), ...)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH EACH ON $130 = $50"]},{"kind":"WRITE","substeps":["$230, $100, $101, $102","TO __stage0B_output","BY HASH($230)"]}],"writeRatioAvg":0.000812237714904562},{"readMsMax":"0","computeMsMax":"5","inputStages":["11"],"waitMsAvg":"1","id":"12","endMs":"1570993646812","waitMsMax":"1","startMs":"1570993646614","waitRatioMax":0.0001353729524840937,"readRatioAvg":0,"parallelInputs":"9","recordsRead":"163","computeRatioAvg":0.0005414918099363748,"writeMsAvg":"161","status":"COMPLETE","writeMsMax":"187","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02531474211452552,"readMsAvg":"0","waitRatioAvg":0.0001353729524840937,"completedParallelInputs":"9","computeRatioMax":0.0006768647624204683,"name":"S0C: Sort+","shuffleOutputBytes":"2256","recordsWritten":"51","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$230, $100, $101, $102","FROM __stage0B_output"]},{"kind":"SORT","substeps":["$80 ASC, $90 ASC, $91 ASC, $92 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$80 := substr($240, 1, 20)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230","$90 := ROOT_AVG($100)","$91 := ROOT_AVG($101)","$92 := ROOT_AVG($102)"]},{"kind":"WRITE","substeps":["$250, $251, $252, $253","TO __stage0C_output"]}],"writeRatioAvg":0.021795045349939084},{"readMsMax":"0","computeMsMax":"4","inputStages":["12"],"waitMsAvg":"1","id":"13","endMs":"1570993646821","waitMsMax":"1","startMs":"1570993646671","waitRatioMax":0.0001353729524840937,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"51","computeRatioAvg":0.0005414918099363748,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0006768647624204683,"readMsAvg":"0","waitRatioAvg":0.0001353729524840937,"completedParallelInputs":"1","computeRatioMax":0.0005414918099363748,"name":"S0D: Output","shuffleOutputBytes":"2256","recordsWritten":"51","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$250, $251, $252, $253","FROM __stage0C_output"]},{"kind":"SORT","substeps":["$250 ASC, $251 ASC, $252 ASC, $253 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$260, $261, $262, $263","TO __stage0D_output"]}],"writeRatioAvg":0.0006768647624204683}],"estimatedBytesProcessed":"4452789674","timeline":[{"totalSlotMs":"22093","activeUnits":"13","completedUnits":"92","elapsedMs":"742","pendingUnits":"9"},{"totalSlotMs":"32106","activeUnits":"103","completedUnits":"98","elapsedMs":"1247","pendingUnits":"103"},{"totalSlotMs":"154742","activeUnits":"53","completedUnits":"179","elapsedMs":"3114","pendingUnits":"22"},{"totalSlotMs":"157654","activeUnits":"3","completedUnits":"198","elapsedMs":"3616","pendingUnits":"3"},{"totalSlotMs":"178195","activeUnits":"0","completedUnits":"201","elapsedMs":"10028","pendingUnits":"0"},{"totalSlotMs":"259717","activeUnits":"92","completedUnits":"411","elapsedMs":"11924","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"4453302272","totalPartitionsProcessed":"0","totalBytesProcessed":"4452789674","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_returns","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"reason","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_page","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer_demographics","datasetId":"scale_100"}]},"endTime":"1570993647030"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query85_1570993632"},"etag":"pIehS4S1u1z80boj9AqJow==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query85_1570993632?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonf8202a20932246c4ca5545842e10863e5ac40538","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query85\nSELECT Substr(r_reason_desc, 1, 20), \n Avg(ws_quantity), \n Avg(wr_refunded_cash), \n Avg(wr_fee) \nFROM web_sales, \n web_returns, \n web_page, \n customer_demographics cd1, \n customer_demographics cd2, \n customer_address, \n date_dim, \n reason \nWHERE ws_web_page_sk = wp_web_page_sk \n AND ws_item_sk = wr_item_sk \n AND ws_order_number = wr_order_number \n AND ws_sold_date_sk = d_date_sk \n AND d_year = 2001 \n AND cd1.cd_demo_sk = wr_refunded_cdemo_sk \n AND cd2.cd_demo_sk = wr_returning_cdemo_sk \n AND ca_address_sk = wr_refunded_addr_sk \n AND r_reason_sk = wr_reason_sk \n AND ( ( cd1.cd_marital_status = 'W' \n AND cd1.cd_marital_status = cd2.cd_marital_status \n AND cd1.cd_education_status = 'Primary' \n AND cd1.cd_education_status = cd2.cd_education_status \n AND ws_sales_price BETWEEN 100.00 AND 150.00 ) \n OR ( cd1.cd_marital_status = 'D' \n AND cd1.cd_marital_status = cd2.cd_marital_status \n AND cd1.cd_education_status = 'Secondary' \n AND cd1.cd_education_status = cd2.cd_education_status \n AND ws_sales_price BETWEEN 50.00 AND 100.00 ) \n OR ( cd1.cd_marital_status = 'M' \n AND cd1.cd_marital_status = cd2.cd_marital_status \n AND cd1.cd_education_status = 'Advanced Degree' \n AND cd1.cd_education_status = cd2.cd_education_status \n AND ws_sales_price BETWEEN 150.00 AND 200.00 ) ) \n AND ( ( ca_country = 'United States' \n AND ca_state IN ( 'KY', 'ME', 'IL' ) \n AND ws_net_profit BETWEEN 100 AND 200 ) \n OR ( ca_country = 'United States' \n AND ca_state IN ( 'OK', 'NE', 'MN' ) \n AND ws_net_profit BETWEEN 150 AND 300 ) \n OR ( ca_country = 'United States' \n AND ca_state IN ( 'FL', 'WI', 'KS' ) \n AND ws_net_profit BETWEEN 50 AND 250 ) ) \nGROUP BY r_reason_desc \nORDER BY Substr(r_reason_desc, 1, 20), \n Avg(ws_quantity), \n Avg(wr_refunded_cash), \n Avg(wr_fee)\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query85_1570993632","user_email":"nithish.sankaranarayanan@ulb.be"}
