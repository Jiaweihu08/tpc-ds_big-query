{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"245906","creationTime":"1570971529632","totalBytesProcessed":"1926969588","startTime":"1570971529802","query":{"totalSlotMs":"245906","queryPlan":[{"readMsMax":"31","computeMsMax":"287","waitMsAvg":"1","id":"0","endMs":"1570971531805","waitMsMax":"1","startMs":"1570971530073","waitRatioMax":0.00012025012025012025,"readRatioAvg":0.003727753727753728,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.034511784511784514,"writeMsAvg":"262","status":"COMPLETE","writeMsMax":"262","computeMsAvg":"287","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03150553150553151,"readMsAvg":"31","waitRatioAvg":0.00012025012025012025,"completedParallelInputs":"1","computeRatioMax":0.034511784511784514,"name":"S00: Input","shuffleOutputBytes":"13796356","recordsWritten":"102000","readRatioMax":0.003727753727753728,"steps":[{"kind":"READ","substeps":["$1:i_item_sk, $2:i_item_id, $3:i_item_desc","FROM item"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.03150553150553151},{"readMsMax":"15","computeMsMax":"5","waitMsAvg":"21","id":"1","endMs":"1570971530284","waitMsMax":"21","startMs":"1570971530114","waitRatioMax":0.0025252525252525255,"readRatioAvg":0.0018037518037518038,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.0006012506012506013,"writeMsAvg":"147","status":"COMPLETE","writeMsMax":"147","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.017676767676767676,"readMsAvg":"15","waitRatioAvg":0.0025252525252525255,"completedParallelInputs":"1","computeRatioMax":0.0006012506012506013,"name":"S01: Input","shuffleOutputBytes":"1632","recordsWritten":"102","readRatioMax":0.0018037518037518038,"steps":[{"kind":"READ","substeps":["$10:s_store_sk, $11:s_state","FROM store"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.017676767676767676},{"readMsMax":"11","computeMsMax":"8","waitMsAvg":"43","id":"2","endMs":"1570971530366","waitMsMax":"43","startMs":"1570971530158","waitRatioMax":0.00517075517075517,"readRatioAvg":0.0013227513227513227,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.000962000962000962,"writeMsAvg":"185","status":"COMPLETE","writeMsMax":"185","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.022246272246272247,"readMsAvg":"11","waitRatioAvg":0.00517075517075517,"completedParallelInputs":"1","computeRatioMax":0.000962000962000962,"name":"S02: Input","shuffleOutputBytes":"2466","recordsWritten":"274","readRatioMax":0.0013227513227513227,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_quarter_name","FROM date_dim","WHERE in($21, '1999Q1', '1999Q2', '1999Q3')"]},{"kind":"WRITE","substeps":["$20","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.022246272246272247},{"readMsMax":"14","computeMsMax":"8","waitMsAvg":"68","id":"3","endMs":"1570971530384","waitMsMax":"68","startMs":"1570971530201","waitRatioMax":0.008177008177008177,"readRatioAvg":0.0016835016835016834,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.000962000962000962,"writeMsAvg":"158","status":"COMPLETE","writeMsMax":"158","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.018999518999519,"readMsAvg":"14","waitRatioAvg":0.008177008177008177,"completedParallelInputs":"1","computeRatioMax":0.000962000962000962,"name":"S03: Input","shuffleOutputBytes":"2466","recordsWritten":"274","readRatioMax":0.0016835016835016834,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_quarter_name","FROM date_dim","WHERE in($31, '1999Q1', '1999Q2', '1999Q3')"]},{"kind":"WRITE","substeps":["$30","TO __stage03_output","BY HASH($30)"]}],"writeRatioAvg":0.018999518999519},{"readMsMax":"7","computeMsMax":"8","waitMsAvg":"56","id":"4","endMs":"1570971530346","waitMsMax":"56","startMs":"1570971530209","waitRatioMax":0.006734006734006734,"readRatioAvg":0.0008417508417508417,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.000962000962000962,"writeMsAvg":"69","status":"COMPLETE","writeMsMax":"69","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008297258297258298,"readMsAvg":"7","waitRatioAvg":0.006734006734006734,"completedParallelInputs":"1","computeRatioMax":0.000962000962000962,"name":"S04: Input","shuffleOutputBytes":"819","recordsWritten":"91","readRatioMax":0.0008417508417508417,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_quarter_name","FROM date_dim","WHERE equal($51, '1999Q1')"]},{"kind":"WRITE","substeps":["$50","TO __stage04_output","BY HASH($50)"]}],"writeRatioAvg":0.008297258297258298},{"readMsMax":"172","computeMsMax":"5743","waitMsAvg":"11","id":"6","endMs":"1570971533576","waitMsMax":"11","startMs":"1570971530292","waitRatioMax":0.0013227513227513227,"readRatioAvg":0.02068302068302068,"parallelInputs":"1","recordsRead":"2878330","computeRatioAvg":0.6905964405964405,"writeMsAvg":"39","status":"COMPLETE","writeMsMax":"39","computeMsAvg":"5743","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00468975468975469,"readMsAvg":"172","waitRatioAvg":0.0013227513227513227,"completedParallelInputs":"1","computeRatioMax":0.6905964405964405,"name":"S06: Input","shuffleOutputBytes":"124157137","recordsWritten":"2776885","readRatioMax":0.02068302068302068,"steps":[{"kind":"READ","substeps":["$70:sr_returned_date_sk, $71:sr_item_sk, $72:sr_customer_sk, $73:sr_ticket_number, $74:sr_return_quantity","FROM store_returns"]},{"kind":"WRITE","substeps":["$70, $71, $72, $73, $74","TO __stage06_output","BY HASH($72, $71, $73)"]}],"writeRatioAvg":0.00468975468975469},{"readMsMax":"0","computeMsMax":"45","inputStages":["6"],"waitMsAvg":"4","id":"8","endMs":"1570971534039","waitMsMax":"9","startMs":"1570971533729","waitRatioMax":0.0010822510822510823,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2776885","computeRatioAvg":0.004088504088504088,"writeMsAvg":"41","status":"COMPLETE","writeMsMax":"72","computeMsAvg":"34","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008658008658008658,"readMsAvg":"0","waitRatioAvg":0.000481000481000481,"completedParallelInputs":"100","computeRatioMax":0.005411255411255411,"name":"S08: Coalesce","shuffleOutputBytes":"124157137","recordsWritten":"2776885","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage06_output"]}],"writeRatioAvg":0.004930254930254931},{"readMsMax":"86","computeMsMax":"8316","inputStages":["8"],"waitMsAvg":"2","id":"9","endMs":"1570971538777","waitMsMax":"2","startMs":"1570971533759","waitRatioMax":0.0002405002405002405,"readRatioAvg":0.005651755651755652,"parallelInputs":"10","recordsRead":"56570962","computeRatioAvg":0.8330928330928331,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"6928","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003487253487253487,"readMsAvg":"47","waitRatioAvg":0.0002405002405002405,"completedParallelInputs":"10","computeRatioMax":1,"name":"S09: Join","shuffleOutputBytes":"149094648","recordsWritten":"2095625","readRatioMax":0.01034151034151034,"steps":[{"kind":"READ","substeps":["$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_customer_sk, $63:ss_store_sk, $64:ss_ticket_number, $65:ss_quantity","FROM store_sales"]},{"kind":"READ","substeps":["$70, $71, $72, $73, $74","FROM __stage08_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $62 = $72, $61 = $71, $64 = $73"]},{"kind":"WRITE","substeps":["$120, $121, $122, $123, $124, $125, $126, $127","TO __stage09_output","BY HASH($126, $125)"]}],"writeRatioAvg":0.0025252525252525255},{"readMsMax":"0","computeMsMax":"43","inputStages":["9"],"waitMsAvg":"1","id":"10","endMs":"1570971539578","waitMsMax":"3","startMs":"1570971538895","waitRatioMax":0.00036075036075036075,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2095625","computeRatioAvg":0.003848003848003848,"writeMsAvg":"257","status":"COMPLETE","writeMsMax":"653","computeMsAvg":"32","shuffleOutputBytesSpilled":"0","writeRatioMax":0.07852332852332852,"readMsAvg":"0","waitRatioAvg":0.00012025012025012025,"completedParallelInputs":"100","computeRatioMax":0.00517075517075517,"name":"S0A: Coalesce","shuffleOutputBytes":"149094648","recordsWritten":"2095625","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage09_output"]}],"writeRatioAvg":0.030904280904280903},{"readMsMax":"38","computeMsMax":"5599","inputStages":["1","2","3","0","4","10"],"waitMsAvg":"1","id":"11","endMs":"1570971542309","waitMsMax":"1","startMs":"1570971539049","waitRatioMax":0.00012025012025012025,"readRatioAvg":0.003848003848003848,"parallelInputs":"8","recordsRead":"31473193","computeRatioAvg":0.6167628667628667,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"70","computeMsAvg":"5129","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008417508417508417,"readMsAvg":"32","waitRatioAvg":0.00012025012025012025,"completedParallelInputs":"8","computeRatioMax":0.6732804232804233,"name":"S0B: Join+","shuffleOutputBytes":"799","recordsWritten":"3","readRatioMax":0.00456950456950457,"steps":[{"kind":"READ","substeps":["$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_quantity","FROM catalog_sales"]},{"kind":"READ","substeps":["$120, $121, $122, $123, $124, $125, $126, $127","FROM __stage0A_output"]},{"kind":"READ","substeps":["$50","FROM __stage04_output"]},{"kind":"READ","substeps":["$30","FROM __stage03_output"]},{"kind":"READ","substeps":["$20","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage01_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $210 := $204, $211 := $205, $212 := $200","$100 := COUNT($202)","$101 := VAR_POP($110)","$102 := SHARD_AVG($202)","$103 := COUNT($203)","$104 := VAR_POP($111)","$105 := SHARD_AVG($203)","$106 := COUNT($201)","$107 := VAR_POP($112)","$108 := SHARD_AVG($201)"]},{"kind":"COMPUTE","substeps":["$110 := CAST($202 AS DOUBLE)","$111 := CAST($203 AS DOUBLE)","$112 := CAST($201 AS DOUBLE)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $191 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $182 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $170 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $155 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $130 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $41 = $126, $42 = $125"]},{"kind":"WRITE","substeps":["$210, $211, $212, $100, $101, $102, $103, $104, $105, $106, $107, $108","TO __stage0B_output","BY HASH($210, $211, $212)"]}],"writeRatioAvg":0.001443001443001443},{"readMsMax":"0","computeMsMax":"8","inputStages":["11"],"waitMsAvg":"1","id":"12","endMs":"1570971542621","waitMsMax":"1","startMs":"1570971542419","waitRatioMax":0.00012025012025012025,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"3","computeRatioAvg":0.000962000962000962,"writeMsAvg":"174","status":"COMPLETE","writeMsMax":"174","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.020923520923520924,"readMsAvg":"0","waitRatioAvg":0.00012025012025012025,"completedParallelInputs":"1","computeRatioMax":0.000962000962000962,"name":"S0C: Sort+","shuffleOutputBytes":"526","recordsWritten":"3","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$210, $211, $212, $100, $101, $102, $103, $104, $105, $106, $107, $108","FROM __stage0B_output"]},{"kind":"COMPUTE","substeps":["$80 := divide($234, $235)","$81 := divide($237, $238)","$82 := divide($240, $241)"]},{"kind":"SORT","substeps":["$220 ASC, $221 ASC, $222 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $220 := $210, $221 := $211, $222 := $212","$90 := SUM_OF_COUNTS($100)","$91 := ROOT_STDDEV_SAMP($101)","$92 := ROOT_AVG($102)","$93 := SUM_OF_COUNTS($103)","$94 := ROOT_STDDEV_SAMP($104)","$95 := ROOT_AVG($105)","$96 := SUM_OF_COUNTS($106)","$97 := ROOT_STDDEV_SAMP($107)","$98 := ROOT_AVG($108)"]},{"kind":"WRITE","substeps":["$230, $231, $232, $80, $81, $82, $233, $234, $235, $236, $237, $238, $239, $241","TO __stage0C_output"]}],"writeRatioAvg":0.020923520923520924},{"readMsMax":"0","computeMsMax":"6","inputStages":["12"],"waitMsAvg":"1","id":"13","endMs":"1570971542668","waitMsMax":"1","startMs":"1570971542461","waitRatioMax":0.00012025012025012025,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"3","computeRatioAvg":0.0007215007215007215,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007215007215007215,"readMsAvg":"0","waitRatioAvg":0.00012025012025012025,"completedParallelInputs":"1","computeRatioMax":0.0007215007215007215,"name":"S0D: Output","shuffleOutputBytes":"526","recordsWritten":"3","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$230, $231, $232, $80, $81, $82, $233, $234, $235, $236, $237, $238, $239, $241","FROM __stage0C_output"]},{"kind":"SORT","substeps":["$230 ASC, $231 ASC, $232 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$250, $251, $252, $253, $254, $255, $256, $257, $258, $259, $260, $261, $262, $263","TO __stage0D_output"]}],"writeRatioAvg":0.0007215007215007215}],"estimatedBytesProcessed":"1926969588","timeline":[{"totalSlotMs":"3057","activeUnits":"20","completedUnits":"4","elapsedMs":"773","pendingUnits":"20"},{"totalSlotMs":"55723","activeUnits":"11","completedUnits":"13","elapsedMs":"2130","pendingUnits":"11"},{"totalSlotMs":"89974","activeUnits":"93","completedUnits":"31","elapsedMs":"4133","pendingUnits":"93"},{"totalSlotMs":"109650","activeUnits":"10","completedUnits":"114","elapsedMs":"4635","pendingUnits":"10"},{"totalSlotMs":"162234","activeUnits":"6","completedUnits":"123","elapsedMs":"8475","pendingUnits":"1"},{"totalSlotMs":"212033","activeUnits":"74","completedUnits":"216","elapsedMs":"9982","pendingUnits":"8"},{"totalSlotMs":"245906","activeUnits":"4","completedUnits":"226","elapsedMs":"13035","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"1927282688","totalPartitionsProcessed":"0","totalBytesProcessed":"1926969588","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_10"}]},"endTime":"1570971542872"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query17_1570971527"},"etag":"SeU1SZvn6pLDXyvWzDHPVw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query17_1570971527?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon8de4e2eea1a2dec326be2e5493b6f73b82233665","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query17\nSELECT i_item_id, \n i_item_desc, \n s_state, \n Count(ss_quantity) AS \n store_sales_quantitycount, \n Avg(ss_quantity) AS \n store_sales_quantityave, \n Stddev_samp(ss_quantity) AS \n store_sales_quantitystdev, \n Stddev_samp(ss_quantity) / Avg(ss_quantity) AS \n store_sales_quantitycov, \n Count(sr_return_quantity) AS \n store_returns_quantitycount, \n Avg(sr_return_quantity) AS \n store_returns_quantityave, \n Stddev_samp(sr_return_quantity) AS \n store_returns_quantitystdev, \n Stddev_samp(sr_return_quantity) / Avg(sr_return_quantity) AS \n store_returns_quantitycov, \n Count(cs_quantity) AS \n catalog_sales_quantitycount, \n Avg(cs_quantity) AS \n catalog_sales_quantityave, \n Stddev_samp(cs_quantity) / Avg(cs_quantity) AS \n catalog_sales_quantitystdev, \n Stddev_samp(cs_quantity) / Avg(cs_quantity) AS \n catalog_sales_quantitycov \nFROM store_sales, \n store_returns, \n catalog_sales, \n date_dim d1, \n date_dim d2, \n date_dim d3, \n store, \n item \nWHERE d1.d_quarter_name = '1999Q1' \n AND d1.d_date_sk = ss_sold_date_sk \n AND i_item_sk = ss_item_sk \n AND s_store_sk = ss_store_sk \n AND ss_customer_sk = sr_customer_sk \n AND ss_item_sk = sr_item_sk \n AND ss_ticket_number = sr_ticket_number \n AND sr_returned_date_sk = d2.d_date_sk \n AND d2.d_quarter_name IN ( '1999Q1', '1999Q2', '1999Q3' ) \n AND sr_customer_sk = cs_bill_customer_sk \n AND sr_item_sk = cs_item_sk \n AND cs_sold_date_sk = d3.d_date_sk \n AND d3.d_quarter_name IN ( '1999Q1', '1999Q2', '1999Q3' ) \nGROUP BY i_item_id, \n i_item_desc, \n s_state \nORDER BY i_item_id, \n i_item_desc, \n s_state\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query17_1570971527","user_email":"nithish.sankaranarayanan@ulb.be"}
