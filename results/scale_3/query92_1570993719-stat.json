{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"225590","creationTime":"1570993721432","totalBytesProcessed":"1695816340","startTime":"1570993721542","query":{"totalSlotMs":"225590","queryPlan":[{"readMsMax":"15","computeMsMax":"19","waitMsAvg":"3","id":"0","endMs":"1570993721824","waitMsMax":"3","startMs":"1570993721774","waitRatioMax":0.0018170805572380376,"readRatioAvg":0.009085402786190187,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.01150817686250757,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0036341611144760752,"readMsAvg":"15","waitRatioAvg":0.0018170805572380376,"completedParallelInputs":"1","computeRatioMax":0.01150817686250757,"name":"S00: Input","shuffleOutputBytes":"828","recordsWritten":"92","readRatioMax":0.009085402786190187,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $11:d_date","FROM date_dim","WHERE between(CAST($11 AS DATE), 11775, 11866)"]},{"kind":"WRITE","substeps":["$10","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.0036341611144760752},{"readMsMax":"13","computeMsMax":"19","waitMsAvg":"40","id":"2","endMs":"1570993722025","waitMsMax":"40","startMs":"1570993721877","waitRatioMax":0.024227740763173834,"readRatioAvg":0.007874015748031496,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.01150817686250757,"writeMsAvg":"80","status":"COMPLETE","writeMsMax":"80","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04845548152634767,"readMsAvg":"13","waitRatioAvg":0.024227740763173834,"completedParallelInputs":"1","computeRatioMax":0.01150817686250757,"name":"S02: Input","shuffleOutputBytes":"828","recordsWritten":"92","readRatioMax":0.007874015748031496,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_date","FROM date_dim","WHERE between(CAST($31 AS DATE), 11775, 11866)"]},{"kind":"WRITE","substeps":["$30","TO __stage02_output","BY HASH($30)"]}],"writeRatioAvg":0.04845548152634767},{"readMsMax":"15","computeMsMax":"12","waitMsAvg":"5","id":"3","endMs":"1570993722032","waitMsMax":"5","startMs":"1570993721931","waitRatioMax":0.0030284675953967293,"readRatioAvg":0.009085402786190187,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.0072683222289521504,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"28","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.016959418534221685,"readMsAvg":"15","waitRatioAvg":0.0030284675953967293,"completedParallelInputs":"1","computeRatioMax":0.0072683222289521504,"name":"S03: Input","shuffleOutputBytes":"432","recordsWritten":"48","readRatioMax":0.009085402786190187,"steps":[{"kind":"READ","substeps":["$40:i_item_sk, $41:i_manufact_id","FROM item","WHERE equal($41, 718)"]},{"kind":"WRITE","substeps":["$40","TO __stage03_output","BY HASH($40)"]}],"writeRatioAvg":0.016959418534221685},{"readMsMax":"97","computeMsMax":"205","inputStages":["0"],"waitMsAvg":"19","id":"5","endMs":"1570993722278","waitMsMax":"22","startMs":"1570993721992","waitRatioMax":0.013325257419745608,"readRatioAvg":0.01756511205330103,"parallelInputs":"92","recordsRead":"70482539","computeRatioAvg":0.09630526953361598,"writeMsAvg":"90","status":"COMPLETE","writeMsMax":"145","computeMsAvg":"159","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08782556026650515,"readMsAvg":"29","waitRatioAvg":0.01150817686250757,"completedParallelInputs":"92","computeRatioMax":0.1241671714112659,"name":"S05: Join","shuffleOutputBytes":"37002388","recordsWritten":"2055798","readRatioMax":0.05875227135069655,"steps":[{"kind":"READ","substeps":["$1:ws_sold_date_sk, $2:ws_item_sk, $3:ws_ext_discount_amt","FROM web_sales"]},{"kind":"READ","substeps":["$10","FROM __stage00_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $10"]},{"kind":"WRITE","substeps":["$120, $121","TO __stage05_output","BY HASH($120)"]}],"writeRatioAvg":0.054512416717141125},{"readMsMax":"0","computeMsMax":"30","inputStages":["5"],"waitMsAvg":"2","id":"6","endMs":"1570993722606","waitMsMax":"5","startMs":"1570993722284","waitRatioMax":0.0030284675953967293,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2055798","computeRatioAvg":0.01150817686250757,"writeMsAvg":"51","status":"COMPLETE","writeMsMax":"116","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.07026044821320412,"readMsAvg":"0","waitRatioAvg":0.0012113870381586917,"completedParallelInputs":"100","computeRatioMax":0.018170805572380374,"name":"S06: Coalesce","shuffleOutputBytes":"37002388","recordsWritten":"2055798","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage05_output"]}],"writeRatioAvg":0.030890369473046637},{"readMsMax":"84","computeMsMax":"1651","inputStages":["6","2","3"],"waitMsAvg":"2","id":"7","endMs":"1570993724056","waitMsMax":"4","startMs":"1570993722315","waitRatioMax":0.0024227740763173833,"readRatioAvg":0.016959418534221685,"parallelInputs":"92","recordsRead":"257564573","computeRatioAvg":0.8237431859479104,"writeMsAvg":"582","status":"COMPLETE","writeMsMax":"1183","computeMsAvg":"1360","shuffleOutputBytesSpilled":"0","writeRatioMax":0.7165354330708661,"readMsAvg":"28","waitRatioAvg":0.0012113870381586917,"completedParallelInputs":"92","computeRatioMax":1,"name":"S07: Join+","shuffleOutputBytes":"26451","recordsWritten":"465","readRatioMax":0.050878255602665054,"steps":[{"kind":"READ","substeps":["$20:ws_sold_date_sk, $21:ws_item_sk, $22:ws_ext_discount_amt","FROM web_sales"]},{"kind":"READ","substeps":["$40","FROM __stage03_output"]},{"kind":"READ","substeps":["$30","FROM __stage02_output"]},{"kind":"READ","substeps":["$120, $121","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $140 := $131","$80 := SHARD_AVG($132)","$81 := ANY_VALUE($130)"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $111 = $120"]},{"kind":"COMPUTE","substeps":["$90 := UNIQUE_ROW_ID()"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $100 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $21 = $40"]},{"kind":"WRITE","substeps":["$80, $81, $140","TO __stage07_output","BY HASH($140)"]}],"writeRatioAvg":0.3525136281041793},{"readMsMax":"0","computeMsMax":"6","inputStages":["7"],"waitMsAvg":"16","id":"8","endMs":"1570993724340","waitMsMax":"18","startMs":"1570993724073","waitRatioMax":0.010902483343428226,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"465","computeRatioAvg":0.0030284675953967293,"writeMsAvg":"45","status":"COMPLETE","writeMsMax":"65","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03937007874015748,"readMsAvg":"0","waitRatioAvg":0.009691096305269533,"completedParallelInputs":"18","computeRatioMax":0.0036341611144760752,"name":"S08: Aggregate+","shuffleOutputBytes":"162","recordsWritten":"18","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$80, $81, $140","FROM __stage07_output"]},{"kind":"AGGREGATE","substeps":["$60 := SUM($71)"]},{"kind":"FILTER","substeps":["greater($71, multiply(1.3, $70))"]},{"kind":"AGGREGATE","substeps":["GROUP BY $150 := $140","$70 := ROOT_AVG($80)","$71 := ANY_VALUE($81)"]},{"kind":"WRITE","substeps":["$60","TO __stage08_output"]}],"writeRatioAvg":0.027256208358570563},{"readMsMax":"0","computeMsMax":"8","inputStages":["8"],"waitMsAvg":"6","id":"9","endMs":"1570993724345","waitMsMax":"6","startMs":"1570993724108","waitRatioMax":0.0036341611144760752,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"18","computeRatioAvg":0.004845548152634767,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0030284675953967293,"readMsAvg":"0","waitRatioAvg":0.0036341611144760752,"completedParallelInputs":"1","computeRatioMax":0.004845548152634767,"name":"S09: Output","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$60","FROM __stage08_output"]},{"kind":"SORT","substeps":["$50 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["$50 := SUM($60)"]},{"kind":"WRITE","substeps":["$160","TO __stage09_output"]}],"writeRatioAvg":0.0030284675953967293}],"estimatedBytesProcessed":"1695816340","timeline":[{"totalSlotMs":"28002","activeUnits":"2","completedUnits":"94","elapsedMs":"732","pendingUnits":"1"},{"totalSlotMs":"75384","activeUnits":"92","completedUnits":"195","elapsedMs":"1238","pendingUnits":"92"},{"totalSlotMs":"225590","activeUnits":"4","completedUnits":"306","elapsedMs":"2985","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"1696595968","totalPartitionsProcessed":"0","totalBytesProcessed":"1695816340","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_100"}]},"endTime":"1570993724548"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query92_1570993719"},"etag":"I+2xOOYmt73/c/3ZDjATSw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query92_1570993719?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon5ff82abc354477dc09d5e04589cc25c552c366e3","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query92\nSELECT \n Sum(ws_ext_discount_amt) AS excess_discount_amount\nFROM web_sales , \n item , \n date_dim \nWHERE i_manufact_id = 718 \nAND i_item_sk = ws_item_sk \nAND Cast(d_date AS DATE) BETWEEN Cast('2002-03-29' AS DATE) AND ( \n Cast('2002-06-28' AS DATE)) \nAND d_date_sk = ws_sold_date_sk \nAND ws_ext_discount_amt > \n ( \n SELECT 1.3 benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results scale_2.zip warmup avg(ws_ext_discount_amt) \n FROM web_sales , \n date_dim \n WHERE ws_item_sk = i_item_sk \n AND Cast(d_date AS DATE) BETWEEN Cast('2002-03-29' AS DATE) AND ( \n cast('2002-06-28' AS date)) \n AND d_date_sk = ws_sold_date_sk ) \nORDER BY sum(ws_ext_discount_amt) \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query92_1570993719","user_email":"nithish.sankaranarayanan@ulb.be"}
