{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"796951","creationTime":"1570992178371","totalBytesProcessed":"3491400204","startTime":"1570992178559","query":{"totalSlotMs":"796951","queryPlan":[{"readMsMax":"19","computeMsMax":"11","waitMsAvg":"1","id":"0","endMs":"1570992178912","waitMsMax":"1","startMs":"1570992178822","waitRatioMax":0.000213903743315508,"readRatioAvg":0.004064171122994653,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.002352941176470588,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0012834224598930481,"readMsAvg":"19","waitRatioAvg":0.000213903743315508,"completedParallelInputs":"1","computeRatioMax":0.002352941176470588,"name":"S00: Input","shuffleOutputBytes":"819","recordsWritten":"91","readRatioMax":0.004064171122994653,"steps":[{"kind":"READ","substeps":["$1:d_date_sk, $2:d_year, $3:d_qoy","FROM date_dim","WHERE and(equal($3, 1), equal($2, 1998))"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.0012834224598930481},{"readMsMax":"28","computeMsMax":"858","waitMsAvg":"28","id":"1","endMs":"1570992179367","waitMsMax":"28","startMs":"1570992178864","waitRatioMax":0.005989304812834224,"readRatioAvg":0.005989304812834224,"parallelInputs":"1","recordsRead":"1000000","computeRatioAvg":0.18352941176470589,"writeMsAvg":"48","status":"COMPLETE","writeMsMax":"48","computeMsAvg":"858","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010267379679144385,"readMsAvg":"28","waitRatioAvg":0.005989304812834224,"completedParallelInputs":"1","computeRatioMax":0.18352941176470589,"name":"S01: Input","shuffleOutputBytes":"25549784","recordsWritten":"1000000","readRatioMax":0.005989304812834224,"steps":[{"kind":"READ","substeps":["$10:ca_address_sk, $11:ca_state, $12:ca_zip","FROM customer_address"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.010267379679144385},{"readMsMax":"29","computeMsMax":"1554","waitMsAvg":"58","id":"2","endMs":"1570992179713","waitMsMax":"58","startMs":"1570992178908","waitRatioMax":0.012406417112299466,"readRatioAvg":0.006203208556149733,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.33240641711229946,"writeMsAvg":"69","status":"COMPLETE","writeMsMax":"69","computeMsAvg":"1554","shuffleOutputBytesSpilled":"0","writeRatioMax":0.014759358288770053,"readMsAvg":"29","waitRatioAvg":0.012406417112299466,"completedParallelInputs":"1","computeRatioMax":0.33240641711229946,"name":"S02: Input","shuffleOutputBytes":"36000000","recordsWritten":"2000000","readRatioMax":0.006203208556149733,"steps":[{"kind":"READ","substeps":["$30:c_customer_sk, $31:c_current_addr_sk","FROM customer"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage02_output","BY HASH($30)"]}],"writeRatioAvg":0.014759358288770053},{"readMsMax":"0","computeMsMax":"24","inputStages":["2"],"waitMsAvg":"3","id":"4","endMs":"1570992180400","waitMsMax":"11","startMs":"1570992179776","waitRatioMax":0.002352941176470588,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2000000","computeRatioAvg":0.0036363636363636364,"writeMsAvg":"49","status":"COMPLETE","writeMsMax":"149","computeMsAvg":"17","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03187165775401069,"readMsAvg":"0","waitRatioAvg":0.0006417112299465241,"completedParallelInputs":"100","computeRatioMax":0.0051336898395721925,"name":"S04: Coalesce","shuffleOutputBytes":"36000000","recordsWritten":"2000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage02_output"]}],"writeRatioAvg":0.010481283422459893},{"readMsMax":"0","computeMsMax":"22","inputStages":["1"],"waitMsAvg":"12","id":"5","endMs":"1570992179945","waitMsMax":"48","startMs":"1570992179776","waitRatioMax":0.010267379679144385,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1000000","computeRatioAvg":0.0025668449197860962,"writeMsAvg":"43","status":"COMPLETE","writeMsMax":"95","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.020320855614973262,"readMsAvg":"0","waitRatioAvg":0.0025668449197860962,"completedParallelInputs":"100","computeRatioMax":0.004705882352941176,"name":"S05: Coalesce","shuffleOutputBytes":"25549784","recordsWritten":"1000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage01_output"]}],"writeRatioAvg":0.009197860962566844},{"readMsMax":"1585","computeMsMax":"4675","inputStages":["0","5","4"],"waitMsAvg":"16","id":"6","endMs":"1570992184735","waitMsMax":"24","startMs":"1570992179827","waitRatioMax":0.0051336898395721925,"readRatioAvg":0.008342245989304813,"parallelInputs":"141","recordsRead":"567023282","computeRatioAvg":0.6866310160427808,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"70","computeMsAvg":"3210","shuffleOutputBytesSpilled":"0","writeRatioMax":0.014973262032085561,"readMsAvg":"39","waitRatioAvg":0.003422459893048128,"completedParallelInputs":"141","computeRatioMax":1,"name":"S06: Join+","shuffleOutputBytes":"57791","recordsWritten":"3044","readRatioMax":0.3390374331550802,"steps":[{"kind":"READ","substeps":["$20:cs_sold_date_sk, $21:cs_bill_customer_sk, $22:cs_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$30, $31","FROM __stage04_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage05_output"]},{"kind":"READ","substeps":["$1","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $100 := $90","$50 := SUM($91)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $70 = $1"]},{"kind":"FILTER","substeps":["or(in(substr($73, 1, 5), '85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792'), ...)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $62 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $21 = $30"]},{"kind":"WRITE","substeps":["$100, $50","TO __stage06_output","BY HASH($100)"]}],"writeRatioAvg":0.0010695187165775401},{"readMsMax":"0","computeMsMax":"8","inputStages":["6"],"waitMsAvg":"1","id":"7","endMs":"1570992184825","waitMsMax":"1","startMs":"1570992184738","waitRatioMax":0.000213903743315508,"readRatioAvg":0,"parallelInputs":"14","recordsRead":"3044","computeRatioAvg":0.000855614973262032,"writeMsAvg":"37","status":"COMPLETE","writeMsMax":"54","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011550802139037433,"readMsAvg":"0","waitRatioAvg":0.000213903743315508,"completedParallelInputs":"14","computeRatioMax":0.001711229946524064,"name":"S07: Sort+","shuffleOutputBytes":"18744","recordsWritten":"987","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$100, $50","FROM __stage06_output"]},{"kind":"SORT","substeps":["$110 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $110 := $100","$40 := SUM($50)"]},{"kind":"WRITE","substeps":["$120, $121","TO __stage07_output"]}],"writeRatioAvg":0.007914438502673796},{"readMsMax":"0","computeMsMax":"6","inputStages":["7"],"waitMsAvg":"1","id":"8","endMs":"1570992184835","waitMsMax":"1","startMs":"1570992184764","waitRatioMax":0.000213903743315508,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"987","computeRatioAvg":0.0012834224598930481,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0012834224598930481,"readMsAvg":"0","waitRatioAvg":0.000213903743315508,"completedParallelInputs":"1","computeRatioMax":0.0012834224598930481,"name":"S08: Output","shuffleOutputBytes":"1891","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$120, $121","FROM __stage07_output"]},{"kind":"SORT","substeps":["$120 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$130, $131","TO __stage08_output"]}],"writeRatioAvg":0.0012834224598930481}],"estimatedBytesProcessed":"3491400204","timeline":[{"totalSlotMs":"25189","activeUnits":"143","completedUnits":"1","elapsedMs":"763","pendingUnits":"143"},{"totalSlotMs":"260294","activeUnits":"337","completedUnits":"199","elapsedMs":"1823","pendingUnits":"145"},{"totalSlotMs":"361501","activeUnits":"141","completedUnits":"203","elapsedMs":"2322","pendingUnits":"141"},{"totalSlotMs":"758487","activeUnits":"35","completedUnits":"328","elapsedMs":"4532","pendingUnits":"16"},{"totalSlotMs":"794650","activeUnits":"16","completedUnits":"343","elapsedMs":"5669","pendingUnits":"1"},{"totalSlotMs":"796951","activeUnits":"2","completedUnits":"359","elapsedMs":"6437","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"3491758080","totalPartitionsProcessed":"0","totalBytesProcessed":"3491400204","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_100"}]},"endTime":"1570992185032"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query15_1570992176"},"etag":"B6+qyYTP9OYjf0XZMxDiqw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query15_1570992176?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonbe53ff45b9afaa2f2db0e93cc0b8f33d36f8f956","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query15\nSELECT ca_zip, \n Sum(cs_sales_price) \nFROM catalog_sales, \n customer, \n customer_address, \n date_dim \nWHERE cs_bill_customer_sk = c_customer_sk \n AND c_current_addr_sk = ca_address_sk \n AND ( Substr(ca_zip, 1, 5) IN ( '85669', '86197', '88274', '83405', \n '86475', '85392', '85460', '80348', \n '81792' ) \n OR ca_state IN ( 'CA', 'WA', 'GA' ) \n OR cs_sales_price > 500 ) \n AND cs_sold_date_sk = d_date_sk \n AND d_qoy = 1 \n AND d_year = 1998 \nGROUP BY ca_zip \nORDER BY ca_zip\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query15_1570992176","user_email":"nithish.sankaranarayanan@ulb.be"}
