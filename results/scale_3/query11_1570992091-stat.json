{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"1930351","creationTime":"1570992092766","totalBytesProcessed":"11035867050","startTime":"1570992092933","query":{"totalSlotMs":"1930351","queryPlan":[{"readMsMax":"20","computeMsMax":"7","waitMsAvg":"1","id":"0","endMs":"1570992093241","waitMsMax":"1","startMs":"1570992093193","waitRatioMax":8.285690612312537e-05,"readRatioAvg":0.0016571381224625072,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0005799983428618775,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0004971414367387521,"readMsAvg":"20","waitRatioAvg":8.285690612312537e-05,"completedParallelInputs":"1","computeRatioMax":0.0005799983428618775,"name":"S00: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0016571381224625072,"steps":[{"kind":"READ","substeps":["$110:d_date_sk, $111:d_year","FROM date_dim","WHERE equal($111, 2001)"]},{"kind":"WRITE","substeps":["$110, $111","TO __stage00_output","BY HASH($110)"]}],"writeRatioAvg":0.0004971414367387521},{"readMsMax":"334","computeMsMax":"2549","waitMsAvg":"42","id":"1","endMs":"1570992106358","waitMsMax":"45","startMs":"1570992093234","waitRatioMax":0.0037285607755406414,"readRatioAvg":0.0037285607755406414,"parallelInputs":"184","recordsRead":"281872923","computeRatioAvg":0.15842240450741568,"writeMsAvg":"116","status":"COMPLETE","writeMsMax":"12069","computeMsAvg":"1912","shuffleOutputBytesSpilled":"0","writeRatioMax":1,"readMsAvg":"45","waitRatioAvg":0.003479990057171265,"completedParallelInputs":"184","computeRatioMax":0.21120225370784654,"name":"S01: Input","shuffleOutputBytes":"9538440728","recordsWritten":"269184774","readRatioMax":0.02767420664512387,"steps":[{"kind":"READ","substeps":["$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_list_price","FROM store_sales"]},{"kind":"WRITE","substeps":["$100, $101, $102, $103","TO __stage01_output","BY HASH($101)"]}],"writeRatioAvg":0.009611401110282542},{"readMsMax":"320","computeMsMax":"6242","waitMsAvg":"20","id":"2","endMs":"1570992096940","waitMsMax":"20","startMs":"1570992093241","waitRatioMax":0.0016571381224625072,"readRatioAvg":0.026514209959400115,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.5171928080205486,"writeMsAvg":"34","status":"COMPLETE","writeMsMax":"34","computeMsAvg":"6242","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0028171348081862625,"readMsAvg":"320","waitRatioAvg":0.0016571381224625072,"completedParallelInputs":"1","computeRatioMax":0.5171928080205486,"name":"S02: Input","shuffleOutputBytes":"205435920","recordsWritten":"2000000","readRatioMax":0.026514209959400115,"steps":[{"kind":"READ","substeps":["$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address","FROM customer"]},{"kind":"WRITE","substeps":["$90, $91, $92, $93, $94, $95, $96, $97","TO __stage02_output","BY HASH($90)"]}],"writeRatioAvg":0.0028171348081862625},{"readMsMax":"17","computeMsMax":"15","waitMsAvg":"8","id":"3","endMs":"1570992093374","waitMsMax":"8","startMs":"1570992093249","waitRatioMax":0.0006628552489850029,"readRatioAvg":0.0014085674040931312,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0012428535918468805,"writeMsAvg":"80","status":"COMPLETE","writeMsMax":"80","computeMsAvg":"15","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006628552489850029,"readMsAvg":"17","waitRatioAvg":0.0006628552489850029,"completedParallelInputs":"1","computeRatioMax":0.0012428535918468805,"name":"S03: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0014085674040931312,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_year","FROM date_dim","WHERE equal($81, 2001)"]},{"kind":"WRITE","substeps":["$80, $81","TO __stage03_output","BY HASH($80)"]}],"writeRatioAvg":0.006628552489850029},{"readMsMax":"221","computeMsMax":"1274","waitMsAvg":"23","id":"4","endMs":"1570992094486","waitMsMax":"25","startMs":"1570992093277","waitRatioMax":0.002071422653078134,"readRatioAvg":0.003479990057171265,"parallelInputs":"92","recordsRead":"70474075","computeRatioAvg":0.08302261993537162,"writeMsAvg":"54","status":"COMPLETE","writeMsMax":"165","computeMsAvg":"1002","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013671389510315685,"readMsAvg":"42","waitRatioAvg":0.0019057088408318834,"completedParallelInputs":"92","computeRatioMax":0.10555969840086171,"name":"S04: Input","shuffleOutputBytes":"2536221804","recordsWritten":"70456495","readRatioMax":0.018311376253210707,"steps":[{"kind":"READ","substeps":["$70:ws_sold_date_sk, $71:ws_bill_customer_sk, $72:ws_ext_discount_amt, $73:ws_ext_list_price","FROM web_sales"]},{"kind":"WRITE","substeps":["$70, $71, $72, $73","TO __stage04_output","BY HASH($71)"]}],"writeRatioAvg":0.0044742729306487695},{"readMsMax":"369","computeMsMax":"6047","waitMsAvg":"1","id":"5","endMs":"1570992096789","waitMsMax":"1","startMs":"1570992093349","waitRatioMax":8.285690612312537e-05,"readRatioAvg":0.030574198359433258,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.501035711326539,"writeMsAvg":"49","status":"COMPLETE","writeMsMax":"49","computeMsAvg":"6047","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0040599884000331425,"readMsAvg":"369","waitRatioAvg":8.285690612312537e-05,"completedParallelInputs":"1","computeRatioMax":0.501035711326539,"name":"S05: Input","shuffleOutputBytes":"205435920","recordsWritten":"2000000","readRatioMax":0.030574198359433258,"steps":[{"kind":"READ","substeps":["$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address","FROM customer"]},{"kind":"WRITE","substeps":["$60, $61, $62, $63, $64, $65, $66, $67","TO __stage05_output","BY HASH($60)"]}],"writeRatioAvg":0.0040599884000331425},{"readMsMax":"9","computeMsMax":"11","waitMsAvg":"2","id":"6","endMs":"1570992093511","waitMsMax":"2","startMs":"1570992093370","waitRatioMax":0.00016571381224625073,"readRatioAvg":0.0007457121551081282,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.000911425967354379,"writeMsAvg":"120","status":"COMPLETE","writeMsMax":"120","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009942828734775044,"readMsAvg":"9","waitRatioAvg":0.00016571381224625073,"completedParallelInputs":"1","computeRatioMax":0.000911425967354379,"name":"S06: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0007457121551081282,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year","FROM date_dim","WHERE equal($51, 2002)"]},{"kind":"WRITE","substeps":["$50, $51","TO __stage06_output","BY HASH($50)"]}],"writeRatioAvg":0.009942828734775044},{"readMsMax":"149","computeMsMax":"2455","waitMsAvg":"2","id":"7","endMs":"1570992102572","waitMsMax":"4","startMs":"1570992093382","waitRatioMax":0.00033142762449250146,"readRatioAvg":0.003479990057171265,"parallelInputs":"184","recordsRead":"281872923","computeRatioAvg":0.15751097854006132,"writeMsAvg":"158","status":"COMPLETE","writeMsMax":"5961","computeMsAvg":"1901","shuffleOutputBytesSpilled":"0","writeRatioMax":0.4939100173999503,"readMsAvg":"42","waitRatioAvg":0.00016571381224625073,"completedParallelInputs":"184","computeRatioMax":0.20341370453227275,"name":"S07: Input","shuffleOutputBytes":"9538440728","recordsWritten":"269184774","readRatioMax":0.012345679012345678,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_ext_discount_amt, $43:ss_ext_list_price","FROM store_sales"]},{"kind":"WRITE","substeps":["$40, $41, $42, $43","TO __stage07_output","BY HASH($41)"]}],"writeRatioAvg":0.013091391167453807},{"readMsMax":"233","computeMsMax":"5775","waitMsAvg":"1","id":"8","endMs":"1570992096609","waitMsMax":"1","startMs":"1570992093483","waitRatioMax":8.285690612312537e-05,"readRatioAvg":0.019305659126688208,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.478498632861049,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"5775","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0022371364653243847,"readMsAvg":"233","waitRatioAvg":8.285690612312537e-05,"completedParallelInputs":"1","computeRatioMax":0.478498632861049,"name":"S08: Input","shuffleOutputBytes":"205435920","recordsWritten":"2000000","readRatioMax":0.019305659126688208,"steps":[{"kind":"READ","substeps":["$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address","FROM customer"]},{"kind":"WRITE","substeps":["$30, $31, $32, $33, $34, $35, $36, $37","TO __stage08_output","BY HASH($30)"]}],"writeRatioAvg":0.0022371364653243847},{"readMsMax":"24","computeMsMax":"8","waitMsAvg":"1","id":"9","endMs":"1570992093558","waitMsMax":"1","startMs":"1570992093500","waitRatioMax":8.285690612312537e-05,"readRatioAvg":0.0019885657469550086,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0006628552489850029,"writeMsAvg":"15","status":"COMPLETE","writeMsMax":"15","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0012428535918468805,"readMsAvg":"24","waitRatioAvg":8.285690612312537e-05,"completedParallelInputs":"1","computeRatioMax":0.0006628552489850029,"name":"S09: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0019885657469550086,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_year","FROM date_dim","WHERE equal($21, 2002)"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage09_output","BY HASH($20)"]}],"writeRatioAvg":0.0012428535918468805},{"readMsMax":"115","computeMsMax":"1245","waitMsAvg":"1","id":"10","endMs":"1570992094432","waitMsMax":"2","startMs":"1570992093511","waitRatioMax":0.00016571381224625073,"readRatioAvg":0.0031485624326787636,"parallelInputs":"92","recordsRead":"70474075","computeRatioAvg":0.08501118568232663,"writeMsAvg":"54","status":"COMPLETE","writeMsMax":"267","computeMsAvg":"1026","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02212279393487447,"readMsAvg":"38","waitRatioAvg":8.285690612312537e-05,"completedParallelInputs":"92","computeRatioMax":0.10315684812329108,"name":"S0A: Input","shuffleOutputBytes":"2536221804","recordsWritten":"70456495","readRatioMax":0.009528544204159417,"steps":[{"kind":"READ","substeps":["$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_list_price","FROM web_sales"]},{"kind":"WRITE","substeps":["$10, $11, $12, $13","TO __stage0A_output","BY HASH($11)"]}],"writeRatioAvg":0.0044742729306487695},{"readMsMax":"187","computeMsMax":"5335","waitMsAvg":"2","id":"11","endMs":"1570992096633","waitMsMax":"2","startMs":"1570992093530","waitRatioMax":0.00016571381224625073,"readRatioAvg":0.015494241445024443,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.44204159416687383,"writeMsAvg":"51","status":"COMPLETE","writeMsMax":"51","computeMsAvg":"5335","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004225702212279393,"readMsAvg":"187","waitRatioAvg":0.00016571381224625073,"completedParallelInputs":"1","computeRatioMax":0.44204159416687383,"name":"S0B: Input","shuffleOutputBytes":"205435920","recordsWritten":"2000000","readRatioMax":0.015494241445024443,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address","FROM customer"]},{"kind":"WRITE","substeps":["$1, $2, $3, $4, $5, $6, $7, $8","TO __stage0B_output","BY HASH($1)"]}],"writeRatioAvg":0.004225702212279393},{"readMsMax":"0","computeMsMax":"923","inputStages":["9","10","11"],"waitMsAvg":"9","id":"12","endMs":"1570992097789","waitMsMax":"22","startMs":"1570992096836","waitRatioMax":0.001822851934708758,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"72492995","computeRatioAvg":0.05924268787803463,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"49","computeMsAvg":"715","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0040599884000331425,"readMsAvg":"0","waitRatioAvg":0.0007457121551081282,"completedParallelInputs":"100","computeRatioMax":0.07647692435164472,"name":"S0C: Join+","shuffleOutputBytes":"99186936","recordsWritten":"887728","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$1, $2, $3, $4, $5, $6, $7, $8","FROM __stage0B_output"]},{"kind":"READ","substeps":["$10, $11, $12, $13","FROM __stage0A_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $440 := $430, $441 := $431, $442 := $432, $443 := $433, $444 := $434, $445 := $435, $446 := $436, $447 := $439","$150 := SUM($170)"]},{"kind":"COMPUTE","substeps":["$170 := subtract($438, $437)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $417 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH EACH ON $1 = $11"]},{"kind":"WRITE","substeps":["$440, $441, $442, $443, $444, $445, $446, $447, $150","TO __stage0C_output","BY HASH($440, $441, $442, $443, $444, $445, $446, $447)"]}],"writeRatioAvg":0.002071422653078134},{"readMsMax":"0","computeMsMax":"1135","inputStages":["3","4","5"],"waitMsAvg":"13","id":"13","endMs":"1570992098422","waitMsMax":"29","startMs":"1570992096976","waitRatioMax":0.0024028502775706355,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"72492995","computeRatioAvg":0.05857983262904963,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"395","computeMsAvg":"707","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03272847791863452,"readMsAvg":"0","waitRatioAvg":0.0010771397796006297,"completedParallelInputs":"100","computeRatioMax":0.09404258844974729,"name":"S0D: Join+","shuffleOutputBytes":"98726678","recordsWritten":"883697","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$60, $61, $62, $63, $64, $65, $66, $67","FROM __stage05_output"]},{"kind":"READ","substeps":["$70, $71, $72, $73","FROM __stage04_output"]},{"kind":"READ","substeps":["$80, $81","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $380 := $370, $381 := $371, $382 := $372, $383 := $373, $384 := $374, $385 := $375, $386 := $376, $387 := $379","$190 := SUM($220)"]},{"kind":"COMPUTE","substeps":["$220 := subtract($378, $377)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $357 = $80"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH EACH ON $60 = $71"]},{"kind":"WRITE","substeps":["$380, $381, $382, $383, $384, $385, $386, $387, $190","TO __stage0D_output","BY HASH($380, $381, $382, $383, $384, $385, $386, $387)"]}],"writeRatioAvg":0.0021542795592012593},{"readMsMax":"0","computeMsMax":"3233","inputStages":["6","7","8"],"waitMsAvg":"3","id":"14","endMs":"1570992105257","waitMsMax":"7","startMs":"1570992103220","waitRatioMax":0.0005799983428618775,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"271221274","computeRatioAvg":0.22073079791200598,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"162","computeMsAvg":"2664","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013422818791946308,"readMsAvg":"0","waitRatioAvg":0.00024857071836937607,"completedParallelInputs":"100","computeRatioMax":0.2678763774960643,"name":"S0E: Join+","shuffleOutputBytes":"202170544","recordsWritten":"1809707","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$30, $31, $32, $33, $34, $35, $36, $37","FROM __stage08_output"]},{"kind":"READ","substeps":["$40, $41, $42, $43","FROM __stage07_output"]},{"kind":"READ","substeps":["$50, $51","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $320 := $310, $321 := $311, $322 := $312, $323 := $313, $324 := $314, $325 := $315, $326 := $316, $327 := $319","$180 := SUM($210)"]},{"kind":"COMPUTE","substeps":["$210 := subtract($318, $317)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $297 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH EACH ON $30 = $41"]},{"kind":"WRITE","substeps":["$320, $321, $322, $323, $324, $325, $326, $327, $180","TO __stage0E_output","BY HASH($320, $321, $322, $323, $324, $325, $326, $327)"]}],"writeRatioAvg":0.002071422653078134},{"readMsMax":"0","computeMsMax":"3113","inputStages":["0","1","2"],"waitMsAvg":"10","id":"15","endMs":"1570992108811","waitMsMax":"19","startMs":"1570992106625","waitRatioMax":0.0015742812163393818,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"271221274","computeRatioAvg":0.2201507995691441,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"83","computeMsAvg":"2657","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006877123208219405,"readMsAvg":"0","waitRatioAvg":0.0008285690612312536,"completedParallelInputs":"100","computeRatioMax":0.25793354876128927,"name":"S0F: Join+","shuffleOutputBytes":"201862856","recordsWritten":"1806942","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$90, $91, $92, $93, $94, $95, $96, $97","FROM __stage02_output"]},{"kind":"READ","substeps":["$100, $101, $102, $103","FROM __stage01_output"]},{"kind":"READ","substeps":["$110, $111","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263, $274 := $264, $275 := $265, $276 := $266, $277 := $269","$200 := SUM($230)"]},{"kind":"COMPUTE","substeps":["$230 := subtract($268, $267)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $247 = $110"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH EACH ON $90 = $101"]},{"kind":"WRITE","substeps":["$270, $271, $272, $273, $274, $275, $276, $277, $200","TO __stage0F_output","BY HASH($270, $271, $272, $273, $274, $275, $276, $277)"]}],"writeRatioAvg":0.002071422653078134},{"readMsMax":"0","computeMsMax":"394","inputStages":["12"],"waitMsAvg":"2","id":"16","endMs":"1570992109315","waitMsMax":"2","startMs":"1570992108940","waitRatioMax":0.00016571381224625073,"readRatioAvg":0,"parallelInputs":"9","recordsRead":"887728","computeRatioAvg":0.028502775706355125,"writeMsAvg":"48","status":"COMPLETE","writeMsMax":"162","computeMsAvg":"344","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013422818791946308,"readMsAvg":"0","waitRatioAvg":0.00016571381224625073,"completedParallelInputs":"9","computeRatioMax":0.032645621012511394,"name":"S10: Aggregate","shuffleOutputBytes":"26631840","recordsWritten":"887728","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$440, $441, $442, $443, $444, $445, $446, $447, $150","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $450 := $440, $451 := $441, $452 := $442, $453 := $443, $454 := $444, $455 := $445, $456 := $446, $457 := $447","$120 := SUM($150)"]},{"kind":"WRITE","substeps":["$120, $450","TO __stage10_output","BY HASH($450)"]}],"writeRatioAvg":0.003977131493910017},{"readMsMax":"0","computeMsMax":"409","inputStages":["13"],"waitMsAvg":"1","id":"17","endMs":"1570992109274","waitMsMax":"2","startMs":"1570992108958","waitRatioMax":0.00016571381224625073,"readRatioAvg":0,"parallelInputs":"9","recordsRead":"883697","computeRatioAvg":0.02858563261247825,"writeMsAvg":"40","status":"COMPLETE","writeMsMax":"73","computeMsAvg":"345","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006048554146988151,"readMsAvg":"0","waitRatioAvg":8.285690612312537e-05,"completedParallelInputs":"9","computeRatioMax":0.033888474604358274,"name":"S11: Aggregate+","shuffleOutputBytes":"26510910","recordsWritten":"883697","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$380, $381, $382, $383, $384, $385, $386, $387, $190","FROM __stage0D_output"]},{"kind":"FILTER","substeps":["greater($140, 0)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384, $395 := $385, $396 := $386, $397 := $387","$140 := SUM($190)"]},{"kind":"WRITE","substeps":["$140, $390","TO __stage11_output","BY HASH($390)"]}],"writeRatioAvg":0.0033142762449250144},{"readMsMax":"0","computeMsMax":"489","inputStages":["15"],"waitMsAvg":"1","id":"19","endMs":"1570992109386","waitMsMax":"2","startMs":"1570992108994","waitRatioMax":0.00016571381224625073,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"1806942","computeRatioAvg":0.029994200016571382,"writeMsAvg":"60","status":"COMPLETE","writeMsMax":"111","computeMsAvg":"362","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009197116579666915,"readMsAvg":"0","waitRatioAvg":8.285690612312537e-05,"completedParallelInputs":"18","computeRatioMax":0.040517027094208305,"name":"S13: Aggregate+","shuffleOutputBytes":"54208260","recordsWritten":"1806942","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$270, $271, $272, $273, $274, $275, $276, $277, $200","FROM __stage0F_output"]},{"kind":"FILTER","substeps":["greater($160, 0)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $280 := $270, $281 := $271, $282 := $272, $283 := $273, $284 := $274, $285 := $275, $286 := $276, $287 := $277","$160 := SUM($200)"]},{"kind":"WRITE","substeps":["$160, $280","TO __stage13_output","BY HASH($280)"]}],"writeRatioAvg":0.004971414367387522},{"readMsMax":"0","computeMsMax":"28","inputStages":["19"],"waitMsAvg":"10","id":"20","endMs":"1570992110201","waitMsMax":"20","startMs":"1570992109391","waitRatioMax":0.0016571381224625072,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1806942","computeRatioAvg":0.0016571381224625072,"writeMsAvg":"37","status":"COMPLETE","writeMsMax":"75","computeMsAvg":"20","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006214267959234402,"readMsAvg":"0","waitRatioAvg":0.0008285690612312536,"completedParallelInputs":"100","computeRatioMax":0.00231999337144751,"name":"S14: Coalesce","shuffleOutputBytes":"54208260","recordsWritten":"1806942","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage13_output"]}],"writeRatioAvg":0.0030657055265556382},{"readMsMax":"0","computeMsMax":"17","inputStages":["17"],"waitMsAvg":"29","id":"21","endMs":"1570992109723","waitMsMax":"43","startMs":"1570992109392","waitRatioMax":0.0035628469632943906,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"883697","computeRatioAvg":0.0009942828734775043,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"57","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004722843649018146,"readMsAvg":"0","waitRatioAvg":0.0024028502775706355,"completedParallelInputs":"100","computeRatioMax":0.0014085674040931312,"name":"S15: Coalesce","shuffleOutputBytes":"26510910","recordsWritten":"883697","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage11_output"]}],"writeRatioAvg":0.0017399950285856326},{"readMsMax":"0","computeMsMax":"18","inputStages":["16"],"waitMsAvg":"51","id":"22","endMs":"1570992110206","waitMsMax":"67","startMs":"1570992109392","waitRatioMax":0.0055514127102494,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"887728","computeRatioAvg":0.0009942828734775043,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"198","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01640566741237882,"readMsAvg":"0","waitRatioAvg":0.004225702212279393,"completedParallelInputs":"100","computeRatioMax":0.0014914243102162564,"name":"S16: Coalesce","shuffleOutputBytes":"26631840","recordsWritten":"887728","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage10_output"]}],"writeRatioAvg":0.0014085674040931312},{"readMsMax":"0","computeMsMax":"8588","inputStages":["14","22","21","20"],"waitMsAvg":"68","id":"23","endMs":"1570992115513","waitMsMax":"71","startMs":"1570992109458","waitRatioMax":0.005882840334741901,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"66220313","computeRatioAvg":0.6111525395641727,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"7376","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0015742812163393818,"readMsAvg":"0","waitRatioAvg":0.005634269616372525,"completedParallelInputs":"18","computeRatioMax":0.7115751097854006,"name":"S17: Join+","shuffleOutputBytes":"100259","recordsWritten":"1800","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$320, $321, $322, $323, $324, $325, $326, $327, $180","FROM __stage0E_output"]},{"kind":"READ","substeps":["$160, $280","FROM __stage14_output"]},{"kind":"READ","substeps":["$140, $390","FROM __stage15_output"]},{"kind":"READ","substeps":["$120, $450","FROM __stage16_output"]},{"kind":"SORT","substeps":["$460 ASC, $461 ASC, $462 ASC, $463 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["greater(case_no_value(greater($465, 0), divide($467, $465), 0), case_no_value(greater($466, 0), divide($464, $466), 0))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $404 = $450"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $340 = $390"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $330 = $280"]},{"kind":"AGGREGATE","substeps":["GROUP BY $330 := $320, $331 := $321, $332 := $322, $333 := $323, $334 := $324, $335 := $325, $336 := $326, $337 := $327","$130 := SUM($180)"]},{"kind":"WRITE","substeps":["$470, $471, $472, $473","TO __stage17_output"]}],"writeRatioAvg":0.0005799983428618775},{"readMsMax":"0","computeMsMax":"7","inputStages":["23"],"waitMsAvg":"47","id":"24","endMs":"1570992115525","waitMsMax":"47","startMs":"1570992109462","waitRatioMax":0.003894274587786892,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1800","computeRatioAvg":0.0005799983428618775,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0022371364653243847,"readMsAvg":"0","waitRatioAvg":0.003894274587786892,"completedParallelInputs":"1","computeRatioMax":0.0005799983428618775,"name":"S18: Output","shuffleOutputBytes":"5513","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$470, $471, $472, $473","FROM __stage17_output"]},{"kind":"SORT","substeps":["$470 ASC, $471 ASC, $472 ASC, $473 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$480, $481, $482, $483","TO __stage18_output"]}],"writeRatioAvg":0.0022371364653243847}],"estimatedBytesProcessed":"11035867050","timeline":[{"totalSlotMs":"110336","activeUnits":"558","completedUnits":"4","elapsedMs":"760","pendingUnits":"556"},{"totalSlotMs":"846469","activeUnits":"296","completedUnits":"546","elapsedMs":"1828","pendingUnits":"14"},{"totalSlotMs":"864848","activeUnits":"10","completedUnits":"554","elapsedMs":"2889","pendingUnits":"6"},{"totalSlotMs":"1063625","activeUnits":"129","completedUnits":"756","elapsedMs":"4965","pendingUnits":"4"},{"totalSlotMs":"1072708","activeUnits":"9","completedUnits":"758","elapsedMs":"5998","pendingUnits":"2"},{"totalSlotMs":"1142809","activeUnits":"103","completedUnits":"759","elapsedMs":"10789","pendingUnits":"101"},{"totalSlotMs":"1358391","activeUnits":"35","completedUnits":"859","elapsedMs":"12432","pendingUnits":"1"},{"totalSlotMs":"1461167","activeUnits":"101","completedUnits":"860","elapsedMs":"14542","pendingUnits":"100"},{"totalSlotMs":"1633438","activeUnits":"30","completedUnits":"959","elapsedMs":"15804","pendingUnits":"1"},{"totalSlotMs":"1713481","activeUnits":"187","completedUnits":"1130","elapsedMs":"16885","pendingUnits":"185"},{"totalSlotMs":"1794208","activeUnits":"19","completedUnits":"1296","elapsedMs":"17416","pendingUnits":"19"},{"totalSlotMs":"1827957","activeUnits":"20","completedUnits":"1296","elapsedMs":"18442","pendingUnits":"19"},{"totalSlotMs":"1917473","activeUnits":"15","completedUnits":"1308","elapsedMs":"21481","pendingUnits":"7"},{"totalSlotMs":"1930351","activeUnits":"7","completedUnits":"1315","elapsedMs":"22791","pendingUnits":"0"},{"totalSlotMs":"1930351","activeUnits":"0","completedUnits":"1315","elapsedMs":"23872","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"11036262400","totalPartitionsProcessed":"0","totalBytesProcessed":"11035867050","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_100"}]},"endTime":"1570992116838"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query11_1570992091"},"etag":"nptl9R+qm0xfCC6X+pVJdA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query11_1570992091?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon0bdb577f6a1a84d924fbe66d97e596bb51fba18e","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query11\nWITH year_total \n AS (SELECT c_customer_id customer_id, \n c_first_name customer_first_name \n , \n c_last_name \n customer_last_name, \n c_preferred_cust_flag \n customer_preferred_cust_flag \n , \n c_birth_country \n customer_birth_country, \n c_login customer_login, \n c_email_address \n customer_email_address, \n d_year dyear, \n Sum(ss_ext_list_price - ss_ext_discount_amt) year_total, \n 's' sale_type \n FROM customer, \n store_sales, \n date_dim \n WHERE c_customer_sk = ss_customer_sk \n AND ss_sold_date_sk = d_date_sk \n GROUP BY c_customer_id, \n c_first_name, \n c_last_name, \n c_preferred_cust_flag, \n c_birth_country, \n c_login, \n c_email_address, \n d_year \n UNION ALL \n SELECT c_customer_id customer_id, \n c_first_name customer_first_name \n , \n c_last_name \n customer_last_name, \n c_preferred_cust_flag \n customer_preferred_cust_flag \n , \n c_birth_country \n customer_birth_country, \n c_login customer_login, \n c_email_address \n customer_email_address, \n d_year dyear, \n Sum(ws_ext_list_price - ws_ext_discount_amt) year_total, \n 'w' sale_type \n FROM customer, \n web_sales, \n date_dim \n WHERE c_customer_sk = ws_bill_customer_sk \n AND ws_sold_date_sk = d_date_sk \n GROUP BY c_customer_id, \n c_first_name, \n c_last_name, \n c_preferred_cust_flag, \n c_birth_country, \n c_login, \n c_email_address, \n d_year) \nSELECT t_s_secyear.customer_id, \n t_s_secyear.customer_first_name, \n t_s_secyear.customer_last_name, \n t_s_secyear.customer_birth_country \nFROM year_total t_s_firstyear, \n year_total t_s_secyear, \n year_total t_w_firstyear, \n year_total t_w_secyear \nWHERE t_s_secyear.customer_id = t_s_firstyear.customer_id \n AND t_s_firstyear.customer_id = t_w_secyear.customer_id \n AND t_s_firstyear.customer_id = t_w_firstyear.customer_id \n AND t_s_firstyear.sale_type = 's' \n AND t_w_firstyear.sale_type = 'w' \n AND t_s_secyear.sale_type = 's' \n AND t_w_secyear.sale_type = 'w' \n AND t_s_firstyear.dyear = 2001 \n AND t_s_secyear.dyear = 2001 + 1 \n AND t_w_firstyear.dyear = 2001 \n AND t_w_secyear.dyear = 2001 + 1 \n AND t_s_firstyear.year_total > 0 \n AND t_w_firstyear.year_total > 0 \n AND CASE \n WHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / \n t_w_firstyear.year_total \n ELSE 0.0 \n END > CASE \n WHEN t_s_firstyear.year_total > 0 THEN \n t_s_secyear.year_total / \n t_s_firstyear.year_total \n ELSE 0.0 \n END \nORDER BY t_s_secyear.customer_id, \n t_s_secyear.customer_first_name, \n t_s_secyear.customer_last_name, \n t_s_secyear.customer_birth_country\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query11_1570992091","user_email":"nithish.sankaranarayanan@ulb.be"}
