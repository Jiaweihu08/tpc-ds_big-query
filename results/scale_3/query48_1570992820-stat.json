{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"357130","creationTime":"1570992822723","totalBytesProcessed":"15145462750","startTime":"1570992822895","query":{"totalSlotMs":"357130","queryPlan":[{"readMsMax":"15","computeMsMax":"7","waitMsAvg":"1","id":"0","endMs":"1570992823289","waitMsMax":"1","startMs":"1570992823232","waitRatioMax":0.0006863417982155113,"readRatioAvg":0.01029512697323267,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004804392587508579,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012354152367879203,"readMsAvg":"15","waitRatioAvg":0.0006863417982155113,"completedParallelInputs":"1","computeRatioMax":0.004804392587508579,"name":"S00: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.01029512697323267,"steps":[{"kind":"READ","substeps":["$1:d_date_sk, $2:d_year","FROM date_dim","WHERE equal($2, 1999)"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.012354152367879203},{"readMsMax":"16","computeMsMax":"213","waitMsAvg":"15","id":"1","endMs":"1570992823481","waitMsMax":"15","startMs":"1570992823274","waitRatioMax":0.01029512697323267,"readRatioAvg":0.01098146877144818,"parallelInputs":"1","recordsRead":"1000000","computeRatioAvg":0.14619080301990392,"writeMsAvg":"38","status":"COMPLETE","writeMsMax":"38","computeMsAvg":"213","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02608098833218943,"readMsAvg":"16","waitRatioAvg":0.01029512697323267,"completedParallelInputs":"1","computeRatioMax":0.14619080301990392,"name":"S01: Input","shuffleOutputBytes":"4271872","recordsWritten":"266992","readRatioMax":0.01098146877144818,"steps":[{"kind":"READ","substeps":["$10:ca_address_sk, $11:ca_state, $12:ca_country","FROM customer_address","WHERE and(equal($12, 'United States'), or(in($11, 'TX', 'NE', 'MO'), in($11, 'CO', 'TN', 'ND'), in($11, 'OK', 'PA', 'CA')))"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.02608098833218943},{"readMsMax":"29","computeMsMax":"562","waitMsAvg":"10","id":"2","endMs":"1570992823618","waitMsMax":"10","startMs":"1570992823290","waitRatioMax":0.0068634179821551134,"readRatioAvg":0.01990391214824983,"parallelInputs":"1","recordsRead":"1920800","computeRatioAvg":0.3857240905971174,"writeMsAvg":"30","status":"COMPLETE","writeMsMax":"30","computeMsAvg":"562","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02059025394646534,"readMsAvg":"29","waitRatioAvg":0.0068634179821551134,"completedParallelInputs":"1","computeRatioMax":0.3857240905971174,"name":"S02: Input","shuffleOutputBytes":"15640800","recordsWritten":"493920","readRatioMax":0.01990391214824983,"steps":[{"kind":"READ","substeps":["$30:cd_demo_sk, $31:cd_marital_status, $32:cd_education_status","FROM customer_demographics","WHERE and(or(equal($31, 'W'), equal($31, 'M'), equal($31, 'D')), ...)"]},{"kind":"WRITE","substeps":["$30, $31, $32","TO __stage02_output","BY HASH($30)"]}],"writeRatioAvg":0.02059025394646534},{"readMsMax":"50","computeMsMax":"12","waitMsAvg":"2","id":"3","endMs":"1570992823595","waitMsMax":"2","startMs":"1570992823317","waitRatioMax":0.0013726835964310226,"readRatioAvg":0.03431708991077557,"parallelInputs":"1","recordsRead":"402","computeRatioAvg":0.008236101578586136,"writeMsAvg":"172","status":"COMPLETE","writeMsMax":"172","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.11805078929306795,"readMsAvg":"50","waitRatioAvg":0.0013726835964310226,"completedParallelInputs":"1","computeRatioMax":0.008236101578586136,"name":"S03: Input","shuffleOutputBytes":"3618","recordsWritten":"402","readRatioMax":0.03431708991077557,"steps":[{"kind":"READ","substeps":["$20:s_store_sk","FROM store"]},{"kind":"WRITE","substeps":["$20","TO __stage03_output","BY HASH($20)"]}],"writeRatioAvg":0.11805078929306795},{"readMsMax":"0","computeMsMax":"15","inputStages":["2"],"waitMsAvg":"1","id":"6","endMs":"1570992823982","waitMsMax":"3","startMs":"1570992823678","waitRatioMax":0.002059025394646534,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"493920","computeRatioAvg":0.0068634179821551134,"writeMsAvg":"122","status":"COMPLETE","writeMsMax":"170","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.11667810569663692,"readMsAvg":"0","waitRatioAvg":0.0006863417982155113,"completedParallelInputs":"100","computeRatioMax":0.01029512697323267,"name":"S06: Coalesce","shuffleOutputBytes":"15640800","recordsWritten":"493920","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage02_output"]}],"writeRatioAvg":0.08373369938229239},{"readMsMax":"0","computeMsMax":"10","inputStages":["1"],"waitMsAvg":"4","id":"7","endMs":"1570992823957","waitMsMax":"8","startMs":"1570992823678","waitRatioMax":0.00549073438572409,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"266992","computeRatioAvg":0.0034317089910775567,"writeMsAvg":"153","status":"COMPLETE","writeMsMax":"209","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.14344543582704186,"readMsAvg":"0","waitRatioAvg":0.002745367192862045,"completedParallelInputs":"100","computeRatioMax":0.0068634179821551134,"name":"S07: Coalesce","shuffleOutputBytes":"4271872","recordsWritten":"266992","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage01_output"]}],"writeRatioAvg":0.10501029512697323},{"readMsMax":"140","computeMsMax":"1457","inputStages":["0","7","6","3"],"waitMsAvg":"6","id":"8","endMs":"1570992825365","waitMsMax":"11","startMs":"1570992823698","waitRatioMax":0.0075497597803706245,"readRatioAvg":0.029512697323266987,"parallelInputs":"184","recordsRead":"422021859","computeRatioAvg":0.7618393960192176,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"56","computeMsAvg":"1110","shuffleOutputBytesSpilled":"0","writeRatioMax":0.038435140700068635,"readMsAvg":"43","waitRatioAvg":0.004118050789293068,"completedParallelInputs":"184","computeRatioMax":1,"name":"S08: Join+","shuffleOutputBytes":"1656","recordsWritten":"184","readRatioMax":0.09608785175017158,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_cdemo_sk, $42:ss_addr_sk, $43:ss_store_sk, $44:ss_quantity, $45:ss_sales_price, $46:ss_net_profit","FROM store_sales","WHERE and(or(between($45, 100, 150), between($45, 50, 100), between($45, 150, 200)), ...)"]},{"kind":"READ","substeps":["$20","FROM __stage03_output"]},{"kind":"READ","substeps":["$30, $31, $32","FROM __stage06_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage07_output"]},{"kind":"READ","substeps":["$1","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["$60 := SUM($120)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $110 = $1"]},{"kind":"FILTER","substeps":["or(and(in($113, 'TX', 'NE', 'MO'), between($112, 0, 2000)), and(in($113, 'CO', 'TN', 'ND'), between($112, 150, 3000)), ...)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $91 = $10"]},{"kind":"FILTER","substeps":["or(and(equal($95, 'W'), equal($96, 'Secondary'), between($93, 100, 150)), ...)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $71 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $43 = $20"]},{"kind":"WRITE","substeps":["$60","TO __stage08_output"]}],"writeRatioAvg":0.004118050789293068},{"readMsMax":"0","computeMsMax":"8","inputStages":["8"],"waitMsAvg":"1","id":"9","endMs":"1570992825399","waitMsMax":"1","startMs":"1570992823818","waitRatioMax":0.0006863417982155113,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"184","computeRatioAvg":0.00549073438572409,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004118050789293068,"readMsAvg":"0","waitRatioAvg":0.0006863417982155113,"completedParallelInputs":"1","computeRatioMax":0.00549073438572409,"name":"S09: Output","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$60","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["$50 := SUM($60)"]},{"kind":"WRITE","substeps":["$50","TO __stage09_output"]}],"writeRatioAvg":0.004118050789293068}],"estimatedBytesProcessed":"15145462750","timeline":[{"totalSlotMs":"10142","activeUnits":"384","completedUnits":"4","elapsedMs":"838","pendingUnits":"385"},{"totalSlotMs":"355535","activeUnits":"185","completedUnits":"386","elapsedMs":"2187","pendingUnits":"3"},{"totalSlotMs":"357130","activeUnits":"0","completedUnits":"389","elapsedMs":"2960","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"15145631744","totalPartitionsProcessed":"0","totalBytesProcessed":"15145462750","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer_demographics","datasetId":"scale_100"}]},"endTime":"1570992825886"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query48_1570992820"},"etag":"JC8bg7WsOXhr+6aHQi85mA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query48_1570992820?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon184318bace82181a96fc4eee9b3280856713e311","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query48\nSELECT Sum (ss_quantity) \nFROM store_sales, \n store, \n customer_demographics, \n customer_address, \n date_dim \nWHERE s_store_sk = ss_store_sk \n AND ss_sold_date_sk = d_date_sk \n AND d_year = 1999 \n AND ( ( cd_demo_sk = ss_cdemo_sk \n AND cd_marital_status = 'W' \n AND cd_education_status = 'Secondary' \n AND ss_sales_price BETWEEN 100.00 AND 150.00 ) \n OR ( cd_demo_sk = ss_cdemo_sk \n AND cd_marital_status = 'M' \n AND cd_education_status = 'Advanced Degree' \n AND ss_sales_price BETWEEN 50.00 AND 100.00 ) \n OR ( cd_demo_sk = ss_cdemo_sk \n AND cd_marital_status = 'D' \n AND cd_education_status = '2 yr Degree' \n AND ss_sales_price BETWEEN 150.00 AND 200.00 ) ) \n AND ( ( ss_addr_sk = ca_address_sk \n AND ca_country = 'United States' \n AND ca_state IN ( 'TX', 'NE', 'MO' ) \n AND ss_net_profit BETWEEN 0 AND 2000 ) \n OR ( ss_addr_sk = ca_address_sk \n AND ca_country = 'United States' \n AND ca_state IN ( 'CO', 'TN', 'ND' ) \n AND ss_net_profit BETWEEN 150 AND 3000 ) \n OR ( ss_addr_sk = ca_address_sk \n AND ca_country = 'United States' \n AND ca_state IN ( 'OK', 'PA', 'CA' ) \n AND ss_net_profit BETWEEN 50 AND 25000 ) ); \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query48_1570992820","user_email":"nithish.sankaranarayanan@ulb.be"}
