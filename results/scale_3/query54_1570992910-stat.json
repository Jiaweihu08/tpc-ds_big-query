{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"234573","creationTime":"1570992912439","totalBytesProcessed":"11663225292","startTime":"1570992912665","query":{"totalSlotMs":"234573","queryPlan":[{"readMsMax":"22","computeMsMax":"10","waitMsAvg":"24","id":"1","endMs":"1570992912972","waitMsMax":"24","startMs":"1570992912910","waitRatioMax":0.0148975791433892,"readRatioAvg":0.013656114214773432,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.006207324643078833,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"12","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0074487895716946,"readMsAvg":"22","waitRatioAvg":0.0148975791433892,"completedParallelInputs":"1","computeRatioMax":0.006207324643078833,"name":"S01: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.013656114214773432,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_year, $72:d_moy","FROM date_dim","WHERE and(equal($72, 5), equal($71, 2000))"]},{"kind":"WRITE","substeps":["$70","TO __stage01_output","BY HASH($70)"]}],"writeRatioAvg":0.0074487895716946},{"readMsMax":"15","computeMsMax":"12","waitMsAvg":"46","id":"2","endMs":"1570992913176","waitMsMax":"46","startMs":"1570992912952","waitRatioMax":0.028553693358162633,"readRatioAvg":0.00931098696461825,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.0074487895716946,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01303538175046555,"readMsAvg":"15","waitRatioAvg":0.028553693358162633,"completedParallelInputs":"1","computeRatioMax":0.0074487895716946,"name":"S02: Input","shuffleOutputBytes":"11808","recordsWritten":"1312","readRatioMax":0.00931098696461825,"steps":[{"kind":"READ","substeps":["$100:i_item_sk, $101:i_class, $102:i_category","FROM item","WHERE and(equal($102, 'Sports'), equal($101, 'fitness'))"]},{"kind":"WRITE","substeps":["$100","TO __stage02_output","BY HASH($100)"]}],"writeRatioAvg":0.01303538175046555},{"readMsMax":"10","computeMsMax":"9","waitMsAvg":"43","id":"4","endMs":"1570992913026","waitMsMax":"43","startMs":"1570992912996","waitRatioMax":0.02669149596523898,"readRatioAvg":0.006207324643078833,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.00558659217877095,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002482929857231533,"readMsAvg":"10","waitRatioAvg":0.02669149596523898,"completedParallelInputs":"1","computeRatioMax":0.00558659217877095,"name":"S04: Input","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.006207324643078833,"steps":[{"kind":"READ","substeps":["$60:d_month_seq, $61:d_year, $62:d_moy","FROM date_dim","WHERE and(equal($61, 2000), equal($62, 5))"]},{"kind":"AGGREGATE","substeps":["GROUP BY $260 := $200"]},{"kind":"COMPUTE","substeps":["$200 := add($60, 3)"]},{"kind":"WRITE","substeps":["$260","TO __stage04_output","BY HASH($260)"]}],"writeRatioAvg":0.002482929857231533},{"readMsMax":"9","computeMsMax":"7","waitMsAvg":"4","id":"5","endMs":"1570992913024","waitMsMax":"4","startMs":"1570992912996","waitRatioMax":0.002482929857231533,"readRatioAvg":0.00558659217877095,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004345127250155183,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"3","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00186219739292365,"readMsAvg":"9","waitRatioAvg":0.002482929857231533,"completedParallelInputs":"1","computeRatioMax":0.004345127250155183,"name":"S05: Input","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.00558659217877095,"steps":[{"kind":"READ","substeps":["$40:d_month_seq, $41:d_year, $42:d_moy","FROM date_dim","WHERE and(equal($41, 2000), equal($42, 5))"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $190"]},{"kind":"COMPUTE","substeps":["$190 := add($40, 1)"]},{"kind":"WRITE","substeps":["$230","TO __stage05_output","BY HASH($230)"]}],"writeRatioAvg":0.00186219739292365},{"readMsMax":"0","computeMsMax":"5","inputStages":["5"],"waitMsAvg":"1","id":"6","endMs":"1570992913249","waitMsMax":"1","startMs":"1570992913033","waitRatioMax":0.0006207324643078833,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.0031036623215394167,"writeMsAvg":"181","status":"COMPLETE","writeMsMax":"181","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.11235257603972688,"readMsAvg":"0","waitRatioAvg":0.0006207324643078833,"completedParallelInputs":"1","computeRatioMax":0.0031036623215394167,"name":"S06: Aggregate+","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$230","FROM __stage05_output"]},{"kind":"LIMIT","substeps":["2"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230"]},{"kind":"WRITE","substeps":["$240","TO __stage06_output"]}],"writeRatioAvg":0.11235257603972688},{"readMsMax":"0","computeMsMax":"4","inputStages":["6"],"waitMsAvg":"3","id":"7","endMs":"1570992913272","waitMsMax":"3","startMs":"1570992913036","waitRatioMax":0.00186219739292365,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.002482929857231533,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002482929857231533,"readMsAvg":"0","waitRatioAvg":0.00186219739292365,"completedParallelInputs":"1","computeRatioMax":0.002482929857231533,"name":"S07: Aggregate","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$240","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["$170 := ANY_AND_CHECK($240)"]},{"kind":"WRITE","substeps":["$170","TO __stage07_output"]}],"writeRatioAvg":0.002482929857231533},{"readMsMax":"0","computeMsMax":"5","inputStages":["4"],"waitMsAvg":"3","id":"8","endMs":"1570992913251","waitMsMax":"3","startMs":"1570992913036","waitRatioMax":0.00186219739292365,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.0031036623215394167,"writeMsAvg":"153","status":"COMPLETE","writeMsMax":"153","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.09497206703910614,"readMsAvg":"0","waitRatioAvg":0.00186219739292365,"completedParallelInputs":"1","computeRatioMax":0.0031036623215394167,"name":"S08: Aggregate+","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$260","FROM __stage04_output"]},{"kind":"LIMIT","substeps":["2"]},{"kind":"AGGREGATE","substeps":["GROUP BY $270 := $260"]},{"kind":"WRITE","substeps":["$270","TO __stage08_output"]}],"writeRatioAvg":0.09497206703910614},{"readMsMax":"0","computeMsMax":"4","inputStages":["8"],"waitMsAvg":"3","id":"9","endMs":"1570992913269","waitMsMax":"3","startMs":"1570992913036","waitRatioMax":0.00186219739292365,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.002482929857231533,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004345127250155183,"readMsAvg":"0","waitRatioAvg":0.00186219739292365,"completedParallelInputs":"1","computeRatioMax":0.002482929857231533,"name":"S09: Aggregate","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$270","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["$180 := ANY_AND_CHECK($270)"]},{"kind":"WRITE","substeps":["$180","TO __stage09_output"]}],"writeRatioAvg":0.004345127250155183},{"readMsMax":"56","computeMsMax":"361","inputStages":["1","2"],"waitMsAvg":"2","id":"10","endMs":"1570992913562","waitMsMax":"4","startMs":"1570992913263","waitRatioMax":0.002482929857231533,"readRatioAvg":0.0148975791433892,"parallelInputs":"233","recordsRead":"214797445","computeRatioAvg":0.15704531346989448,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"73","computeMsAvg":"253","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04531346989447548,"readMsAvg":"24","waitRatioAvg":0.0012414649286157666,"completedParallelInputs":"233","computeRatioMax":0.22408441961514589,"name":"S0A: Join","shuffleOutputBytes":"118548","recordsWritten":"13172","readRatioMax":0.03476101800124146,"steps":[{"kind":"READ","substeps":["$80:cs_sold_date_sk, $81:cs_bill_customer_sk, $82:cs_item_sk","FROM catalog_sales"]},{"kind":"READ","substeps":["$90:ws_sold_date_sk, $91:ws_item_sk, $92:ws_bill_customer_sk","FROM web_sales"]},{"kind":"READ","substeps":["$100","FROM __stage02_output"]},{"kind":"READ","substeps":["$70","FROM __stage01_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $290 = $70"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $212 = $100"]},{"kind":"WRITE","substeps":["$300","TO __stage0A_output","BY HASH($300)"]}],"writeRatioAvg":0.004345127250155183},{"readMsMax":"0","computeMsMax":"9","inputStages":["10"],"waitMsAvg":"1","id":"11","endMs":"1570992913666","waitMsMax":"2","startMs":"1570992913566","waitRatioMax":0.0012414649286157666,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"13172","computeRatioAvg":0.0031036623215394167,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"34","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02110490378646803,"readMsAvg":"0","waitRatioAvg":0.0006207324643078833,"completedParallelInputs":"100","computeRatioMax":0.00558659217877095,"name":"S0B: Coalesce","shuffleOutputBytes":"118548","recordsWritten":"13172","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0A_output"]}],"writeRatioAvg":0.0111731843575419},{"readMsMax":"21","computeMsMax":"402","inputStages":["11"],"waitMsAvg":"1","id":"12","endMs":"1570992913888","waitMsMax":"1","startMs":"1570992913588","waitRatioMax":0.0006207324643078833,"readRatioAvg":0.01303538175046555,"parallelInputs":"1","recordsRead":"2013172","computeRatioAvg":0.24953445065176907,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"402","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010552451893234015,"readMsAvg":"21","waitRatioAvg":0.0006207324643078833,"completedParallelInputs":"1","computeRatioMax":0.24953445065176907,"name":"S0C: Join+","shuffleOutputBytes":"229428","recordsWritten":"12746","readRatioMax":0.01303538175046555,"steps":[{"kind":"READ","substeps":["$50:c_customer_sk, $51:c_current_addr_sk","FROM customer"]},{"kind":"READ","substeps":["$300","FROM __stage0B_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $320 := $310, $321 := $311"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $50 = $300"]},{"kind":"WRITE","substeps":["$320, $321","TO __stage0C_output","BY HASH($320, $321)"]}],"writeRatioAvg":0.010552451893234015},{"readMsMax":"11","computeMsMax":"16","waitMsAvg":"1","id":"13","endMs":"1570992914003","waitMsMax":"1","startMs":"1570992913935","waitRatioMax":0.0006207324643078833,"readRatioAvg":0.006828057107386716,"parallelInputs":"1","recordsRead":"73051","computeRatioAvg":0.009931719428926133,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"16","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0111731843575419,"readMsAvg":"11","waitRatioAvg":0.0006207324643078833,"completedParallelInputs":"1","computeRatioMax":0.009931719428926133,"name":"S0D: Input","shuffleOutputBytes":"828","recordsWritten":"92","readRatioMax":0.006828057107386716,"steps":[{"kind":"READ","substeps":["$180","FROM __stage09_output"]},{"kind":"READ","substeps":["$170","FROM __stage07_output"]},{"kind":"READ","substeps":["$10:d_date_sk, $11:d_month_seq","FROM date_dim"]},{"kind":"FILTER","substeps":["between($11, $170, $180)"]},{"kind":"WRITE","substeps":["$10","TO __stage0D_output","BY HASH($10)"]}],"writeRatioAvg":0.0111731843575419},{"readMsMax":"9","computeMsMax":"9","waitMsAvg":"1","id":"14","endMs":"1570992914075","waitMsMax":"1","startMs":"1570992913975","waitRatioMax":0.0006207324643078833,"readRatioAvg":0.00558659217877095,"parallelInputs":"1","recordsRead":"402","computeRatioAvg":0.00558659217877095,"writeMsAvg":"32","status":"COMPLETE","writeMsMax":"32","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.019863438857852266,"readMsAvg":"9","waitRatioAvg":0.0006207324643078833,"completedParallelInputs":"1","computeRatioMax":0.00558659217877095,"name":"S0E: Input","shuffleOutputBytes":"10303","recordsWritten":"395","readRatioMax":0.00558659217877095,"steps":[{"kind":"READ","substeps":["$1:s_county, $2:s_state","FROM store"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage0E_output","BY HASH($1, $2)"]}],"writeRatioAvg":0.019863438857852266},{"readMsMax":"0","computeMsMax":"14","inputStages":["12"],"waitMsAvg":"0","id":"17","endMs":"1570992914290","waitMsMax":"1","startMs":"1570992914063","waitRatioMax":0.0006207324643078833,"readRatioAvg":0,"parallelInputs":"23","recordsRead":"12746","computeRatioAvg":0.00558659217877095,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"41","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.025450031036623216,"readMsAvg":"0","waitRatioAvg":0,"completedParallelInputs":"23","computeRatioMax":0.008690254500310366,"name":"S11: Aggregate","shuffleOutputBytes":"229428","recordsWritten":"12746","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$320, $321","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $330 := $320, $331 := $321"]},{"kind":"WRITE","substeps":["$330, $331","TO __stage11_output","BY HASH($330)"]}],"writeRatioAvg":0.016139044072004966},{"readMsMax":"0","computeMsMax":"8","inputStages":["17"],"waitMsAvg":"4","id":"18","endMs":"1570992914421","waitMsMax":"6","startMs":"1570992914304","waitRatioMax":0.0037243947858473,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"12746","computeRatioAvg":0.0031036623215394167,"writeMsAvg":"36","status":"COMPLETE","writeMsMax":"60","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.037243947858473,"readMsAvg":"0","waitRatioAvg":0.002482929857231533,"completedParallelInputs":"100","computeRatioMax":0.004965859714463066,"name":"S12: Coalesce","shuffleOutputBytes":"229428","recordsWritten":"12746","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage11_output"]}],"writeRatioAvg":0.0223463687150838},{"readMsMax":"74","computeMsMax":"516","inputStages":["18"],"waitMsAvg":"2","id":"19","endMs":"1570992914713","waitMsMax":"4","startMs":"1570992914348","waitRatioMax":0.002482929857231533,"readRatioAvg":0.019863438857852266,"parallelInputs":"184","recordsRead":"284218187","computeRatioAvg":0.24953445065176907,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"50","computeMsAvg":"402","shuffleOutputBytesSpilled":"0","writeRatioMax":0.031036623215394164,"readMsAvg":"32","waitRatioAvg":0.0012414649286157666,"completedParallelInputs":"184","computeRatioMax":0.3202979515828678,"name":"S13: Join","shuffleOutputBytes":"60754840","recordsWritten":"1705494","readRatioMax":0.045934202358783364,"steps":[{"kind":"READ","substeps":["$30:ss_sold_date_sk, $31:ss_customer_sk, $32:ss_ext_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$330, $331","FROM __stage12_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $31 = $330"]},{"kind":"WRITE","substeps":["$340, $341, $342, $343","TO __stage13_output","BY HASH($341)"]}],"writeRatioAvg":0.00558659217877095},{"readMsMax":"0","computeMsMax":"25","inputStages":["19"],"waitMsAvg":"1","id":"20","endMs":"1570992914966","waitMsMax":"5","startMs":"1570992914725","waitRatioMax":0.0031036623215394167,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1705494","computeRatioAvg":0.011793916821849782,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"115","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.07138423339540657,"readMsAvg":"0","waitRatioAvg":0.0006207324643078833,"completedParallelInputs":"100","computeRatioMax":0.015518311607697082,"name":"S14: Coalesce","shuffleOutputBytes":"60754840","recordsWritten":"1705494","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage13_output"]}],"writeRatioAvg":0.014276846679081317},{"readMsMax":"0","computeMsMax":"9","inputStages":["13"],"waitMsAvg":"4","id":"21","endMs":"1570992914958","waitMsMax":"5","startMs":"1570992914726","waitRatioMax":0.0031036623215394167,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"92","computeRatioAvg":0.0031036623215394167,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"54","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0335195530726257,"readMsAvg":"0","waitRatioAvg":0.002482929857231533,"completedParallelInputs":"100","computeRatioMax":0.00558659217877095,"name":"S15: Coalesce","shuffleOutputBytes":"828","recordsWritten":"92","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0D_output"]}],"writeRatioAvg":0.012414649286157667},{"readMsMax":"21","computeMsMax":"1611","inputStages":["7","9","21","14","20"],"waitMsAvg":"1","id":"22","endMs":"1570992915834","waitMsMax":"1","startMs":"1570992914757","waitRatioMax":0.0006207324643078833,"readRatioAvg":0.01303538175046555,"parallelInputs":"1","recordsRead":"2705983","computeRatioAvg":1,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"1611","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0031036623215394167,"readMsAvg":"21","waitRatioAvg":0.0006207324643078833,"completedParallelInputs":"1","computeRatioMax":1,"name":"S16: Join+","shuffleOutputBytes":"198","recordsWritten":"11","readRatioMax":0.01303538175046555,"steps":[{"kind":"READ","substeps":["$170","FROM __stage07_output"]},{"kind":"READ","substeps":["$180","FROM __stage09_output"]},{"kind":"READ","substeps":["$20:ca_address_sk, $21:ca_county, $22:ca_state","FROM customer_address"]},{"kind":"READ","substeps":["$340, $341, $342, $343","FROM __stage14_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage0E_output"]},{"kind":"READ","substeps":["$10","FROM __stage15_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $380 := $371","$160 := SUM($370)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $360 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $353 = $1, $354 = $2"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $341"]},{"kind":"WRITE","substeps":["$380, $160","TO __stage16_output","BY HASH($380)"]}],"writeRatioAvg":0.0031036623215394167},{"readMsMax":"0","computeMsMax":"11","inputStages":["22"],"waitMsAvg":"1","id":"23","endMs":"1570992916035","waitMsMax":"1","startMs":"1570992915959","waitRatioMax":0.0006207324643078833,"readRatioAvg":0,"parallelInputs":"20","recordsRead":"11","computeRatioAvg":0.004345127250155183,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"49","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03041589075108628,"readMsAvg":"0","waitRatioAvg":0.0006207324643078833,"completedParallelInputs":"20","computeRatioMax":0.006828057107386716,"name":"S17: Aggregate+","shuffleOutputBytes":"198","recordsWritten":"11","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$380, $160","FROM __stage16_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $400 := $140","$130 := COUNT_STAR()"]},{"kind":"COMPUTE","substeps":["$140 := floor(divide($150, 50))"]},{"kind":"AGGREGATE","substeps":["GROUP BY $390 := $380","$150 := SUM($160)"]},{"kind":"WRITE","substeps":["$130, $400","TO __stage17_output","BY HASH($400)"]}],"writeRatioAvg":0.016139044072004966},{"readMsMax":"0","computeMsMax":"6","inputStages":["23"],"waitMsAvg":"1","id":"24","endMs":"1570992916377","waitMsMax":"1","startMs":"1570992916322","waitRatioMax":0.0006207324643078833,"readRatioAvg":0,"parallelInputs":"2","recordsRead":"11","computeRatioAvg":0.0037243947858473,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.018001241464928614,"readMsAvg":"0","waitRatioAvg":0.0006207324643078833,"completedParallelInputs":"2","computeRatioMax":0.0037243947858473,"name":"S18: Sort+","shuffleOutputBytes":"297","recordsWritten":"11","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$130, $400","FROM __stage17_output"]},{"kind":"COMPUTE","substeps":["$110 := multiply($421, 50)"]},{"kind":"SORT","substeps":["$410 ASC, $120 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $410 := $400","$120 := SUM_OF_COUNTS($130)"]},{"kind":"WRITE","substeps":["$110, $420, $421","TO __stage18_output"]}],"writeRatioAvg":0.018001241464928614},{"readMsMax":"0","computeMsMax":"3","inputStages":["24"],"waitMsAvg":"1","id":"25","endMs":"1570992916391","waitMsMax":"1","startMs":"1570992916336","waitRatioMax":0.0006207324643078833,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"11","computeRatioAvg":0.00186219739292365,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002482929857231533,"readMsAvg":"0","waitRatioAvg":0.0006207324643078833,"completedParallelInputs":"1","computeRatioMax":0.00186219739292365,"name":"S19: Output","shuffleOutputBytes":"297","recordsWritten":"11","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110, $420, $421","FROM __stage18_output"]},{"kind":"SORT","substeps":["$421 ASC, $420 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$430, $431, $432","TO __stage19_output"]}],"writeRatioAvg":0.002482929857231533}],"estimatedBytesProcessed":"11663225292","timeline":[{"totalSlotMs":"18988","activeUnits":"234","completedUnits":"8","elapsedMs":"705","pendingUnits":"234"},{"totalSlotMs":"123936","activeUnits":"185","completedUnits":"467","elapsedMs":"1776","pendingUnits":"185"},{"totalSlotMs":"231770","activeUnits":"1","completedUnits":"851","elapsedMs":"2423","pendingUnits":"1"},{"totalSlotMs":"234573","activeUnits":"2","completedUnits":"875","elapsedMs":"3893","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"11663310848","totalPartitionsProcessed":"0","totalBytesProcessed":"11663225292","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_100"}]},"endTime":"1570992916600"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query54_1570992910"},"etag":"9RykXg4D3HJkdjkJ4AeGOQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query54_1570992910?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon88bab7bdc497900e907a9b8b84667815890d3d8f","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query54\nWITH my_customers \n AS (SELECT DISTINCT c_customer_sk, \n c_current_addr_sk \n FROM (SELECT cs_sold_date_sk sold_date_sk, \n cs_bill_customer_sk customer_sk, \n cs_item_sk item_sk \n FROM catalog_sales \n UNION ALL \n SELECT ws_sold_date_sk sold_date_sk, \n ws_bill_customer_sk customer_sk, \n ws_item_sk item_sk \n FROM web_sales) cs_or_ws_sales, \n item, \n date_dim, \n customer \n WHERE sold_date_sk = d_date_sk \n AND item_sk = i_item_sk \n AND i_category = 'Sports' \n AND i_class = 'fitness' \n AND c_customer_sk = cs_or_ws_sales.customer_sk \n AND d_moy = 5 \n AND d_year = 2000), \n my_revenue \n AS (SELECT c_customer_sk, \n Sum(ss_ext_sales_price) AS revenue \n FROM my_customers, \n store_sales, \n customer_address, \n store, \n date_dim \n WHERE c_current_addr_sk = ca_address_sk \n AND ca_county = s_county \n AND ca_state = s_state \n AND ss_sold_date_sk = d_date_sk \n AND c_customer_sk = ss_customer_sk \n AND d_month_seq BETWEEN (SELECT DISTINCT d_month_seq + 1 \n FROM date_dim \n WHERE d_year = 2000 \n AND d_moy = 5) AND \n (SELECT DISTINCT \n d_month_seq + 3 \n FROM date_dim \n WHERE d_year = 2000 \n AND d_moy = 5) \n GROUP BY c_customer_sk), \n segments \n AS (SELECT Floor(revenue / 50) AS segment \n FROM my_revenue) \nSELECT segment, \n Count(*) AS num_customers, \n segment benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results scale_2.zip warmup 50 AS segment_base \nFROM segments \nGROUP BY segment \nORDER BY segment, \n num_customers\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query54_1570992910","user_email":"nithish.sankaranarayanan@ulb.be"}
