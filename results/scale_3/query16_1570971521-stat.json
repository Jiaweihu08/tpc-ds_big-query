{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"117502","creationTime":"1570971522239","totalBytesProcessed":"819331819","startTime":"1570971522427","query":{"totalSlotMs":"117502","queryPlan":[{"readMsMax":"57","computeMsMax":"879","waitMsAvg":"1","id":"0","endMs":"1570971523160","waitMsMax":"1","startMs":"1570971522613","waitRatioMax":0.0006640106241699867,"readRatioAvg":0.037848605577689244,"parallelInputs":"1","recordsRead":"1439802","computeRatioAvg":0.5836653386454184,"writeMsAvg":"88","status":"COMPLETE","writeMsMax":"88","computeMsAvg":"879","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05843293492695883,"readMsAvg":"57","waitRatioAvg":0.0006640106241699867,"completedParallelInputs":"1","computeRatioMax":0.5836653386454184,"name":"S00: Input","shuffleOutputBytes":"12958218","recordsWritten":"1439802","readRatioMax":0.037848605577689244,"steps":[{"kind":"READ","substeps":["$1:cr_order_number","FROM catalog_returns"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.05843293492695883},{"readMsMax":"151","computeMsMax":"1506","waitMsAvg":"96","id":"1","endMs":"1570971523666","waitMsMax":"171","startMs":"1570971522656","waitRatioMax":0.11354581673306773,"readRatioAvg":0.07901726427622842,"parallelInputs":"8","recordsRead":"14397323","computeRatioAvg":0.8944223107569721,"writeMsAvg":"63","status":"COMPLETE","writeMsMax":"109","computeMsAvg":"1347","shuffleOutputBytesSpilled":"0","writeRatioMax":0.07237715803452856,"readMsAvg":"119","waitRatioAvg":0.06374501992031872,"completedParallelInputs":"8","computeRatioMax":1,"name":"S01: Input","shuffleOutputBytes":"258577390","recordsWritten":"14397323","readRatioMax":0.10026560424966799,"steps":[{"kind":"READ","substeps":["$10:cs_warehouse_sk, $11:cs_order_number","FROM catalog_sales"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage01_output","BY HASH($11)"]}],"writeRatioAvg":0.04183266932270916},{"readMsMax":"35","computeMsMax":"11","waitMsAvg":"21","id":"2","endMs":"1570971522742","waitMsMax":"21","startMs":"1570971522671","waitRatioMax":0.013944223107569721,"readRatioAvg":0.023240371845949535,"parallelInputs":"1","recordsRead":"24","computeRatioAvg":0.0073041168658698535,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004648074369189907,"readMsAvg":"35","waitRatioAvg":0.013944223107569721,"completedParallelInputs":"1","computeRatioMax":0.0073041168658698535,"name":"S02: Input","shuffleOutputBytes":"63","recordsWritten":"7","readRatioMax":0.023240371845949535,"steps":[{"kind":"READ","substeps":["$20:cc_call_center_sk, $21:cc_county","FROM call_center","WHERE in($21, 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County')"]},{"kind":"WRITE","substeps":["$20","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.004648074369189907},{"readMsMax":"55","computeMsMax":"9","waitMsAvg":"10","id":"3","endMs":"1570971522750","waitMsMax":"10","startMs":"1570971522678","waitRatioMax":0.006640106241699867,"readRatioAvg":0.03652058432934927,"parallelInputs":"1","recordsRead":"250000","computeRatioAvg":0.00597609561752988,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0026560424966799467,"readMsAvg":"55","waitRatioAvg":0.006640106241699867,"completedParallelInputs":"1","computeRatioMax":0.00597609561752988,"name":"S03: Input","shuffleOutputBytes":"68913","recordsWritten":"7657","readRatioMax":0.03652058432934927,"steps":[{"kind":"READ","substeps":["$40:ca_address_sk, $41:ca_state","FROM customer_address","WHERE equal($41, 'IA')"]},{"kind":"WRITE","substeps":["$40","TO __stage03_output","BY HASH($40)"]}],"writeRatioAvg":0.0026560424966799467},{"readMsMax":"12","computeMsMax":"18","waitMsAvg":"13","id":"4","endMs":"1570971523048","waitMsMax":"13","startMs":"1570971522699","waitRatioMax":0.008632138114209827,"readRatioAvg":0.00796812749003984,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.01195219123505976,"writeMsAvg":"138","status":"COMPLETE","writeMsMax":"138","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.09163346613545817,"readMsAvg":"12","waitRatioAvg":0.008632138114209827,"completedParallelInputs":"1","computeRatioMax":0.01195219123505976,"name":"S04: Input","shuffleOutputBytes":"558","recordsWritten":"62","readRatioMax":0.00796812749003984,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_date","FROM date_dim","WHERE between(CAST($51 AS DATE), 11747, 11808)"]},{"kind":"WRITE","substeps":["$50","TO __stage04_output","BY HASH($50)"]}],"writeRatioAvg":0.09163346613545817},{"readMsMax":"172","computeMsMax":"1102","inputStages":["2","3","4"],"waitMsAvg":"2","id":"6","endMs":"1570971524076","waitMsMax":"2","startMs":"1570971523265","waitRatioMax":0.0013280212483399733,"readRatioAvg":0.08432934926958831,"parallelInputs":"8","recordsRead":"14459131","computeRatioAvg":0.601593625498008,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"906","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00597609561752988,"readMsAvg":"127","waitRatioAvg":0.0013280212483399733,"completedParallelInputs":"8","computeRatioMax":0.7317397078353254,"name":"S06: Join","shuffleOutputBytes":"90724","recordsWritten":"2521","readRatioMax":0.11420982735723771,"steps":[{"kind":"READ","substeps":["$30:cs_ship_date_sk, $31:cs_ship_addr_sk, $32:cs_call_center_sk, $33:cs_warehouse_sk, $34:cs_order_number, $35:cs_ext_ship_cost, $36:cs_net_profit","FROM catalog_sales"]},{"kind":"READ","substeps":["$50","FROM __stage04_output"]},{"kind":"READ","substeps":["$40","FROM __stage03_output"]},{"kind":"READ","substeps":["$20","FROM __stage02_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $190 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $180 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $30 = $50"]},{"kind":"WRITE","substeps":["$200, $201, $202, $203","TO __stage06_output","BY HASH($201)"]}],"writeRatioAvg":0.0033200531208499337},{"readMsMax":"0","computeMsMax":"18","inputStages":["0"],"waitMsAvg":"1","id":"7","endMs":"1570971523522","waitMsMax":"3","startMs":"1570971523311","waitRatioMax":0.00199203187250996,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1439802","computeRatioAvg":0.00796812749003984,"writeMsAvg":"118","status":"COMPLETE","writeMsMax":"140","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.09296148738379814,"readMsAvg":"0","waitRatioAvg":0.0006640106241699867,"completedParallelInputs":"100","computeRatioMax":0.01195219123505976,"name":"S07: Coalesce","shuffleOutputBytes":"12958218","recordsWritten":"1439802","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage00_output"]}],"writeRatioAvg":0.07835325365205843},{"readMsMax":"0","computeMsMax":"965","inputStages":["7","1","6"],"waitMsAvg":"3","id":"8","endMs":"1570971524851","waitMsMax":"5","startMs":"1570971524116","waitRatioMax":0.0033200531208499337,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"158380044","computeRatioAvg":0.44687915006640105,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"76","computeMsAvg":"673","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05046480743691899,"readMsAvg":"0","waitRatioAvg":0.00199203187250996,"completedParallelInputs":"100","computeRatioMax":0.6407702523240372,"name":"S08: Join+","shuffleOutputBytes":"8360","recordsWritten":"380","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$200, $201, $202, $203","FROM __stage06_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage01_output"]},{"kind":"READ","substeps":["$1","FROM __stage07_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $170, $231 := $150","$140 := SUM($152)","$141 := SUM($151)"]},{"kind":"COMPUTE","substeps":["$150 := if(equal($170, 1), $220, NULL)","$151 := if(equal($170, 0), $222, NULL)","$152 := if(equal($170, 0), $221, NULL)"]},{"kind":"COMPUTE","substeps":["$160 := ARRAY<...>"]},{"kind":"JOIN","substeps":["ANTI HASH JOIN EACH WITH ALL ON $211 = $1"]},{"kind":"JOIN","substeps":["SEMI HASH JOIN EACH WITH EACH ON $201 = $11"]},{"kind":"WRITE","substeps":["$140, $141, $231, $230","TO __stage08_output","BY HASH($230, $231)"]}],"writeRatioAvg":0.005312084993359893},{"readMsMax":"0","computeMsMax":"7","inputStages":["8"],"waitMsAvg":"1","id":"9","endMs":"1570971525106","waitMsMax":"1","startMs":"1570971524940","waitRatioMax":0.0006640106241699867,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"380","computeRatioAvg":0.004648074369189907,"writeMsAvg":"141","status":"COMPLETE","writeMsMax":"141","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.09362549800796813,"readMsAvg":"0","waitRatioAvg":0.0006640106241699867,"completedParallelInputs":"1","computeRatioMax":0.004648074369189907,"name":"S09: Aggregate+","shuffleOutputBytes":"56","recordsWritten":"2","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$140, $141, $231, $230","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $250 := $240","$110 := COUNT($122)","$111 := ANY_VALUE($121)","$112 := ANY_VALUE($120)"]},{"kind":"COMPUTE","substeps":["$120 := if(equal($240, 0), $131, NULL)","$121 := if(equal($240, 0), $130, NULL)","$122 := if(equal($240, 1), $241, NULL)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230, $241 := $231","$130 := SUM($140)","$131 := SUM($141)"]},{"kind":"WRITE","substeps":["$110, $111, $112, $250","TO __stage09_output","BY HASH($250)"]}],"writeRatioAvg":0.09362549800796813},{"readMsMax":"0","computeMsMax":"6","inputStages":["9"],"waitMsAvg":"1","id":"10","endMs":"1570971525351","waitMsMax":"1","startMs":"1570971525125","waitRatioMax":0.0006640106241699867,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2","computeRatioAvg":0.00398406374501992,"writeMsAvg":"30","status":"COMPLETE","writeMsMax":"30","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0199203187250996,"readMsAvg":"0","waitRatioAvg":0.0006640106241699867,"completedParallelInputs":"1","computeRatioMax":0.00398406374501992,"name":"S0A: Aggregate+","shuffleOutputBytes":"27","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110, $111, $112, $250","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["$80 := ANY_VALUE($92)","$81 := ANY_VALUE($91)","$82 := ANY_VALUE($90)"]},{"kind":"COMPUTE","substeps":["$90 := if(equal($260, 0), $102, NULL)","$91 := if(equal($260, 0), $101, NULL)","$92 := if(equal($260, 1), $100, NULL)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $260 := $250","$100 := SUM_OF_COUNTS($110)","$101 := ANY_VALUE($111)","$102 := ANY_VALUE($112)"]},{"kind":"WRITE","substeps":["$80, $81, $82","TO __stage0A_output"]}],"writeRatioAvg":0.0199203187250996},{"readMsMax":"0","computeMsMax":"7","inputStages":["10"],"waitMsAvg":"1","id":"11","endMs":"1570971525401","waitMsMax":"1","startMs":"1570971525146","waitRatioMax":0.0006640106241699867,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.004648074369189907,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005312084993359893,"readMsAvg":"0","waitRatioAvg":0.0006640106241699867,"completedParallelInputs":"1","computeRatioMax":0.004648074369189907,"name":"S0B: Output","shuffleOutputBytes":"27","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$80, $81, $82","FROM __stage0A_output"]},{"kind":"SORT","substeps":["$60 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$60 := if(is_null($70), 0, $70)"]},{"kind":"AGGREGATE","substeps":["$70 := ANY_VALUE($80)","$71 := ANY_VALUE($81)","$72 := ANY_VALUE($82)"]},{"kind":"WRITE","substeps":["$270, $271, $272","TO __stage0B_output"]}],"writeRatioAvg":0.005312084993359893}],"estimatedBytesProcessed":"819331819","timeline":[{"totalSlotMs":"3576","activeUnits":"17","completedUnits":"3","elapsedMs":"688","pendingUnits":"17"},{"totalSlotMs":"40337","activeUnits":"100","completedUnits":"120","elapsedMs":"1743","pendingUnits":"100"},{"totalSlotMs":"117502","activeUnits":"0","completedUnits":"223","elapsedMs":"3172","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"819986432","totalPartitionsProcessed":"0","totalBytesProcessed":"819331819","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"call_center","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_10"}]},"endTime":"1570971525634"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query16_1570971521"},"etag":"XuXnJtmfj5DZ1jVz5hYSIw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query16_1570971521?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon91c179dc07acbfab99ad97a0c4258d387f974636","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query16\nSELECT\n Count(DISTINCT cs_order_number) AS order_count ,\n Sum(cs_ext_ship_cost) AS total_shipping_cost ,\n Sum(cs_net_profit) AS total_net_profit\nFROM catalog_sales cs1 ,\n date_dim ,\n customer_address ,\n call_center\nWHERE Cast(d_date AS DATE) BETWEEN Cast('2002-3-01' AS DATE) AND (\n Cast('2002-5-01' AS DATE))\nAND cs1.cs_ship_date_sk = d_date_sk\nAND cs1.cs_ship_addr_sk = ca_address_sk\nAND ca_state = 'IA'\nAND cs1.cs_call_center_sk = cc_call_center_sk\nAND cc_county IN ('Williamson County',\n 'Williamson County',\n 'Williamson County',\n 'Williamson County',\n 'Williamson County' )\nAND EXISTS\n (\n SELECT *\n FROM catalog_sales cs2\n WHERE cs1.cs_order_number = cs2.cs_order_number\n AND cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\nAND NOT EXISTS\n (\n SELECT *\n FROM catalog_returns cr1\n WHERE cs1.cs_order_number = cr1.cr_order_number)\nORDER BY count(DISTINCT cs_order_number)\nLIMIT 100;\n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query16_1570971521","user_email":"nithish.sankaranarayanan@ulb.be"}
