{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"351982","creationTime":"1570992130397","totalBytesProcessed":"21606126782","startTime":"1570992130528","query":{"totalSlotMs":"351982","queryPlan":[{"readMsMax":"8","computeMsMax":"7","waitMsAvg":"1","id":"0","endMs":"1570992130781","waitMsMax":"1","startMs":"1570992130733","waitRatioMax":0.000715307582260372,"readRatioAvg":0.005722460658082976,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.005007153075822604,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012875536480686695,"readMsAvg":"8","waitRatioAvg":0.000715307582260372,"completedParallelInputs":"1","computeRatioMax":0.005007153075822604,"name":"S00: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.005722460658082976,"steps":[{"kind":"READ","substeps":["$1:d_date_sk, $2:d_year","FROM date_dim","WHERE equal($2, 2001)"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.012875536480686695},{"readMsMax":"19","computeMsMax":"210","waitMsAvg":"25","id":"1","endMs":"1570992130940","waitMsMax":"25","startMs":"1570992130776","waitRatioMax":0.0178826895565093,"readRatioAvg":0.013590844062947067,"parallelInputs":"1","recordsRead":"1000000","computeRatioAvg":0.15021459227467812,"writeMsAvg":"32","status":"COMPLETE","writeMsMax":"32","computeMsAvg":"210","shuffleOutputBytesSpilled":"0","writeRatioMax":0.022889842632331903,"readMsAvg":"19","waitRatioAvg":0.0178826895565093,"completedParallelInputs":"1","computeRatioMax":0.15021459227467812,"name":"S01: Input","shuffleOutputBytes":"3922832","recordsWritten":"245177","readRatioMax":0.013590844062947067,"steps":[{"kind":"READ","substeps":["$10:ca_address_sk, $11:ca_state, $12:ca_country","FROM customer_address","WHERE and(equal($12, 'United States'), or(in($11, 'AZ', 'NE', 'IA'), in($11, 'MS', 'CA', 'NV'), in($11, 'GA', 'TX', 'NJ')))"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.022889842632331903},{"readMsMax":"30","computeMsMax":"9","waitMsAvg":"9","id":"2","endMs":"1570992130838","waitMsMax":"9","startMs":"1570992130781","waitRatioMax":0.006437768240343348,"readRatioAvg":0.02145922746781116,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.006437768240343348,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00357653791130186,"readMsAvg":"30","waitRatioAvg":0.006437768240343348,"completedParallelInputs":"1","computeRatioMax":0.006437768240343348,"name":"S02: Input","shuffleOutputBytes":"25920","recordsWritten":"1440","readRatioMax":0.02145922746781116,"steps":[{"kind":"READ","substeps":["$20:hd_demo_sk, $21:hd_dep_count","FROM household_demographics","WHERE or(equal($21, 3), equal($21, 1), equal($21, 1))"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.00357653791130186},{"readMsMax":"58","computeMsMax":"569","waitMsAvg":"31","id":"3","endMs":"1570992131256","waitMsMax":"31","startMs":"1570992130820","waitRatioMax":0.022174535050071532,"readRatioAvg":0.04148783977110158,"parallelInputs":"1","recordsRead":"1920800","computeRatioAvg":0.40701001430615164,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"569","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012160228898426323,"readMsAvg":"58","waitRatioAvg":0.022174535050071532,"completedParallelInputs":"1","computeRatioMax":0.40701001430615164,"name":"S03: Input","shuffleOutputBytes":"14982240","recordsWritten":"493920","readRatioMax":0.04148783977110158,"steps":[{"kind":"READ","substeps":["$40:cd_demo_sk, $41:cd_marital_status, $42:cd_education_status","FROM customer_demographics","WHERE and(or(equal($41, 'U'), equal($41, 'M'), equal($41, 'D')), ...)"]},{"kind":"WRITE","substeps":["$40, $41, $42","TO __stage03_output","BY HASH($40)"]}],"writeRatioAvg":0.012160228898426323},{"readMsMax":"44","computeMsMax":"6","waitMsAvg":"17","id":"4","endMs":"1570992130877","waitMsMax":"17","startMs":"1570992130820","waitRatioMax":0.012160228898426323,"readRatioAvg":0.031473533619456366,"parallelInputs":"1","recordsRead":"402","computeRatioAvg":0.004291845493562232,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"3","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002145922746781116,"readMsAvg":"44","waitRatioAvg":0.012160228898426323,"completedParallelInputs":"1","computeRatioMax":0.004291845493562232,"name":"S04: Input","shuffleOutputBytes":"3618","recordsWritten":"402","readRatioMax":0.031473533619456366,"steps":[{"kind":"READ","substeps":["$30:s_store_sk","FROM store"]},{"kind":"WRITE","substeps":["$30","TO __stage04_output","BY HASH($30)"]}],"writeRatioAvg":0.002145922746781116},{"readMsMax":"0","computeMsMax":"13","inputStages":["3"],"waitMsAvg":"2","id":"7","endMs":"1570992131637","waitMsMax":"7","startMs":"1570992131362","waitRatioMax":0.005007153075822604,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"493920","computeRatioAvg":0.006437768240343348,"writeMsAvg":"54","status":"COMPLETE","writeMsMax":"97","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.06938483547925609,"readMsAvg":"0","waitRatioAvg":0.001430615164520744,"completedParallelInputs":"100","computeRatioMax":0.009298998569384835,"name":"S07: Coalesce","shuffleOutputBytes":"14982240","recordsWritten":"493920","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage03_output"]}],"writeRatioAvg":0.03862660944206009},{"readMsMax":"0","computeMsMax":"10","inputStages":["1"],"waitMsAvg":"5","id":"8","endMs":"1570992131504","waitMsMax":"7","startMs":"1570992131362","waitRatioMax":0.005007153075822604,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"245177","computeRatioAvg":0.004291845493562232,"writeMsAvg":"47","status":"COMPLETE","writeMsMax":"67","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04792560801144492,"readMsAvg":"0","waitRatioAvg":0.00357653791130186,"completedParallelInputs":"100","computeRatioMax":0.00715307582260372,"name":"S08: Coalesce","shuffleOutputBytes":"3922832","recordsWritten":"245177","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage01_output"]}],"writeRatioAvg":0.033619456366237484},{"readMsMax":"961","computeMsMax":"1398","inputStages":["0","8","2","7","4"],"waitMsAvg":"8","id":"9","endMs":"1570992133233","waitMsMax":"11","startMs":"1570992131379","waitRatioMax":0.007868383404864092,"readRatioAvg":0.18955650929899856,"parallelInputs":"184","recordsRead":"418272859","computeRatioAvg":0.7560801144492132,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"135","computeMsAvg":"1057","shuffleOutputBytesSpilled":"0","writeRatioMax":0.09656652360515021,"readMsAvg":"265","waitRatioAvg":0.005722460658082976,"completedParallelInputs":"184","computeRatioMax":1,"name":"S09: Join+","shuffleOutputBytes":"10276","recordsWritten":"184","readRatioMax":0.6874105865522174,"steps":[{"kind":"READ","substeps":["$50:ss_sold_date_sk, $51:ss_cdemo_sk, $52:ss_hdemo_sk, $53:ss_addr_sk, $54:ss_store_sk, $55:ss_quantity, $56:ss_sales_price, $57:ss_ext_sales_price, $58:ss_ext_wholesale_cost, $59:ss_net_profit","FROM store_sales","WHERE and(or(between($56, 100, 150), between($56, 50, 100), between($56, 150, 200)), ...)"]},{"kind":"READ","substeps":["$30","FROM __stage04_output"]},{"kind":"READ","substeps":["$40, $41, $42","FROM __stage07_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage08_output"]},{"kind":"READ","substeps":["$1","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["$70 := SHARD_AVG($150)","$71 := SHARD_AVG($151)","$72 := SHARD_AVG($152)","$73 := SUM($152)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $140 = $1"]},{"kind":"FILTER","substeps":["or(and(in($145, 'AZ', 'NE', 'IA'), between($144, 100, 200)), and(in($145, 'MS', 'CA', 'NV'), between($144, 150, 300)), ...)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $123 = $10"]},{"kind":"FILTER","substeps":["or(and(equal($120, 'U'), equal($121, 'Advanced Degree'), between($125, 100, 150), equal($129, 3)), ...)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $101 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $81 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $54 = $30"]},{"kind":"WRITE","substeps":["$70, $71, $72, $73","TO __stage09_output"]}],"writeRatioAvg":0.00357653791130186},{"readMsMax":"0","computeMsMax":"9","inputStages":["9"],"waitMsAvg":"1","id":"10","endMs":"1570992133236","waitMsMax":"1","startMs":"1570992131406","waitRatioMax":0.000715307582260372,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"184","computeRatioAvg":0.006437768240343348,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002861230329041488,"readMsAvg":"0","waitRatioAvg":0.000715307582260372,"completedParallelInputs":"1","computeRatioMax":0.006437768240343348,"name":"S0A: Output","shuffleOutputBytes":"33","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$70, $71, $72, $73","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["$60 := ROOT_AVG($70)","$61 := ROOT_AVG($71)","$62 := ROOT_AVG($72)","$63 := SUM($73)"]},{"kind":"WRITE","substeps":["$60, $61, $62, $63","TO __stage0A_output"]}],"writeRatioAvg":0.002861230329041488}],"estimatedBytesProcessed":"21606126782","timeline":[{"totalSlotMs":"24142","activeUnits":"185","completedUnits":"4","elapsedMs":"706","pendingUnits":"185"},{"totalSlotMs":"96032","activeUnits":"185","completedUnits":"205","elapsedMs":"1209","pendingUnits":"185"},{"totalSlotMs":"351982","activeUnits":"5","completedUnits":"390","elapsedMs":"2899","pendingUnits":"0"},{"totalSlotMs":"351982","activeUnits":"0","completedUnits":"390","elapsedMs":"3382","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"21606957056","totalPartitionsProcessed":"0","totalBytesProcessed":"21606126782","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer_demographics","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_100"}]},"endTime":"1570992133934"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query13_1570992128"},"etag":"W4/fCNDkKQzu2H+xapWlGA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query13_1570992128?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonecdab04015c823eb8d4c46fce7bd006b44e25137","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query13\nSELECT Avg(ss_quantity), \n Avg(ss_ext_sales_price), \n Avg(ss_ext_wholesale_cost), \n Sum(ss_ext_wholesale_cost) \nFROM store_sales, \n store, \n customer_demographics, \n household_demographics, \n customer_address, \n date_dim \nWHERE s_store_sk = ss_store_sk \n AND ss_sold_date_sk = d_date_sk \n AND d_year = 2001 \n AND ( ( ss_hdemo_sk = hd_demo_sk \n AND cd_demo_sk = ss_cdemo_sk \n AND cd_marital_status = 'U' \n AND cd_education_status = 'Advanced Degree' \n AND ss_sales_price BETWEEN 100.00 AND 150.00 \n AND hd_dep_count = 3 ) \n OR ( ss_hdemo_sk = hd_demo_sk \n AND cd_demo_sk = ss_cdemo_sk \n AND cd_marital_status = 'M' \n AND cd_education_status = 'Primary' \n AND ss_sales_price BETWEEN 50.00 AND 100.00 \n AND hd_dep_count = 1 ) \n OR ( ss_hdemo_sk = hd_demo_sk \n AND cd_demo_sk = ss_cdemo_sk \n AND cd_marital_status = 'D' \n AND cd_education_status = 'Secondary' \n AND ss_sales_price BETWEEN 150.00 AND 200.00 \n AND hd_dep_count = 1 ) ) \n AND ( ( ss_addr_sk = ca_address_sk \n AND ca_country = 'United States' \n AND ca_state IN ( 'AZ', 'NE', 'IA' ) \n AND ss_net_profit BETWEEN 100 AND 200 ) \n OR ( ss_addr_sk = ca_address_sk \n AND ca_country = 'United States' \n AND ca_state IN ( 'MS', 'CA', 'NV' ) \n AND ss_net_profit BETWEEN 150 AND 300 ) \n OR ( ss_addr_sk = ca_address_sk \n AND ca_country = 'United States' \n AND ca_state IN ( 'GA', 'TX', 'NJ' ) \n AND ss_net_profit BETWEEN 50 AND 250 ) ); \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query13_1570992128","user_email":"nithish.sankaranarayanan@ulb.be"}
