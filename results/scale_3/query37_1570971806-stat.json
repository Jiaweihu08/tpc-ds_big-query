{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"44075","creationTime":"1570971807444","totalBytesProcessed":"3272734888","startTime":"1570971807617","query":{"totalSlotMs":"44075","queryPlan":[{"readMsMax":"11","computeMsMax":"19","waitMsAvg":"11","id":"1","endMs":"1570971807884","waitMsMax":"11","startMs":"1570971807807","waitRatioMax":0.005508262393590386,"readRatioAvg":0.005508262393590386,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.009514271407110666,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00400600901352028,"readMsAvg":"11","waitRatioAvg":0.005508262393590386,"completedParallelInputs":"1","computeRatioMax":0.009514271407110666,"name":"S01: Input","shuffleOutputBytes":"558","recordsWritten":"62","readRatioMax":0.005508262393590386,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $11:d_date","FROM date_dim","WHERE between(CAST($11 AS DATE), 10656, 10717)"]},{"kind":"WRITE","substeps":["$10","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.00400600901352028},{"readMsMax":"50","computeMsMax":"29","waitMsAvg":"49","id":"3","endMs":"1570971807957","waitMsMax":"49","startMs":"1570971807873","waitRatioMax":0.024536805207811718,"readRatioAvg":0.02503755633450175,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.014521782674011016,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"29","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004506760140210316,"readMsAvg":"50","waitRatioAvg":0.024536805207811718,"completedParallelInputs":"1","computeRatioMax":0.014521782674011016,"name":"S03: Input","shuffleOutputBytes":"979","recordsWritten":"6","readRatioMax":0.02503755633450175,"steps":[{"kind":"READ","substeps":["$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_manufact_id","FROM item","WHERE and(between($23, 20, 50), in($24, 843, 815, 850, 840))"]},{"kind":"WRITE","substeps":["$20, $21, $22, $23","TO __stage03_output","BY HASH($20)"]}],"writeRatioAvg":0.004506760140210316},{"readMsMax":"46","computeMsMax":"1997","inputStages":["1","3"],"waitMsAvg":"1","id":"4","endMs":"1570971809437","waitMsMax":"1","startMs":"1570971808280","waitRatioMax":0.000500751126690035,"readRatioAvg":0.01602403605408112,"parallelInputs":"14","recordsRead":"133110952","computeRatioAvg":0.8037055583375062,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"1605","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00400600901352028,"readMsAvg":"32","waitRatioAvg":0.000500751126690035,"completedParallelInputs":"14","computeRatioMax":1,"name":"S04: Join","shuffleOutputBytes":"7291","recordsWritten":"71","readRatioMax":0.02303455182774161,"steps":[{"kind":"READ","substeps":["$30:inv_date_sk, $31:inv_item_sk, $32:inv_quantity_on_hand","FROM inventory","WHERE between($32, 100, 500)"]},{"kind":"READ","substeps":["$20, $21, $22, $23","FROM __stage03_output"]},{"kind":"READ","substeps":["$10","FROM __stage01_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $54 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $31 = $20"]},{"kind":"WRITE","substeps":["$60, $61, $62, $63","TO __stage04_output","BY HASH($60)"]}],"writeRatioAvg":0.0035052578868302454},{"readMsMax":"0","computeMsMax":"8","inputStages":["4"],"waitMsAvg":"2","id":"5","endMs":"1570971809552","waitMsMax":"4","startMs":"1570971809447","waitRatioMax":0.00200300450676014,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"71","computeRatioAvg":0.0025037556334501754,"writeMsAvg":"15","status":"COMPLETE","writeMsMax":"30","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.015022533800701052,"readMsAvg":"0","waitRatioAvg":0.00100150225338007,"completedParallelInputs":"100","computeRatioMax":0.00400600901352028,"name":"S05: Coalesce","shuffleOutputBytes":"7291","recordsWritten":"71","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage04_output"]}],"writeRatioAvg":0.007511266900350526},{"readMsMax":"22","computeMsMax":"354","inputStages":["5"],"waitMsAvg":"1","id":"6","endMs":"1570971809777","waitMsMax":"1","startMs":"1570971809466","waitRatioMax":0.000500751126690035,"readRatioAvg":0.009013520280420632,"parallelInputs":"8","recordsRead":"14397891","computeRatioAvg":0.13069604406609914,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"261","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009013520280420632,"readMsAvg":"18","waitRatioAvg":0.000500751126690035,"completedParallelInputs":"8","computeRatioMax":0.1772658988482724,"name":"S06: Join+","shuffleOutputBytes":"1496","recordsWritten":"16","readRatioMax":0.011016524787180772,"steps":[{"kind":"READ","substeps":["$1:cs_item_sk","FROM catalog_sales"]},{"kind":"READ","substeps":["$60, $61, $62, $63","FROM __stage05_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $80 := $70, $81 := $71, $82 := $72"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $60"]},{"kind":"WRITE","substeps":["$80, $81, $82","TO __stage06_output","BY HASH($80, $81, $82)"]}],"writeRatioAvg":0.0035052578868302454},{"readMsMax":"0","computeMsMax":"3","inputStages":["6"],"waitMsAvg":"2","id":"7","endMs":"1570971809859","waitMsMax":"2","startMs":"1570971809795","waitRatioMax":0.00100150225338007,"readRatioAvg":0,"parallelInputs":"2","recordsRead":"16","computeRatioAvg":0.00100150225338007,"writeMsAvg":"53","status":"COMPLETE","writeMsMax":"54","computeMsAvg":"2","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02704056084126189,"readMsAvg":"0","waitRatioAvg":0.00100150225338007,"completedParallelInputs":"2","computeRatioMax":0.0015022533800701052,"name":"S07: Sort+","shuffleOutputBytes":"187","recordsWritten":"2","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$80, $81, $82","FROM __stage06_output"]},{"kind":"SORT","substeps":["$90 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $90 := $80, $91 := $81, $92 := $82"]},{"kind":"WRITE","substeps":["$100, $101, $102","TO __stage07_output"]}],"writeRatioAvg":0.026539809714571858},{"readMsMax":"0","computeMsMax":"6","inputStages":["7"],"waitMsAvg":"1","id":"8","endMs":"1570971809884","waitMsMax":"1","startMs":"1570971809827","waitRatioMax":0.000500751126690035,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2","computeRatioAvg":0.0030045067601402104,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0030045067601402104,"readMsAvg":"0","waitRatioAvg":0.000500751126690035,"completedParallelInputs":"1","computeRatioMax":0.0030045067601402104,"name":"S08: Output","shuffleOutputBytes":"187","recordsWritten":"2","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$100, $101, $102","FROM __stage07_output"]},{"kind":"SORT","substeps":["$100 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$110, $111, $112","TO __stage08_output"]}],"writeRatioAvg":0.0030045067601402104}],"estimatedBytesProcessed":"3272734888","timeline":[{"totalSlotMs":"3778","activeUnits":"22","completedUnits":"2","elapsedMs":"666","pendingUnits":"22"},{"totalSlotMs":"41196","activeUnits":"13","completedUnits":"116","elapsedMs":"1947","pendingUnits":"8"},{"totalSlotMs":"44075","activeUnits":"8","completedUnits":"127","elapsedMs":"2497","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"3273654272","totalPartitionsProcessed":"0","totalBytesProcessed":"3272734888","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"inventory","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_10"}]},"endTime":"1570971810162"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query37_1570971806"},"etag":"f26oMSGwwLjyON08RVUcTw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query37_1570971806?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonf1981faafb15d1b93f698671d9b288f16b85583a","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query37\nSELECT \n i_item_id , \n i_item_desc , \n i_current_price \nFROM item, \n inventory, \n date_dim, \n catalog_sales \nWHERE i_current_price BETWEEN 20 AND 20 + 30 \nAND inv_item_sk = i_item_sk \nAND d_date_sk=inv_date_sk \nAND Cast(d_date AS DATE) BETWEEN Cast('1999-03-06' AS DATE) AND Cast('1999-05-06' AS DATE)\nAND i_manufact_id IN (843,815,850,840) \nAND inv_quantity_on_hand BETWEEN 100 AND 500 \nAND cs_item_sk = i_item_sk \nGROUP BY i_item_id, \n i_item_desc, \n i_current_price \nORDER BY i_item_id \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query37_1570971806","user_email":"nithish.sankaranarayanan@ulb.be"}
