{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"149504","creationTime":"1570992122950","totalBytesProcessed":"1723915795","startTime":"1570992123072","query":{"totalSlotMs":"149504","queryPlan":[{"readMsMax":"22","computeMsMax":"20","waitMsAvg":"2","id":"0","endMs":"1570992123430","waitMsMax":"2","startMs":"1570992123229","waitRatioMax":0.0024067388688327317,"readRatioAvg":0.026474127557160047,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.024067388688327317,"writeMsAvg":"149","status":"COMPLETE","writeMsMax":"149","computeMsAvg":"20","shuffleOutputBytesSpilled":"0","writeRatioMax":0.1793020457280385,"readMsAvg":"22","waitRatioAvg":0.0024067388688327317,"completedParallelInputs":"1","computeRatioMax":0.024067388688327317,"name":"S00: Input","shuffleOutputBytes":"288","recordsWritten":"32","readRatioMax":0.026474127557160047,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $11:d_date","FROM date_dim","WHERE between(CAST($11 AS DATE), 11088, 11119)"]},{"kind":"WRITE","substeps":["$10","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.1793020457280385},{"readMsMax":"211","computeMsMax":"322","waitMsAvg":"1","id":"1","endMs":"1570992124378","waitMsMax":"1","startMs":"1570992123321","waitRatioMax":0.0012033694344163659,"readRatioAvg":0.2539109506618532,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.38748495788206977,"writeMsAvg":"42","status":"COMPLETE","writeMsMax":"42","computeMsAvg":"322","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05054151624548736,"readMsAvg":"211","waitRatioAvg":0.0012033694344163659,"completedParallelInputs":"1","computeRatioMax":0.38748495788206977,"name":"S01: Input","shuffleOutputBytes":"10237253","recordsWritten":"61297","readRatioMax":0.2539109506618532,"steps":[{"kind":"READ","substeps":["$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_class, $25:i_category","FROM item","WHERE in($25, 'Home', 'Men', 'Women')"]},{"kind":"WRITE","substeps":["$20, $21, $22, $23, $24, $25","TO __stage01_output","BY HASH($20)"]}],"writeRatioAvg":0.05054151624548736},{"readMsMax":"67","computeMsMax":"831","inputStages":["0","1"],"waitMsAvg":"3","id":"3","endMs":"1570992125249","waitMsMax":"4","startMs":"1570992124452","waitRatioMax":0.0048134777376654635,"readRatioAvg":0.03730445246690734,"parallelInputs":"92","recordsRead":"76116343","computeRatioAvg":0.7906137184115524,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"148","computeMsAvg":"657","shuffleOutputBytesSpilled":"0","writeRatioMax":0.17809867629362214,"readMsAvg":"31","waitRatioAvg":0.0036101083032490976,"completedParallelInputs":"92","computeRatioMax":1,"name":"S03: Join+","shuffleOutputBytes":"34393820","recordsWritten":"205900","readRatioMax":0.08062575210589651,"steps":[{"kind":"READ","substeps":["$1:ws_sold_date_sk, $2:ws_item_sk, $3:ws_ext_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$20, $21, $22, $23, $24, $25","FROM __stage01_output"]},{"kind":"READ","substeps":["$10","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $90 := $81, $91 := $82, $92 := $85, $93 := $84, $94 := $83","$60 := SUM($80)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $70 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $2 = $20"]},{"kind":"WRITE","substeps":["$90, $91, $94, $93, $92, $60","TO __stage03_output","BY HASH($90, $91, $92, $93, $94)"]}],"writeRatioAvg":0.02286401925391095},{"readMsMax":"0","computeMsMax":"65","inputStages":["3"],"waitMsAvg":"1","id":"4","endMs":"1570992125415","waitMsMax":"1","startMs":"1570992125281","waitRatioMax":0.0012033694344163659,"readRatioAvg":0,"parallelInputs":"9","recordsRead":"205900","computeRatioAvg":0.07099879663056559,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"32","computeMsAvg":"59","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03850782190132371,"readMsAvg":"0","waitRatioAvg":0.0012033694344163659,"completedParallelInputs":"9","computeRatioMax":0.07821901323706378,"name":"S04: Aggregate","shuffleOutputBytes":"5098076","recordsWritten":"30519","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$90, $91, $94, $93, $92, $60","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $100 := $90, $101 := $91, $102 := $92, $103 := $93, $104 := $94","$50 := SUM($60)"]},{"kind":"WRITE","substeps":["$100, $101, $104, $103, $102, $50","TO __stage04_output","BY HASH($103)"]}],"writeRatioAvg":0.026474127557160047},{"readMsMax":"0","computeMsMax":"45","inputStages":["4"],"waitMsAvg":"1","id":"5","endMs":"1570992125788","waitMsMax":"2","startMs":"1570992125649","waitRatioMax":0.0024067388688327317,"readRatioAvg":0,"parallelInputs":"9","recordsRead":"30519","computeRatioAvg":0.02045728038507822,"writeMsAvg":"66","status":"COMPLETE","writeMsMax":"93","computeMsAvg":"17","shuffleOutputBytesSpilled":"0","writeRatioMax":0.11191335740072202,"readMsAvg":"0","waitRatioAvg":0.0012033694344163659,"completedParallelInputs":"9","computeRatioMax":0.05415162454873646,"name":"S05: Sort+","shuffleOutputBytes":"141824","recordsWritten":"800","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$100, $101, $104, $103, $102, $50","FROM __stage04_output"]},{"kind":"SORT","substeps":["$124 ASC, $123 ASC, $120 ASC, $121 ASC, $30 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$30 := divide(multiply($125, 100), $40)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$40 := SUM($115) OVER (PARTITION BY $113 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)"]},{"kind":"SORT","substeps":["$103 ASC"]},{"kind":"WRITE","substeps":["$130, $131, $132, $133, $134, $135, $136","TO __stage05_output"]}],"writeRatioAvg":0.07942238267148015},{"readMsMax":"0","computeMsMax":"8","inputStages":["5"],"waitMsAvg":"1","id":"6","endMs":"1570992125808","waitMsMax":"1","startMs":"1570992125740","waitRatioMax":0.0012033694344163659,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"800","computeRatioAvg":0.009626955475330927,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007220216606498195,"readMsAvg":"0","waitRatioAvg":0.0012033694344163659,"completedParallelInputs":"1","computeRatioMax":0.009626955475330927,"name":"S06: Output","shuffleOutputBytes":"16497","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$130, $131, $132, $133, $134, $135, $136","FROM __stage05_output"]},{"kind":"SORT","substeps":["$134 ASC, $133 ASC, $130 ASC, $131 ASC, $135 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$140, $141, $142, $143, $144, $145, $146","TO __stage06_output"]}],"writeRatioAvg":0.007220216606498195}],"estimatedBytesProcessed":"1723915795","timeline":[{"totalSlotMs":"9398","activeUnits":"93","completedUnits":"1","elapsedMs":"657","pendingUnits":"93"},{"totalSlotMs":"124984","activeUnits":"51","completedUnits":"43","elapsedMs":"1807","pendingUnits":"51"},{"totalSlotMs":"149504","activeUnits":"2","completedUnits":"113","elapsedMs":"2869","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"1724907520","totalPartitionsProcessed":"0","totalBytesProcessed":"1723915795","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_100"}]},"endTime":"1570992125969"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query12_1570992121"},"etag":"xh5tVE1uhOB+GefsYS5ZiQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query12_1570992121?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon25006f4a0672b41cd15431b0149c2d14c901baaf","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query12\nSELECT\n i_item_id , \n i_item_desc , \n i_category , \n i_class , \n i_current_price , \n Sum(ws_ext_sales_price) AS itemrevenue ,\n Sum(ws_ext_sales_price)*100/Sum(Sum(ws_ext_sales_price)) OVER (partition BY i_class) AS revenueratio\nFROM web_sales , \n item , \n date_dim \nWHERE ws_item_sk = i_item_sk \nAND i_category IN ('Home', \n 'Men', \n 'Women') \nAND ws_sold_date_sk = d_date_sk \nAND Cast(d_date AS DATE) BETWEEN Cast('2000-05-11' AS DATE) AND ( \n Cast('2000-06-11' AS DATE)) \nGROUP BY i_item_id , \n i_item_desc , \n i_category , \n i_class , \n i_current_price \nORDER BY i_category , \n i_class , \n i_item_id , \n i_item_desc , \n revenueratio \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query12_1570992121","user_email":"nithish.sankaranarayanan@ulb.be"}
