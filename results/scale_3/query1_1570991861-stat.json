{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"181787","creationTime":"1570991862223","totalBytesProcessed":"923699664","startTime":"1570991862395","query":{"totalSlotMs":"181787","queryPlan":[{"readMsMax":"44","computeMsMax":"9","waitMsAvg":"2","id":"0","endMs":"1570991862862","waitMsMax":"2","startMs":"1570991862668","waitRatioMax":0.000474158368895211,"readRatioAvg":0.010431484115694643,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0021337126600284497,"writeMsAvg":"100","status":"COMPLETE","writeMsMax":"100","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02370791844476055,"readMsAvg":"44","waitRatioAvg":0.000474158368895211,"completedParallelInputs":"1","computeRatioMax":0.0021337126600284497,"name":"S00: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.010431484115694643,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year","FROM date_dim","WHERE equal($51, 2001)"]},{"kind":"WRITE","substeps":["$50","TO __stage00_output","BY HASH($50)"]}],"writeRatioAvg":0.02370791844476055},{"readMsMax":"11","computeMsMax":"10","waitMsAvg":"20","id":"2","endMs":"1570991862892","waitMsMax":"20","startMs":"1570991862808","waitRatioMax":0.00474158368895211,"readRatioAvg":0.0026078710289236607,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.002370791844476055,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001896633475580844,"readMsAvg":"11","waitRatioAvg":0.00474158368895211,"completedParallelInputs":"1","computeRatioMax":0.002370791844476055,"name":"S02: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.0026078710289236607,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_year","FROM date_dim","WHERE equal($31, 2001)"]},{"kind":"WRITE","substeps":["$30","TO __stage02_output","BY HASH($30)"]}],"writeRatioAvg":0.001896633475580844},{"readMsMax":"186","computeMsMax":"3044","inputStages":["0"],"waitMsAvg":"1","id":"4","endMs":"1570991866480","waitMsMax":"1","startMs":"1570991862912","waitRatioMax":0.0002370791844476055,"readRatioAvg":0.02252252252252252,"parallelInputs":"9","recordsRead":"28194614","computeRatioAvg":0.6199620673304884,"writeMsAvg":"75","status":"COMPLETE","writeMsMax":"400","computeMsAvg":"2615","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0948316737790422,"readMsAvg":"95","waitRatioAvg":0.0002370791844476055,"completedParallelInputs":"9","computeRatioMax":0.7216690374585112,"name":"S04: Join+","shuffleOutputBytes":"142645437","recordsWritten":"5312911","readRatioMax":0.044096728307254626,"steps":[{"kind":"READ","substeps":["$40:sr_returned_date_sk, $41:sr_customer_sk, $42:sr_store_sk, $43:sr_return_amt","FROM store_returns"]},{"kind":"READ","substeps":["$50","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $170, $181 := $171","$110 := SUM($172)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $50"]},{"kind":"WRITE","substeps":["$180, $181, $110","TO __stage04_output","BY HASH($180, $181)"]}],"writeRatioAvg":0.017780938833570414},{"readMsMax":"110","computeMsMax":"3046","inputStages":["2"],"waitMsAvg":"1","id":"5","endMs":"1570991864796","waitMsMax":"2","startMs":"1570991863022","waitRatioMax":0.000474158368895211,"readRatioAvg":0.013039355144618302,"parallelInputs":"9","recordsRead":"28194614","computeRatioAvg":0.6137980085348507,"writeMsAvg":"67","status":"COMPLETE","writeMsMax":"226","computeMsAvg":"2589","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05357989568515884,"readMsAvg":"55","waitRatioAvg":0.0002370791844476055,"completedParallelInputs":"9","computeRatioMax":0.7221431958274064,"name":"S05: Join+","shuffleOutputBytes":"142645437","recordsWritten":"5312911","readRatioMax":0.026078710289236605,"steps":[{"kind":"READ","substeps":["$20:sr_returned_date_sk, $21:sr_customer_sk, $22:sr_store_sk, $23:sr_return_amt","FROM store_returns"]},{"kind":"READ","substeps":["$30","FROM __stage02_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $130 := $120, $131 := $121","$100 := SUM($122)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $30"]},{"kind":"WRITE","substeps":["$130, $131, $100","TO __stage05_output","BY HASH($130, $131)"]}],"writeRatioAvg":0.01588430535798957},{"readMsMax":"0","computeMsMax":"4218","inputStages":["4"],"waitMsAvg":"1","id":"6","endMs":"1570991871088","waitMsMax":"1","startMs":"1570991864416","waitRatioMax":0.0002370791844476055,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"3750832","computeRatioAvg":1,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"4218","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00474158368895211,"readMsAvg":"0","waitRatioAvg":0.0002370791844476055,"completedParallelInputs":"1","computeRatioMax":1,"name":"S06: Repartition","shuffleOutputBytes":"100586096","recordsWritten":"3750832","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage04_output"]}],"writeRatioAvg":0.00474158368895211},{"readMsMax":"0","computeMsMax":"4141","inputStages":["5"],"waitMsAvg":"1","id":"7","endMs":"1570991866429","waitMsMax":"1","startMs":"1570991864504","waitRatioMax":0.0002370791844476055,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"4207776","computeRatioAvg":0.9817449027975343,"writeMsAvg":"30","status":"COMPLETE","writeMsMax":"30","computeMsAvg":"4141","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007112375533428165,"readMsAvg":"0","waitRatioAvg":0.0002370791844476055,"completedParallelInputs":"1","computeRatioMax":0.9817449027975343,"name":"S07: Repartition","shuffleOutputBytes":"112891064","recordsWritten":"4207776","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage05_output"]}],"writeRatioAvg":0.007112375533428165},{"readMsMax":"0","computeMsMax":"1403","inputStages":["6","4"],"waitMsAvg":"9","id":"8","endMs":"1570991872639","waitMsMax":"11","startMs":"1570991871554","waitRatioMax":0.0026078710289236607,"readRatioAvg":0,"parallelInputs":"10","recordsRead":"5312911","computeRatioAvg":0.22569938359412042,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"952","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004978662873399715,"readMsAvg":"0","waitRatioAvg":0.0021337126600284497,"completedParallelInputs":"10","computeRatioMax":0.3326220957799905,"name":"S08: Aggregate","shuffleOutputBytes":"52440","recordsWritten":"2020","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$180, $181, $110","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $200 := $191","$80 := SHARD_AVG($90)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $180, $191 := $181","$90 := SUM($110)"]},{"kind":"WRITE","substeps":["$200, $80","TO __stage08_output","BY HASH($200)"]}],"writeRatioAvg":0.0021337126600284497},{"readMsMax":"0","computeMsMax":"9","inputStages":["8"],"waitMsAvg":"2","id":"9","endMs":"1570991872784","waitMsMax":"2","startMs":"1570991872712","waitRatioMax":0.000474158368895211,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2020","computeRatioAvg":0.0021337126600284497,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0026078710289236607,"readMsAvg":"0","waitRatioAvg":0.000474158368895211,"completedParallelInputs":"1","computeRatioMax":0.0021337126600284497,"name":"S09: Aggregate","shuffleOutputBytes":"3618","recordsWritten":"201","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$200, $80","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $210 := $200","$60 := ROOT_AVG($80)"]},{"kind":"WRITE","substeps":["$60, $210","TO __stage09_output","BY HASH($210)"]}],"writeRatioAvg":0.0026078710289236607},{"readMsMax":"214","computeMsMax":"1967","waitMsAvg":"1","id":"10","endMs":"1570991874028","waitMsMax":"1","startMs":"1570991872728","waitRatioMax":0.0002370791844476055,"readRatioAvg":0.05073494547178758,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.46633475580844,"writeMsAvg":"39","status":"COMPLETE","writeMsMax":"39","computeMsAvg":"1967","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009246088193456615,"readMsAvg":"214","waitRatioAvg":0.0002370791844476055,"completedParallelInputs":"1","computeRatioMax":0.46633475580844,"name":"S0A: Input","shuffleOutputBytes":"60000000","recordsWritten":"2000000","readRatioMax":0.05073494547178758,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_customer_id","FROM customer"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage0A_output","BY HASH($1)"]}],"writeRatioAvg":0.009246088193456615},{"readMsMax":"21","computeMsMax":"7","waitMsAvg":"2","id":"11","endMs":"1570991873195","waitMsMax":"2","startMs":"1570991872747","waitRatioMax":0.000474158368895211,"readRatioAvg":0.004978662873399715,"parallelInputs":"1","recordsRead":"402","computeRatioAvg":0.0016595542911332385,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.000948316737790422,"readMsAvg":"21","waitRatioAvg":0.000474158368895211,"completedParallelInputs":"1","computeRatioMax":0.0016595542911332385,"name":"S0B: Input","shuffleOutputBytes":"378","recordsWritten":"42","readRatioMax":0.004978662873399715,"steps":[{"kind":"READ","substeps":["$10:s_store_sk, $11:s_state","FROM store","WHERE equal($11, 'TN')"]},{"kind":"WRITE","substeps":["$10","TO __stage0B_output","BY HASH($10)"]}],"writeRatioAvg":0.000948316737790422},{"readMsMax":"0","computeMsMax":"27","inputStages":["10"],"waitMsAvg":"3","id":"14","endMs":"1570991874862","waitMsMax":"11","startMs":"1570991874114","waitRatioMax":0.0026078710289236607,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2000000","computeRatioAvg":0.0045045045045045045,"writeMsAvg":"32","status":"COMPLETE","writeMsMax":"362","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0858226647700332,"readMsAvg":"0","waitRatioAvg":0.0007112375533428165,"completedParallelInputs":"100","computeRatioMax":0.006401137980085348,"name":"S0E: Coalesce","shuffleOutputBytes":"60000000","recordsWritten":"2000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0A_output"]}],"writeRatioAvg":0.007586533902323376},{"readMsMax":"0","computeMsMax":"10","inputStages":["9"],"waitMsAvg":"10","id":"15","endMs":"1570991874232","waitMsMax":"13","startMs":"1570991874115","waitRatioMax":0.0030820293978188716,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"201","computeRatioAvg":0.0011853959222380276,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"35","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008297771455666193,"readMsAvg":"0","waitRatioAvg":0.002370791844476055,"completedParallelInputs":"100","computeRatioMax":0.002370791844476055,"name":"S0F: Coalesce","shuffleOutputBytes":"3618","recordsWritten":"201","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage09_output"]}],"writeRatioAvg":0.005689900426742532},{"readMsMax":"0","computeMsMax":"3071","inputStages":["7","5","15","14","11"],"waitMsAvg":"13","id":"16","endMs":"1570991880791","waitMsMax":"15","startMs":"1570991874126","waitRatioMax":0.0035561877667140826,"readRatioAvg":0,"parallelInputs":"10","recordsRead":"25315341","computeRatioAvg":0.5910384068278806,"writeMsAvg":"100","status":"COMPLETE","writeMsMax":"942","computeMsAvg":"2493","shuffleOutputBytesSpilled":"0","writeRatioMax":0.2233285917496444,"readMsAvg":"0","waitRatioAvg":0.0030820293978188716,"completedParallelInputs":"10","computeRatioMax":0.7280701754385965,"name":"S10: Join+","shuffleOutputBytes":"21000","recordsWritten":"1000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$130, $131, $100","FROM __stage05_output"]},{"kind":"READ","substeps":["$10","FROM __stage0B_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage0E_output"]},{"kind":"READ","substeps":["$60, $210","FROM __stage0F_output"]},{"kind":"SORT","substeps":["$220 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["greater($221, multiply($222, 1.2))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $160 = $210"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $150 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $141 = $10"]},{"kind":"AGGREGATE","substeps":["GROUP BY $140 := $130, $141 := $131","$70 := SUM($100)"]},{"kind":"WRITE","substeps":["$230","TO __stage10_output"]}],"writeRatioAvg":0.02370791844476055},{"readMsMax":"0","computeMsMax":"5","inputStages":["16"],"waitMsAvg":"5","id":"17","endMs":"1570991880811","waitMsMax":"5","startMs":"1570991874143","waitRatioMax":0.0011853959222380276,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1000","computeRatioAvg":0.0011853959222380276,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001422475106685633,"readMsAvg":"0","waitRatioAvg":0.0011853959222380276,"completedParallelInputs":"1","computeRatioMax":0.0011853959222380276,"name":"S11: Output","shuffleOutputBytes":"2100","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$230","FROM __stage10_output"]},{"kind":"SORT","substeps":["$230 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$240","TO __stage11_output"]}],"writeRatioAvg":0.001422475106685633}],"estimatedBytesProcessed":"923699664","timeline":[{"totalSlotMs":"1270","activeUnits":"18","completedUnits":"2","elapsedMs":"774","pendingUnits":"18"},{"totalSlotMs":"49377","activeUnits":"10","completedUnits":"18","elapsedMs":"2845","pendingUnits":"4"},{"totalSlotMs":"60834","activeUnits":"1","completedUnits":"21","elapsedMs":"4097","pendingUnits":"1"},{"totalSlotMs":"75724","activeUnits":"10","completedUnits":"31","elapsedMs":"10105","pendingUnits":"1"},{"totalSlotMs":"84404","activeUnits":"12","completedUnits":"34","elapsedMs":"11302","pendingUnits":"11"},{"totalSlotMs":"128602","activeUnits":"89","completedUnits":"229","elapsedMs":"12454","pendingUnits":"17"},{"totalSlotMs":"133695","activeUnits":"11","completedUnits":"235","elapsedMs":"12956","pendingUnits":"11"},{"totalSlotMs":"172967","activeUnits":"7","completedUnits":"242","elapsedMs":"16539","pendingUnits":"4"},{"totalSlotMs":"181787","activeUnits":"3","completedUnits":"246","elapsedMs":"18898","pendingUnits":"0"},{"totalSlotMs":"181787","activeUnits":"0","completedUnits":"246","elapsedMs":"19685","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"923795456","totalPartitionsProcessed":"0","totalBytesProcessed":"923699664","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_100"}]},"endTime":"1570991882109"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query1_1570991861"},"etag":"nriPCbNUrHA+JPDsATW0KQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query1_1570991861?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonce8c04c3da4b53560bb23696dda7ff265b725f5c","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query1\nWITH customer_total_return \n AS (SELECT sr_customer_sk AS ctr_customer_sk, \n sr_store_sk AS ctr_store_sk, \n Sum(sr_return_amt) AS ctr_total_return \n FROM store_returns, \n date_dim \n WHERE sr_returned_date_sk = d_date_sk \n AND d_year = 2001 \n GROUP BY sr_customer_sk, \n sr_store_sk),\nhigh_return AS (\n SELECT ctr_store_sk, Avg(ctr_total_return) benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results scale_2.zip warmup 1.2 AS return_limit\n FROM customer_total_return ctr2 \n GROUP BY ctr_store_sk\n)\nSELECT c_customer_id \nFROM customer_total_return ctr1, \n store, \n customer,\n high_return \nWHERE ctr1.ctr_total_return > high_return.return_limit\n AND s_store_sk = ctr1.ctr_store_sk \n AND s_state = 'TN' \n AND ctr1.ctr_customer_sk = c_customer_sk \n AND ctr1.ctr_store_sk = high_return.ctr_store_sk\nORDER BY c_customer_id\nLIMIT 100;\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query1_1570991861","user_email":"nithish.sankaranarayanan@ulb.be"}
