{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"210323","creationTime":"1570972323033","totalBytesProcessed":"854802124","startTime":"1570972323268","query":{"totalSlotMs":"210323","queryPlan":[{"readMsMax":"25","computeMsMax":"9","waitMsAvg":"0","id":"0","endMs":"1570972323611","waitMsMax":"0","startMs":"1570972323503","waitRatioMax":0,"readRatioAvg":0.0041274558362225525,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0014858841010401188,"writeMsAvg":"61","status":"COMPLETE","writeMsMax":"61","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010070992240383029,"readMsAvg":"25","waitRatioAvg":0,"completedParallelInputs":"1","computeRatioMax":0.0014858841010401188,"name":"S00: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0041274558362225525,"steps":[{"kind":"READ","substeps":["$110:d_date_sk, $111:d_year","FROM date_dim","WHERE and(in($111, 1999, 2000), equal($111, 1999))"]},{"kind":"WRITE","substeps":["$110, $111","TO __stage00_output","BY HASH($110)"]}],"writeRatioAvg":0.010070992240383029},{"readMsMax":"28","computeMsMax":"680","waitMsAvg":"10","id":"2","endMs":"1570972324567","waitMsMax":"10","startMs":"1570972323611","waitRatioMax":0.001650982334489021,"readRatioAvg":0.004622750536569259,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.11226679874525343,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"680","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004787848770018161,"readMsAvg":"28","waitRatioAvg":0.001650982334489021,"completedParallelInputs":"1","computeRatioMax":0.11226679874525343,"name":"S02: Input","shuffleOutputBytes":"25634188","recordsWritten":"500000","readRatioMax":0.004622750536569259,"steps":[{"kind":"READ","substeps":["$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$90, $91, $92, $93","TO __stage02_output","BY HASH($90)"]}],"writeRatioAvg":0.004787848770018161},{"readMsMax":"8","computeMsMax":"10","waitMsAvg":"51","id":"3","endMs":"1570972323821","waitMsMax":"51","startMs":"1570972323666","waitRatioMax":0.008420009905894007,"readRatioAvg":0.0013207858675912169,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.001650982334489021,"writeMsAvg":"87","status":"COMPLETE","writeMsMax":"87","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.014363546310054482,"readMsAvg":"8","waitRatioAvg":0.008420009905894007,"completedParallelInputs":"1","computeRatioMax":0.001650982334489021,"name":"S03: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0013207858675912169,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_year","FROM date_dim","WHERE and(in($81, 1999, 2000), equal($81, 1999))"]},{"kind":"WRITE","substeps":["$80, $81","TO __stage03_output","BY HASH($80)"]}],"writeRatioAvg":0.014363546310054482},{"readMsMax":"27","computeMsMax":"777","waitMsAvg":"1","id":"5","endMs":"1570972324420","waitMsMax":"1","startMs":"1570972323681","waitRatioMax":0.0001650982334489021,"readRatioAvg":0.004457652303120356,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.12828132738979692,"writeMsAvg":"142","status":"COMPLETE","writeMsMax":"142","computeMsAvg":"777","shuffleOutputBytesSpilled":"0","writeRatioMax":0.023443949149744098,"readMsAvg":"27","waitRatioAvg":0.0001650982334489021,"completedParallelInputs":"1","computeRatioMax":0.12828132738979692,"name":"S05: Input","shuffleOutputBytes":"25634188","recordsWritten":"500000","readRatioMax":0.004457652303120356,"steps":[{"kind":"READ","substeps":["$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$60, $61, $62, $63","TO __stage05_output","BY HASH($60)"]}],"writeRatioAvg":0.023443949149744098},{"readMsMax":"9","computeMsMax":"9","waitMsAvg":"1","id":"6","endMs":"1570972323847","waitMsMax":"1","startMs":"1570972323768","waitRatioMax":0.0001650982334489021,"readRatioAvg":0.0014858841010401188,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0014858841010401188,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003301964668978042,"readMsAvg":"9","waitRatioAvg":0.0001650982334489021,"completedParallelInputs":"1","computeRatioMax":0.0014858841010401188,"name":"S06: Input","shuffleOutputBytes":"6588","recordsWritten":"366","readRatioMax":0.0014858841010401188,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year","FROM date_dim","WHERE and(in($51, 1999, 2000), equal($51, 2000))"]},{"kind":"WRITE","substeps":["$50, $51","TO __stage06_output","BY HASH($50)"]}],"writeRatioAvg":0.003301964668978042},{"readMsMax":"44","computeMsMax":"828","waitMsAvg":"1","id":"8","endMs":"1570972325069","waitMsMax":"1","startMs":"1570972323911","waitRatioMax":0.0001650982334489021,"readRatioAvg":0.0072643222717516925,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.13670133729569092,"writeMsAvg":"72","status":"COMPLETE","writeMsMax":"72","computeMsAvg":"828","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01188707280832095,"readMsAvg":"44","waitRatioAvg":0.0001650982334489021,"completedParallelInputs":"1","computeRatioMax":0.13670133729569092,"name":"S08: Input","shuffleOutputBytes":"25634188","recordsWritten":"500000","readRatioMax":0.0072643222717516925,"steps":[{"kind":"READ","substeps":["$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$30, $31, $32, $33","TO __stage08_output","BY HASH($30)"]}],"writeRatioAvg":0.01188707280832095},{"readMsMax":"9","computeMsMax":"9","waitMsAvg":"3","id":"9","endMs":"1570972323975","waitMsMax":"3","startMs":"1570972323930","waitRatioMax":0.0004952947003467063,"readRatioAvg":0.0014858841010401188,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0014858841010401188,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0011556876341423147,"readMsAvg":"9","waitRatioAvg":0.0004952947003467063,"completedParallelInputs":"1","computeRatioMax":0.0014858841010401188,"name":"S09: Input","shuffleOutputBytes":"6588","recordsWritten":"366","readRatioMax":0.0014858841010401188,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_year","FROM date_dim","WHERE and(in($21, 1999, 2000), equal($21, 2000))"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage09_output","BY HASH($20)"]}],"writeRatioAvg":0.0011556876341423147},{"readMsMax":"24","computeMsMax":"682","waitMsAvg":"1","id":"11","endMs":"1570972325007","waitMsMax":"1","startMs":"1570972323957","waitRatioMax":0.0001650982334489021,"readRatioAvg":0.00396235760277365,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.11259699521215123,"writeMsAvg":"88","status":"COMPLETE","writeMsMax":"88","computeMsAvg":"682","shuffleOutputBytesSpilled":"0","writeRatioMax":0.014528644543503385,"readMsAvg":"24","waitRatioAvg":0.0001650982334489021,"completedParallelInputs":"1","computeRatioMax":0.11259699521215123,"name":"S0B: Input","shuffleOutputBytes":"25634188","recordsWritten":"500000","readRatioMax":0.00396235760277365,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$1, $2, $3, $4","TO __stage0B_output","BY HASH($1)"]}],"writeRatioAvg":0.014528644543503385},{"readMsMax":"42","computeMsMax":"3857","inputStages":["3","5"],"waitMsAvg":"1","id":"12","endMs":"1570972326947","waitMsMax":"1","startMs":"1570972324525","waitRatioMax":0.0001650982334489021,"readRatioAvg":0.005448241703813769,"parallelInputs":"4","recordsRead":"9202490","computeRatioAvg":0.5535743767541688,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"25","computeMsAvg":"3353","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0041274558362225525,"readMsAvg":"33","waitRatioAvg":0.0001650982334489021,"completedParallelInputs":"4","computeRatioMax":0.6367838864124153,"name":"S0C: Join+","shuffleOutputBytes":"24838853","recordsWritten":"412212","readRatioMax":0.006934125804853888,"steps":[{"kind":"READ","substeps":["$70:ws_sold_date_sk, $71:ws_bill_customer_sk, $72:ws_net_paid","FROM web_sales"]},{"kind":"READ","substeps":["$60, $61, $62, $63","FROM __stage05_output"]},{"kind":"READ","substeps":["$80, $81","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $310 := $300, $311 := $301, $312 := $302, $313 := $304","$180 := SUM($303)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $293 = $80"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $71 = $60"]},{"kind":"WRITE","substeps":["$310, $311, $312, $313, $180","TO __stage0C_output","BY HASH($310, $311, $312, $313)"]}],"writeRatioAvg":0.0026415717351824337},{"readMsMax":"46","computeMsMax":"5537","inputStages":["0","2"],"waitMsAvg":"1","id":"13","endMs":"1570972328762","waitMsMax":"1","startMs":"1570972324819","waitRatioMax":0.0001650982334489021,"readRatioAvg":0.0061086346376093776,"parallelInputs":"10","recordsRead":"33805762","computeRatioAvg":0.8231797919762258,"writeMsAvg":"129","status":"COMPLETE","writeMsMax":"1023","computeMsAvg":"4986","shuffleOutputBytesSpilled":"0","writeRatioMax":0.16889549281822686,"readMsAvg":"37","waitRatioAvg":0.0001650982334489021,"completedParallelInputs":"10","computeRatioMax":0.9141489186065709,"name":"S0D: Join+","shuffleOutputBytes":"144515503","recordsWritten":"2399540","readRatioMax":0.007594518738649496,"steps":[{"kind":"READ","substeps":["$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_net_paid","FROM store_sales"]},{"kind":"READ","substeps":["$90, $91, $92, $93","FROM __stage02_output"]},{"kind":"READ","substeps":["$110, $111","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $220 := $210, $221 := $211, $222 := $212, $223 := $214","$190 := SUM($213)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $203 = $110"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $101 = $90"]},{"kind":"WRITE","substeps":["$220, $221, $222, $223, $190","TO __stage0D_output","BY HASH($220, $221, $222, $223)"]}],"writeRatioAvg":0.02129767211490837},{"readMsMax":"35","computeMsMax":"3273","inputStages":["9","11"],"waitMsAvg":"6","id":"14","endMs":"1570972327070","waitMsMax":"6","startMs":"1570972325172","waitRatioMax":0.0009905894006934125,"readRatioAvg":0.004457652303120356,"parallelInputs":"4","recordsRead":"9202494","computeRatioAvg":0.5132904077926366,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"31","computeMsAvg":"3109","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005118045236915965,"readMsAvg":"27","waitRatioAvg":0.0009905894006934125,"completedParallelInputs":"4","computeRatioMax":0.5403665180782565,"name":"S0E: Join+","shuffleOutputBytes":"24951306","recordsWritten":"414031","readRatioMax":0.005778438170711574,"steps":[{"kind":"READ","substeps":["$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_net_paid","FROM web_sales"]},{"kind":"READ","substeps":["$1, $2, $3, $4","FROM __stage0B_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $360 := $350, $361 := $351, $362 := $352, $363 := $354","$150 := SUM($353)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $343 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $11 = $1"]},{"kind":"WRITE","substeps":["$360, $361, $362, $363, $150","TO __stage0E_output","BY HASH($360, $361, $362, $363)"]}],"writeRatioAvg":0.00396235760277365},{"readMsMax":"116","computeMsMax":"6057","inputStages":["6","8"],"waitMsAvg":"1","id":"15","endMs":"1570972328656","waitMsMax":"2","startMs":"1570972325319","waitRatioMax":0.0003301964668978042,"readRatioAvg":0.00627373287105828,"parallelInputs":"10","recordsRead":"33805772","computeRatioAvg":0.7871883770843652,"writeMsAvg":"34","status":"COMPLETE","writeMsMax":"103","computeMsAvg":"4768","shuffleOutputBytesSpilled":"0","writeRatioMax":0.017005118045236915,"readMsAvg":"38","waitRatioAvg":0.0001650982334489021,"completedParallelInputs":"10","computeRatioMax":1,"name":"S0F: Join+","shuffleOutputBytes":"144726950","recordsWritten":"2402760","readRatioMax":0.019151395080072645,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_net_paid","FROM store_sales"]},{"kind":"READ","substeps":["$30, $31, $32, $33","FROM __stage08_output"]},{"kind":"READ","substeps":["$50, $51","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $260 := $250, $261 := $251, $262 := $252, $263 := $254","$170 := SUM($253)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $243 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $41 = $30"]},{"kind":"WRITE","substeps":["$260, $261, $262, $263, $170","TO __stage0F_output","BY HASH($260, $261, $262, $263)"]}],"writeRatioAvg":0.005613339937262671},{"readMsMax":"0","computeMsMax":"4584","inputStages":["13"],"waitMsAvg":"1","id":"16","endMs":"1570972330362","waitMsMax":"1","startMs":"1570972327925","waitRatioMax":0.0001650982334489021,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2399540","computeRatioAvg":0.7568103021297672,"writeMsAvg":"38","status":"COMPLETE","writeMsMax":"38","computeMsAvg":"4584","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00627373287105828,"readMsAvg":"0","waitRatioAvg":0.0001650982334489021,"completedParallelInputs":"1","computeRatioMax":0.7568103021297672,"name":"S10: Repartition","shuffleOutputBytes":"144515503","recordsWritten":"2399540","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0D_output"]}],"writeRatioAvg":0.00627373287105828},{"readMsMax":"0","computeMsMax":"913","inputStages":["14"],"waitMsAvg":"2","id":"17","endMs":"1570972331171","waitMsMax":"2","startMs":"1570972330441","waitRatioMax":0.0003301964668978042,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"414031","computeRatioAvg":0.1507346871388476,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"28","computeMsAvg":"913","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004622750536569259,"readMsAvg":"0","waitRatioAvg":0.0003301964668978042,"completedParallelInputs":"1","computeRatioMax":0.1507346871388476,"name":"S11: Aggregate","shuffleOutputBytes":"3222540","recordsWritten":"107418","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$360, $361, $362, $363, $150","FROM __stage0E_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $370 := $360, $371 := $361, $372 := $362, $373 := $363","$120 := SUM($150)"]},{"kind":"WRITE","substeps":["$120, $370","TO __stage11_output","BY HASH($370)"]}],"writeRatioAvg":0.004622750536569259},{"readMsMax":"0","computeMsMax":"835","inputStages":["12"],"waitMsAvg":"4","id":"18","endMs":"1570972330939","waitMsMax":"4","startMs":"1570972330465","waitRatioMax":0.0006603929337956084,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"412212","computeRatioAvg":0.13785702492983326,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"835","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00396235760277365,"readMsAvg":"0","waitRatioAvg":0.0006603929337956084,"completedParallelInputs":"1","computeRatioMax":0.13785702492983326,"name":"S12: Aggregate+","shuffleOutputBytes":"3209400","recordsWritten":"106980","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$310, $311, $312, $313, $180","FROM __stage0C_output"]},{"kind":"FILTER","substeps":["greater($140, 0)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $320 := $310, $321 := $311, $322 := $312, $323 := $313","$140 := SUM($180)"]},{"kind":"WRITE","substeps":["$140, $320","TO __stage12_output","BY HASH($320)"]}],"writeRatioAvg":0.00396235760277365},{"readMsMax":"0","computeMsMax":"449","inputStages":["16","13"],"waitMsAvg":"1","id":"20","endMs":"1570972330783","waitMsMax":"1","startMs":"1570972330489","waitRatioMax":0.0001650982334489021,"readRatioAvg":0,"parallelInputs":"10","recordsRead":"2399540","computeRatioAvg":0.05894006934125805,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"28","computeMsAvg":"357","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004622750536569259,"readMsAvg":"0","waitRatioAvg":0.0001650982334489021,"completedParallelInputs":"10","computeRatioMax":0.07412910681855704,"name":"S14: Aggregate+","shuffleOutputBytes":"9259350","recordsWritten":"308645","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$220, $221, $222, $223, $190","FROM __stage0D_output"]},{"kind":"FILTER","substeps":["greater($160, 0)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $220, $231 := $221, $232 := $222, $233 := $223","$160 := SUM($190)"]},{"kind":"WRITE","substeps":["$160, $230","TO __stage14_output","BY HASH($230)"]}],"writeRatioAvg":0.003797259369324748},{"readMsMax":"0","computeMsMax":"29","inputStages":["20"],"waitMsAvg":"2","id":"21","endMs":"1570972330894","waitMsMax":"5","startMs":"1570972330786","waitRatioMax":0.0008254911672445105,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"308645","computeRatioAvg":0.0011556876341423147,"writeMsAvg":"35","status":"COMPLETE","writeMsMax":"63","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010401188707280832,"readMsAvg":"0","waitRatioAvg":0.0003301964668978042,"completedParallelInputs":"100","computeRatioMax":0.004787848770018161,"name":"S15: Coalesce","shuffleOutputBytes":"9259350","recordsWritten":"308645","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage14_output"]}],"writeRatioAvg":0.005778438170711574},{"readMsMax":"0","computeMsMax":"12","inputStages":["18"],"waitMsAvg":"1","id":"23","endMs":"1570972331118","waitMsMax":"3","startMs":"1570972330977","waitRatioMax":0.0004952947003467063,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"106980","computeRatioAvg":0.0009905894006934125,"writeMsAvg":"54","status":"COMPLETE","writeMsMax":"74","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012217269275218755,"readMsAvg":"0","waitRatioAvg":0.0001650982334489021,"completedParallelInputs":"100","computeRatioMax":0.001981178801386825,"name":"S17: Coalesce","shuffleOutputBytes":"3209400","recordsWritten":"106980","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage12_output"]}],"writeRatioAvg":0.008915304606240713},{"readMsMax":"0","computeMsMax":"10","inputStages":["17"],"waitMsAvg":"3","id":"25","endMs":"1570972331415","waitMsMax":"5","startMs":"1570972331312","waitRatioMax":0.0008254911672445105,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"107418","computeRatioAvg":0.0008254911672445105,"writeMsAvg":"15","status":"COMPLETE","writeMsMax":"31","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005118045236915965,"readMsAvg":"0","waitRatioAvg":0.0004952947003467063,"completedParallelInputs":"100","computeRatioMax":0.001650982334489021,"name":"S19: Coalesce","shuffleOutputBytes":"3222540","recordsWritten":"107418","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage11_output"]}],"writeRatioAvg":0.0024764735017335313},{"readMsMax":"0","computeMsMax":"5677","inputStages":["15","25","23","21"],"waitMsAvg":"8","id":"26","endMs":"1570972334546","waitMsMax":"8","startMs":"1570972331318","waitRatioMax":0.0013207858675912169,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2925803","computeRatioAvg":0.9372626712894172,"writeMsAvg":"70","status":"COMPLETE","writeMsMax":"70","computeMsAvg":"5677","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011556876341423147,"readMsAvg":"0","waitRatioAvg":0.0013207858675912169,"completedParallelInputs":"1","computeRatioMax":0.9372626712894172,"name":"S1A: Join+","shuffleOutputBytes":"4219","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$260, $261, $262, $263, $170","FROM __stage0F_output"]},{"kind":"READ","substeps":["$160, $230","FROM __stage15_output"]},{"kind":"READ","substeps":["$140, $320","FROM __stage17_output"]},{"kind":"READ","substeps":["$120, $370","FROM __stage19_output"]},{"kind":"SORT","substeps":["$380 ASC, $381 ASC, $382 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["greater(case_no_value(greater($384, 0), divide($386, $384), NULL), case_no_value(greater($385, 0), divide($383, $385), NULL))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $333 = $370"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $280 = $320"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $270 = $230"]},{"kind":"AGGREGATE","substeps":["GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263","$130 := SUM($170)"]},{"kind":"WRITE","substeps":["$390, $391, $392","TO __stage1A_output"]}],"writeRatioAvg":0.011556876341423147},{"readMsMax":"0","computeMsMax":"5","inputStages":["26"],"waitMsAvg":"1","id":"27","endMs":"1570972334600","waitMsMax":"1","startMs":"1570972331329","waitRatioMax":0.0001650982334489021,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0008254911672445105,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0009905894006934125,"readMsAvg":"0","waitRatioAvg":0.0001650982334489021,"completedParallelInputs":"1","computeRatioMax":0.0008254911672445105,"name":"S1B: Output","shuffleOutputBytes":"4219","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$390, $391, $392","FROM __stage1A_output"]},{"kind":"SORT","substeps":["$390 ASC, $391 ASC, $392 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$400, $401, $402","TO __stage1B_output"]}],"writeRatioAvg":0.0009905894006934125}],"estimatedBytesProcessed":"854802124","timeline":[{"totalSlotMs":"3992","activeUnits":"32","completedUnits":"4","elapsedMs":"737","pendingUnits":"32"},{"totalSlotMs":"55667","activeUnits":"28","completedUnits":"8","elapsedMs":"2244","pendingUnits":"28"},{"totalSlotMs":"145252","activeUnits":"24","completedUnits":"17","elapsedMs":"4135","pendingUnits":"19"},{"totalSlotMs":"169739","activeUnits":"9","completedUnits":"34","elapsedMs":"5160","pendingUnits":"3"},{"totalSlotMs":"172791","activeUnits":"1","completedUnits":"36","elapsedMs":"5891","pendingUnits":"1"},{"totalSlotMs":"200822","activeUnits":"60","completedUnits":"294","elapsedMs":"8104","pendingUnits":"57"},{"totalSlotMs":"205461","activeUnits":"2","completedUnits":"349","elapsedMs":"8611","pendingUnits":"2"},{"totalSlotMs":"210323","activeUnits":"0","completedUnits":"351","elapsedMs":"12330","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"855638016","totalPartitionsProcessed":"0","totalBytesProcessed":"854802124","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570972335636"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query74_1570972321"},"etag":"uRNPxmyAvXi8hpgqNmjbIw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query74_1570972321?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon9bd52b15d9809d5d85adb5011bdc5aed71cd7dca","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query74\nWITH year_total \n AS (SELECT c_customer_id customer_id, \n c_first_name customer_first_name, \n c_last_name customer_last_name, \n d_year AS year1, \n Sum(ss_net_paid) year_total, \n 's' sale_type \n FROM customer, \n store_sales, \n date_dim \n WHERE c_customer_sk = ss_customer_sk \n AND ss_sold_date_sk = d_date_sk \n AND d_year IN ( 1999, 1999 + 1 ) \n GROUP BY c_customer_id, \n c_first_name, \n c_last_name, \n d_year \n UNION ALL \n SELECT c_customer_id customer_id, \n c_first_name customer_first_name, \n c_last_name customer_last_name, \n d_year AS year1, \n Sum(ws_net_paid) year_total, \n 'w' sale_type \n FROM customer, \n web_sales, \n date_dim \n WHERE c_customer_sk = ws_bill_customer_sk \n AND ws_sold_date_sk = d_date_sk \n AND d_year IN ( 1999, 1999 + 1 ) \n GROUP BY c_customer_id, \n c_first_name, \n c_last_name, \n d_year) \nSELECT t_s_secyear.customer_id, \n t_s_secyear.customer_first_name, \n t_s_secyear.customer_last_name \nFROM year_total t_s_firstyear, \n year_total t_s_secyear, \n year_total t_w_firstyear, \n year_total t_w_secyear \nWHERE t_s_secyear.customer_id = t_s_firstyear.customer_id \n AND t_s_firstyear.customer_id = t_w_secyear.customer_id \n AND t_s_firstyear.customer_id = t_w_firstyear.customer_id \n AND t_s_firstyear.sale_type = 's' \n AND t_w_firstyear.sale_type = 'w' \n AND t_s_secyear.sale_type = 's' \n AND t_w_secyear.sale_type = 'w' \n AND t_s_firstyear.year1 = 1999 \n AND t_s_secyear.year1 = 1999 + 1 \n AND t_w_firstyear.year1 = 1999 \n AND t_w_secyear.year1 = 1999 + 1 \n AND t_s_firstyear.year_total > 0 \n AND t_w_firstyear.year_total > 0 \n AND CASE \n WHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / \n t_w_firstyear.year_total \n ELSE NULL \n END > CASE \n WHEN t_s_firstyear.year_total > 0 THEN \n t_s_secyear.year_total / \n t_s_firstyear.year_total \n ELSE NULL \n END \nORDER BY 1, \n 2, \n 3\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query74_1570972321","user_email":"nithish.sankaranarayanan@ulb.be"}
