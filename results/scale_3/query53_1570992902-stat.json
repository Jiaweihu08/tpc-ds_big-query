{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"110810","creationTime":"1570992904803","totalBytesProcessed":"8727742511","startTime":"1570992904937","query":{"totalSlotMs":"110810","queryPlan":[{"readMsMax":"30","computeMsMax":"9","waitMsAvg":"1","id":"0","endMs":"1570992905286","waitMsMax":"1","startMs":"1570992905088","waitRatioMax":0.0012422360248447205,"readRatioAvg":0.037267080745341616,"parallelInputs":"1","recordsRead":"402","computeRatioAvg":0.011180124223602485,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006211180124223602,"readMsAvg":"30","waitRatioAvg":0.0012422360248447205,"completedParallelInputs":"1","computeRatioMax":0.011180124223602485,"name":"S00: Input","shuffleOutputBytes":"3618","recordsWritten":"402","readRatioMax":0.037267080745341616,"steps":[{"kind":"READ","substeps":["$1:s_store_sk","FROM store"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.006211180124223602},{"readMsMax":"15","computeMsMax":"10","waitMsAvg":"26","id":"1","endMs":"1570992905341","waitMsMax":"26","startMs":"1570992905128","waitRatioMax":0.03229813664596273,"readRatioAvg":0.018633540372670808,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.012422360248447204,"writeMsAvg":"185","status":"COMPLETE","writeMsMax":"185","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.22981366459627328,"readMsAvg":"15","waitRatioAvg":0.03229813664596273,"completedParallelInputs":"1","computeRatioMax":0.012422360248447204,"name":"S01: Input","shuffleOutputBytes":"6588","recordsWritten":"366","readRatioMax":0.018633540372670808,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $22:d_qoy, $21:d_month_seq","FROM date_dim","WHERE in($21, 1199, 1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210)"]},{"kind":"WRITE","substeps":["$20, $22","TO __stage01_output","BY HASH($20)"]}],"writeRatioAvg":0.22981366459627328},{"readMsMax":"17","computeMsMax":"63","waitMsAvg":"19","id":"3","endMs":"1570992905352","waitMsMax":"19","startMs":"1570992905229","waitRatioMax":0.02360248447204969,"readRatioAvg":0.02111801242236025,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.0782608695652174,"writeMsAvg":"66","status":"COMPLETE","writeMsMax":"66","computeMsAvg":"63","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08198757763975155,"readMsAvg":"17","waitRatioAvg":0.02360248447204969,"completedParallelInputs":"1","computeRatioMax":0.0782608695652174,"name":"S03: Input","shuffleOutputBytes":"188510","recordsWritten":"10475","readRatioMax":0.02111801242236025,"steps":[{"kind":"READ","substeps":["$30:i_item_sk, $34:i_manufact_id, $31:i_brand, $32:i_class, $33:i_category","FROM item","WHERE or(and(in($33, 'Books', 'Children', 'Electronics'), in($32, 'personal', 'portable', 'reference', 'self-help'), ...), ...)"]},{"kind":"WRITE","substeps":["$30, $34","TO __stage03_output","BY HASH($30)"]}],"writeRatioAvg":0.08198757763975155},{"readMsMax":"150","computeMsMax":"805","inputStages":["0","1","3"],"waitMsAvg":"1","id":"4","endMs":"1570992905966","waitMsMax":"3","startMs":"1570992905416","waitRatioMax":0.0037267080745341614,"readRatioAvg":0.04720496894409938,"parallelInputs":"184","recordsRead":"283941635","computeRatioAvg":0.6881987577639752,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"15","computeMsAvg":"554","shuffleOutputBytesSpilled":"0","writeRatioMax":0.018633540372670808,"readMsAvg":"38","waitRatioAvg":0.0012422360248447205,"completedParallelInputs":"184","computeRatioMax":1,"name":"S04: Join+","shuffleOutputBytes":"14381031","recordsWritten":"533285","readRatioMax":0.18633540372670807,"steps":[{"kind":"READ","substeps":["$10:ss_sold_date_sk, $11:ss_item_sk, $12:ss_store_sk, $13:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$30, $34","FROM __stage03_output"]},{"kind":"READ","substeps":["$20, $22","FROM __stage01_output"]},{"kind":"READ","substeps":["$1","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $110 := $102, $111 := $101","$60 := SUM($100)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $90 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $81 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $11 = $30"]},{"kind":"WRITE","substeps":["$111, $110, $60","TO __stage04_output","BY HASH($110, $111)"]}],"writeRatioAvg":0.004968944099378882},{"readMsMax":"0","computeMsMax":"22","inputStages":["4"],"waitMsAvg":"3","id":"5","endMs":"1570992906252","waitMsMax":"4","startMs":"1570992906018","waitRatioMax":0.004968944099378882,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"533285","computeRatioAvg":0.01987577639751553,"writeMsAvg":"134","status":"COMPLETE","writeMsMax":"167","computeMsAvg":"16","shuffleOutputBytesSpilled":"0","writeRatioMax":0.20745341614906831,"readMsAvg":"0","waitRatioAvg":0.0037267080745341614,"completedParallelInputs":"18","computeRatioMax":0.02732919254658385,"name":"S05: Aggregate","shuffleOutputBytes":"66424","recordsWritten":"3692","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$111, $110, $60","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $120 := $110, $121 := $111","$50 := SUM($60)"]},{"kind":"WRITE","substeps":["$120, $50","TO __stage05_output","BY HASH($120)"]}],"writeRatioAvg":0.16645962732919253},{"readMsMax":"0","computeMsMax":"12","inputStages":["5"],"waitMsAvg":"1","id":"6","endMs":"1570992906529","waitMsMax":"1","startMs":"1570992906434","waitRatioMax":0.0012422360248447205,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"3692","computeRatioAvg":0.007453416149068323,"writeMsAvg":"34","status":"COMPLETE","writeMsMax":"56","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.06956521739130435,"readMsAvg":"0","waitRatioAvg":0.0012422360248447205,"completedParallelInputs":"18","computeRatioMax":0.014906832298136646,"name":"S06: Sort+","shuffleOutputBytes":"48576","recordsWritten":"1800","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$120, $50","FROM __stage05_output"]},{"kind":"SORT","substeps":["$40 ASC, $141 ASC, $140 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["greater(case_no_value(greater($40, 0), divide(abs(subtract($141, $40)), $40), NULL), 0.1)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$40 := AVG($131) OVER (PARTITION BY $130 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)"]},{"kind":"SORT","substeps":["$120 ASC"]},{"kind":"WRITE","substeps":["$150, $151, $152","TO __stage06_output"]}],"writeRatioAvg":0.0422360248447205},{"readMsMax":"0","computeMsMax":"7","inputStages":["6"],"waitMsAvg":"1","id":"7","endMs":"1570992906538","waitMsMax":"1","startMs":"1570992906455","waitRatioMax":0.0012422360248447205,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1800","computeRatioAvg":0.008695652173913044,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007453416149068323,"readMsAvg":"0","waitRatioAvg":0.0012422360248447205,"completedParallelInputs":"1","computeRatioMax":0.008695652173913044,"name":"S07: Output","shuffleOutputBytes":"2700","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$150, $151, $152","FROM __stage06_output"]},{"kind":"SORT","substeps":["$151 ASC, $152 ASC, $150 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$160, $161, $162","TO __stage07_output"]}],"writeRatioAvg":0.007453416149068323}],"estimatedBytesProcessed":"8727742511","timeline":[{"totalSlotMs":"8486","activeUnits":"184","completedUnits":"3","elapsedMs":"653","pendingUnits":"184"},{"totalSlotMs":"110810","activeUnits":"17","completedUnits":"224","elapsedMs":"1751","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"8728346624","totalPartitionsProcessed":"0","totalBytesProcessed":"8727742511","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_100"}]},"endTime":"1570992906718"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query53_1570992902"},"etag":"PNBirVn7ua2syjh8/sWjAw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query53_1570992902?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon0d354a45c2c17ed6157248755f80a4a81ded9071","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query53\nSELECT benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results scale_2.zip warmup \nFROM (SELECT i_manufact_id, \n Sum(ss_sales_price) sum_sales, \n Avg(Sum(ss_sales_price)) \n OVER ( \n partition BY i_manufact_id) avg_quarterly_sales \n FROM item, \n store_sales, \n date_dim, \n store \n WHERE ss_item_sk = i_item_sk \n AND ss_sold_date_sk = d_date_sk \n AND ss_store_sk = s_store_sk \n AND d_month_seq IN ( 1199, 1199 + 1, 1199 + 2, 1199 + 3, \n 1199 + 4, 1199 + 5, 1199 + 6, 1199 + 7, \n 1199 + 8, 1199 + 9, 1199 + 10, 1199 + 11 ) \n AND ( ( i_category IN ( 'Books', 'Children', 'Electronics' ) \n AND i_class IN ( 'personal', 'portable', 'reference', \n 'self-help' ) \n AND i_brand IN ( 'scholaramalgamalg #14', \n 'scholaramalgamalg #7' \n , \n 'exportiunivamalg #9', \n 'scholaramalgamalg #9' ) \n ) \n OR ( i_category IN ( 'Women', 'Music', 'Men' ) \n AND i_class IN ( 'accessories', 'classical', \n 'fragrances', \n 'pants' ) \n AND i_brand IN ( 'amalgimporto #1', \n 'edu packscholar #1', \n 'exportiimporto #1', \n 'importoamalg #1' ) ) ) \n GROUP BY i_manufact_id, \n d_qoy) tmp1 \nWHERE CASE \n WHEN avg_quarterly_sales > 0 THEN Abs (sum_sales - avg_quarterly_sales) \n / \n avg_quarterly_sales \n ELSE NULL \n END > 0.1 \nORDER BY avg_quarterly_sales, \n sum_sales, \n i_manufact_id\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query53_1570992902","user_email":"nithish.sankaranarayanan@ulb.be"}
