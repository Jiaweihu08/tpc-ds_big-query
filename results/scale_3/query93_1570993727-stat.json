{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"9475498","creationTime":"1570993729120","totalBytesProcessed":"11856786084","startTime":"1570993729352","query":{"totalSlotMs":"9475498","queryPlan":[{"readMsMax":"31","computeMsMax":"8","waitMsAvg":"1","id":"0","endMs":"1570993729678","waitMsMax":"1","startMs":"1570993729534","waitRatioMax":0.0002390628735357399,"readRatioAvg":0.007410949079607937,"parallelInputs":"1","recordsRead":"55","computeRatioAvg":0.0019125029882859192,"writeMsAvg":"58","status":"COMPLETE","writeMsMax":"58","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013865646665072914,"readMsAvg":"31","waitRatioAvg":0.0002390628735357399,"completedParallelInputs":"1","computeRatioMax":0.0019125029882859192,"name":"S00: Input","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.007410949079607937,"steps":[{"kind":"READ","substeps":["$20:r_reason_sk, $21:r_reason_desc","FROM reason","WHERE equal($21, 'reason 38')"]},{"kind":"WRITE","substeps":["$20","TO __stage00_output","BY HASH($20)"]}],"writeRatioAvg":0.013865646665072914},{"readMsMax":"94","computeMsMax":"4183","waitMsAvg":"28","id":"1","endMs":"1570993733351","waitMsMax":"57","startMs":"1570993729617","waitRatioMax":0.013626583791537174,"readRatioAvg":0.008606263447286636,"parallelInputs":"9","recordsRead":"28191329","computeRatioAvg":0.9474061678221373,"writeMsAvg":"54","status":"COMPLETE","writeMsMax":"143","computeMsAvg":"3963","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03418599091561081,"readMsAvg":"36","waitRatioAvg":0.006693760459000717,"completedParallelInputs":"9","computeRatioMax":1,"name":"S01: Input","shuffleOutputBytes":"999082460","recordsWritten":"28191329","readRatioMax":0.02247191011235955,"steps":[{"kind":"READ","substeps":["$10:sr_item_sk, $11:sr_reason_sk, $12:sr_ticket_number, $13:sr_return_quantity","FROM store_returns"]},{"kind":"WRITE","substeps":["$10, $11, $12, $13","TO __stage01_output","BY HASH($10, $12)"]}],"writeRatioAvg":0.012909395170929955},{"readMsMax":"200","computeMsMax":"3700","waitMsAvg":"2","id":"2","endMs":"1570993732510","waitMsMax":"6","startMs":"1570993729936","waitRatioMax":0.0014343772412144394,"readRatioAvg":0.010996892182644035,"parallelInputs":"184","recordsRead":"281872923","computeRatioAvg":0.6509682046378198,"writeMsAvg":"56","status":"COMPLETE","writeMsMax":"1302","computeMsAvg":"2723","shuffleOutputBytesSpilled":"0","writeRatioMax":0.31125986134353334,"readMsAvg":"46","waitRatioAvg":0.0004781257470714798,"completedParallelInputs":"184","computeRatioMax":0.8845326320822376,"name":"S02: Input","shuffleOutputBytes":"12379832247","recordsWritten":"281872923","readRatioMax":0.04781257470714798,"steps":[{"kind":"READ","substeps":["$1:ss_item_sk, $2:ss_customer_sk, $3:ss_ticket_number, $4:ss_quantity, $5:ss_sales_price","FROM store_sales"]},{"kind":"WRITE","substeps":["$1, $2, $3, $4, $5","TO __stage02_output","BY HASH($1, $3)"]}],"writeRatioAvg":0.013387520918001434},{"readMsMax":"0","computeMsMax":"3211","inputStages":["2"],"waitMsAvg":"1","id":"3","endMs":"1570993734261","waitMsMax":"3","startMs":"1570993730829","waitRatioMax":0.0007171886206072197,"readRatioAvg":0,"parallelInputs":"30","recordsRead":"55287463","computeRatioAvg":0.6605307195792494,"writeMsAvg":"41","status":"COMPLETE","writeMsMax":"75","computeMsAvg":"2763","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01792971551518049,"readMsAvg":"0","waitRatioAvg":0.0002390628735357399,"completedParallelInputs":"30","computeRatioMax":0.7676308869232609,"name":"S03: Repartition","shuffleOutputBytes":"2473302939","recordsWritten":"55287463","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage02_output"]}],"writeRatioAvg":0.009801577814965335},{"readMsMax":"0","computeMsMax":"276","inputStages":["1"],"waitMsAvg":"1","id":"4","endMs":"1570993731721","waitMsMax":"2","startMs":"1570993730830","waitRatioMax":0.0004781257470714798,"readRatioAvg":0,"parallelInputs":"30","recordsRead":"5431325","computeRatioAvg":0.054506335166148695,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"154","computeMsAvg":"228","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03681568252450394,"readMsAvg":"0","waitRatioAvg":0.0002390628735357399,"completedParallelInputs":"30","computeRatioMax":0.06598135309586421,"name":"S04: Repartition","shuffleOutputBytes":"191225268","recordsWritten":"5431325","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage01_output"]}],"writeRatioAvg":0.006215634711929237},{"readMsMax":"0","computeMsMax":"3431","inputStages":["3","2"],"waitMsAvg":"1","id":"5","endMs":"1570993734243","waitMsMax":"1","startMs":"1570993730884","waitRatioMax":0.0002390628735357399,"readRatioAvg":0,"parallelInputs":"27","recordsRead":"55053781","computeRatioAvg":0.7066698541716472,"writeMsAvg":"43","status":"COMPLETE","writeMsMax":"163","computeMsAvg":"2956","shuffleOutputBytesSpilled":"0","writeRatioMax":0.038967248386325606,"readMsAvg":"0","waitRatioAvg":0.0002390628735357399,"completedParallelInputs":"27","computeRatioMax":0.8202247191011236,"name":"S05: Repartition","shuffleOutputBytes":"2461081937","recordsWritten":"55053781","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage03_output"]}],"writeRatioAvg":0.010279703562036816},{"readMsMax":"0","computeMsMax":"280","inputStages":["4","1"],"waitMsAvg":"1","id":"6","endMs":"1570993733330","waitMsMax":"3","startMs":"1570993730886","waitRatioMax":0.0007171886206072197,"readRatioAvg":0,"parallelInputs":"27","recordsRead":"5216240","computeRatioAvg":0.05737508964857758,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"40","computeMsAvg":"240","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009562514941429595,"readMsAvg":"0","waitRatioAvg":0.0002390628735357399,"completedParallelInputs":"27","computeRatioMax":0.06693760459000717,"name":"S06: Repartition","shuffleOutputBytes":"183853432","recordsWritten":"5216240","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage04_output"]}],"writeRatioAvg":0.005498446091322017},{"readMsMax":"0","computeMsMax":"3761","inputStages":["5","2"],"waitMsAvg":"1","id":"7","endMs":"1570993734261","waitMsMax":"1","startMs":"1570993730979","waitRatioMax":0.0002390628735357399,"readRatioAvg":0,"parallelInputs":"28","recordsRead":"61774863","computeRatioAvg":0.7716949557733684,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"218","computeMsAvg":"3228","shuffleOutputBytesSpilled":"0","writeRatioMax":0.052115706430791296,"readMsAvg":"0","waitRatioAvg":0.0002390628735357399,"completedParallelInputs":"28","computeRatioMax":0.8991154673679178,"name":"S07: Repartition","shuffleOutputBytes":"2758306107","recordsWritten":"61774863","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage05_output"]}],"writeRatioAvg":0.006932823332536457},{"readMsMax":"0","computeMsMax":"308","inputStages":["6","1"],"waitMsAvg":"0","id":"8","endMs":"1570993733847","waitMsMax":"1","startMs":"1570993730981","waitRatioMax":0.0002390628735357399,"readRatioAvg":0,"parallelInputs":"28","recordsRead":"5699643","computeRatioAvg":0.061439158498685156,"writeMsAvg":"13","status":"COMPLETE","writeMsMax":"55","computeMsAvg":"257","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013148458044465695,"readMsAvg":"0","waitRatioAvg":0,"completedParallelInputs":"28","computeRatioMax":0.07363136504900789,"name":"S08: Repartition","shuffleOutputBytes":"201067732","recordsWritten":"5699643","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage06_output"]}],"writeRatioAvg":0.0031078173559646186},{"readMsMax":"0","computeMsMax":"4048","inputStages":["7","2"],"waitMsAvg":"1","id":"9","endMs":"1570993734512","waitMsMax":"1","startMs":"1570993731214","waitRatioMax":0.0002390628735357399,"readRatioAvg":0,"parallelInputs":"15","recordsRead":"36541747","computeRatioAvg":0.8560841501314845,"writeMsAvg":"33","status":"COMPLETE","writeMsMax":"51","computeMsAvg":"3581","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012192206550322734,"readMsAvg":"0","waitRatioAvg":0.0002390628735357399,"completedParallelInputs":"15","computeRatioMax":0.9677265120726751,"name":"S09: Repartition","shuffleOutputBytes":"1625452223","recordsWritten":"36541747","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage07_output"]}],"writeRatioAvg":0.007889074826679417},{"readMsMax":"0","computeMsMax":"323","inputStages":["8","1"],"waitMsAvg":"1","id":"10","endMs":"1570993733950","waitMsMax":"2","startMs":"1570993731216","waitRatioMax":0.0004781257470714798,"readRatioAvg":0,"parallelInputs":"15","recordsRead":"3351994","computeRatioAvg":0.06622041596939995,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"43","computeMsAvg":"277","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010279703562036816,"readMsAvg":"0","waitRatioAvg":0.0002390628735357399,"completedParallelInputs":"15","computeRatioMax":0.07721730815204399,"name":"S0A: Repartition","shuffleOutputBytes":"118421016","recordsWritten":"3351994","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage08_output"]}],"writeRatioAvg":0.0038250059765718384},{"readMsMax":"0","computeMsMax":"275","inputStages":["9","10","0","1","2"],"waitMsAvg":"193","id":"11","endMs":"1570993760661","waitMsMax":"457","startMs":"1570993733976","waitRatioMax":0.10925173320583313,"readRatioAvg":0,"parallelInputs":"1000","recordsRead":"310065252","computeRatioAvg":0.04996414056896964,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"391","computeMsAvg":"209","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0934735835524743,"readMsAvg":"0","waitRatioAvg":0.0461391345923978,"completedParallelInputs":"1000","computeRatioMax":0.06574229022232847,"name":"S0B: Join+","shuffleOutputBytes":"8364196","recordsWritten":"472514","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$1, $2, $3, $4, $5","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11, $12, $13","FROM __stage01_output"]},{"kind":"READ","substeps":["$20","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $80 := $70","$40 := SUM($50)"]},{"kind":"COMPUTE","substeps":["$50 := case_no_value(not(is_null($73)), multiply(CAST(subtract($71, $73) AS DOUBLE), $72), multiply(CAST($71 AS DOUBLE), $72))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $63 = $20"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH EACH ON $1 = $10, $3 = $12"]},{"kind":"WRITE","substeps":["$80, $40","TO __stage0B_output","BY HASH($80)"]}],"writeRatioAvg":0.0014343772412144394},{"readMsMax":"0","computeMsMax":"22","inputStages":["11"],"waitMsAvg":"1","id":"12","endMs":"1570993763026","waitMsMax":"2","startMs":"1570993761433","waitRatioMax":0.0004781257470714798,"readRatioAvg":0,"parallelInputs":"19","recordsRead":"472514","computeRatioAvg":0.004303131723643318,"writeMsAvg":"1197","status":"COMPLETE","writeMsMax":"1526","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.3648099450155391,"readMsAvg":"0","waitRatioAvg":0.0002390628735357399,"completedParallelInputs":"19","computeRatioMax":0.005259383217786278,"name":"S0C: Sort+","shuffleOutputBytes":"19000","recordsWritten":"1900","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$80, $40","FROM __stage0B_output"]},{"kind":"SORT","substeps":["$30 ASC, $90 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $90 := $80","$30 := SUM($40)"]},{"kind":"WRITE","substeps":["$100, $101","TO __stage0C_output"]}],"writeRatioAvg":0.28615825962228064},{"readMsMax":"0","computeMsMax":"18","inputStages":["12"],"waitMsAvg":"1","id":"13","endMs":"1570993763102","waitMsMax":"1","startMs":"1570993761468","waitRatioMax":0.0002390628735357399,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1900","computeRatioAvg":0.004303131723643318,"writeMsAvg":"59","status":"COMPLETE","writeMsMax":"59","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.014104709538608654,"readMsAvg":"0","waitRatioAvg":0.0002390628735357399,"completedParallelInputs":"1","computeRatioMax":0.004303131723643318,"name":"S0D: Output","shuffleOutputBytes":"1000","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$100, $101","FROM __stage0C_output"]},{"kind":"SORT","substeps":["$101 ASC, $100 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$110, $111","TO __stage0D_output"]}],"writeRatioAvg":0.014104709538608654}],"estimatedBytesProcessed":"11856786084","timeline":[{"totalSlotMs":"3633","activeUnits":"193","completedUnits":"1","elapsedMs":"681","pendingUnits":"193"},{"totalSlotMs":"613499","activeUnits":"325","completedUnits":"231","elapsedMs":"2485","pendingUnits":"163"},{"totalSlotMs":"813279","activeUnits":"161","completedUnits":"237","elapsedMs":"3661","pendingUnits":"157"},{"totalSlotMs":"1053191","activeUnits":"410","completedUnits":"383","elapsedMs":"4764","pendingUnits":"1011"},{"totalSlotMs":"1670006","activeUnits":"604","completedUnits":"791","elapsedMs":"5806","pendingUnits":"603"},{"totalSlotMs":"4745410","activeUnits":"538","completedUnits":"857","elapsedMs":"11837","pendingUnits":"537"},{"totalSlotMs":"6878140","activeUnits":"535","completedUnits":"860","elapsedMs":"16196","pendingUnits":"534"},{"totalSlotMs":"7509535","activeUnits":"531","completedUnits":"863","elapsedMs":"17546","pendingUnits":"531"},{"totalSlotMs":"8052753","activeUnits":"529","completedUnits":"865","elapsedMs":"18688","pendingUnits":"529"},{"totalSlotMs":"8933122","activeUnits":"455","completedUnits":"1053","elapsedMs":"20547","pendingUnits":"341"},{"totalSlotMs":"9209621","activeUnits":"259","completedUnits":"1191","elapsedMs":"21551","pendingUnits":"203"},{"totalSlotMs":"9369128","activeUnits":"143","completedUnits":"1303","elapsedMs":"22563","pendingUnits":"91"},{"totalSlotMs":"9431309","activeUnits":"52","completedUnits":"1393","elapsedMs":"23574","pendingUnits":"1"},{"totalSlotMs":"9458281","activeUnits":"20","completedUnits":"1394","elapsedMs":"32584","pendingUnits":"20"},{"totalSlotMs":"9475498","activeUnits":"1","completedUnits":"1414","elapsedMs":"34275","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"11857297408","totalPartitionsProcessed":"0","totalBytesProcessed":"11856786084","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"reason","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_100"}]},"endTime":"1570993763668"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query93_1570993727"},"etag":"yd/Z55D0mFMFr9xBkVSmqQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query93_1570993727?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon74e6d36834a4e9e7121abe4ca8aa0015fe46da9d","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query93\nSELECT ss_customer_sk, \n Sum(act_sales) sumsales \nFROM (SELECT ss_item_sk, \n ss_ticket_number, \n ss_customer_sk, \n CASE \n WHEN sr_return_quantity IS NOT NULL THEN \n ( ss_quantity - sr_return_quantity ) benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results scale_2.zip warmup ss_sales_price \n ELSE ( ss_quantity benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results scale_2.zip warmup ss_sales_price ) \n END act_sales \n FROM store_sales \n LEFT OUTER JOIN store_returns \n ON ( sr_item_sk = ss_item_sk \n AND sr_ticket_number = ss_ticket_number ), \n reason \n WHERE sr_reason_sk = r_reason_sk \n AND r_reason_desc = 'reason 38') t \nGROUP BY ss_customer_sk \nORDER BY sumsales, \n ss_customer_sk\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query93_1570993727","user_email":"nithish.sankaranarayanan@ulb.be"}
