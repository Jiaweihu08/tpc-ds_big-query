{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"58278","creationTime":"1570993625491","totalBytesProcessed":"365431918","startTime":"1570993625620","query":{"totalSlotMs":"58278","queryPlan":[{"readMsMax":"26","computeMsMax":"5","waitMsAvg":"9","id":"1","endMs":"1570993626083","waitMsMax":"9","startMs":"1570993625861","waitRatioMax":0.003852739726027397,"readRatioAvg":0.01113013698630137,"parallelInputs":"1","recordsRead":"20","computeRatioAvg":0.0021404109589041095,"writeMsAvg":"183","status":"COMPLETE","writeMsMax":"183","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0783390410958904,"readMsAvg":"26","waitRatioAvg":0.003852739726027397,"completedParallelInputs":"1","computeRatioMax":0.0021404109589041095,"name":"S01: Input","shuffleOutputBytes":"36","recordsWritten":"4","readRatioMax":0.01113013698630137,"steps":[{"kind":"READ","substeps":["$20:ib_income_band_sk, $21:ib_lower_bound, $22:ib_upper_bound","FROM income_band","WHERE and(greater_or_equal($21, 54986), less_or_equal($22, 104986))"]},{"kind":"WRITE","substeps":["$20","TO __stage01_output","BY HASH($20)"]}],"writeRatioAvg":0.0783390410958904},{"readMsMax":"23","computeMsMax":"14","waitMsAvg":"40","id":"2","endMs":"1570993626188","waitMsMax":"40","startMs":"1570993625977","waitRatioMax":0.017123287671232876,"readRatioAvg":0.009845890410958904,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.0059931506849315065,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"14","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0025684931506849314,"readMsAvg":"23","waitRatioAvg":0.017123287671232876,"completedParallelInputs":"1","computeRatioMax":0.0059931506849315065,"name":"S02: Input","shuffleOutputBytes":"129600","recordsWritten":"7200","readRatioMax":0.009845890410958904,"steps":[{"kind":"READ","substeps":["$10:hd_demo_sk, $11:hd_income_band_sk","FROM household_demographics"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage02_output","BY HASH($10)"]}],"writeRatioAvg":0.0025684931506849314},{"readMsMax":"43","computeMsMax":"1167","waitMsAvg":"56","id":"3","endMs":"1570993626752","waitMsMax":"56","startMs":"1570993626021","waitRatioMax":0.023972602739726026,"readRatioAvg":0.018407534246575343,"parallelInputs":"1","recordsRead":"1920800","computeRatioAvg":0.4995719178082192,"writeMsAvg":"161","status":"COMPLETE","writeMsMax":"161","computeMsAvg":"1167","shuffleOutputBytesSpilled":"0","writeRatioMax":0.06892123287671233,"readMsAvg":"43","waitRatioAvg":0.023972602739726026,"completedParallelInputs":"1","computeRatioMax":0.4995719178082192,"name":"S03: Input","shuffleOutputBytes":"17287200","recordsWritten":"1920800","readRatioMax":0.018407534246575343,"steps":[{"kind":"READ","substeps":["$30:cd_demo_sk","FROM customer_demographics"]},{"kind":"WRITE","substeps":["$30","TO __stage03_output","BY HASH($30)"]}],"writeRatioAvg":0.06892123287671233},{"readMsMax":"21","computeMsMax":"25","waitMsAvg":"82","id":"4","endMs":"1570993626153","waitMsMax":"82","startMs":"1570993626064","waitRatioMax":0.0351027397260274,"readRatioAvg":0.00898972602739726,"parallelInputs":"1","recordsRead":"1000000","computeRatioAvg":0.010702054794520547,"writeMsAvg":"48","status":"COMPLETE","writeMsMax":"48","computeMsAvg":"25","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02054794520547945,"readMsAvg":"21","waitRatioAvg":0.0351027397260274,"completedParallelInputs":"1","computeRatioMax":0.010702054794520547,"name":"S04: Input","shuffleOutputBytes":"75006","recordsWritten":"8334","readRatioMax":0.00898972602739726,"steps":[{"kind":"READ","substeps":["$50:ca_address_sk, $51:ca_city","FROM customer_address","WHERE equal($51, 'Green Acres')"]},{"kind":"WRITE","substeps":["$50","TO __stage04_output","BY HASH($50)"]}],"writeRatioAvg":0.02054794520547945},{"readMsMax":"0","computeMsMax":"10","inputStages":["4"],"waitMsAvg":"1","id":"6","endMs":"1570993626432","waitMsMax":"2","startMs":"1570993626157","waitRatioMax":0.0008561643835616438,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"8334","computeRatioAvg":0.0021404109589041095,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"42","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01797945205479452,"readMsAvg":"0","waitRatioAvg":0.0004280821917808219,"completedParallelInputs":"100","computeRatioMax":0.004280821917808219,"name":"S06: Coalesce","shuffleOutputBytes":"75006","recordsWritten":"8334","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage04_output"]}],"writeRatioAvg":0.010273972602739725},{"readMsMax":"0","computeMsMax":"19","inputStages":["3"],"waitMsAvg":"2","id":"8","endMs":"1570993627029","waitMsMax":"6","startMs":"1570993626794","waitRatioMax":0.0025684931506849314,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1920800","computeRatioAvg":0.0059931506849315065,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"71","computeMsAvg":"14","shuffleOutputBytesSpilled":"0","writeRatioMax":0.030393835616438356,"readMsAvg":"0","waitRatioAvg":0.0008561643835616438,"completedParallelInputs":"100","computeRatioMax":0.008133561643835616,"name":"S08: Coalesce","shuffleOutputBytes":"17287200","recordsWritten":"1920800","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage03_output"]}],"writeRatioAvg":0.007705479452054794},{"readMsMax":"64","computeMsMax":"2336","inputStages":["1","2","8","6"],"waitMsAvg":"1","id":"9","endMs":"1570993628359","waitMsMax":"1","startMs":"1570993626814","waitRatioMax":0.0004280821917808219,"readRatioAvg":0.0273972602739726,"parallelInputs":"1","recordsRead":"3936338","computeRatioAvg":1,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"2336","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0021404109589041095,"readMsAvg":"64","waitRatioAvg":0.0004280821917808219,"completedParallelInputs":"1","computeRatioMax":1,"name":"S09: Join","shuffleOutputBytes":"165911","recordsWritten":"3208","readRatioMax":0.0273972602739726,"steps":[{"kind":"READ","substeps":["$40:c_customer_id, $41:c_current_cdemo_sk, $42:c_current_hdemo_sk, $43:c_current_addr_sk, $44:c_first_name, $45:c_last_name","FROM customer"]},{"kind":"READ","substeps":["$50","FROM __stage06_output"]},{"kind":"READ","substeps":["$30","FROM __stage08_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage02_output"]},{"kind":"READ","substeps":["$20","FROM __stage01_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $94 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $81 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $71 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $43 = $50"]},{"kind":"WRITE","substeps":["$100, $101, $102, $103","TO __stage09_output","BY HASH($100)"]}],"writeRatioAvg":0.0021404109589041095},{"readMsMax":"0","computeMsMax":"9","inputStages":["9"],"waitMsAvg":"1","id":"10","endMs":"1570993628849","waitMsMax":"2","startMs":"1570993628749","waitRatioMax":0.0008561643835616438,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"3208","computeRatioAvg":0.0021404109589041095,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"28","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011986301369863013,"readMsAvg":"0","waitRatioAvg":0.0004280821917808219,"completedParallelInputs":"100","computeRatioMax":0.003852739726027397,"name":"S0A: Coalesce","shuffleOutputBytes":"165911","recordsWritten":"3208","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage09_output"]}],"writeRatioAvg":0.008561643835616438},{"readMsMax":"38","computeMsMax":"535","inputStages":["10"],"waitMsAvg":"2","id":"11","endMs":"1570993629165","waitMsMax":"3","startMs":"1570993628752","waitRatioMax":0.0012842465753424657,"readRatioAvg":0.009845890410958904,"parallelInputs":"9","recordsRead":"28220201","computeRatioAvg":0.19820205479452055,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"463","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003424657534246575,"readMsAvg":"23","waitRatioAvg":0.0008561643835616438,"completedParallelInputs":"9","computeRatioMax":0.22902397260273974,"name":"S0B: Join+","shuffleOutputBytes":"35661","recordsWritten":"900","readRatioMax":0.016267123287671232,"steps":[{"kind":"READ","substeps":["$1:sr_cdemo_sk","FROM store_returns"]},{"kind":"READ","substeps":["$100, $101, $102, $103","FROM __stage0A_output"]},{"kind":"COMPUTE","substeps":["$60 := concat($122, concat(', ', $121))"]},{"kind":"SORT","substeps":["$110 ASC","LIMIT 100"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $100"]},{"kind":"WRITE","substeps":["$120, $60","TO __stage0B_output"]}],"writeRatioAvg":0.0021404109589041095},{"readMsMax":"0","computeMsMax":"5","inputStages":["11"],"waitMsAvg":"1","id":"12","endMs":"1570993629184","waitMsMax":"1","startMs":"1570993628767","waitRatioMax":0.0004280821917808219,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"900","computeRatioAvg":0.0021404109589041095,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"12","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005136986301369863,"readMsAvg":"0","waitRatioAvg":0.0004280821917808219,"completedParallelInputs":"1","computeRatioMax":0.0021404109589041095,"name":"S0C: Output","shuffleOutputBytes":"3966","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$120, $60","FROM __stage0B_output"]},{"kind":"SORT","substeps":["$120 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$130, $131","TO __stage0C_output"]}],"writeRatioAvg":0.005136986301369863}],"estimatedBytesProcessed":"365431918","timeline":[{"totalSlotMs":"8282","activeUnits":"47","completedUnits":"67","elapsedMs":"714","pendingUnits":"47"},{"totalSlotMs":"43906","activeUnits":"109","completedUnits":"213","elapsedMs":"1744","pendingUnits":"1"},{"totalSlotMs":"58278","activeUnits":"10","completedUnits":"315","elapsedMs":"3825","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"365953024","totalPartitionsProcessed":"0","totalBytesProcessed":"365431918","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"income_band","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer_demographics","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_100"}]},"endTime":"1570993629468"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query84_1570993624"},"etag":"LxX9VjUL47TF7PgVoIclJA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query84_1570993624?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon31182ab16a4935610ed312c72ddbfcf68bcf5497","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query84\nSELECT c_customer_id AS customer_id, \n Concat(c_last_name, Concat(', ', c_first_name)) AS customername \nFROM customer, \n customer_address, \n customer_demographics, \n household_demographics, \n income_band, \n store_returns \nWHERE ca_city = 'Green Acres' \n AND c_current_addr_sk = ca_address_sk \n AND ib_lower_bound >= 54986 \n AND ib_upper_bound <= 54986 + 50000 \n AND ib_income_band_sk = hd_income_band_sk \n AND cd_demo_sk = c_current_cdemo_sk \n AND hd_demo_sk = c_current_hdemo_sk \n AND sr_cdemo_sk = cd_demo_sk \nORDER BY c_customer_id\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query84_1570993624","user_email":"nithish.sankaranarayanan@ulb.be"}
