{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"610535","creationTime":"1570993808861","totalBytesProcessed":"10007841344","startTime":"1570993809024","query":{"totalSlotMs":"610535","queryPlan":[{"readMsMax":"19","computeMsMax":"8","waitMsAvg":"1","id":"0","endMs":"1570993809305","waitMsMax":"1","startMs":"1570993809256","waitRatioMax":0.00012009126936471719,"readRatioAvg":0.0022817341179296267,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0009607301549177375,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007205476161883031,"readMsAvg":"19","waitRatioAvg":0.00012009126936471719,"completedParallelInputs":"1","computeRatioMax":0.0009607301549177375,"name":"S00: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.0022817341179296267,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_month_seq","FROM date_dim","WHERE between($31, 1196, 1207)"]},{"kind":"WRITE","substeps":["$30","TO __stage00_output","BY HASH($30)"]}],"writeRatioAvg":0.0007205476161883031},{"readMsMax":"8","computeMsMax":"7","waitMsAvg":"24","id":"2","endMs":"1570993809385","waitMsMax":"24","startMs":"1570993809306","waitRatioMax":0.0028821904647532122,"readRatioAvg":0.0009607301549177375,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0008406388855530203,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0022817341179296267,"readMsAvg":"8","waitRatioAvg":0.0028821904647532122,"completedParallelInputs":"1","computeRatioMax":0.0008406388855530203,"name":"S02: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.0009607301549177375,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_month_seq","FROM date_dim","WHERE between($21, 1196, 1207)"]},{"kind":"WRITE","substeps":["$20","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.0022817341179296267},{"readMsMax":"123","computeMsMax":"3102","inputStages":["0"],"waitMsAvg":"1","id":"4","endMs":"1570993811190","waitMsMax":"4","startMs":"1570993809332","waitRatioMax":0.00048036507745886876,"readRatioAvg":0.003722829350306233,"parallelInputs":"141","recordsRead":"144062057","computeRatioAvg":0.07625795604659541,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"254","computeMsAvg":"635","shuffleOutputBytesSpilled":"0","writeRatioMax":0.030503182418638166,"readMsAvg":"31","waitRatioAvg":0.00012009126936471719,"completedParallelInputs":"141","computeRatioMax":0.3725231175693527,"name":"S04: Join+","shuffleOutputBytes":"514785386","recordsWritten":"28630685","readRatioMax":0.014771226131860214,"steps":[{"kind":"READ","substeps":["$10:cs_sold_date_sk, $11:cs_bill_customer_sk, $12:cs_item_sk","FROM catalog_sales"]},{"kind":"READ","substeps":["$30","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $110 := $100, $111 := $101"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $10 = $30"]},{"kind":"WRITE","substeps":["$110, $111","TO __stage04_output","BY HASH($110, $111)"]}],"writeRatioAvg":0.002041551579200192},{"readMsMax":"78","computeMsMax":"1122","inputStages":["2"],"waitMsAvg":"3","id":"5","endMs":"1570993810340","waitMsMax":"6","startMs":"1570993809464","waitRatioMax":0.0007205476161883031,"readRatioAvg":0.00384292061967095,"parallelInputs":"184","recordsRead":"281940267","computeRatioAvg":0.10039630118890357,"writeMsAvg":"30","status":"COMPLETE","writeMsMax":"452","computeMsAvg":"836","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05428125375285217,"readMsAvg":"32","waitRatioAvg":0.00036027380809415153,"completedParallelInputs":"184","computeRatioMax":0.13474240422721268,"name":"S05: Join+","shuffleOutputBytes":"963228666","recordsWritten":"54063861","readRatioMax":0.009367119010447941,"steps":[{"kind":"READ","substeps":["$1:ss_sold_date_sk, $2:ss_item_sk, $3:ss_customer_sk","FROM store_sales"]},{"kind":"READ","substeps":["$20","FROM __stage02_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $80 := $71, $81 := $70"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $20"]},{"kind":"WRITE","substeps":["$81, $80","TO __stage05_output","BY HASH($80, $81)"]}],"writeRatioAvg":0.0036027380809415155},{"readMsMax":"0","computeMsMax":"6336","inputStages":["4"],"waitMsAvg":"1","id":"6","endMs":"1570993814730","waitMsMax":"1","startMs":"1570993811349","waitRatioMax":0.00012009126936471719,"readRatioAvg":0,"parallelInputs":"14","recordsRead":"28630685","computeRatioAvg":0.6923261678875946,"writeMsAvg":"86","status":"COMPLETE","writeMsMax":"111","computeMsAvg":"5765","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013330130899483608,"readMsAvg":"0","waitRatioAvg":0.00012009126936471719,"completedParallelInputs":"14","computeRatioMax":0.760898282694848,"name":"S06: Aggregate","shuffleOutputBytes":"514620416","recordsWritten":"28614188","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110, $111","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $120 := $110, $121 := $111"]},{"kind":"WRITE","substeps":["$120, $121","TO __stage06_output","BY HASH($120, $121)"]}],"writeRatioAvg":0.010327849165365678},{"readMsMax":"0","computeMsMax":"8327","inputStages":["5"],"waitMsAvg":"1","id":"7","endMs":"1570993816013","waitMsMax":"2","startMs":"1570993811375","waitRatioMax":0.00024018253872943438,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"54063861","computeRatioAvg":0.8635763180016813,"writeMsAvg":"145","status":"COMPLETE","writeMsMax":"196","computeMsAvg":"7191","shuffleOutputBytesSpilled":"0","writeRatioMax":0.023537888795484567,"readMsAvg":"0","waitRatioAvg":0.00012009126936471719,"completedParallelInputs":"18","computeRatioMax":1,"name":"S07: Aggregate","shuffleOutputBytes":"952185946","recordsWritten":"52959589","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$81, $80","FROM __stage05_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $90 := $80, $91 := $81"]},{"kind":"WRITE","substeps":["$90, $91","TO __stage07_output","BY HASH($90, $91)"]}],"writeRatioAvg":0.017413234057883992},{"readMsMax":"0","computeMsMax":"1105","inputStages":["6","7"],"waitMsAvg":"1","id":"8","endMs":"1570993817157","waitMsMax":"3","startMs":"1570993816016","waitRatioMax":0.00036027380809415153,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"81573777","computeRatioAvg":0.10748168608142188,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"158","computeMsAvg":"895","shuffleOutputBytesSpilled":"0","writeRatioMax":0.018974420559625314,"readMsAvg":"0","waitRatioAvg":0.00012009126936471719,"completedParallelInputs":"100","computeRatioMax":0.13270085264801249,"name":"S08: Join+","shuffleOutputBytes":"2700","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$90, $91","FROM __stage07_output"]},{"kind":"READ","substeps":["$120, $121","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["$50 := SUM($62)","$51 := SUM($61)","$52 := SUM($60)"]},{"kind":"COMPUTE","substeps":["$60 := case_no_value(and(not(is_null($130)), not(is_null($131))), 1, 0)","$61 := case_no_value(and(is_null($130), not(is_null($131))), 1, 0)","$62 := case_no_value(and(not(is_null($130)), is_null($131)), 1, 0)"]},{"kind":"JOIN","substeps":["FULL OUTER HASH JOIN EACH WITH EACH ON $90 = $120, $91 = $121"]},{"kind":"WRITE","substeps":["$50, $51, $52","TO __stage08_output"]}],"writeRatioAvg":0.0008406388855530203},{"readMsMax":"0","computeMsMax":"7","inputStages":["8"],"waitMsAvg":"1","id":"9","endMs":"1570993817156","waitMsMax":"1","startMs":"1570993816037","waitRatioMax":0.00012009126936471719,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0008406388855530203,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0006004563468235859,"readMsAvg":"0","waitRatioAvg":0.00012009126936471719,"completedParallelInputs":"1","computeRatioMax":0.0008406388855530203,"name":"S09: Output","shuffleOutputBytes":"25","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$50, $51, $52","FROM __stage08_output"]},{"kind":"LIMIT","substeps":["100"]},{"kind":"AGGREGATE","substeps":["$40 := SUM($50)","$41 := SUM($51)","$42 := SUM($52)"]},{"kind":"WRITE","substeps":["$40, $41, $42","TO __stage09_output"]}],"writeRatioAvg":0.0006004563468235859}],"estimatedBytesProcessed":"10007841344","timeline":[{"totalSlotMs":"59532","activeUnits":"214","completedUnits":"114","elapsedMs":"733","pendingUnits":"213"},{"totalSlotMs":"303785","activeUnits":"83","completedUnits":"318","elapsedMs":"1818","pendingUnits":"9"},{"totalSlotMs":"329170","activeUnits":"32","completedUnits":"327","elapsedMs":"2853","pendingUnits":"32"},{"totalSlotMs":"359389","activeUnits":"33","completedUnits":"327","elapsedMs":"3360","pendingUnits":"32"},{"totalSlotMs":"509951","activeUnits":"21","completedUnits":"348","elapsedMs":"6121","pendingUnits":"11"},{"totalSlotMs":"534209","activeUnits":"101","completedUnits":"359","elapsedMs":"7265","pendingUnits":"101"},{"totalSlotMs":"610535","activeUnits":"3","completedUnits":"460","elapsedMs":"8551","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"10008657920","totalPartitionsProcessed":"0","totalBytesProcessed":"10007841344","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_100"}]},"endTime":"1570993817604"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query97_1570993807"},"etag":"6qwsrqMS/RtJntlqkPZaKw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query97_1570993807?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon29bd586a1e010b1b03e482c56edcbbbd0796afd0","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"\n-- query97\nWITH ssci \n AS (SELECT ss_customer_sk customer_sk, \n ss_item_sk item_sk \n FROM store_sales, \n date_dim \n WHERE ss_sold_date_sk = d_date_sk \n AND d_month_seq BETWEEN 1196 AND 1196 + 11 \n GROUP BY ss_customer_sk, \n ss_item_sk), \n csci \n AS (SELECT cs_bill_customer_sk customer_sk, \n cs_item_sk item_sk \n FROM catalog_sales, \n date_dim \n WHERE cs_sold_date_sk = d_date_sk \n AND d_month_seq BETWEEN 1196 AND 1196 + 11 \n GROUP BY cs_bill_customer_sk, \n cs_item_sk) \nSELECT Sum(CASE \n WHEN ssci.customer_sk IS NOT NULL \n AND csci.customer_sk IS NULL THEN 1 \n ELSE 0 \n END) store_only, \n Sum(CASE \n WHEN ssci.customer_sk IS NULL \n AND csci.customer_sk IS NOT NULL THEN 1 \n ELSE 0 \n END) catalog_only, \n Sum(CASE \n WHEN ssci.customer_sk IS NOT NULL \n AND csci.customer_sk IS NOT NULL THEN 1 \n ELSE 0 \n END) store_and_catalog \nFROM ssci \n FULL OUTER JOIN csci \n ON ( ssci.customer_sk = csci.customer_sk \n AND ssci.item_sk = csci.item_sk )\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query97_1570993807","user_email":"nithish.sankaranarayanan@ulb.be"}
