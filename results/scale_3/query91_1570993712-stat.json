{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"42828","creationTime":"1570993714040","totalBytesProcessed":"577732282","startTime":"1570993714240","query":{"totalSlotMs":"42828","queryPlan":[{"readMsMax":"13","computeMsMax":"8","waitMsAvg":"1","id":"0","endMs":"1570993714729","waitMsMax":"1","startMs":"1570993714535","waitRatioMax":0.000564334085778781,"readRatioAvg":0.007336343115124154,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.004514672686230248,"writeMsAvg":"162","status":"COMPLETE","writeMsMax":"162","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.09142212189616253,"readMsAvg":"13","waitRatioAvg":0.000564334085778781,"completedParallelInputs":"1","computeRatioMax":0.004514672686230248,"name":"S00: Input","shuffleOutputBytes":"10800","recordsWritten":"1200","readRatioMax":0.007336343115124154,"steps":[{"kind":"READ","substeps":["$1:hd_demo_sk, $2:hd_buy_potential","FROM household_demographics","WHERE like($2, 'Unknown%')"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.09142212189616253},{"readMsMax":"21","computeMsMax":"428","waitMsAvg":"1","id":"1","endMs":"1570993714898","waitMsMax":"1","startMs":"1570993714637","waitRatioMax":0.000564334085778781,"readRatioAvg":0.011851015801354402,"parallelInputs":"1","recordsRead":"1920800","computeRatioAvg":0.24153498871331827,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"428","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011851015801354402,"readMsAvg":"21","waitRatioAvg":0.000564334085778781,"completedParallelInputs":"1","computeRatioMax":0.24153498871331827,"name":"S01: Input","shuffleOutputBytes":"3402560","recordsWritten":"109760","readRatioMax":0.011851015801354402,"steps":[{"kind":"READ","substeps":["$10:cd_demo_sk, $11:cd_marital_status, $12:cd_education_status","FROM customer_demographics","WHERE or(and(equal($11, 'M'), equal($12, 'Unknown')), and(equal($11, 'W'), equal($12, 'Advanced Degree')))"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.011851015801354402},{"readMsMax":"19","computeMsMax":"87","waitMsAvg":"24","id":"2","endMs":"1570993714920","waitMsMax":"24","startMs":"1570993714680","waitRatioMax":0.013544018058690745,"readRatioAvg":0.01072234762979684,"parallelInputs":"1","recordsRead":"1000000","computeRatioAvg":0.04909706546275395,"writeMsAvg":"40","status":"COMPLETE","writeMsMax":"40","computeMsAvg":"87","shuffleOutputBytesSpilled":"0","writeRatioMax":0.022573363431151242,"readMsAvg":"19","waitRatioAvg":0.013544018058690745,"completedParallelInputs":"1","computeRatioMax":0.04909706546275395,"name":"S02: Input","shuffleOutputBytes":"977823","recordsWritten":"108647","readRatioMax":0.01072234762979684,"steps":[{"kind":"READ","substeps":["$30:ca_address_sk, $31:ca_gmt_offset","FROM customer_address","WHERE equal($31, -7)"]},{"kind":"WRITE","substeps":["$30","TO __stage02_output","BY HASH($30)"]}],"writeRatioAvg":0.022573363431151242},{"readMsMax":"15","computeMsMax":"7","waitMsAvg":"29","id":"4","endMs":"1570993714904","waitMsMax":"29","startMs":"1570993714768","waitRatioMax":0.01636568848758465,"readRatioAvg":0.008465011286681716,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0039503386004514675,"writeMsAvg":"60","status":"COMPLETE","writeMsMax":"60","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.033860045146726865,"readMsAvg":"15","waitRatioAvg":0.01636568848758465,"completedParallelInputs":"1","computeRatioMax":0.0039503386004514675,"name":"S04: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.008465011286681716,"steps":[{"kind":"READ","substeps":["$60:d_date_sk, $61:d_year, $62:d_moy","FROM date_dim","WHERE and(equal($61, 1999), equal($62, 12))"]},{"kind":"WRITE","substeps":["$60","TO __stage04_output","BY HASH($60)"]}],"writeRatioAvg":0.033860045146726865},{"readMsMax":"17","computeMsMax":"7","waitMsAvg":"1","id":"6","endMs":"1570993714903","waitMsMax":"1","startMs":"1570993714854","waitRatioMax":0.000564334085778781,"readRatioAvg":0.009593679458239277,"parallelInputs":"1","recordsRead":"30","computeRatioAvg":0.0039503386004514675,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0056433408577878106,"readMsAvg":"17","waitRatioAvg":0.000564334085778781,"completedParallelInputs":"1","computeRatioMax":0.0039503386004514675,"name":"S06: Input","shuffleOutputBytes":"1998","recordsWritten":"30","readRatioMax":0.009593679458239277,"steps":[{"kind":"READ","substeps":["$40:cc_call_center_sk, $41:cc_call_center_id, $42:cc_name, $43:cc_manager","FROM call_center"]},{"kind":"WRITE","substeps":["$40, $41, $42, $43","TO __stage06_output","BY HASH($40)"]}],"writeRatioAvg":0.0056433408577878106},{"readMsMax":"49","computeMsMax":"1440","inputStages":["4","6"],"waitMsAvg":"1","id":"8","endMs":"1570993715803","waitMsMax":"2","startMs":"1570993714985","waitRatioMax":0.001128668171557562,"readRatioAvg":0.020316027088036117,"parallelInputs":"6","recordsRead":"14398962","computeRatioAvg":0.6608352144469526,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"1171","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013544018058690745,"readMsAvg":"36","waitRatioAvg":0.000564334085778781,"completedParallelInputs":"6","computeRatioMax":0.8126410835214447,"name":"S08: Join","shuffleOutputBytes":"17503387","recordsWritten":"232492","readRatioMax":0.027652370203160272,"steps":[{"kind":"READ","substeps":["$50:cr_returned_date_sk, $51:cr_returning_customer_sk, $52:cr_call_center_sk, $53:cr_net_loss","FROM catalog_returns"]},{"kind":"READ","substeps":["$40, $41, $42, $43","FROM __stage06_output"]},{"kind":"READ","substeps":["$60","FROM __stage04_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $93 = $60"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $52 = $40"]},{"kind":"WRITE","substeps":["$110, $111, $112, $113, $114","TO __stage08_output","BY HASH($113)"]}],"writeRatioAvg":0.011851015801354402},{"readMsMax":"0","computeMsMax":"12","inputStages":["8"],"waitMsAvg":"2","id":"9","endMs":"1570993716005","waitMsMax":"5","startMs":"1570993715830","waitRatioMax":0.0028216704288939053,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"232492","computeRatioAvg":0.004514672686230248,"writeMsAvg":"52","status":"COMPLETE","writeMsMax":"74","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0417607223476298,"readMsAvg":"0","waitRatioAvg":0.001128668171557562,"completedParallelInputs":"100","computeRatioMax":0.006772009029345372,"name":"S09: Coalesce","shuffleOutputBytes":"17503387","recordsWritten":"232492","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage08_output"]}],"writeRatioAvg":0.029345372460496615},{"readMsMax":"0","computeMsMax":"9","inputStages":["2"],"waitMsAvg":"5","id":"10","endMs":"1570993715978","waitMsMax":"6","startMs":"1570993715832","waitRatioMax":0.003386004514672686,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"108647","computeRatioAvg":0.003386004514672686,"writeMsAvg":"46","status":"COMPLETE","writeMsMax":"72","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.040632054176072234,"readMsAvg":"0","waitRatioAvg":0.0028216704288939053,"completedParallelInputs":"100","computeRatioMax":0.005079006772009029,"name":"S0A: Coalesce","shuffleOutputBytes":"977823","recordsWritten":"108647","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage02_output"]}],"writeRatioAvg":0.025959367945823927},{"readMsMax":"0","computeMsMax":"14","inputStages":["1"],"waitMsAvg":"5","id":"11","endMs":"1570993716086","waitMsMax":"9","startMs":"1570993715830","waitRatioMax":0.005079006772009029,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"109760","computeRatioAvg":0.003386004514672686,"writeMsAvg":"38","status":"COMPLETE","writeMsMax":"70","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.039503386004514675,"readMsAvg":"0","waitRatioAvg":0.0028216704288939053,"completedParallelInputs":"100","computeRatioMax":0.007900677200902935,"name":"S0B: Coalesce","shuffleOutputBytes":"3402560","recordsWritten":"109760","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage01_output"]}],"writeRatioAvg":0.02144469525959368},{"readMsMax":"29","computeMsMax":"1772","inputStages":["0","11","10","9"],"waitMsAvg":"1","id":"12","endMs":"1570993717000","waitMsMax":"1","startMs":"1570993715887","waitRatioMax":0.000564334085778781,"readRatioAvg":0.01636568848758465,"parallelInputs":"1","recordsRead":"2452099","computeRatioAvg":1,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"1772","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002257336343115124,"readMsAvg":"29","waitRatioAvg":0.000564334085778781,"completedParallelInputs":"1","computeRatioMax":1,"name":"S0C: Join+","shuffleOutputBytes":"2650","recordsWritten":"30","readRatioMax":0.01636568848758465,"steps":[{"kind":"READ","substeps":["$20:c_customer_sk, $21:c_current_cdemo_sk, $22:c_current_hdemo_sk, $23:c_current_addr_sk","FROM customer"]},{"kind":"READ","substeps":["$110, $111, $112, $113, $114","FROM __stage09_output"]},{"kind":"READ","substeps":["$30","FROM __stage0A_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage0B_output"]},{"kind":"READ","substeps":["$1","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $172, $181 := $173, $182 := $174, $183 := $170, $184 := $171","$80 := SUM($175)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $160 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $140 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $126 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $113"]},{"kind":"WRITE","substeps":["$183, $184, $180, $181, $182, $80","TO __stage0C_output","BY HASH($180, $181, $182, $183, $184)"]}],"writeRatioAvg":0.002257336343115124},{"readMsMax":"0","computeMsMax":"8","inputStages":["12"],"waitMsAvg":"2","id":"13","endMs":"1570993717214","waitMsMax":"2","startMs":"1570993717104","waitRatioMax":0.001128668171557562,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"30","computeRatioAvg":0.004514672686230248,"writeMsAvg":"38","status":"COMPLETE","writeMsMax":"38","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02144469525959368,"readMsAvg":"0","waitRatioAvg":0.001128668171557562,"completedParallelInputs":"1","computeRatioMax":0.004514672686230248,"name":"S0D: Aggregate","shuffleOutputBytes":"1990","recordsWritten":"30","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$183, $184, $180, $181, $182, $80","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $180, $191 := $181, $192 := $182, $193 := $183, $194 := $184","$70 := SUM($80)"]},{"kind":"WRITE","substeps":["$190, $191, $192, $70","TO __stage0D_output"]}],"writeRatioAvg":0.02144469525959368},{"readMsMax":"0","computeMsMax":"6","inputStages":["13"],"waitMsAvg":"1","id":"14","endMs":"1570993717393","waitMsMax":"1","startMs":"1570993717257","waitRatioMax":0.000564334085778781,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"30","computeRatioAvg":0.003386004514672686,"writeMsAvg":"86","status":"COMPLETE","writeMsMax":"86","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04853273137697517,"readMsAvg":"0","waitRatioAvg":0.000564334085778781,"completedParallelInputs":"1","computeRatioMax":0.003386004514672686,"name":"S0E: Output","shuffleOutputBytes":"1990","recordsWritten":"30","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$190, $191, $192, $70","FROM __stage0D_output"]},{"kind":"SORT","substeps":["$70 DESC"]},{"kind":"WRITE","substeps":["$200, $201, $202, $203","TO __stage0E_output"]}],"writeRatioAvg":0.04853273137697517}],"estimatedBytesProcessed":"577732282","timeline":[{"totalSlotMs":"1114","activeUnits":"7","completedUnits":"5","elapsedMs":"797","pendingUnits":"7"},{"totalSlotMs":"41517","activeUnits":"7","completedUnits":"311","elapsedMs":"1856","pendingUnits":"1"},{"totalSlotMs":"42828","activeUnits":"1","completedUnits":"314","elapsedMs":"3539","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"577765376","totalPartitionsProcessed":"0","totalBytesProcessed":"577732282","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"call_center","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer_demographics","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_100"}]},"endTime":"1570993717813"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query91_1570993712"},"etag":"tZfzlY+XrFUXH4MB+uruOw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query91_1570993712?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon60be7db79d1c27e40fd8b345c64a93ea84560d67","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query91\nSELECT cc_call_center_id Call_Center, \n cc_name Call_Center_Name, \n cc_manager Manager, \n Sum(cr_net_loss) Returns_Loss \nFROM call_center, \n catalog_returns, \n date_dim, \n customer, \n customer_address, \n customer_demographics, \n household_demographics \nWHERE cr_call_center_sk = cc_call_center_sk \n AND cr_returned_date_sk = d_date_sk \n AND cr_returning_customer_sk = c_customer_sk \n AND cd_demo_sk = c_current_cdemo_sk \n AND hd_demo_sk = c_current_hdemo_sk \n AND ca_address_sk = c_current_addr_sk \n AND d_year = 1999 \n AND d_moy = 12 \n AND ( ( cd_marital_status = 'M' \n AND cd_education_status = 'Unknown' ) \n OR ( cd_marital_status = 'W' \n AND cd_education_status = 'Advanced Degree' ) ) \n AND hd_buy_potential LIKE 'Unknown%' \n AND ca_gmt_offset = -7 \nGROUP BY cc_call_center_id, \n cc_name, \n cc_manager, \n cd_marital_status, \n cd_education_status \nORDER BY Sum(cr_net_loss) DESC; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query91_1570993712","user_email":"nithish.sankaranarayanan@ulb.be"}
