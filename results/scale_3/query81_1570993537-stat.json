{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"168182","creationTime":"1570993538354","totalBytesProcessed":"672459148","startTime":"1570993538484","query":{"totalSlotMs":"168182","queryPlan":[{"readMsMax":"21","computeMsMax":"796","waitMsAvg":"1","id":"0","endMs":"1570993540610","waitMsMax":"1","startMs":"1570993538680","waitRatioMax":0.00012899896800825592,"readRatioAvg":0.0027089783281733747,"parallelInputs":"1","recordsRead":"1000000","computeRatioAvg":0.10268317853457172,"writeMsAvg":"1464","status":"COMPLETE","writeMsMax":"1464","computeMsAvg":"796","shuffleOutputBytesSpilled":"0","writeRatioMax":0.18885448916408668,"readMsAvg":"21","waitRatioAvg":0.00012899896800825592,"completedParallelInputs":"1","computeRatioMax":0.10268317853457172,"name":"S00: Input","shuffleOutputBytes":"15819964","recordsWritten":"1000000","readRatioMax":0.0027089783281733747,"steps":[{"kind":"READ","substeps":["$60:ca_address_sk, $61:ca_state","FROM customer_address"]},{"kind":"WRITE","substeps":["$60, $61","TO __stage00_output","BY HASH($60)"]}],"writeRatioAvg":0.18885448916408668},{"readMsMax":"17","computeMsMax":"10","waitMsAvg":"27","id":"1","endMs":"1570993538801","waitMsMax":"27","startMs":"1570993538721","waitRatioMax":0.00348297213622291,"readRatioAvg":0.0021929824561403508,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0012899896800825593,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007739938080495357,"readMsAvg":"17","waitRatioAvg":0.00348297213622291,"completedParallelInputs":"1","computeRatioMax":0.0012899896800825593,"name":"S01: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.0021929824561403508,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_year","FROM date_dim","WHERE equal($81, 1999)"]},{"kind":"WRITE","substeps":["$80","TO __stage01_output","BY HASH($80)"]}],"writeRatioAvg":0.0007739938080495357},{"readMsMax":"23","computeMsMax":"671","waitMsAvg":"53","id":"3","endMs":"1570993539566","waitMsMax":"53","startMs":"1570993538779","waitRatioMax":0.006836945304437564,"readRatioAvg":0.0029669762641898866,"parallelInputs":"1","recordsRead":"1000000","computeRatioAvg":0.08655830753353973,"writeMsAvg":"267","status":"COMPLETE","writeMsMax":"267","computeMsAvg":"671","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03444272445820434,"readMsAvg":"23","waitRatioAvg":0.006836945304437564,"completedParallelInputs":"1","computeRatioMax":0.08655830753353973,"name":"S03: Input","shuffleOutputBytes":"15819964","recordsWritten":"1000000","readRatioMax":0.0029669762641898866,"steps":[{"kind":"READ","substeps":["$30:ca_address_sk, $31:ca_state","FROM customer_address"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage03_output","BY HASH($30)"]}],"writeRatioAvg":0.03444272445820434},{"readMsMax":"9","computeMsMax":"6","waitMsAvg":"46","id":"4","endMs":"1570993538989","waitMsMax":"46","startMs":"1570993538787","waitRatioMax":0.005933952528379773,"readRatioAvg":0.0011609907120743034,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0007739938080495357,"writeMsAvg":"183","status":"COMPLETE","writeMsMax":"183","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.023606811145510834,"readMsAvg":"9","waitRatioAvg":0.005933952528379773,"completedParallelInputs":"1","computeRatioMax":0.0007739938080495357,"name":"S04: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.0011609907120743034,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year","FROM date_dim","WHERE equal($51, 1999)"]},{"kind":"WRITE","substeps":["$50","TO __stage04_output","BY HASH($50)"]}],"writeRatioAvg":0.023606811145510834},{"readMsMax":"0","computeMsMax":"16","inputStages":["3"],"waitMsAvg":"1","id":"8","endMs":"1570993539916","waitMsMax":"3","startMs":"1570993539617","waitRatioMax":0.0003869969040247678,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1000000","computeRatioAvg":0.0012899896800825593,"writeMsAvg":"178","status":"COMPLETE","writeMsMax":"216","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02786377708978328,"readMsAvg":"0","waitRatioAvg":0.00012899896800825592,"completedParallelInputs":"100","computeRatioMax":0.0020639834881320948,"name":"S08: Coalesce","shuffleOutputBytes":"15819964","recordsWritten":"1000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage03_output"]}],"writeRatioAvg":0.022961816305469555},{"readMsMax":"47","computeMsMax":"3352","inputStages":["8","4"],"waitMsAvg":"1","id":"9","endMs":"1570993541514","waitMsMax":"1","startMs":"1570993539701","waitRatioMax":0.00012899896800825592,"readRatioAvg":0.0043859649122807015,"parallelInputs":"6","recordsRead":"20400786","computeRatioAvg":0.37564499484004127,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"38","computeMsAvg":"2912","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004901960784313725,"readMsAvg":"34","waitRatioAvg":0.00012899896800825592,"completedParallelInputs":"6","computeRatioMax":0.4324045407636739,"name":"S09: Join+","shuffleOutputBytes":"68546669","recordsWritten":"2766543","readRatioMax":0.006062951496388029,"steps":[{"kind":"READ","substeps":["$40:cr_returned_date_sk, $41:cr_returning_customer_sk, $42:cr_returning_addr_sk, $43:cr_return_amt_inc_tax","FROM catalog_returns"]},{"kind":"READ","substeps":["$50","FROM __stage04_output"]},{"kind":"READ","substeps":["$30, $31","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $170 := $160, $171 := $162","$120 := SUM($161)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $151 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $50"]},{"kind":"WRITE","substeps":["$171, $170, $120","TO __stage09_output","BY HASH($170, $171)"]}],"writeRatioAvg":0.00348297213622291},{"readMsMax":"0","computeMsMax":"16","inputStages":["0"],"waitMsAvg":"1","id":"10","endMs":"1570993540977","waitMsMax":"4","startMs":"1570993540736","waitRatioMax":0.0005159958720330237,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1000000","computeRatioAvg":0.0012899896800825593,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003740970072239422,"readMsAvg":"0","waitRatioAvg":0.00012899896800825592,"completedParallelInputs":"100","computeRatioMax":0.0020639834881320948,"name":"S0A: Coalesce","shuffleOutputBytes":"15819964","recordsWritten":"1000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage00_output"]}],"writeRatioAvg":0.0023219814241486067},{"readMsMax":"107","computeMsMax":"3362","inputStages":["10","1"],"waitMsAvg":"1","id":"11","endMs":"1570993542906","waitMsMax":"1","startMs":"1570993540754","waitRatioMax":0.00012899896800825592,"readRatioAvg":0.005933952528379773,"parallelInputs":"6","recordsRead":"20400786","computeRatioAvg":0.39628482972136225,"writeMsAvg":"33","status":"COMPLETE","writeMsMax":"38","computeMsAvg":"3072","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004901960784313725,"readMsAvg":"46","waitRatioAvg":0.00012899896800825592,"completedParallelInputs":"6","computeRatioMax":0.43369453044375644,"name":"S0B: Join+","shuffleOutputBytes":"68546669","recordsWritten":"2766543","readRatioMax":0.013802889576883385,"steps":[{"kind":"READ","substeps":["$70:cr_returned_date_sk, $71:cr_returning_customer_sk, $72:cr_returning_addr_sk, $73:cr_return_amt_inc_tax","FROM catalog_returns"]},{"kind":"READ","substeps":["$80","FROM __stage01_output"]},{"kind":"READ","substeps":["$60, $61","FROM __stage0A_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $220, $231 := $222","$140 := SUM($221)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $211 = $60"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $70 = $80"]},{"kind":"WRITE","substeps":["$231, $230, $140","TO __stage0B_output","BY HASH($230, $231)"]}],"writeRatioAvg":0.0042569659442724455},{"readMsMax":"0","computeMsMax":"5048","inputStages":["11"],"waitMsAvg":"1","id":"12","endMs":"1570993545999","waitMsMax":"1","startMs":"1570993542962","waitRatioMax":0.00012899896800825592,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2766543","computeRatioAvg":0.651186790505676,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"5048","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0006449948400412797,"readMsAvg":"0","waitRatioAvg":0.00012899896800825592,"completedParallelInputs":"1","computeRatioMax":0.651186790505676,"name":"S0C: Aggregate","shuffleOutputBytes":"1283","recordsWritten":"52","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$231, $230, $140","FROM __stage0B_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $250 := $241","$110 := SHARD_AVG($130)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230, $241 := $231","$130 := SUM($140)"]},{"kind":"WRITE","substeps":["$250, $110","TO __stage0C_output","BY HASH($250)"]}],"writeRatioAvg":0.0006449948400412797},{"readMsMax":"144","computeMsMax":"304","waitMsAvg":"1","id":"13","endMs":"1570993547117","waitMsMax":"1","startMs":"1570993546811","waitRatioMax":0.00012899896800825592,"readRatioAvg":0.018575851393188854,"parallelInputs":"1","recordsRead":"1000000","computeRatioAvg":0.0392156862745098,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"304","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0011609907120743034,"readMsAvg":"144","waitRatioAvg":0.00012899896800825592,"completedParallelInputs":"1","computeRatioMax":0.0392156862745098,"name":"S0D: Input","shuffleOutputBytes":"11226199","recordsWritten":"79324","readRatioMax":0.018575851393188854,"steps":[{"kind":"READ","substeps":["$1:ca_address_sk, $2:ca_street_number, $3:ca_street_name, $4:ca_street_type, $5:ca_suite_number, $6:ca_city, $7:ca_county, $8:ca_state, $9:ca_zip, $10:ca_country, $11:ca_gmt_offset, $12:ca_location_type","FROM customer_address","WHERE equal($8, 'TX')"]},{"kind":"WRITE","substeps":["$1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12","TO __stage0D_output","BY HASH($1)"]}],"writeRatioAvg":0.0011609907120743034},{"readMsMax":"0","computeMsMax":"9","inputStages":["12"],"waitMsAvg":"1","id":"14","endMs":"1570993546902","waitMsMax":"1","startMs":"1570993546824","waitRatioMax":0.00012899896800825592,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"52","computeRatioAvg":0.0011609907120743034,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0012899896800825593,"readMsAvg":"0","waitRatioAvg":0.00012899896800825592,"completedParallelInputs":"1","computeRatioMax":0.0011609907120743034,"name":"S0E: Aggregate","shuffleOutputBytes":"816","recordsWritten":"51","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$250, $110","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $260 := $250","$90 := ROOT_AVG($110)"]},{"kind":"WRITE","substeps":["$90, $260","TO __stage0E_output","BY HASH($260)"]}],"writeRatioAvg":0.0012899896800825593},{"readMsMax":"42","computeMsMax":"4185","waitMsAvg":"1","id":"15","endMs":"1570993548888","waitMsMax":"1","startMs":"1570993546838","waitRatioMax":0.00012899896800825592,"readRatioAvg":0.005417956656346749,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.5398606811145511,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"16","computeMsAvg":"4185","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0020639834881320948,"readMsAvg":"42","waitRatioAvg":0.00012899896800825592,"completedParallelInputs":"1","computeRatioMax":0.5398606811145511,"name":"S0F: Input","shuffleOutputBytes":"136518213","recordsWritten":"2000000","readRatioMax":0.005417956656346749,"steps":[{"kind":"READ","substeps":["$20:c_customer_sk, $21:c_customer_id, $22:c_current_addr_sk, $23:c_salutation, $24:c_first_name, $25:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$20, $21, $22, $23, $24, $25","TO __stage0F_output","BY HASH($20)"]}],"writeRatioAvg":0.0020639834881320948},{"readMsMax":"0","computeMsMax":"7752","inputStages":["9"],"waitMsAvg":"2","id":"16","endMs":"1570993550746","waitMsMax":"2","startMs":"1570993546854","waitRatioMax":0.00025799793601651185,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2766543","computeRatioAvg":1,"writeMsAvg":"78","status":"COMPLETE","writeMsMax":"78","computeMsAvg":"7752","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010061919504643963,"readMsAvg":"0","waitRatioAvg":0.00025799793601651185,"completedParallelInputs":"1","computeRatioMax":1,"name":"S10: Aggregate","shuffleOutputBytes":"67186370","recordsWritten":"2711452","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$171, $170, $120","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $170, $181 := $171","$100 := SUM($120)"]},{"kind":"WRITE","substeps":["$100, $180, $181","TO __stage10_output","BY HASH($180)"]}],"writeRatioAvg":0.010061919504643963},{"readMsMax":"0","computeMsMax":"10","inputStages":["14"],"waitMsAvg":"1","id":"17","endMs":"1570993551184","waitMsMax":"3","startMs":"1570993551054","waitRatioMax":0.0003869969040247678,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"51","computeRatioAvg":0.0006449948400412797,"writeMsAvg":"32","status":"COMPLETE","writeMsMax":"60","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007739938080495356,"readMsAvg":"0","waitRatioAvg":0.00012899896800825592,"completedParallelInputs":"100","computeRatioMax":0.0012899896800825593,"name":"S11: Coalesce","shuffleOutputBytes":"816","recordsWritten":"51","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0E_output"]}],"writeRatioAvg":0.0041279669762641896},{"readMsMax":"0","computeMsMax":"13","inputStages":["13"],"waitMsAvg":"3","id":"18","endMs":"1570993551277","waitMsMax":"4","startMs":"1570993551054","waitRatioMax":0.0005159958720330237,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"79324","computeRatioAvg":0.0009029927760577915,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"59","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0076109391124871,"readMsAvg":"0","waitRatioAvg":0.0003869969040247678,"completedParallelInputs":"100","computeRatioMax":0.001676986584107327,"name":"S12: Coalesce","shuffleOutputBytes":"11226199","recordsWritten":"79324","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0D_output"]}],"writeRatioAvg":0.003611971104231166},{"readMsMax":"0","computeMsMax":"260","inputStages":["18","17","15","16"],"waitMsAvg":"4","id":"19","endMs":"1570993551509","waitMsMax":"5","startMs":"1570993551060","waitRatioMax":0.0006449948400412797,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"12648952","computeRatioAvg":0.023993808049535603,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"186","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0012899896800825593,"readMsAvg":"0","waitRatioAvg":0.0005159958720330237,"completedParallelInputs":"100","computeRatioMax":0.033539731682146544,"name":"S13: Join+","shuffleOutputBytes":"1917286","recordsWritten":"10000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$100, $180, $181","FROM __stage10_output"]},{"kind":"READ","substeps":["$20, $21, $22, $23, $24, $25","FROM __stage0F_output"]},{"kind":"READ","substeps":["$90, $260","FROM __stage11_output"]},{"kind":"READ","substeps":["$1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12","FROM __stage12_output"]},{"kind":"SORT","substeps":["$290 ASC, $291 ASC, $292 ASC, $293 ASC, $295 ASC, $296 ASC, $297 ASC, $298 ASC, $299 ASC, $300 ASC, $301 ASC, $302 ASC, $303 ASC, $304 ASC, $305 ASC, $294 ASC","LIMIT 100"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $271 = $1"]},{"kind":"FILTER","substeps":["greater($275, multiply($276, 1.2))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $190 = $260"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH EACH ON $180 = $20"]},{"kind":"WRITE","substeps":["$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $322, $323, $324, $325","TO __stage13_output"]}],"writeRatioAvg":0.0005159958720330237},{"readMsMax":"0","computeMsMax":"16","inputStages":["19"],"waitMsAvg":"1","id":"20","endMs":"1570993551519","waitMsMax":"1","startMs":"1570993551089","waitRatioMax":0.00012899896800825592,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"10000","computeRatioAvg":0.0020639834881320948,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"16","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0005159958720330237,"readMsAvg":"0","waitRatioAvg":0.00012899896800825592,"completedParallelInputs":"1","computeRatioMax":0.0020639834881320948,"name":"S14: Output","shuffleOutputBytes":"19198","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $322, $323, $324, $325","FROM __stage13_output"]},{"kind":"SORT","substeps":["$321 ASC, $322 ASC, $323 ASC, $324 ASC, $310 ASC, $311 ASC, $312 ASC, $313 ASC, $314 ASC, $315 ASC, $316 ASC, $317 ASC, $318 ASC, $319 ASC, $320 ASC, $325 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$330, $331, $332, $333, $334, $335, $336, $337, $338, $339, $340, $341, $342, $343, $344, $345","TO __stage14_output"]}],"writeRatioAvg":0.0005159958720330237}],"estimatedBytesProcessed":"672459148","timeline":[{"totalSlotMs":"989","activeUnits":"14","completedUnits":"2","elapsedMs":"697","pendingUnits":"14"},{"totalSlotMs":"36201","activeUnits":"7","completedUnits":"109","elapsedMs":"1586","pendingUnits":"7"},{"totalSlotMs":"76793","activeUnits":"11","completedUnits":"210","elapsedMs":"3175","pendingUnits":"6"},{"totalSlotMs":"90287","activeUnits":"2","completedUnits":"216","elapsedMs":"5184","pendingUnits":"1"},{"totalSlotMs":"103237","activeUnits":"2","completedUnits":"219","elapsedMs":"8828","pendingUnits":"2"},{"totalSlotMs":"108409","activeUnits":"1","completedUnits":"220","elapsedMs":"10906","pendingUnits":"1"},{"totalSlotMs":"168182","activeUnits":"123","completedUnits":"522","elapsedMs":"13344","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"673185792","totalPartitionsProcessed":"0","totalBytesProcessed":"672459148","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_100"}]},"endTime":"1570993551856"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query81_1570993537"},"etag":"Ilr7AC7UJdsgA2yPzedWgw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query81_1570993537?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon41a399a99a0af72a179455dd00c461137055e6c9","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"\n-- query81\nWITH customer_total_return \n AS (SELECT cr_returning_customer_sk AS ctr_customer_sk, \n ca_state AS ctr_state, \n Sum(cr_return_amt_inc_tax) AS ctr_total_return \n FROM catalog_returns, \n date_dim, \n customer_address \n WHERE cr_returned_date_sk = d_date_sk \n AND d_year = 1999 \n AND cr_returning_addr_sk = ca_address_sk \n GROUP BY cr_returning_customer_sk, \n ca_state),\nhigh_return AS (\n SELECT ctr_state AS hr_state, Avg(ctr_total_return) benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results scale_2.zip warmup 1.2 AS hr_limit\n FROM customer_total_return \n GROUP BY ctr_state\n)\nSELECT c_customer_id, \n c_salutation, \n c_first_name, \n c_last_name, \n ca_street_number, \n ca_street_name, \n ca_street_type, \n ca_suite_number, \n ca_city, \n ca_county, \n ca_state, \n ca_zip, \n ca_country, \n ca_gmt_offset, \n ca_location_type, \n ctr_total_return \nFROM customer_total_return, \n high_return,\n customer_address, \n customer\nWHERE ctr_state = hr_state \n AND ctr_customer_sk = c_customer_sk \n AND ca_address_sk = c_current_addr_sk \n AND ca_state = 'TX' \n AND ctr_total_return > hr_limit\nORDER BY c_customer_id, \n c_salutation, \n c_first_name, \n c_last_name, \n ca_street_number, \n ca_street_name, \n ca_street_type, \n ca_suite_number, \n ca_city, \n ca_county, \n ca_state, \n ca_zip, \n ca_country, \n ca_gmt_offset, \n ca_location_type, \n ctr_total_return\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query81_1570993537","user_email":"nithish.sankaranarayanan@ulb.be"}
