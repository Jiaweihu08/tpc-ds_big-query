{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"112710","creationTime":"1570971814134","totalBytesProcessed":"798244160","startTime":"1570971814253","query":{"totalSlotMs":"112710","queryPlan":[{"readMsMax":"29","computeMsMax":"566","waitMsAvg":"0","id":"0","endMs":"1570971815471","waitMsMax":"0","startMs":"1570971814485","waitRatioMax":0,"readRatioAvg":0.0045828065739570165,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.08944374209860935,"writeMsAvg":"105","status":"COMPLETE","writeMsMax":"105","computeMsAvg":"566","shuffleOutputBytesSpilled":"0","writeRatioMax":0.016592920353982302,"readMsAvg":"29","waitRatioAvg":0,"completedParallelInputs":"1","computeRatioMax":0.08944374209860935,"name":"S00: Input","shuffleOutputBytes":"15134188","recordsWritten":"500000","readRatioMax":0.0045828065739570165,"steps":[{"kind":"READ","substeps":["$20:c_customer_sk, $21:c_first_name, $22:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$20, $21, $22","TO __stage00_output","BY HASH($20)"]}],"writeRatioAvg":0.016592920353982302},{"readMsMax":"13","computeMsMax":"10","waitMsAvg":"30","id":"1","endMs":"1570971814748","waitMsMax":"30","startMs":"1570971814529","waitRatioMax":0.004740834386852086,"readRatioAvg":0.0020543615676359038,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0015802781289506952,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0045828065739570165,"readMsAvg":"13","waitRatioAvg":0.004740834386852086,"completedParallelInputs":"1","computeRatioMax":0.0015802781289506952,"name":"S01: Input","shuffleOutputBytes":"8760","recordsWritten":"365","readRatioMax":0.0020543615676359038,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_date, $82:d_month_seq","FROM date_dim","WHERE between($82, 1188, 1199)"]},{"kind":"WRITE","substeps":["$80, $81","TO __stage01_output","BY HASH($80)"]}],"writeRatioAvg":0.0045828065739570165},{"readMsMax":"24","computeMsMax":"645","waitMsAvg":"8","id":"3","endMs":"1570971815599","waitMsMax":"8","startMs":"1570971814584","waitRatioMax":0.0012642225031605564,"readRatioAvg":0.0037926675094816687,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.10192793931731985,"writeMsAvg":"143","status":"COMPLETE","writeMsMax":"143","computeMsAvg":"645","shuffleOutputBytesSpilled":"0","writeRatioMax":0.022597977243994944,"readMsAvg":"24","waitRatioAvg":0.0012642225031605564,"completedParallelInputs":"1","computeRatioMax":0.10192793931731985,"name":"S03: Input","shuffleOutputBytes":"15134188","recordsWritten":"500000","readRatioMax":0.0037926675094816687,"steps":[{"kind":"READ","substeps":["$10:c_customer_sk, $11:c_first_name, $12:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage03_output","BY HASH($10)"]}],"writeRatioAvg":0.022597977243994944},{"readMsMax":"22","computeMsMax":"12","waitMsAvg":"38","id":"4","endMs":"1570971814765","waitMsMax":"38","startMs":"1570971814708","waitRatioMax":0.0060050568900126425,"readRatioAvg":0.00347661188369153,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0018963337547408343,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0012642225031605564,"readMsAvg":"22","waitRatioAvg":0.0060050568900126425,"completedParallelInputs":"1","computeRatioMax":0.0018963337547408343,"name":"S04: Input","shuffleOutputBytes":"8760","recordsWritten":"365","readRatioMax":0.00347661188369153,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_date, $72:d_month_seq","FROM date_dim","WHERE between($72, 1188, 1199)"]},{"kind":"WRITE","substeps":["$70, $71","TO __stage04_output","BY HASH($70)"]}],"writeRatioAvg":0.0012642225031605564},{"readMsMax":"14","computeMsMax":"8","waitMsAvg":"66","id":"7","endMs":"1570971814996","waitMsMax":"66","startMs":"1570971814792","waitRatioMax":0.010429835651074588,"readRatioAvg":0.0022123893805309734,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0012642225031605564,"writeMsAvg":"180","status":"COMPLETE","writeMsMax":"180","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.028445006321112517,"readMsAvg":"14","waitRatioAvg":0.010429835651074588,"completedParallelInputs":"1","computeRatioMax":0.0012642225031605564,"name":"S07: Input","shuffleOutputBytes":"8760","recordsWritten":"365","readRatioMax":0.0022123893805309734,"steps":[{"kind":"READ","substeps":["$60:d_date_sk, $61:d_date, $62:d_month_seq","FROM date_dim","WHERE between($62, 1188, 1199)"]},{"kind":"WRITE","substeps":["$60, $61","TO __stage07_output","BY HASH($60)"]}],"writeRatioAvg":0.028445006321112517},{"readMsMax":"124","computeMsMax":"823","inputStages":["7"],"waitMsAvg":"2","id":"11","endMs":"1570971815506","waitMsMax":"2","startMs":"1570971815036","waitRatioMax":0.0003160556257901391,"readRatioAvg":0.008059418457648546,"parallelInputs":"4","recordsRead":"7202490","computeRatioAvg":0.09513274336283185,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"35","computeMsAvg":"602","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0055309734513274336,"readMsAvg":"51","waitRatioAvg":0.0003160556257901391,"completedParallelInputs":"4","computeRatioMax":0.13005689001264223,"name":"S0B: Join","shuffleOutputBytes":"34661232","recordsWritten":"1444218","readRatioMax":0.019595448798988623,"steps":[{"kind":"READ","substeps":["$30:ws_sold_date_sk, $31:ws_bill_customer_sk","FROM web_sales"]},{"kind":"READ","substeps":["$60, $61","FROM __stage07_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $30 = $60"]},{"kind":"WRITE","substeps":["$200, $201","TO __stage0B_output","BY HASH($200)"]}],"writeRatioAvg":0.0030025284450063213},{"readMsMax":"56","computeMsMax":"2063","inputStages":["0","1"],"waitMsAvg":"1","id":"12","endMs":"1570971816887","waitMsMax":"1","startMs":"1570971815715","waitRatioMax":0.00015802781289506955,"readRatioAvg":0.0045828065739570165,"parallelInputs":"8","recordsRead":"18400243","computeRatioAvg":0.26738305941845764,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"1692","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0045828065739570165,"readMsAvg":"29","waitRatioAvg":0.00015802781289506955,"completedParallelInputs":"8","computeRatioMax":0.32601137800252844,"name":"S0C: Join+","shuffleOutputBytes":"61200979","recordsWritten":"1672734","readRatioMax":0.008849557522123894,"steps":[{"kind":"READ","substeps":["$50:cs_sold_date_sk, $51:cs_bill_customer_sk","FROM catalog_sales"]},{"kind":"READ","substeps":["$80, $81","FROM __stage01_output"]},{"kind":"READ","substeps":["$20, $21, $22","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $170 := $162, $171 := $161, $172 := $160"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $150 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $50 = $80"]},{"kind":"WRITE","substeps":["$171, $170, $172","TO __stage0C_output","BY HASH($170, $171, $172)"]}],"writeRatioAvg":0.0037926675094816687},{"readMsMax":"0","computeMsMax":"19","inputStages":["11"],"waitMsAvg":"2","id":"13","endMs":"1570971815878","waitMsMax":"3","startMs":"1570971815717","waitRatioMax":0.0004740834386852086,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1444218","computeRatioAvg":0.0020543615676359038,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"54","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008533501896333754,"readMsAvg":"0","waitRatioAvg":0.0003160556257901391,"completedParallelInputs":"100","computeRatioMax":0.0030025284450063213,"name":"S0D: Coalesce","shuffleOutputBytes":"34661232","recordsWritten":"1444218","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0B_output"]}],"writeRatioAvg":0.0036346396965865994},{"readMsMax":"38","computeMsMax":"2329","inputStages":["13"],"waitMsAvg":"1","id":"14","endMs":"1570971817193","waitMsMax":"1","startMs":"1570971815740","waitRatioMax":0.00015802781289506955,"readRatioAvg":0.0060050568900126425,"parallelInputs":"1","recordsRead":"1944218","computeRatioAvg":0.36804677623261695,"writeMsAvg":"56","status":"COMPLETE","writeMsMax":"56","computeMsAvg":"2329","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008849557522123894,"readMsAvg":"38","waitRatioAvg":0.00015802781289506955,"completedParallelInputs":"1","computeRatioMax":0.36804677623261695,"name":"S0E: Join+","shuffleOutputBytes":"4325612","recordsWritten":"118352","readRatioMax":0.0060050568900126425,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_first_name, $3:c_last_name","FROM customer"]},{"kind":"READ","substeps":["$200, $201","FROM __stage0D_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $220 := $212, $221 := $211, $222 := $210"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $200"]},{"kind":"WRITE","substeps":["$221, $220, $222","TO __stage0E_output","BY HASH($220, $221, $222)"]}],"writeRatioAvg":0.008849557522123894},{"readMsMax":"178","computeMsMax":"2718","inputStages":["3","4"],"waitMsAvg":"1","id":"15","endMs":"1570971817346","waitMsMax":"2","startMs":"1570971815779","waitRatioMax":0.0003160556257901391,"readRatioAvg":0.006479140328697851,"parallelInputs":"10","recordsRead":"33805762","computeRatioAvg":0.3715233881163085,"writeMsAvg":"33","status":"COMPLETE","writeMsMax":"68","computeMsAvg":"2351","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010745891276864728,"readMsAvg":"41","waitRatioAvg":0.00015802781289506955,"completedParallelInputs":"10","computeRatioMax":0.429519595448799,"name":"S0F: Join+","shuffleOutputBytes":"116953865","recordsWritten":"3195352","readRatioMax":0.028128950695322376,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_customer_sk","FROM store_sales"]},{"kind":"READ","substeps":["$70, $71","FROM __stage04_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $130 := $122, $131 := $121, $132 := $120"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $110 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $70"]},{"kind":"WRITE","substeps":["$131, $130, $132","TO __stage0F_output","BY HASH($130, $131, $132)"]}],"writeRatioAvg":0.005214917825537294},{"readMsMax":"0","computeMsMax":"323","inputStages":["14"],"waitMsAvg":"12","id":"16","endMs":"1570971817649","waitMsMax":"12","startMs":"1570971817396","waitRatioMax":0.0018963337547408343,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"118352","computeRatioAvg":0.05104298356510746,"writeMsAvg":"30","status":"COMPLETE","writeMsMax":"30","computeMsAvg":"323","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004740834386852086,"readMsAvg":"0","waitRatioAvg":0.0018963337547408343,"completedParallelInputs":"1","computeRatioMax":0.05104298356510746,"name":"S10: Aggregate","shuffleOutputBytes":"4205856","recordsWritten":"113789","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$221, $220, $222","FROM __stage0E_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $220, $231 := $221, $232 := $222"]},{"kind":"WRITE","substeps":["$230, $231, $232","TO __stage10_output","BY HASH($230, $231, $232)"]}],"writeRatioAvg":0.004740834386852086},{"readMsMax":"0","computeMsMax":"3113","inputStages":["12"],"waitMsAvg":"5","id":"17","endMs":"1570971819707","waitMsMax":"5","startMs":"1570971817420","waitRatioMax":0.0007901390644753476,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1672734","computeRatioAvg":0.49194058154235143,"writeMsAvg":"570","status":"COMPLETE","writeMsMax":"570","computeMsAvg":"3113","shuffleOutputBytesSpilled":"0","writeRatioMax":0.09007585335018964,"readMsAvg":"0","waitRatioAvg":0.0007901390644753476,"completedParallelInputs":"1","computeRatioMax":0.49194058154235143,"name":"S11: Aggregate","shuffleOutputBytes":"11108019","recordsWritten":"300462","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$171, $170, $172","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $170, $181 := $171, $182 := $172"]},{"kind":"WRITE","substeps":["$180, $181, $182","TO __stage11_output","BY HASH($180, $181, $182)"]}],"writeRatioAvg":0.09007585335018964},{"readMsMax":"0","computeMsMax":"12","inputStages":["17"],"waitMsAvg":"7","id":"19","endMs":"1570971819982","waitMsMax":"13","startMs":"1570971819841","waitRatioMax":0.0020543615676359038,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"300462","computeRatioAvg":0.0012642225031605564,"writeMsAvg":"38","status":"COMPLETE","writeMsMax":"56","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008849557522123894,"readMsAvg":"0","waitRatioAvg":0.0011061946902654867,"completedParallelInputs":"100","computeRatioMax":0.0018963337547408343,"name":"S13: Coalesce","shuffleOutputBytes":"11108019","recordsWritten":"300462","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage11_output"]}],"writeRatioAvg":0.0060050568900126425},{"readMsMax":"0","computeMsMax":"11","inputStages":["16"],"waitMsAvg":"13","id":"20","endMs":"1570971819982","waitMsMax":"16","startMs":"1570971819842","waitRatioMax":0.0025284450063211127,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"113789","computeRatioAvg":0.0009481668773704172,"writeMsAvg":"33","status":"COMPLETE","writeMsMax":"54","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008533501896333754,"readMsAvg":"0","waitRatioAvg":0.0020543615676359038,"completedParallelInputs":"100","computeRatioMax":0.001738305941845765,"name":"S14: Coalesce","shuffleOutputBytes":"4205856","recordsWritten":"113789","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage10_output"]}],"writeRatioAvg":0.005214917825537294},{"readMsMax":"0","computeMsMax":"6328","inputStages":["15","20","19"],"waitMsAvg":"16","id":"21","endMs":"1570971825026","waitMsMax":"16","startMs":"1570971819854","waitRatioMax":0.0025284450063211127,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"3609603","computeRatioAvg":1,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"6328","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0006321112515802782,"readMsAvg":"0","waitRatioAvg":0.0025284450063211127,"completedParallelInputs":"1","computeRatioMax":1,"name":"S15: Join+","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$131, $130, $132","FROM __stage0F_output"]},{"kind":"READ","substeps":["$180, $181, $182","FROM __stage13_output"]},{"kind":"READ","substeps":["$230, $231, $232","FROM __stage14_output"]},{"kind":"AGGREGATE","substeps":["$100 := COUNT_STAR()"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $191 = $230, $190 = $231, $192 = $232"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $140 = $180, $141 = $181, $142 = $182"]},{"kind":"AGGREGATE","substeps":["GROUP BY $140 := $130, $141 := $131, $142 := $132"]},{"kind":"WRITE","substeps":["$100","TO __stage15_output"]}],"writeRatioAvg":0.0006321112515802782},{"readMsMax":"0","computeMsMax":"5","inputStages":["21"],"waitMsAvg":"9","id":"22","endMs":"1570971825192","waitMsMax":"9","startMs":"1570971819897","waitRatioMax":0.0014222503160556258,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.0007901390644753476,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0014222503160556258,"readMsAvg":"0","waitRatioAvg":0.0014222503160556258,"completedParallelInputs":"1","computeRatioMax":0.0007901390644753476,"name":"S16: Output","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$100","FROM __stage15_output"]},{"kind":"LIMIT","substeps":["100"]},{"kind":"AGGREGATE","substeps":["$90 := SUM_OF_COUNTS($100)"]},{"kind":"WRITE","substeps":["$90","TO __stage16_output"]}],"writeRatioAvg":0.0014222503160556258}],"estimatedBytesProcessed":"798244160","timeline":[{"totalSlotMs":"1908","activeUnits":"26","completedUnits":"2","elapsedMs":"733","pendingUnits":"26"},{"totalSlotMs":"32374","activeUnits":"19","completedUnits":"109","elapsedMs":"1752","pendingUnits":"19"},{"totalSlotMs":"70988","activeUnits":"6","completedUnits":"129","elapsedMs":"3402","pendingUnits":"2"},{"totalSlotMs":"97534","activeUnits":"2","completedUnits":"330","elapsedMs":"5957","pendingUnits":"2"},{"totalSlotMs":"112710","activeUnits":"0","completedUnits":"332","elapsedMs":"11276","pendingUnits":"0"},{"totalSlotMs":"112710","activeUnits":"0","completedUnits":"332","elapsedMs":"12524","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"799014912","totalPartitionsProcessed":"0","totalBytesProcessed":"798244160","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570971826799"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query38_1570971813"},"etag":"Cv4DszsVHdBiM0OVRmprEw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query38_1570971813?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anone1e97ab2ba12f32f5b064909d63eb69b0d387f0f","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query38\nWITH g1 AS (\n SELECT DISTINCT c_last_name, \n c_first_name, \n d_date \n FROM store_sales, \n date_dim, \n customer \n WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk \n AND store_sales.ss_customer_sk = customer.c_customer_sk \n AND d_month_seq BETWEEN 1188 AND 1188 + 11 \n), g2 AS (\n SELECT DISTINCT c_last_name, \n c_first_name, \n d_date \n FROM catalog_sales, \n date_dim, \n customer \n WHERE catalog_sales.cs_sold_date_sk = date_dim.d_date_sk \n AND catalog_sales.cs_bill_customer_sk = customer.c_customer_sk \n AND d_month_seq BETWEEN 1188 AND 1188 + 11 \n), g3 AS (\n SELECT DISTINCT c_last_name, \n c_first_name, \n d_date \n FROM web_sales, \n date_dim, \n customer \n WHERE web_sales.ws_sold_date_sk = date_dim.d_date_sk \n AND web_sales.ws_bill_customer_sk = customer.c_customer_sk \n AND d_month_seq BETWEEN 1188 AND 1188 + 11\n)\nSELECT Count(*) \nFROM g1 \nJOIN g2 ON g1.c_last_name = g2.c_last_name AND g1.c_first_name = g2.c_first_name AND g1.d_date = g2.d_date\nJOIN g3 ON g1.c_last_name = g3.c_last_name AND g1.c_first_name = g3.c_first_name AND g1.d_date = g3.d_date\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query38_1570971813","user_email":"nithish.sankaranarayanan@ulb.be"}
