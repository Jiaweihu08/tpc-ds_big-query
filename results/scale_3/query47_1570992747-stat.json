{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"2533892","creationTime":"1570992749892","totalBytesProcessed":"8724129740","startTime":"1570992750067","query":{"totalSlotMs":"2533892","queryPlan":[{"readMsMax":"7","computeMsMax":"5","waitMsAvg":"1","id":"0","endMs":"1570992750602","waitMsMax":"1","startMs":"1570992750367","waitRatioMax":3.576154203769266e-05,"readRatioAvg":0.00025033079426384864,"parallelInputs":"1","recordsRead":"402","computeRatioAvg":0.00017880771018846333,"writeMsAvg":"203","status":"COMPLETE","writeMsMax":"203","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007259593033651611,"readMsAvg":"7","waitRatioAvg":3.576154203769266e-05,"completedParallelInputs":"1","computeRatioMax":0.00017880771018846333,"name":"S00: Input","shuffleOutputBytes":"11972","recordsWritten":"402","readRatioMax":0.00025033079426384864,"steps":[{"kind":"READ","substeps":["$80:s_store_sk, $81:s_store_name, $82:s_company_name","FROM store"]},{"kind":"WRITE","substeps":["$80, $81, $82","TO __stage00_output","BY HASH($80)"]}],"writeRatioAvg":0.007259593033651611},{"readMsMax":"14","computeMsMax":"17","waitMsAvg":"1","id":"1","endMs":"1570992750630","waitMsMax":"1","startMs":"1570992750469","waitRatioMax":3.576154203769266e-05,"readRatioAvg":0.0005006615885276973,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0006079462146407753,"writeMsAvg":"117","status":"COMPLETE","writeMsMax":"117","computeMsAvg":"17","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0041841004184100415,"readMsAvg":"14","waitRatioAvg":3.576154203769266e-05,"completedParallelInputs":"1","computeRatioMax":0.0006079462146407753,"name":"S01: Input","shuffleOutputBytes":"11529","recordsWritten":"427","readRatioMax":0.0005006615885276973,"steps":[{"kind":"READ","substeps":["$110:d_date_sk, $111:d_year, $112:d_moy","FROM date_dim","WHERE or(equal($111, 1999), and(equal($111, 1998), equal($112, 12)), and(equal($111, 2000), equal($112, 1)))"]},{"kind":"WRITE","substeps":["$110, $111, $112","TO __stage01_output","BY HASH($110)"]}],"writeRatioAvg":0.0041841004184100415},{"readMsMax":"10","computeMsMax":"147","waitMsAvg":"1","id":"3","endMs":"1570992751492","waitMsMax":"1","startMs":"1570992750620","waitRatioMax":3.576154203769266e-05,"readRatioAvg":0.00035761542037692667,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.005256946679540821,"writeMsAvg":"130","status":"COMPLETE","writeMsMax":"130","computeMsAvg":"147","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004649000464900047,"readMsAvg":"10","waitRatioAvg":3.576154203769266e-05,"completedParallelInputs":"1","computeRatioMax":0.005256946679540821,"name":"S03: Input","shuffleOutputBytes":"8359844","recordsWritten":"204000","readRatioMax":0.00035761542037692667,"steps":[{"kind":"READ","substeps":["$90:i_item_sk, $91:i_brand, $92:i_category","FROM item"]},{"kind":"WRITE","substeps":["$90, $91, $92","TO __stage03_output","BY HASH($90)"]}],"writeRatioAvg":0.004649000464900047},{"readMsMax":"8","computeMsMax":"7","waitMsAvg":"1","id":"4","endMs":"1570992750842","waitMsMax":"1","startMs":"1570992750741","waitRatioMax":3.576154203769266e-05,"readRatioAvg":0.0002860923363015413,"parallelInputs":"1","recordsRead":"402","computeRatioAvg":0.00025033079426384864,"writeMsAvg":"30","status":"COMPLETE","writeMsMax":"30","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0010728462611307799,"readMsAvg":"8","waitRatioAvg":3.576154203769266e-05,"completedParallelInputs":"1","computeRatioMax":0.00025033079426384864,"name":"S04: Input","shuffleOutputBytes":"11972","recordsWritten":"402","readRatioMax":0.0002860923363015413,"steps":[{"kind":"READ","substeps":["$10:s_store_sk, $11:s_store_name, $12:s_company_name","FROM store"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage04_output","BY HASH($10)"]}],"writeRatioAvg":0.0010728462611307799},{"readMsMax":"14","computeMsMax":"13","waitMsAvg":"1","id":"5","endMs":"1570992750857","waitMsMax":"1","startMs":"1570992750774","waitRatioMax":3.576154203769266e-05,"readRatioAvg":0.0005006615885276973,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.00046490004649000463,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00025033079426384864,"readMsAvg":"14","waitRatioAvg":3.576154203769266e-05,"completedParallelInputs":"1","computeRatioMax":0.00046490004649000463,"name":"S05: Input","shuffleOutputBytes":"11529","recordsWritten":"427","readRatioMax":0.0005006615885276973,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_year, $72:d_moy","FROM date_dim","WHERE or(equal($71, 1999), and(equal($71, 1998), equal($72, 12)), and(equal($71, 2000), equal($72, 1)))"]},{"kind":"WRITE","substeps":["$70, $71, $72","TO __stage05_output","BY HASH($70)"]}],"writeRatioAvg":0.00025033079426384864},{"readMsMax":"10","computeMsMax":"187","waitMsAvg":"1","id":"7","endMs":"1570992751511","waitMsMax":"1","startMs":"1570992750819","waitRatioMax":3.576154203769266e-05,"readRatioAvg":0.00035761542037692667,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.0066874083610485285,"writeMsAvg":"32","status":"COMPLETE","writeMsMax":"32","computeMsAvg":"187","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0011443693452061652,"readMsAvg":"10","waitRatioAvg":3.576154203769266e-05,"completedParallelInputs":"1","computeRatioMax":0.0066874083610485285,"name":"S07: Input","shuffleOutputBytes":"8359844","recordsWritten":"204000","readRatioMax":0.00035761542037692667,"steps":[{"kind":"READ","substeps":["$50:i_item_sk, $51:i_brand, $52:i_category","FROM item"]},{"kind":"WRITE","substeps":["$50, $51, $52","TO __stage07_output","BY HASH($50)"]}],"writeRatioAvg":0.0011443693452061652},{"readMsMax":"5","computeMsMax":"7","waitMsAvg":"1","id":"8","endMs":"1570992751011","waitMsMax":"1","startMs":"1570992750882","waitRatioMax":3.576154203769266e-05,"readRatioAvg":0.00017880771018846333,"parallelInputs":"1","recordsRead":"402","computeRatioAvg":0.00025033079426384864,"writeMsAvg":"62","status":"COMPLETE","writeMsMax":"62","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0022172156063369453,"readMsAvg":"5","waitRatioAvg":3.576154203769266e-05,"completedParallelInputs":"1","computeRatioMax":0.00025033079426384864,"name":"S08: Input","shuffleOutputBytes":"11972","recordsWritten":"402","readRatioMax":0.00017880771018846333,"steps":[{"kind":"READ","substeps":["$1:s_store_sk, $2:s_store_name, $3:s_company_name","FROM store"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage08_output","BY HASH($1)"]}],"writeRatioAvg":0.0022172156063369453},{"readMsMax":"13","computeMsMax":"21","waitMsAvg":"1","id":"9","endMs":"1570992751104","waitMsMax":"1","startMs":"1570992750951","waitRatioMax":3.576154203769266e-05,"readRatioAvg":0.00046490004649000463,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.000750992382791546,"writeMsAvg":"113","status":"COMPLETE","writeMsMax":"113","computeMsAvg":"21","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004041054250259271,"readMsAvg":"13","waitRatioAvg":3.576154203769266e-05,"completedParallelInputs":"1","computeRatioMax":0.000750992382791546,"name":"S09: Input","shuffleOutputBytes":"11529","recordsWritten":"427","readRatioMax":0.00046490004649000463,"steps":[{"kind":"READ","substeps":["$40:d_date_sk, $41:d_year, $42:d_moy","FROM date_dim","WHERE or(equal($41, 1999), and(equal($41, 1998), equal($42, 12)), and(equal($41, 2000), equal($42, 1)))"]},{"kind":"WRITE","substeps":["$40, $41, $42","TO __stage09_output","BY HASH($40)"]}],"writeRatioAvg":0.004041054250259271},{"readMsMax":"22","computeMsMax":"201","waitMsAvg":"5","id":"11","endMs":"1570992751413","waitMsMax":"5","startMs":"1570992751120","waitRatioMax":0.00017880771018846333,"readRatioAvg":0.0007867539248292386,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.007188069949576226,"writeMsAvg":"13","status":"COMPLETE","writeMsMax":"13","computeMsAvg":"201","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00046490004649000463,"readMsAvg":"22","waitRatioAvg":0.00017880771018846333,"completedParallelInputs":"1","computeRatioMax":0.007188069949576226,"name":"S0B: Input","shuffleOutputBytes":"8359844","recordsWritten":"204000","readRatioMax":0.0007867539248292386,"steps":[{"kind":"READ","substeps":["$20:i_item_sk, $21:i_brand, $22:i_category","FROM item"]},{"kind":"WRITE","substeps":["$20, $21, $22","TO __stage0B_output","BY HASH($20)"]}],"writeRatioAvg":0.00046490004649000463},{"readMsMax":"138","computeMsMax":"3588","inputStages":["8","9","11"],"waitMsAvg":"3","id":"12","endMs":"1570992767129","waitMsMax":"6","startMs":"1570992751507","waitRatioMax":0.000214569252226156,"readRatioAvg":0.0012158924292815505,"parallelInputs":"184","recordsRead":"319561459","computeRatioAvg":0.08661445481529163,"writeMsAvg":"211","status":"COMPLETE","writeMsMax":"14185","computeMsAvg":"2422","shuffleOutputBytesSpilled":"0","writeRatioMax":0.5072774738046705,"readMsAvg":"34","waitRatioAvg":0.000107284626113078,"completedParallelInputs":"184","computeRatioMax":0.12831241283124128,"name":"S0C: Join+","shuffleOutputBytes":"1241885769","recordsWritten":"15490602","readRatioMax":0.004935092801201588,"steps":[{"kind":"READ","substeps":["$30:ss_sold_date_sk, $31:ss_item_sk, $32:ss_store_sk, $33:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$20, $21, $22","FROM __stage0B_output"]},{"kind":"READ","substeps":["$40, $41, $42","FROM __stage09_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $480 := $471, $481 := $470, $482 := $475, $483 := $476, $484 := $473, $485 := $474","$210 := SUM($472)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $462 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $442 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $31 = $20"]},{"kind":"WRITE","substeps":["$482, $483, $481, $480, $484, $485, $210","TO __stage0C_output","BY HASH($480, $481, $482, $483, $484, $485)"]}],"writeRatioAvg":0.007545685369953152},{"readMsMax":"129","computeMsMax":"3217","inputStages":["0","1","3"],"waitMsAvg":"2","id":"13","endMs":"1570992770620","waitMsMax":"5","startMs":"1570992751658","waitRatioMax":0.00017880771018846333,"readRatioAvg":0.0012516539713192433,"parallelInputs":"184","recordsRead":"319561459","computeRatioAvg":0.08600650860065086,"writeMsAvg":"246","status":"COMPLETE","writeMsMax":"14327","computeMsAvg":"2405","shuffleOutputBytesSpilled":"0","writeRatioMax":0.5123556127740229,"readMsAvg":"35","waitRatioAvg":7.152308407538533e-05,"completedParallelInputs":"184","computeRatioMax":0.1150448807352573,"name":"S0D: Join+","shuffleOutputBytes":"1241885769","recordsWritten":"15490602","readRatioMax":0.004613238922862354,"steps":[{"kind":"READ","substeps":["$100:ss_sold_date_sk, $101:ss_item_sk, $102:ss_store_sk, $103:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$90, $91, $92","FROM __stage03_output"]},{"kind":"READ","substeps":["$110, $111, $112","FROM __stage01_output"]},{"kind":"READ","substeps":["$80, $81, $82","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $290 := $281, $291 := $280, $292 := $285, $293 := $286, $294 := $283, $295 := $284","$240 := SUM($282)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $272 = $80"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $252 = $110"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $101 = $90"]},{"kind":"WRITE","substeps":["$292, $293, $291, $290, $294, $295, $240","TO __stage0D_output","BY HASH($290, $291, $292, $293, $294, $295)"]}],"writeRatioAvg":0.008797339341272395},{"readMsMax":"124","computeMsMax":"3569","inputStages":["4","5","7"],"waitMsAvg":"2","id":"14","endMs":"1570992780868","waitMsMax":"6","startMs":"1570992751691","waitRatioMax":0.000214569252226156,"readRatioAvg":0.001180130887243858,"parallelInputs":"184","recordsRead":"319561459","computeRatioAvg":0.08661445481529163,"writeMsAvg":"264","status":"COMPLETE","writeMsMax":"27963","computeMsAvg":"2422","shuffleOutputBytesSpilled":"0","writeRatioMax":1,"readMsAvg":"33","waitRatioAvg":7.152308407538533e-05,"completedParallelInputs":"184","computeRatioMax":0.12763294353252513,"name":"S0E: Join+","shuffleOutputBytes":"1241885769","recordsWritten":"15490602","readRatioMax":0.004434431212673891,"steps":[{"kind":"READ","substeps":["$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_store_sk, $63:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$50, $51, $52","FROM __stage07_output"]},{"kind":"READ","substeps":["$70, $71, $72","FROM __stage05_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $390 := $381, $391 := $380, $392 := $385, $393 := $386, $394 := $383, $395 := $384","$220 := SUM($382)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $372 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $352 = $70"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $61 = $50"]},{"kind":"WRITE","substeps":["$392, $393, $391, $390, $394, $395, $220","TO __stage0E_output","BY HASH($390, $391, $392, $393, $394, $395)"]}],"writeRatioAvg":0.009441047097950864},{"readMsMax":"0","computeMsMax":"1002","inputStages":["12"],"waitMsAvg":"1","id":"15","endMs":"1570992768688","waitMsMax":"3","startMs":"1570992767693","waitRatioMax":0.000107284626113078,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"15490602","computeRatioAvg":0.030933733862604156,"writeMsAvg":"89","status":"COMPLETE","writeMsMax":"463","computeMsAvg":"865","shuffleOutputBytesSpilled":"0","writeRatioMax":0.016557593963451703,"readMsAvg":"0","waitRatioAvg":3.576154203769266e-05,"completedParallelInputs":"18","computeRatioMax":0.03583306512176805,"name":"S0F: Aggregate","shuffleOutputBytes":"12343865","recordsWritten":"157722","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$482, $483, $481, $480, $484, $485, $210","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $490 := $480, $491 := $481, $492 := $482, $493 := $483, $494 := $484, $495 := $485","$180 := SUM($210)"]},{"kind":"WRITE","substeps":["$492, $493, $491, $490, $494, $495, $180","TO __stage0F_output","BY HASH($490, $491, $492, $493)"]}],"writeRatioAvg":0.003182777241354647},{"readMsMax":"0","computeMsMax":"1064","inputStages":["13"],"waitMsAvg":"1","id":"16","endMs":"1570992798692","waitMsMax":"2","startMs":"1570992771069","waitRatioMax":7.152308407538533e-05,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"15490602","computeRatioAvg":0.03032578764796338,"writeMsAvg":"1485","status":"COMPLETE","writeMsMax":"25716","computeMsAvg":"848","shuffleOutputBytesSpilled":"0","writeRatioMax":0.9196438150413045,"readMsAvg":"0","waitRatioAvg":3.576154203769266e-05,"completedParallelInputs":"18","computeRatioMax":0.038050280728105,"name":"S10: Aggregate","shuffleOutputBytes":"12343865","recordsWritten":"157722","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$292, $293, $291, $290, $294, $295, $240","FROM __stage0D_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $300 := $290, $301 := $291, $302 := $292, $303 := $293, $304 := $294, $305 := $295","$230 := SUM($240)"]},{"kind":"WRITE","substeps":["$302, $303, $301, $300, $304, $305, $230","TO __stage10_output","BY HASH($300, $301, $302, $303, $304)"]}],"writeRatioAvg":0.05310588992597361},{"readMsMax":"0","computeMsMax":"1002","inputStages":["14"],"waitMsAvg":"1","id":"17","endMs":"1570992782601","waitMsMax":"2","startMs":"1570992781960","waitRatioMax":7.152308407538533e-05,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"15490602","computeRatioAvg":0.03182777241354647,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"890","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0009655616350177019,"readMsAvg":"0","waitRatioAvg":3.576154203769266e-05,"completedParallelInputs":"18","computeRatioMax":0.03583306512176805,"name":"S11: Aggregate","shuffleOutputBytes":"12343865","recordsWritten":"157722","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$392, $393, $391, $390, $394, $395, $220","FROM __stage0E_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $400 := $390, $401 := $391, $402 := $392, $403 := $393, $404 := $394, $405 := $395","$200 := SUM($220)"]},{"kind":"WRITE","substeps":["$402, $403, $401, $400, $404, $405, $200","TO __stage11_output","BY HASH($400, $401, $402, $403)"]}],"writeRatioAvg":0.0007867539248292386},{"readMsMax":"0","computeMsMax":"92","inputStages":["16"],"waitMsAvg":"1","id":"18","endMs":"1570992811702","waitMsMax":"2","startMs":"1570992799967","waitRatioMax":7.152308407538533e-05,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"157722","computeRatioAvg":0.002002646354110789,"writeMsAvg":"663","status":"COMPLETE","writeMsMax":"11539","computeMsAvg":"56","shuffleOutputBytesSpilled":"0","writeRatioMax":0.4126524335729357,"readMsAvg":"0","waitRatioAvg":3.576154203769266e-05,"completedParallelInputs":"18","computeRatioMax":0.003290061867467725,"name":"S12: Sort+","shuffleOutputBytes":"13763339","recordsWritten":"157722","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$302, $303, $301, $300, $304, $305, $230","FROM __stage10_output"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$190 := AVG($316) OVER (PARTITION BY $313, $312, $310, $311, $314 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)"]},{"kind":"SORT","substeps":["$300 ASC, $301 ASC, $302 ASC, $303 ASC, $304 ASC"]},{"kind":"WRITE","substeps":["$320, $321, $322, $323, $324, $325, $190, $326","TO __stage12_output","BY HASH($323, $322, $320, $321)"]}],"writeRatioAvg":0.023709902370990237},{"readMsMax":"0","computeMsMax":"57","inputStages":["15"],"waitMsAvg":"1","id":"19","endMs":"1570992812399","waitMsMax":"2","startMs":"1570992812182","waitRatioMax":7.152308407538533e-05,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"157722","computeRatioAvg":0.0016450309337338626,"writeMsAvg":"151","status":"COMPLETE","writeMsMax":"178","computeMsAvg":"46","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006365554482709294,"readMsAvg":"0","waitRatioAvg":3.576154203769266e-05,"completedParallelInputs":"18","computeRatioMax":0.002038407896148482,"name":"S13: Sort+","shuffleOutputBytes":"8715200","recordsWritten":"120160","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$492, $493, $491, $490, $494, $495, $180","FROM __stage0F_output"]},{"kind":"COMPUTE","substeps":["$130 := subtract($150, 1)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$150 := RANK() OVER (PARTITION BY $503, $502, $500, $501 ORDER BY $504 ASC, $505 ASC)"]},{"kind":"SORT","substeps":["$490 ASC, $491 ASC, $492 ASC, $493 ASC, $494 ASC, $495 ASC"]},{"kind":"WRITE","substeps":["$130, $510, $511, $512, $513, $514","TO __stage13_output","BY HASH($513, $512, $510, $511, $130)"]}],"writeRatioAvg":0.005399992847691592},{"readMsMax":"0","computeMsMax":"61","inputStages":["18"],"waitMsAvg":"1","id":"21","endMs":"1570992812381","waitMsMax":"1","startMs":"1570992812298","waitRatioMax":3.576154203769266e-05,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"157722","computeRatioAvg":0.0015735078496584773,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"44","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0009655616350177019,"readMsAvg":"0","waitRatioAvg":3.576154203769266e-05,"completedParallelInputs":"18","computeRatioMax":0.0021814540642992528,"name":"S15: Sort+","shuffleOutputBytes":"10149007","recordsWritten":"101981","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$320, $321, $322, $323, $324, $325, $190, $326","FROM __stage12_output"]},{"kind":"FILTER","substeps":["and(equal($344, 1999), greater($346, 0), ...)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$160 := RANK() OVER (PARTITION BY $333, $332, $330, $331 ORDER BY $334 ASC, $335 ASC)"]},{"kind":"SORT","substeps":["$323 ASC, $322 ASC, $320 ASC, $321 ASC, $324 ASC, $325 ASC"]},{"kind":"WRITE","substeps":["$160, $340, $341, $342, $343, $344, $345, $346, $347","TO __stage15_output","BY HASH($343, $342, $340, $341, $160)"]}],"writeRatioAvg":0.000750992382791546},{"readMsMax":"0","computeMsMax":"18","inputStages":["21"],"waitMsAvg":"1","id":"22","endMs":"1570992812608","waitMsMax":"2","startMs":"1570992812385","waitRatioMax":7.152308407538533e-05,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"101981","computeRatioAvg":0.00025033079426384864,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"82","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0029324464470907984,"readMsAvg":"0","waitRatioAvg":3.576154203769266e-05,"completedParallelInputs":"100","computeRatioMax":0.000643707756678468,"name":"S16: Coalesce","shuffleOutputBytes":"10149007","recordsWritten":"101981","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage15_output"]}],"writeRatioAvg":0.0007152308407538533},{"readMsMax":"0","computeMsMax":"10","inputStages":["19"],"waitMsAvg":"2","id":"24","endMs":"1570992812521","waitMsMax":"5","startMs":"1570992812408","waitRatioMax":0.00017880771018846333,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"120160","computeRatioAvg":0.000214569252226156,"writeMsAvg":"39","status":"COMPLETE","writeMsMax":"62","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0022172156063369453,"readMsAvg":"0","waitRatioAvg":7.152308407538533e-05,"completedParallelInputs":"100","computeRatioMax":0.00035761542037692667,"name":"S18: Coalesce","shuffleOutputBytes":"8715200","recordsWritten":"120160","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage13_output"]}],"writeRatioAvg":0.001394700139470014},{"readMsMax":"0","computeMsMax":"568","inputStages":["17","24","22"],"waitMsAvg":"6","id":"25","endMs":"1570992812882","waitMsMax":"6","startMs":"1570992812413","waitRatioMax":0.000214569252226156,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"4156260","computeRatioAvg":0.015985409290848622,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"447","shuffleOutputBytesSpilled":"0","writeRatioMax":0.000214569252226156,"readMsAvg":"0","waitRatioAvg":0.000214569252226156,"completedParallelInputs":"18","computeRatioMax":0.020312555877409433,"name":"S19: Join+","shuffleOutputBytes":"131803","recordsWritten":"1800","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$402, $403, $401, $400, $404, $405, $200","FROM __stage11_output"]},{"kind":"READ","substeps":["$160, $340, $341, $342, $343, $344, $345, $346, $347","FROM __stage16_output"]},{"kind":"READ","substeps":["$130, $510, $511, $512, $513, $514","FROM __stage18_output"]},{"kind":"SORT","substeps":["$120 ASC, $522 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$120 := subtract($525, $523)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $433 = $513, $432 = $512, $430 = $510, $431 = $511, $436 = $130"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $423 = $343, $422 = $342, $420 = $340, $421 = $341, $140 = $160"]},{"kind":"COMPUTE","substeps":["$140 := add($170, 1)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$170 := RANK() OVER (PARTITION BY $413, $412, $410, $411 ORDER BY $414 ASC, $415 ASC)"]},{"kind":"SORT","substeps":["$400 ASC, $401 ASC, $402 ASC, $403 ASC, $404 ASC, $405 ASC"]},{"kind":"WRITE","substeps":["$530, $531, $532, $533, $534, $535, $536, $537","TO __stage19_output"]}],"writeRatioAvg":0.00014304616815077065},{"readMsMax":"0","computeMsMax":"7","inputStages":["25"],"waitMsAvg":"1","id":"26","endMs":"1570992812893","waitMsMax":"1","startMs":"1570992812443","waitRatioMax":3.576154203769266e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1800","computeRatioAvg":0.00025033079426384864,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00017880771018846333,"readMsAvg":"0","waitRatioAvg":3.576154203769266e-05,"completedParallelInputs":"1","computeRatioMax":0.00025033079426384864,"name":"S1A: Output","shuffleOutputBytes":"6435","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$530, $531, $532, $533, $534, $535, $536, $537","FROM __stage19_output"]},{"kind":"SORT","substeps":["$533 ASC, $532 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$540, $541, $542, $543, $544, $545, $546","TO __stage1A_output"]}],"writeRatioAvg":0.00017880771018846333}],"estimatedBytesProcessed":"8724129740","timeline":[{"totalSlotMs":"19786","activeUnits":"370","completedUnits":"4","elapsedMs":"803","pendingUnits":"371"},{"totalSlotMs":"553841","activeUnits":"555","completedUnits":"9","elapsedMs":"1850","pendingUnits":"552"},{"totalSlotMs":"1837782","activeUnits":"444","completedUnits":"490","elapsedMs":"3298","pendingUnits":"71"},{"totalSlotMs":"1953551","activeUnits":"68","completedUnits":"540","elapsedMs":"4340","pendingUnits":"21"},{"totalSlotMs":"2013400","activeUnits":"48","completedUnits":"549","elapsedMs":"5444","pendingUnits":"12"},{"totalSlotMs":"2046787","activeUnits":"30","completedUnits":"551","elapsedMs":"6186","pendingUnits":"10"},{"totalSlotMs":"2095144","activeUnits":"27","completedUnits":"554","elapsedMs":"7802","pendingUnits":"7"},{"totalSlotMs":"2164088","activeUnits":"18","completedUnits":"556","elapsedMs":"11083","pendingUnits":"5"},{"totalSlotMs":"2274454","activeUnits":"12","completedUnits":"559","elapsedMs":"17568","pendingUnits":"2"},{"totalSlotMs":"2302275","activeUnits":"18","completedUnits":"577","elapsedMs":"18654","pendingUnits":"2"},{"totalSlotMs":"2337304","activeUnits":"21","completedUnits":"594","elapsedMs":"21962","pendingUnits":"3"},{"totalSlotMs":"2343259","activeUnits":"6","completedUnits":"595","elapsedMs":"22979","pendingUnits":"2"},{"totalSlotMs":"2390465","activeUnits":"3","completedUnits":"596","elapsedMs":"31313","pendingUnits":"1"},{"totalSlotMs":"2414162","activeUnits":"18","completedUnits":"614","elapsedMs":"32910","pendingUnits":"1"},{"totalSlotMs":"2462898","activeUnits":"0","completedUnits":"615","elapsedMs":"49139","pendingUnits":"0"},{"totalSlotMs":"2465275","activeUnits":"3","completedUnits":"632","elapsedMs":"50407","pendingUnits":"1"},{"totalSlotMs":"2529923","activeUnits":"18","completedUnits":"877","elapsedMs":"63143","pendingUnits":"11"},{"totalSlotMs":"2533892","completedUnits":"888","elapsedMs":"63189","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"8724152320","totalPartitionsProcessed":"0","totalBytesProcessed":"8724129740","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_100"}]},"endTime":"1570992814417"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query47_1570992747"},"etag":"lDK/hZhtnu8GGQj+RUrDAw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query47_1570992747?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon01af061dddfe81516e74866bb0eeb946f7281423","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query47\nWITH v1 \n AS (SELECT i_category, \n i_brand, \n s_store_name, \n s_company_name, \n d_year, \n d_moy, \n Sum(ss_sales_price) sum_sales, \n Avg(Sum(ss_sales_price)) \n OVER ( \n partition BY i_category, i_brand, s_store_name, \n s_company_name, \n d_year) \n avg_monthly_sales, \n Rank() \n OVER ( \n partition BY i_category, i_brand, s_store_name, \n s_company_name \n ORDER BY d_year, d_moy) rn \n FROM item, \n store_sales, \n date_dim, \n store \n WHERE ss_item_sk = i_item_sk \n AND ss_sold_date_sk = d_date_sk \n AND ss_store_sk = s_store_sk \n AND ( d_year = 1999 \n OR ( d_year = 1999 - 1 \n AND d_moy = 12 ) \n OR ( d_year = 1999 + 1 \n AND d_moy = 1 ) ) \n GROUP BY i_category, \n i_brand, \n s_store_name, \n s_company_name, \n d_year, \n d_moy), \n v2 \n AS (SELECT v1.i_category, \n v1.d_year, \n v1.d_moy, \n v1.avg_monthly_sales, \n v1.sum_sales, \n v1_lag.sum_sales psum, \n v1_lead.sum_sales nsum \n FROM v1, \n v1 v1_lag, \n v1 v1_lead \n WHERE v1.i_category = v1_lag.i_category \n AND v1.i_category = v1_lead.i_category \n AND v1.i_brand = v1_lag.i_brand \n AND v1.i_brand = v1_lead.i_brand \n AND v1.s_store_name = v1_lag.s_store_name \n AND v1.s_store_name = v1_lead.s_store_name \n AND v1.s_company_name = v1_lag.s_company_name \n AND v1.s_company_name = v1_lead.s_company_name \n AND v1.rn = v1_lag.rn + 1 \n AND v1.rn = v1_lead.rn - 1) \nSELECT benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results scale_2.zip warmup \nFROM v2 \nWHERE d_year = 1999 \n AND avg_monthly_sales > 0 \n AND CASE \n WHEN avg_monthly_sales > 0 THEN Abs(sum_sales - avg_monthly_sales) \n / \n avg_monthly_sales \n ELSE NULL \n END > 0.1 \nORDER BY sum_sales - avg_monthly_sales, \n 3\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query47_1570992747","user_email":"nithish.sankaranarayanan@ulb.be"}
