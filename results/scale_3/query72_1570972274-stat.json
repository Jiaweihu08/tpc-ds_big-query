{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"664388","creationTime":"1570972275900","totalBytesProcessed":"5181538055","startTime":"1570972276044","query":{"totalSlotMs":"664388","queryPlan":[{"readMsMax":"34","computeMsMax":"1737","waitMsAvg":"1","id":"0","endMs":"1570972277155","waitMsMax":"1","startMs":"1570972276213","waitRatioMax":6.767273465520742e-05,"readRatioAvg":0.002300872978277052,"parallelInputs":"1","recordsRead":"1439802","computeRatioAvg":0.11754754009609528,"writeMsAvg":"89","status":"COMPLETE","writeMsMax":"89","computeMsAvg":"1737","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00602287338431346,"readMsAvg":"34","waitRatioAvg":6.767273465520742e-05,"completedParallelInputs":"1","computeRatioMax":0.11754754009609528,"name":"S00: Input","shuffleOutputBytes":"25916436","recordsWritten":"1439802","readRatioMax":0.002300872978277052,"steps":[{"kind":"READ","substeps":["$20:cr_item_sk, $21:cr_order_number","FROM catalog_returns"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage00_output","BY HASH($20, $21)"]}],"writeRatioAvg":0.00602287338431346},{"readMsMax":"34","computeMsMax":"6","waitMsAvg":"27","id":"1","endMs":"1570972276305","waitMsMax":"27","startMs":"1570972276254","waitRatioMax":0.0018271638356906002,"readRatioAvg":0.002300872978277052,"parallelInputs":"1","recordsRead":"500","computeRatioAvg":0.0004060364079312445,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0002706909386208297,"readMsAvg":"34","waitRatioAvg":0.0018271638356906002,"completedParallelInputs":"1","computeRatioMax":0.0004060364079312445,"name":"S01: Input","shuffleOutputBytes":"4500","recordsWritten":"500","readRatioMax":0.002300872978277052,"steps":[{"kind":"READ","substeps":["$30:p_promo_sk","FROM promotion"]},{"kind":"WRITE","substeps":["$30","TO __stage01_output","BY HASH($30)"]}],"writeRatioAvg":0.0002706909386208297},{"readMsMax":"19","computeMsMax":"9","waitMsAvg":"56","id":"2","endMs":"1570972276452","waitMsMax":"56","startMs":"1570972276298","waitRatioMax":0.0037896731406916154,"readRatioAvg":0.0012857819584489408,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0006090546118968668,"writeMsAvg":"74","status":"COMPLETE","writeMsMax":"74","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005007782364485349,"readMsAvg":"19","waitRatioAvg":0.0037896731406916154,"completedParallelInputs":"1","computeRatioMax":0.0006090546118968668,"name":"S02: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0012857819584489408,"steps":[{"kind":"READ","substeps":["$40:d_date_sk, $41:d_week_seq, $42:d_year","FROM date_dim","WHERE equal($42, 2002)"]},{"kind":"WRITE","substeps":["$40, $41","TO __stage02_output","BY HASH($40)"]}],"writeRatioAvg":0.005007782364485349},{"readMsMax":"40","computeMsMax":"6","waitMsAvg":"48","id":"3","endMs":"1570972276511","waitMsMax":"48","startMs":"1570972276306","waitRatioMax":0.003248291263449956,"readRatioAvg":0.0027069093862082966,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.0004060364079312445,"writeMsAvg":"155","status":"COMPLETE","writeMsMax":"155","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01048927387155715,"readMsAvg":"40","waitRatioAvg":0.003248291263449956,"completedParallelInputs":"1","computeRatioMax":0.0004060364079312445,"name":"S03: Input","shuffleOutputBytes":"10800","recordsWritten":"1200","readRatioMax":0.0027069093862082966,"steps":[{"kind":"READ","substeps":["$50:hd_demo_sk, $51:hd_buy_potential","FROM household_demographics","WHERE equal($51, '501-1000')"]},{"kind":"WRITE","substeps":["$50","TO __stage03_output","BY HASH($50)"]}],"writeRatioAvg":0.01048927387155715},{"readMsMax":"27","computeMsMax":"255","waitMsAvg":"1","id":"4","endMs":"1570972277133","waitMsMax":"1","startMs":"1570972276910","waitRatioMax":6.767273465520742e-05,"readRatioAvg":0.0018271638356906002,"parallelInputs":"1","recordsRead":"1920800","computeRatioAvg":0.01725654733707789,"writeMsAvg":"75","status":"COMPLETE","writeMsMax":"75","computeMsAvg":"255","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005075455099140556,"readMsAvg":"27","waitRatioAvg":6.767273465520742e-05,"completedParallelInputs":"1","computeRatioMax":0.01725654733707789,"name":"S04: Input","shuffleOutputBytes":"3457440","recordsWritten":"384160","readRatioMax":0.0018271638356906002,"steps":[{"kind":"READ","substeps":["$60:cd_demo_sk, $61:cd_marital_status","FROM customer_demographics","WHERE equal($61, 'M')"]},{"kind":"WRITE","substeps":["$60","TO __stage04_output","BY HASH($60)"]}],"writeRatioAvg":0.005075455099140556},{"readMsMax":"96","computeMsMax":"14777","waitMsAvg":"1","id":"5","endMs":"1570972286063","waitMsMax":"1","startMs":"1570972276982","waitRatioMax":6.767273465520742e-05,"readRatioAvg":0.0025038911822426744,"parallelInputs":"14","recordsRead":"133110000","computeRatioAvg":0.9151383907423699,"writeMsAvg":"288","status":"COMPLETE","writeMsMax":"2923","computeMsAvg":"13523","shuffleOutputBytesSpilled":"0","writeRatioMax":0.1978074033971713,"readMsAvg":"37","waitRatioAvg":6.767273465520742e-05,"completedParallelInputs":"14","computeRatioMax":1,"name":"S05: Input","shuffleOutputBytes":"4738704736","recordsWritten":"133110000","readRatioMax":0.006496582526899912,"steps":[{"kind":"READ","substeps":["$80:inv_date_sk, $81:inv_item_sk, $82:inv_warehouse_sk, $83:inv_quantity_on_hand","FROM inventory"]},{"kind":"WRITE","substeps":["$80, $81, $82, $83","TO __stage05_output","BY HASH($81, $80, $82)"]}],"writeRatioAvg":0.019489747580699737},{"readMsMax":"4318","computeMsMax":"4819","waitMsAvg":"1","id":"6","endMs":"1570972283580","waitMsMax":"1","startMs":"1570972277013","waitRatioMax":6.767273465520742e-05,"readRatioAvg":0.04385193205657441,"parallelInputs":"8","recordsRead":"14397323","computeRatioAvg":0.2956621777086012,"writeMsAvg":"123","status":"COMPLETE","writeMsMax":"219","computeMsAvg":"4369","shuffleOutputBytesSpilled":"0","writeRatioMax":0.014820328889490425,"readMsAvg":"648","waitRatioAvg":6.767273465520742e-05,"completedParallelInputs":"8","computeRatioMax":0.32611490830344453,"name":"S06: Input","shuffleOutputBytes":"1028261792","recordsWritten":"14289393","readRatioMax":0.29221086824118564,"steps":[{"kind":"READ","substeps":["$70:cs_sold_date_sk, $71:cs_bill_cdemo_sk, $72:cs_bill_hdemo_sk, $73:cs_warehouse_sk, $74:cs_item_sk, $75:cs_promo_sk, $76:cs_order_number, $77:cs_quantity","FROM catalog_sales"]},{"kind":"WRITE","substeps":["$70, $71, $72, $73, $74, $75, $76, $77","TO __stage06_output","BY HASH($74, $70, $73)"]}],"writeRatioAvg":0.008323746362590513},{"readMsMax":"0","computeMsMax":"11","inputStages":["4"],"waitMsAvg":"11","id":"7","endMs":"1570972286317","waitMsMax":"27","startMs":"1570972286072","waitRatioMax":0.0018271638356906002,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"384160","computeRatioAvg":0.0004737091425864519,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"53","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003586654936725993,"readMsAvg":"0","waitRatioAvg":0.0007444000812072816,"completedParallelInputs":"100","computeRatioMax":0.0007444000812072816,"name":"S07: Coalesce","shuffleOutputBytes":"3457440","recordsWritten":"384160","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage04_output"]}],"writeRatioAvg":0.001624145631724978},{"readMsMax":"0","computeMsMax":"20","inputStages":["0"],"waitMsAvg":"35","id":"8","endMs":"1570972286334","waitMsMax":"50","startMs":"1570972286075","waitRatioMax":0.003383636732760371,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1439802","computeRatioAvg":0.0009474182851729038,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"38","computeMsAvg":"14","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0025715639168978816,"readMsAvg":"0","waitRatioAvg":0.0023685457129322598,"completedParallelInputs":"100","computeRatioMax":0.0013534546931041483,"name":"S08: Coalesce","shuffleOutputBytes":"25916436","recordsWritten":"1439802","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage00_output"]}],"writeRatioAvg":0.0006767273465520742},{"readMsMax":"0","computeMsMax":"4472","inputStages":["8","6","2","1","3","7","5"],"waitMsAvg":"40","id":"9","endMs":"1570972293044","waitMsMax":"54","startMs":"1570972286124","waitRatioMax":0.0036543276713812004,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"330002093","computeRatioAvg":0.22602693374839278,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"46","computeMsAvg":"3340","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0031129457941395412,"readMsAvg":"0","waitRatioAvg":0.0027069093862082966,"completedParallelInputs":"100","computeRatioMax":0.3026324693780876,"name":"S09: Join+","shuffleOutputBytes":"33804","recordsWritten":"626","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$70, $71, $72, $73, $74, $75, $76, $77","FROM __stage06_output"]},{"kind":"READ","substeps":["$80, $81, $82, $83","FROM __stage05_output"]},{"kind":"READ","substeps":["$60","FROM __stage07_output"]},{"kind":"READ","substeps":["$50","FROM __stage03_output"]},{"kind":"READ","substeps":["$40, $41","FROM __stage02_output"]},{"kind":"READ","substeps":["$30","FROM __stage01_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $183, $191 := $182, $192 := $181","$100 := SUM($111)","$101 := SUM($110)","$102 := COUNT_STAR()"]},{"kind":"COMPUTE","substeps":["$110 := case_no_value(not(is_null($180)), 1, 0)","$111 := case_no_value(is_null($180), 1, 0)"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $172 = $20, $173 = $21"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $162 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $150 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $141 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $121 = $60"]},{"kind":"FILTER","substeps":["less($128, $127)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH EACH ON $74 = $81, $70 = $80, $73 = $82"]},{"kind":"WRITE","substeps":["$192, $191, $190, $100, $101, $102","TO __stage09_output","BY HASH($190, $191, $192)"]}],"writeRatioAvg":0.0004737091425864519},{"readMsMax":"0","computeMsMax":"10","inputStages":["9"],"waitMsAvg":"5","id":"12","endMs":"1570972298253","waitMsMax":"5","startMs":"1570972298161","waitRatioMax":0.0003383636732760371,"readRatioAvg":0,"parallelInputs":"2","recordsRead":"626","computeRatioAvg":0.0005413818772416594,"writeMsAvg":"36","status":"COMPLETE","writeMsMax":"48","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003248291263449956,"readMsAvg":"0","waitRatioAvg":0.0003383636732760371,"completedParallelInputs":"2","computeRatioMax":0.0006767273465520742,"name":"S0C: Aggregate","shuffleOutputBytes":"33804","recordsWritten":"626","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$192, $191, $190, $100, $101, $102","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $200 := $190, $201 := $191, $202 := $192","$90 := SUM($100)","$91 := SUM($101)","$92 := SUM_OF_COUNTS($102)"]},{"kind":"WRITE","substeps":["$90, $91, $92, $200, $201, $202","TO __stage0C_output","BY HASH($201)"]}],"writeRatioAvg":0.002436218447587467},{"readMsMax":"0","computeMsMax":"8","inputStages":["12"],"waitMsAvg":"2","id":"13","endMs":"1570972298394","waitMsMax":"5","startMs":"1570972298265","waitRatioMax":0.0003383636732760371,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"626","computeRatioAvg":0.0003383636732760371,"writeMsAvg":"49","status":"COMPLETE","writeMsMax":"67","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004534073221898897,"readMsAvg":"0","waitRatioAvg":0.00013534546931041484,"completedParallelInputs":"100","computeRatioMax":0.0005413818772416594,"name":"S0D: Coalesce","shuffleOutputBytes":"33804","recordsWritten":"626","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0C_output"]}],"writeRatioAvg":0.0033159639981051635},{"readMsMax":"10","computeMsMax":"17","inputStages":["13"],"waitMsAvg":"1","id":"14","endMs":"1570972298420","waitMsMax":"1","startMs":"1570972298291","waitRatioMax":6.767273465520742e-05,"readRatioAvg":0.0006767273465520742,"parallelInputs":"1","recordsRead":"636","computeRatioAvg":0.001150436489138526,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"17","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007444000812072816,"readMsAvg":"10","waitRatioAvg":6.767273465520742e-05,"completedParallelInputs":"1","computeRatioMax":0.001150436489138526,"name":"S0E: Join","shuffleOutputBytes":"41324","recordsWritten":"626","readRatioMax":0.0006767273465520742,"steps":[{"kind":"READ","substeps":["$10:w_warehouse_sk, $11:w_warehouse_name","FROM warehouse"]},{"kind":"READ","substeps":["$90, $91, $92, $200, $201, $202","FROM __stage0D_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $10 = $201"]},{"kind":"WRITE","substeps":["$210, $211, $212, $213, $214, $215","TO __stage0E_output","BY HASH($211)"]}],"writeRatioAvg":0.0007444000812072816},{"readMsMax":"0","computeMsMax":"13","inputStages":["14"],"waitMsAvg":"1","id":"15","endMs":"1570972298703","waitMsMax":"4","startMs":"1570972298449","waitRatioMax":0.0002706909386208297,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"626","computeRatioAvg":0.0003383636732760371,"writeMsAvg":"44","status":"COMPLETE","writeMsMax":"61","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004128036813967653,"readMsAvg":"0","waitRatioAvg":6.767273465520742e-05,"completedParallelInputs":"100","computeRatioMax":0.0008797455505176965,"name":"S0F: Coalesce","shuffleOutputBytes":"41324","recordsWritten":"626","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0E_output"]}],"writeRatioAvg":0.0029776003248291262},{"readMsMax":"24","computeMsMax":"58","inputStages":["15"],"waitMsAvg":"5","id":"16","endMs":"1570972298742","waitMsMax":"5","startMs":"1570972298454","waitRatioMax":0.0003383636732760371,"readRatioAvg":0.001624145631724978,"parallelInputs":"1","recordsRead":"102626","computeRatioAvg":0.00392501861000203,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"3","computeMsAvg":"58","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00020301820396562224,"readMsAvg":"24","waitRatioAvg":0.0003383636732760371,"completedParallelInputs":"1","computeRatioMax":0.00392501861000203,"name":"S10: Join+","shuffleOutputBytes":"14983","recordsWritten":"100","readRatioMax":0.001624145631724978,"steps":[{"kind":"READ","substeps":["$1:i_item_sk, $2:i_item_desc","FROM item"]},{"kind":"READ","substeps":["$210, $211, $212, $213, $214, $215","FROM __stage0F_output"]},{"kind":"SORT","substeps":["$224 DESC, $225 ASC, $220 ASC, $221 ASC","LIMIT 100"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $211"]},{"kind":"WRITE","substeps":["$230, $231, $232, $233, $234, $235","TO __stage10_output"]}],"writeRatioAvg":0.00020301820396562224},{"readMsMax":"0","computeMsMax":"5","inputStages":["16"],"waitMsAvg":"1","id":"17","endMs":"1570972298783","waitMsMax":"1","startMs":"1570972298477","waitRatioMax":6.767273465520742e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0003383636732760371,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0003383636732760371,"readMsAvg":"0","waitRatioAvg":6.767273465520742e-05,"completedParallelInputs":"1","computeRatioMax":0.0003383636732760371,"name":"S11: Output","shuffleOutputBytes":"14983","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$230, $231, $232, $233, $234, $235","FROM __stage10_output"]},{"kind":"SORT","substeps":["$235 DESC, $230 ASC, $231 ASC, $232 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$240, $241, $242, $243, $244, $245","TO __stage11_output"]}],"writeRatioAvg":0.0003383636732760371}],"estimatedBytesProcessed":"5181538055","timeline":[{"totalSlotMs":"760","activeUnits":"1","completedUnits":"3","elapsedMs":"670","pendingUnits":"2"},{"totalSlotMs":"9732","activeUnits":"22","completedUnits":"5","elapsedMs":"1366","pendingUnits":"22"},{"totalSlotMs":"97173","activeUnits":"16","completedUnits":"12","elapsedMs":"3783","pendingUnits":"15"},{"totalSlotMs":"174413","activeUnits":"17","completedUnits":"12","elapsedMs":"6466","pendingUnits":"15"},{"totalSlotMs":"223118","activeUnits":"5","completedUnits":"25","elapsedMs":"8575","pendingUnits":"2"},{"totalSlotMs":"229319","activeUnits":"2","completedUnits":"26","elapsedMs":"9510","pendingUnits":"1"},{"totalSlotMs":"284670","activeUnits":"100","completedUnits":"227","elapsedMs":"10521","pendingUnits":"100"},{"totalSlotMs":"630055","activeUnits":"46","completedUnits":"323","elapsedMs":"12690","pendingUnits":"4"},{"totalSlotMs":"636622","activeUnits":"4","completedUnits":"326","elapsedMs":"13915","pendingUnits":"1"},{"totalSlotMs":"638126","activeUnits":"3","completedUnits":"326","elapsedMs":"15130","pendingUnits":"1"},{"totalSlotMs":"644593","activeUnits":"0","completedUnits":"327","elapsedMs":"17502","pendingUnits":"0"},{"totalSlotMs":"651912","activeUnits":"102","completedUnits":"430","elapsedMs":"22476","pendingUnits":"102"},{"totalSlotMs":"664388","activeUnits":"102","completedUnits":"532","elapsedMs":"25300","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"5182062592","totalPartitionsProcessed":"0","totalBytesProcessed":"5181538055","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"warehouse","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"promotion","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"inventory","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer_demographics","datasetId":"scale_10"}]},"endTime":"1570972301367"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query72_1570972274"},"etag":"GywadgYmlunXwjtiDCofew==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query72_1570972274?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anond96da77d73bf982c67fe8287b41963f8e86d577f","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query72\nWITH top_items AS (\n SELECT cs_item_sk, \n cs_warehouse_sk, \n d1.d_week_seq, \n Sum(CASE \n WHEN p_promo_sk IS NULL THEN 1 \n ELSE 0 \n END) no_promo, \n Sum(CASE \n WHEN p_promo_sk IS NOT NULL THEN 1 \n ELSE 0 \n END) promo, \n Count(*) total_cnt \n FROM catalog_sales \n JOIN inventory \n ON ( cs_item_sk = inv_item_sk and cs_sold_date_sk = inv_date_sk and cs_warehouse_sk = inv_warehouse_sk ) \n JOIN customer_demographics \n ON ( cs_bill_cdemo_sk = cd_demo_sk ) \n JOIN household_demographics \n ON ( cs_bill_hdemo_sk = hd_demo_sk ) \n JOIN date_dim d1 \n ON ( cs_sold_date_sk = d1.d_date_sk ) \n LEFT OUTER JOIN promotion \n ON ( cs_promo_sk = p_promo_sk ) \n LEFT OUTER JOIN catalog_returns \n ON ( cr_item_sk = cs_item_sk \n AND cr_order_number = cs_order_number ) \n WHERE inv_quantity_on_hand < cs_quantity \n AND hd_buy_potential = '501-1000' \n AND d1.d_year = 2002 \n AND cd_marital_status = 'M' \n GROUP BY 1, 2, 3\n)\nSELECT i_item_desc, \n w_warehouse_name, \n d_week_seq,\n no_promo,\n promo,\n total_cnt\nFROM top_items \nJOIN warehouse \n ON ( w_warehouse_sk = cs_warehouse_sk ) \nJOIN item \n ON ( i_item_sk = cs_item_sk ) \nORDER BY total_cnt DESC, \n 1, 2, 3\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query72_1570972274","user_email":"nithish.sankaranarayanan@ulb.be"}
