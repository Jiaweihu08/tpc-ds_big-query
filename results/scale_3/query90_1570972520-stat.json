{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"9360","creationTime":"1570972522247","totalBytesProcessed":"174282504","startTime":"1570972522363","query":{"totalSlotMs":"9360","queryPlan":[{"readMsMax":"24","computeMsMax":"9","waitMsAvg":"1","id":"0","endMs":"1570972522660","waitMsMax":"1","startMs":"1570972522600","waitRatioMax":0.0010964912280701754,"readRatioAvg":0.02631578947368421,"parallelInputs":"1","recordsRead":"200","computeRatioAvg":0.009868421052631578,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010964912280701754,"readMsAvg":"24","waitRatioAvg":0.0010964912280701754,"completedParallelInputs":"1","computeRatioMax":0.009868421052631578,"name":"S00: Input","shuffleOutputBytes":"45","recordsWritten":"5","readRatioMax":0.02631578947368421,"steps":[{"kind":"READ","substeps":["$10:wp_web_page_sk, $11:wp_char_count","FROM web_page","WHERE between($11, 5000, 5200)"]},{"kind":"WRITE","substeps":["$10","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.010964912280701754},{"readMsMax":"10","computeMsMax":"9","waitMsAvg":"25","id":"1","endMs":"1570972522831","waitMsMax":"25","startMs":"1570972522642","waitRatioMax":0.027412280701754384,"readRatioAvg":0.010964912280701754,"parallelInputs":"1","recordsRead":"86400","computeRatioAvg":0.009868421052631578,"writeMsAvg":"167","status":"COMPLETE","writeMsMax":"167","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.18311403508771928,"readMsAvg":"10","waitRatioAvg":0.027412280701754384,"completedParallelInputs":"1","computeRatioMax":0.009868421052631578,"name":"S01: Input","shuffleOutputBytes":"64800","recordsWritten":"7200","readRatioMax":0.010964912280701754,"steps":[{"kind":"READ","substeps":["$50:t_time_sk, $51:t_hour","FROM time_dim","WHERE between($51, 20, 21)"]},{"kind":"WRITE","substeps":["$50","TO __stage01_output","BY HASH($50)"]}],"writeRatioAvg":0.18311403508771928},{"readMsMax":"50","computeMsMax":"10","waitMsAvg":"28","id":"2","endMs":"1570972522824","waitMsMax":"28","startMs":"1570972522661","waitRatioMax":0.03070175438596491,"readRatioAvg":0.05482456140350877,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.010964912280701754,"writeMsAvg":"53","status":"COMPLETE","writeMsMax":"53","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0581140350877193,"readMsAvg":"50","waitRatioAvg":0.03070175438596491,"completedParallelInputs":"1","computeRatioMax":0.010964912280701754,"name":"S02: Input","shuffleOutputBytes":"6480","recordsWritten":"720","readRatioMax":0.05482456140350877,"steps":[{"kind":"READ","substeps":["$70:hd_demo_sk, $71:hd_dep_count","FROM household_demographics","WHERE equal($71, 8)"]},{"kind":"WRITE","substeps":["$70","TO __stage02_output","BY HASH($70)"]}],"writeRatioAvg":0.0581140350877193},{"readMsMax":"8","computeMsMax":"7","waitMsAvg":"8","id":"4","endMs":"1570972522815","waitMsMax":"8","startMs":"1570972522765","waitRatioMax":0.008771929824561403,"readRatioAvg":0.008771929824561403,"parallelInputs":"1","recordsRead":"200","computeRatioAvg":0.007675438596491228,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.020833333333333332,"readMsAvg":"8","waitRatioAvg":0.008771929824561403,"completedParallelInputs":"1","computeRatioMax":0.007675438596491228,"name":"S04: Input","shuffleOutputBytes":"45","recordsWritten":"5","readRatioMax":0.008771929824561403,"steps":[{"kind":"READ","substeps":["$1:wp_web_page_sk, $2:wp_char_count","FROM web_page","WHERE between($2, 5000, 5200)"]},{"kind":"WRITE","substeps":["$1","TO __stage04_output","BY HASH($1)"]}],"writeRatioAvg":0.020833333333333332},{"readMsMax":"8","computeMsMax":"11","waitMsAvg":"2","id":"5","endMs":"1570972523006","waitMsMax":"2","startMs":"1570972522811","waitRatioMax":0.0021929824561403508,"readRatioAvg":0.008771929824561403,"parallelInputs":"1","recordsRead":"86400","computeRatioAvg":0.01206140350877193,"writeMsAvg":"164","status":"COMPLETE","writeMsMax":"164","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.17982456140350878,"readMsAvg":"8","waitRatioAvg":0.0021929824561403508,"completedParallelInputs":"1","computeRatioMax":0.01206140350877193,"name":"S05: Input","shuffleOutputBytes":"64800","recordsWritten":"7200","readRatioMax":0.008771929824561403,"steps":[{"kind":"READ","substeps":["$30:t_time_sk, $31:t_hour","FROM time_dim","WHERE between($31, 12, 13)"]},{"kind":"WRITE","substeps":["$30","TO __stage05_output","BY HASH($30)"]}],"writeRatioAvg":0.17982456140350878},{"readMsMax":"9","computeMsMax":"6","waitMsAvg":"1","id":"6","endMs":"1570972522938","waitMsMax":"1","startMs":"1570972522898","waitRatioMax":0.0010964912280701754,"readRatioAvg":0.009868421052631578,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.006578947368421052,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007675438596491228,"readMsAvg":"9","waitRatioAvg":0.0010964912280701754,"completedParallelInputs":"1","computeRatioMax":0.006578947368421052,"name":"S06: Input","shuffleOutputBytes":"6480","recordsWritten":"720","readRatioMax":0.009868421052631578,"steps":[{"kind":"READ","substeps":["$60:hd_demo_sk, $61:hd_dep_count","FROM household_demographics","WHERE equal($61, 8)"]},{"kind":"WRITE","substeps":["$60","TO __stage06_output","BY HASH($60)"]}],"writeRatioAvg":0.007675438596491228},{"readMsMax":"38","computeMsMax":"835","inputStages":["0","1","2"],"waitMsAvg":"2","id":"9","endMs":"1570972523517","waitMsMax":"2","startMs":"1570972522969","waitRatioMax":0.0021929824561403508,"readRatioAvg":0.03399122807017544,"parallelInputs":"4","recordsRead":"7232730","computeRatioAvg":0.8804824561403509,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"803","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007675438596491228,"readMsAvg":"31","waitRatioAvg":0.0021929824561403508,"completedParallelInputs":"4","computeRatioMax":0.9155701754385965,"name":"S09: Join+","shuffleOutputBytes":"36","recordsWritten":"4","readRatioMax":0.041666666666666664,"steps":[{"kind":"READ","substeps":["$40:ws_sold_time_sk, $41:ws_ship_hdemo_sk, $42:ws_web_page_sk","FROM web_sales"]},{"kind":"READ","substeps":["$70","FROM __stage02_output"]},{"kind":"READ","substeps":["$50","FROM __stage01_output"]},{"kind":"READ","substeps":["$10","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["$120 := COUNT_STAR()"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $170 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $160 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $41 = $70"]},{"kind":"WRITE","substeps":["$120","TO __stage09_output"]}],"writeRatioAvg":0.006578947368421052},{"readMsMax":"0","computeMsMax":"4","inputStages":["9"],"waitMsAvg":"7","id":"10","endMs":"1570972523535","waitMsMax":"7","startMs":"1570972522975","waitRatioMax":0.007675438596491228,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"4","computeRatioAvg":0.0043859649122807015,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006578947368421052,"readMsAvg":"0","waitRatioAvg":0.007675438596491228,"completedParallelInputs":"1","computeRatioMax":0.0043859649122807015,"name":"S0A: Aggregate","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$120","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["$100 := SUM_OF_COUNTS($120)"]},{"kind":"WRITE","substeps":["$100","TO __stage0A_output"]}],"writeRatioAvg":0.006578947368421052},{"readMsMax":"29","computeMsMax":"912","inputStages":["4","5","6"],"waitMsAvg":"3","id":"12","endMs":"1570972523597","waitMsMax":"3","startMs":"1570972523076","waitRatioMax":0.003289473684210526,"readRatioAvg":0.03070175438596491,"parallelInputs":"4","recordsRead":"7232730","computeRatioAvg":0.8651315789473685,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"789","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0043859649122807015,"readMsAvg":"28","waitRatioAvg":0.003289473684210526,"completedParallelInputs":"4","computeRatioMax":1,"name":"S0C: Join+","shuffleOutputBytes":"36","recordsWritten":"4","readRatioMax":0.03179824561403509,"steps":[{"kind":"READ","substeps":["$20:ws_sold_time_sk, $21:ws_ship_hdemo_sk, $22:ws_web_page_sk","FROM web_sales"]},{"kind":"READ","substeps":["$60","FROM __stage06_output"]},{"kind":"READ","substeps":["$30","FROM __stage05_output"]},{"kind":"READ","substeps":["$1","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["$110 := COUNT_STAR()"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $140 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $130 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $21 = $60"]},{"kind":"WRITE","substeps":["$110","TO __stage0C_output"]}],"writeRatioAvg":0.003289473684210526},{"readMsMax":"0","computeMsMax":"4","inputStages":["12"],"waitMsAvg":"6","id":"13","endMs":"1570972523610","waitMsMax":"6","startMs":"1570972523079","waitRatioMax":0.006578947368421052,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"4","computeRatioAvg":0.0043859649122807015,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005482456140350877,"readMsAvg":"0","waitRatioAvg":0.006578947368421052,"completedParallelInputs":"1","computeRatioMax":0.0043859649122807015,"name":"S0D: Aggregate","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["$90 := SUM_OF_COUNTS($110)"]},{"kind":"WRITE","substeps":["$90","TO __stage0D_output"]}],"writeRatioAvg":0.005482456140350877},{"readMsMax":"0","computeMsMax":"10","inputStages":["13","10"],"waitMsAvg":"13","id":"14","endMs":"1570972523833","waitMsMax":"13","startMs":"1570972523754","waitRatioMax":0.01425438596491228,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2","computeRatioAvg":0.010964912280701754,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006578947368421052,"readMsAvg":"0","waitRatioAvg":0.01425438596491228,"completedParallelInputs":"1","computeRatioMax":0.010964912280701754,"name":"S0E: Output","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$90","FROM __stage0D_output"]},{"kind":"READ","substeps":["$100","FROM __stage0A_output"]},{"kind":"SORT","substeps":["$80 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$80 := divide(CAST($180 AS DOUBLE), CAST($181 AS DOUBLE))"]},{"kind":"JOIN","substeps":["CROSS ALL WITH ALL "]},{"kind":"WRITE","substeps":["$190","TO __stage0E_output"]}],"writeRatioAvg":0.006578947368421052}],"estimatedBytesProcessed":"174282504","timeline":[{"totalSlotMs":"1499","activeUnits":"10","completedUnits":"6","elapsedMs":"738","pendingUnits":"10"},{"totalSlotMs":"9360","activeUnits":"10","completedUnits":"17","elapsedMs":"1617","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"175112192","totalPartitionsProcessed":"0","totalBytesProcessed":"174282504","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"time_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_page","datasetId":"scale_10"}]},"endTime":"1570972524004"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query90_1570972520"},"etag":"lzjmXbxiTQws6fH1QYK6QA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query90_1570972520?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon9d4da47aae1419ac315de053a86a3afcd35b44b3","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"\n-- query90\nSELECT amc / pmc AS am_pm_ratio \nFROM (SELECT Count(*) amc \n FROM web_sales, \n household_demographics, \n time_dim, \n web_page \n WHERE ws_sold_time_sk = time_dim.t_time_sk \n AND ws_ship_hdemo_sk = household_demographics.hd_demo_sk \n AND ws_web_page_sk = web_page.wp_web_page_sk \n AND time_dim.t_hour BETWEEN 12 AND 12 + 1 \n AND household_demographics.hd_dep_count = 8 \n AND web_page.wp_char_count BETWEEN 5000 AND 5200) at1, \n (SELECT Count(*) pmc \n FROM web_sales, \n household_demographics, \n time_dim, \n web_page \n WHERE ws_sold_time_sk = time_dim.t_time_sk \n AND ws_ship_hdemo_sk = household_demographics.hd_demo_sk \n AND ws_web_page_sk = web_page.wp_web_page_sk \n AND time_dim.t_hour BETWEEN 20 AND 20 + 1 \n AND household_demographics.hd_dep_count = 8 \n AND web_page.wp_char_count BETWEEN 5000 AND 5200) pt \nORDER BY am_pm_ratio\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query90_1570972520","user_email":"nithish.sankaranarayanan@ulb.be"}
