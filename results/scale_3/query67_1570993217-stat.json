{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"1357810","creationTime":"1570993218725","totalBytesProcessed":"10885763174","startTime":"1570993218929","query":{"totalSlotMs":"1357810","queryPlan":[{"readMsMax":"22","computeMsMax":"243","waitMsAvg":"1","id":"0","endMs":"1570993220000","waitMsMax":"1","startMs":"1570993219241","waitRatioMax":0.00017277125086385625,"readRatioAvg":0.0038009675190048375,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.04198341395991707,"writeMsAvg":"14","status":"COMPLETE","writeMsMax":"14","computeMsAvg":"243","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0024187975120939877,"readMsAvg":"22","waitRatioAvg":0.00017277125086385625,"completedParallelInputs":"1","computeRatioMax":0.04198341395991707,"name":"S00: Input","shuffleOutputBytes":"16525648","recordsWritten":"204000","readRatioMax":0.0038009675190048375,"steps":[{"kind":"READ","substeps":["$1:i_item_sk, $2:i_brand, $3:i_class, $4:i_category, $5:i_product_name","FROM item"]},{"kind":"WRITE","substeps":["$1, $2, $3, $4, $5","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.0024187975120939877},{"readMsMax":"54","computeMsMax":"10","waitMsAvg":"26","id":"1","endMs":"1570993219399","waitMsMax":"26","startMs":"1570993219284","waitRatioMax":0.004492052522460262,"readRatioAvg":0.009329647546648237,"parallelInputs":"1","recordsRead":"402","computeRatioAvg":0.0017277125086385626,"writeMsAvg":"38","status":"COMPLETE","writeMsMax":"38","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0065653075328265375,"readMsAvg":"54","waitRatioAvg":0.004492052522460262,"completedParallelInputs":"1","computeRatioMax":0.0017277125086385626,"name":"S01: Input","shuffleOutputBytes":"12060","recordsWritten":"402","readRatioMax":0.009329647546648237,"steps":[{"kind":"READ","substeps":["$10:s_store_sk, $11:s_store_id","FROM store"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.0065653075328265375},{"readMsMax":"16","computeMsMax":"9","waitMsAvg":"58","id":"2","endMs":"1570993219438","waitMsMax":"58","startMs":"1570993219331","waitRatioMax":0.010020732550103663,"readRatioAvg":0.0027643400138217,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0015549412577747063,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"28","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0048375950241879755,"readMsAvg":"16","waitRatioAvg":0.010020732550103663,"completedParallelInputs":"1","computeRatioMax":0.0015549412577747063,"name":"S02: Input","shuffleOutputBytes":"13140","recordsWritten":"365","readRatioMax":0.0027643400138217,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $32:d_year, $33:d_moy, $34:d_qoy, $31:d_month_seq","FROM date_dim","WHERE between($31, 1181, 1192)"]},{"kind":"WRITE","substeps":["$30, $32, $33, $34","TO __stage02_output","BY HASH($30)"]}],"writeRatioAvg":0.0048375950241879755},{"readMsMax":"276","computeMsMax":"3307","inputStages":["0","1","2"],"waitMsAvg":"3","id":"5","endMs":"1570993222729","waitMsMax":"5","startMs":"1570993220163","waitRatioMax":0.0008638562543192813,"readRatioAvg":0.0065653075328265375,"parallelInputs":"184","recordsRead":"319550051","computeRatioAvg":0.437456807187284,"writeMsAvg":"41","status":"COMPLETE","writeMsMax":"901","computeMsAvg":"2532","shuffleOutputBytesSpilled":"0","writeRatioMax":0.15566689702833447,"readMsAvg":"38","waitRatioAvg":0.0005183137525915688,"completedParallelInputs":"184","computeRatioMax":0.5713545266067727,"name":"S05: Join+","shuffleOutputBytes":"6766328916","recordsWritten":"52489622","readRatioMax":0.04768486523842433,"steps":[{"kind":"READ","substeps":["$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_store_sk, $23:ss_quantity, $24:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$30, $32, $33, $34","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage01_output"]},{"kind":"READ","substeps":["$1, $2, $3, $4, $5","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $110 := $108, $111 := $107, $112 := $106, $113 := $109, $114 := $103, $115 := $105, $116 := $104, $117 := $100","$60 := SUM($70)"]},{"kind":"COMPUTE","substeps":["$70 := coalesce(multiply($102, CAST($101 AS DOUBLE)), 0)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $90 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $81 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $30"]},{"kind":"WRITE","substeps":["$112, $111, $110, $113, $117, $114, $116, $115, $60","TO __stage05_output","BY HASH($110, $111, $112, $113, $114, $115, $116, $117)"]}],"writeRatioAvg":0.007083621285418107},{"readMsMax":"0","computeMsMax":"5185","inputStages":["5"],"waitMsAvg":"2","id":"6","endMs":"1570993224007","waitMsMax":"6","startMs":"1570993221331","waitRatioMax":0.0010366275051831375,"readRatioAvg":0,"parallelInputs":"5","recordsRead":"7918584","computeRatioAvg":0.795611610228058,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"64","computeMsAvg":"4605","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0110573600552868,"readMsAvg":"0","waitRatioAvg":0.0003455425017277125,"completedParallelInputs":"5","computeRatioMax":0.8958189357290947,"name":"S06: Repartition","shuffleOutputBytes":"1020763013","recordsWritten":"7918584","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage05_output"]}],"writeRatioAvg":0.0048375950241879755},{"readMsMax":"0","computeMsMax":"5270","inputStages":["6","5"],"waitMsAvg":"1","id":"7","endMs":"1570993224185","waitMsMax":"1","startMs":"1570993221346","waitRatioMax":0.00017277125086385625,"readRatioAvg":0,"parallelInputs":"6","recordsRead":"10032294","computeRatioAvg":0.8225639253628196,"writeMsAvg":"31","status":"COMPLETE","writeMsMax":"59","computeMsAvg":"4761","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01019350380096752,"readMsAvg":"0","waitRatioAvg":0.00017277125086385625,"completedParallelInputs":"6","computeRatioMax":0.9105044920525225,"name":"S07: Repartition","shuffleOutputBytes":"1293213006","recordsWritten":"10032294","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage06_output"]}],"writeRatioAvg":0.005355908776779544},{"readMsMax":"0","computeMsMax":"5788","inputStages":["7","5"],"waitMsAvg":"1","id":"8","endMs":"1570993225063","waitMsMax":"2","startMs":"1570993221370","waitRatioMax":0.0003455425017277125,"readRatioAvg":0,"parallelInputs":"5","recordsRead":"8968740","computeRatioAvg":0.909813407049067,"writeMsAvg":"155","status":"COMPLETE","writeMsMax":"625","computeMsAvg":"5266","shuffleOutputBytesSpilled":"0","writeRatioMax":0.10798203178991016,"readMsAvg":"0","waitRatioAvg":0.00017277125086385625,"completedParallelInputs":"5","computeRatioMax":1,"name":"S08: Repartition","shuffleOutputBytes":"1156155524","recordsWritten":"8968740","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage07_output"]}],"writeRatioAvg":0.02677954388389772},{"readMsMax":"0","computeMsMax":"5703","inputStages":["8","5"],"waitMsAvg":"1","id":"9","endMs":"1570993224454","waitMsMax":"1","startMs":"1570993221373","waitRatioMax":0.00017277125086385625,"readRatioAvg":0,"parallelInputs":"2","recordsRead":"3747536","computeRatioAvg":0.9452315134761575,"writeMsAvg":"90","status":"COMPLETE","writeMsMax":"129","computeMsAvg":"5471","shuffleOutputBytesSpilled":"0","writeRatioMax":0.022287491361437456,"readMsAvg":"0","waitRatioAvg":0.00017277125086385625,"completedParallelInputs":"2","computeRatioMax":0.9853144436765722,"name":"S09: Repartition","shuffleOutputBytes":"483092056","recordsWritten":"3747536","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage08_output"]}],"writeRatioAvg":0.015549412577747062},{"readMsMax":"0","computeMsMax":"2197","inputStages":["9","5"],"waitMsAvg":"6","id":"10","endMs":"1570993226660","waitMsMax":"13","startMs":"1570993225180","waitRatioMax":0.002246026261230131,"readRatioAvg":0,"parallelInputs":"180","recordsRead":"52489622","computeRatioAvg":0.2593296475466482,"writeMsAvg":"63","status":"COMPLETE","writeMsMax":"641","computeMsAvg":"1501","shuffleOutputBytesSpilled":"0","writeRatioMax":0.11074637180373186,"readMsAvg":"0","waitRatioAvg":0.0010366275051831375,"completedParallelInputs":"180","computeRatioMax":0.3795784381478922,"name":"S0A: Aggregate","shuffleOutputBytes":"5943608807","recordsWritten":"46096939","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$112, $111, $110, $113, $117, $114, $116, $115, $60","FROM __stage05_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $120 := $110, $121 := $111, $122 := $112, $123 := $113, $124 := $114, $125 := $115, $126 := $116, $127 := $117","$50 := SUM($60)"]},{"kind":"WRITE","substeps":["$122, $121, $120, $123, $127, $124, $126, $125, $50","TO __stage0A_output","BY HASH($120, $121, $122, $123)"]}],"writeRatioAvg":0.010884588804422944},{"readMsMax":"0","computeMsMax":"4915","inputStages":["10"],"waitMsAvg":"1","id":"11","endMs":"1570993230487","waitMsMax":"1","startMs":"1570993225823","waitRatioMax":0.00017277125086385625,"readRatioAvg":0,"parallelInputs":"6","recordsRead":"9375014","computeRatioAvg":0.7387698686938493,"writeMsAvg":"246","status":"COMPLETE","writeMsMax":"1348","computeMsAvg":"4276","shuffleOutputBytesSpilled":"0","writeRatioMax":0.23289564616447822,"readMsAvg":"0","waitRatioAvg":0.00017277125086385625,"completedParallelInputs":"6","computeRatioMax":0.8491706979958535,"name":"S0B: Repartition","shuffleOutputBytes":"1208930516","recordsWritten":"9375014","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0A_output"]}],"writeRatioAvg":0.04250172771250864},{"readMsMax":"0","computeMsMax":"4800","inputStages":["11","10"],"waitMsAvg":"1","id":"12","endMs":"1570993228761","waitMsMax":"1","startMs":"1570993225845","waitRatioMax":0.00017277125086385625,"readRatioAvg":0,"parallelInputs":"8","recordsRead":"13744451","computeRatioAvg":0.7696959225984796,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"40","computeMsAvg":"4455","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006910850034554251,"readMsAvg":"0","waitRatioAvg":0.00017277125086385625,"completedParallelInputs":"8","computeRatioMax":0.82930200414651,"name":"S0C: Repartition","shuffleOutputBytes":"1771857045","recordsWritten":"13744451","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0B_output"]}],"writeRatioAvg":0.0034554250172771253},{"readMsMax":"0","computeMsMax":"5713","inputStages":["12","10"],"waitMsAvg":"1","id":"13","endMs":"1570993229290","waitMsMax":"1","startMs":"1570993225900","waitRatioMax":0.00017277125086385625,"readRatioAvg":0,"parallelInputs":"4","recordsRead":"7678873","computeRatioAvg":0.8797512093987561,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"51","computeMsAvg":"5092","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008811333794056669,"readMsAvg":"0","waitRatioAvg":0.00017277125086385625,"completedParallelInputs":"4","computeRatioMax":0.9870421561852107,"name":"S0D: Repartition","shuffleOutputBytes":"990198033","recordsWritten":"7678873","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0C_output"]}],"writeRatioAvg":0.0046648237733241185},{"readMsMax":"0","computeMsMax":"2344","inputStages":["13","10"],"waitMsAvg":"26","id":"14","endMs":"1570993232049","waitMsMax":"39","startMs":"1570993230494","waitRatioMax":0.006738078783690394,"readRatioAvg":0,"parallelInputs":"180","recordsRead":"46096939","computeRatioAvg":0.2982031789910159,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"33","computeMsAvg":"1726","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005701451278507256,"readMsAvg":"0","waitRatioAvg":0.004492052522460262,"completedParallelInputs":"180","computeRatioMax":0.40497581202487903,"name":"S0E: Sort+","shuffleOutputBytes":"1969600","recordsWritten":"18000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$122, $121, $120, $123, $127, $124, $126, $125, $50","FROM __stage0A_output"]},{"kind":"SORT","substeps":["$142 ASC, $141 ASC, $140 ASC, $143 ASC, $145 ASC, $147 ASC, $146 ASC, $144 ASC, $148 ASC, $40 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["less_or_equal($40, 100)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$40 := RANK() OVER (PARTITION BY $132, $131, $130, $133 ORDER BY $138 DESC)"]},{"kind":"SORT","substeps":["$120 ASC, $121 ASC, $122 ASC, $123 ASC, $50 DESC"]},{"kind":"WRITE","substeps":["$150, $151, $152, $153, $154, $155, $156, $157, $158, $159","TO __stage0E_output"]}],"writeRatioAvg":0.000691085003455425},{"readMsMax":"0","computeMsMax":"19","inputStages":["14"],"waitMsAvg":"26","id":"15","endMs":"1570993232072","waitMsMax":"26","startMs":"1570993230534","waitRatioMax":0.004492052522460262,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"18000","computeRatioAvg":0.0032826537664132687,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0012093987560469939,"readMsAvg":"0","waitRatioAvg":0.004492052522460262,"completedParallelInputs":"1","computeRatioMax":0.0032826537664132687,"name":"S0F: Output","shuffleOutputBytes":"7000","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$150, $151, $152, $153, $154, $155, $156, $157, $158, $159","FROM __stage0E_output"]},{"kind":"SORT","substeps":["$152 ASC, $151 ASC, $150 ASC, $153 ASC, $155 ASC, $157 ASC, $156 ASC, $154 ASC, $159 ASC, $158 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$160, $161, $162, $163, $164, $165, $166, $167, $168, $169","TO __stage0F_output"]}],"writeRatioAvg":0.0012093987560469939}],"estimatedBytesProcessed":"10885763174","timeline":[{"totalSlotMs":"18148","activeUnits":"185","completedUnits":"2","elapsedMs":"814","pendingUnits":"185"},{"totalSlotMs":"175490","activeUnits":"184","completedUnits":"3","elapsedMs":"1480","pendingUnits":"184"},{"totalSlotMs":"633668","activeUnits":"66","completedUnits":"184","elapsedMs":"3276","pendingUnits":"21"},{"totalSlotMs":"689553","activeUnits":"18","completedUnits":"190","elapsedMs":"4816","pendingUnits":"15"},{"totalSlotMs":"708469","activeUnits":"7","completedUnits":"204","elapsedMs":"6028","pendingUnits":"1"},{"totalSlotMs":"971692","activeUnits":"181","completedUnits":"377","elapsedMs":"7344","pendingUnits":"26"},{"totalSlotMs":"987962","activeUnits":"18","completedUnits":"385","elapsedMs":"7857","pendingUnits":"18"},{"totalSlotMs":"1063683","activeUnits":"6","completedUnits":"402","elapsedMs":"10459","pendingUnits":"1"},{"totalSlotMs":"1352616","activeUnits":"181","completedUnits":"575","elapsedMs":"12772","pendingUnits":"9"},{"totalSlotMs":"1357810","activeUnits":"0","completedUnits":"584","elapsedMs":"13624","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"10886316032","totalPartitionsProcessed":"0","totalBytesProcessed":"10885763174","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_100"}]},"endTime":"1570993232852"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query67_1570993217"},"etag":"2kf4T4dz+D43x2Xhv9myow==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query67_1570993217?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon0541bc17b0cf5a8351057a5e6c8dab34700c5424","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query67\nwith dw1 as (\n select i_category\n ,i_class\n ,i_brand\n ,i_product_name\n ,d_year\n ,d_qoy\n ,d_moy\n ,s_store_id\n ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n from store_sales\n ,date_dim\n ,store\n ,item\n where ss_sold_date_sk=d_date_sk\n and ss_item_sk=i_item_sk\n and ss_store_sk = s_store_sk\n and d_month_seq between 1181 and 1181+11\n group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id\n), dw2 as (\n select i_category\n ,i_class\n ,i_brand\n ,i_product_name\n ,d_year\n ,d_qoy\n ,d_moy\n ,s_store_id\n ,sumsales\n ,rank() over (partition by i_category, i_class, i_brand, i_product_name order by sumsales desc) rk\n from dw1\n), dw3 as (\n select i_category\n ,i_class\n ,i_brand\n ,i_product_name\n ,d_year\n ,d_qoy\n ,d_moy\n ,s_store_id\n ,sumsales\n ,rank() over (partition by i_category order by sumsales desc) rk\n from dw2\n where rk <= 100\n)\nselect *\nfrom dw2\nwhere rk <= 100\norder by i_category\n ,i_class\n ,i_brand\n ,i_product_name\n ,d_year\n ,d_qoy\n ,d_moy\n ,s_store_id\n ,sumsales\n ,rk\nlimit 100\n;\n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query67_1570993217","user_email":"nithish.sankaranarayanan@ulb.be"}
