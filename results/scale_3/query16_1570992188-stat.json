{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"300572","creationTime":"1570992189984","totalBytesProcessed":"8164307619","startTime":"1570992190172","query":{"totalSlotMs":"300572","queryPlan":[{"readMsMax":"110","computeMsMax":"1591","waitMsAvg":"14","id":"0","endMs":"1570992192343","waitMsMax":"31","startMs":"1570992190504","waitRatioMax":0.01948460087994972,"readRatioAvg":0.05216844751728473,"parallelInputs":"6","recordsRead":"14398596","computeRatioAvg":0.8698931489629164,"writeMsAvg":"170","status":"COMPLETE","writeMsMax":"205","computeMsAvg":"1384","shuffleOutputBytesSpilled":"0","writeRatioMax":0.12884978001257072,"readMsAvg":"83","waitRatioAvg":0.008799497171590195,"completedParallelInputs":"6","computeRatioMax":1,"name":"S00: Input","shuffleOutputBytes":"129587364","recordsWritten":"14398596","readRatioMax":0.06913890634820867,"steps":[{"kind":"READ","substeps":["$1:cr_order_number","FROM catalog_returns"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.10685103708359522},{"readMsMax":"183","computeMsMax":"941","waitMsAvg":"392","id":"1","endMs":"1570992192149","waitMsMax":"469","startMs":"1570992190591","waitRatioMax":0.29478315524827153,"readRatioAvg":0.05091137649277184,"parallelInputs":"141","recordsRead":"144010451","computeRatioAvg":0.49465744814582024,"writeMsAvg":"76","status":"COMPLETE","writeMsMax":"313","computeMsAvg":"787","shuffleOutputBytesSpilled":"0","writeRatioMax":0.19673161533626649,"readMsAvg":"81","waitRatioAvg":0.24638592080452545,"completedParallelInputs":"141","computeRatioMax":0.5914519170333123,"name":"S01: Input","shuffleOutputBytes":"2586421622","recordsWritten":"144010451","readRatioMax":0.11502199874292897,"steps":[{"kind":"READ","substeps":["$10:cs_warehouse_sk, $11:cs_order_number","FROM catalog_sales"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage01_output","BY HASH($11)"]}],"writeRatioAvg":0.04776869893148963},{"readMsMax":"17","computeMsMax":"5","waitMsAvg":"8","id":"2","endMs":"1570992190831","waitMsMax":"8","startMs":"1570992190618","waitRatioMax":0.00502828409805154,"readRatioAvg":0.010685103708359522,"parallelInputs":"1","recordsRead":"30","computeRatioAvg":0.0031426775612822125,"writeMsAvg":"186","status":"COMPLETE","writeMsMax":"186","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.1169076052796983,"readMsAvg":"17","waitRatioAvg":0.00502828409805154,"completedParallelInputs":"1","computeRatioMax":0.0031426775612822125,"name":"S02: Input","shuffleOutputBytes":"27","recordsWritten":"3","readRatioMax":0.010685103708359522,"steps":[{"kind":"READ","substeps":["$20:cc_call_center_sk, $21:cc_county","FROM call_center","WHERE in($21, 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County')"]},{"kind":"WRITE","substeps":["$20","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.1169076052796983},{"readMsMax":"24","computeMsMax":"32","waitMsAvg":"14","id":"3","endMs":"1570992190828","waitMsMax":"14","startMs":"1570992190705","waitRatioMax":0.008799497171590195,"readRatioAvg":0.01508485229415462,"parallelInputs":"1","recordsRead":"1000000","computeRatioAvg":0.02011313639220616,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"26","computeMsAvg":"32","shuffleOutputBytesSpilled":"0","writeRatioMax":0.016341923318667503,"readMsAvg":"24","waitRatioAvg":0.008799497171590195,"completedParallelInputs":"1","computeRatioMax":0.02011313639220616,"name":"S03: Input","shuffleOutputBytes":"276516","recordsWritten":"30724","readRatioMax":0.01508485229415462,"steps":[{"kind":"READ","substeps":["$40:ca_address_sk, $41:ca_state","FROM customer_address","WHERE equal($41, 'IA')"]},{"kind":"WRITE","substeps":["$40","TO __stage03_output","BY HASH($40)"]}],"writeRatioAvg":0.016341923318667503},{"readMsMax":"16","computeMsMax":"19","waitMsAvg":"13","id":"4","endMs":"1570992190917","waitMsMax":"13","startMs":"1570992190734","waitRatioMax":0.008170961659333752,"readRatioAvg":0.01005656819610308,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.011942174732872407,"writeMsAvg":"152","status":"COMPLETE","writeMsMax":"152","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.09553739786297925,"readMsAvg":"16","waitRatioAvg":0.008170961659333752,"completedParallelInputs":"1","computeRatioMax":0.011942174732872407,"name":"S04: Input","shuffleOutputBytes":"558","recordsWritten":"62","readRatioMax":0.01005656819610308,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_date","FROM date_dim","WHERE between(CAST($51 AS DATE), 11747, 11808)"]},{"kind":"WRITE","substeps":["$50","TO __stage04_output","BY HASH($50)"]}],"writeRatioAvg":0.09553739786297925},{"readMsMax":"0","computeMsMax":"7","inputStages":["3"],"waitMsAvg":"109","id":"6","endMs":"1570992191263","waitMsMax":"119","startMs":"1570992191030","waitRatioMax":0.07479572595851666,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"30724","computeRatioAvg":0.00251414204902577,"writeMsAvg":"158","status":"COMPLETE","writeMsMax":"201","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.12633563796354494,"readMsAvg":"0","waitRatioAvg":0.06851037083595223,"completedParallelInputs":"100","computeRatioMax":0.0043997485857950975,"name":"S06: Coalesce","shuffleOutputBytes":"276516","recordsWritten":"30724","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage03_output"]}],"writeRatioAvg":0.09930861093651791},{"readMsMax":"347","computeMsMax":"749","inputStages":["2","6","4"],"waitMsAvg":"46","id":"7","endMs":"1570992192006","waitMsMax":"51","startMs":"1570992191048","waitRatioMax":0.03205531112507857,"readRatioAvg":0.13702074167190445,"parallelInputs":"141","recordsRead":"144357190","computeRatioAvg":0.31489629164047767,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"137","computeMsAvg":"501","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08610936517913262,"readMsAvg":"218","waitRatioAvg":0.028912633563796353,"completedParallelInputs":"141","computeRatioMax":0.47077309868007544,"name":"S07: Join","shuffleOutputBytes":"240764","recordsWritten":"6689","readRatioMax":0.21810182275298554,"steps":[{"kind":"READ","substeps":["$30:cs_ship_date_sk, $31:cs_ship_addr_sk, $32:cs_call_center_sk, $33:cs_warehouse_sk, $34:cs_order_number, $35:cs_ext_ship_cost, $36:cs_net_profit","FROM catalog_sales"]},{"kind":"READ","substeps":["$50","FROM __stage04_output"]},{"kind":"READ","substeps":["$40","FROM __stage06_output"]},{"kind":"READ","substeps":["$20","FROM __stage02_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $190 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $180 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $30 = $50"]},{"kind":"WRITE","substeps":["$200, $201, $202, $203","TO __stage07_output","BY HASH($201)"]}],"writeRatioAvg":0.00251414204902577},{"readMsMax":"0","computeMsMax":"1074","inputStages":["1","7"],"waitMsAvg":"3","id":"8","endMs":"1570992196268","waitMsMax":"7","startMs":"1570992195188","waitRatioMax":0.0043997485857950975,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"144017140","computeRatioAvg":0.5003142677561282,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"74","computeMsAvg":"796","shuffleOutputBytesSpilled":"0","writeRatioMax":0.046511627906976744,"readMsAvg":"0","waitRatioAvg":0.0018856065367693275,"completedParallelInputs":"100","computeRatioMax":0.6750471401634193,"name":"S08: Join","shuffleOutputBytes":"180487","recordsWritten":"6685","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$200, $201, $202, $203","FROM __stage07_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage01_output"]},{"kind":"JOIN","substeps":["SEMI HASH JOIN EACH WITH EACH ON $201 = $11"]},{"kind":"WRITE","substeps":["$211, $212, $213","TO __stage08_output","BY HASH($211)"]}],"writeRatioAvg":0.006285355122564425},{"readMsMax":"0","computeMsMax":"53","inputStages":["0","8"],"waitMsAvg":"1","id":"9","endMs":"1570992196493","waitMsMax":"4","startMs":"1570992196291","waitRatioMax":0.00251414204902577,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"14405281","computeRatioAvg":0.026398491514770583,"writeMsAvg":"37","status":"COMPLETE","writeMsMax":"141","computeMsAvg":"42","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08862350722815839,"readMsAvg":"0","waitRatioAvg":0.0006285355122564425,"completedParallelInputs":"100","computeRatioMax":0.03331238214959145,"name":"S09: Join+","shuffleOutputBytes":"18060","recordsWritten":"863","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$211, $212, $213","FROM __stage08_output"]},{"kind":"READ","substeps":["$1","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $170, $231 := $150","$140 := SUM($152)","$141 := SUM($151)"]},{"kind":"COMPUTE","substeps":["$150 := if(equal($170, 1), $220, NULL)","$151 := if(equal($170, 0), $222, NULL)","$152 := if(equal($170, 0), $221, NULL)"]},{"kind":"COMPUTE","substeps":["$160 := ARRAY<...>"]},{"kind":"JOIN","substeps":["ANTI HASH JOIN EACH WITH EACH ON $211 = $1"]},{"kind":"WRITE","substeps":["$140, $141, $231, $230","TO __stage09_output","BY HASH($230, $231)"]}],"writeRatioAvg":0.023255813953488372},{"readMsMax":"0","computeMsMax":"9","inputStages":["9"],"waitMsAvg":"0","id":"10","endMs":"1570992196644","waitMsMax":"1","startMs":"1570992196561","waitRatioMax":0.0006285355122564425,"readRatioAvg":0,"parallelInputs":"28","recordsRead":"863","computeRatioAvg":0.0043997485857950975,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"37","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.023255813953488372,"readMsAvg":"0","waitRatioAvg":0,"completedParallelInputs":"28","computeRatioMax":0.0056568196103079825,"name":"S0A: Aggregate+","shuffleOutputBytes":"596","recordsWritten":"29","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$140, $141, $231, $230","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $250 := $240","$110 := COUNT($122)","$111 := ANY_VALUE($121)","$112 := ANY_VALUE($120)"]},{"kind":"COMPUTE","substeps":["$120 := if(equal($240, 0), $131, NULL)","$121 := if(equal($240, 0), $130, NULL)","$122 := if(equal($240, 1), $241, NULL)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230, $241 := $231","$130 := SUM($140)","$131 := SUM($141)"]},{"kind":"WRITE","substeps":["$110, $111, $112, $250","TO __stage0A_output","BY HASH($250)"]}],"writeRatioAvg":0.01257071024512885},{"readMsMax":"0","computeMsMax":"5","inputStages":["10"],"waitMsAvg":"1","id":"11","endMs":"1570992196746","waitMsMax":"1","startMs":"1570992196666","waitRatioMax":0.0006285355122564425,"readRatioAvg":0,"parallelInputs":"2","recordsRead":"29","computeRatioAvg":0.0031426775612822125,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010685103708359522,"readMsAvg":"0","waitRatioAvg":0.0006285355122564425,"completedParallelInputs":"2","computeRatioMax":0.0031426775612822125,"name":"S0B: Aggregate+","shuffleOutputBytes":"30","recordsWritten":"2","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110, $111, $112, $250","FROM __stage0A_output"]},{"kind":"AGGREGATE","substeps":["$80 := ANY_VALUE($92)","$81 := ANY_VALUE($91)","$82 := ANY_VALUE($90)"]},{"kind":"COMPUTE","substeps":["$90 := if(equal($260, 0), $102, NULL)","$91 := if(equal($260, 0), $101, NULL)","$92 := if(equal($260, 1), $100, NULL)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $260 := $250","$100 := SUM_OF_COUNTS($110)","$101 := ANY_VALUE($111)","$102 := ANY_VALUE($112)"]},{"kind":"WRITE","substeps":["$80, $81, $82","TO __stage0B_output"]}],"writeRatioAvg":0.01005656819610308},{"readMsMax":"0","computeMsMax":"6","inputStages":["11"],"waitMsAvg":"2","id":"12","endMs":"1570992196773","waitMsMax":"2","startMs":"1570992196684","waitRatioMax":0.001257071024512885,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2","computeRatioAvg":0.003771213073538655,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00502828409805154,"readMsAvg":"0","waitRatioAvg":0.001257071024512885,"completedParallelInputs":"1","computeRatioMax":0.003771213073538655,"name":"S0C: Output","shuffleOutputBytes":"27","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$80, $81, $82","FROM __stage0B_output"]},{"kind":"SORT","substeps":["$60 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$60 := if(is_null($70), 0, $70)"]},{"kind":"AGGREGATE","substeps":["$70 := ANY_VALUE($80)","$71 := ANY_VALUE($81)","$72 := ANY_VALUE($82)"]},{"kind":"WRITE","substeps":["$270, $271, $272","TO __stage0C_output"]}],"writeRatioAvg":0.00502828409805154}],"estimatedBytesProcessed":"8164307619","timeline":[{"totalSlotMs":"6304","activeUnits":"32","completedUnits":"3","elapsedMs":"835","pendingUnits":"388"},{"totalSlotMs":"206319","activeUnits":"187","completedUnits":"389","elapsedMs":"1861","pendingUnits":"2"},{"totalSlotMs":"208463","activeUnits":"0","completedUnits":"391","elapsedMs":"2480","pendingUnits":"0"},{"totalSlotMs":"286612","activeUnits":"47","completedUnits":"490","elapsedMs":"6020","pendingUnits":"1"},{"totalSlotMs":"300572","activeUnits":"1","completedUnits":"622","elapsedMs":"6762","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"8165261312","totalPartitionsProcessed":"0","totalBytesProcessed":"8164307619","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"call_center","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_100"}]},"endTime":"1570992196974"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query16_1570992188"},"etag":"Uht19xu5AMGry4Jy84YM5A==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query16_1570992188?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonaca10001a4306430409944ac589e1aec093f2071","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query16\nSELECT\n Count(DISTINCT cs_order_number) AS order_count ,\n Sum(cs_ext_ship_cost) AS total_shipping_cost ,\n Sum(cs_net_profit) AS total_net_profit\nFROM catalog_sales cs1 ,\n date_dim ,\n customer_address ,\n call_center\nWHERE Cast(d_date AS DATE) BETWEEN Cast('2002-3-01' AS DATE) AND (\n Cast('2002-5-01' AS DATE))\nAND cs1.cs_ship_date_sk = d_date_sk\nAND cs1.cs_ship_addr_sk = ca_address_sk\nAND ca_state = 'IA'\nAND cs1.cs_call_center_sk = cc_call_center_sk\nAND cc_county IN ('Williamson County',\n 'Williamson County',\n 'Williamson County',\n 'Williamson County',\n 'Williamson County' )\nAND EXISTS\n (\n SELECT *\n FROM catalog_sales cs2\n WHERE cs1.cs_order_number = cs2.cs_order_number\n AND cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\nAND NOT EXISTS\n (\n SELECT *\n FROM catalog_returns cr1\n WHERE cs1.cs_order_number = cr1.cr_order_number)\nORDER BY count(DISTINCT cs_order_number)\nLIMIT 100;\n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query16_1570992188","user_email":"nithish.sankaranarayanan@ulb.be"}
