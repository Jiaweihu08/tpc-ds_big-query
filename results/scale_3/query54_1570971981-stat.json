{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"286489","creationTime":"1570971982886","totalBytesProcessed":"1197126574","startTime":"1570971983081","query":{"totalSlotMs":"286489","queryPlan":[{"readMsMax":"17","computeMsMax":"412","waitMsAvg":"2","id":"0","endMs":"1570971986977","waitMsMax":"2","startMs":"1570971984722","waitRatioMax":0.0012738853503184713,"readRatioAvg":0.010828025477707006,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.2624203821656051,"writeMsAvg":"654","status":"COMPLETE","writeMsMax":"654","computeMsAvg":"412","shuffleOutputBytesSpilled":"0","writeRatioMax":0.41656050955414015,"readMsAvg":"17","waitRatioAvg":0.0012738853503184713,"completedParallelInputs":"1","computeRatioMax":0.2624203821656051,"name":"S00: Input","shuffleOutputBytes":"9000000","recordsWritten":"500000","readRatioMax":0.010828025477707006,"steps":[{"kind":"READ","substeps":["$50:c_customer_sk, $51:c_current_addr_sk","FROM customer"]},{"kind":"WRITE","substeps":["$50, $51","TO __stage00_output","BY HASH($50)"]}],"writeRatioAvg":0.41656050955414015},{"readMsMax":"10","computeMsMax":"10","waitMsAvg":"1","id":"1","endMs":"1570971986190","waitMsMax":"1","startMs":"1570971984854","waitRatioMax":0.0006369426751592356,"readRatioAvg":0.006369426751592357,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.006369426751592357,"writeMsAvg":"587","status":"COMPLETE","writeMsMax":"587","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.3738853503184713,"readMsAvg":"10","waitRatioAvg":0.0006369426751592356,"completedParallelInputs":"1","computeRatioMax":0.006369426751592357,"name":"S01: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.006369426751592357,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_year, $72:d_moy","FROM date_dim","WHERE and(equal($72, 5), equal($71, 2000))"]},{"kind":"WRITE","substeps":["$70","TO __stage01_output","BY HASH($70)"]}],"writeRatioAvg":0.3738853503184713},{"readMsMax":"12","computeMsMax":"16","waitMsAvg":"2","id":"2","endMs":"1570971986264","waitMsMax":"2","startMs":"1570971984961","waitRatioMax":0.0012738853503184713,"readRatioAvg":0.007643312101910828,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.01019108280254777,"writeMsAvg":"745","status":"COMPLETE","writeMsMax":"745","computeMsAvg":"16","shuffleOutputBytesSpilled":"0","writeRatioMax":0.4745222929936306,"readMsAvg":"12","waitRatioAvg":0.0012738853503184713,"completedParallelInputs":"1","computeRatioMax":0.01019108280254777,"name":"S02: Input","shuffleOutputBytes":"6057","recordsWritten":"673","readRatioMax":0.007643312101910828,"steps":[{"kind":"READ","substeps":["$100:i_item_sk, $101:i_class, $102:i_category","FROM item","WHERE and(equal($102, 'Sports'), equal($101, 'fitness'))"]},{"kind":"WRITE","substeps":["$100","TO __stage02_output","BY HASH($100)"]}],"writeRatioAvg":0.4745222929936306},{"readMsMax":"7","computeMsMax":"12","waitMsAvg":"10","id":"4","endMs":"1570971985954","waitMsMax":"10","startMs":"1570971985176","waitRatioMax":0.006369426751592357,"readRatioAvg":0.0044585987261146496,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.007643312101910828,"writeMsAvg":"251","status":"COMPLETE","writeMsMax":"251","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.15987261146496815,"readMsAvg":"7","waitRatioAvg":0.006369426751592357,"completedParallelInputs":"1","computeRatioMax":0.007643312101910828,"name":"S04: Input","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.0044585987261146496,"steps":[{"kind":"READ","substeps":["$60:d_month_seq, $61:d_year, $62:d_moy","FROM date_dim","WHERE and(equal($61, 2000), equal($62, 5))"]},{"kind":"AGGREGATE","substeps":["GROUP BY $260 := $200"]},{"kind":"COMPUTE","substeps":["$200 := add($60, 3)"]},{"kind":"WRITE","substeps":["$260","TO __stage04_output","BY HASH($260)"]}],"writeRatioAvg":0.15987261146496815},{"readMsMax":"10","computeMsMax":"7","waitMsAvg":"2","id":"5","endMs":"1570971986915","waitMsMax":"2","startMs":"1570971985319","waitRatioMax":0.0012738853503184713,"readRatioAvg":0.006369426751592357,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0044585987261146496,"writeMsAvg":"1570","status":"COMPLETE","writeMsMax":"1570","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":1,"readMsAvg":"10","waitRatioAvg":0.0012738853503184713,"completedParallelInputs":"1","computeRatioMax":0.0044585987261146496,"name":"S05: Input","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.006369426751592357,"steps":[{"kind":"READ","substeps":["$40:d_month_seq, $41:d_year, $42:d_moy","FROM date_dim","WHERE and(equal($41, 2000), equal($42, 5))"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $190"]},{"kind":"COMPUTE","substeps":["$190 := add($40, 1)"]},{"kind":"WRITE","substeps":["$230","TO __stage05_output","BY HASH($230)"]}],"writeRatioAvg":1},{"readMsMax":"0","computeMsMax":"4","inputStages":["4"],"waitMsAvg":"2","id":"6","endMs":"1570971987635","waitMsMax":"2","startMs":"1570971986076","waitRatioMax":0.0012738853503184713,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.0025477707006369425,"writeMsAvg":"1537","status":"COMPLETE","writeMsMax":"1537","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.9789808917197452,"readMsAvg":"0","waitRatioAvg":0.0012738853503184713,"completedParallelInputs":"1","computeRatioMax":0.0025477707006369425,"name":"S06: Aggregate+","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$260","FROM __stage04_output"]},{"kind":"LIMIT","substeps":["2"]},{"kind":"AGGREGATE","substeps":["GROUP BY $270 := $260"]},{"kind":"WRITE","substeps":["$270","TO __stage06_output"]}],"writeRatioAvg":0.9789808917197452},{"readMsMax":"0","computeMsMax":"4","inputStages":["6"],"waitMsAvg":"3","id":"7","endMs":"1570971987707","waitMsMax":"3","startMs":"1570971986077","waitRatioMax":0.001910828025477707,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.0025477707006369425,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0025477707006369425,"readMsAvg":"0","waitRatioAvg":0.001910828025477707,"completedParallelInputs":"1","computeRatioMax":0.0025477707006369425,"name":"S07: Aggregate","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$270","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["$180 := ANY_AND_CHECK($270)"]},{"kind":"WRITE","substeps":["$180","TO __stage07_output"]}],"writeRatioAvg":0.0025477707006369425},{"readMsMax":"0","computeMsMax":"7","inputStages":["5"],"waitMsAvg":"1","id":"9","endMs":"1570971988316","waitMsMax":"1","startMs":"1570971986960","waitRatioMax":0.0006369426751592356,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.0044585987261146496,"writeMsAvg":"738","status":"COMPLETE","writeMsMax":"738","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.47006369426751593,"readMsAvg":"0","waitRatioAvg":0.0006369426751592356,"completedParallelInputs":"1","computeRatioMax":0.0044585987261146496,"name":"S09: Aggregate+","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$230","FROM __stage05_output"]},{"kind":"LIMIT","substeps":["2"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230"]},{"kind":"WRITE","substeps":["$240","TO __stage09_output"]}],"writeRatioAvg":0.47006369426751593},{"readMsMax":"0","computeMsMax":"5","inputStages":["9"],"waitMsAvg":"2","id":"10","endMs":"1570971988460","waitMsMax":"2","startMs":"1570971986962","waitRatioMax":0.0012738853503184713,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.0031847133757961785,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0031847133757961785,"readMsAvg":"0","waitRatioAvg":0.0012738853503184713,"completedParallelInputs":"1","computeRatioMax":0.0031847133757961785,"name":"S0A: Aggregate","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$240","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["$170 := ANY_AND_CHECK($240)"]},{"kind":"WRITE","substeps":["$170","TO __stage0A_output"]}],"writeRatioAvg":0.0031847133757961785},{"readMsMax":"127","computeMsMax":"1192","inputStages":["0","1","2"],"waitMsAvg":"2","id":"11","endMs":"1570971990125","waitMsMax":"2","startMs":"1570971987690","waitRatioMax":0.0012738853503184713,"readRatioAvg":0.022929936305732482,"parallelInputs":"12","recordsRead":"27606801","computeRatioAvg":0.6636942675159235,"writeMsAvg":"552","status":"COMPLETE","writeMsMax":"1034","computeMsAvg":"1042","shuffleOutputBytesSpilled":"0","writeRatioMax":0.6585987261146496,"readMsAvg":"36","waitRatioAvg":0.0012738853503184713,"completedParallelInputs":"12","computeRatioMax":0.759235668789809,"name":"S0B: Join+","shuffleOutputBytes":"23346","recordsWritten":"1297","readRatioMax":0.08089171974522293,"steps":[{"kind":"READ","substeps":["$80:cs_sold_date_sk, $81:cs_bill_customer_sk, $82:cs_item_sk","FROM catalog_sales"]},{"kind":"READ","substeps":["$90:ws_sold_date_sk, $91:ws_item_sk, $92:ws_bill_customer_sk","FROM web_sales"]},{"kind":"READ","substeps":["$100","FROM __stage02_output"]},{"kind":"READ","substeps":["$70","FROM __stage01_output"]},{"kind":"READ","substeps":["$50, $51","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $320 := $310, $321 := $311"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $300 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $290 = $70"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $212 = $100"]},{"kind":"WRITE","substeps":["$320, $321","TO __stage0B_output","BY HASH($320, $321)"]}],"writeRatioAvg":0.35159235668789807},{"readMsMax":"12","computeMsMax":"21","waitMsAvg":"17","id":"12","endMs":"1570971992002","waitMsMax":"17","startMs":"1570971990378","waitRatioMax":0.010828025477707006,"readRatioAvg":0.007643312101910828,"parallelInputs":"1","recordsRead":"73051","computeRatioAvg":0.01337579617834395,"writeMsAvg":"1358","status":"COMPLETE","writeMsMax":"1358","computeMsAvg":"21","shuffleOutputBytesSpilled":"0","writeRatioMax":0.8649681528662421,"readMsAvg":"12","waitRatioAvg":0.010828025477707006,"completedParallelInputs":"1","computeRatioMax":0.01337579617834395,"name":"S0C: Input","shuffleOutputBytes":"828","recordsWritten":"92","readRatioMax":0.007643312101910828,"steps":[{"kind":"READ","substeps":["$180","FROM __stage07_output"]},{"kind":"READ","substeps":["$170","FROM __stage0A_output"]},{"kind":"READ","substeps":["$10:d_date_sk, $11:d_month_seq","FROM date_dim"]},{"kind":"FILTER","substeps":["between($11, $170, $180)"]},{"kind":"WRITE","substeps":["$10","TO __stage0C_output","BY HASH($10)"]}],"writeRatioAvg":0.8649681528662421},{"readMsMax":"18","computeMsMax":"10","waitMsAvg":"12","id":"13","endMs":"1570971991308","waitMsMax":"12","startMs":"1570971990511","waitRatioMax":0.007643312101910828,"readRatioAvg":0.011464968152866241,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.006369426751592357,"writeMsAvg":"218","status":"COMPLETE","writeMsMax":"218","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.13885350318471337,"readMsAvg":"18","waitRatioAvg":0.007643312101910828,"completedParallelInputs":"1","computeRatioMax":0.006369426751592357,"name":"S0D: Input","shuffleOutputBytes":"2715","recordsWritten":"102","readRatioMax":0.011464968152866241,"steps":[{"kind":"READ","substeps":["$1:s_county, $2:s_state","FROM store"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage0D_output","BY HASH($1, $2)"]}],"writeRatioAvg":0.13885350318471337},{"readMsMax":"23","computeMsMax":"284","waitMsAvg":"31","id":"14","endMs":"1570971992946","waitMsMax":"31","startMs":"1570971990655","waitRatioMax":0.019745222929936305,"readRatioAvg":0.01464968152866242,"parallelInputs":"1","recordsRead":"250000","computeRatioAvg":0.18089171974522292,"writeMsAvg":"661","status":"COMPLETE","writeMsMax":"661","computeMsAvg":"284","shuffleOutputBytesSpilled":"0","writeRatioMax":0.4210191082802548,"readMsAvg":"23","waitRatioAvg":0.019745222929936305,"completedParallelInputs":"1","computeRatioMax":0.18089171974522292,"name":"S0E: Input","shuffleOutputBytes":"8559762","recordsWritten":"250000","readRatioMax":0.01464968152866242,"steps":[{"kind":"READ","substeps":["$20:ca_address_sk, $21:ca_county, $22:ca_state","FROM customer_address"]},{"kind":"WRITE","substeps":["$20, $21, $22","TO __stage0E_output","BY HASH($20)"]}],"writeRatioAvg":0.4210191082802548},{"readMsMax":"0","computeMsMax":"9","inputStages":["11"],"waitMsAvg":"37","id":"16","endMs":"1570971991815","waitMsMax":"37","startMs":"1570971990929","waitRatioMax":0.02356687898089172,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1297","computeRatioAvg":0.005732484076433121,"writeMsAvg":"674","status":"COMPLETE","writeMsMax":"674","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.42929936305732486,"readMsAvg":"0","waitRatioAvg":0.02356687898089172,"completedParallelInputs":"1","computeRatioMax":0.005732484076433121,"name":"S10: Aggregate","shuffleOutputBytes":"23076","recordsWritten":"1282","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$320, $321","FROM __stage0B_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $330 := $320, $331 := $321"]},{"kind":"WRITE","substeps":["$330, $331","TO __stage10_output","BY HASH($330)"]}],"writeRatioAvg":0.42929936305732486},{"readMsMax":"0","computeMsMax":"12","inputStages":["16"],"waitMsAvg":"37","id":"17","endMs":"1570971993372","waitMsMax":"43","startMs":"1570971991855","waitRatioMax":0.027388535031847135,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1282","computeRatioAvg":0.003821656050955414,"writeMsAvg":"831","status":"COMPLETE","writeMsMax":"1475","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.9394904458598726,"readMsAvg":"0","waitRatioAvg":0.02356687898089172,"completedParallelInputs":"100","computeRatioMax":0.007643312101910828,"name":"S11: Coalesce","shuffleOutputBytes":"23076","recordsWritten":"1282","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage10_output"]}],"writeRatioAvg":0.5292993630573248},{"readMsMax":"0","computeMsMax":"10","inputStages":["12"],"waitMsAvg":"128","id":"19","endMs":"1570971994720","waitMsMax":"146","startMs":"1570971993353","waitRatioMax":0.0929936305732484,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"92","computeRatioAvg":0.0031847133757961785,"writeMsAvg":"499","status":"COMPLETE","writeMsMax":"706","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.4496815286624204,"readMsAvg":"0","waitRatioAvg":0.08152866242038216,"completedParallelInputs":"100","computeRatioMax":0.006369426751592357,"name":"S13: Coalesce","shuffleOutputBytes":"828","recordsWritten":"92","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0C_output"]}],"writeRatioAvg":0.3178343949044586},{"readMsMax":"65","computeMsMax":"1146","inputStages":["10","7","19","13","14","17"],"waitMsAvg":"86","id":"20","endMs":"1570971995253","waitMsMax":"89","startMs":"1570971993472","waitRatioMax":0.056687898089171976,"readRatioAvg":0.02356687898089172,"parallelInputs":"10","recordsRead":"31316892","computeRatioAvg":0.6312101910828025,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"51","computeMsAvg":"991","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03248407643312102,"readMsAvg":"37","waitRatioAvg":0.05477707006369427,"completedParallelInputs":"10","computeRatioMax":0.729936305732484,"name":"S14: Join+","shuffleOutputBytes":"0","recordsWritten":"0","readRatioMax":0.041401273885350316,"steps":[{"kind":"READ","substeps":["$170","FROM __stage0A_output"]},{"kind":"READ","substeps":["$180","FROM __stage07_output"]},{"kind":"READ","substeps":["$30:ss_sold_date_sk, $31:ss_customer_sk, $32:ss_ext_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$330, $331","FROM __stage11_output"]},{"kind":"READ","substeps":["$20, $21, $22","FROM __stage0E_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage0D_output"]},{"kind":"READ","substeps":["$10","FROM __stage13_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $380 := $371","$160 := SUM($370)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $360 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $353 = $1, $354 = $2"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $341 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $31 = $330"]},{"kind":"WRITE","substeps":["$380, $160","TO __stage14_output","BY HASH($380)"]}],"writeRatioAvg":0.015286624203821656},{"readMsMax":"0","computeMsMax":"7","inputStages":["20"],"waitMsAvg":"5","id":"21","endMs":"1570971996846","waitMsMax":"5","startMs":"1570971995524","waitRatioMax":0.0031847133757961785,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"0","computeRatioAvg":0.0044585987261146496,"writeMsAvg":"620","status":"COMPLETE","writeMsMax":"620","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.39490445859872614,"readMsAvg":"0","waitRatioAvg":0.0031847133757961785,"completedParallelInputs":"1","computeRatioMax":0.0044585987261146496,"name":"S15: Aggregate+","shuffleOutputBytes":"0","recordsWritten":"0","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$380, $160","FROM __stage14_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $400 := $140","$130 := COUNT_STAR()"]},{"kind":"COMPUTE","substeps":["$140 := floor(divide($150, 50))"]},{"kind":"AGGREGATE","substeps":["GROUP BY $390 := $380","$150 := SUM($160)"]},{"kind":"WRITE","substeps":["$130, $400","TO __stage15_output","BY HASH($400)"]}],"writeRatioAvg":0.39490445859872614},{"readMsMax":"0","computeMsMax":"3","inputStages":["21"],"waitMsAvg":"5","id":"22","endMs":"1570971997528","waitMsMax":"5","startMs":"1570971996952","waitRatioMax":0.0031847133757961785,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"0","computeRatioAvg":0.001910828025477707,"writeMsAvg":"567","status":"COMPLETE","writeMsMax":"567","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.3611464968152866,"readMsAvg":"0","waitRatioAvg":0.0031847133757961785,"completedParallelInputs":"1","computeRatioMax":0.001910828025477707,"name":"S16: Sort+","shuffleOutputBytes":"0","recordsWritten":"0","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$130, $400","FROM __stage15_output"]},{"kind":"COMPUTE","substeps":["$110 := multiply($421, 50)"]},{"kind":"SORT","substeps":["$410 ASC, $120 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $410 := $400","$120 := SUM_OF_COUNTS($130)"]},{"kind":"WRITE","substeps":["$110, $420, $421","TO __stage16_output"]}],"writeRatioAvg":0.3611464968152866},{"readMsMax":"0","computeMsMax":"3","inputStages":["22"],"waitMsAvg":"3","id":"23","endMs":"1570971997717","waitMsMax":"3","startMs":"1570971997066","waitRatioMax":0.001910828025477707,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"0","computeRatioAvg":0.001910828025477707,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0025477707006369425,"readMsAvg":"0","waitRatioAvg":0.001910828025477707,"completedParallelInputs":"1","computeRatioMax":0.001910828025477707,"name":"S17: Output","shuffleOutputBytes":"0","recordsWritten":"0","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110, $420, $421","FROM __stage16_output"]},{"kind":"SORT","substeps":["$421 ASC, $420 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$430, $431, $432","TO __stage17_output"]}],"writeRatioAvg":0.0025477707006369425}],"estimatedBytesProcessed":"1197126574","timeline":[{"totalSlotMs":"1209","activeUnits":"16","completedUnits":"0","elapsedMs":"2143","pendingUnits":"17"},{"totalSlotMs":"21912","activeUnits":"17","completedUnits":"3","elapsedMs":"3375","pendingUnits":"16"},{"totalSlotMs":"40350","activeUnits":"16","completedUnits":"7","elapsedMs":"4941","pendingUnits":"14"},{"totalSlotMs":"61106","activeUnits":"11","completedUnits":"19","elapsedMs":"6360","pendingUnits":"2"},{"totalSlotMs":"65451","activeUnits":"13","completedUnits":"21","elapsedMs":"7798","pendingUnits":"14"},{"totalSlotMs":"95952","activeUnits":"111","completedUnits":"24","elapsedMs":"9236","pendingUnits":"111"},{"totalSlotMs":"213563","activeUnits":"110","completedUnits":"125","elapsedMs":"10713","pendingUnits":"110"},{"totalSlotMs":"281124","activeUnits":"42","completedUnits":"228","elapsedMs":"11976","pendingUnits":"7"},{"totalSlotMs":"284489","activeUnits":"1","completedUnits":"235","elapsedMs":"12499","pendingUnits":"1"},{"totalSlotMs":"286489","activeUnits":"2","completedUnits":"238","elapsedMs":"14911","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"1197473792","totalPartitionsProcessed":"0","totalBytesProcessed":"1197126574","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570971998021"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query54_1570971981"},"etag":"ssLfe5oNUHe/JtqYHMHw/Q==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query54_1570971981?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anond14b5d3cb880d4e0e49de52833bf53198e5e93e7","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query54\nWITH my_customers \n AS (SELECT DISTINCT c_customer_sk, \n c_current_addr_sk \n FROM (SELECT cs_sold_date_sk sold_date_sk, \n cs_bill_customer_sk customer_sk, \n cs_item_sk item_sk \n FROM catalog_sales \n UNION ALL \n SELECT ws_sold_date_sk sold_date_sk, \n ws_bill_customer_sk customer_sk, \n ws_item_sk item_sk \n FROM web_sales) cs_or_ws_sales, \n item, \n date_dim, \n customer \n WHERE sold_date_sk = d_date_sk \n AND item_sk = i_item_sk \n AND i_category = 'Sports' \n AND i_class = 'fitness' \n AND c_customer_sk = cs_or_ws_sales.customer_sk \n AND d_moy = 5 \n AND d_year = 2000), \n my_revenue \n AS (SELECT c_customer_sk, \n Sum(ss_ext_sales_price) AS revenue \n FROM my_customers, \n store_sales, \n customer_address, \n store, \n date_dim \n WHERE c_current_addr_sk = ca_address_sk \n AND ca_county = s_county \n AND ca_state = s_state \n AND ss_sold_date_sk = d_date_sk \n AND c_customer_sk = ss_customer_sk \n AND d_month_seq BETWEEN (SELECT DISTINCT d_month_seq + 1 \n FROM date_dim \n WHERE d_year = 2000 \n AND d_moy = 5) AND \n (SELECT DISTINCT \n d_month_seq + 3 \n FROM date_dim \n WHERE d_year = 2000 \n AND d_moy = 5) \n GROUP BY c_customer_sk), \n segments \n AS (SELECT Floor(revenue / 50) AS segment \n FROM my_revenue) \nSELECT segment, \n Count(*) AS num_customers, \n segment benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results warmup 50 AS segment_base \nFROM segments \nGROUP BY segment \nORDER BY segment, \n num_customers\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query54_1570971981","user_email":"nithish.sankaranarayanan@ulb.be"}
