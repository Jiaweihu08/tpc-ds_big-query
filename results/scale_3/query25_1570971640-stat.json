{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"716640","creationTime":"1570971641846","totalBytesProcessed":"1928125382","startTime":"1570971642094","query":{"totalSlotMs":"716640","queryPlan":[{"readMsMax":"36","computeMsMax":"374","waitMsAvg":"1","id":"0","endMs":"1570971644212","waitMsMax":"1","startMs":"1570971642310","waitRatioMax":0.00010894432944765226,"readRatioAvg":0.003921995860115481,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.04074517921342194,"writeMsAvg":"1095","status":"COMPLETE","writeMsMax":"1095","computeMsAvg":"374","shuffleOutputBytesSpilled":"0","writeRatioMax":0.11929404074517921,"readMsAvg":"36","waitRatioAvg":0.00010894432944765226,"completedParallelInputs":"1","computeRatioMax":0.04074517921342194,"name":"S00: Input","shuffleOutputBytes":"13796356","recordsWritten":"102000","readRatioMax":0.003921995860115481,"steps":[{"kind":"READ","substeps":["$1:i_item_sk, $2:i_item_id, $3:i_item_desc","FROM item"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.11929404074517921},{"readMsMax":"16","computeMsMax":"9","waitMsAvg":"4","id":"1","endMs":"1570971642929","waitMsMax":"4","startMs":"1570971642423","waitRatioMax":0.000435777317790609,"readRatioAvg":0.001743109271162436,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.0009804989650288702,"writeMsAvg":"304","status":"COMPLETE","writeMsMax":"304","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.033119076152086285,"readMsAvg":"16","waitRatioAvg":0.000435777317790609,"completedParallelInputs":"1","computeRatioMax":0.0009804989650288702,"name":"S01: Input","shuffleOutputBytes":"3964","recordsWritten":"102","readRatioMax":0.001743109271162436,"steps":[{"kind":"READ","substeps":["$10:s_store_sk, $11:s_store_id, $12:s_store_name","FROM store"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.033119076152086285},{"readMsMax":"12","computeMsMax":"10","waitMsAvg":"1","id":"2","endMs":"1570971643008","waitMsMax":"1","startMs":"1570971642592","waitRatioMax":0.00010894432944765226,"readRatioAvg":0.001307331953371827,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0010894432944765224,"writeMsAvg":"182","status":"COMPLETE","writeMsMax":"182","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01982786795947271,"readMsAvg":"12","waitRatioAvg":0.00010894432944765226,"completedParallelInputs":"1","computeRatioMax":0.0010894432944765224,"name":"S02: Input","shuffleOutputBytes":"1926","recordsWritten":"214","readRatioMax":0.001307331953371827,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_year, $22:d_moy","FROM date_dim","WHERE and(between($22, 4, 10), equal($21, 2001))"]},{"kind":"WRITE","substeps":["$20","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.01982786795947271},{"readMsMax":"10","computeMsMax":"10","waitMsAvg":"5","id":"3","endMs":"1570971643210","waitMsMax":"5","startMs":"1570971642785","waitRatioMax":0.0005447216472382612,"readRatioAvg":0.0010894432944765224,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0010894432944765224,"writeMsAvg":"242","status":"COMPLETE","writeMsMax":"242","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.026364527726331844,"readMsAvg":"10","waitRatioAvg":0.0005447216472382612,"completedParallelInputs":"1","computeRatioMax":0.0010894432944765224,"name":"S03: Input","shuffleOutputBytes":"1926","recordsWritten":"214","readRatioMax":0.0010894432944765224,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_year, $32:d_moy","FROM date_dim","WHERE and(between($32, 4, 10), equal($31, 2001))"]},{"kind":"WRITE","substeps":["$30","TO __stage03_output","BY HASH($30)"]}],"writeRatioAvg":0.026364527726331844},{"readMsMax":"12","computeMsMax":"12","waitMsAvg":"1","id":"4","endMs":"1570971643274","waitMsMax":"1","startMs":"1570971642868","waitRatioMax":0.00010894432944765226,"readRatioAvg":0.001307331953371827,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.001307331953371827,"writeMsAvg":"167","status":"COMPLETE","writeMsMax":"167","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.018193703017757926,"readMsAvg":"12","waitRatioAvg":0.00010894432944765226,"completedParallelInputs":"1","computeRatioMax":0.001307331953371827,"name":"S04: Input","shuffleOutputBytes":"270","recordsWritten":"30","readRatioMax":0.001307331953371827,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year, $52:d_moy","FROM date_dim","WHERE and(equal($52, 4), equal($51, 2001))"]},{"kind":"WRITE","substeps":["$50","TO __stage04_output","BY HASH($50)"]}],"writeRatioAvg":0.018193703017757926},{"readMsMax":"31","computeMsMax":"6007","waitMsAvg":"1","id":"6","endMs":"1570971646557","waitMsMax":"1","startMs":"1570971643187","waitRatioMax":0.00010894432944765226,"readRatioAvg":0.0033772742128772197,"parallelInputs":"1","recordsRead":"2878330","computeRatioAvg":0.6544285869920471,"writeMsAvg":"112","status":"COMPLETE","writeMsMax":"112","computeMsAvg":"6007","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012201764898137051,"readMsAvg":"31","waitRatioAvg":0.00010894432944765226,"completedParallelInputs":"1","computeRatioMax":0.6544285869920471,"name":"S06: Input","shuffleOutputBytes":"124156889","recordsWritten":"2776885","readRatioMax":0.0033772742128772197,"steps":[{"kind":"READ","substeps":["$70:sr_returned_date_sk, $71:sr_item_sk, $72:sr_customer_sk, $73:sr_ticket_number, $74:sr_net_loss","FROM store_returns"]},{"kind":"WRITE","substeps":["$70, $71, $72, $73, $74","TO __stage06_output","BY HASH($72, $71, $73)"]}],"writeRatioAvg":0.012201764898137051},{"readMsMax":"0","computeMsMax":"56","inputStages":["6"],"waitMsAvg":"15","id":"8","endMs":"1570971649979","waitMsMax":"18","startMs":"1570971646649","waitRatioMax":0.0019609979300577404,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2776885","computeRatioAvg":0.004139884519010786,"writeMsAvg":"212","status":"COMPLETE","writeMsMax":"836","computeMsAvg":"38","shuffleOutputBytesSpilled":"0","writeRatioMax":0.09107745941823728,"readMsAvg":"0","waitRatioAvg":0.0016341649417147836,"completedParallelInputs":"100","computeRatioMax":0.006100882449068526,"name":"S08: Coalesce","shuffleOutputBytes":"124156889","recordsWritten":"2776885","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage06_output"]}],"writeRatioAvg":0.023096197842902278},{"readMsMax":"127","computeMsMax":"9179","inputStages":["8"],"waitMsAvg":"31","id":"9","endMs":"1570971655413","waitMsMax":"34","startMs":"1570971646820","waitRatioMax":0.0037041072012201767,"readRatioAvg":0.005556160801830265,"parallelInputs":"10","recordsRead":"56570962","computeRatioAvg":0.856193485129099,"writeMsAvg":"44","status":"COMPLETE","writeMsMax":"99","computeMsAvg":"7859","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010785488615317572,"readMsAvg":"51","waitRatioAvg":0.0033772742128772197,"completedParallelInputs":"10","computeRatioMax":1,"name":"S09: Join","shuffleOutputBytes":"149094424","recordsWritten":"2095625","readRatioMax":0.013835929839851836,"steps":[{"kind":"READ","substeps":["$60:ss_sold_date_sk, $61:ss_item_sk, $62:ss_customer_sk, $63:ss_store_sk, $64:ss_ticket_number, $65:ss_net_profit","FROM store_sales"]},{"kind":"READ","substeps":["$70, $71, $72, $73, $74","FROM __stage08_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $62 = $72, $61 = $71, $64 = $73"]},{"kind":"WRITE","substeps":["$100, $101, $102, $103, $104, $105, $106, $107","TO __stage09_output","BY HASH($106, $105)"]}],"writeRatioAvg":0.004793550495696699},{"readMsMax":"0","computeMsMax":"47","inputStages":["9"],"waitMsAvg":"2","id":"10","endMs":"1570971657624","waitMsMax":"5","startMs":"1570971655416","waitRatioMax":0.0005447216472382612,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2095625","computeRatioAvg":0.003921995860115481,"writeMsAvg":"189","status":"COMPLETE","writeMsMax":"265","computeMsAvg":"36","shuffleOutputBytesSpilled":"0","writeRatioMax":0.028870247303627847,"readMsAvg":"0","waitRatioAvg":0.0002178886588953045,"completedParallelInputs":"100","computeRatioMax":0.005120383484039656,"name":"S0A: Coalesce","shuffleOutputBytes":"149094424","recordsWritten":"2095625","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage09_output"]}],"writeRatioAvg":0.020590478265606275},{"readMsMax":"45","computeMsMax":"6359","inputStages":["0","1","2","3","4","10"],"waitMsAvg":"1","id":"11","endMs":"1570971660936","waitMsMax":"1","startMs":"1570971655492","waitRatioMax":0.00010894432944765226,"readRatioAvg":0.003921995860115481,"parallelInputs":"8","recordsRead":"31368907","computeRatioAvg":0.5599738533609325,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"5140","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0005447216472382612,"readMsAvg":"36","waitRatioAvg":0.00010894432944765226,"completedParallelInputs":"8","computeRatioMax":0.6927769909576207,"name":"S0B: Join+","shuffleOutputBytes":"438","recordsWritten":"2","readRatioMax":0.004902494825144352,"steps":[{"kind":"READ","substeps":["$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_net_profit","FROM catalog_sales"]},{"kind":"READ","substeps":["$100, $101, $102, $103, $104, $105, $106, $107","FROM __stage0A_output"]},{"kind":"READ","substeps":["$50","FROM __stage04_output"]},{"kind":"READ","substeps":["$30","FROM __stage03_output"]},{"kind":"READ","substeps":["$20","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage01_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $200 := $195, $201 := $196, $202 := $190, $203 := $191","$90 := MAX($193)","$91 := MAX($194)","$92 := MAX($192)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $181 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $172 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $150 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $135 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $110 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $41 = $106, $42 = $105"]},{"kind":"WRITE","substeps":["$200, $201, $202, $203, $90, $91, $92","TO __stage0B_output","BY HASH($200, $201, $202, $203)"]}],"writeRatioAvg":0.00032683298834295673},{"readMsMax":"0","computeMsMax":"4","inputStages":["11"],"waitMsAvg":"1","id":"12","endMs":"1570971661070","waitMsMax":"1","startMs":"1570971661051","waitRatioMax":0.00010894432944765226,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2","computeRatioAvg":0.000435777317790609,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"3","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00032683298834295673,"readMsAvg":"0","waitRatioAvg":0.00010894432944765226,"completedParallelInputs":"1","computeRatioMax":0.000435777317790609,"name":"S0C: Sort+","shuffleOutputBytes":"438","recordsWritten":"2","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$200, $201, $202, $203, $90, $91, $92","FROM __stage0B_output"]},{"kind":"SORT","substeps":["$210 ASC, $211 ASC, $212 ASC, $213 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203","$80 := MAX($90)","$81 := MAX($91)","$82 := MAX($92)"]},{"kind":"WRITE","substeps":["$220, $221, $222, $223, $224, $225, $226","TO __stage0C_output"]}],"writeRatioAvg":0.00032683298834295673},{"readMsMax":"0","computeMsMax":"5","inputStages":["12"],"waitMsAvg":"1","id":"13","endMs":"1570971661768","waitMsMax":"1","startMs":"1570971661127","waitRatioMax":0.00010894432944765226,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2","computeRatioAvg":0.0005447216472382612,"writeMsAvg":"612","status":"COMPLETE","writeMsMax":"612","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.06667392962196318,"readMsAvg":"0","waitRatioAvg":0.00010894432944765226,"completedParallelInputs":"1","computeRatioMax":0.0005447216472382612,"name":"S0D: Output","shuffleOutputBytes":"438","recordsWritten":"2","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$220, $221, $222, $223, $224, $225, $226","FROM __stage0C_output"]},{"kind":"SORT","substeps":["$220 ASC, $221 ASC, $222 ASC, $223 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$230, $231, $232, $233, $234, $235, $236","TO __stage0D_output"]}],"writeRatioAvg":0.06667392962196318}],"estimatedBytesProcessed":"1928125382","timeline":[{"totalSlotMs":"288","activeUnits":"4","completedUnits":"0","elapsedMs":"718","pendingUnits":"5"},{"totalSlotMs":"5160","activeUnits":"20","completedUnits":"4","elapsedMs":"1276","pendingUnits":"20"},{"totalSlotMs":"75459","activeUnits":"19","completedUnits":"8","elapsedMs":"3536","pendingUnits":"16"},{"totalSlotMs":"149542","activeUnits":"114","completedUnits":"15","elapsedMs":"5347","pendingUnits":"109"},{"totalSlotMs":"206023","activeUnits":"108","completedUnits":"16","elapsedMs":"5884","pendingUnits":"108"},{"totalSlotMs":"382081","activeUnits":"54","completedUnits":"113","elapsedMs":"7869","pendingUnits":"11"},{"totalSlotMs":"389513","activeUnits":"10","completedUnits":"114","elapsedMs":"8390","pendingUnits":"10"},{"totalSlotMs":"458329","activeUnits":"9","completedUnits":"121","elapsedMs":"12202","pendingUnits":"3"},{"totalSlotMs":"471991","activeUnits":"108","completedUnits":"116","elapsedMs":"13570","pendingUnits":"108"},{"totalSlotMs":"657359","activeUnits":"106","completedUnits":"188","elapsedMs":"15151","pendingUnits":"36"},{"totalSlotMs":"675981","activeUnits":"8","completedUnits":"216","elapsedMs":"15653","pendingUnits":"8"},{"totalSlotMs":"714839","activeUnits":"4","completedUnits":"223","elapsedMs":"18602","pendingUnits":"1"},{"totalSlotMs":"716640","activeUnits":"1","completedUnits":"226","elapsedMs":"19899","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"1928331264","totalPartitionsProcessed":"0","totalBytesProcessed":"1928125382","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570971662032"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query25_1570971640"},"etag":"vBkrmZdm9fk6lyzN60kw9g==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query25_1570971640?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anona7325997d4d96876b9c5731ed10465a5a8d94e7c","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query25\nSELECT i_item_id, \n i_item_desc, \n s_store_id, \n s_store_name, \n Max(ss_net_profit) AS store_sales_profit, \n Max(sr_net_loss) AS store_returns_loss, \n Max(cs_net_profit) AS catalog_sales_profit \nFROM store_sales, \n store_returns, \n catalog_sales, \n date_dim d1, \n date_dim d2, \n date_dim d3, \n store, \n item \nWHERE d1.d_moy = 4 \n AND d1.d_year = 2001 \n AND d1.d_date_sk = ss_sold_date_sk \n AND i_item_sk = ss_item_sk \n AND s_store_sk = ss_store_sk \n AND ss_customer_sk = sr_customer_sk \n AND ss_item_sk = sr_item_sk \n AND ss_ticket_number = sr_ticket_number \n AND sr_returned_date_sk = d2.d_date_sk \n AND d2.d_moy BETWEEN 4 AND 10 \n AND d2.d_year = 2001 \n AND sr_customer_sk = cs_bill_customer_sk \n AND sr_item_sk = cs_item_sk \n AND cs_sold_date_sk = d3.d_date_sk \n AND d3.d_moy BETWEEN 4 AND 10 \n AND d3.d_year = 2001 \nGROUP BY i_item_id, \n i_item_desc, \n s_store_id, \n s_store_name \nORDER BY i_item_id, \n i_item_desc, \n s_store_id, \n s_store_name\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query25_1570971640","user_email":"nithish.sankaranarayanan@ulb.be"}
