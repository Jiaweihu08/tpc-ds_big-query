{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"209390","creationTime":"1570993509318","totalBytesProcessed":"17378232475","startTime":"1570993509457","query":{"totalSlotMs":"209390","queryPlan":[{"readMsMax":"22","computeMsMax":"8","waitMsAvg":"1","id":"0","endMs":"1570993510369","waitMsMax":"1","startMs":"1570993509727","waitRatioMax":0.0008210180623973727,"readRatioAvg":0.0180623973727422,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.006568144499178982,"writeMsAvg":"608","status":"COMPLETE","writeMsMax":"608","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.49917898193760263,"readMsAvg":"22","waitRatioAvg":0.0008210180623973727,"completedParallelInputs":"1","computeRatioMax":0.006568144499178982,"name":"S00: Input","shuffleOutputBytes":"6480","recordsWritten":"720","readRatioMax":0.0180623973727422,"steps":[{"kind":"READ","substeps":["$10:hd_demo_sk, $11:hd_dep_count, $12:hd_vehicle_count","FROM household_demographics","WHERE or(equal($11, 8), greater($12, 4))"]},{"kind":"WRITE","substeps":["$10","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.49917898193760263},{"readMsMax":"38","computeMsMax":"6","waitMsAvg":"3","id":"1","endMs":"1570993510495","waitMsMax":"3","startMs":"1570993509768","waitRatioMax":0.0024630541871921183,"readRatioAvg":0.031198686371100164,"parallelInputs":"1","recordsRead":"402","computeRatioAvg":0.0049261083743842365,"writeMsAvg":"676","status":"COMPLETE","writeMsMax":"676","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.555008210180624,"readMsAvg":"38","waitRatioAvg":0.0024630541871921183,"completedParallelInputs":"1","computeRatioMax":0.0049261083743842365,"name":"S01: Input","shuffleOutputBytes":"8970","recordsWritten":"385","readRatioMax":0.031198686371100164,"steps":[{"kind":"READ","substeps":["$30:s_store_sk, $32:s_city, $31:s_number_employees","FROM store","WHERE between($31, 200, 295)"]},{"kind":"WRITE","substeps":["$30, $32","TO __stage01_output","BY HASH($30)"]}],"writeRatioAvg":0.555008210180624},{"readMsMax":"8","computeMsMax":"7","waitMsAvg":"3","id":"2","endMs":"1570993510452","waitMsMax":"3","startMs":"1570993509836","waitRatioMax":0.0024630541871921183,"readRatioAvg":0.006568144499178982,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.005747126436781609,"writeMsAvg":"569","status":"COMPLETE","writeMsMax":"569","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.4671592775041051,"readMsAvg":"8","waitRatioAvg":0.0024630541871921183,"completedParallelInputs":"1","computeRatioMax":0.005747126436781609,"name":"S02: Input","shuffleOutputBytes":"1413","recordsWritten":"157","readRatioMax":0.006568144499178982,"steps":[{"kind":"READ","substeps":["$40:d_date_sk, $41:d_year, $42:d_dow","FROM date_dim","WHERE and(equal($42, 1), in($41, 2000, 2001, 2002))"]},{"kind":"WRITE","substeps":["$40","TO __stage02_output","BY HASH($40)"]}],"writeRatioAvg":0.4671592775041051},{"readMsMax":"116","computeMsMax":"1215","inputStages":["0","1","2"],"waitMsAvg":"3","id":"5","endMs":"1570993511605","waitMsMax":"8","startMs":"1570993510752","waitRatioMax":0.006568144499178982,"readRatioAvg":0.041050903119868636,"parallelInputs":"184","recordsRead":"282105131","computeRatioAvg":0.7684729064039408,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"149","computeMsAvg":"936","shuffleOutputBytesSpilled":"0","writeRatioMax":0.12233169129720854,"readMsAvg":"50","waitRatioAvg":0.0024630541871921183,"completedParallelInputs":"184","computeRatioMax":0.9975369458128078,"name":"S05: Join+","shuffleOutputBytes":"12160082","recordsWritten":"210748","readRatioMax":0.09523809523809523,"steps":[{"kind":"READ","substeps":["$20:ss_sold_date_sk, $21:ss_customer_sk, $22:ss_hdemo_sk, $23:ss_addr_sk, $24:ss_store_sk, $25:ss_ticket_number, $26:ss_coupon_amt, $27:ss_net_profit","FROM store_sales"]},{"kind":"READ","substeps":["$40","FROM __stage02_output"]},{"kind":"READ","substeps":["$30, $32","FROM __stage01_output"]},{"kind":"READ","substeps":["$10","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $120 := $112, $121 := $110, $122 := $111, $123 := $115","$70 := SUM($113)","$71 := SUM($114)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $91 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $83 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $40"]},{"kind":"WRITE","substeps":["$121, $122, $120, $123, $70, $71","TO __stage05_output","BY HASH($120, $121, $122, $123)"]}],"writeRatioAvg":0.006568144499178982},{"readMsMax":"0","computeMsMax":"50","inputStages":["5"],"waitMsAvg":"6","id":"7","endMs":"1570993512071","waitMsMax":"7","startMs":"1570993511668","waitRatioMax":0.005747126436781609,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"210748","computeRatioAvg":0.03201970443349754,"writeMsAvg":"82","status":"COMPLETE","writeMsMax":"135","computeMsAvg":"39","shuffleOutputBytesSpilled":"0","writeRatioMax":0.11083743842364532,"readMsAvg":"0","waitRatioAvg":0.0049261083743842365,"completedParallelInputs":"18","computeRatioMax":0.041050903119868636,"name":"S07: Aggregate","shuffleOutputBytes":"9924140","recordsWritten":"197936","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$121, $122, $120, $123, $70, $71","FROM __stage05_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $130 := $120, $131 := $121, $132 := $122, $133 := $123","$60 := SUM($70)","$61 := SUM($71)"]},{"kind":"WRITE","substeps":["$60, $61, $130, $131, $133","TO __stage07_output","BY HASH($131)"]}],"writeRatioAvg":0.06732348111658457},{"readMsMax":"0","computeMsMax":"16","inputStages":["7"],"waitMsAvg":"2","id":"8","endMs":"1570993512426","waitMsMax":"4","startMs":"1570993512080","waitRatioMax":0.003284072249589491,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"197936","computeRatioAvg":0.007389162561576354,"writeMsAvg":"108","status":"COMPLETE","writeMsMax":"141","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.11576354679802955,"readMsAvg":"0","waitRatioAvg":0.0016420361247947454,"completedParallelInputs":"100","computeRatioMax":0.013136288998357963,"name":"S08: Coalesce","shuffleOutputBytes":"9924140","recordsWritten":"197936","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage07_output"]}],"writeRatioAvg":0.08866995073891626},{"readMsMax":"26","computeMsMax":"1218","inputStages":["8"],"waitMsAvg":"5","id":"9","endMs":"1570993513064","waitMsMax":"5","startMs":"1570993512085","waitRatioMax":0.004105090311986864,"readRatioAvg":0.021346469622331693,"parallelInputs":"1","recordsRead":"2197936","computeRatioAvg":1,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"3","computeMsAvg":"1218","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0024630541871921183,"readMsAvg":"26","waitRatioAvg":0.004105090311986864,"completedParallelInputs":"1","computeRatioMax":1,"name":"S09: Join+","shuffleOutputBytes":"3976","recordsWritten":"100","readRatioMax":0.021346469622331693,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_first_name, $3:c_last_name","FROM customer"]},{"kind":"READ","substeps":["$60, $61, $130, $131, $133","FROM __stage08_output"]},{"kind":"SORT","substeps":["$145 ASC, $144 ASC, $50 ASC, $143 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$50 := substr($141, 1, 30)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $131"]},{"kind":"WRITE","substeps":["$150, $151, $152, $153, $154, $155","TO __stage09_output"]}],"writeRatioAvg":0.0024630541871921183},{"readMsMax":"0","computeMsMax":"5","inputStages":["9"],"waitMsAvg":"2","id":"10","endMs":"1570993513290","waitMsMax":"2","startMs":"1570993512152","waitRatioMax":0.0016420361247947454,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.004105090311986864,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.016420361247947456,"readMsAvg":"0","waitRatioAvg":0.0016420361247947454,"completedParallelInputs":"1","computeRatioMax":0.004105090311986864,"name":"S0A: Output","shuffleOutputBytes":"3976","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$150, $151, $152, $153, $154, $155","FROM __stage09_output"]},{"kind":"SORT","substeps":["$151 ASC, $150 ASC, $153 ASC, $155 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$160, $161, $162, $163, $164, $165","TO __stage0A_output"]}],"writeRatioAvg":0.016420361247947456}],"estimatedBytesProcessed":"17378232475","timeline":[{"totalSlotMs":"1876","activeUnits":"43","completedUnits":"0","elapsedMs":"770","pendingUnits":"187"},{"totalSlotMs":"72745","activeUnits":"174","completedUnits":"13","elapsedMs":"1796","pendingUnits":"174"},{"totalSlotMs":"206979","activeUnits":"19","completedUnits":"305","elapsedMs":"3052","pendingUnits":"2"},{"totalSlotMs":"209390","activeUnits":"2","completedUnits":"307","elapsedMs":"4172","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"17379098624","totalPartitionsProcessed":"0","totalBytesProcessed":"17378232475","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_100"}]},"endTime":"1570993513656"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query79_1570993507"},"etag":"dnllRcbe29SlZweR8FgtFQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query79_1570993507?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon06797cad6efe124f265c00efac792734b38c30c1","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query79\nSELECT c_last_name, \n c_first_name, \n Substr(s_city, 1, 30), \n ss_ticket_number, \n amt, \n profit \nFROM (SELECT ss_ticket_number, \n ss_customer_sk, \n store.s_city, \n Sum(ss_coupon_amt) amt, \n Sum(ss_net_profit) profit \n FROM store_sales, \n date_dim, \n store, \n household_demographics \n WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk \n AND store_sales.ss_store_sk = store.s_store_sk \n AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk \n AND ( household_demographics.hd_dep_count = 8 \n OR household_demographics.hd_vehicle_count > 4 ) \n AND date_dim.d_dow = 1 \n AND date_dim.d_year IN ( 2000, 2000 + 1, 2000 + 2 ) \n AND store.s_number_employees BETWEEN 200 AND 295 \n GROUP BY ss_ticket_number, \n ss_customer_sk, \n ss_addr_sk, \n store.s_city) ms, \n customer \nWHERE ss_customer_sk = c_customer_sk \nORDER BY c_last_name, \n c_first_name, \n Substr(s_city, 1, 30), \n profit\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query79_1570993507","user_email":"nithish.sankaranarayanan@ulb.be"}
