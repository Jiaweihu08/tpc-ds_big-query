{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"121537","creationTime":"1570992711334","totalBytesProcessed":"6462302678","startTime":"1570992711502","query":{"totalSlotMs":"121537","queryPlan":[{"readMsMax":"26","computeMsMax":"10","waitMsAvg":"1","id":"0","endMs":"1570992711802","waitMsMax":"1","startMs":"1570992711753","waitRatioMax":0.0014204545454545455,"readRatioAvg":0.036931818181818184,"parallelInputs":"1","recordsRead":"402","computeRatioAvg":0.014204545454545454,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011363636363636364,"readMsAvg":"26","waitRatioAvg":0.0014204545454545455,"completedParallelInputs":"1","computeRatioMax":0.014204545454545454,"name":"S00: Input","shuffleOutputBytes":"8961","recordsWritten":"230","readRatioMax":0.036931818181818184,"steps":[{"kind":"READ","substeps":["$10:s_store_sk, $11:s_store_id, $12:s_store_name, $13:s_gmt_offset","FROM store","WHERE equal($13, -5)"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.011363636363636364},{"readMsMax":"17","computeMsMax":"9","waitMsAvg":"20","id":"2","endMs":"1570992711997","waitMsMax":"20","startMs":"1570992711804","waitRatioMax":0.028409090909090908,"readRatioAvg":0.024147727272727272,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.01278409090909091,"writeMsAvg":"163","status":"COMPLETE","writeMsMax":"163","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.2315340909090909,"readMsAvg":"17","waitRatioAvg":0.028409090909090908,"completedParallelInputs":"1","computeRatioMax":0.01278409090909091,"name":"S02: Input","shuffleOutputBytes":"7717","recordsWritten":"365","readRatioMax":0.024147727272727272,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $22:d_day_name, $21:d_year","FROM date_dim","WHERE equal($21, 2002)"]},{"kind":"WRITE","substeps":["$20, $22","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.2315340909090909},{"readMsMax":"66","computeMsMax":"704","inputStages":["0","2"],"waitMsAvg":"6","id":"3","endMs":"1570992712696","waitMsMax":"9","startMs":"1570992712117","waitRatioMax":0.01278409090909091,"readRatioAvg":0.032670454545454544,"parallelInputs":"184","recordsRead":"281982403","computeRatioAvg":0.765625,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"201","computeMsAvg":"539","shuffleOutputBytesSpilled":"0","writeRatioMax":0.28551136363636365,"readMsAvg":"23","waitRatioAvg":0.008522727272727272,"completedParallelInputs":"184","computeRatioMax":1,"name":"S03: Join+","shuffleOutputBytes":"2018480","recordsWritten":"21712","readRatioMax":0.09375,"steps":[{"kind":"READ","substeps":["$1:ss_sold_date_sk, $2:ss_store_sk, $3:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$20, $22","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $90 := $83, $91 := $82","$40 := SUM($56)","$41 := SUM($55)","$42 := SUM($54)","$43 := SUM($53)","$44 := SUM($52)","$45 := SUM($51)","$46 := SUM($50)"]},{"kind":"COMPUTE","substeps":["$50 := case_no_value(equal($81, 'Saturday'), $80, NULL)","$51 := case_no_value(equal($81, 'Friday'), $80, NULL)","$52 := case_no_value(equal($81, 'Thursday'), $80, NULL)","$53 := case_no_value(equal($81, 'Wednesday'), $80, NULL)","$54 := case_no_value(equal($81, 'Tuesday'), $80, NULL)","$55 := case_no_value(equal($81, 'Monday'), $80, NULL)","$56 := case_no_value(equal($81, 'Sunday'), $80, NULL)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $71 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $20"]},{"kind":"WRITE","substeps":["$91, $90, $40, $41, $42, $43, $44, $45, $46","TO __stage03_output","BY HASH($90, $91)"]}],"writeRatioAvg":0.011363636363636364},{"readMsMax":"0","computeMsMax":"9","inputStages":["3"],"waitMsAvg":"1","id":"4","endMs":"1570992712800","waitMsMax":"1","startMs":"1570992712704","waitRatioMax":0.0014204545454545455,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"21712","computeRatioAvg":0.008522727272727272,"writeMsAvg":"30","status":"COMPLETE","writeMsMax":"66","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.09375,"readMsAvg":"0","waitRatioAvg":0.0014204545454545455,"completedParallelInputs":"18","computeRatioMax":0.01278409090909091,"name":"S04: Sort+","shuffleOutputBytes":"10970","recordsWritten":"118","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$91, $90, $40, $41, $42, $43, $44, $45, $46","FROM __stage03_output"]},{"kind":"SORT","substeps":["$100 ASC, $101 ASC, $30 ASC, $31 ASC, $32 ASC, $33 ASC, $34 ASC, $35 ASC, $36 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $100 := $90, $101 := $91","$30 := SUM($40)","$31 := SUM($41)","$32 := SUM($42)","$33 := SUM($43)","$34 := SUM($44)","$35 := SUM($45)","$36 := SUM($46)"]},{"kind":"WRITE","substeps":["$110, $111, $112, $113, $114, $115, $116, $117, $118","TO __stage04_output"]}],"writeRatioAvg":0.04261363636363636},{"readMsMax":"0","computeMsMax":"6","inputStages":["4"],"waitMsAvg":"1","id":"5","endMs":"1570992712914","waitMsMax":"1","startMs":"1570992712726","waitRatioMax":0.0014204545454545455,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"118","computeRatioAvg":0.008522727272727272,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009943181818181818,"readMsAvg":"0","waitRatioAvg":0.0014204545454545455,"completedParallelInputs":"1","computeRatioMax":0.008522727272727272,"name":"S05: Output","shuffleOutputBytes":"9291","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110, $111, $112, $113, $114, $115, $116, $117, $118","FROM __stage04_output"]},{"kind":"SORT","substeps":["$111 ASC, $110 ASC, $112 ASC, $113 ASC, $114 ASC, $115 ASC, $116 ASC, $117 ASC, $118 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$120, $121, $122, $123, $124, $125, $126, $127, $128","TO __stage05_output"]}],"writeRatioAvg":0.009943181818181818}],"estimatedBytesProcessed":"6462302678","timeline":[{"totalSlotMs":"15252","activeUnits":"184","completedUnits":"2","elapsedMs":"755","pendingUnits":"184"},{"totalSlotMs":"121537","activeUnits":"1","completedUnits":"205","elapsedMs":"1584","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"6462373888","totalPartitionsProcessed":"0","totalBytesProcessed":"6462302678","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_100"}]},"endTime":"1570992713124"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query43_1570992708"},"etag":"RtIn6VsmVsttwoUvaFl+zQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query43_1570992708?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon99016e46ece19107fd6346d53346385168e890e8","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query43\nSELECT s_store_name, \n s_store_id, \n Sum(CASE \n WHEN ( d_day_name = 'Sunday' ) THEN ss_sales_price \n ELSE NULL \n END) sun_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Monday' ) THEN ss_sales_price \n ELSE NULL \n END) mon_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Tuesday' ) THEN ss_sales_price \n ELSE NULL \n END) tue_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Wednesday' ) THEN ss_sales_price \n ELSE NULL \n END) wed_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Thursday' ) THEN ss_sales_price \n ELSE NULL \n END) thu_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Friday' ) THEN ss_sales_price \n ELSE NULL \n END) fri_sales, \n Sum(CASE \n WHEN ( d_day_name = 'Saturday' ) THEN ss_sales_price \n ELSE NULL \n END) sat_sales \nFROM date_dim, \n store_sales, \n store \nWHERE d_date_sk = ss_sold_date_sk \n AND s_store_sk = ss_store_sk \n AND s_gmt_offset = -5 \n AND d_year = 2002 \nGROUP BY s_store_name, \n s_store_id \nORDER BY s_store_name, \n s_store_id, \n sun_sales, \n mon_sales, \n tue_sales, \n wed_sales, \n thu_sales, \n fri_sales, \n sat_sales\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query43_1570992708","user_email":"nithish.sankaranarayanan@ulb.be"}
