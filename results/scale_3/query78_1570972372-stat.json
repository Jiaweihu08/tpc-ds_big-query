{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"394455","creationTime":"1570972373614","totalBytesProcessed":"2849413048","startTime":"1570972373817","query":{"totalSlotMs":"394455","queryPlan":[{"readMsMax":"12","computeMsMax":"56","waitMsAvg":"1","id":"0","endMs":"1570972374204","waitMsMax":"1","startMs":"1570972373998","waitRatioMax":8.667013347200555e-05,"readRatioAvg":0.0010400416016640667,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004853527474432311,"writeMsAvg":"157","status":"COMPLETE","writeMsMax":"157","computeMsAvg":"56","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013607210955104872,"readMsAvg":"12","waitRatioAvg":8.667013347200555e-05,"completedParallelInputs":"1","computeRatioMax":0.004853527474432311,"name":"S00: Input","shuffleOutputBytes":"1314882","recordsWritten":"73049","readRatioMax":0.0010400416016640667,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $11:d_year","FROM date_dim"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.013607210955104872},{"readMsMax":"20","computeMsMax":"648","waitMsAvg":"1","id":"1","endMs":"1570972375062","waitMsMax":"1","startMs":"1570972374067","waitRatioMax":8.667013347200555e-05,"readRatioAvg":0.001733402669440111,"parallelInputs":"1","recordsRead":"720202","computeRatioAvg":0.056162246489859596,"writeMsAvg":"40","status":"COMPLETE","writeMsMax":"40","computeMsAvg":"648","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003466805338880222,"readMsAvg":"20","waitRatioAvg":8.667013347200555e-05,"completedParallelInputs":"1","computeRatioMax":0.056162246489859596,"name":"S01: Input","shuffleOutputBytes":"12963636","recordsWritten":"720202","readRatioMax":0.001733402669440111,"steps":[{"kind":"READ","substeps":["$80:wr_item_sk, $81:wr_order_number","FROM web_returns"]},{"kind":"WRITE","substeps":["$80, $81","TO __stage01_output","BY HASH($81, $80)"]}],"writeRatioAvg":0.003466805338880222},{"readMsMax":"9","computeMsMax":"10","waitMsAvg":"21","id":"2","endMs":"1570972374295","waitMsMax":"21","startMs":"1570972374108","waitRatioMax":0.0018200728029121164,"readRatioAvg":0.00078003120124805,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0008667013347200555,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0006933610677760444,"readMsAvg":"9","waitRatioAvg":0.0018200728029121164,"completedParallelInputs":"1","computeRatioMax":0.0008667013347200555,"name":"S02: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.00078003120124805,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_year","FROM date_dim","WHERE equal($31, 1999)"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage02_output","BY HASH($30)"]}],"writeRatioAvg":0.0006933610677760444},{"readMsMax":"23","computeMsMax":"3449","waitMsAvg":"46","id":"3","endMs":"1570972375855","waitMsMax":"46","startMs":"1570972374149","waitRatioMax":0.003986826139712255,"readRatioAvg":0.0019934130698561277,"parallelInputs":"1","recordsRead":"2878330","computeRatioAvg":0.29892529034494714,"writeMsAvg":"45","status":"COMPLETE","writeMsMax":"45","computeMsAvg":"3449","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0039001560062402497,"readMsAvg":"23","waitRatioAvg":0.003986826139712255,"completedParallelInputs":"1","computeRatioMax":0.29892529034494714,"name":"S03: Input","shuffleOutputBytes":"51809940","recordsWritten":"2878330","readRatioMax":0.0019934130698561277,"steps":[{"kind":"READ","substeps":["$60:sr_item_sk, $61:sr_ticket_number","FROM store_returns"]},{"kind":"WRITE","substeps":["$60, $61","TO __stage03_output","BY HASH($61, $60)"]}],"writeRatioAvg":0.0039001560062402497},{"readMsMax":"11","computeMsMax":"46","waitMsAvg":"74","id":"4","endMs":"1570972374246","waitMsMax":"74","startMs":"1570972374193","waitRatioMax":0.006413589876928411,"readRatioAvg":0.000953371468192061,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.003986826139712255,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"46","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0008667013347200555,"readMsAvg":"11","waitRatioAvg":0.006413589876928411,"completedParallelInputs":"1","computeRatioMax":0.003986826139712255,"name":"S04: Input","shuffleOutputBytes":"1314882","recordsWritten":"73049","readRatioMax":0.000953371468192061,"steps":[{"kind":"READ","substeps":["$1:d_date_sk, $2:d_year","FROM date_dim"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage04_output","BY HASH($1)"]}],"writeRatioAvg":0.0008667013347200555},{"readMsMax":"29","computeMsMax":"1462","waitMsAvg":"39","id":"5","endMs":"1570972375059","waitMsMax":"39","startMs":"1570972374204","waitRatioMax":0.0033801352054082163,"readRatioAvg":0.0025134338706881607,"parallelInputs":"1","recordsRead":"1439802","computeRatioAvg":0.12671173513607212,"writeMsAvg":"79","status":"COMPLETE","writeMsMax":"79","computeMsAvg":"1462","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006846940544288438,"readMsAvg":"29","waitRatioAvg":0.0033801352054082163,"completedParallelInputs":"1","computeRatioMax":0.12671173513607212,"name":"S05: Input","shuffleOutputBytes":"25916436","recordsWritten":"1439802","readRatioMax":0.0025134338706881607,"steps":[{"kind":"READ","substeps":["$20:cr_item_sk, $21:cr_order_number","FROM catalog_returns"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage05_output","BY HASH($21, $20)"]}],"writeRatioAvg":0.006846940544288438},{"readMsMax":"0","computeMsMax":"20","inputStages":["5"],"waitMsAvg":"2","id":"6","endMs":"1570972375376","waitMsMax":"4","startMs":"1570972375121","waitRatioMax":0.0003466805338880222,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1439802","computeRatioAvg":0.0012133818686080777,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"49","computeMsAvg":"14","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0042468365401282715,"readMsAvg":"0","waitRatioAvg":0.0001733402669440111,"completedParallelInputs":"100","computeRatioMax":0.001733402669440111,"name":"S06: Coalesce","shuffleOutputBytes":"25916436","recordsWritten":"1439802","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage05_output"]}],"writeRatioAvg":0.001733402669440111},{"readMsMax":"364","computeMsMax":"11538","inputStages":["4","6"],"waitMsAvg":"1","id":"7","endMs":"1570972381592","waitMsMax":"2","startMs":"1570972375273","waitRatioMax":0.0001733402669440111,"readRatioAvg":0.010747096550528688,"parallelInputs":"8","recordsRead":"26500131","computeRatioAvg":0.8667880048535275,"writeMsAvg":"138","status":"COMPLETE","writeMsMax":"404","computeMsAvg":"10001","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03501473392269024,"readMsAvg":"124","waitRatioAvg":8.667013347200555e-05,"completedParallelInputs":"8","computeRatioMax":1,"name":"S07: Join+","shuffleOutputBytes":"695155932","recordsWritten":"12892334","readRatioMax":0.03154792858381002,"steps":[{"kind":"READ","substeps":["$40:cs_sold_date_sk, $41:cs_bill_customer_sk, $42:cs_item_sk, $43:cs_order_number, $44:cs_quantity, $45:cs_wholesale_cost, $46:cs_sales_price","FROM catalog_sales","WHERE equal($42, $42)"]},{"kind":"READ","substeps":["$20, $21","FROM __stage06_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $280 := $275, $281 := $271, $282 := $270","$130 := SUM($272)","$131 := SUM($273)","$132 := SUM($274)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $260 = $1"]},{"kind":"FILTER","substeps":["is_null($266)"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $43 = $21, $42 = $20"]},{"kind":"WRITE","substeps":["$280, $282, $281, $130, $131, $132","TO __stage07_output","BY HASH($280, $281, $282)"]}],"writeRatioAvg":0.011960478419136765},{"readMsMax":"155","computeMsMax":"10426","inputStages":["0","1"],"waitMsAvg":"1","id":"8","endMs":"1570972380828","waitMsMax":"1","startMs":"1570972375286","waitRatioMax":8.667013347200555e-05,"readRatioAvg":0.008407002946784538,"parallelInputs":"4","recordsRead":"10374034","computeRatioAvg":0.7907782977985786,"writeMsAvg":"215","status":"COMPLETE","writeMsMax":"705","computeMsAvg":"9124","shuffleOutputBytesSpilled":"0","writeRatioMax":0.061102444097763914,"readMsAvg":"97","waitRatioAvg":8.667013347200555e-05,"completedParallelInputs":"4","computeRatioMax":0.9036228115791298,"name":"S08: Join+","shuffleOutputBytes":"349850590","recordsWritten":"6479189","readRatioMax":0.01343387068816086,"steps":[{"kind":"READ","substeps":["$70:ws_sold_date_sk, $71:ws_item_sk, $72:ws_bill_customer_sk, $73:ws_order_number, $74:ws_quantity, $75:ws_wholesale_cost, $76:ws_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$80, $81","FROM __stage01_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $225, $231 := $220, $232 := $221","$150 := SUM($222)","$151 := SUM($223)","$152 := SUM($224)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $210 = $10"]},{"kind":"FILTER","substeps":["is_null($216)"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $73 = $81, $71 = $80"]},{"kind":"WRITE","substeps":["$230, $231, $232, $150, $151, $152","TO __stage08_output","BY HASH($230, $231, $232)"]}],"writeRatioAvg":0.018634078696481194},{"readMsMax":"0","computeMsMax":"29","inputStages":["3"],"waitMsAvg":"1","id":"9","endMs":"1570972376307","waitMsMax":"4","startMs":"1570972376009","waitRatioMax":0.0003466805338880222,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2878330","computeRatioAvg":0.001906742936384122,"writeMsAvg":"170","status":"COMPLETE","writeMsMax":"210","computeMsAvg":"22","shuffleOutputBytesSpilled":"0","writeRatioMax":0.018200728029121163,"readMsAvg":"0","waitRatioAvg":8.667013347200555e-05,"completedParallelInputs":"100","computeRatioMax":0.0025134338706881607,"name":"S09: Coalesce","shuffleOutputBytes":"51809940","recordsWritten":"2878330","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage03_output"]}],"writeRatioAvg":0.014733922690240943},{"readMsMax":"54","computeMsMax":"11056","inputStages":["2","9"],"waitMsAvg":"1","id":"10","endMs":"1570972383150","waitMsMax":"1","startMs":"1570972376102","waitRatioMax":8.667013347200555e-05,"readRatioAvg":0.0037268157392962385,"parallelInputs":"10","recordsRead":"57589062","computeRatioAvg":0.8135725429017161,"writeMsAvg":"36","status":"COMPLETE","writeMsMax":"55","computeMsAvg":"9387","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004766857340960305,"readMsAvg":"43","waitRatioAvg":8.667013347200555e-05,"completedParallelInputs":"10","computeRatioMax":0.9582249956664933,"name":"S0A: Join+","shuffleOutputBytes":"263301828","recordsWritten":"4939162","readRatioMax":0.0046801872074883,"steps":[{"kind":"READ","substeps":["$50:ss_sold_date_sk, $51:ss_item_sk, $52:ss_customer_sk, $53:ss_ticket_number, $54:ss_quantity, $55:ss_wholesale_cost, $56:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$60, $61","FROM __stage09_output"]},{"kind":"READ","substeps":["$30, $31","FROM __stage02_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $185, $191 := $180, $192 := $181","$140 := SUM($182)","$141 := SUM($183)","$142 := SUM($184)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $160 = $30"]},{"kind":"FILTER","substeps":["is_null($166)"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $53 = $61, $51 = $60"]},{"kind":"WRITE","substeps":["$190, $191, $192, $140, $141, $142","TO __stage0A_output","BY HASH($190, $191, $192)"]}],"writeRatioAvg":0.0031201248049922},{"readMsMax":"0","computeMsMax":"4442","inputStages":["7"],"waitMsAvg":"1","id":"11","endMs":"1570972381642","waitMsMax":"1","startMs":"1570972379182","waitRatioMax":8.667013347200555e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2571184","computeRatioAvg":0.3849887328826486,"writeMsAvg":"41","status":"COMPLETE","writeMsMax":"41","computeMsAvg":"4442","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0035534754723522276,"readMsAvg":"0","waitRatioAvg":8.667013347200555e-05,"completedParallelInputs":"1","computeRatioMax":0.3849887328826486,"name":"S0B: Repartition","shuffleOutputBytes":"138413800","recordsWritten":"2571184","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage07_output"]}],"writeRatioAvg":0.0035534754723522276},{"readMsMax":"0","computeMsMax":"4652","inputStages":["8"],"waitMsAvg":"1","id":"12","endMs":"1570972381413","waitMsMax":"1","startMs":"1570972379184","waitRatioMax":8.667013347200555e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"3029597","computeRatioAvg":0.4031894609117698,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"4652","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001733402669440111,"readMsAvg":"0","waitRatioAvg":8.667013347200555e-05,"completedParallelInputs":"1","computeRatioMax":0.4031894609117698,"name":"S0C: Repartition","shuffleOutputBytes":"163579902","recordsWritten":"3029597","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage08_output"]}],"writeRatioAvg":0.001733402669440111},{"readMsMax":"0","computeMsMax":"3277","inputStages":["10"],"waitMsAvg":"1","id":"13","endMs":"1570972383246","waitMsMax":"1","startMs":"1570972381360","waitRatioMax":8.667013347200555e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2112756","computeRatioAvg":0.28401802738776216,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"3277","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0015600624024961,"readMsAvg":"0","waitRatioAvg":8.667013347200555e-05,"completedParallelInputs":"1","computeRatioMax":0.28401802738776216,"name":"S0D: Repartition","shuffleOutputBytes":"112509360","recordsWritten":"2112756","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0A_output"]}],"writeRatioAvg":0.0015600624024961},{"readMsMax":"0","computeMsMax":"4836","inputStages":["11","7"],"waitMsAvg":"1","id":"14","endMs":"1570972385926","waitMsMax":"1","startMs":"1570972383374","waitRatioMax":8.667013347200555e-05,"readRatioAvg":0,"parallelInputs":"10","recordsRead":"12892334","computeRatioAvg":0.3455538221528861,"writeMsAvg":"49","status":"COMPLETE","writeMsMax":"131","computeMsAvg":"3987","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011353787484832727,"readMsAvg":"0","waitRatioAvg":8.667013347200555e-05,"completedParallelInputs":"10","computeRatioMax":0.41913676547061884,"name":"S0E: Aggregate","shuffleOutputBytes":"578313227","recordsWritten":"12859999","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$280, $282, $281, $130, $131, $132","FROM __stage07_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $290 := $280, $291 := $281, $292 := $282","$100 := SUM($130)","$101 := SUM($131)","$102 := SUM($132)"]},{"kind":"WRITE","substeps":["$100, $101, $102, $290, $292","TO __stage0E_output","BY HASH($290, $292)"]}],"writeRatioAvg":0.0042468365401282715},{"readMsMax":"0","computeMsMax":"2587","inputStages":["12","8"],"waitMsAvg":"1","id":"15","endMs":"1570972384907","waitMsMax":"1","startMs":"1570972383391","waitRatioMax":8.667013347200555e-05,"readRatioAvg":0,"parallelInputs":"10","recordsRead":"6479189","computeRatioAvg":0.17845380481885942,"writeMsAvg":"36","status":"COMPLETE","writeMsMax":"60","computeMsAvg":"2059","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005200208008320333,"readMsAvg":"0","waitRatioAvg":8.667013347200555e-05,"completedParallelInputs":"10","computeRatioMax":0.22421563529207836,"name":"S0F: Aggregate","shuffleOutputBytes":"349820392","recordsWritten":"6478320","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$230, $231, $232, $150, $151, $152","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230, $241 := $231, $242 := $232","$120 := SUM($150)","$121 := SUM($151)","$122 := SUM($152)"]},{"kind":"WRITE","substeps":["$120, $121, $122, $240, $241, $242","TO __stage0F_output","BY HASH($240, $241, $242)"]}],"writeRatioAvg":0.0031201248049922},{"readMsMax":"0","computeMsMax":"1770","inputStages":["13","10"],"waitMsAvg":"1","id":"16","endMs":"1570972385252","waitMsMax":"1","startMs":"1570972384212","waitRatioMax":8.667013347200555e-05,"readRatioAvg":0,"parallelInputs":"10","recordsRead":"4939162","computeRatioAvg":0.140492286358121,"writeMsAvg":"46","status":"COMPLETE","writeMsMax":"80","computeMsAvg":"1621","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006933610677760444,"readMsAvg":"0","waitRatioAvg":8.667013347200555e-05,"completedParallelInputs":"10","computeRatioMax":0.15340613624544983,"name":"S10: Aggregate","shuffleOutputBytes":"261508032","recordsWritten":"4880292","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$190, $191, $192, $140, $141, $142","FROM __stage0A_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $200 := $190, $201 := $191, $202 := $192","$110 := SUM($140)","$111 := SUM($141)","$112 := SUM($142)"]},{"kind":"WRITE","substeps":["$110, $111, $112, $200, $201, $202","TO __stage10_output","BY HASH($200, $201, $202)"]}],"writeRatioAvg":0.003986826139712255},{"readMsMax":"0","computeMsMax":"189","inputStages":["15","16"],"waitMsAvg":"4","id":"17","endMs":"1570972385484","waitMsMax":"8","startMs":"1570972385284","waitRatioMax":0.0006933610677760444,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"11358612","computeRatioAvg":0.010053735482752643,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"70","computeMsAvg":"116","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006066909343040388,"readMsAvg":"0","waitRatioAvg":0.0003466805338880222,"completedParallelInputs":"100","computeRatioMax":0.01638065522620905,"name":"S11: Join+","shuffleOutputBytes":"16930","recordsWritten":"210","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110, $111, $112, $200, $201, $202","FROM __stage10_output"]},{"kind":"READ","substeps":["$120, $121, $122, $240, $241, $242","FROM __stage0F_output"]},{"kind":"FILTER","substeps":["greater(coalesce($256, 0), 0)"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH EACH ON $200 = $240, $201 = $241, $202 = $242"]},{"kind":"WRITE","substeps":["$250, $251, $252, $253, $254, $255, $256, $257, $258","TO __stage11_output","BY HASH($250, $252)"]}],"writeRatioAvg":0.0006066909343040389},{"readMsMax":"0","computeMsMax":"154","inputStages":["14","17"],"waitMsAvg":"2","id":"18","endMs":"1570972386091","waitMsMax":"4","startMs":"1570972385936","waitRatioMax":0.0003466805338880222,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"12860209","computeRatioAvg":0.008840353614144566,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"40","computeMsAvg":"102","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003466805338880222,"readMsAvg":"0","waitRatioAvg":0.0001733402669440111,"completedParallelInputs":"100","computeRatioMax":0.013347200554688854,"name":"S12: Join+","shuffleOutputBytes":"69192","recordsWritten":"972","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$250, $251, $252, $253, $254, $255, $256, $257, $258","FROM __stage11_output"]},{"kind":"READ","substeps":["$100, $101, $102, $290, $292","FROM __stage0E_output"]},{"kind":"SORT","substeps":["$300 ASC, $301 DESC, $302 DESC, $303 DESC, $91 ASC, $92 ASC, $93 ASC, $90 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$90 := round(divide(CAST($301 AS DOUBLE), CAST(coalesce(add($304, $307), 1) AS DOUBLE)), 2)","$91 := add(coalesce($304, 0), coalesce($307, 0))","$92 := add(coalesce($305, 0), coalesce($308, 0))","$93 := add(coalesce($306, 0), coalesce($309, 0))"]},{"kind":"FILTER","substeps":["greater(coalesce($307, 0), 0)"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH EACH ON $250 = $290, $252 = $292"]},{"kind":"WRITE","substeps":["$310, $311, $312, $313, $314, $315, $316, $317","TO __stage12_output"]}],"writeRatioAvg":0.00043335066736002774},{"readMsMax":"0","computeMsMax":"8","inputStages":["18"],"waitMsAvg":"1","id":"19","endMs":"1570972386102","waitMsMax":"1","startMs":"1570972385961","waitRatioMax":8.667013347200555e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"972","computeRatioAvg":0.0006933610677760444,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0006933610677760444,"readMsAvg":"0","waitRatioAvg":8.667013347200555e-05,"completedParallelInputs":"1","computeRatioMax":0.0006933610677760444,"name":"S13: Output","shuffleOutputBytes":"6816","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$310, $311, $312, $313, $314, $315, $316, $317","FROM __stage12_output"]},{"kind":"SORT","substeps":["$310 ASC, $315 DESC, $316 DESC, $317 DESC, $312 ASC, $313 ASC, $314 ASC, $311 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$320, $321, $322, $323, $324, $325, $326, $327","TO __stage13_output"]}],"writeRatioAvg":0.0006933610677760444}],"estimatedBytesProcessed":"2849413048","timeline":[{"totalSlotMs":"921","activeUnits":"3","completedUnits":"3","elapsedMs":"683","pendingUnits":"3"},{"totalSlotMs":"59439","activeUnits":"22","completedUnits":"206","elapsedMs":"2541","pendingUnits":"22"},{"totalSlotMs":"231887","activeUnits":"23","completedUnits":"211","elapsedMs":"6843","pendingUnits":"19"},{"totalSlotMs":"264898","activeUnits":"15","completedUnits":"225","elapsedMs":"7858","pendingUnits":"6"},{"totalSlotMs":"272487","activeUnits":"3","completedUnits":"229","elapsedMs":"8644","pendingUnits":"2"},{"totalSlotMs":"281052","activeUnits":"20","completedUnits":"231","elapsedMs":"9837","pendingUnits":"20"},{"totalSlotMs":"354794","activeUnits":"101","completedUnits":"260","elapsedMs":"11549","pendingUnits":"101"},{"totalSlotMs":"394455","activeUnits":"2","completedUnits":"462","elapsedMs":"12481","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"2850029568","totalPartitionsProcessed":"0","totalBytesProcessed":"2849413048","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_returns","datasetId":"scale_10"}]},"endTime":"1570972386335"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query78_1570972372"},"etag":"QYLsZa5THYnkZcaDUe/5jQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query78_1570972372?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anondcac9488a241d1a17f24380424f37105df3580b1","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query78\nWITH ws \n AS (SELECT d_year AS ws_sold_year, \n ws_item_sk, \n ws_bill_customer_sk ws_customer_sk, \n Sum(ws_quantity) ws_qty, \n Sum(ws_wholesale_cost) ws_wc, \n Sum(ws_sales_price) ws_sp \n FROM web_sales \n LEFT JOIN web_returns \n ON wr_order_number = ws_order_number \n AND ws_item_sk = wr_item_sk \n JOIN date_dim \n ON ws_sold_date_sk = d_date_sk \n WHERE wr_order_number IS NULL \n GROUP BY d_year, \n ws_item_sk, \n ws_bill_customer_sk), \n cs \n AS (SELECT d_year AS cs_sold_year, \n cs_item_sk, \n cs_bill_customer_sk cs_customer_sk, \n Sum(cs_quantity) cs_qty, \n Sum(cs_wholesale_cost) cs_wc, \n Sum(cs_sales_price) cs_sp \n FROM catalog_sales \n LEFT JOIN catalog_returns \n ON cr_order_number = cs_order_number \n AND cs_item_sk = cr_item_sk \n JOIN date_dim \n ON cs_sold_date_sk = d_date_sk \n WHERE cr_order_number IS NULL \n GROUP BY d_year, \n cs_item_sk, \n cs_bill_customer_sk), \n ss \n AS (SELECT d_year AS ss_sold_year, \n ss_item_sk, \n ss_customer_sk, \n Sum(ss_quantity) ss_qty, \n Sum(ss_wholesale_cost) ss_wc, \n Sum(ss_sales_price) ss_sp \n FROM store_sales \n LEFT JOIN store_returns \n ON sr_ticket_number = ss_ticket_number \n AND ss_item_sk = sr_item_sk \n JOIN date_dim \n ON ss_sold_date_sk = d_date_sk \n WHERE sr_ticket_number IS NULL \n GROUP BY d_year, \n ss_item_sk, \n ss_customer_sk) \nSELECT ss_item_sk, \n Round(ss_qty / ( COALESCE(ws_qty + cs_qty, 1) ), 2) ratio, \n ss_qty store_qty, \n ss_wc \n store_wholesale_cost, \n ss_sp \n store_sales_price, \n COALESCE(ws_qty, 0) + COALESCE(cs_qty, 0) \n other_chan_qty, \n COALESCE(ws_wc, 0) + COALESCE(cs_wc, 0) \n other_chan_wholesale_cost, \n COALESCE(ws_sp, 0) + COALESCE(cs_sp, 0) \n other_chan_sales_price \nFROM ss \n LEFT JOIN ws \n ON ( ws_sold_year = ss_sold_year \n AND ws_item_sk = ss_item_sk \n AND ws_customer_sk = ss_customer_sk ) \n LEFT JOIN cs \n ON ( cs_sold_year = ss_sold_year \n AND cs_item_sk = cs_item_sk \n AND cs_customer_sk = ss_customer_sk ) \nWHERE COALESCE(ws_qty, 0) > 0 \n AND COALESCE(cs_qty, 0) > 0 \n AND ss_sold_year = 1999 \nORDER BY ss_item_sk, \n ss_qty DESC, \n ss_wc DESC, \n ss_sp DESC, \n other_chan_qty, \n other_chan_wholesale_cost, \n other_chan_sales_price, \n Round(ss_qty / ( COALESCE(ws_qty + cs_qty, 1) ), 2)\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query78_1570972372","user_email":"nithish.sankaranarayanan@ulb.be"}
