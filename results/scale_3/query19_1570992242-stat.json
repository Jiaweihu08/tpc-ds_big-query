{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"714438","creationTime":"1570992244610","totalBytesProcessed":"10930380544","startTime":"1570992244798","query":{"totalSlotMs":"714438","queryPlan":[{"readMsMax":"59","computeMsMax":"6","waitMsAvg":"1","id":"0","endMs":"1570992245147","waitMsMax":"1","startMs":"1570992245070","waitRatioMax":8.587376556462001e-05,"readRatioAvg":0.00506655216831258,"parallelInputs":"1","recordsRead":"402","computeRatioAvg":0.0005152425933877201,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00042936882782310007,"readMsAvg":"59","waitRatioAvg":8.587376556462001e-05,"completedParallelInputs":"1","computeRatioMax":0.0005152425933877201,"name":"S00: Input","shuffleOutputBytes":"7593","recordsWritten":"402","readRatioMax":0.00506655216831258,"steps":[{"kind":"READ","substeps":["$1:s_store_sk, $2:s_zip","FROM store"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.00042936882782310007},{"readMsMax":"19","computeMsMax":"808","waitMsAvg":"16","id":"1","endMs":"1570992245602","waitMsMax":"16","startMs":"1570992245100","waitRatioMax":0.0013739802490339201,"readRatioAvg":0.0016316015457277801,"parallelInputs":"1","recordsRead":"1000000","computeRatioAvg":0.06938600257621297,"writeMsAvg":"69","status":"COMPLETE","writeMsMax":"69","computeMsAvg":"808","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005925289823958781,"readMsAvg":"19","waitRatioAvg":0.0013739802490339201,"completedParallelInputs":"1","computeRatioMax":0.06938600257621297,"name":"S01: Input","shuffleOutputBytes":"18729820","recordsWritten":"1000000","readRatioMax":0.0016316015457277801,"steps":[{"kind":"READ","substeps":["$10:ca_address_sk, $11:ca_zip","FROM customer_address"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.005925289823958781},{"readMsMax":"27","computeMsMax":"1602","waitMsAvg":"45","id":"2","endMs":"1570992245963","waitMsMax":"45","startMs":"1570992245143","waitRatioMax":0.0038643194504079004,"readRatioAvg":0.0023185916702447404,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.13756977243452126,"writeMsAvg":"58","status":"COMPLETE","writeMsMax":"58","computeMsAvg":"1602","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0049806784027479605,"readMsAvg":"27","waitRatioAvg":0.0038643194504079004,"completedParallelInputs":"1","computeRatioMax":0.13756977243452126,"name":"S02: Input","shuffleOutputBytes":"36000000","recordsWritten":"2000000","readRatioMax":0.0023185916702447404,"steps":[{"kind":"READ","substeps":["$20:c_customer_sk, $21:c_current_addr_sk","FROM customer"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.0049806784027479605},{"readMsMax":"48","computeMsMax":"19","waitMsAvg":"34","id":"3","endMs":"1570992245278","waitMsMax":"34","startMs":"1570992245147","waitRatioMax":0.00291970802919708,"readRatioAvg":0.004121940747101761,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.0016316015457277801,"writeMsAvg":"53","status":"COMPLETE","writeMsMax":"53","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00455130957492486,"readMsAvg":"48","waitRatioAvg":0.00291970802919708,"completedParallelInputs":"1","computeRatioMax":0.0016316015457277801,"name":"S03: Input","shuffleOutputBytes":"112826","recordsWritten":"1750","readRatioMax":0.004121940747101761,"steps":[{"kind":"READ","substeps":["$40:i_item_sk, $41:i_brand_id, $42:i_brand, $43:i_manufact_id, $44:i_manufact, $45:i_manager_id","FROM item","WHERE equal($45, 38)"]},{"kind":"WRITE","substeps":["$40, $41, $42, $43, $44","TO __stage03_output","BY HASH($40)"]}],"writeRatioAvg":0.00455130957492486},{"readMsMax":"14","computeMsMax":"8","waitMsAvg":"39","id":"5","endMs":"1570992245276","waitMsMax":"39","startMs":"1570992245188","waitRatioMax":0.0033490768570201804,"readRatioAvg":0.00120223271790468,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0006869901245169601,"writeMsAvg":"51","status":"COMPLETE","writeMsMax":"51","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004379562043795621,"readMsAvg":"14","waitRatioAvg":0.0033490768570201804,"completedParallelInputs":"1","computeRatioMax":0.0006869901245169601,"name":"S05: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.00120223271790468,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year, $52:d_moy","FROM date_dim","WHERE and(equal($52, 12), equal($51, 1998))"]},{"kind":"WRITE","substeps":["$50","TO __stage05_output","BY HASH($50)"]}],"writeRatioAvg":0.004379562043795621},{"readMsMax":"0","computeMsMax":"29","inputStages":["2"],"waitMsAvg":"5","id":"8","endMs":"1570992246471","waitMsMax":"16","startMs":"1570992246097","waitRatioMax":0.0013739802490339201,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2000000","computeRatioAvg":0.0016316015457277801,"writeMsAvg":"84","status":"COMPLETE","writeMsMax":"121","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01039072563331902,"readMsAvg":"0","waitRatioAvg":0.00042936882782310007,"completedParallelInputs":"100","computeRatioMax":0.0024903392013739803,"name":"S08: Coalesce","shuffleOutputBytes":"36000000","recordsWritten":"2000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage02_output"]}],"writeRatioAvg":0.007213396307428081},{"readMsMax":"0","computeMsMax":"18","inputStages":["1"],"waitMsAvg":"16","id":"9","endMs":"1570992246296","waitMsMax":"21","startMs":"1570992246098","waitRatioMax":0.0018033490768570202,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1000000","computeRatioAvg":0.0010304851867754402,"writeMsAvg":"79","status":"COMPLETE","writeMsMax":"102","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008759124087591242,"readMsAvg":"0","waitRatioAvg":0.0013739802490339201,"completedParallelInputs":"100","computeRatioMax":0.0015457277801631602,"name":"S09: Coalesce","shuffleOutputBytes":"18729820","recordsWritten":"1000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage01_output"]}],"writeRatioAvg":0.0067840274796049805},{"readMsMax":"167","computeMsMax":"3491","inputStages":["0","9","8","3","5"],"waitMsAvg":"3","id":"10","endMs":"1570992259477","waitMsMax":"8","startMs":"1570992246134","waitRatioMax":0.0006869901245169601,"readRatioAvg":0.0034349506225848005,"parallelInputs":"184","recordsRead":"834274595","computeRatioAvg":0.23555173894375267,"writeMsAvg":"92","status":"COMPLETE","writeMsMax":"11645","computeMsAvg":"2743","shuffleOutputBytesSpilled":"0","writeRatioMax":1,"readMsAvg":"40","waitRatioAvg":0.00025762129669386005,"completedParallelInputs":"184","computeRatioMax":0.29978531558608845,"name":"S0A: Join+","shuffleOutputBytes":"3676292","recordsWritten":"57104","readRatioMax":0.014340918849291541,"steps":[{"kind":"READ","substeps":["$30:ss_sold_date_sk, $31:ss_item_sk, $32:ss_customer_sk, $33:ss_store_sk, $34:ss_ext_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$50","FROM __stage05_output"]},{"kind":"READ","substeps":["$40, $41, $42, $43, $44","FROM __stage03_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage08_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage09_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $130 := $123, $131 := $122, $132 := $124, $133 := $125","$70 := SUM($121)"]},{"kind":"FILTER","substeps":["not_equal(substr($120, 1, 5), substr($126, 1, 5))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $110 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $106 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $90 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $80 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $30 = $50"]},{"kind":"WRITE","substeps":["$131, $130, $132, $133, $70","TO __stage0A_output","BY HASH($130, $131, $132, $133)"]}],"writeRatioAvg":0.007900386431945041},{"readMsMax":"0","computeMsMax":"9","inputStages":["10"],"waitMsAvg":"1","id":"11","endMs":"1570992260499","waitMsMax":"2","startMs":"1570992260293","waitRatioMax":0.00017174753112924002,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"57104","computeRatioAvg":0.00060111635895234,"writeMsAvg":"167","status":"COMPLETE","writeMsMax":"187","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.016058394160583942,"readMsAvg":"0","waitRatioAvg":8.587376556462001e-05,"completedParallelInputs":"18","computeRatioMax":0.0007728638900815801,"name":"S0B: Sort+","shuffleOutputBytes":"55142","recordsWritten":"856","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$131, $130, $132, $133, $70","FROM __stage0A_output"]},{"kind":"SORT","substeps":["$60 DESC, $140 ASC, $141 ASC, $142 ASC, $143 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $140 := $130, $141 := $131, $142 := $132, $143 := $133","$60 := SUM($70)"]},{"kind":"WRITE","substeps":["$150, $151, $152, $153, $154","TO __stage0B_output"]}],"writeRatioAvg":0.014340918849291541},{"readMsMax":"0","computeMsMax":"5","inputStages":["11"],"waitMsAvg":"1","id":"12","endMs":"1570992260516","waitMsMax":"1","startMs":"1570992260344","waitRatioMax":8.587376556462001e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"856","computeRatioAvg":0.00042936882782310007,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00042936882782310007,"readMsAvg":"0","waitRatioAvg":8.587376556462001e-05,"completedParallelInputs":"1","computeRatioMax":0.00042936882782310007,"name":"S0C: Output","shuffleOutputBytes":"6484","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$150, $151, $152, $153, $154","FROM __stage0B_output"]},{"kind":"SORT","substeps":["$154 DESC, $151 ASC, $150 ASC, $152 ASC, $153 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$160, $161, $162, $163, $164","TO __stage0C_output"]}],"writeRatioAvg":0.00042936882782310007}],"estimatedBytesProcessed":"10930380544","timeline":[{"totalSlotMs":"18197","activeUnits":"186","completedUnits":"3","elapsedMs":"775","pendingUnits":"186"},{"totalSlotMs":"201708","activeUnits":"185","completedUnits":"205","elapsedMs":"1802","pendingUnits":"184"},{"totalSlotMs":"685645","activeUnits":"82","completedUnits":"387","elapsedMs":"3571","pendingUnits":"2"},{"totalSlotMs":"687610","activeUnits":"2","completedUnits":"388","elapsedMs":"4209","pendingUnits":"1"},{"totalSlotMs":"690399","activeUnits":"3","completedUnits":"388","elapsedMs":"5632","pendingUnits":"1"},{"totalSlotMs":"714438","activeUnits":"0","completedUnits":"408","elapsedMs":"15920","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"10931404800","totalPartitionsProcessed":"0","totalBytesProcessed":"10930380544","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_100"}]},"endTime":"1570992260751"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query19_1570992242"},"etag":"Hyg9rgG7Yy1/xn/rDOLLpw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query19_1570992242?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon084ec3fe75c92353bb72d119719b6c99bbfe4f55","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query19\nSELECT i_brand_id brand_id, \n i_brand brand, \n i_manufact_id, \n i_manufact, \n Sum(ss_ext_sales_price) ext_price \nFROM date_dim, \n store_sales, \n item, \n customer, \n customer_address, \n store \nWHERE d_date_sk = ss_sold_date_sk \n AND ss_item_sk = i_item_sk \n AND i_manager_id = 38 \n AND d_moy = 12 \n AND d_year = 1998 \n AND ss_customer_sk = c_customer_sk \n AND c_current_addr_sk = ca_address_sk \n AND Substr(ca_zip, 1, 5) <> Substr(s_zip, 1, 5) \n AND ss_store_sk = s_store_sk \nGROUP BY i_brand, \n i_brand_id, \n i_manufact_id, \n i_manufact \nORDER BY ext_price DESC, \n i_brand, \n i_brand_id, \n i_manufact_id, \n i_manufact\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query19_1570992242","user_email":"nithish.sankaranarayanan@ulb.be"}
