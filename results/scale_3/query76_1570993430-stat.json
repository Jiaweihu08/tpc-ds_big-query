{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"261483","creationTime":"1570993432172","totalBytesProcessed":"15566266994","startTime":"1570993432370","query":{"totalSlotMs":"261483","queryPlan":[{"readMsMax":"10","computeMsMax":"43","waitMsAvg":"1","id":"0","endMs":"1570993432682","waitMsMax":"1","startMs":"1570993432607","waitRatioMax":0.0008771929824561404,"readRatioAvg":0.008771929824561403,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.037719298245614034,"writeMsAvg":"15","status":"COMPLETE","writeMsMax":"15","computeMsAvg":"43","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013157894736842105,"readMsAvg":"10","waitRatioAvg":0.0008771929824561404,"completedParallelInputs":"1","computeRatioMax":0.037719298245614034,"name":"S00: Input","shuffleOutputBytes":"1972323","recordsWritten":"73049","readRatioMax":0.008771929824561403,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_year, $22:d_qoy","FROM date_dim"]},{"kind":"WRITE","substeps":["$20, $21, $22","TO __stage00_output","BY HASH($20)"]}],"writeRatioAvg":0.013157894736842105},{"readMsMax":"114","computeMsMax":"76","waitMsAvg":"53","id":"2","endMs":"1570993432869","waitMsMax":"56","startMs":"1570993432686","waitRatioMax":0.04912280701754386,"readRatioAvg":0.03333333333333333,"parallelInputs":"141","recordsRead":"144010451","computeRatioAvg":0.054385964912280704,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"47","computeMsAvg":"62","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0412280701754386,"readMsAvg":"38","waitRatioAvg":0.04649122807017544,"completedParallelInputs":"141","computeRatioMax":0.06666666666666667,"name":"S02: Input","shuffleOutputBytes":"13694996","recordsWritten":"720812","readRatioMax":0.1,"steps":[{"kind":"READ","substeps":["$80:cs_sold_date_sk, $82:cs_item_sk, $83:cs_ext_sales_price, $81:cs_warehouse_sk","FROM catalog_sales","WHERE is_null($81)"]},{"kind":"WRITE","substeps":["$80, $82, $83","TO __stage02_output","BY HASH($82)"]}],"writeRatioAvg":0.005263157894736842},{"readMsMax":"14","computeMsMax":"56","waitMsAvg":"34","id":"3","endMs":"1570993432766","waitMsMax":"34","startMs":"1570993432692","waitRatioMax":0.02982456140350877,"readRatioAvg":0.012280701754385965,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.04912280701754386,"writeMsAvg":"15","status":"COMPLETE","writeMsMax":"15","computeMsAvg":"56","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013157894736842105,"readMsAvg":"14","waitRatioAvg":0.02982456140350877,"completedParallelInputs":"1","computeRatioMax":0.04912280701754386,"name":"S03: Input","shuffleOutputBytes":"1972323","recordsWritten":"73049","readRatioMax":0.012280701754385965,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $11:d_year, $12:d_qoy","FROM date_dim"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage03_output","BY HASH($10)"]}],"writeRatioAvg":0.013157894736842105},{"readMsMax":"131","computeMsMax":"58","waitMsAvg":"4","id":"5","endMs":"1570993432941","waitMsMax":"5","startMs":"1570993432695","waitRatioMax":0.0043859649122807015,"readRatioAvg":0.05350877192982456,"parallelInputs":"92","recordsRead":"70474075","computeRatioAvg":0.03508771929824561,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"51","computeMsAvg":"40","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04473684210526316,"readMsAvg":"61","waitRatioAvg":0.0035087719298245615,"completedParallelInputs":"92","computeRatioMax":0.05087719298245614,"name":"S05: Input","shuffleOutputBytes":"332404","recordsWritten":"17548","readRatioMax":0.11491228070175438,"steps":[{"kind":"READ","substeps":["$70:ws_sold_date_sk, $71:ws_item_sk, $73:ws_ext_sales_price, $72:ws_ship_hdemo_sk","FROM web_sales","WHERE is_null($72)"]},{"kind":"WRITE","substeps":["$70, $71, $73","TO __stage05_output","BY HASH($71)"]}],"writeRatioAvg":0.0043859649122807015},{"readMsMax":"23","computeMsMax":"56","waitMsAvg":"1","id":"6","endMs":"1570993432787","waitMsMax":"1","startMs":"1570993432709","waitRatioMax":0.0008771929824561404,"readRatioAvg":0.02017543859649123,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.04912280701754386,"writeMsAvg":"14","status":"COMPLETE","writeMsMax":"14","computeMsAvg":"56","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012280701754385965,"readMsAvg":"23","waitRatioAvg":0.0008771929824561404,"completedParallelInputs":"1","computeRatioMax":0.04912280701754386,"name":"S06: Input","shuffleOutputBytes":"1972323","recordsWritten":"73049","readRatioMax":0.02017543859649123,"steps":[{"kind":"READ","substeps":["$1:d_date_sk, $2:d_year, $3:d_qoy","FROM date_dim"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage06_output","BY HASH($1)"]}],"writeRatioAvg":0.012280701754385965},{"readMsMax":"23","computeMsMax":"157","waitMsAvg":"1","id":"7","endMs":"1570993433400","waitMsMax":"1","startMs":"1570993432724","waitRatioMax":0.0008771929824561404,"readRatioAvg":0.02017543859649123,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.13771929824561405,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"157","shuffleOutputBytesSpilled":"0","writeRatioMax":0.021052631578947368,"readMsAvg":"23","waitRatioAvg":0.0008771929824561404,"completedParallelInputs":"1","computeRatioMax":0.13771929824561405,"name":"S07: Input","shuffleOutputBytes":"4054040","recordsWritten":"204000","readRatioMax":0.02017543859649123,"steps":[{"kind":"READ","substeps":["$30:i_item_sk, $31:i_category","FROM item"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage07_output","BY HASH($30)"]}],"writeRatioAvg":0.021052631578947368},{"readMsMax":"0","computeMsMax":"19","inputStages":["2"],"waitMsAvg":"1","id":"9","endMs":"1570993434673","waitMsMax":"3","startMs":"1570993432878","waitRatioMax":0.002631578947368421,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"720812","computeRatioAvg":0.010526315789473684,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"60","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05263157894736842,"readMsAvg":"0","waitRatioAvg":0.0008771929824561404,"completedParallelInputs":"100","computeRatioMax":0.016666666666666666,"name":"S09: Coalesce","shuffleOutputBytes":"13694996","recordsWritten":"720812","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage02_output"]}],"writeRatioAvg":0.01929824561403509},{"readMsMax":"0","computeMsMax":"12","inputStages":["5"],"waitMsAvg":"2","id":"10","endMs":"1570993433307","waitMsMax":"7","startMs":"1570993433177","waitRatioMax":0.0061403508771929825,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"17548","computeRatioAvg":0.005263157894736842,"writeMsAvg":"35","status":"COMPLETE","writeMsMax":"62","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.054385964912280704,"readMsAvg":"0","waitRatioAvg":0.0017543859649122807,"completedParallelInputs":"100","computeRatioMax":0.010526315789473684,"name":"S0A: Coalesce","shuffleOutputBytes":"332404","recordsWritten":"17548","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage05_output"]}],"writeRatioAvg":0.03070175438596491},{"readMsMax":"88","computeMsMax":"1140","inputStages":["0","6","9","3","10","7"],"waitMsAvg":"2","id":"11","endMs":"1570993435178","waitMsMax":"4","startMs":"1570993433484","waitRatioMax":0.0035087719298245615,"readRatioAvg":0.028070175438596492,"parallelInputs":"186","recordsRead":"334142397","computeRatioAvg":0.3017543859649123,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"344","shuffleOutputBytesSpilled":"0","writeRatioMax":0.018421052631578946,"readMsAvg":"32","waitRatioAvg":0.0017543859649122807,"completedParallelInputs":"186","computeRatioMax":1,"name":"S0B: Join+","shuffleOutputBytes":"3070812","recordsWritten":"42637","readRatioMax":0.07719298245614035,"steps":[{"kind":"READ","substeps":["$60:ss_sold_date_sk, $61:ss_item_sk, $63:ss_ext_sales_price, $62:ss_hdemo_sk","FROM store_sales","WHERE is_null($62)"]},{"kind":"READ","substeps":["$30, $31","FROM __stage07_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage06_output"]},{"kind":"READ","substeps":["$40:i_item_sk, $41:i_category","FROM item","(1 similar table omitted)"]},{"kind":"READ","substeps":["$70, $71, $73","FROM __stage0A_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage03_output"]},{"kind":"READ","substeps":["$80, $82, $83","FROM __stage09_output"]},{"kind":"READ","substeps":["$20, $21, $22","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $210 := $110, $211 := $111, $212 := $112, $213 := $113, $214 := $114","$100 := COUNT_STAR()","$101 := SUM($115)"]},{"kind":"COMPUTE","substeps":["$120 := 'store'","$121 := 'ss_hdemo_sk'"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $150 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $61 = $30"]},{"kind":"COMPUTE","substeps":["$130 := 'web'","$131 := 'ws_ship_hdemo_sk'"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $170 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $71"]},{"kind":"COMPUTE","substeps":["$140 := 'catalog'","$141 := 'cs_warehouse_sk'"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $190 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $50 = $82"]},{"kind":"WRITE","substeps":["$100, $101, $210, $211, $212, $213, $214","TO __stage0B_output","BY HASH($210, $211, $212, $213, $214)"]}],"writeRatioAvg":0.0043859649122807015},{"readMsMax":"0","computeMsMax":"7","inputStages":["11"],"waitMsAvg":"1","id":"12","endMs":"1570993435376","waitMsMax":"5","startMs":"1570993435341","waitRatioMax":0.0043859649122807015,"readRatioAvg":0,"parallelInputs":"41","recordsRead":"42637","computeRatioAvg":0.0035087719298245615,"writeMsAvg":"2","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0043859649122807015,"readMsAvg":"0","waitRatioAvg":0.0008771929824561404,"completedParallelInputs":"41","computeRatioMax":0.0061403508771929825,"name":"S0C: Sort+","shuffleOutputBytes":"51497","recordsWritten":"687","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$100, $101, $210, $211, $212, $213, $214","FROM __stage0B_output"]},{"kind":"SORT","substeps":["$220 ASC, $221 ASC, $222 ASC, $223 ASC, $224 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $220 := $210, $221 := $211, $222 := $212, $223 := $213, $224 := $214","$90 := SUM_OF_COUNTS($100)","$91 := SUM($101)"]},{"kind":"WRITE","substeps":["$230, $231, $232, $233, $234, $235, $236","TO __stage0C_output"]}],"writeRatioAvg":0.0017543859649122807},{"readMsMax":"0","computeMsMax":"9","inputStages":["12"],"waitMsAvg":"1","id":"13","endMs":"1570993435459","waitMsMax":"1","startMs":"1570993435376","waitRatioMax":0.0008771929824561404,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"687","computeRatioAvg":0.007894736842105263,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008771929824561403,"readMsAvg":"0","waitRatioAvg":0.0008771929824561404,"completedParallelInputs":"1","computeRatioMax":0.007894736842105263,"name":"S0D: Output","shuffleOutputBytes":"7791","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$230, $231, $232, $233, $234, $235, $236","FROM __stage0C_output"]},{"kind":"SORT","substeps":["$232 ASC, $233 ASC, $234 ASC, $235 ASC, $236 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$240, $241, $242, $243, $244, $245, $246","TO __stage0D_output"]}],"writeRatioAvg":0.008771929824561403}],"estimatedBytesProcessed":"15566266994","timeline":[{"totalSlotMs":"72198","activeUnits":"89","completedUnits":"433","elapsedMs":"739","pendingUnits":"89"},{"totalSlotMs":"227213","activeUnits":"272","completedUnits":"552","elapsedMs":"1813","pendingUnits":"71"},{"totalSlotMs":"261483","activeUnits":"3","completedUnits":"665","elapsedMs":"3279","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"15567159296","totalPartitionsProcessed":"0","totalBytesProcessed":"15566266994","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_100"}]},"endTime":"1570993435683"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query76_1570993430"},"etag":"kUtvueHgxHNxqyuCNFlnsA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query76_1570993430?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonfefa5f7513b4ad9e0cea398a37bb798d2d7f1650","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query76\nSELECT channel, \n col_name, \n d_year, \n d_qoy, \n i_category, \n Count(*) sales_cnt, \n Sum(ext_sales_price) sales_amt \nFROM (SELECT 'store' AS channel, \n 'ss_hdemo_sk' col_name, \n d_year, \n d_qoy, \n i_category, \n ss_ext_sales_price ext_sales_price \n FROM store_sales, \n item, \n date_dim \n WHERE ss_hdemo_sk IS NULL \n AND ss_sold_date_sk = d_date_sk \n AND ss_item_sk = i_item_sk \n UNION ALL \n SELECT 'web' AS channel, \n 'ws_ship_hdemo_sk' col_name, \n d_year, \n d_qoy, \n i_category, \n ws_ext_sales_price ext_sales_price \n FROM web_sales, \n item, \n date_dim \n WHERE ws_ship_hdemo_sk IS NULL \n AND ws_sold_date_sk = d_date_sk \n AND ws_item_sk = i_item_sk \n UNION ALL \n SELECT 'catalog' AS channel, \n 'cs_warehouse_sk' col_name, \n d_year, \n d_qoy, \n i_category, \n cs_ext_sales_price ext_sales_price \n FROM catalog_sales, \n item, \n date_dim \n WHERE cs_warehouse_sk IS NULL \n AND cs_sold_date_sk = d_date_sk \n AND cs_item_sk = i_item_sk) foo \nGROUP BY channel, \n col_name, \n d_year, \n d_qoy, \n i_category \nORDER BY channel, \n col_name, \n d_year, \n d_qoy, \n i_category\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query76_1570993430","user_email":"nithish.sankaranarayanan@ulb.be"}
