{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"143122","creationTime":"1570993702453","totalBytesProcessed":"8726120699","startTime":"1570993702573","query":{"totalSlotMs":"143122","queryPlan":[{"readMsMax":"9","computeMsMax":"6","waitMsAvg":"1","id":"0","endMs":"1570993702793","waitMsMax":"1","startMs":"1570993702744","waitRatioMax":0.0011337868480725624,"readRatioAvg":0.01020408163265306,"parallelInputs":"1","recordsRead":"402","computeRatioAvg":0.006802721088435374,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.021541950113378686,"readMsAvg":"9","waitRatioAvg":0.0011337868480725624,"completedParallelInputs":"1","computeRatioMax":0.006802721088435374,"name":"S00: Input","shuffleOutputBytes":"11972","recordsWritten":"402","readRatioMax":0.01020408163265306,"steps":[{"kind":"READ","substeps":["$1:s_store_sk, $2:s_store_name, $3:s_company_name","FROM store"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.021541950113378686},{"readMsMax":"9","computeMsMax":"7","waitMsAvg":"17","id":"1","endMs":"1570993702869","waitMsMax":"17","startMs":"1570993702778","waitRatioMax":0.01927437641723356,"readRatioAvg":0.01020408163265306,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.007936507936507936,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.024943310657596373,"readMsAvg":"9","waitRatioAvg":0.01927437641723356,"completedParallelInputs":"1","computeRatioMax":0.007936507936507936,"name":"S01: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.01020408163265306,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $22:d_moy, $21:d_year","FROM date_dim","WHERE in($21, 2002)"]},{"kind":"WRITE","substeps":["$20, $22","TO __stage01_output","BY HASH($20)"]}],"writeRatioAvg":0.024943310657596373},{"readMsMax":"10","computeMsMax":"72","waitMsAvg":"21","id":"3","endMs":"1570993703041","waitMsMax":"21","startMs":"1570993702824","waitRatioMax":0.023809523809523808,"readRatioAvg":0.011337868480725623,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.08163265306122448,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"72","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009070294784580499,"readMsAvg":"10","waitRatioAvg":0.023809523809523808,"completedParallelInputs":"1","computeRatioMax":0.08163265306122448,"name":"S03: Input","shuffleOutputBytes":"999574","recordsWritten":"19100","readRatioMax":0.011337868480725623,"steps":[{"kind":"READ","substeps":["$30:i_item_sk, $31:i_brand, $32:i_class, $33:i_category","FROM item","WHERE or(and(in($33, 'Home', 'Men', 'Sports'), in($32, 'paint', 'accessories', 'fitness')), ...)"]},{"kind":"WRITE","substeps":["$30, $31, $32, $33","TO __stage03_output","BY HASH($30)"]}],"writeRatioAvg":0.009070294784580499},{"readMsMax":"120","computeMsMax":"882","inputStages":["0","1","3"],"waitMsAvg":"3","id":"4","endMs":"1570993703868","waitMsMax":"7","startMs":"1570993703122","waitRatioMax":0.007936507936507936,"readRatioAvg":0.03854875283446712,"parallelInputs":"184","recordsRead":"285528451","computeRatioAvg":0.7551020408163265,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"50","computeMsAvg":"666","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05668934240362812,"readMsAvg":"34","waitRatioAvg":0.003401360544217687,"completedParallelInputs":"184","computeRatioMax":1,"name":"S04: Join+","shuffleOutputBytes":"49157277","recordsWritten":"602628","readRatioMax":0.1360544217687075,"steps":[{"kind":"READ","substeps":["$10:ss_sold_date_sk, $11:ss_item_sk, $12:ss_store_sk, $13:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$30, $31, $32, $33","FROM __stage03_output"]},{"kind":"READ","substeps":["$20, $22","FROM __stage01_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $110 := $104, $111 := $103, $112 := $102, $113 := $105, $114 := $106, $115 := $101","$70 := SUM($100)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $90 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $83 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $11 = $30"]},{"kind":"WRITE","substeps":["$113, $114, $115, $112, $111, $110, $70","TO __stage04_output","BY HASH($110, $111, $112, $113, $114, $115)"]}],"writeRatioAvg":0.01020408163265306},{"readMsMax":"0","computeMsMax":"36","inputStages":["4"],"waitMsAvg":"2","id":"5","endMs":"1570993704063","waitMsMax":"5","startMs":"1570993703909","waitRatioMax":0.005668934240362812,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"602628","computeRatioAvg":0.036281179138321996,"writeMsAvg":"30","status":"COMPLETE","writeMsMax":"41","computeMsAvg":"32","shuffleOutputBytesSpilled":"0","writeRatioMax":0.046485260770975055,"readMsAvg":"0","waitRatioAvg":0.0022675736961451248,"completedParallelInputs":"18","computeRatioMax":0.04081632653061224,"name":"S05: Aggregate","shuffleOutputBytes":"408788","recordsWritten":"5162","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$113, $114, $115, $112, $111, $110, $70","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $120 := $110, $121 := $111, $122 := $112, $123 := $113, $124 := $114, $125 := $115","$60 := SUM($70)"]},{"kind":"WRITE","substeps":["$123, $124, $125, $122, $121, $120, $60","TO __stage05_output","BY HASH($120, $122, $123, $124)"]}],"writeRatioAvg":0.034013605442176874},{"readMsMax":"0","computeMsMax":"8","inputStages":["5"],"waitMsAvg":"3","id":"6","endMs":"1570993704264","waitMsMax":"4","startMs":"1570993704070","waitRatioMax":0.0045351473922902496,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"5162","computeRatioAvg":0.006802721088435374,"writeMsAvg":"134","status":"COMPLETE","writeMsMax":"182","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.20634920634920634,"readMsAvg":"0","waitRatioAvg":0.003401360544217687,"completedParallelInputs":"18","computeRatioMax":0.009070294784580499,"name":"S06: Sort+","shuffleOutputBytes":"179873","recordsWritten":"1800","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$123, $124, $125, $122, $121, $120, $60","FROM __stage05_output"]},{"kind":"SORT","substeps":["$40 ASC, $140 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$40 := subtract($146, $50)"]},{"kind":"FILTER","substeps":["greater(case_no_value(not_equal($50, 0), divide(abs(subtract($146, $50)), $50), NULL), 0.1)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$50 := AVG($136) OVER (PARTITION BY $135, $133, $130, $131 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)"]},{"kind":"SORT","substeps":["$120 ASC, $122 ASC, $123 ASC, $124 ASC"]},{"kind":"WRITE","substeps":["$150, $151, $152, $153, $154, $155, $156, $157, $158","TO __stage06_output"]}],"writeRatioAvg":0.15192743764172337},{"readMsMax":"0","computeMsMax":"9","inputStages":["6"],"waitMsAvg":"3","id":"7","endMs":"1570993704278","waitMsMax":"3","startMs":"1570993704132","waitRatioMax":0.003401360544217687,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1800","computeRatioAvg":0.01020408163265306,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007936507936507936,"readMsAvg":"0","waitRatioAvg":0.003401360544217687,"completedParallelInputs":"1","computeRatioMax":0.01020408163265306,"name":"S07: Output","shuffleOutputBytes":"9110","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$150, $151, $152, $153, $154, $155, $156, $157, $158","FROM __stage06_output"]},{"kind":"SORT","substeps":["$156 ASC, $150 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$160, $161, $162, $163, $164, $165, $166, $167","TO __stage07_output"]}],"writeRatioAvg":0.007936507936507936}],"estimatedBytesProcessed":"8726120699","timeline":[{"totalSlotMs":"19293","activeUnits":"184","completedUnits":"3","elapsedMs":"672","pendingUnits":"184"},{"totalSlotMs":"143122","activeUnits":"18","completedUnits":"224","elapsedMs":"1872","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"8726249472","totalPartitionsProcessed":"0","totalBytesProcessed":"8726120699","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_100"}]},"endTime":"1570993704471"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query89_1570993700"},"etag":"qeDlc74w7KrLqGvg+Rt+yA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query89_1570993700?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon36b9a1fe8d074d1a8816aa8ebc513997f776f624","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query89\nSELECT benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results scale_2.zip warmup \nFROM (SELECT i_category, \n i_class, \n i_brand, \n s_store_name, \n s_company_name, \n d_moy, \n Sum(ss_sales_price) sum_sales, \n Avg(Sum(ss_sales_price)) \n OVER ( \n partition BY i_category, i_brand, s_store_name, s_company_name \n ) \n avg_monthly_sales \n FROM item, \n store_sales, \n date_dim, \n store \n WHERE ss_item_sk = i_item_sk \n AND ss_sold_date_sk = d_date_sk \n AND ss_store_sk = s_store_sk \n AND d_year IN ( 2002 ) \n AND ( ( i_category IN ( 'Home', 'Men', 'Sports' ) \n AND i_class IN ( 'paint', 'accessories', 'fitness' ) ) \n OR ( i_category IN ( 'Shoes', 'Jewelry', 'Women' ) \n AND i_class IN ( 'mens', 'pendants', 'swimwear' ) ) ) \n GROUP BY i_category, \n i_class, \n i_brand, \n s_store_name, \n s_company_name, \n d_moy) tmp1 \nWHERE CASE \n WHEN ( avg_monthly_sales <> 0 ) THEN ( \n Abs(sum_sales - avg_monthly_sales) / avg_monthly_sales ) \n ELSE NULL \n END > 0.1 \nORDER BY sum_sales - avg_monthly_sales, \n s_store_name\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query89_1570993700","user_email":"nithish.sankaranarayanan@ulb.be"}
