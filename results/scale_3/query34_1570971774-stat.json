{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"26467","creationTime":"1570971775772","totalBytesProcessed":"1128285040","startTime":"1570971775973","query":{"totalSlotMs":"26467","queryPlan":[{"readMsMax":"21","computeMsMax":"9","waitMsAvg":"1","id":"0","endMs":"1570971776234","waitMsMax":"1","startMs":"1570971776146","waitRatioMax":0.000970873786407767,"readRatioAvg":0.020388349514563107,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.008737864077669903,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006796116504854369,"readMsAvg":"21","waitRatioAvg":0.000970873786407767,"completedParallelInputs":"1","computeRatioMax":0.008737864077669903,"name":"S00: Input","shuffleOutputBytes":"4680","recordsWritten":"520","readRatioMax":0.020388349514563107,"steps":[{"kind":"READ","substeps":["$10:hd_demo_sk, $11:hd_buy_potential, $12:hd_dep_count, $13:hd_vehicle_count","FROM household_demographics","WHERE and(or(equal($11, '>10000'), equal($11, 'unknown')), greater($13, 0), ...)"]},{"kind":"WRITE","substeps":["$10","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.006796116504854369},{"readMsMax":"43","computeMsMax":"9","waitMsAvg":"12","id":"1","endMs":"1570971776250","waitMsMax":"12","startMs":"1570971776190","waitRatioMax":0.011650485436893204,"readRatioAvg":0.04174757281553398,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.008737864077669903,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003883495145631068,"readMsAvg":"43","waitRatioAvg":0.011650485436893204,"completedParallelInputs":"1","computeRatioMax":0.008737864077669903,"name":"S01: Input","shuffleOutputBytes":"306","recordsWritten":"34","readRatioMax":0.04174757281553398,"steps":[{"kind":"READ","substeps":["$30:s_store_sk, $31:s_county","FROM store","WHERE in($31, 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County', ...)"]},{"kind":"WRITE","substeps":["$30","TO __stage01_output","BY HASH($30)"]}],"writeRatioAvg":0.003883495145631068},{"readMsMax":"10","computeMsMax":"8","waitMsAvg":"36","id":"2","endMs":"1570971776287","waitMsMax":"36","startMs":"1570971776232","waitRatioMax":0.03495145631067961,"readRatioAvg":0.009708737864077669,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.007766990291262136,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.019417475728155338,"readMsAvg":"10","waitRatioAvg":0.03495145631067961,"completedParallelInputs":"1","computeRatioMax":0.007766990291262136,"name":"S02: Input","shuffleOutputBytes":"2268","recordsWritten":"252","readRatioMax":0.009708737864077669,"steps":[{"kind":"READ","substeps":["$40:d_date_sk, $41:d_year, $42:d_dom","FROM date_dim","WHERE and(or(between($42, 1, 3), between($42, 25, 28)), in($41, 1999, 2000, 2001))"]},{"kind":"WRITE","substeps":["$40","TO __stage02_output","BY HASH($40)"]}],"writeRatioAvg":0.019417475728155338},{"readMsMax":"56","computeMsMax":"1030","inputStages":["0","1","2"],"waitMsAvg":"1","id":"4","endMs":"1570971776974","waitMsMax":"2","startMs":"1570971776311","waitRatioMax":0.001941747572815534,"readRatioAvg":0.038834951456310676,"parallelInputs":"10","recordsRead":"28810172","computeRatioAvg":0.8553398058252427,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"881","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005825242718446602,"readMsAvg":"40","waitRatioAvg":0.000970873786407767,"completedParallelInputs":"10","computeRatioMax":1,"name":"S04: Join+","shuffleOutputBytes":"1450158","recordsWritten":"53866","readRatioMax":0.05436893203883495,"steps":[{"kind":"READ","substeps":["$20:ss_sold_date_sk, $21:ss_customer_sk, $22:ss_hdemo_sk, $23:ss_store_sk, $24:ss_ticket_number","FROM store_sales"]},{"kind":"READ","substeps":["$40","FROM __stage02_output"]},{"kind":"READ","substeps":["$30","FROM __stage01_output"]},{"kind":"READ","substeps":["$10","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $100 := $91, $101 := $90","$60 := COUNT_STAR()"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $81 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $72 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $40"]},{"kind":"WRITE","substeps":["$101, $100, $60","TO __stage04_output","BY HASH($100, $101)"]}],"writeRatioAvg":0.003883495145631068},{"readMsMax":"0","computeMsMax":"31","inputStages":["4"],"waitMsAvg":"1","id":"6","endMs":"1570971777067","waitMsMax":"1","startMs":"1570971777021","waitRatioMax":0.000970873786407767,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"53866","computeRatioAvg":0.030097087378640777,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"31","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005825242718446602,"readMsAvg":"0","waitRatioAvg":0.000970873786407767,"completedParallelInputs":"1","computeRatioMax":0.030097087378640777,"name":"S06: Aggregate+","shuffleOutputBytes":"21033","recordsWritten":"779","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$101, $100, $60","FROM __stage04_output"]},{"kind":"FILTER","substeps":["between($50, 15, 20)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $110 := $100, $111 := $101","$50 := SUM_OF_COUNTS($60)"]},{"kind":"WRITE","substeps":["$50, $110, $111","TO __stage06_output","BY HASH($111)"]}],"writeRatioAvg":0.005825242718446602},{"readMsMax":"0","computeMsMax":"11","inputStages":["6"],"waitMsAvg":"1","id":"7","endMs":"1570971777287","waitMsMax":"4","startMs":"1570971777074","waitRatioMax":0.003883495145631068,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"779","computeRatioAvg":0.005825242718446602,"writeMsAvg":"104","status":"COMPLETE","writeMsMax":"144","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.13980582524271845,"readMsAvg":"0","waitRatioAvg":0.000970873786407767,"completedParallelInputs":"100","computeRatioMax":0.010679611650485437,"name":"S07: Coalesce","shuffleOutputBytes":"21033","recordsWritten":"779","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage06_output"]}],"writeRatioAvg":0.10097087378640776},{"readMsMax":"35","computeMsMax":"181","inputStages":["7"],"waitMsAvg":"1","id":"8","endMs":"1570971777410","waitMsMax":"1","startMs":"1570971777119","waitRatioMax":0.000970873786407767,"readRatioAvg":0.03398058252427184,"parallelInputs":"1","recordsRead":"500779","computeRatioAvg":0.17572815533980582,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"181","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005825242718446602,"readMsAvg":"35","waitRatioAvg":0.000970873786407767,"completedParallelInputs":"1","computeRatioMax":0.17572815533980582,"name":"S08: Join","shuffleOutputBytes":"41556","recordsWritten":"779","readRatioMax":0.03398058252427184,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_salutation, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag","FROM customer"]},{"kind":"READ","substeps":["$50, $110, $111","FROM __stage07_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $111"]},{"kind":"WRITE","substeps":["$122, $123, $124, $125, $120, $121","TO __stage08_output"]}],"writeRatioAvg":0.005825242718446602},{"readMsMax":"0","computeMsMax":"9","inputStages":["8"],"waitMsAvg":"1","id":"9","endMs":"1570971777652","waitMsMax":"1","startMs":"1570971777452","waitRatioMax":0.000970873786407767,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"779","computeRatioAvg":0.008737864077669903,"writeMsAvg":"37","status":"COMPLETE","writeMsMax":"37","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.035922330097087375,"readMsAvg":"0","waitRatioAvg":0.000970873786407767,"completedParallelInputs":"1","computeRatioMax":0.008737864077669903,"name":"S09: Output","shuffleOutputBytes":"41556","recordsWritten":"779","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$122, $123, $124, $125, $120, $121","FROM __stage08_output"]},{"kind":"SORT","substeps":["$124 ASC, $123 ASC, $122 ASC, $125 DESC"]},{"kind":"WRITE","substeps":["$130, $131, $132, $133, $134, $135","TO __stage09_output"]}],"writeRatioAvg":0.035922330097087375}],"estimatedBytesProcessed":"1128285040","timeline":[{"totalSlotMs":"3571","activeUnits":"10","completedUnits":"3","elapsedMs":"675","pendingUnits":"10"},{"totalSlotMs":"26467","activeUnits":"94","completedUnits":"116","elapsedMs":"1927","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"1129316352","totalPartitionsProcessed":"0","totalBytesProcessed":"1128285040","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570971777963"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query34_1570971774"},"etag":"0ZLTrsFqFHNFsOryHlwGDw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query34_1570971774?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon135b1e4ef20a1da777fe5b60d626ca1bc3b53821","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query34\nSELECT c_last_name, \n c_first_name, \n c_salutation, \n c_preferred_cust_flag, \n ss_ticket_number, \n cnt \nFROM (SELECT ss_ticket_number, \n ss_customer_sk, \n Count(*) cnt \n FROM store_sales, \n date_dim, \n store, \n household_demographics \n WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk \n AND store_sales.ss_store_sk = store.s_store_sk \n AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk \n AND ( date_dim.d_dom BETWEEN 1 AND 3 \n OR date_dim.d_dom BETWEEN 25 AND 28 ) \n AND ( household_demographics.hd_buy_potential = '>10000' \n OR household_demographics.hd_buy_potential = 'unknown' ) \n AND household_demographics.hd_vehicle_count > 0 \n AND ( CASE \n WHEN household_demographics.hd_vehicle_count > 0 THEN \n household_demographics.hd_dep_count / \n household_demographics.hd_vehicle_count \n ELSE NULL \n END ) > 1.2 \n AND date_dim.d_year IN ( 1999, 1999 + 1, 1999 + 2 ) \n AND store.s_county IN ( 'Williamson County', 'Williamson County', \n 'Williamson County', \n 'Williamson County' \n , \n 'Williamson County', 'Williamson County', \n 'Williamson County', \n 'Williamson County' \n ) \n GROUP BY ss_ticket_number, \n ss_customer_sk) dn, \n customer \nWHERE ss_customer_sk = c_customer_sk \n AND cnt BETWEEN 15 AND 20 \nORDER BY c_last_name, \n c_first_name, \n c_salutation, \n c_preferred_cust_flag DESC; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query34_1570971774","user_email":"nithish.sankaranarayanan@ulb.be"}
