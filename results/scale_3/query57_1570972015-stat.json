{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"194998","creationTime":"1570972016812","totalBytesProcessed":"464210055","startTime":"1570972017046","query":{"totalSlotMs":"194998","queryPlan":[{"readMsMax":"33","computeMsMax":"8","waitMsAvg":"1","id":"0","endMs":"1570972017479","waitMsMax":"1","startMs":"1570972017241","waitRatioMax":0.00025220680958385876,"readRatioAvg":0.00832282471626734,"parallelInputs":"1","recordsRead":"24","computeRatioAvg":0.00201765447667087,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0015132408575031526,"readMsAvg":"33","waitRatioAvg":0.00025220680958385876,"completedParallelInputs":"1","computeRatioMax":0.00201765447667087,"name":"S00: Input","shuffleOutputBytes":"654","recordsWritten":"24","readRatioMax":0.00832282471626734,"steps":[{"kind":"READ","substeps":["$80:cc_call_center_sk, $81:cc_name","FROM call_center"]},{"kind":"WRITE","substeps":["$80, $81","TO __stage00_output","BY HASH($80)"]}],"writeRatioAvg":0.0015132408575031526},{"readMsMax":"12","computeMsMax":"17","waitMsAvg":"30","id":"1","endMs":"1570972017504","waitMsMax":"30","startMs":"1570972017285","waitRatioMax":0.007566204287515763,"readRatioAvg":0.003026481715006305,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004287515762925599,"writeMsAvg":"187","status":"COMPLETE","writeMsMax":"187","computeMsAvg":"17","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04716267339218159,"readMsAvg":"12","waitRatioAvg":0.007566204287515763,"completedParallelInputs":"1","computeRatioMax":0.004287515762925599,"name":"S01: Input","shuffleOutputBytes":"11556","recordsWritten":"428","readRatioMax":0.003026481715006305,"steps":[{"kind":"READ","substeps":["$110:d_date_sk, $111:d_year, $112:d_moy","FROM date_dim","WHERE or(equal($111, 2000), and(equal($111, 1999), equal($112, 12)), and(equal($111, 2001), equal($112, 1)))"]},{"kind":"WRITE","substeps":["$110, $111, $112","TO __stage01_output","BY HASH($110)"]}],"writeRatioAvg":0.04716267339218159},{"readMsMax":"14","computeMsMax":"105","waitMsAvg":"42","id":"3","endMs":"1570972017674","waitMsMax":"42","startMs":"1570972017422","waitRatioMax":0.010592686002522068,"readRatioAvg":0.0035308953341740227,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.02648171500630517,"writeMsAvg":"168","status":"COMPLETE","writeMsMax":"168","computeMsAvg":"105","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04237074401008827,"readMsAvg":"14","waitRatioAvg":0.010592686002522068,"completedParallelInputs":"1","computeRatioMax":0.02648171500630517,"name":"S03: Input","shuffleOutputBytes":"4180043","recordsWritten":"102000","readRatioMax":0.0035308953341740227,"steps":[{"kind":"READ","substeps":["$90:i_item_sk, $91:i_brand, $92:i_category","FROM item"]},{"kind":"WRITE","substeps":["$90, $91, $92","TO __stage03_output","BY HASH($90)"]}],"writeRatioAvg":0.04237074401008827},{"readMsMax":"5","computeMsMax":"5","waitMsAvg":"66","id":"4","endMs":"1570972017668","waitMsMax":"66","startMs":"1570972017465","waitRatioMax":0.01664564943253468,"readRatioAvg":0.0012610340479192938,"parallelInputs":"1","recordsRead":"24","computeRatioAvg":0.0012610340479192938,"writeMsAvg":"188","status":"COMPLETE","writeMsMax":"188","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04741488020176545,"readMsAvg":"5","waitRatioAvg":0.01664564943253468,"completedParallelInputs":"1","computeRatioMax":0.0012610340479192938,"name":"S04: Input","shuffleOutputBytes":"654","recordsWritten":"24","readRatioMax":0.0012610340479192938,"steps":[{"kind":"READ","substeps":["$10:cc_call_center_sk, $11:cc_name","FROM call_center"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage04_output","BY HASH($10)"]}],"writeRatioAvg":0.04741488020176545},{"readMsMax":"10","computeMsMax":"24","waitMsAvg":"57","id":"5","endMs":"1570972017760","waitMsMax":"57","startMs":"1570972017477","waitRatioMax":0.01437578814627995,"readRatioAvg":0.0025220680958385876,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.00605296343001261,"writeMsAvg":"64","status":"COMPLETE","writeMsMax":"64","computeMsAvg":"24","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01614123581336696,"readMsAvg":"10","waitRatioAvg":0.01437578814627995,"completedParallelInputs":"1","computeRatioMax":0.00605296343001261,"name":"S05: Input","shuffleOutputBytes":"11556","recordsWritten":"428","readRatioMax":0.0025220680958385876,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_year, $72:d_moy","FROM date_dim","WHERE or(equal($71, 2000), and(equal($71, 1999), equal($72, 12)), and(equal($71, 2001), equal($72, 1)))"]},{"kind":"WRITE","substeps":["$70, $71, $72","TO __stage05_output","BY HASH($70)"]}],"writeRatioAvg":0.01614123581336696},{"readMsMax":"12","computeMsMax":"97","waitMsAvg":"72","id":"7","endMs":"1570972017723","waitMsMax":"72","startMs":"1570972017624","waitRatioMax":0.01815889029003783,"readRatioAvg":0.003026481715006305,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.0244640605296343,"writeMsAvg":"34","status":"COMPLETE","writeMsMax":"34","computeMsAvg":"97","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008575031525851198,"readMsAvg":"12","waitRatioAvg":0.01815889029003783,"completedParallelInputs":"1","computeRatioMax":0.0244640605296343,"name":"S07: Input","shuffleOutputBytes":"4180043","recordsWritten":"102000","readRatioMax":0.003026481715006305,"steps":[{"kind":"READ","substeps":["$50:i_item_sk, $51:i_brand, $52:i_category","FROM item"]},{"kind":"WRITE","substeps":["$50, $51, $52","TO __stage07_output","BY HASH($50)"]}],"writeRatioAvg":0.008575031525851198},{"readMsMax":"6","computeMsMax":"8","waitMsAvg":"54","id":"8","endMs":"1570972017749","waitMsMax":"54","startMs":"1570972017624","waitRatioMax":0.013619167717528373,"readRatioAvg":0.0015132408575031526,"parallelInputs":"1","recordsRead":"24","computeRatioAvg":0.00201765447667087,"writeMsAvg":"57","status":"COMPLETE","writeMsMax":"57","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01437578814627995,"readMsAvg":"6","waitRatioAvg":0.013619167717528373,"completedParallelInputs":"1","computeRatioMax":0.00201765447667087,"name":"S08: Input","shuffleOutputBytes":"654","recordsWritten":"24","readRatioMax":0.0015132408575031526,"steps":[{"kind":"READ","substeps":["$1:cc_call_center_sk, $2:cc_name","FROM call_center"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage08_output","BY HASH($1)"]}],"writeRatioAvg":0.01437578814627995},{"readMsMax":"19","computeMsMax":"21","waitMsAvg":"1","id":"9","endMs":"1570972017731","waitMsMax":"1","startMs":"1570972017665","waitRatioMax":0.00025220680958385876,"readRatioAvg":0.0047919293820933165,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.005296343001261034,"writeMsAvg":"13","status":"COMPLETE","writeMsMax":"13","computeMsAvg":"21","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003278688524590164,"readMsAvg":"19","waitRatioAvg":0.00025220680958385876,"completedParallelInputs":"1","computeRatioMax":0.005296343001261034,"name":"S09: Input","shuffleOutputBytes":"11556","recordsWritten":"428","readRatioMax":0.0047919293820933165,"steps":[{"kind":"READ","substeps":["$40:d_date_sk, $41:d_year, $42:d_moy","FROM date_dim","WHERE or(equal($41, 2000), and(equal($41, 1999), equal($42, 12)), and(equal($41, 2001), equal($42, 1)))"]},{"kind":"WRITE","substeps":["$40, $41, $42","TO __stage09_output","BY HASH($40)"]}],"writeRatioAvg":0.003278688524590164},{"readMsMax":"10","computeMsMax":"103","waitMsAvg":"1","id":"11","endMs":"1570972017929","waitMsMax":"1","startMs":"1570972017705","waitRatioMax":0.00025220680958385876,"readRatioAvg":0.0025220680958385876,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.025977301387137452,"writeMsAvg":"148","status":"COMPLETE","writeMsMax":"148","computeMsAvg":"103","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0373266078184111,"readMsAvg":"10","waitRatioAvg":0.00025220680958385876,"completedParallelInputs":"1","computeRatioMax":0.025977301387137452,"name":"S0B: Input","shuffleOutputBytes":"4180043","recordsWritten":"102000","readRatioMax":0.0025220680958385876,"steps":[{"kind":"READ","substeps":["$20:i_item_sk, $21:i_brand, $22:i_category","FROM item"]},{"kind":"WRITE","substeps":["$20, $21, $22","TO __stage0B_output","BY HASH($20)"]}],"writeRatioAvg":0.0373266078184111},{"readMsMax":"44","computeMsMax":"3599","inputStages":["0","1","3"],"waitMsAvg":"1","id":"12","endMs":"1570972019709","waitMsMax":"2","startMs":"1570972017725","waitRatioMax":0.0005044136191677175,"readRatioAvg":0.008575031525851198,"parallelInputs":"8","recordsRead":"15216939","computeRatioAvg":0.7656998738965952,"writeMsAvg":"58","status":"COMPLETE","writeMsMax":"238","computeMsAvg":"3036","shuffleOutputBytesSpilled":"0","writeRatioMax":0.060025220680958384,"readMsAvg":"34","waitRatioAvg":0.00025220680958385876,"completedParallelInputs":"8","computeRatioMax":0.9076923076923077,"name":"S0C: Join+","shuffleOutputBytes":"62250942","recordsWritten":"798515","readRatioMax":0.011097099621689786,"steps":[{"kind":"READ","substeps":["$100:cs_sold_date_sk, $101:cs_call_center_sk, $102:cs_item_sk, $103:cs_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$90, $91, $92","FROM __stage03_output"]},{"kind":"READ","substeps":["$110, $111, $112","FROM __stage01_output"]},{"kind":"READ","substeps":["$80, $81","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $290 := $281, $291 := $280, $292 := $285, $293 := $283, $294 := $284","$240 := SUM($282)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $272 = $80"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $252 = $110"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $102 = $90"]},{"kind":"WRITE","substeps":["$292, $291, $290, $293, $294, $240","TO __stage0C_output","BY HASH($290, $291, $292, $293, $294)"]}],"writeRatioAvg":0.014627994955863808},{"readMsMax":"62","computeMsMax":"3561","inputStages":["4","5","7"],"waitMsAvg":"4","id":"14","endMs":"1570972020387","waitMsMax":"4","startMs":"1570972017881","waitRatioMax":0.001008827238335435,"readRatioAvg":0.01008827238335435,"parallelInputs":"8","recordsRead":"15216939","computeRatioAvg":0.8045397225725095,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"49","computeMsAvg":"3190","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01235813366960908,"readMsAvg":"40","waitRatioAvg":0.001008827238335435,"completedParallelInputs":"8","computeRatioMax":0.898108448928121,"name":"S0E: Join+","shuffleOutputBytes":"62250942","recordsWritten":"798515","readRatioMax":0.015636822194199245,"steps":[{"kind":"READ","substeps":["$60:cs_sold_date_sk, $61:cs_call_center_sk, $62:cs_item_sk, $63:cs_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$50, $51, $52","FROM __stage07_output"]},{"kind":"READ","substeps":["$70, $71, $72","FROM __stage05_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $390 := $381, $391 := $380, $392 := $385, $393 := $383, $394 := $384","$220 := SUM($382)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $372 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $352 = $70"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $62 = $50"]},{"kind":"WRITE","substeps":["$392, $391, $390, $393, $394, $220","TO __stage0E_output","BY HASH($390, $391, $392, $393, $394)"]}],"writeRatioAvg":0.005800756620428752},{"readMsMax":"46","computeMsMax":"3965","inputStages":["8","9","11"],"waitMsAvg":"1","id":"15","endMs":"1570972020130","waitMsMax":"3","startMs":"1570972018038","waitRatioMax":0.0007566204287515763,"readRatioAvg":0.009331651954602775,"parallelInputs":"8","recordsRead":"15216939","computeRatioAvg":0.8332912988650694,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"36","computeMsAvg":"3304","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009079445145018916,"readMsAvg":"37","waitRatioAvg":0.00025220680958385876,"completedParallelInputs":"8","computeRatioMax":1,"name":"S0F: Join+","shuffleOutputBytes":"62250942","recordsWritten":"798515","readRatioMax":0.011601513240857503,"steps":[{"kind":"READ","substeps":["$30:cs_sold_date_sk, $31:cs_call_center_sk, $32:cs_item_sk, $33:cs_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$20, $21, $22","FROM __stage0B_output"]},{"kind":"READ","substeps":["$40, $41, $42","FROM __stage09_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $480 := $471, $481 := $470, $482 := $475, $483 := $473, $484 := $474","$210 := SUM($472)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $462 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $442 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $32 = $20"]},{"kind":"WRITE","substeps":["$482, $481, $480, $483, $484, $210","TO __stage0F_output","BY HASH($480, $481, $482, $483, $484)"]}],"writeRatioAvg":0.006305170239596469},{"readMsMax":"0","computeMsMax":"1815","inputStages":["12"],"waitMsAvg":"1","id":"16","endMs":"1570972020702","waitMsMax":"1","startMs":"1570972019742","waitRatioMax":0.00025220680958385876,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"798515","computeRatioAvg":0.45775535939470363,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"25","computeMsAvg":"1815","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006305170239596469,"readMsAvg":"0","waitRatioAvg":0.00025220680958385876,"completedParallelInputs":"1","computeRatioMax":0.45775535939470363,"name":"S10: Aggregate","shuffleOutputBytes":"11359400","recordsWritten":"145195","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$292, $291, $290, $293, $294, $240","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $300 := $290, $301 := $291, $302 := $292, $303 := $293, $304 := $294","$230 := SUM($240)"]},{"kind":"WRITE","substeps":["$302, $301, $300, $303, $304, $230","TO __stage10_output","BY HASH($300, $301, $302, $303)"]}],"writeRatioAvg":0.006305170239596469},{"readMsMax":"0","computeMsMax":"1968","inputStages":["15"],"waitMsAvg":"1","id":"17","endMs":"1570972021274","waitMsMax":"1","startMs":"1570972020188","waitRatioMax":0.00025220680958385876,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"798515","computeRatioAvg":0.49634300126103403,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"1968","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007313997477931904,"readMsAvg":"0","waitRatioAvg":0.00025220680958385876,"completedParallelInputs":"1","computeRatioMax":0.49634300126103403,"name":"S11: Aggregate","shuffleOutputBytes":"11359400","recordsWritten":"145195","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$482, $481, $480, $483, $484, $210","FROM __stage0F_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $490 := $480, $491 := $481, $492 := $482, $493 := $483, $494 := $484","$180 := SUM($210)"]},{"kind":"WRITE","substeps":["$492, $491, $490, $493, $494, $180","TO __stage11_output","BY HASH($490, $491, $492)"]}],"writeRatioAvg":0.007313997477931904},{"readMsMax":"0","computeMsMax":"1905","inputStages":["14"],"waitMsAvg":"1","id":"18","endMs":"1570972023771","waitMsMax":"1","startMs":"1570972020483","waitRatioMax":0.00025220680958385876,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"798515","computeRatioAvg":0.48045397225725095,"writeMsAvg":"2323","status":"COMPLETE","writeMsMax":"2323","computeMsAvg":"1905","shuffleOutputBytesSpilled":"0","writeRatioMax":0.5858764186633039,"readMsAvg":"0","waitRatioAvg":0.00025220680958385876,"completedParallelInputs":"1","computeRatioMax":0.48045397225725095,"name":"S12: Aggregate","shuffleOutputBytes":"11359400","recordsWritten":"145195","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$392, $391, $390, $393, $394, $220","FROM __stage0E_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $400 := $390, $401 := $391, $402 := $392, $403 := $393, $404 := $394","$200 := SUM($220)"]},{"kind":"WRITE","substeps":["$402, $401, $400, $403, $404, $200","TO __stage12_output","BY HASH($400, $401, $402)"]}],"writeRatioAvg":0.5858764186633039},{"readMsMax":"0","computeMsMax":"1208","inputStages":["16"],"waitMsAvg":"2","id":"19","endMs":"1570972021562","waitMsMax":"2","startMs":"1570972020913","waitRatioMax":0.0005044136191677175,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"145195","computeRatioAvg":0.3046658259773014,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"26","computeMsAvg":"1208","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006557377049180328,"readMsAvg":"0","waitRatioAvg":0.0005044136191677175,"completedParallelInputs":"1","computeRatioMax":0.3046658259773014,"name":"S13: Sort+","shuffleOutputBytes":"12666147","recordsWritten":"145195","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$302, $301, $300, $303, $304, $230","FROM __stage10_output"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$190 := AVG($315) OVER (PARTITION BY $312, $311, $310, $313 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)"]},{"kind":"SORT","substeps":["$300 ASC, $301 ASC, $302 ASC, $303 ASC"]},{"kind":"WRITE","substeps":["$320, $321, $322, $323, $324, $190, $325","TO __stage13_output","BY HASH($322, $321, $320)"]}],"writeRatioAvg":0.006557377049180328},{"readMsMax":"0","computeMsMax":"1074","inputStages":["17"],"waitMsAvg":"3","id":"20","endMs":"1570972025628","waitMsMax":"3","startMs":"1570972024528","waitRatioMax":0.0007566204287515763,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"145195","computeRatioAvg":0.27087011349306434,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"25","computeMsAvg":"1074","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006305170239596469,"readMsAvg":"0","waitRatioAvg":0.0007566204287515763,"completedParallelInputs":"1","computeRatioMax":0.27087011349306434,"name":"S14: Sort+","shuffleOutputBytes":"9777560","recordsWritten":"140188","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$492, $491, $490, $493, $494, $180","FROM __stage11_output"]},{"kind":"COMPUTE","substeps":["$130 := subtract($150, 1)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$150 := RANK() OVER (PARTITION BY $502, $501, $500 ORDER BY $503 ASC, $504 ASC)"]},{"kind":"SORT","substeps":["$490 ASC, $491 ASC, $492 ASC, $493 ASC, $494 ASC"]},{"kind":"WRITE","substeps":["$130, $510, $511, $512, $513","TO __stage14_output","BY HASH($512, $511, $510, $130)"]}],"writeRatioAvg":0.006305170239596469},{"readMsMax":"0","computeMsMax":"496","inputStages":["19"],"waitMsAvg":"9","id":"22","endMs":"1570972025628","waitMsMax":"9","startMs":"1570972024620","waitRatioMax":0.002269861286254729,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"145195","computeRatioAvg":0.12509457755359396,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"496","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006809583858764187,"readMsAvg":"0","waitRatioAvg":0.002269861286254729,"completedParallelInputs":"1","computeRatioMax":0.12509457755359396,"name":"S16: Sort+","shuffleOutputBytes":"9814312","recordsWritten":"111949","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$320, $321, $322, $323, $324, $190, $325","FROM __stage13_output"]},{"kind":"FILTER","substeps":["and(equal($343, 2000), greater($344, 0), ...)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$160 := RANK() OVER (PARTITION BY $332, $331, $330 ORDER BY $333 ASC, $334 ASC)"]},{"kind":"SORT","substeps":["$322 ASC, $321 ASC, $320 ASC, $323 ASC, $324 ASC"]},{"kind":"WRITE","substeps":["$160, $340, $341, $342, $343, $344, $345","TO __stage16_output","BY HASH($342, $341, $340, $160)"]}],"writeRatioAvg":0.006809583858764187},{"readMsMax":"0","computeMsMax":"11","inputStages":["22"],"waitMsAvg":"1","id":"23","endMs":"1570972026037","waitMsMax":"4","startMs":"1570972025633","waitRatioMax":0.001008827238335435,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"111949","computeRatioAvg":0.0017654476670870113,"writeMsAvg":"176","status":"COMPLETE","writeMsMax":"207","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05220680958385877,"readMsAvg":"0","waitRatioAvg":0.00025220680958385876,"completedParallelInputs":"100","computeRatioMax":0.0027742749054224464,"name":"S17: Coalesce","shuffleOutputBytes":"9814312","recordsWritten":"111949","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage16_output"]}],"writeRatioAvg":0.04438839848675914},{"readMsMax":"0","computeMsMax":"12","inputStages":["20"],"waitMsAvg":"5","id":"24","endMs":"1570972026018","waitMsMax":"7","startMs":"1570972025635","waitRatioMax":0.0017654476670870113,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"140188","computeRatioAvg":0.0017654476670870113,"writeMsAvg":"160","status":"COMPLETE","writeMsMax":"203","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05119798234552333,"readMsAvg":"0","waitRatioAvg":0.0012610340479192938,"completedParallelInputs":"100","computeRatioMax":0.003026481715006305,"name":"S18: Coalesce","shuffleOutputBytes":"9777560","recordsWritten":"140188","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage14_output"]}],"writeRatioAvg":0.0403530895334174},{"readMsMax":"0","computeMsMax":"1273","inputStages":["18","24","23"],"waitMsAvg":"7","id":"25","endMs":"1570972038427","waitMsMax":"7","startMs":"1570972025645","waitRatioMax":0.0017654476670870113,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"397332","computeRatioAvg":0.3210592686002522,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"1273","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001008827238335435,"readMsAvg":"0","waitRatioAvg":0.0017654476670870113,"completedParallelInputs":"1","computeRatioMax":0.3210592686002522,"name":"S19: Join+","shuffleOutputBytes":"7561","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$402, $401, $400, $403, $404, $200","FROM __stage12_output"]},{"kind":"READ","substeps":["$160, $340, $341, $342, $343, $344, $345","FROM __stage17_output"]},{"kind":"READ","substeps":["$130, $510, $511, $512, $513","FROM __stage18_output"]},{"kind":"SORT","substeps":["$120 ASC, $522 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$120 := subtract($524, $522)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $432 = $512, $431 = $511, $430 = $510, $434 = $130"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $422 = $342, $421 = $341, $420 = $340, $140 = $160"]},{"kind":"COMPUTE","substeps":["$140 := add($170, 1)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$170 := RANK() OVER (PARTITION BY $412, $411, $410 ORDER BY $413 ASC, $414 ASC)"]},{"kind":"SORT","substeps":["$400 ASC, $401 ASC, $402 ASC, $403 ASC, $404 ASC"]},{"kind":"WRITE","substeps":["$530, $531, $532, $533, $534, $535, $536","TO __stage19_output"]}],"writeRatioAvg":0.001008827238335435},{"readMsMax":"0","computeMsMax":"6","inputStages":["25"],"waitMsAvg":"2","id":"26","endMs":"1570972039527","waitMsMax":"2","startMs":"1570972025742","waitRatioMax":0.0005044136191677175,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0015132408575031526,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0015132408575031526,"readMsAvg":"0","waitRatioAvg":0.0005044136191677175,"completedParallelInputs":"1","computeRatioMax":0.0015132408575031526,"name":"S1A: Output","shuffleOutputBytes":"6661","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$530, $531, $532, $533, $534, $535, $536","FROM __stage19_output"]},{"kind":"SORT","substeps":["$532 ASC, $534 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$540, $541, $542, $543, $544, $545","TO __stage1A_output"]}],"writeRatioAvg":0.0015132408575031526}],"estimatedBytesProcessed":"464210055","timeline":[{"totalSlotMs":"2538","activeUnits":"19","completedUnits":"6","elapsedMs":"699","pendingUnits":"27"},{"totalSlotMs":"9599","activeUnits":"24","completedUnits":"9","elapsedMs":"1208","pendingUnits":"24"},{"totalSlotMs":"93093","activeUnits":"11","completedUnits":"32","elapsedMs":"3308","pendingUnits":"3"},{"totalSlotMs":"98591","activeUnits":"2","completedUnits":"35","elapsedMs":"4372","pendingUnits":"2"},{"totalSlotMs":"100552","activeUnits":"1","completedUnits":"36","elapsedMs":"5021","pendingUnits":"1"},{"totalSlotMs":"102353","activeUnits":"0","completedUnits":"37","elapsedMs":"7229","pendingUnits":"0"},{"totalSlotMs":"171157","activeUnits":"2","completedUnits":"239","elapsedMs":"9092","pendingUnits":"2"},{"totalSlotMs":"194529","activeUnits":"1","completedUnits":"240","elapsedMs":"21887","pendingUnits":"1"},{"totalSlotMs":"194998","activeUnits":"0","completedUnits":"241","elapsedMs":"23225","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"464519168","totalPartitionsProcessed":"0","totalBytesProcessed":"464210055","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"call_center","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_10"}]},"endTime":"1570972040316"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query57_1570972015"},"etag":"u3C2gIA8z18wl4Se1+9oEQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query57_1570972015?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon753346639e2e0fa6043fd333404e5166ac747454","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query57\nWITH v1 \n AS (SELECT i_category, \n i_brand, \n cc_name, \n d_year, \n d_moy, \n Sum(cs_sales_price) sum_sales \n , \n Avg(Sum(cs_sales_price)) \n OVER ( \n partition BY i_category, i_brand, cc_name, d_year) \n avg_monthly_sales \n , \n Rank() \n OVER ( \n partition BY i_category, i_brand, cc_name \n ORDER BY d_year, d_moy) rn \n FROM item, \n catalog_sales, \n date_dim, \n call_center \n WHERE cs_item_sk = i_item_sk \n AND cs_sold_date_sk = d_date_sk \n AND cc_call_center_sk = cs_call_center_sk \n AND ( d_year = 2000 \n OR ( d_year = 2000 - 1 \n AND d_moy = 12 ) \n OR ( d_year = 2000 + 1 \n AND d_moy = 1 ) ) \n GROUP BY i_category, \n i_brand, \n cc_name, \n d_year, \n d_moy), \n v2 \n AS (SELECT v1.i_brand, \n v1.d_year, \n v1.avg_monthly_sales, \n v1.sum_sales, \n v1_lag.sum_sales psum, \n v1_lead.sum_sales nsum \n FROM v1, \n v1 v1_lag, \n v1 v1_lead \n WHERE v1.i_category = v1_lag.i_category \n AND v1.i_category = v1_lead.i_category \n AND v1.i_brand = v1_lag.i_brand \n AND v1.i_brand = v1_lead.i_brand \n AND v1. cc_name = v1_lag. cc_name \n AND v1. cc_name = v1_lead. cc_name \n AND v1.rn = v1_lag.rn + 1 \n AND v1.rn = v1_lead.rn - 1) \nSELECT benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results warmup \nFROM v2 \nWHERE d_year = 2000 \n AND avg_monthly_sales > 0 \n AND CASE \n WHEN avg_monthly_sales > 0 THEN Abs(sum_sales - avg_monthly_sales) \n / \n avg_monthly_sales \n ELSE NULL \n END > 0.1 \nORDER BY sum_sales - avg_monthly_sales, \n 3\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query57_1570972015","user_email":"nithish.sankaranarayanan@ulb.be"}
