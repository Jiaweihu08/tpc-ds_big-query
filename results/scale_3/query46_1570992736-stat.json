{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"470582","creationTime":"1570992738798","totalBytesProcessed":"17412851865","startTime":"1570992738928","query":{"totalSlotMs":"470582","queryPlan":[{"readMsMax":"20","computeMsMax":"995","waitMsAvg":"1","id":"0","endMs":"1570992739648","waitMsMax":"1","startMs":"1570992739111","waitRatioMax":0.00045413260672116256,"readRatioAvg":0.009082652134423252,"parallelInputs":"1","recordsRead":"1000000","computeRatioAvg":0.4518619436875568,"writeMsAvg":"46","status":"COMPLETE","writeMsMax":"46","computeMsAvg":"995","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02089009990917348,"readMsAvg":"20","waitRatioAvg":0.00045413260672116256,"completedParallelInputs":"1","computeRatioMax":0.4518619436875568,"name":"S00: Input","shuffleOutputBytes":"22561984","recordsWritten":"1000000","readRatioMax":0.009082652134423252,"steps":[{"kind":"READ","substeps":["$20:ca_address_sk, $21:ca_city","FROM customer_address"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage00_output","BY HASH($20)"]}],"writeRatioAvg":0.02089009990917348},{"readMsMax":"47","computeMsMax":"9","waitMsAvg":"15","id":"1","endMs":"1570992739211","waitMsMax":"15","startMs":"1570992739145","waitRatioMax":0.006811989100817439,"readRatioAvg":0.02134423251589464,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.004087193460490463,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0027247956403269754,"readMsAvg":"47","waitRatioAvg":0.006811989100817439,"completedParallelInputs":"1","computeRatioMax":0.004087193460490463,"name":"S01: Input","shuffleOutputBytes":"16200","recordsWritten":"1800","readRatioMax":0.02134423251589464,"steps":[{"kind":"READ","substeps":["$30:hd_demo_sk, $31:hd_dep_count, $32:hd_vehicle_count","FROM household_demographics","WHERE or(equal($31, 6), equal($32, 0))"]},{"kind":"WRITE","substeps":["$30","TO __stage01_output","BY HASH($30)"]}],"writeRatioAvg":0.0027247956403269754},{"readMsMax":"64","computeMsMax":"6","waitMsAvg":"43","id":"2","endMs":"1570992739271","waitMsMax":"43","startMs":"1570992739188","waitRatioMax":0.01952770208900999,"readRatioAvg":0.029064486830154404,"parallelInputs":"1","recordsRead":"402","computeRatioAvg":0.0027247956403269754,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0036330608537693005,"readMsAvg":"64","waitRatioAvg":0.01952770208900999,"completedParallelInputs":"1","computeRatioMax":0.0027247956403269754,"name":"S02: Input","shuffleOutputBytes":"333","recordsWritten":"37","readRatioMax":0.029064486830154404,"steps":[{"kind":"READ","substeps":["$50:s_store_sk, $51:s_city","FROM store","WHERE in($51, 'Midway', 'Fairview', 'Fairview', 'Fairview', 'Fairview')"]},{"kind":"WRITE","substeps":["$50","TO __stage02_output","BY HASH($50)"]}],"writeRatioAvg":0.0036330608537693005},{"readMsMax":"16","computeMsMax":"13","waitMsAvg":"51","id":"3","endMs":"1570992739298","waitMsMax":"51","startMs":"1570992739212","waitRatioMax":0.02316076294277929,"readRatioAvg":0.007266121707538601,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.005903723887375113,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0036330608537693005,"readMsAvg":"16","waitRatioAvg":0.02316076294277929,"completedParallelInputs":"1","computeRatioMax":0.005903723887375113,"name":"S03: Input","shuffleOutputBytes":"2826","recordsWritten":"314","readRatioMax":0.007266121707538601,"steps":[{"kind":"READ","substeps":["$60:d_date_sk, $61:d_year, $62:d_dow","FROM date_dim","WHERE and(in($62, 6, 0), in($61, 2000, 2001, 2002))"]},{"kind":"WRITE","substeps":["$60","TO __stage03_output","BY HASH($60)"]}],"writeRatioAvg":0.0036330608537693005},{"readMsMax":"0","computeMsMax":"25","inputStages":["0"],"waitMsAvg":"1","id":"6","endMs":"1570992740205","waitMsMax":"3","startMs":"1570992739799","waitRatioMax":0.0013623978201634877,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1000000","computeRatioAvg":0.005449591280653951,"writeMsAvg":"145","status":"COMPLETE","writeMsMax":"197","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08946412352406903,"readMsAvg":"0","waitRatioAvg":0.00045413260672116256,"completedParallelInputs":"100","computeRatioMax":0.011353315168029064,"name":"S06: Coalesce","shuffleOutputBytes":"22561984","recordsWritten":"1000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage00_output"]}],"writeRatioAvg":0.06584922797456857},{"readMsMax":"226","computeMsMax":"2202","inputStages":["6","1","2","3"],"waitMsAvg":"5","id":"7","endMs":"1570992741491","waitMsMax":"9","startMs":"1570992739860","waitRatioMax":0.004087193460490463,"readRatioAvg":0.022252497729336965,"parallelInputs":"184","recordsRead":"466268707","computeRatioAvg":0.7702089009990918,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"143","computeMsAvg":"1696","shuffleOutputBytesSpilled":"0","writeRatioMax":0.06494096276112625,"readMsAvg":"49","waitRatioAvg":0.002270663033605813,"completedParallelInputs":"184","computeRatioMax":1,"name":"S07: Join+","shuffleOutputBytes":"5200888","recordsWritten":"89563","readRatioMax":0.10263396911898275,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_hdemo_sk, $43:ss_addr_sk, $44:ss_store_sk, $45:ss_ticket_number, $46:ss_coupon_amt, $47:ss_net_profit","FROM store_sales"]},{"kind":"READ","substeps":["$60","FROM __stage03_output"]},{"kind":"READ","substeps":["$50","FROM __stage02_output"]},{"kind":"READ","substeps":["$30","FROM __stage01_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $150 := $142, $151 := $140, $152 := $141, $153 := $145","$80 := SUM($143)","$81 := SUM($144)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $131 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $111 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $93 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $60"]},{"kind":"WRITE","substeps":["$153, $151, $152, $150, $80, $81","TO __stage07_output","BY HASH($150, $151, $152, $153)"]}],"writeRatioAvg":0.0027247956403269754},{"readMsMax":"18","computeMsMax":"829","waitMsAvg":"1","id":"8","endMs":"1570992742083","waitMsMax":"1","startMs":"1570992741527","waitRatioMax":0.00045413260672116256,"readRatioAvg":0.008174386920980926,"parallelInputs":"1","recordsRead":"1000000","computeRatioAvg":0.3764759309718438,"writeMsAvg":"160","status":"COMPLETE","writeMsMax":"160","computeMsAvg":"829","shuffleOutputBytesSpilled":"0","writeRatioMax":0.07266121707538602,"readMsAvg":"18","waitRatioAvg":0.00045413260672116256,"completedParallelInputs":"1","computeRatioMax":0.3764759309718438,"name":"S08: Input","shuffleOutputBytes":"22561984","recordsWritten":"1000000","readRatioMax":0.008174386920980926,"steps":[{"kind":"READ","substeps":["$1:ca_address_sk, $2:ca_city","FROM customer_address"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage08_output","BY HASH($1)"]}],"writeRatioAvg":0.07266121707538602},{"readMsMax":"0","computeMsMax":"27","inputStages":["7"],"waitMsAvg":"1","id":"10","endMs":"1570992741748","waitMsMax":"1","startMs":"1570992741635","waitRatioMax":0.00045413260672116256,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"89563","computeRatioAvg":0.009536784741144414,"writeMsAvg":"50","status":"COMPLETE","writeMsMax":"65","computeMsAvg":"21","shuffleOutputBytesSpilled":"0","writeRatioMax":0.029518619436875566,"readMsAvg":"0","waitRatioAvg":0.00045413260672116256,"completedParallelInputs":"18","computeRatioMax":0.01226158038147139,"name":"S0A: Aggregate","shuffleOutputBytes":"4301213","recordsWritten":"86784","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$153, $151, $152, $150, $80, $81","FROM __stage07_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $160 := $150, $161 := $151, $162 := $152, $163 := $153","$70 := SUM($80)","$71 := SUM($81)"]},{"kind":"WRITE","substeps":["$70, $71, $160, $161, $163","TO __stage0A_output","BY HASH($161)"]}],"writeRatioAvg":0.022706630336058128},{"readMsMax":"0","computeMsMax":"12","inputStages":["10"],"waitMsAvg":"1","id":"11","endMs":"1570992742185","waitMsMax":"3","startMs":"1570992741759","waitRatioMax":0.0013623978201634877,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"86784","computeRatioAvg":0.003178928247048138,"writeMsAvg":"195","status":"COMPLETE","writeMsMax":"222","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.1008174386920981,"readMsAvg":"0","waitRatioAvg":0.00045413260672116256,"completedParallelInputs":"100","computeRatioMax":0.005449591280653951,"name":"S0B: Coalesce","shuffleOutputBytes":"4301213","recordsWritten":"86784","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0A_output"]}],"writeRatioAvg":0.0885558583106267},{"readMsMax":"0","computeMsMax":"19","inputStages":["8"],"waitMsAvg":"1","id":"13","endMs":"1570992742504","waitMsMax":"3","startMs":"1570992742223","waitRatioMax":0.0013623978201634877,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1000000","computeRatioAvg":0.005449591280653951,"writeMsAvg":"45","status":"COMPLETE","writeMsMax":"61","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.027702089009990917,"readMsAvg":"0","waitRatioAvg":0.00045413260672116256,"completedParallelInputs":"100","computeRatioMax":0.00862851952770209,"name":"S0D: Coalesce","shuffleOutputBytes":"22561984","recordsWritten":"1000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage08_output"]}],"writeRatioAvg":0.020435967302452316},{"readMsMax":"24","computeMsMax":"1639","inputStages":["13","11"],"waitMsAvg":"2","id":"14","endMs":"1570992743268","waitMsMax":"2","startMs":"1570992742226","waitRatioMax":0.0009082652134423251,"readRatioAvg":0.010899182561307902,"parallelInputs":"1","recordsRead":"3086784","computeRatioAvg":0.7443233424159855,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"1639","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0018165304268846503,"readMsAvg":"24","waitRatioAvg":0.0009082652134423251,"completedParallelInputs":"1","computeRatioMax":0.7443233424159855,"name":"S0E: Join+","shuffleOutputBytes":"5515","recordsWritten":"100","readRatioMax":0.010899182561307902,"steps":[{"kind":"READ","substeps":["$10:c_customer_sk, $11:c_current_addr_sk, $12:c_first_name, $13:c_last_name","FROM customer"]},{"kind":"READ","substeps":["$70, $71, $160, $161, $163","FROM __stage0B_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage0D_output"]},{"kind":"SORT","substeps":["$181 ASC, $180 ASC, $186 ASC, $182 ASC, $183 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["not_equal($186, $182)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $174 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $10 = $161"]},{"kind":"WRITE","substeps":["$190, $191, $192, $193, $194, $195, $196","TO __stage0E_output"]}],"writeRatioAvg":0.0018165304268846503},{"readMsMax":"0","computeMsMax":"6","inputStages":["14"],"waitMsAvg":"4","id":"15","endMs":"1570992743395","waitMsMax":"4","startMs":"1570992742261","waitRatioMax":0.0018165304268846503,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0027247956403269754,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004087193460490463,"readMsAvg":"0","waitRatioAvg":0.0018165304268846503,"completedParallelInputs":"1","computeRatioMax":0.0027247956403269754,"name":"S0F: Output","shuffleOutputBytes":"5515","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$190, $191, $192, $193, $194, $195, $196","FROM __stage0E_output"]},{"kind":"SORT","substeps":["$192 ASC, $191 ASC, $190 ASC, $193 ASC, $194 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$200, $201, $202, $203, $204, $205, $206","TO __stage0F_output"]}],"writeRatioAvg":0.004087193460490463}],"estimatedBytesProcessed":"17412851865","timeline":[{"totalSlotMs":"19355","activeUnits":"185","completedUnits":"3","elapsedMs":"684","pendingUnits":"185"},{"totalSlotMs":"210545","activeUnits":"226","completedUnits":"104","elapsedMs":"1724","pendingUnits":"184"},{"totalSlotMs":"416989","activeUnits":"101","completedUnits":"306","elapsedMs":"2913","pendingUnits":"102"},{"totalSlotMs":"469694","activeUnits":"93","completedUnits":"507","elapsedMs":"3989","pendingUnits":"2"},{"totalSlotMs":"470582","activeUnits":"2","completedUnits":"509","elapsedMs":"4872","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"17413701632","totalPartitionsProcessed":"0","totalBytesProcessed":"17412851865","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_100"}]},"endTime":"1570992743824"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query46_1570992736"},"etag":"aI8LZfDv0/XKTfPdD5Az/A==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query46_1570992736?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon1f439167696fc6de8bead63ae7f0313aac942e81","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query46\nSELECT c_last_name, \n c_first_name, \n ca_city, \n bought_city, \n ss_ticket_number, \n amt, \n profit \nFROM (SELECT ss_ticket_number, \n ss_customer_sk, \n ca_city bought_city, \n Sum(ss_coupon_amt) amt, \n Sum(ss_net_profit) profit \n FROM store_sales, \n date_dim, \n store, \n household_demographics, \n customer_address \n WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk \n AND store_sales.ss_store_sk = store.s_store_sk \n AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk \n AND store_sales.ss_addr_sk = customer_address.ca_address_sk \n AND ( household_demographics.hd_dep_count = 6 \n OR household_demographics.hd_vehicle_count = 0 ) \n AND date_dim.d_dow IN ( 6, 0 ) \n AND date_dim.d_year IN ( 2000, 2000 + 1, 2000 + 2 ) \n AND store.s_city IN ( 'Midway', 'Fairview', 'Fairview', \n 'Fairview', \n 'Fairview' ) \n GROUP BY ss_ticket_number, \n ss_customer_sk, \n ss_addr_sk, \n ca_city) dn, \n customer, \n customer_address current_addr \nWHERE ss_customer_sk = c_customer_sk \n AND customer.c_current_addr_sk = current_addr.ca_address_sk \n AND current_addr.ca_city <> bought_city \nORDER BY c_last_name, \n c_first_name, \n ca_city, \n bought_city, \n ss_ticket_number\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query46_1570992736","user_email":"nithish.sankaranarayanan@ulb.be"}
