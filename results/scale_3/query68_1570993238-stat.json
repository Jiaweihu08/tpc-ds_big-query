{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"490653","creationTime":"1570993239911","totalBytesProcessed":"19566356281","startTime":"1570993240101","query":{"totalSlotMs":"490653","queryPlan":[{"readMsMax":"18","computeMsMax":"926","waitMsAvg":"2","id":"0","endMs":"1570993240904","waitMsMax":"2","startMs":"1570993240297","waitRatioMax":0.0007698229407236335,"readRatioAvg":0.006928406466512702,"parallelInputs":"1","recordsRead":"1000000","computeRatioAvg":0.35642802155504233,"writeMsAvg":"168","status":"COMPLETE","writeMsMax":"168","computeMsAvg":"926","shuffleOutputBytesSpilled":"0","writeRatioMax":0.06466512702078522,"readMsAvg":"18","waitRatioAvg":0.0007698229407236335,"completedParallelInputs":"1","computeRatioMax":0.35642802155504233,"name":"S00: Input","shuffleOutputBytes":"22561984","recordsWritten":"1000000","readRatioMax":0.006928406466512702,"steps":[{"kind":"READ","substeps":["$20:ca_address_sk, $21:ca_city","FROM customer_address"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage00_output","BY HASH($20)"]}],"writeRatioAvg":0.06466512702078522},{"readMsMax":"20","computeMsMax":"9","waitMsAvg":"1","id":"1","endMs":"1570993240460","waitMsMax":"1","startMs":"1570993240367","waitRatioMax":0.00038491147036181676,"readRatioAvg":0.007698229407236336,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.003464203233256351,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0026943802925327174,"readMsAvg":"20","waitRatioAvg":0.00038491147036181676,"completedParallelInputs":"1","computeRatioMax":0.003464203233256351,"name":"S01: Input","shuffleOutputBytes":"16200","recordsWritten":"1800","readRatioMax":0.007698229407236336,"steps":[{"kind":"READ","substeps":["$30:hd_demo_sk, $31:hd_dep_count, $32:hd_vehicle_count","FROM household_demographics","WHERE or(equal($31, 8), equal($32, 3))"]},{"kind":"WRITE","substeps":["$30","TO __stage01_output","BY HASH($30)"]}],"writeRatioAvg":0.0026943802925327174},{"readMsMax":"27","computeMsMax":"7","waitMsAvg":"20","id":"2","endMs":"1570993240610","waitMsMax":"20","startMs":"1570993240403","waitRatioMax":0.007698229407236336,"readRatioAvg":0.010392609699769052,"parallelInputs":"1","recordsRead":"402","computeRatioAvg":0.0026943802925327174,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001924557351809084,"readMsAvg":"27","waitRatioAvg":0.007698229407236336,"completedParallelInputs":"1","computeRatioMax":0.0026943802925327174,"name":"S02: Input","shuffleOutputBytes":"333","recordsWritten":"37","readRatioMax":0.010392609699769052,"steps":[{"kind":"READ","substeps":["$50:s_store_sk, $51:s_city","FROM store","WHERE in($51, 'Fairview', 'Midway')"]},{"kind":"WRITE","substeps":["$50","TO __stage02_output","BY HASH($50)"]}],"writeRatioAvg":0.001924557351809084},{"readMsMax":"14","computeMsMax":"11","waitMsAvg":"55","id":"3","endMs":"1570993240570","waitMsMax":"55","startMs":"1570993240451","waitRatioMax":0.021170130869899922,"readRatioAvg":0.005388760585065435,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004234026173979984,"writeMsAvg":"51","status":"COMPLETE","writeMsMax":"51","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.019630484988452657,"readMsAvg":"14","waitRatioAvg":0.021170130869899922,"completedParallelInputs":"1","computeRatioMax":0.004234026173979984,"name":"S03: Input","shuffleOutputBytes":"648","recordsWritten":"72","readRatioMax":0.005388760585065435,"steps":[{"kind":"READ","substeps":["$60:d_date_sk, $61:d_year, $62:d_dom","FROM date_dim","WHERE and(between($62, 1, 2), in($61, 1998, 1999, 2000))"]},{"kind":"WRITE","substeps":["$60","TO __stage03_output","BY HASH($60)"]}],"writeRatioAvg":0.019630484988452657},{"readMsMax":"0","computeMsMax":"15","inputStages":["0"],"waitMsAvg":"21","id":"7","endMs":"1570993241256","waitMsMax":"24","startMs":"1570993241066","waitRatioMax":0.009237875288683603,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1000000","computeRatioAvg":0.004234026173979984,"writeMsAvg":"53","status":"COMPLETE","writeMsMax":"94","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.036181678214010776,"readMsAvg":"0","waitRatioAvg":0.008083140877598153,"completedParallelInputs":"100","computeRatioMax":0.005773672055427252,"name":"S07: Coalesce","shuffleOutputBytes":"22561984","recordsWritten":"1000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage00_output"]}],"writeRatioAvg":0.02040030792917629},{"readMsMax":"536","computeMsMax":"2598","inputStages":["7","1","2","3"],"waitMsAvg":"17","id":"8","endMs":"1570993243102","waitMsMax":"23","startMs":"1570993241112","waitRatioMax":0.008852963818321785,"readRatioAvg":0.09738260200153964,"parallelInputs":"184","recordsRead":"466224179","computeRatioAvg":0.7648190916089299,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"134","computeMsAvg":"1987","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05157813702848345,"readMsAvg":"253","waitRatioAvg":0.006543494996150885,"completedParallelInputs":"184","computeRatioMax":1,"name":"S08: Join+","shuffleOutputBytes":"1310392","recordsWritten":"19592","readRatioMax":0.2063125481139338,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_hdemo_sk, $43:ss_addr_sk, $44:ss_store_sk, $45:ss_ticket_number, $46:ss_ext_sales_price, $47:ss_ext_list_price, $48:ss_ext_tax","FROM store_sales"]},{"kind":"READ","substeps":["$60","FROM __stage03_output"]},{"kind":"READ","substeps":["$50","FROM __stage02_output"]},{"kind":"READ","substeps":["$30","FROM __stage01_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage07_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $150 := $142, $151 := $140, $152 := $141, $153 := $146","$80 := SUM($143)","$81 := SUM($144)","$82 := SUM($145)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $131 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $111 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $93 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $60"]},{"kind":"WRITE","substeps":["$153, $151, $152, $150, $80, $81, $82","TO __stage08_output","BY HASH($150, $151, $152, $153)"]}],"writeRatioAvg":0.001924557351809084},{"readMsMax":"24","computeMsMax":"1062","waitMsAvg":"5","id":"9","endMs":"1570993243914","waitMsMax":"5","startMs":"1570993243126","waitRatioMax":0.001924557351809084,"readRatioAvg":0.009237875288683603,"parallelInputs":"1","recordsRead":"1000000","computeRatioAvg":0.40877598152424943,"writeMsAvg":"234","status":"COMPLETE","writeMsMax":"234","computeMsAvg":"1062","shuffleOutputBytesSpilled":"0","writeRatioMax":0.09006928406466513,"readMsAvg":"24","waitRatioAvg":0.001924557351809084,"completedParallelInputs":"1","computeRatioMax":0.40877598152424943,"name":"S09: Input","shuffleOutputBytes":"22561984","recordsWritten":"1000000","readRatioMax":0.009237875288683603,"steps":[{"kind":"READ","substeps":["$1:ca_address_sk, $2:ca_city","FROM customer_address"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage09_output","BY HASH($1)"]}],"writeRatioAvg":0.09006928406466513},{"readMsMax":"0","computeMsMax":"12","inputStages":["8"],"waitMsAvg":"6","id":"11","endMs":"1570993243340","waitMsMax":"7","startMs":"1570993243225","waitRatioMax":0.0026943802925327174,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"19592","computeRatioAvg":0.003464203233256351,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"84","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03233256351039261,"readMsAvg":"0","waitRatioAvg":0.0023094688221709007,"completedParallelInputs":"18","computeRatioMax":0.004618937644341801,"name":"S0B: Aggregate","shuffleOutputBytes":"1109023","recordsWritten":"18943","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$153, $151, $152, $150, $80, $81, $82","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $160 := $150, $161 := $151, $162 := $152, $163 := $153","$70 := SUM($80)","$71 := SUM($81)","$72 := SUM($82)"]},{"kind":"WRITE","substeps":["$70, $71, $72, $160, $161, $163","TO __stage0B_output","BY HASH($161)"]}],"writeRatioAvg":0.008083140877598153},{"readMsMax":"0","computeMsMax":"8","inputStages":["11"],"waitMsAvg":"6","id":"12","endMs":"1570993243500","waitMsMax":"9","startMs":"1570993243368","waitRatioMax":0.003464203233256351,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"18943","computeRatioAvg":0.001539645881447267,"writeMsAvg":"52","status":"COMPLETE","writeMsMax":"115","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04426481909160893,"readMsAvg":"0","waitRatioAvg":0.0023094688221709007,"completedParallelInputs":"100","computeRatioMax":0.003079291762894534,"name":"S0C: Coalesce","shuffleOutputBytes":"1109023","recordsWritten":"18943","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0B_output"]}],"writeRatioAvg":0.020015396458814474},{"readMsMax":"0","computeMsMax":"16","inputStages":["9"],"waitMsAvg":"5","id":"14","endMs":"1570993244368","waitMsMax":"7","startMs":"1570993244086","waitRatioMax":0.0026943802925327174,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1000000","computeRatioAvg":0.004618937644341801,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"51","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.019630484988452657,"readMsAvg":"0","waitRatioAvg":0.001924557351809084,"completedParallelInputs":"100","computeRatioMax":0.006158583525789068,"name":"S0E: Coalesce","shuffleOutputBytes":"22561984","recordsWritten":"1000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage09_output"]}],"writeRatioAvg":0.007698229407236336},{"readMsMax":"35","computeMsMax":"1529","inputStages":["14","12"],"waitMsAvg":"11","id":"15","endMs":"1570993256245","waitMsMax":"11","startMs":"1570993244093","waitRatioMax":0.004234026173979984,"readRatioAvg":0.013471901462663588,"parallelInputs":"1","recordsRead":"3018943","computeRatioAvg":0.5885296381832179,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"1529","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001924557351809084,"readMsAvg":"35","waitRatioAvg":0.004234026173979984,"completedParallelInputs":"1","computeRatioMax":0.5885296381832179,"name":"S0F: Join+","shuffleOutputBytes":"7066","recordsWritten":"100","readRatioMax":0.013471901462663588,"steps":[{"kind":"READ","substeps":["$10:c_customer_sk, $11:c_current_addr_sk, $12:c_first_name, $13:c_last_name","FROM customer"]},{"kind":"READ","substeps":["$70, $71, $72, $160, $161, $163","FROM __stage0C_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage0E_output"]},{"kind":"SORT","substeps":["$181 ASC, $183 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["not_equal($187, $182)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $175 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $10 = $161"]},{"kind":"WRITE","substeps":["$190, $191, $192, $193, $194, $195, $196, $197","TO __stage0F_output"]}],"writeRatioAvg":0.001924557351809084},{"readMsMax":"0","computeMsMax":"7","inputStages":["15"],"waitMsAvg":"14","id":"16","endMs":"1570993257865","waitMsMax":"14","startMs":"1570993244117","waitRatioMax":0.005388760585065435,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0026943802925327174,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0023094688221709007,"readMsAvg":"0","waitRatioAvg":0.005388760585065435,"completedParallelInputs":"1","computeRatioMax":0.0026943802925327174,"name":"S10: Output","shuffleOutputBytes":"7066","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$190, $191, $192, $193, $194, $195, $196, $197","FROM __stage0F_output"]},{"kind":"SORT","substeps":["$192 ASC, $194 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$200, $201, $202, $203, $204, $205, $206, $207","TO __stage10_output"]}],"writeRatioAvg":0.0023094688221709007}],"estimatedBytesProcessed":"19566356281","timeline":[{"totalSlotMs":"5292","activeUnits":"185","completedUnits":"3","elapsedMs":"698","pendingUnits":"185"},{"totalSlotMs":"67085","activeUnits":"184","completedUnits":"104","elapsedMs":"1306","pendingUnits":"184"},{"totalSlotMs":"440532","activeUnits":"33","completedUnits":"288","elapsedMs":"3119","pendingUnits":"20"},{"totalSlotMs":"468199","activeUnits":"2","completedUnits":"507","elapsedMs":"4316","pendingUnits":"2"},{"totalSlotMs":"490022","activeUnits":"1","completedUnits":"508","elapsedMs":"16648","pendingUnits":"1"},{"totalSlotMs":"490653","activeUnits":"0","completedUnits":"509","elapsedMs":"19175","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"19566428160","totalPartitionsProcessed":"0","totalBytesProcessed":"19566356281","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_100"}]},"endTime":"1570993259313"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query68_1570993238"},"etag":"n6RgQz+OmojcIhpQYxIZ8A==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query68_1570993238?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonf604a46d296d529f96a0d1979d6bfa0d6fafd861","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query68\nSELECT c_last_name, \n c_first_name, \n ca_city, \n bought_city, \n ss_ticket_number, \n extended_price, \n extended_tax, \n list_price \nFROM (SELECT ss_ticket_number, \n ss_customer_sk, \n ca_city bought_city, \n Sum(ss_ext_sales_price) extended_price, \n Sum(ss_ext_list_price) list_price, \n Sum(ss_ext_tax) extended_tax \n FROM store_sales, \n date_dim, \n store, \n household_demographics, \n customer_address \n WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk \n AND store_sales.ss_store_sk = store.s_store_sk \n AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk \n AND store_sales.ss_addr_sk = customer_address.ca_address_sk \n AND date_dim.d_dom BETWEEN 1 AND 2 \n AND ( household_demographics.hd_dep_count = 8 \n OR household_demographics.hd_vehicle_count = 3 ) \n AND date_dim.d_year IN ( 1998, 1998 + 1, 1998 + 2 ) \n AND store.s_city IN ( 'Fairview', 'Midway' ) \n GROUP BY ss_ticket_number, \n ss_customer_sk, \n ss_addr_sk, \n ca_city) dn, \n customer, \n customer_address current_addr \nWHERE ss_customer_sk = c_customer_sk \n AND customer.c_current_addr_sk = current_addr.ca_address_sk \n AND current_addr.ca_city <> bought_city \nORDER BY c_last_name, \n ss_ticket_number\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query68_1570993238","user_email":"nithish.sankaranarayanan@ulb.be"}
