{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"102693","creationTime":"1570993367553","totalBytesProcessed":"10933657540","startTime":"1570993367758","query":{"totalSlotMs":"102693","queryPlan":[{"readMsMax":"35","computeMsMax":"10","waitMsAvg":"2","id":"0","endMs":"1570993368037","waitMsMax":"2","startMs":"1570993367959","waitRatioMax":0.002369668246445498,"readRatioAvg":0.041469194312796206,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.011848341232227487,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.027251184834123223,"readMsAvg":"35","waitRatioAvg":0.002369668246445498,"completedParallelInputs":"1","computeRatioMax":0.011848341232227487,"name":"S00: Input","shuffleOutputBytes":"9360","recordsWritten":"1040","readRatioMax":0.041469194312796206,"steps":[{"kind":"READ","substeps":["$10:hd_demo_sk, $11:hd_buy_potential, $12:hd_dep_count, $13:hd_vehicle_count","FROM household_demographics","WHERE and(or(equal($11, '>10000'), equal($11, '0-500')), greater($13, 0), ...)"]},{"kind":"WRITE","substeps":["$10","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.027251184834123223},{"readMsMax":"121","computeMsMax":"8","waitMsAvg":"27","id":"1","endMs":"1570993368196","waitMsMax":"27","startMs":"1570993367998","waitRatioMax":0.031990521327014215,"readRatioAvg":0.14336492890995262,"parallelInputs":"1","recordsRead":"402","computeRatioAvg":0.009478672985781991,"writeMsAvg":"32","status":"COMPLETE","writeMsMax":"32","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.037914691943127965,"readMsAvg":"121","waitRatioAvg":0.031990521327014215,"completedParallelInputs":"1","computeRatioMax":0.009478672985781991,"name":"S01: Input","shuffleOutputBytes":"387","recordsWritten":"43","readRatioMax":0.14336492890995262,"steps":[{"kind":"READ","substeps":["$30:s_store_sk, $31:s_county","FROM store","WHERE in($31, 'Williamson County', 'Williamson County', 'Williamson County', 'Williamson County')"]},{"kind":"WRITE","substeps":["$30","TO __stage01_output","BY HASH($30)"]}],"writeRatioAvg":0.037914691943127965},{"readMsMax":"48","computeMsMax":"12","waitMsAvg":"50","id":"2","endMs":"1570993368192","waitMsMax":"50","startMs":"1570993368038","waitRatioMax":0.05924170616113744,"readRatioAvg":0.05687203791469194,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.014218009478672985,"writeMsAvg":"70","status":"COMPLETE","writeMsMax":"70","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08293838862559241,"readMsAvg":"48","waitRatioAvg":0.05924170616113744,"completedParallelInputs":"1","computeRatioMax":0.014218009478672985,"name":"S02: Input","shuffleOutputBytes":"648","recordsWritten":"72","readRatioMax":0.05687203791469194,"steps":[{"kind":"READ","substeps":["$40:d_date_sk, $41:d_year, $42:d_dom","FROM date_dim","WHERE and(between($42, 1, 2), in($41, 2000, 2001, 2002))"]},{"kind":"WRITE","substeps":["$40","TO __stage02_output","BY HASH($40)"]}],"writeRatioAvg":0.08293838862559241},{"readMsMax":"174","computeMsMax":"844","inputStages":["0","1","2"],"waitMsAvg":"4","id":"5","endMs":"1570993369035","waitMsMax":"7","startMs":"1570993368265","waitRatioMax":0.008293838862559242,"readRatioAvg":0.04265402843601896,"parallelInputs":"184","recordsRead":"282085443","computeRatioAvg":0.5154028436018957,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"131","computeMsAvg":"435","shuffleOutputBytesSpilled":"0","writeRatioMax":0.1552132701421801,"readMsAvg":"36","waitRatioAvg":0.004739336492890996,"completedParallelInputs":"184","computeRatioMax":1,"name":"S05: Join+","shuffleOutputBytes":"337106","recordsWritten":"12702","readRatioMax":0.20616113744075829,"steps":[{"kind":"READ","substeps":["$20:ss_sold_date_sk, $21:ss_customer_sk, $22:ss_hdemo_sk, $23:ss_store_sk, $24:ss_ticket_number","FROM store_sales"]},{"kind":"READ","substeps":["$40","FROM __stage02_output"]},{"kind":"READ","substeps":["$30","FROM __stage01_output"]},{"kind":"READ","substeps":["$10","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $100 := $91, $101 := $90","$60 := COUNT_STAR()"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $81 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $72 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $40"]},{"kind":"WRITE","substeps":["$101, $100, $60","TO __stage05_output","BY HASH($100, $101)"]}],"writeRatioAvg":0.008293838862559242},{"readMsMax":"0","computeMsMax":"10","inputStages":["5"],"waitMsAvg":"1","id":"7","endMs":"1570993369275","waitMsMax":"9","startMs":"1570993369167","waitRatioMax":0.01066350710900474,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"12702","computeRatioAvg":0.008293838862559242,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"26","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.030805687203791468,"readMsAvg":"0","waitRatioAvg":0.001184834123222749,"completedParallelInputs":"18","computeRatioMax":0.011848341232227487,"name":"S07: Aggregate+","shuffleOutputBytes":"1026","recordsWritten":"38","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$101, $100, $60","FROM __stage05_output"]},{"kind":"FILTER","substeps":["between($50, 1, 5)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $110 := $100, $111 := $101","$50 := SUM_OF_COUNTS($60)"]},{"kind":"WRITE","substeps":["$50, $110, $111","TO __stage07_output","BY HASH($111)"]}],"writeRatioAvg":0.023696682464454975},{"readMsMax":"0","computeMsMax":"9","inputStages":["7"],"waitMsAvg":"4","id":"8","endMs":"1570993369404","waitMsMax":"10","startMs":"1570993369290","waitRatioMax":0.011848341232227487,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"38","computeRatioAvg":0.005924170616113744,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"30","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.035545023696682464,"readMsAvg":"0","waitRatioAvg":0.004739336492890996,"completedParallelInputs":"100","computeRatioMax":0.01066350710900474,"name":"S08: Coalesce","shuffleOutputBytes":"1026","recordsWritten":"38","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage07_output"]}],"writeRatioAvg":0.018957345971563982},{"readMsMax":"36","computeMsMax":"713","inputStages":["8"],"waitMsAvg":"1","id":"9","endMs":"1570993369843","waitMsMax":"1","startMs":"1570993369306","waitRatioMax":0.001184834123222749,"readRatioAvg":0.04265402843601896,"parallelInputs":"1","recordsRead":"2000038","computeRatioAvg":0.8447867298578199,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"713","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0071090047393364926,"readMsAvg":"36","waitRatioAvg":0.001184834123222749,"completedParallelInputs":"1","computeRatioMax":0.8447867298578199,"name":"S09: Join","shuffleOutputBytes":"2040","recordsWritten":"38","readRatioMax":0.04265402843601896,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_salutation, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag","FROM customer"]},{"kind":"READ","substeps":["$50, $110, $111","FROM __stage08_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $111"]},{"kind":"WRITE","substeps":["$122, $123, $124, $125, $120, $121","TO __stage09_output"]}],"writeRatioAvg":0.0071090047393364926},{"readMsMax":"0","computeMsMax":"6","inputStages":["9"],"waitMsAvg":"2","id":"10","endMs":"1570993370071","waitMsMax":"2","startMs":"1570993369869","waitRatioMax":0.002369668246445498,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"38","computeRatioAvg":0.0071090047393364926,"writeMsAvg":"15","status":"COMPLETE","writeMsMax":"15","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.017772511848341232,"readMsAvg":"0","waitRatioAvg":0.002369668246445498,"completedParallelInputs":"1","computeRatioMax":0.0071090047393364926,"name":"S0A: Output","shuffleOutputBytes":"2040","recordsWritten":"38","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$122, $123, $124, $125, $120, $121","FROM __stage09_output"]},{"kind":"SORT","substeps":["$121 DESC, $124 ASC"]},{"kind":"WRITE","substeps":["$130, $131, $132, $133, $134, $135","TO __stage0A_output"]}],"writeRatioAvg":0.017772511848341232}],"estimatedBytesProcessed":"10933657540","timeline":[{"totalSlotMs":"14957","activeUnits":"184","completedUnits":"3","elapsedMs":"702","pendingUnits":"184"},{"totalSlotMs":"102107","activeUnits":"9","completedUnits":"305","elapsedMs":"1743","pendingUnits":"1"},{"totalSlotMs":"102693","activeUnits":"1","completedUnits":"307","elapsedMs":"2782","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"10934550528","totalPartitionsProcessed":"0","totalBytesProcessed":"10933657540","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_100"}]},"endTime":"1570993370580"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query73_1570993366"},"etag":"z7y/RRyJ3xp1+5hhNLbWig==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query73_1570993366?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anona1aaa74b6eb5ebbbf3f23c5ca0fcc20a45b99e31","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query73\nSELECT c_last_name, \n c_first_name, \n c_salutation, \n c_preferred_cust_flag, \n ss_ticket_number, \n cnt \nFROM (SELECT ss_ticket_number, \n ss_customer_sk, \n Count(*) cnt \n FROM store_sales, \n date_dim, \n store, \n household_demographics \n WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk \n AND store_sales.ss_store_sk = store.s_store_sk \n AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk \n AND date_dim.d_dom BETWEEN 1 AND 2 \n AND ( household_demographics.hd_buy_potential = '>10000' \n OR household_demographics.hd_buy_potential = '0-500' ) \n AND household_demographics.hd_vehicle_count > 0 \n AND CASE \n WHEN household_demographics.hd_vehicle_count > 0 THEN \n household_demographics.hd_dep_count / \n household_demographics.hd_vehicle_count \n ELSE NULL \n END > 1 \n AND date_dim.d_year IN ( 2000, 2000 + 1, 2000 + 2 ) \n AND store.s_county IN ( 'Williamson County', 'Williamson County', \n 'Williamson County', \n 'Williamson County' \n ) \n GROUP BY ss_ticket_number, \n ss_customer_sk) dj, \n customer \nWHERE ss_customer_sk = c_customer_sk \n AND cnt BETWEEN 1 AND 5 \nORDER BY cnt DESC, \n c_last_name ASC; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query73_1570993366","user_email":"nithish.sankaranarayanan@ulb.be"}
