{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"95781","creationTime":"1570972143047","totalBytesProcessed":"906443827","startTime":"1570972143212","query":{"totalSlotMs":"95781","queryPlan":[{"readMsMax":"11","computeMsMax":"10","waitMsAvg":"1","id":"0","endMs":"1570972143559","waitMsMax":"1","startMs":"1570972143351","waitRatioMax":0.0002623983206507478,"readRatioAvg":0.0028863815271582263,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0026239832065074785,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0018367882445552348,"readMsAvg":"11","waitRatioAvg":0.0002623983206507478,"completedParallelInputs":"1","computeRatioMax":0.0026239832065074785,"name":"S00: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.0028863815271582263,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_month_seq","FROM date_dim","WHERE between($51, 1199, 1210)"]},{"kind":"WRITE","substeps":["$50","TO __stage00_output","BY HASH($50)"]}],"writeRatioAvg":0.0018367882445552348},{"readMsMax":"8","computeMsMax":"7","waitMsAvg":"56","id":"2","endMs":"1570972143582","waitMsMax":"56","startMs":"1570972143502","waitRatioMax":0.014694305956441878,"readRatioAvg":0.0020991865652059826,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0018367882445552348,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004985568092364209,"readMsAvg":"8","waitRatioAvg":0.014694305956441878,"completedParallelInputs":"1","computeRatioMax":0.0018367882445552348,"name":"S02: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.0020991865652059826,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_month_seq","FROM date_dim","WHERE between($31, 1199, 1210)"]},{"kind":"WRITE","substeps":["$30","TO __stage02_output","BY HASH($30)"]}],"writeRatioAvg":0.004985568092364209},{"readMsMax":"39","computeMsMax":"3365","inputStages":["0"],"waitMsAvg":"1","id":"4","endMs":"1570972145411","waitMsMax":"1","startMs":"1570972143639","waitRatioMax":0.0002623983206507478,"readRatioAvg":0.007347152978220939,"parallelInputs":"10","recordsRead":"28805772","computeRatioAvg":0.6633429546050905,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"93","computeMsAvg":"2528","shuffleOutputBytesSpilled":"0","writeRatioMax":0.024403043820519547,"readMsAvg":"28","waitRatioAvg":0.0002623983206507478,"completedParallelInputs":"10","computeRatioMax":0.8829703489897665,"name":"S04: Join+","shuffleOutputBytes":"134081348","recordsWritten":"5032580","readRatioMax":0.010233534505379166,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_item_sk, $42:ss_store_sk, $43:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$50","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $160 := $151, $161 := $150","$110 := SUM($152)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $50"]},{"kind":"WRITE","substeps":["$161, $160, $110","TO __stage04_output","BY HASH($160, $161)"]}],"writeRatioAvg":0.007084754657570191},{"readMsMax":"118","computeMsMax":"3485","inputStages":["2"],"waitMsAvg":"1","id":"5","endMs":"1570972145731","waitMsMax":"2","startMs":"1570972143669","waitRatioMax":0.0005247966413014956,"readRatioAvg":0.011545526108632905,"parallelInputs":"10","recordsRead":"28805772","computeRatioAvg":0.7310417213329835,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"31","computeMsAvg":"2786","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008134347940173182,"readMsAvg":"44","waitRatioAvg":0.0002623983206507478,"completedParallelInputs":"10","computeRatioMax":0.9144581474678563,"name":"S05: Join+","shuffleOutputBytes":"134081348","recordsWritten":"5032580","readRatioMax":0.030963001836788243,"steps":[{"kind":"READ","substeps":["$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_store_sk, $23:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$30","FROM __stage02_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $130 := $121, $131 := $120","$80 := SUM($122)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $30"]},{"kind":"WRITE","substeps":["$131, $130, $80","TO __stage05_output","BY HASH($130, $131)"]}],"writeRatioAvg":0.004985568092364209},{"readMsMax":"0","computeMsMax":"3811","inputStages":["4"],"waitMsAvg":"1","id":"6","endMs":"1570972147043","waitMsMax":"1","startMs":"1570972145094","waitRatioMax":0.0002623983206507478,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"4124632","computeRatioAvg":1,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"25","computeMsAvg":"3811","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006559958016268696,"readMsAvg":"0","waitRatioAvg":0.0002623983206507478,"completedParallelInputs":"1","computeRatioMax":1,"name":"S06: Repartition","shuffleOutputBytes":"109781464","recordsWritten":"4124632","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage04_output"]}],"writeRatioAvg":0.006559958016268696},{"readMsMax":"0","computeMsMax":"3263","inputStages":["5"],"waitMsAvg":"1","id":"7","endMs":"1570972146945","waitMsMax":"1","startMs":"1570972145298","waitRatioMax":0.0002623983206507478,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"3994181","computeRatioAvg":0.8562057202833901,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"3263","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004723169771713461,"readMsAvg":"0","waitRatioAvg":0.0002623983206507478,"completedParallelInputs":"1","computeRatioMax":0.8562057202833901,"name":"S07: Repartition","shuffleOutputBytes":"106270919","recordsWritten":"3994181","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage05_output"]}],"writeRatioAvg":0.004723169771713461},{"readMsMax":"0","computeMsMax":"770","inputStages":["6","4"],"waitMsAvg":"3","id":"8","endMs":"1570972147660","waitMsMax":"3","startMs":"1570972147152","waitRatioMax":0.0007871949619522435,"readRatioAvg":0,"parallelInputs":"10","recordsRead":"5032580","computeRatioAvg":0.16819732353712935,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"15","computeMsAvg":"641","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003935974809761217,"readMsAvg":"0","waitRatioAvg":0.0007871949619522435,"completedParallelInputs":"10","computeRatioMax":0.20204670690107585,"name":"S08: Aggregate","shuffleOutputBytes":"13440","recordsWritten":"520","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$161, $160, $110","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $170","$90 := SHARD_AVG($100)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $170 := $160, $171 := $161","$100 := SUM($110)"]},{"kind":"WRITE","substeps":["$180, $90","TO __stage08_output","BY HASH($180)"]}],"writeRatioAvg":0.0020991865652059826},{"readMsMax":"21","computeMsMax":"4","waitMsAvg":"1","id":"10","endMs":"1570972147797","waitMsMax":"1","startMs":"1570972147750","waitRatioMax":0.0002623983206507478,"readRatioAvg":0.005510364733665705,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.0010495932826029913,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0013119916032537393,"readMsAvg":"21","waitRatioAvg":0.0002623983206507478,"completedParallelInputs":"1","computeRatioMax":0.0010495932826029913,"name":"S0A: Input","shuffleOutputBytes":"1822","recordsWritten":"102","readRatioMax":0.005510364733665705,"steps":[{"kind":"READ","substeps":["$10:s_store_sk, $11:s_store_name","FROM store"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage0A_output","BY HASH($10)"]}],"writeRatioAvg":0.0013119916032537393},{"readMsMax":"0","computeMsMax":"8","inputStages":["8"],"waitMsAvg":"1","id":"11","endMs":"1570972147806","waitMsMax":"1","startMs":"1570972147765","waitRatioMax":0.0002623983206507478,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"520","computeRatioAvg":0.0020991865652059826,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0028863815271582263,"readMsAvg":"0","waitRatioAvg":0.0002623983206507478,"completedParallelInputs":"1","computeRatioMax":0.0020991865652059826,"name":"S0B: Aggregate","shuffleOutputBytes":"918","recordsWritten":"51","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$180, $90","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $180","$70 := ROOT_AVG($90)"]},{"kind":"WRITE","substeps":["$70, $190","TO __stage0B_output","BY HASH($190)"]}],"writeRatioAvg":0.0028863815271582263},{"readMsMax":"0","computeMsMax":"9","inputStages":["11"],"waitMsAvg":"1","id":"13","endMs":"1570972147916","waitMsMax":"2","startMs":"1570972147812","waitRatioMax":0.0005247966413014956,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"51","computeRatioAvg":0.0010495932826029913,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"46","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0120703227499344,"readMsAvg":"0","waitRatioAvg":0.0002623983206507478,"completedParallelInputs":"100","computeRatioMax":0.0023615848858567303,"name":"S0D: Coalesce","shuffleOutputBytes":"918","recordsWritten":"51","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0B_output"]}],"writeRatioAvg":0.006559958016268696},{"readMsMax":"0","computeMsMax":"756","inputStages":["7","5","10","13"],"waitMsAvg":"5","id":"14","endMs":"1570972148328","waitMsMax":"5","startMs":"1570972147839","waitRatioMax":0.0013119916032537393,"readRatioAvg":0,"parallelInputs":"10","recordsRead":"5034110","computeRatioAvg":0.16531094200997112,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"59","computeMsAvg":"630","shuffleOutputBytesSpilled":"0","writeRatioMax":0.015481500918394122,"readMsAvg":"0","waitRatioAvg":0.0013119916032537393,"completedParallelInputs":"10","computeRatioMax":0.19837313041196536,"name":"S0E: Join+","shuffleOutputBytes":"6008402","recordsWritten":"223026","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$131, $130, $80","FROM __stage05_output"]},{"kind":"READ","substeps":["$70, $190","FROM __stage0D_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage0A_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $201 = $10"]},{"kind":"FILTER","substeps":["less_or_equal($202, multiply(0.1, $203))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $140 = $190"]},{"kind":"AGGREGATE","substeps":["GROUP BY $140 := $130, $141 := $131","$60 := SUM($80)"]},{"kind":"WRITE","substeps":["$210, $211, $212","TO __stage0E_output","BY HASH($210)"]}],"writeRatioAvg":0.0060351613749672},{"readMsMax":"0","computeMsMax":"11","inputStages":["14"],"waitMsAvg":"1","id":"15","endMs":"1570972148503","waitMsMax":"3","startMs":"1570972148345","waitRatioMax":0.0007871949619522435,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"223026","computeRatioAvg":0.0018367882445552348,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"58","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.015219102597743374,"readMsAvg":"0","waitRatioAvg":0.0002623983206507478,"completedParallelInputs":"100","computeRatioMax":0.0028863815271582263,"name":"S0F: Coalesce","shuffleOutputBytes":"6008402","recordsWritten":"223026","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0E_output"]}],"writeRatioAvg":0.004460771451062713},{"readMsMax":"30","computeMsMax":"525","inputStages":["15"],"waitMsAvg":"3","id":"16","endMs":"1570972149114","waitMsMax":"3","startMs":"1570972148348","waitRatioMax":0.0007871949619522435,"readRatioAvg":0.007871949619522435,"parallelInputs":"1","recordsRead":"325026","computeRatioAvg":0.13775911834164262,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"525","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0010495932826029913,"readMsAvg":"30","waitRatioAvg":0.0007871949619522435,"completedParallelInputs":"1","computeRatioMax":0.13775911834164262,"name":"S10: Join+","shuffleOutputBytes":"4982","recordsWritten":"100","readRatioMax":0.007871949619522435,"steps":[{"kind":"READ","substeps":["$1:i_item_sk, $2:i_item_desc, $3:i_current_price, $4:i_wholesale_cost, $5:i_brand","FROM item"]},{"kind":"READ","substeps":["$210, $211, $212","FROM __stage0F_output"]},{"kind":"SORT","substeps":["$220 ASC, $222 ASC","LIMIT 100"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $210"]},{"kind":"WRITE","substeps":["$230, $231, $232, $233, $234, $235","TO __stage10_output"]}],"writeRatioAvg":0.0010495932826029913},{"readMsMax":"0","computeMsMax":"4","inputStages":["16"],"waitMsAvg":"2","id":"17","endMs":"1570972149208","waitMsMax":"2","startMs":"1570972148367","waitRatioMax":0.0005247966413014956,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0010495932826029913,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001574389923904487,"readMsAvg":"0","waitRatioAvg":0.0005247966413014956,"completedParallelInputs":"1","computeRatioMax":0.0010495932826029913,"name":"S11: Output","shuffleOutputBytes":"4982","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$230, $231, $232, $233, $234, $235","FROM __stage10_output"]},{"kind":"SORT","substeps":["$234 ASC, $230 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$240, $241, $242, $243, $244, $245","TO __stage11_output"]}],"writeRatioAvg":0.001574389923904487}],"estimatedBytesProcessed":"906443827","timeline":[{"totalSlotMs":"2045","activeUnits":"20","completedUnits":"2","elapsedMs":"640","pendingUnits":"20"},{"totalSlotMs":"56573","activeUnits":"7","completedUnits":"22","elapsedMs":"2588","pendingUnits":"2"},{"totalSlotMs":"76665","activeUnits":"11","completedUnits":"136","elapsedMs":"4766","pendingUnits":"11"},{"totalSlotMs":"95781","activeUnits":"2","completedUnits":"248","elapsedMs":"6240","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"907018240","totalPartitionsProcessed":"0","totalBytesProcessed":"906443827","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570972149497"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query65_1570972141"},"etag":"9GntHxglhlX0vTJqE2nGbQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query65_1570972141?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonadc0b8b1bbf4ed6d55a1c5b74be151da6060f085","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query65\nSELECT s_store_name, \n i_item_desc, \n sc.revenue, \n i_current_price, \n i_wholesale_cost, \n i_brand \nFROM store, \n item, \n (SELECT ss_store_sk, \n Avg(revenue) AS ave \n FROM (SELECT ss_store_sk, \n ss_item_sk, \n Sum(ss_sales_price) AS revenue \n FROM store_sales, \n date_dim \n WHERE ss_sold_date_sk = d_date_sk \n AND d_month_seq BETWEEN 1199 AND 1199 + 11 \n GROUP BY ss_store_sk, \n ss_item_sk) sa \n GROUP BY ss_store_sk) sb, \n (SELECT ss_store_sk, \n ss_item_sk, \n Sum(ss_sales_price) AS revenue \n FROM store_sales, \n date_dim \n WHERE ss_sold_date_sk = d_date_sk \n AND d_month_seq BETWEEN 1199 AND 1199 + 11 \n GROUP BY ss_store_sk, \n ss_item_sk) sc \nWHERE sb.ss_store_sk = sc.ss_store_sk \n AND sc.revenue <= 0.1 benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results warmup sb.ave \n AND s_store_sk = sc.ss_store_sk \n AND i_item_sk = sc.ss_item_sk \nORDER BY s_store_name, \n i_item_desc\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query65_1570972141","user_email":"nithish.sankaranarayanan@ulb.be"}
