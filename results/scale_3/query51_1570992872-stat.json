{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"693995","creationTime":"1570992874721","totalBytesProcessed":"8255105796","startTime":"1570992874843","query":{"totalSlotMs":"693995","queryPlan":[{"readMsMax":"18","computeMsMax":"9","waitMsAvg":"2","id":"0","endMs":"1570992875056","waitMsMax":"2","startMs":"1570992875002","waitRatioMax":0.0002820078962210942,"readRatioAvg":0.0025380710659898475,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0012690355329949238,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0011280315848843769,"readMsAvg":"18","waitRatioAvg":0.0002820078962210942,"completedParallelInputs":"1","computeRatioMax":0.0012690355329949238,"name":"S00: Input","shuffleOutputBytes":"8784","recordsWritten":"366","readRatioMax":0.0025380710659898475,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_date, $32:d_month_seq","FROM date_dim","WHERE between($32, 1192, 1203)"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage00_output","BY HASH($30)"]}],"writeRatioAvg":0.0011280315848843769},{"readMsMax":"10","computeMsMax":"10","waitMsAvg":"16","id":"2","endMs":"1570992875132","waitMsMax":"16","startMs":"1570992875056","waitRatioMax":0.0022560631697687537,"readRatioAvg":0.0014100394811054709,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0014100394811054709,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0012690355329949238,"readMsAvg":"10","waitRatioAvg":0.0022560631697687537,"completedParallelInputs":"1","computeRatioMax":0.0014100394811054709,"name":"S02: Input","shuffleOutputBytes":"8784","recordsWritten":"366","readRatioMax":0.0014100394811054709,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $11:d_date, $12:d_month_seq","FROM date_dim","WHERE between($12, 1192, 1203)"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage02_output","BY HASH($10)"]}],"writeRatioAvg":0.0012690355329949238},{"readMsMax":"103","computeMsMax":"1627","inputStages":["0"],"waitMsAvg":"2","id":"4","endMs":"1570992876240","waitMsMax":"8","startMs":"1570992875098","waitRatioMax":0.0011280315848843769,"readRatioAvg":0.005217146080090242,"parallelInputs":"184","recordsRead":"281940267","computeRatioAvg":0.16032148900169205,"writeMsAvg":"32","status":"COMPLETE","writeMsMax":"506","computeMsAvg":"1137","shuffleOutputBytesSpilled":"0","writeRatioMax":0.07134799774393683,"readMsAvg":"37","waitRatioAvg":0.0002820078962210942,"completedParallelInputs":"184","computeRatioMax":0.22941342357586011,"name":"S04: Join+","shuffleOutputBytes":"1763518064","recordsWritten":"53745328","readRatioMax":0.01452340665538635,"steps":[{"kind":"READ","substeps":["$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_sales_price","FROM store_sales","WHERE not(is_null($21))"]},{"kind":"READ","substeps":["$30, $31","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $170, $181 := $172","$110 := SUM($171)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $30"]},{"kind":"WRITE","substeps":["$180, $181, $110","TO __stage04_output","BY HASH($180, $181)"]}],"writeRatioAvg":0.0045121263395375075},{"readMsMax":"75","computeMsMax":"692","inputStages":["2"],"waitMsAvg":"10","id":"5","endMs":"1570992875752","waitMsMax":"16","startMs":"1570992875189","waitRatioMax":0.0022560631697687537,"readRatioAvg":0.0038071065989847717,"parallelInputs":"92","recordsRead":"70507747","computeRatioAvg":0.07402707275803723,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"324","computeMsAvg":"525","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04568527918781726,"readMsAvg":"27","waitRatioAvg":0.0014100394811054709,"completedParallelInputs":"92","computeRatioMax":0.09757473209249859,"name":"S05: Join+","shuffleOutputBytes":"465812995","recordsWritten":"14115979","readRatioMax":0.010575296108291032,"steps":[{"kind":"READ","substeps":["$1:ws_sold_date_sk, $2:ws_item_sk, $3:ws_sales_price","FROM web_sales","WHERE not(is_null($2))"]},{"kind":"READ","substeps":["$10, $11","FROM __stage02_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $130 := $120, $131 := $122","$100 := SUM($121)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $10"]},{"kind":"WRITE","substeps":["$130, $131, $100","TO __stage05_output","BY HASH($130, $131)"]}],"writeRatioAvg":0.0032430908065425833},{"readMsMax":"0","computeMsMax":"4282","inputStages":["5"],"waitMsAvg":"1","id":"6","endMs":"1570992877972","waitMsMax":"2","startMs":"1570992875780","waitRatioMax":0.0002820078962210942,"readRatioAvg":0,"parallelInputs":"9","recordsRead":"14115979","computeRatioAvg":0.5069091934574168,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"3595","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0038071065989847717,"readMsAvg":"0","waitRatioAvg":0.0001410039481105471,"completedParallelInputs":"9","computeRatioMax":0.6037789058093627,"name":"S06: Aggregate","shuffleOutputBytes":"371669222","recordsWritten":"11262974","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$130, $131, $100","FROM __stage05_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $140 := $130, $141 := $131","$80 := SUM($100)"]},{"kind":"WRITE","substeps":["$140, $141, $80","TO __stage06_output","BY HASH($140)"]}],"writeRatioAvg":0.0023970671178793006},{"readMsMax":"0","computeMsMax":"3565","inputStages":["4"],"waitMsAvg":"2","id":"7","endMs":"1570992877678","waitMsMax":"2","startMs":"1570992875823","waitRatioMax":0.0002820078962210942,"readRatioAvg":0,"parallelInputs":"6","recordsRead":"17156115","computeRatioAvg":0.468556119571348,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"66","computeMsAvg":"3323","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009306260575296108,"readMsAvg":"0","waitRatioAvg":0.0002820078962210942,"completedParallelInputs":"6","computeRatioMax":0.5026790750141004,"name":"S07: Repartition","shuffleOutputBytes":"563128075","recordsWritten":"17156115","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage04_output"]}],"writeRatioAvg":0.003948110547095319},{"readMsMax":"0","computeMsMax":"3229","inputStages":["7","4"],"waitMsAvg":"7","id":"8","endMs":"1570992879413","waitMsMax":"7","startMs":"1570992877714","waitRatioMax":0.0009870276367738298,"readRatioAvg":0,"parallelInputs":"3","recordsRead":"8948029","computeRatioAvg":0.4514946418499718,"writeMsAvg":"14","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"3202","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002679075014100395,"readMsAvg":"0","waitRatioAvg":0.0009870276367738298,"completedParallelInputs":"3","computeRatioMax":0.45530174844895654,"name":"S08: Repartition","shuffleOutputBytes":"293617869","recordsWritten":"8948029","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage07_output"]}],"writeRatioAvg":0.0019740552735476595},{"readMsMax":"0","computeMsMax":"7092","inputStages":["8","4"],"waitMsAvg":"3","id":"9","endMs":"1570992883031","waitMsMax":"8","startMs":"1570992879449","waitRatioMax":0.0011280315848843769,"readRatioAvg":0,"parallelInputs":"99","recordsRead":"53745328","computeRatioAvg":0.14086294416243655,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"112","computeMsAvg":"999","shuffleOutputBytesSpilled":"0","writeRatioMax":0.015792442188381276,"readMsAvg":"0","waitRatioAvg":0.00042301184433164127,"completedParallelInputs":"99","computeRatioMax":1,"name":"S09: Aggregate","shuffleOutputBytes":"861241616","recordsWritten":"26165192","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$180, $181, $110","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $180, $191 := $181","$90 := SUM($110)"]},{"kind":"WRITE","substeps":["$190, $191, $90","TO __stage09_output","BY HASH($190)"]}],"writeRatioAvg":0.0038071065989847717},{"readMsMax":"0","computeMsMax":"6459","inputStages":["9"],"waitMsAvg":"1","id":"10","endMs":"1570992887116","waitMsMax":"2","startMs":"1570992883128","waitRatioMax":0.0002820078962210942,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"26165192","computeRatioAvg":0.7790468133107727,"writeMsAvg":"52","status":"COMPLETE","writeMsMax":"367","computeMsAvg":"5525","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05174844895657078,"readMsAvg":"0","waitRatioAvg":0.0001410039481105471,"completedParallelInputs":"18","computeRatioMax":0.9107445008460237,"name":"S0A: Sort+","shuffleOutputBytes":"863438288","recordsWritten":"26165192","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$190, $191, $90","FROM __stage09_output"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$70 := SUM($202) OVER (PARTITION BY $200 ORDER BY $201 ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)"]},{"kind":"SORT","substeps":["$190 ASC, $191 ASC"]},{"kind":"WRITE","substeps":["$70, $210, $211","TO __stage0A_output","BY HASH($210, $211)"]}],"writeRatioAvg":0.007332205301748449},{"readMsMax":"0","computeMsMax":"5344","inputStages":["6"],"waitMsAvg":"2","id":"11","endMs":"1570992886091","waitMsMax":"2","startMs":"1570992883150","waitRatioMax":0.0002820078962210942,"readRatioAvg":0,"parallelInputs":"9","recordsRead":"11262974","computeRatioAvg":0.6807670614777214,"writeMsAvg":"127","status":"COMPLETE","writeMsMax":"285","computeMsAvg":"4828","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04018612521150592,"readMsAvg":"0","waitRatioAvg":0.0002820078962210942,"completedParallelInputs":"9","computeRatioMax":0.7535250987027636,"name":"S0B: Sort+","shuffleOutputBytes":"371678006","recordsWritten":"11262974","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$140, $141, $80","FROM __stage06_output"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$60 := SUM($152) OVER (PARTITION BY $150 ORDER BY $151 ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)"]},{"kind":"SORT","substeps":["$140 ASC, $141 ASC"]},{"kind":"WRITE","substeps":["$60, $160, $161","TO __stage0B_output","BY HASH($160, $161)"]}],"writeRatioAvg":0.01790750141003948},{"readMsMax":"0","computeMsMax":"1601","inputStages":["10","11"],"waitMsAvg":"1","id":"12","endMs":"1570992888582","waitMsMax":"3","startMs":"1570992887306","waitRatioMax":0.00042301184433164127,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"37428166","computeRatioAvg":0.155668358714044,"writeMsAvg":"31","status":"COMPLETE","writeMsMax":"279","computeMsAvg":"1104","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03934010152284264,"readMsAvg":"0","waitRatioAvg":0.0001410039481105471,"completedParallelInputs":"100","computeRatioMax":0.2257473209249859,"name":"S0C: Join+","shuffleOutputBytes":"1046920100","recordsWritten":"28750306","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$60, $160, $161","FROM __stage0B_output"]},{"kind":"READ","substeps":["$70, $210, $211","FROM __stage0A_output"]},{"kind":"COMPUTE","substeps":["$50 := case_no_value(not(is_null($220)), $220, $223)","$51 := case_no_value(not(is_null($221)), $221, $224)"]},{"kind":"JOIN","substeps":["FULL OUTER HASH JOIN EACH WITH EACH ON $160 = $210, $161 = $211"]},{"kind":"WRITE","substeps":["$50, $51, $222, $225","TO __stage0C_output","BY HASH($50)"]}],"writeRatioAvg":0.00437112239142696},{"readMsMax":"0","computeMsMax":"2060","inputStages":["12"],"waitMsAvg":"1","id":"13","endMs":"1570992889771","waitMsMax":"1","startMs":"1570992888585","waitRatioMax":0.0001410039481105471,"readRatioAvg":0,"parallelInputs":"27","recordsRead":"28750306","computeRatioAvg":0.22349125775521714,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"1585","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0025380710659898475,"readMsAvg":"0","waitRatioAvg":0.0001410039481105471,"completedParallelInputs":"27","computeRatioMax":0.290468133107727,"name":"S0D: Sort+","shuffleOutputBytes":"146384","recordsWritten":"2700","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$50, $51, $222, $225","FROM __stage0C_output"]},{"kind":"SORT","substeps":["$240 ASC, $241 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["greater($40, $41)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$40 := MAX($232) OVER (PARTITION BY $230 ORDER BY $231 ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)","$41 := MAX($233) OVER (PARTITION BY $230 ORDER BY $231 ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)"]},{"kind":"SORT","substeps":["$50 ASC, $51 ASC"]},{"kind":"WRITE","substeps":["$250, $251, $252, $253, $254, $255","TO __stage0D_output"]}],"writeRatioAvg":0.0007050197405527354},{"readMsMax":"0","computeMsMax":"8","inputStages":["13"],"waitMsAvg":"1","id":"14","endMs":"1570992889797","waitMsMax":"1","startMs":"1570992888604","waitRatioMax":0.0001410039481105471,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2700","computeRatioAvg":0.0011280315848843769,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0008460236886632825,"readMsAvg":"0","waitRatioAvg":0.0001410039481105471,"completedParallelInputs":"1","computeRatioMax":0.0011280315848843769,"name":"S0E: Output","shuffleOutputBytes":"5440","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$250, $251, $252, $253, $254, $255","FROM __stage0D_output"]},{"kind":"SORT","substeps":["$252 ASC, $253 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$260, $261, $262, $263, $264, $265","TO __stage0E_output"]}],"writeRatioAvg":0.0008460236886632825}],"estimatedBytesProcessed":"8255105796","timeline":[{"totalSlotMs":"64563","activeUnits":"243","completedUnits":"35","elapsedMs":"659","pendingUnits":"243"},{"totalSlotMs":"252217","activeUnits":"21","completedUnits":"278","elapsedMs":"1704","pendingUnits":"15"},{"totalSlotMs":"286110","activeUnits":"7","completedUnits":"293","elapsedMs":"3465","pendingUnits":"3"},{"totalSlotMs":"351502","activeUnits":"28","completedUnits":"386","elapsedMs":"5503","pendingUnits":"9"},{"totalSlotMs":"451584","activeUnits":"21","completedUnits":"393","elapsedMs":"8060","pendingUnits":"2"},{"totalSlotMs":"456332","activeUnits":"27","completedUnits":"395","elapsedMs":"8571","pendingUnits":"27"},{"totalSlotMs":"560581","activeUnits":"17","completedUnits":"419","elapsedMs":"11567","pendingUnits":"3"},{"totalSlotMs":"575530","activeUnits":"100","completedUnits":"422","elapsedMs":"12777","pendingUnits":"100"},{"totalSlotMs":"665723","activeUnits":"28","completedUnits":"522","elapsedMs":"14242","pendingUnits":"28"},{"totalSlotMs":"693995","activeUnits":"3","completedUnits":"550","elapsedMs":"15381","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"8255438848","totalPartitionsProcessed":"0","totalBytesProcessed":"8255105796","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_100"}]},"endTime":"1570992890250"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query51_1570992872"},"etag":"zryDMlv+WnrLn0Up/LfK4g==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query51_1570992872?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon147e83a39b9e925437a955a10b169ffdcef1f708","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query51\nWITH web_v1 AS \n( \n SELECT ws_item_sk item_sk, \n d_date, \n sum(Sum(ws_sales_price)) OVER (partition BY ws_item_sk ORDER BY d_date rows BETWEEN UNBOUNDED PRECEDING AND CURRENT row) cume_sales\n FROM web_sales , \n date_dim \n WHERE ws_sold_date_sk=d_date_sk \n AND d_month_seq BETWEEN 1192 AND 1192+11 \n AND ws_item_sk IS NOT NULL \n GROUP BY ws_item_sk, \n d_date), store_v1 AS \n( \n SELECT ss_item_sk item_sk, \n d_date, \n sum(sum(ss_sales_price)) OVER (partition BY ss_item_sk ORDER BY d_date rows BETWEEN UNBOUNDED PRECEDING AND CURRENT row) cume_sales\n FROM store_sales , \n date_dim \n WHERE ss_sold_date_sk=d_date_sk \n AND d_month_seq BETWEEN 1192 AND 1192+11 \n AND ss_item_sk IS NOT NULL \n GROUP BY ss_item_sk, \n d_date) \nSELECT \n benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results scale_2.zip warmup \nFROM ( \n SELECT item_sk , \n d_date , \n web_sales , \n store_sales , \n max(web_sales) OVER (partition BY item_sk ORDER BY d_date rows BETWEEN UNBOUNDED PRECEDING AND CURRENT row) web_cumulative ,\n max(store_sales) OVER (partition BY item_sk ORDER BY d_date rows BETWEEN UNBOUNDED PRECEDING AND CURRENT row) store_cumulative\n FROM ( \n SELECT \n CASE \n WHEN web.item_sk IS NOT NULL THEN web.item_sk\n ELSE store.item_sk \n END item_sk , \n CASE \n WHEN web.d_date IS NOT NULL THEN web.d_date\n ELSE store.d_date \n END d_date , \n web.cume_sales web_sales , \n store.cume_sales store_sales \n FROM web_v1 web \n FULL OUTER JOIN store_v1 store \n ON ( \n web.item_sk = store.item_sk\n AND web.d_date = store.d_date) )x )y\nWHERE web_cumulative > store_cumulative \nORDER BY item_sk , \n d_date \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query51_1570992872","user_email":"nithish.sankaranarayanan@ulb.be"}
