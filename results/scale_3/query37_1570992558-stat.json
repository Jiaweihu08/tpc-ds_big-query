{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"216964","creationTime":"1570992561039","totalBytesProcessed":"10607113834","startTime":"1570992561217","query":{"totalSlotMs":"216964","queryPlan":[{"readMsMax":"22","computeMsMax":"22","waitMsAvg":"9","id":"1","endMs":"1570992561551","waitMsMax":"9","startMs":"1570992561406","waitRatioMax":0.006828528072837633,"readRatioAvg":0.01669195751138088,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.01669195751138088,"writeMsAvg":"53","status":"COMPLETE","writeMsMax":"53","computeMsAvg":"22","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04021244309559939,"readMsAvg":"22","waitRatioAvg":0.006828528072837633,"completedParallelInputs":"1","computeRatioMax":0.01669195751138088,"name":"S01: Input","shuffleOutputBytes":"558","recordsWritten":"62","readRatioMax":0.01669195751138088,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $11:d_date","FROM date_dim","WHERE between(CAST($11 AS DATE), 10656, 10717)"]},{"kind":"WRITE","substeps":["$10","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.04021244309559939},{"readMsMax":"70","computeMsMax":"51","waitMsAvg":"10","id":"3","endMs":"1570992561610","waitMsMax":"10","startMs":"1570992561501","waitRatioMax":0.007587253414264037,"readRatioAvg":0.05311077389984825,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.038694992412746584,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"51","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0030349013657056147,"readMsAvg":"70","waitRatioAvg":0.007587253414264037,"completedParallelInputs":"1","computeRatioMax":0.038694992412746584,"name":"S03: Input","shuffleOutputBytes":"1679","recordsWritten":"10","readRatioMax":0.05311077389984825,"steps":[{"kind":"READ","substeps":["$20:i_item_sk, $21:i_item_id, $22:i_item_desc, $23:i_current_price, $24:i_manufact_id","FROM item","WHERE and(between($23, 20, 50), in($24, 843, 815, 850, 840))"]},{"kind":"WRITE","substeps":["$20, $21, $22, $23","TO __stage03_output","BY HASH($20)"]}],"writeRatioAvg":0.0030349013657056147},{"readMsMax":"87","computeMsMax":"1318","inputStages":["1","3"],"waitMsAvg":"113","id":"4","endMs":"1570992562453","waitMsMax":"115","startMs":"1570992561750","waitRatioMax":0.08725341426403642,"readRatioAvg":0.028072837632776935,"parallelInputs":"40","recordsRead":"399332880","computeRatioAvg":0.7632776934749621,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"16","computeMsAvg":"1006","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012139605462822459,"readMsAvg":"37","waitRatioAvg":0.08573596358118361,"completedParallelInputs":"40","computeRatioMax":1,"name":"S04: Join","shuffleOutputBytes":"42237","recordsWritten":"256","readRatioMax":0.06600910470409711,"steps":[{"kind":"READ","substeps":["$30:inv_date_sk, $31:inv_item_sk, $32:inv_quantity_on_hand","FROM inventory","WHERE between($32, 100, 500)"]},{"kind":"READ","substeps":["$20, $21, $22, $23","FROM __stage03_output"]},{"kind":"READ","substeps":["$10","FROM __stage01_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $54 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $31 = $20"]},{"kind":"WRITE","substeps":["$60, $61, $62, $63","TO __stage04_output","BY HASH($60)"]}],"writeRatioAvg":0.0037936267071320183},{"readMsMax":"0","computeMsMax":"9","inputStages":["4"],"waitMsAvg":"1","id":"5","endMs":"1570992562552","waitMsMax":"2","startMs":"1570992562466","waitRatioMax":0.0015174506828528073,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"256","computeRatioAvg":0.0030349013657056147,"writeMsAvg":"35","status":"COMPLETE","writeMsMax":"56","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.042488619119878605,"readMsAvg":"0","waitRatioAvg":0.0007587253414264037,"completedParallelInputs":"100","computeRatioMax":0.006828528072837633,"name":"S05: Coalesce","shuffleOutputBytes":"42237","recordsWritten":"256","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage04_output"]}],"writeRatioAvg":0.026555386949924126},{"readMsMax":"32","computeMsMax":"132","inputStages":["5"],"waitMsAvg":"2","id":"6","endMs":"1570992563157","waitMsMax":"3","startMs":"1570992562490","waitRatioMax":0.002276176024279211,"readRatioAvg":0.012139605462822459,"parallelInputs":"141","recordsRead":"144046547","computeRatioAvg":0.07814871016691957,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"71","computeMsAvg":"103","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05386949924127466,"readMsAvg":"16","waitRatioAvg":0.0015174506828528073,"completedParallelInputs":"141","computeRatioMax":0.10015174506828528,"name":"S06: Join+","shuffleOutputBytes":"102906","recordsWritten":"648","readRatioMax":0.024279210925644917,"steps":[{"kind":"READ","substeps":["$1:cs_item_sk","FROM catalog_sales"]},{"kind":"READ","substeps":["$60, $61, $62, $63","FROM __stage05_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $80 := $70, $81 := $71, $82 := $72"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $60"]},{"kind":"WRITE","substeps":["$80, $81, $82","TO __stage06_output","BY HASH($80, $81, $82)"]}],"writeRatioAvg":0.005311077389984826},{"readMsMax":"0","computeMsMax":"7","inputStages":["6"],"waitMsAvg":"1","id":"7","endMs":"1570992563377","waitMsMax":"1","startMs":"1570992563164","waitRatioMax":0.0007587253414264037,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"648","computeRatioAvg":0.0037936267071320183,"writeMsAvg":"14","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.017450682852807285,"readMsAvg":"0","waitRatioAvg":0.0007587253414264037,"completedParallelInputs":"18","computeRatioMax":0.005311077389984826,"name":"S07: Sort+","shuffleOutputBytes":"798","recordsWritten":"5","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$80, $81, $82","FROM __stage06_output"]},{"kind":"SORT","substeps":["$90 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $90 := $80, $91 := $81, $92 := $82"]},{"kind":"WRITE","substeps":["$100, $101, $102","TO __stage07_output"]}],"writeRatioAvg":0.010622154779969651},{"readMsMax":"0","computeMsMax":"8","inputStages":["7"],"waitMsAvg":"1","id":"8","endMs":"1570992563397","waitMsMax":"1","startMs":"1570992563183","waitRatioMax":0.0007587253414264037,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"5","computeRatioAvg":0.006069802731411229,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004552352048558422,"readMsAvg":"0","waitRatioAvg":0.0007587253414264037,"completedParallelInputs":"1","computeRatioMax":0.006069802731411229,"name":"S08: Output","shuffleOutputBytes":"798","recordsWritten":"5","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$100, $101, $102","FROM __stage07_output"]},{"kind":"SORT","substeps":["$100 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$110, $111, $112","TO __stage08_output"]}],"writeRatioAvg":0.004552352048558422}],"estimatedBytesProcessed":"10607113834","timeline":[{"totalSlotMs":"10838","activeUnits":"174","completedUnits":"9","elapsedMs":"663","pendingUnits":"174"},{"totalSlotMs":"174485","activeUnits":"141","completedUnits":"142","elapsedMs":"1674","pendingUnits":"141"},{"totalSlotMs":"216964","activeUnits":"0","completedUnits":"302","elapsedMs":"2358","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"10607394816","totalPartitionsProcessed":"0","totalBytesProcessed":"10607113834","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"inventory","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_100"}]},"endTime":"1570992563614"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query37_1570992558"},"etag":"kWjW1BIIEXhvP8P77yk3ew==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query37_1570992558?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon83376ebad02dbd450ece396191624657c01ea0be","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query37\nSELECT \n i_item_id , \n i_item_desc , \n i_current_price \nFROM item, \n inventory, \n date_dim, \n catalog_sales \nWHERE i_current_price BETWEEN 20 AND 20 + 30 \nAND inv_item_sk = i_item_sk \nAND d_date_sk=inv_date_sk \nAND Cast(d_date AS DATE) BETWEEN Cast('1999-03-06' AS DATE) AND Cast('1999-05-06' AS DATE)\nAND i_manufact_id IN (843,815,850,840) \nAND inv_quantity_on_hand BETWEEN 100 AND 500 \nAND cs_item_sk = i_item_sk \nGROUP BY i_item_id, \n i_item_desc, \n i_current_price \nORDER BY i_item_id \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query37_1570992558","user_email":"nithish.sankaranarayanan@ulb.be"}
