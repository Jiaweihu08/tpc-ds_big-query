{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"284196","creationTime":"1570993280194","totalBytesProcessed":"6461646283","startTime":"1570993280389","query":{"totalSlotMs":"284196","queryPlan":[{"readMsMax":"12","computeMsMax":"8","waitMsAvg":"1","id":"0","endMs":"1570993280593","waitMsMax":"1","startMs":"1570993280556","waitRatioMax":0.0016638935108153079,"readRatioAvg":0.019966722129783693,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.013311148086522463,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008319467554076539,"readMsAvg":"12","waitRatioAvg":0.0016638935108153079,"completedParallelInputs":"1","computeRatioMax":0.013311148086522463,"name":"S00: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.019966722129783693,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_month_seq","FROM date_dim","WHERE between($51, 1200, 1211)"]},{"kind":"WRITE","substeps":["$50","TO __stage00_output","BY HASH($50)"]}],"writeRatioAvg":0.008319467554076539},{"readMsMax":"33","computeMsMax":"4","waitMsAvg":"25","id":"1","endMs":"1570993280775","waitMsMax":"25","startMs":"1570993280594","waitRatioMax":0.04159733777038269,"readRatioAvg":0.05490848585690516,"parallelInputs":"1","recordsRead":"402","computeRatioAvg":0.0066555740432612314,"writeMsAvg":"140","status":"COMPLETE","writeMsMax":"140","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.23294509151414308,"readMsAvg":"33","waitRatioAvg":0.04159733777038269,"completedParallelInputs":"1","computeRatioMax":0.0066555740432612314,"name":"S01: Input","shuffleOutputBytes":"6408","recordsWritten":"402","readRatioMax":0.05490848585690516,"steps":[{"kind":"READ","substeps":["$40:s_store_sk, $41:s_state","FROM store"]},{"kind":"WRITE","substeps":["$40, $41","TO __stage01_output","BY HASH($40)"]}],"writeRatioAvg":0.23294509151414308},{"readMsMax":"72","computeMsMax":"601","inputStages":["0","1"],"waitMsAvg":"14","id":"3","endMs":"1570993281462","waitMsMax":"17","startMs":"1570993280831","waitRatioMax":0.028286189683860232,"readRatioAvg":0.04159733777038269,"parallelInputs":"184","recordsRead":"282014235","computeRatioAvg":0.7587354409317804,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"134","computeMsAvg":"456","shuffleOutputBytesSpilled":"0","writeRatioMax":0.22296173044925124,"readMsAvg":"25","waitRatioAvg":0.02329450915141431,"completedParallelInputs":"184","computeRatioMax":1,"name":"S03: Join+","shuffleOutputBytes":"28336","recordsWritten":"1840","readRatioMax":0.11980033277870217,"steps":[{"kind":"READ","substeps":["$30:ss_sold_date_sk, $31:ss_store_sk, $32:ss_net_profit","FROM store_sales"]},{"kind":"READ","substeps":["$40, $41","FROM __stage01_output"]},{"kind":"READ","substeps":["$50","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $160 := $151","$110 := SUM($150)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $140 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $31 = $40"]},{"kind":"WRITE","substeps":["$160, $110","TO __stage03_output","BY HASH($160)"]}],"writeRatioAvg":0.009983361064891847},{"readMsMax":"0","computeMsMax":"7","inputStages":["3"],"waitMsAvg":"1","id":"4","endMs":"1570993281686","waitMsMax":"1","startMs":"1570993281492","waitRatioMax":0.0016638935108153079,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"1840","computeRatioAvg":0.008319467554076539,"writeMsAvg":"155","status":"COMPLETE","writeMsMax":"178","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.2961730449251248,"readMsAvg":"0","waitRatioAvg":0.0016638935108153079,"completedParallelInputs":"18","computeRatioMax":0.011647254575707155,"name":"S04: Aggregate","shuffleOutputBytes":"154","recordsWritten":"10","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$160, $110","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $170 := $160","$100 := SUM($110)"]},{"kind":"WRITE","substeps":["$170, $100","TO __stage04_output","BY HASH($170)"]}],"writeRatioAvg":0.2579034941763727},{"readMsMax":"0","computeMsMax":"9","inputStages":["4"],"waitMsAvg":"1","id":"5","endMs":"1570993281775","waitMsMax":"1","startMs":"1570993281705","waitRatioMax":0.0016638935108153079,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"10","computeRatioAvg":0.009983361064891847,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.029950083194675542,"readMsAvg":"0","waitRatioAvg":0.0016638935108153079,"completedParallelInputs":"18","computeRatioMax":0.014975041597337771,"name":"S05: Sort+","shuffleOutputBytes":"63","recordsWritten":"9","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$170, $100","FROM __stage04_output"]},{"kind":"FILTER","substeps":["less_or_equal($90, 5)"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$90 := RANK() OVER (PARTITION BY $180 ORDER BY $181 DESC)"]},{"kind":"SORT","substeps":["$170 ASC, $100 DESC"]},{"kind":"WRITE","substeps":["$190","TO __stage05_output","BY HASH($190)"]}],"writeRatioAvg":0.016638935108153077},{"readMsMax":"8","computeMsMax":"10","waitMsAvg":"4","id":"6","endMs":"1570993281948","waitMsMax":"4","startMs":"1570993281726","waitRatioMax":0.0066555740432612314,"readRatioAvg":0.013311148086522463,"parallelInputs":"1","recordsRead":"402","computeRatioAvg":0.016638935108153077,"writeMsAvg":"36","status":"COMPLETE","writeMsMax":"36","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.059900166389351084,"readMsAvg":"8","waitRatioAvg":0.0066555740432612314,"completedParallelInputs":"1","computeRatioMax":0.016638935108153077,"name":"S06: Input","shuffleOutputBytes":"14009","recordsWritten":"402","readRatioMax":0.013311148086522463,"steps":[{"kind":"READ","substeps":["$1:s_store_sk, $2:s_county, $3:s_state","FROM store"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage06_output","BY HASH($1)"]}],"writeRatioAvg":0.059900166389351084},{"readMsMax":"14","computeMsMax":"7","waitMsAvg":"1","id":"7","endMs":"1570993282618","waitMsMax":"1","startMs":"1570993282071","waitRatioMax":0.0016638935108153079,"readRatioAvg":0.02329450915141431,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.011647254575707155,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011647254575707155,"readMsAvg":"14","waitRatioAvg":0.0016638935108153079,"completedParallelInputs":"1","computeRatioMax":0.011647254575707155,"name":"S07: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.02329450915141431,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_month_seq","FROM date_dim","WHERE between($21, 1200, 1211)"]},{"kind":"WRITE","substeps":["$20","TO __stage07_output","BY HASH($20)"]}],"writeRatioAvg":0.011647254575707155},{"readMsMax":"0","computeMsMax":"8","inputStages":["5"],"waitMsAvg":"1","id":"9","endMs":"1570993282821","waitMsMax":"2","startMs":"1570993282719","waitRatioMax":0.0033277870216306157,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"9","computeRatioAvg":0.008319467554076539,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"72","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.11980033277870217,"readMsAvg":"0","waitRatioAvg":0.0016638935108153079,"completedParallelInputs":"100","computeRatioMax":0.013311148086522463,"name":"S09: Coalesce","shuffleOutputBytes":"63","recordsWritten":"9","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage05_output"]}],"writeRatioAvg":0.033277870216306155},{"readMsMax":"86","computeMsMax":"579","inputStages":["9","6","7"],"waitMsAvg":"3","id":"10","endMs":"1570993284207","waitMsMax":"5","startMs":"1570993283614","waitRatioMax":0.008319467554076539,"readRatioAvg":0.04326123128119801,"parallelInputs":"184","recordsRead":"282015891","computeRatioAvg":0.718801996672213,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"15","computeMsAvg":"432","shuffleOutputBytesSpilled":"0","writeRatioMax":0.024958402662229616,"readMsAvg":"26","waitRatioAvg":0.004991680532445923,"completedParallelInputs":"184","computeRatioMax":0.9633943427620633,"name":"S0A: Join+","shuffleOutputBytes":"64584","recordsWritten":"2024","readRatioMax":0.14309484193011648,"steps":[{"kind":"READ","substeps":["$10:ss_sold_date_sk, $11:ss_store_sk, $12:ss_net_profit","FROM store_sales"]},{"kind":"READ","substeps":["$20","FROM __stage07_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage06_output"]},{"kind":"READ","substeps":["$190","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $210 := $201, $211 := $200","$80 := SUM($202)"]},{"kind":"JOIN","substeps":["SEMI HASH JOIN EACH WITH ALL ON $132 = $190"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $120 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $10 = $20"]},{"kind":"WRITE","substeps":["$211, $210, $80","TO __stage0A_output","BY HASH($210, $211)"]}],"writeRatioAvg":0.009983361064891847},{"readMsMax":"0","computeMsMax":"9","inputStages":["10"],"waitMsAvg":"1","id":"11","endMs":"1570993284350","waitMsMax":"2","startMs":"1570993284267","waitRatioMax":0.0033277870216306157,"readRatioAvg":0,"parallelInputs":"20","recordsRead":"2024","computeRatioAvg":0.009983361064891847,"writeMsAvg":"14","status":"COMPLETE","writeMsMax":"26","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04326123128119801,"readMsAvg":"0","waitRatioAvg":0.0016638935108153079,"completedParallelInputs":"20","computeRatioMax":0.014975041597337771,"name":"S0B: Aggregate","shuffleOutputBytes":"351","recordsWritten":"11","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$211, $210, $80","FROM __stage0A_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $220 := $210, $221 := $211","$70 := SUM($80)"]},{"kind":"WRITE","substeps":["$221, $220, $70","TO __stage0B_output","BY HASH($220, $221)"]}],"writeRatioAvg":0.02329450915141431},{"readMsMax":"0","computeMsMax":"6","inputStages":["11"],"waitMsAvg":"1","id":"12","endMs":"1570993284425","waitMsMax":"1","startMs":"1570993284359","waitRatioMax":0.0016638935108153079,"readRatioAvg":0,"parallelInputs":"20","recordsRead":"11","computeRatioAvg":0.0066555740432612314,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"30","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04991680532445923,"readMsAvg":"0","waitRatioAvg":0.0016638935108153079,"completedParallelInputs":"20","computeRatioMax":0.009983361064891847,"name":"S0C: Sort+","shuffleOutputBytes":"450","recordsWritten":"11","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$221, $220, $70","FROM __stage0B_output"]},{"kind":"SORT","substeps":["$241 ASC, $60 ASC","LIMIT 100"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$60 := RANK() OVER (PARTITION BY $231, $230 ORDER BY $232 DESC)"]},{"kind":"SORT","substeps":["$220 ASC, $221 ASC, $70 DESC"]},{"kind":"WRITE","substeps":["$250, $251, $252, $253","TO __stage0C_output"]}],"writeRatioAvg":0.03993344425956739},{"readMsMax":"0","computeMsMax":"5","inputStages":["12"],"waitMsAvg":"1","id":"13","endMs":"1570993284455","waitMsMax":"1","startMs":"1570993284374","waitRatioMax":0.0016638935108153079,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"11","computeRatioAvg":0.008319467554076539,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008319467554076539,"readMsAvg":"0","waitRatioAvg":0.0016638935108153079,"completedParallelInputs":"1","computeRatioMax":0.008319467554076539,"name":"S0D: Output","shuffleOutputBytes":"450","recordsWritten":"11","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$250, $251, $252, $253","FROM __stage0C_output"]},{"kind":"SORT","substeps":["$251 ASC, $252 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$260, $261, $262, $263","TO __stage0D_output"]}],"writeRatioAvg":0.008319467554076539}],"estimatedBytesProcessed":"6461646283","timeline":[{"totalSlotMs":"21880","activeUnits":"181","completedUnits":"5","elapsedMs":"668","pendingUnits":"181"},{"totalSlotMs":"97771","activeUnits":"185","completedUnits":"223","elapsedMs":"1756","pendingUnits":"185"},{"totalSlotMs":"281876","activeUnits":"2","completedUnits":"507","elapsedMs":"3727","pendingUnits":"1"},{"totalSlotMs":"284196","activeUnits":"2","completedUnits":"549","elapsedMs":"4214","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"6462373888","totalPartitionsProcessed":"0","totalBytesProcessed":"6461646283","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_100"}]},"endTime":"1570993284642"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query70_1570993278"},"etag":"+0HuWIr9+fNYKYNK0ztfRw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query70_1570993278?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon2d50a08de86b56aaece7acf9639ff6577a7fd17c","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query70\nSELECT Sum(ss_net_profit) AS total_sum, \n s_state, \n s_county, \n Rank() \n OVER ( \n PARTITION BY s_state, s_county\n ORDER BY Sum(ss_net_profit) DESC) AS rank_within_parent \nFROM store_sales, \n date_dim d1, \n store \nWHERE d1.d_month_seq BETWEEN 1200 AND 1200 + 11 \n AND d1.d_date_sk = ss_sold_date_sk \n AND s_store_sk = ss_store_sk \n AND s_state IN (SELECT s_state \n FROM (SELECT s_state AS \n s_state, \n Rank() \n OVER ( \n partition BY s_state \n ORDER BY Sum(ss_net_profit) DESC) AS \n ranking \n FROM store_sales, \n store, \n date_dim \n WHERE d_month_seq BETWEEN 1200 AND 1200 + 11 \n AND d_date_sk = ss_sold_date_sk \n AND s_store_sk = ss_store_sk \n GROUP BY s_state) tmp1 \n WHERE ranking <= 5) \nGROUP BY s_state, s_county \nORDER BY s_state, \n rank_within_parent\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query70_1570993278","user_email":"nithish.sankaranarayanan@ulb.be"}
