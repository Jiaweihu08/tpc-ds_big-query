{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"440066","creationTime":"1570992831457","totalBytesProcessed":"24966229496","startTime":"1570992831655","query":{"totalSlotMs":"440066","queryPlan":[{"readMsMax":"15","computeMsMax":"8","waitMsAvg":"5","id":"0","endMs":"1570992831939","waitMsMax":"5","startMs":"1570992831895","waitRatioMax":0.0018031013342949874,"readRatioAvg":0.005409304002884962,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.00288496213487198,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0018031013342949874,"readMsAvg":"15","waitRatioAvg":0.0018031013342949874,"completedParallelInputs":"1","computeRatioMax":0.00288496213487198,"name":"S00: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.005409304002884962,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_year, $22:d_moy","FROM date_dim","WHERE and(equal($21, 1999), equal($22, 12))"]},{"kind":"WRITE","substeps":["$20","TO __stage00_output","BY HASH($20)"]}],"writeRatioAvg":0.0018031013342949874},{"readMsMax":"81","computeMsMax":"214","waitMsAvg":"28","id":"1","endMs":"1570992832139","waitMsMax":"31","startMs":"1570992831929","waitRatioMax":0.011179228272628922,"readRatioAvg":0.02271907681211684,"parallelInputs":"9","recordsRead":"28191329","computeRatioAvg":0.0699603317706455,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"194","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00288496213487198,"readMsAvg":"63","waitRatioAvg":0.01009736747205193,"completedParallelInputs":"9","computeRatioMax":0.07717273710782546,"name":"S01: Input","shuffleOutputBytes":"1652168","recordsWritten":"46086","readRatioMax":0.029210241615578794,"steps":[{"kind":"READ","substeps":["$80:sr_item_sk, $81:sr_ticket_number, $82:sr_return_quantity, $83:sr_return_amt","FROM store_returns","WHERE greater($83, 10000)"]},{"kind":"WRITE","substeps":["$80, $81, $82, $83","TO __stage01_output","BY HASH($81, $80)"]}],"writeRatioAvg":0.002163721601153985},{"readMsMax":"11","computeMsMax":"9","waitMsAvg":"0","id":"3","endMs":"1570992832084","waitMsMax":"0","startMs":"1570992831953","waitRatioMax":0,"readRatioAvg":0.003966822935448972,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0032455824017309774,"writeMsAvg":"98","status":"COMPLETE","writeMsMax":"98","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03534078615218175,"readMsAvg":"11","waitRatioAvg":0,"completedParallelInputs":"1","computeRatioMax":0.0032455824017309774,"name":"S03: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.003966822935448972,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $11:d_year, $12:d_moy","FROM date_dim","WHERE and(equal($11, 1999), equal($12, 12))"]},{"kind":"WRITE","substeps":["$10","TO __stage03_output","BY HASH($10)"]}],"writeRatioAvg":0.03534078615218175},{"readMsMax":"187","computeMsMax":"286","waitMsAvg":"3","id":"4","endMs":"1570992832318","waitMsMax":"4","startMs":"1570992831973","waitRatioMax":0.00144248106743599,"readRatioAvg":0.03714388748647674,"parallelInputs":"6","recordsRead":"14398596","computeRatioAvg":0.09448250991705734,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"40","computeMsAvg":"262","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0144248106743599,"readMsAvg":"103","waitRatioAvg":0.0010818608005769925,"completedParallelInputs":"6","computeRatioMax":0.10313739632167328,"name":"S04: Input","shuffleOutputBytes":"4458496","recordsWritten":"124126","readRatioMax":0.06743598990263253,"steps":[{"kind":"READ","substeps":["$60:cr_item_sk, $61:cr_order_number, $62:cr_return_quantity, $63:cr_return_amount","FROM catalog_returns","WHERE greater($63, 10000)"]},{"kind":"WRITE","substeps":["$60, $61, $62, $63","TO __stage04_output","BY HASH($61, $60)"]}],"writeRatioAvg":0.00865488640461594},{"readMsMax":"17","computeMsMax":"10","waitMsAvg":"3","id":"6","endMs":"1570992832155","waitMsMax":"3","startMs":"1570992832095","waitRatioMax":0.0010818608005769925,"readRatioAvg":0.006130544536602957,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.003606202668589975,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003606202668589975,"readMsAvg":"17","waitRatioAvg":0.0010818608005769925,"completedParallelInputs":"1","computeRatioMax":0.003606202668589975,"name":"S06: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.006130544536602957,"steps":[{"kind":"READ","substeps":["$1:d_date_sk, $2:d_year, $3:d_moy","FROM date_dim","WHERE and(equal($2, 1999), equal($3, 12))"]},{"kind":"WRITE","substeps":["$1","TO __stage06_output","BY HASH($1)"]}],"writeRatioAvg":0.003606202668589975},{"readMsMax":"92","computeMsMax":"211","waitMsAvg":"2","id":"7","endMs":"1570992832321","waitMsMax":"2","startMs":"1570992832121","waitRatioMax":0.000721240533717995,"readRatioAvg":0.027767760548142804,"parallelInputs":"3","recordsRead":"7048438","computeRatioAvg":0.0703209520375045,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"195","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007573025604038947,"readMsAvg":"77","waitRatioAvg":0.000721240533717995,"completedParallelInputs":"3","computeRatioMax":0.07609087630724846,"name":"S07: Input","shuffleOutputBytes":"2115488","recordsWritten":"59078","readRatioMax":0.03317706455102777,"steps":[{"kind":"READ","substeps":["$40:wr_item_sk, $41:wr_order_number, $42:wr_return_quantity, $43:wr_return_amt","FROM web_returns","WHERE greater($43, 10000)"]},{"kind":"WRITE","substeps":["$40, $41, $42, $43","TO __stage07_output","BY HASH($41, $40)"]}],"writeRatioAvg":0.00576992426974396},{"readMsMax":"0","computeMsMax":"11","inputStages":["1"],"waitMsAvg":"3","id":"9","endMs":"1570992832262","waitMsMax":"5","startMs":"1570992832163","waitRatioMax":0.0018031013342949874,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"46086","computeRatioAvg":0.002163721601153985,"writeMsAvg":"37","status":"COMPLETE","writeMsMax":"64","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02307969707897584,"readMsAvg":"0","waitRatioAvg":0.0010818608005769925,"completedParallelInputs":"100","computeRatioMax":0.003966822935448972,"name":"S09: Coalesce","shuffleOutputBytes":"1652168","recordsWritten":"46086","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage01_output"]}],"writeRatioAvg":0.013342949873782907},{"readMsMax":"2773","computeMsMax":"754","inputStages":["0","9"],"waitMsAvg":"4","id":"10","endMs":"1570992835927","waitMsMax":"8","startMs":"1570992832199","waitRatioMax":0.00288496213487198,"readRatioAvg":0.05120807789397764,"parallelInputs":"184","recordsRead":"290358451","computeRatioAvg":0.2127659574468085,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"184","computeMsAvg":"590","shuffleOutputBytesSpilled":"0","writeRatioMax":0.06635412910205554,"readMsAvg":"142","waitRatioAvg":0.00144248106743599,"completedParallelInputs":"184","computeRatioMax":0.27190768121168407,"name":"S0A: Join+","shuffleOutputBytes":"54540","recordsWritten":"1212","readRatioMax":1,"steps":[{"kind":"READ","substeps":["$70:ss_sold_date_sk, $71:ss_item_sk, $72:ss_ticket_number, $73:ss_quantity, $74:ss_net_paid, $75:ss_net_profit","FROM store_sales","WHERE and(greater($75, 1), greater($74, 0), greater($73, 0))"]},{"kind":"READ","substeps":["$80, $81, $82, $83","FROM __stage09_output"]},{"kind":"READ","substeps":["$20","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $570 := $560","$270 := SUM($300)","$271 := SUM($301)","$272 := SUM($302)","$273 := SUM($303)"]},{"kind":"COMPUTE","substeps":["$300 := coalesce($563, 0)","$301 := coalesce($561, 0)","$302 := coalesce($564, 0)","$303 := coalesce($562, 0)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $540 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $72 = $81, $71 = $80"]},{"kind":"WRITE","substeps":["$570, $270, $271, $272, $273","TO __stage0A_output","BY HASH($570)"]}],"writeRatioAvg":0.002163721601153985},{"readMsMax":"0","computeMsMax":"11","inputStages":["4"],"waitMsAvg":"3","id":"11","endMs":"1570992832942","waitMsMax":"5","startMs":"1570992832348","waitRatioMax":0.0018031013342949874,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"124126","computeRatioAvg":0.002163721601153985,"writeMsAvg":"181","status":"COMPLETE","writeMsMax":"578","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.20843851424450055,"readMsAvg":"0","waitRatioAvg":0.0010818608005769925,"completedParallelInputs":"100","computeRatioMax":0.003966822935448972,"name":"S0B: Coalesce","shuffleOutputBytes":"4458496","recordsWritten":"124126","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage04_output"]}],"writeRatioAvg":0.06527226830147854},{"readMsMax":"117","computeMsMax":"844","inputStages":["3","11"],"waitMsAvg":"22","id":"12","endMs":"1570992834316","waitMsMax":"25","startMs":"1570992832464","waitRatioMax":0.009015506671474938,"readRatioAvg":0.01730977280923188,"parallelInputs":"141","recordsRead":"161516588","computeRatioAvg":0.22142084385142444,"writeMsAvg":"2","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"614","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00288496213487198,"readMsAvg":"48","waitRatioAvg":0.007933645870897944,"completedParallelInputs":"141","computeRatioMax":0.30436350522899386,"name":"S0C: Join+","shuffleOutputBytes":"169515","recordsWritten":"3767","readRatioMax":0.0421925712225027,"steps":[{"kind":"READ","substeps":["$50:cs_sold_date_sk, $51:cs_item_sk, $52:cs_order_number, $53:cs_quantity, $54:cs_net_paid, $55:cs_net_profit","FROM catalog_sales","WHERE and(greater($55, 1), greater($54, 0), greater($53, 0))"]},{"kind":"READ","substeps":["$60, $61, $62, $63","FROM __stage0B_output"]},{"kind":"READ","substeps":["$10","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $460 := $450","$260 := SUM($290)","$261 := SUM($291)","$262 := SUM($292)","$263 := SUM($293)"]},{"kind":"COMPUTE","substeps":["$290 := coalesce($453, 0)","$291 := coalesce($451, 0)","$292 := coalesce($454, 0)","$293 := coalesce($452, 0)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $430 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $52 = $61, $51 = $60"]},{"kind":"WRITE","substeps":["$460, $260, $261, $262, $263","TO __stage0C_output","BY HASH($460)"]}],"writeRatioAvg":0.000721240533717995},{"readMsMax":"0","computeMsMax":"11","inputStages":["7"],"waitMsAvg":"17","id":"13","endMs":"1570992832566","waitMsMax":"24","startMs":"1570992832456","waitRatioMax":0.00865488640461594,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"59078","computeRatioAvg":0.002163721601153985,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"35","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012621709340064912,"readMsAvg":"0","waitRatioAvg":0.006130544536602957,"completedParallelInputs":"100","computeRatioMax":0.003966822935448972,"name":"S0D: Coalesce","shuffleOutputBytes":"2115488","recordsWritten":"59078","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage07_output"]}],"writeRatioAvg":0.006851785070320952},{"readMsMax":"375","computeMsMax":"577","inputStages":["6","13"],"waitMsAvg":"14","id":"14","endMs":"1570992833136","waitMsMax":"16","startMs":"1570992832490","waitRatioMax":0.00576992426974396,"readRatioAvg":0.017670393076090876,"parallelInputs":"92","recordsRead":"75912103","computeRatioAvg":0.14785430941218897,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"290","computeMsAvg":"410","shuffleOutputBytesSpilled":"0","writeRatioMax":0.10457987738910927,"readMsAvg":"49","waitRatioAvg":0.005048683736025965,"completedParallelInputs":"92","computeRatioMax":0.20807789397764154,"name":"S0E: Join+","shuffleOutputBytes":"82845","recordsWritten":"1841","readRatioMax":0.13523260007212407,"steps":[{"kind":"READ","substeps":["$30:ws_sold_date_sk, $31:ws_item_sk, $32:ws_order_number, $33:ws_quantity, $34:ws_net_paid, $35:ws_net_profit","FROM web_sales","WHERE and(greater($35, 1), greater($34, 0), greater($33, 0))"]},{"kind":"READ","substeps":["$40, $41, $42, $43","FROM __stage0D_output"]},{"kind":"READ","substeps":["$1","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $350 := $340","$250 := SUM($280)","$251 := SUM($281)","$252 := SUM($282)","$253 := SUM($283)"]},{"kind":"COMPUTE","substeps":["$280 := coalesce($343, 0)","$281 := coalesce($341, 0)","$282 := coalesce($344, 0)","$283 := coalesce($342, 0)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $320 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $32 = $41, $31 = $40"]},{"kind":"WRITE","substeps":["$350, $250, $251, $252, $253","TO __stage0E_output","BY HASH($350)"]}],"writeRatioAvg":0.007573025604038947},{"readMsMax":"0","computeMsMax":"7","inputStages":["14"],"waitMsAvg":"6","id":"15","endMs":"1570992833216","waitMsMax":"8","startMs":"1570992833151","waitRatioMax":0.00288496213487198,"readRatioAvg":0,"parallelInputs":"9","recordsRead":"1841","computeRatioAvg":0.002163721601153985,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"30","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.010818608005769925,"readMsAvg":"0","waitRatioAvg":0.002163721601153985,"completedParallelInputs":"9","computeRatioMax":0.0025243418680129825,"name":"S0F: Aggregate+","shuffleOutputBytes":"49302","recordsWritten":"1826","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$350, $250, $251, $252, $253","FROM __stage0E_output"]},{"kind":"COMPUTE","substeps":["$190 := divide(CAST($220 AS DOUBLE), CAST($221 AS DOUBLE))","$191 := divide($222, $223)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $360 := $350","$220 := SUM($250)","$221 := SUM($251)","$222 := SUM($252)","$223 := SUM($253)"]},{"kind":"WRITE","substeps":["$360, $190, $191","TO __stage0F_output"]}],"writeRatioAvg":0.00865488640461594},{"readMsMax":"0","computeMsMax":"8","inputStages":["12"],"waitMsAvg":"1","id":"16","endMs":"1570992834420","waitMsMax":"2","startMs":"1570992834339","waitRatioMax":0.000721240533717995,"readRatioAvg":0,"parallelInputs":"14","recordsRead":"3767","computeRatioAvg":0.002163721601153985,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"52","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01875225387666787,"readMsAvg":"0","waitRatioAvg":0.0003606202668589975,"completedParallelInputs":"14","computeRatioMax":0.00288496213487198,"name":"S10: Aggregate+","shuffleOutputBytes":"100170","recordsWritten":"3710","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$460, $260, $261, $262, $263","FROM __stage0C_output"]},{"kind":"COMPUTE","substeps":["$200 := divide(CAST($230 AS DOUBLE), CAST($231 AS DOUBLE))","$201 := divide($232, $233)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $470 := $460","$230 := SUM($260)","$231 := SUM($261)","$232 := SUM($262)","$233 := SUM($263)"]},{"kind":"WRITE","substeps":["$470, $200, $201","TO __stage10_output"]}],"writeRatioAvg":0.010457987738910927},{"readMsMax":"0","computeMsMax":"10","inputStages":["10"],"waitMsAvg":"1","id":"17","endMs":"1570992836461","waitMsMax":"2","startMs":"1570992836172","waitRatioMax":0.000721240533717995,"readRatioAvg":0,"parallelInputs":"19","recordsRead":"1212","computeRatioAvg":0.0025243418680129825,"writeMsAvg":"39","status":"COMPLETE","writeMsMax":"273","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.09844933285250632,"readMsAvg":"0","waitRatioAvg":0.0003606202668589975,"completedParallelInputs":"19","computeRatioMax":0.003606202668589975,"name":"S11: Aggregate+","shuffleOutputBytes":"32589","recordsWritten":"1207","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$570, $270, $271, $272, $273","FROM __stage0A_output"]},{"kind":"COMPUTE","substeps":["$210 := divide(CAST($240 AS DOUBLE), CAST($241 AS DOUBLE))","$211 := divide($242, $243)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $580 := $570","$240 := SUM($270)","$241 := SUM($271)","$242 := SUM($272)","$243 := SUM($273)"]},{"kind":"WRITE","substeps":["$580, $210, $211","TO __stage11_output"]}],"writeRatioAvg":0.014064190407500902},{"readMsMax":"0","computeMsMax":"17","inputStages":["15","16","17"],"waitMsAvg":"2","id":"18","endMs":"1570992836479","waitMsMax":"2","startMs":"1570992836174","waitRatioMax":0.000721240533717995,"readRatioAvg":0,"parallelInputs":"3","recordsRead":"6743","computeRatioAvg":0.00432744320230797,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"25","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009015506671474938,"readMsAvg":"0","waitRatioAvg":0.000721240533717995,"completedParallelInputs":"3","computeRatioMax":0.006130544536602957,"name":"S12: Sort+","shuffleOutputBytes":"6198","recordsWritten":"135","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$360, $190, $191","FROM __stage0F_output"]},{"kind":"READ","substeps":["$470, $200, $201","FROM __stage10_output"]},{"kind":"READ","substeps":["$580, $210, $211","FROM __stage11_output"]},{"kind":"SORT","substeps":["$100 ASC, $401 ASC, $130 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$100 := 'web'"]},{"kind":"FILTER","substeps":["or(less_or_equal($401, 10), less_or_equal($130, 10))"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$130 := RANK() OVER (ORDER BY $393 ASC)"]},{"kind":"SORT","substeps":["$382 ASC"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$160 := RANK() OVER (ORDER BY $371 ASC)"]},{"kind":"SORT","substeps":["$190 ASC"]},{"kind":"SORT","substeps":["$110 ASC, $511 ASC, $140 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$110 := 'catalog'"]},{"kind":"FILTER","substeps":["or(less_or_equal($511, 10), less_or_equal($140, 10))"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$140 := RANK() OVER (ORDER BY $503 ASC)"]},{"kind":"SORT","substeps":["$492 ASC"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$170 := RANK() OVER (ORDER BY $481 ASC)"]},{"kind":"SORT","substeps":["$200 ASC"]},{"kind":"SORT","substeps":["$120 ASC, $621 ASC, $150 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$120 := 'store'"]},{"kind":"FILTER","substeps":["or(less_or_equal($621, 10), less_or_equal($150, 10))"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$150 := RANK() OVER (ORDER BY $613 ASC)"]},{"kind":"SORT","substeps":["$602 ASC"]},{"kind":"ANALYTIC_FUNCTION","substeps":["$180 := RANK() OVER (ORDER BY $591 ASC)"]},{"kind":"SORT","substeps":["$210 ASC"]},{"kind":"WRITE","substeps":["$90, $91, $92, $93, $94","TO __stage12_output"]}],"writeRatioAvg":0.006491164803461955},{"readMsMax":"0","computeMsMax":"6","inputStages":["18"],"waitMsAvg":"1","id":"19","endMs":"1570992836505","waitMsMax":"1","startMs":"1570992836195","waitRatioMax":0.0003606202668589975,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"135","computeRatioAvg":0.002163721601153985,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0025243418680129825,"readMsAvg":"0","waitRatioAvg":0.0003606202668589975,"completedParallelInputs":"1","computeRatioMax":0.002163721601153985,"name":"S13: Output","shuffleOutputBytes":"4658","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$90, $91, $92, $93, $94","FROM __stage12_output"]},{"kind":"SORT","substeps":["$90 ASC, $93 ASC, $94 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$640, $641, $642, $643, $644","TO __stage13_output"]}],"writeRatioAvg":0.0025243418680129825}],"estimatedBytesProcessed":"24966229496","timeline":[{"totalSlotMs":"44696","activeUnits":"376","completedUnits":"121","elapsedMs":"743","pendingUnits":"517"},{"totalSlotMs":"366495","activeUnits":"171","completedUnits":"665","elapsedMs":"1816","pendingUnits":"82"},{"totalSlotMs":"434573","activeUnits":"45","completedUnits":"760","elapsedMs":"2872","pendingUnits":"1"},{"totalSlotMs":"440066","activeUnits":"4","completedUnits":"784","elapsedMs":"5081","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"24966594560","totalPartitionsProcessed":"0","totalBytesProcessed":"24966229496","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"web_returns","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_100"}]},"endTime":"1570992836765"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query49_1570992829"},"etag":"JFrlWLY/cVCtyKSEc4Yyzg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query49_1570992829?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonc0c9792c05d6b9e949e180141cc6eb50ce53187c","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query49\nSELECT 'web' AS channel, \n web.item, \n web.return_ratio, \n web.return_rank, \n web.currency_rank \nFROM (SELECT item, \n return_ratio, \n currency_ratio, \n Rank() \n OVER ( \n ORDER BY return_ratio) AS return_rank, \n Rank() \n OVER ( \n ORDER BY currency_ratio) AS currency_rank \n FROM (SELECT ws.ws_item_sk AS item, \n ( Sum(COALESCE(wr.wr_return_quantity, 0)) / \n Sum(COALESCE(ws.ws_quantity, 0)) ) AS \n return_ratio, \n ( Sum(COALESCE(wr.wr_return_amt, 0)) / \n Sum(COALESCE(ws.ws_net_paid, 0)) ) AS currency_ratio \n FROM web_sales ws \n LEFT OUTER JOIN web_returns wr \n ON ( ws.ws_order_number = wr.wr_order_number \n AND ws.ws_item_sk = wr.wr_item_sk ), \n date_dim \n WHERE wr.wr_return_amt > 10000 \n AND ws.ws_net_profit > 1 \n AND ws.ws_net_paid > 0 \n AND ws.ws_quantity > 0 \n AND ws_sold_date_sk = d_date_sk \n AND d_year = 1999 \n AND d_moy = 12 \n GROUP BY ws.ws_item_sk) in_web) web \nWHERE ( web.return_rank <= 10 \n OR web.currency_rank <= 10 ) \nUNION ALL \nSELECT 'catalog' AS channel, \n catalog.item, \n catalog.return_ratio, \n catalog.return_rank, \n catalog.currency_rank \nFROM (SELECT item, \n return_ratio, \n currency_ratio, \n Rank() \n OVER ( \n ORDER BY return_ratio) AS return_rank, \n Rank() \n OVER ( \n ORDER BY currency_ratio) AS currency_rank \n FROM (SELECT cs.cs_item_sk AS \n item, \n ( Sum(COALESCE(cr.cr_return_quantity, 0)) / \n Sum(COALESCE(cs.cs_quantity, 0)) ) AS \n return_ratio, \n ( Sum(COALESCE(cr.cr_return_amount, 0)) / \n Sum(COALESCE(cs.cs_net_paid, 0)) ) AS \n currency_ratio \n FROM catalog_sales cs \n LEFT OUTER JOIN catalog_returns cr \n ON ( cs.cs_order_number = cr.cr_order_number \n AND cs.cs_item_sk = cr.cr_item_sk ), \n date_dim \n WHERE cr.cr_return_amount > 10000 \n AND cs.cs_net_profit > 1 \n AND cs.cs_net_paid > 0 \n AND cs.cs_quantity > 0 \n AND cs_sold_date_sk = d_date_sk \n AND d_year = 1999 \n AND d_moy = 12 \n GROUP BY cs.cs_item_sk) in_cat) catalog \nWHERE ( catalog.return_rank <= 10 \n OR catalog.currency_rank <= 10 ) \nUNION ALL\nSELECT 'store' AS channel, \n store.item, \n store.return_ratio, \n store.return_rank, \n store.currency_rank \nFROM (SELECT item, \n return_ratio, \n currency_ratio, \n Rank() \n OVER ( \n ORDER BY return_ratio) AS return_rank, \n Rank() \n OVER ( \n ORDER BY currency_ratio) AS currency_rank \n FROM (SELECT sts.ss_item_sk AS \n item, \n ( Sum(COALESCE(sr.sr_return_quantity, 0)) / \n Sum(COALESCE(sts.ss_quantity, 0)) ) AS \n return_ratio, \n ( Sum(COALESCE(sr.sr_return_amt, 0)) \n / Sum(COALESCE(sts.ss_net_paid, 0)) ) AS \n currency_ratio \n FROM store_sales sts \n LEFT OUTER JOIN store_returns sr \n ON ( sts.ss_ticket_number = \n sr.sr_ticket_number \n AND sts.ss_item_sk = sr.sr_item_sk ), \n date_dim \n WHERE sr.sr_return_amt > 10000 \n AND sts.ss_net_profit > 1 \n AND sts.ss_net_paid > 0 \n AND sts.ss_quantity > 0 \n AND ss_sold_date_sk = d_date_sk \n AND d_year = 1999 \n AND d_moy = 12 \n GROUP BY sts.ss_item_sk) in_store) store \nWHERE ( store.return_rank <= 10 \n OR store.currency_rank <= 10 ) \nORDER BY 1, \n 4, \n 5\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query49_1570992829","user_email":"nithish.sankaranarayanan@ulb.be"}
