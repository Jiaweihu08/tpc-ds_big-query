{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"39127","creationTime":"1570993708472","totalBytesProcessed":"1692487728","startTime":"1570993708633","query":{"totalSlotMs":"39127","queryPlan":[{"readMsMax":"32","computeMsMax":"6","waitMsAvg":"1","id":"0","endMs":"1570993708994","waitMsMax":"1","startMs":"1570993708792","waitRatioMax":0.00425531914893617,"readRatioAvg":0.13617021276595745,"parallelInputs":"1","recordsRead":"2040","computeRatioAvg":0.02553191489361702,"writeMsAvg":"161","status":"COMPLETE","writeMsMax":"161","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.6851063829787234,"readMsAvg":"32","waitRatioAvg":0.00425531914893617,"completedParallelInputs":"1","computeRatioMax":0.02553191489361702,"name":"S00: Input","shuffleOutputBytes":"450","recordsWritten":"50","readRatioMax":0.13617021276595745,"steps":[{"kind":"READ","substeps":["$10:wp_web_page_sk, $11:wp_char_count","FROM web_page","WHERE between($11, 5000, 5200)"]},{"kind":"WRITE","substeps":["$10","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.6851063829787234},{"readMsMax":"7","computeMsMax":"8","waitMsAvg":"1","id":"1","endMs":"1570993708947","waitMsMax":"1","startMs":"1570993708878","waitRatioMax":0.00425531914893617,"readRatioAvg":0.029787234042553193,"parallelInputs":"1","recordsRead":"86400","computeRatioAvg":0.03404255319148936,"writeMsAvg":"51","status":"COMPLETE","writeMsMax":"51","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.2170212765957447,"readMsAvg":"7","waitRatioAvg":0.00425531914893617,"completedParallelInputs":"1","computeRatioMax":0.03404255319148936,"name":"S01: Input","shuffleOutputBytes":"64800","recordsWritten":"7200","readRatioMax":0.029787234042553193,"steps":[{"kind":"READ","substeps":["$50:t_time_sk, $51:t_hour","FROM time_dim","WHERE between($51, 20, 21)"]},{"kind":"WRITE","substeps":["$50","TO __stage01_output","BY HASH($50)"]}],"writeRatioAvg":0.2170212765957447},{"readMsMax":"23","computeMsMax":"8","waitMsAvg":"9","id":"2","endMs":"1570993708971","waitMsMax":"9","startMs":"1570993708918","waitRatioMax":0.03829787234042553,"readRatioAvg":0.09787234042553192,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.03404255319148936,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02127659574468085,"readMsAvg":"23","waitRatioAvg":0.03829787234042553,"completedParallelInputs":"1","computeRatioMax":0.03404255319148936,"name":"S02: Input","shuffleOutputBytes":"6480","recordsWritten":"720","readRatioMax":0.09787234042553192,"steps":[{"kind":"READ","substeps":["$70:hd_demo_sk, $71:hd_dep_count","FROM household_demographics","WHERE equal($71, 8)"]},{"kind":"WRITE","substeps":["$70","TO __stage02_output","BY HASH($70)"]}],"writeRatioAvg":0.02127659574468085},{"readMsMax":"7","computeMsMax":"6","waitMsAvg":"13","id":"4","endMs":"1570993709132","waitMsMax":"13","startMs":"1570993708962","waitRatioMax":0.05531914893617021,"readRatioAvg":0.029787234042553193,"parallelInputs":"1","recordsRead":"2040","computeRatioAvg":0.02553191489361702,"writeMsAvg":"153","status":"COMPLETE","writeMsMax":"153","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.6510638297872341,"readMsAvg":"7","waitRatioAvg":0.05531914893617021,"completedParallelInputs":"1","computeRatioMax":0.02553191489361702,"name":"S04: Input","shuffleOutputBytes":"450","recordsWritten":"50","readRatioMax":0.029787234042553193,"steps":[{"kind":"READ","substeps":["$1:wp_web_page_sk, $2:wp_char_count","FROM web_page","WHERE between($2, 5000, 5200)"]},{"kind":"WRITE","substeps":["$1","TO __stage04_output","BY HASH($1)"]}],"writeRatioAvg":0.6510638297872341},{"readMsMax":"9","computeMsMax":"14","waitMsAvg":"1","id":"5","endMs":"1570993709116","waitMsMax":"1","startMs":"1570993709029","waitRatioMax":0.00425531914893617,"readRatioAvg":0.03829787234042553,"parallelInputs":"1","recordsRead":"86400","computeRatioAvg":0.059574468085106386,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"14","shuffleOutputBytesSpilled":"0","writeRatioMax":0.08936170212765958,"readMsAvg":"9","waitRatioAvg":0.00425531914893617,"completedParallelInputs":"1","computeRatioMax":0.059574468085106386,"name":"S05: Input","shuffleOutputBytes":"64800","recordsWritten":"7200","readRatioMax":0.03829787234042553,"steps":[{"kind":"READ","substeps":["$30:t_time_sk, $31:t_hour","FROM time_dim","WHERE between($31, 12, 13)"]},{"kind":"WRITE","substeps":["$30","TO __stage05_output","BY HASH($30)"]}],"writeRatioAvg":0.08936170212765958},{"readMsMax":"4","computeMsMax":"8","waitMsAvg":"1","id":"6","endMs":"1570993709147","waitMsMax":"1","startMs":"1570993709050","waitRatioMax":0.00425531914893617,"readRatioAvg":0.01702127659574468,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.03404255319148936,"writeMsAvg":"31","status":"COMPLETE","writeMsMax":"31","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.13191489361702127,"readMsAvg":"4","waitRatioAvg":0.00425531914893617,"completedParallelInputs":"1","computeRatioMax":0.03404255319148936,"name":"S06: Input","shuffleOutputBytes":"6480","recordsWritten":"720","readRatioMax":0.01702127659574468,"steps":[{"kind":"READ","substeps":["$60:hd_demo_sk, $61:hd_dep_count","FROM household_demographics","WHERE equal($61, 8)"]},{"kind":"WRITE","substeps":["$60","TO __stage06_output","BY HASH($60)"]}],"writeRatioAvg":0.13191489361702127},{"readMsMax":"116","computeMsMax":"222","inputStages":["0","1","2"],"waitMsAvg":"2","id":"9","endMs":"1570993709350","waitMsMax":"4","startMs":"1570993709113","waitRatioMax":0.01702127659574468,"readRatioAvg":0.10212765957446808,"parallelInputs":"92","recordsRead":"71207315","computeRatioAvg":0.7702127659574468,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"181","shuffleOutputBytesSpilled":"0","writeRatioMax":0.029787234042553193,"readMsAvg":"24","waitRatioAvg":0.00851063829787234,"completedParallelInputs":"92","computeRatioMax":0.9446808510638298,"name":"S09: Join+","shuffleOutputBytes":"828","recordsWritten":"92","readRatioMax":0.49361702127659574,"steps":[{"kind":"READ","substeps":["$40:ws_sold_time_sk, $41:ws_ship_hdemo_sk, $42:ws_web_page_sk","FROM web_sales"]},{"kind":"READ","substeps":["$70","FROM __stage02_output"]},{"kind":"READ","substeps":["$50","FROM __stage01_output"]},{"kind":"READ","substeps":["$10","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["$120 := COUNT_STAR()"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $170 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $160 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $41 = $70"]},{"kind":"WRITE","substeps":["$120","TO __stage09_output"]}],"writeRatioAvg":0.01702127659574468},{"readMsMax":"0","computeMsMax":"5","inputStages":["9"],"waitMsAvg":"3","id":"10","endMs":"1570993709368","waitMsMax":"3","startMs":"1570993709116","waitRatioMax":0.01276595744680851,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"92","computeRatioAvg":0.02127659574468085,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02127659574468085,"readMsAvg":"0","waitRatioAvg":0.01276595744680851,"completedParallelInputs":"1","computeRatioMax":0.02127659574468085,"name":"S0A: Aggregate","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$120","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["$100 := SUM_OF_COUNTS($120)"]},{"kind":"WRITE","substeps":["$100","TO __stage0A_output"]}],"writeRatioAvg":0.02127659574468085},{"readMsMax":"40","computeMsMax":"235","inputStages":["4","5","6"],"waitMsAvg":"3","id":"11","endMs":"1570993709358","waitMsMax":"6","startMs":"1570993709161","waitRatioMax":0.02553191489361702,"readRatioAvg":0.08936170212765958,"parallelInputs":"92","recordsRead":"71207315","computeRatioAvg":0.7787234042553192,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"66","computeMsAvg":"183","shuffleOutputBytesSpilled":"0","writeRatioMax":0.28085106382978725,"readMsAvg":"21","waitRatioAvg":0.01276595744680851,"completedParallelInputs":"92","computeRatioMax":1,"name":"S0B: Join+","shuffleOutputBytes":"828","recordsWritten":"92","readRatioMax":0.1702127659574468,"steps":[{"kind":"READ","substeps":["$20:ws_sold_time_sk, $21:ws_ship_hdemo_sk, $22:ws_web_page_sk","FROM web_sales"]},{"kind":"READ","substeps":["$60","FROM __stage06_output"]},{"kind":"READ","substeps":["$30","FROM __stage05_output"]},{"kind":"READ","substeps":["$1","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["$110 := COUNT_STAR()"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $140 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $130 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $21 = $60"]},{"kind":"WRITE","substeps":["$110","TO __stage0B_output"]}],"writeRatioAvg":0.02553191489361702},{"readMsMax":"0","computeMsMax":"4","inputStages":["11"],"waitMsAvg":"5","id":"12","endMs":"1570993709375","waitMsMax":"5","startMs":"1570993709165","waitRatioMax":0.02127659574468085,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"92","computeRatioAvg":0.01702127659574468,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02553191489361702,"readMsAvg":"0","waitRatioAvg":0.02127659574468085,"completedParallelInputs":"1","computeRatioMax":0.01702127659574468,"name":"S0C: Aggregate","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110","FROM __stage0B_output"]},{"kind":"AGGREGATE","substeps":["$90 := SUM_OF_COUNTS($110)"]},{"kind":"WRITE","substeps":["$90","TO __stage0C_output"]}],"writeRatioAvg":0.02553191489361702},{"readMsMax":"0","computeMsMax":"8","inputStages":["12","10"],"waitMsAvg":"1","id":"13","endMs":"1570993709588","waitMsMax":"1","startMs":"1570993709450","waitRatioMax":0.00425531914893617,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2","computeRatioAvg":0.03404255319148936,"writeMsAvg":"106","status":"COMPLETE","writeMsMax":"106","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.451063829787234,"readMsAvg":"0","waitRatioAvg":0.00425531914893617,"completedParallelInputs":"1","computeRatioMax":0.03404255319148936,"name":"S0D: Output","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$90","FROM __stage0C_output"]},{"kind":"READ","substeps":["$100","FROM __stage0A_output"]},{"kind":"SORT","substeps":["$80 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$80 := divide(CAST($180 AS DOUBLE), CAST($181 AS DOUBLE))"]},{"kind":"JOIN","substeps":["CROSS ALL WITH ALL "]},{"kind":"WRITE","substeps":["$190","TO __stage0D_output"]}],"writeRatioAvg":0.451063829787234}],"estimatedBytesProcessed":"1692487728","timeline":[{"totalSlotMs":"22835","activeUnits":"95","completedUnits":"105","elapsedMs":"661","pendingUnits":"87"},{"totalSlotMs":"39127","activeUnits":"92","completedUnits":"193","elapsedMs":"1124","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"1693450240","totalPartitionsProcessed":"0","totalBytesProcessed":"1692487728","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"time_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_page","datasetId":"scale_100"}]},"endTime":"1570993709788"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query90_1570993706"},"etag":"gnOm0KnhOv7DJX/mANqB4A==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query90_1570993706?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anoncbefa021933b97acc09b06756e80f6823a8f08b0","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"\n-- query90\nSELECT amc / pmc AS am_pm_ratio \nFROM (SELECT Count(*) amc \n FROM web_sales, \n household_demographics, \n time_dim, \n web_page \n WHERE ws_sold_time_sk = time_dim.t_time_sk \n AND ws_ship_hdemo_sk = household_demographics.hd_demo_sk \n AND ws_web_page_sk = web_page.wp_web_page_sk \n AND time_dim.t_hour BETWEEN 12 AND 12 + 1 \n AND household_demographics.hd_dep_count = 8 \n AND web_page.wp_char_count BETWEEN 5000 AND 5200) at1, \n (SELECT Count(*) pmc \n FROM web_sales, \n household_demographics, \n time_dim, \n web_page \n WHERE ws_sold_time_sk = time_dim.t_time_sk \n AND ws_ship_hdemo_sk = household_demographics.hd_demo_sk \n AND ws_web_page_sk = web_page.wp_web_page_sk \n AND time_dim.t_hour BETWEEN 20 AND 20 + 1 \n AND household_demographics.hd_dep_count = 8 \n AND web_page.wp_char_count BETWEEN 5000 AND 5200) pt \nORDER BY am_pm_ratio\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query90_1570993706","user_email":"nithish.sankaranarayanan@ulb.be"}
