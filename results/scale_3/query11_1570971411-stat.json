{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"388560","creationTime":"1570971412803","totalBytesProcessed":"1153270128","startTime":"1570971413072","query":{"totalSlotMs":"388560","queryPlan":[{"readMsMax":"9","computeMsMax":"5","waitMsAvg":"1","id":"0","endMs":"1570971413457","waitMsMax":"1","startMs":"1570971413283","waitRatioMax":1.7394026891165574e-05,"readRatioAvg":0.00015654624202049016,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":8.697013445582786e-05,"writeMsAvg":"156","status":"COMPLETE","writeMsMax":"156","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0027134681950218295,"readMsAvg":"9","waitRatioAvg":1.7394026891165574e-05,"completedParallelInputs":"1","computeRatioMax":8.697013445582786e-05,"name":"S00: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.00015654624202049016,"steps":[{"kind":"READ","substeps":["$110:d_date_sk, $111:d_year","FROM date_dim","WHERE equal($111, 2001)"]},{"kind":"WRITE","substeps":["$110, $111","TO __stage00_output","BY HASH($110)"]}],"writeRatioAvg":0.0027134681950218295},{"readMsMax":"301","computeMsMax":"1409","waitMsAvg":"39","id":"2","endMs":"1570971415073","waitMsMax":"39","startMs":"1570971413430","waitRatioMax":0.0006783670487554574,"readRatioAvg":0.005235602094240838,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.024508183889652292,"writeMsAvg":"114","status":"COMPLETE","writeMsMax":"114","computeMsAvg":"1409","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0019829190655928754,"readMsAvg":"301","waitRatioAvg":0.0006783670487554574,"completedParallelInputs":"1","computeRatioMax":0.024508183889652292,"name":"S02: Input","shuffleOutputBytes":"51365300","recordsWritten":"500000","readRatioMax":0.005235602094240838,"steps":[{"kind":"READ","substeps":["$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name, $94:c_preferred_cust_flag, $95:c_birth_country, $96:c_login, $97:c_email_address","FROM customer"]},{"kind":"WRITE","substeps":["$90, $91, $92, $93, $94, $95, $96, $97","TO __stage02_output","BY HASH($90)"]}],"writeRatioAvg":0.0019829190655928754},{"readMsMax":"8","computeMsMax":"8","waitMsAvg":"48","id":"3","endMs":"1570971413555","waitMsMax":"48","startMs":"1570971413458","waitRatioMax":0.0008349132907759475,"readRatioAvg":0.0001391522151293246,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0001391522151293246,"writeMsAvg":"37","status":"COMPLETE","writeMsMax":"37","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0006435789949731263,"readMsAvg":"8","waitRatioAvg":0.0008349132907759475,"completedParallelInputs":"1","computeRatioMax":0.0001391522151293246,"name":"S03: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0001391522151293246,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_year","FROM date_dim","WHERE equal($81, 2001)"]},{"kind":"WRITE","substeps":["$80, $81","TO __stage03_output","BY HASH($80)"]}],"writeRatioAvg":0.0006435789949731263},{"readMsMax":"167","computeMsMax":"1266","waitMsAvg":"111","id":"5","endMs":"1570971416727","waitMsMax":"111","startMs":"1570971413554","waitRatioMax":0.0019307369849193786,"readRatioAvg":0.0029048024908246506,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.022020838044215615,"writeMsAvg":"1046","status":"COMPLETE","writeMsMax":"1046","computeMsAvg":"1266","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01819415212815919,"readMsAvg":"167","waitRatioAvg":0.0019307369849193786,"completedParallelInputs":"1","computeRatioMax":0.022020838044215615,"name":"S05: Input","shuffleOutputBytes":"51365300","recordsWritten":"500000","readRatioMax":0.0029048024908246506,"steps":[{"kind":"READ","substeps":["$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name, $64:c_preferred_cust_flag, $65:c_birth_country, $66:c_login, $67:c_email_address","FROM customer"]},{"kind":"WRITE","substeps":["$60, $61, $62, $63, $64, $65, $66, $67","TO __stage05_output","BY HASH($60)"]}],"writeRatioAvg":0.01819415212815919},{"readMsMax":"16","computeMsMax":"10","waitMsAvg":"99","id":"6","endMs":"1570971413722","waitMsMax":"99","startMs":"1570971413555","waitRatioMax":0.0017220086622253918,"readRatioAvg":0.0002783044302586492,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.00017394026891165572,"writeMsAvg":"98","status":"COMPLETE","writeMsMax":"98","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0017046146353342263,"readMsAvg":"16","waitRatioAvg":0.0017220086622253918,"completedParallelInputs":"1","computeRatioMax":0.00017394026891165572,"name":"S06: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0002783044302586492,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year","FROM date_dim","WHERE equal($51, 2002)"]},{"kind":"WRITE","substeps":["$50, $51","TO __stage06_output","BY HASH($50)"]}],"writeRatioAvg":0.0017046146353342263},{"readMsMax":"156","computeMsMax":"1346","waitMsAvg":"45","id":"8","endMs":"1570971415090","waitMsMax":"45","startMs":"1570971413553","waitRatioMax":0.0007827312101024508,"readRatioAvg":0.0027134681950218295,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.023412360195508863,"writeMsAvg":"85","status":"COMPLETE","writeMsMax":"85","computeMsAvg":"1346","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0014784922857490738,"readMsAvg":"156","waitRatioAvg":0.0007827312101024508,"completedParallelInputs":"1","computeRatioMax":0.023412360195508863,"name":"S08: Input","shuffleOutputBytes":"51365300","recordsWritten":"500000","readRatioMax":0.0027134681950218295,"steps":[{"kind":"READ","substeps":["$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name, $34:c_preferred_cust_flag, $35:c_birth_country, $36:c_login, $37:c_email_address","FROM customer"]},{"kind":"WRITE","substeps":["$30, $31, $32, $33, $34, $35, $36, $37","TO __stage08_output","BY HASH($30)"]}],"writeRatioAvg":0.0014784922857490738},{"readMsMax":"10","computeMsMax":"10","waitMsAvg":"21","id":"9","endMs":"1570971413724","waitMsMax":"21","startMs":"1570971413555","waitRatioMax":0.00036527456471447707,"readRatioAvg":0.00017394026891165572,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.00017394026891165572,"writeMsAvg":"104","status":"COMPLETE","writeMsMax":"104","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0018089787966812196,"readMsAvg":"10","waitRatioAvg":0.00036527456471447707,"completedParallelInputs":"1","computeRatioMax":0.00017394026891165572,"name":"S09: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.00017394026891165572,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_year","FROM date_dim","WHERE equal($21, 2002)"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage09_output","BY HASH($20)"]}],"writeRatioAvg":0.0018089787966812196},{"readMsMax":"93","computeMsMax":"1555","waitMsAvg":"1","id":"11","endMs":"1570971472372","waitMsMax":"1","startMs":"1570971413562","waitRatioMax":1.7394026891165574e-05,"readRatioAvg":0.0016176445008783983,"parallelInputs":"1","recordsRead":"500000","computeRatioAvg":0.027047711815762467,"writeMsAvg":"57491","status":"COMPLETE","writeMsMax":"57491","computeMsAvg":"1555","shuffleOutputBytesSpilled":"0","writeRatioMax":1,"readMsAvg":"93","waitRatioAvg":1.7394026891165574e-05,"completedParallelInputs":"1","computeRatioMax":0.027047711815762467,"name":"S0B: Input","shuffleOutputBytes":"51365300","recordsWritten":"500000","readRatioMax":0.0016176445008783983,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name, $5:c_preferred_cust_flag, $6:c_birth_country, $7:c_login, $8:c_email_address","FROM customer"]},{"kind":"WRITE","substeps":["$1, $2, $3, $4, $5, $6, $7, $8","TO __stage0B_output","BY HASH($1)"]}],"writeRatioAvg":1},{"readMsMax":"51","computeMsMax":"6920","inputStages":["0","2"],"waitMsAvg":"1","id":"12","endMs":"1570971419143","waitMsMax":"1","startMs":"1570971415117","waitRatioMax":1.7394026891165574e-05,"readRatioAvg":0.0006783670487554574,"parallelInputs":"10","recordsRead":"33805762","computeRatioAvg":0.10843436363952619,"writeMsAvg":"50","status":"COMPLETE","writeMsMax":"98","computeMsAvg":"6234","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0017046146353342263,"readMsAvg":"39","waitRatioAvg":1.7394026891165574e-05,"completedParallelInputs":"10","computeRatioMax":0.12036666608686578,"name":"S0C: Join+","shuffleOutputBytes":"267307627","recordsWritten":"2393453","readRatioMax":0.0008870953714494443,"steps":[{"kind":"READ","substeps":["$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_ext_discount_amt, $103:ss_ext_list_price","FROM store_sales"]},{"kind":"READ","substeps":["$90, $91, $92, $93, $94, $95, $96, $97","FROM __stage02_output"]},{"kind":"READ","substeps":["$110, $111","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263, $274 := $264, $275 := $265, $276 := $266, $277 := $269","$200 := SUM($230)"]},{"kind":"COMPUTE","substeps":["$230 := subtract($268, $267)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $247 = $110"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $101 = $90"]},{"kind":"WRITE","substeps":["$270, $271, $272, $273, $274, $275, $276, $277, $200","TO __stage0C_output","BY HASH($270, $271, $272, $273, $274, $275, $276, $277)"]}],"writeRatioAvg":0.0008697013445582787},{"readMsMax":"125","computeMsMax":"7217","inputStages":["6","8"],"waitMsAvg":"2","id":"13","endMs":"1570971419260","waitMsMax":"3","startMs":"1570971415250","waitRatioMax":5.218208067349672e-05,"readRatioAvg":0.0007653371832112853,"parallelInputs":"10","recordsRead":"33805762","computeRatioAvg":0.10735593397227391,"writeMsAvg":"62","status":"COMPLETE","writeMsMax":"190","computeMsAvg":"6172","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003304865109321459,"readMsAvg":"44","waitRatioAvg":3.478805378233115e-05,"completedParallelInputs":"10","computeRatioMax":0.12553269207354195,"name":"S0D: Join+","shuffleOutputBytes":"268531697","recordsWritten":"2405223","readRatioMax":0.002174253361395697,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_ext_discount_amt, $43:ss_ext_list_price","FROM store_sales"]},{"kind":"READ","substeps":["$30, $31, $32, $33, $34, $35, $36, $37","FROM __stage08_output"]},{"kind":"READ","substeps":["$50, $51","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $320 := $310, $321 := $311, $322 := $312, $323 := $313, $324 := $314, $325 := $315, $326 := $316, $327 := $319","$180 := SUM($210)"]},{"kind":"COMPUTE","substeps":["$210 := subtract($318, $317)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $297 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $41 = $30"]},{"kind":"WRITE","substeps":["$320, $321, $322, $323, $324, $325, $326, $327, $180","TO __stage0D_output","BY HASH($320, $321, $322, $323, $324, $325, $326, $327)"]}],"writeRatioAvg":0.0010784296672522655},{"readMsMax":"52","computeMsMax":"4402","inputStages":["3","5"],"waitMsAvg":"1","id":"14","endMs":"1570971420462","waitMsMax":"2","startMs":"1570971417308","waitRatioMax":3.478805378233115e-05,"readRatioAvg":0.0006435789949731263,"parallelInputs":"4","recordsRead":"9202490","computeRatioAvg":0.06994138212937677,"writeMsAvg":"50","status":"COMPLETE","writeMsMax":"112","computeMsAvg":"4021","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0019481310118105442,"readMsAvg":"37","waitRatioAvg":1.7394026891165574e-05,"completedParallelInputs":"4","computeRatioMax":0.07656850637491086,"name":"S0E: Join+","shuffleOutputBytes":"45624054","recordsWritten":"408368","readRatioMax":0.0009044893983406098,"steps":[{"kind":"READ","substeps":["$70:ws_sold_date_sk, $71:ws_bill_customer_sk, $72:ws_ext_discount_amt, $73:ws_ext_list_price","FROM web_sales"]},{"kind":"READ","substeps":["$60, $61, $62, $63, $64, $65, $66, $67","FROM __stage05_output"]},{"kind":"READ","substeps":["$80, $81","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $380 := $370, $381 := $371, $382 := $372, $383 := $373, $384 := $374, $385 := $375, $386 := $376, $387 := $379","$190 := SUM($220)"]},{"kind":"COMPUTE","substeps":["$220 := subtract($378, $377)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $357 = $80"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $71 = $60"]},{"kind":"WRITE","substeps":["$380, $381, $382, $383, $384, $385, $386, $387, $190","TO __stage0E_output","BY HASH($380, $381, $382, $383, $384, $385, $386, $387)"]}],"writeRatioAvg":0.0008697013445582787},{"readMsMax":"0","computeMsMax":"5311","inputStages":["12"],"waitMsAvg":"1","id":"15","endMs":"1570971421037","waitMsMax":"1","startMs":"1570971418344","waitRatioMax":1.7394026891165574e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1754456","computeRatioAvg":0.09237967681898036,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"5311","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0003304865109321459,"readMsAvg":"0","waitRatioAvg":1.7394026891165574e-05,"completedParallelInputs":"1","computeRatioMax":0.09237967681898036,"name":"S0F: Repartition","shuffleOutputBytes":"195946825","recordsWritten":"1754456","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0C_output"]}],"writeRatioAvg":0.0003304865109321459},{"readMsMax":"0","computeMsMax":"6666","inputStages":["13"],"waitMsAvg":"1","id":"16","endMs":"1570971422812","waitMsMax":"1","startMs":"1570971418916","waitRatioMax":1.7394026891165574e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2258361","computeRatioAvg":0.11594858325650971,"writeMsAvg":"46","status":"COMPLETE","writeMsMax":"46","computeMsAvg":"6666","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0008001252369936164,"readMsAvg":"0","waitRatioAvg":1.7394026891165574e-05,"completedParallelInputs":"1","computeRatioMax":0.11594858325650971,"name":"S10: Repartition","shuffleOutputBytes":"252131933","recordsWritten":"2258361","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0D_output"]}],"writeRatioAvg":0.0008001252369936164},{"readMsMax":"49","computeMsMax":"4948","inputStages":["9","11"],"waitMsAvg":"4","id":"17","endMs":"1570971476457","waitMsMax":"6","startMs":"1570971473870","waitRatioMax":0.00010436416134699344,"readRatioAvg":0.0007479431563201197,"parallelInputs":"4","recordsRead":"9202490","computeRatioAvg":0.07766433006905428,"writeMsAvg":"35","status":"COMPLETE","writeMsMax":"38","computeMsAvg":"4465","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0006609730218642918,"readMsAvg":"43","waitRatioAvg":6.95761075646623e-05,"completedParallelInputs":"4","computeRatioMax":0.08606564505748726,"name":"S11: Join+","shuffleOutputBytes":"45829765","recordsWritten":"410121","readRatioMax":0.0008523073176671132,"steps":[{"kind":"READ","substeps":["$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_ext_discount_amt, $13:ws_ext_list_price","FROM web_sales"]},{"kind":"READ","substeps":["$1, $2, $3, $4, $5, $6, $7, $8","FROM __stage0B_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $440 := $430, $441 := $431, $442 := $432, $443 := $433, $444 := $434, $445 := $435, $446 := $436, $447 := $439","$150 := SUM($170)"]},{"kind":"COMPUTE","substeps":["$170 := subtract($438, $437)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $417 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $11 = $1"]},{"kind":"WRITE","substeps":["$440, $441, $442, $443, $444, $445, $446, $447, $150","TO __stage11_output","BY HASH($440, $441, $442, $443, $444, $445, $446, $447)"]}],"writeRatioAvg":0.0006087909411907951},{"readMsMax":"0","computeMsMax":"1156","inputStages":["17"],"waitMsAvg":"1","id":"18","endMs":"1570971477537","waitMsMax":"1","startMs":"1570971476861","waitRatioMax":1.7394026891165574e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"410121","computeRatioAvg":0.020107495086187404,"writeMsAvg":"42","status":"COMPLETE","writeMsMax":"42","computeMsAvg":"1156","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007305491294289541,"readMsAvg":"0","waitRatioAvg":1.7394026891165574e-05,"completedParallelInputs":"1","computeRatioMax":0.020107495086187404,"name":"S12: Aggregate","shuffleOutputBytes":"3194220","recordsWritten":"106474","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$440, $441, $442, $443, $444, $445, $446, $447, $150","FROM __stage11_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $450 := $440, $451 := $441, $452 := $442, $453 := $443, $454 := $444, $455 := $445, $456 := $446, $457 := $447","$120 := SUM($150)"]},{"kind":"WRITE","substeps":["$120, $450","TO __stage12_output","BY HASH($450)"]}],"writeRatioAvg":0.0007305491294289541},{"readMsMax":"0","computeMsMax":"1063","inputStages":["14"],"waitMsAvg":"1","id":"19","endMs":"1570971477465","waitMsMax":"1","startMs":"1570971476893","waitRatioMax":1.7394026891165574e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"408368","computeRatioAvg":0.018489850585309005,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"1063","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00034788053782331145,"readMsAvg":"0","waitRatioAvg":1.7394026891165574e-05,"completedParallelInputs":"1","computeRatioMax":0.018489850585309005,"name":"S13: Aggregate+","shuffleOutputBytes":"3177360","recordsWritten":"105912","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$380, $381, $382, $383, $384, $385, $386, $387, $190","FROM __stage0E_output"]},{"kind":"FILTER","substeps":["greater($140, 0)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $390 := $380, $391 := $381, $392 := $382, $393 := $383, $394 := $384, $395 := $385, $396 := $386, $397 := $387","$140 := SUM($190)"]},{"kind":"WRITE","substeps":["$140, $390","TO __stage13_output","BY HASH($390)"]}],"writeRatioAvg":0.00034788053782331145},{"readMsMax":"0","computeMsMax":"657","inputStages":["16","13"],"waitMsAvg":"2","id":"20","endMs":"1570971477463","waitMsMax":"2","startMs":"1570971476945","waitRatioMax":3.478805378233115e-05,"readRatioAvg":0,"parallelInputs":"10","recordsRead":"2405223","computeRatioAvg":0.009862413247290881,"writeMsAvg":"45","status":"COMPLETE","writeMsMax":"152","computeMsAvg":"567","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002643892087457167,"readMsAvg":"0","waitRatioAvg":3.478805378233115e-05,"completedParallelInputs":"10","computeRatioMax":0.011427875667495781,"name":"S14: Aggregate","shuffleOutputBytes":"19950007","recordsWritten":"309240","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$320, $321, $322, $323, $324, $325, $326, $327, $180","FROM __stage0D_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $330 := $320, $331 := $321, $332 := $322, $333 := $323, $334 := $324, $335 := $325, $336 := $326, $337 := $327","$130 := SUM($180)"]},{"kind":"WRITE","substeps":["$130, $330, $331, $332, $334","TO __stage14_output","BY HASH($330)"]}],"writeRatioAvg":0.0007827312101024508},{"readMsMax":"0","computeMsMax":"14","inputStages":["20"],"waitMsAvg":"1","id":"22","endMs":"1570971477747","waitMsMax":"3","startMs":"1570971477477","waitRatioMax":5.218208067349672e-05,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"309240","computeRatioAvg":0.00017394026891165572,"writeMsAvg":"62","status":"COMPLETE","writeMsMax":"94","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0016350385277695638,"readMsAvg":"0","waitRatioAvg":1.7394026891165574e-05,"completedParallelInputs":"100","computeRatioMax":0.00024351637647631802,"name":"S16: Coalesce","shuffleOutputBytes":"19950007","recordsWritten":"309240","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage14_output"]}],"writeRatioAvg":0.0010784296672522655},{"readMsMax":"0","computeMsMax":"10","inputStages":["19"],"waitMsAvg":"5","id":"24","endMs":"1570971477834","waitMsMax":"10","startMs":"1570971477561","waitRatioMax":0.00017394026891165572,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"105912","computeRatioAvg":0.00010436416134699344,"writeMsAvg":"38","status":"COMPLETE","writeMsMax":"67","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0011653998017080935,"readMsAvg":"0","waitRatioAvg":8.697013445582786e-05,"completedParallelInputs":"100","computeRatioMax":0.00017394026891165572,"name":"S18: Coalesce","shuffleOutputBytes":"3177360","recordsWritten":"105912","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage13_output"]}],"writeRatioAvg":0.0006609730218642918},{"readMsMax":"0","computeMsMax":"8","inputStages":["18"],"waitMsAvg":"1","id":"26","endMs":"1570971477874","waitMsMax":"2","startMs":"1570971477739","waitRatioMax":3.478805378233115e-05,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"106474","computeRatioAvg":0.00010436416134699344,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"53","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0009218834252317754,"readMsAvg":"0","waitRatioAvg":1.7394026891165574e-05,"completedParallelInputs":"100","computeRatioMax":0.0001391522151293246,"name":"S1A: Coalesce","shuffleOutputBytes":"3194220","recordsWritten":"106474","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage12_output"]}],"writeRatioAvg":0.0004522446991703049},{"readMsMax":"0","computeMsMax":"1526","inputStages":["15","12","26","24","22"],"waitMsAvg":"1","id":"27","endMs":"1570971479354","waitMsMax":"2","startMs":"1570971477742","waitRatioMax":3.478805378233115e-05,"readRatioAvg":0,"parallelInputs":"10","recordsRead":"7609713","computeRatioAvg":0.022194778313127272,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"1276","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0001391522151293246,"readMsAvg":"0","waitRatioAvg":1.7394026891165574e-05,"completedParallelInputs":"10","computeRatioMax":0.026543285035918667,"name":"S1B: Join+","shuffleOutputBytes":"55579","recordsWritten":"1000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$270, $271, $272, $273, $274, $275, $276, $277, $200","FROM __stage0C_output"]},{"kind":"READ","substeps":["$130, $330, $331, $332, $334","FROM __stage16_output"]},{"kind":"READ","substeps":["$140, $390","FROM __stage18_output"]},{"kind":"READ","substeps":["$120, $450","FROM __stage1A_output"]},{"kind":"SORT","substeps":["$460 ASC, $461 ASC, $462 ASC, $463 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["greater(case_no_value(greater($465, 0), divide($467, $465), 0), case_no_value(greater($466, 0), divide($464, $466), 0))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $404 = $450"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $340 = $390"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $280 = $330"]},{"kind":"FILTER","substeps":["greater($160, 0)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $280 := $270, $281 := $271, $282 := $272, $283 := $273, $284 := $274, $285 := $275, $286 := $276, $287 := $277","$160 := SUM($200)"]},{"kind":"WRITE","substeps":["$470, $471, $472, $473","TO __stage1B_output"]}],"writeRatioAvg":8.697013445582786e-05},{"readMsMax":"0","computeMsMax":"5","inputStages":["27"],"waitMsAvg":"0","id":"28","endMs":"1570971479457","waitMsMax":"0","startMs":"1570971477762","waitRatioMax":0,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1000","computeRatioAvg":8.697013445582786e-05,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00010436416134699344,"readMsAvg":"0","waitRatioAvg":0,"completedParallelInputs":"1","computeRatioMax":8.697013445582786e-05,"name":"S1C: Output","shuffleOutputBytes":"5467","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$470, $471, $472, $473","FROM __stage1B_output"]},{"kind":"SORT","substeps":["$470 ASC, $471 ASC, $472 ASC, $473 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$480, $481, $482, $483","TO __stage1C_output"]}],"writeRatioAvg":0.00010436416134699344}],"estimatedBytesProcessed":"1153270128","timeline":[{"totalSlotMs":"6010","activeUnits":"32","completedUnits":"4","elapsedMs":"713","pendingUnits":"32"},{"totalSlotMs":"95074","activeUnits":"22","completedUnits":"14","elapsedMs":"2683","pendingUnits":"22"},{"totalSlotMs":"140609","activeUnits":"23","completedUnits":"15","elapsedMs":"3769","pendingUnits":"21"},{"totalSlotMs":"233978","activeUnits":"27","completedUnits":"26","elapsedMs":"5657","pendingUnits":"11"},{"totalSlotMs":"252402","activeUnits":"9","completedUnits":"32","elapsedMs":"6693","pendingUnits":"6"},{"totalSlotMs":"261190","activeUnits":"4","completedUnits":"35","elapsedMs":"7895","pendingUnits":"3"},{"totalSlotMs":"264028","activeUnits":"2","completedUnits":"36","elapsedMs":"8470","pendingUnits":"2"},{"totalSlotMs":"268335","activeUnits":"1","completedUnits":"37","elapsedMs":"10245","pendingUnits":"1"},{"totalSlotMs":"301186","activeUnits":"0","completedUnits":"38","elapsedMs":"59804","pendingUnits":"0"},{"totalSlotMs":"303012","activeUnits":"4","completedUnits":"34","elapsedMs":"61303","pendingUnits":"4"},{"totalSlotMs":"327334","activeUnits":"9","completedUnits":"52","elapsedMs":"64295","pendingUnits":"8"},{"totalSlotMs":"385805","activeUnits":"11","completedUnits":"359","elapsedMs":"65810","pendingUnits":"2"},{"totalSlotMs":"388560","activeUnits":"3","completedUnits":"361","elapsedMs":"66749","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"1153433600","totalPartitionsProcessed":"0","totalBytesProcessed":"1153270128","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570971479862"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query11_1570971411"},"etag":"INrE7FfbD2hVVRxPXInkuw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query11_1570971411?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon916e9fecd610813c71d9a34e58918b2eaa8f0849","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query11\nWITH year_total \n AS (SELECT c_customer_id customer_id, \n c_first_name customer_first_name \n , \n c_last_name \n customer_last_name, \n c_preferred_cust_flag \n customer_preferred_cust_flag \n , \n c_birth_country \n customer_birth_country, \n c_login customer_login, \n c_email_address \n customer_email_address, \n d_year dyear, \n Sum(ss_ext_list_price - ss_ext_discount_amt) year_total, \n 's' sale_type \n FROM customer, \n store_sales, \n date_dim \n WHERE c_customer_sk = ss_customer_sk \n AND ss_sold_date_sk = d_date_sk \n GROUP BY c_customer_id, \n c_first_name, \n c_last_name, \n c_preferred_cust_flag, \n c_birth_country, \n c_login, \n c_email_address, \n d_year \n UNION ALL \n SELECT c_customer_id customer_id, \n c_first_name customer_first_name \n , \n c_last_name \n customer_last_name, \n c_preferred_cust_flag \n customer_preferred_cust_flag \n , \n c_birth_country \n customer_birth_country, \n c_login customer_login, \n c_email_address \n customer_email_address, \n d_year dyear, \n Sum(ws_ext_list_price - ws_ext_discount_amt) year_total, \n 'w' sale_type \n FROM customer, \n web_sales, \n date_dim \n WHERE c_customer_sk = ws_bill_customer_sk \n AND ws_sold_date_sk = d_date_sk \n GROUP BY c_customer_id, \n c_first_name, \n c_last_name, \n c_preferred_cust_flag, \n c_birth_country, \n c_login, \n c_email_address, \n d_year) \nSELECT t_s_secyear.customer_id, \n t_s_secyear.customer_first_name, \n t_s_secyear.customer_last_name, \n t_s_secyear.customer_birth_country \nFROM year_total t_s_firstyear, \n year_total t_s_secyear, \n year_total t_w_firstyear, \n year_total t_w_secyear \nWHERE t_s_secyear.customer_id = t_s_firstyear.customer_id \n AND t_s_firstyear.customer_id = t_w_secyear.customer_id \n AND t_s_firstyear.customer_id = t_w_firstyear.customer_id \n AND t_s_firstyear.sale_type = 's' \n AND t_w_firstyear.sale_type = 'w' \n AND t_s_secyear.sale_type = 's' \n AND t_w_secyear.sale_type = 'w' \n AND t_s_firstyear.dyear = 2001 \n AND t_s_secyear.dyear = 2001 + 1 \n AND t_w_firstyear.dyear = 2001 \n AND t_w_secyear.dyear = 2001 + 1 \n AND t_s_firstyear.year_total > 0 \n AND t_w_firstyear.year_total > 0 \n AND CASE \n WHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / \n t_w_firstyear.year_total \n ELSE 0.0 \n END > CASE \n WHEN t_s_firstyear.year_total > 0 THEN \n t_s_secyear.year_total / \n t_s_firstyear.year_total \n ELSE 0.0 \n END \nORDER BY t_s_secyear.customer_id, \n t_s_secyear.customer_first_name, \n t_s_secyear.customer_last_name, \n t_s_secyear.customer_birth_country\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query11_1570971411","user_email":"nithish.sankaranarayanan@ulb.be"}
