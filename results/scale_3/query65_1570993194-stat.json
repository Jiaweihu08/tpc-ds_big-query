{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"606397","creationTime":"1570993195449","totalBytesProcessed":"8746019145","startTime":"1570993195662","query":{"totalSlotMs":"606397","queryPlan":[{"readMsMax":"18","computeMsMax":"9","waitMsAvg":"1","id":"0","endMs":"1570993195871","waitMsMax":"1","startMs":"1570993195824","waitRatioMax":0.00016342539630658605,"readRatioAvg":0.002941657133518549,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0014708285667592745,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0009805523778395162,"readMsAvg":"18","waitRatioAvg":0.00016342539630658605,"completedParallelInputs":"1","computeRatioMax":0.0014708285667592745,"name":"S00: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.002941657133518549,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_month_seq","FROM date_dim","WHERE between($51, 1199, 1210)"]},{"kind":"WRITE","substeps":["$50","TO __stage00_output","BY HASH($50)"]}],"writeRatioAvg":0.0009805523778395162},{"readMsMax":"11","computeMsMax":"12","waitMsAvg":"15","id":"2","endMs":"1570993195992","waitMsMax":"15","startMs":"1570993195871","waitRatioMax":0.0024513809445987906,"readRatioAvg":0.0017976793593724465,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0019611047556790323,"writeMsAvg":"88","status":"COMPLETE","writeMsMax":"88","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.014381434874979572,"readMsAvg":"11","waitRatioAvg":0.0024513809445987906,"completedParallelInputs":"1","computeRatioMax":0.0019611047556790323,"name":"S02: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.0017976793593724465,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_month_seq","FROM date_dim","WHERE between($31, 1199, 1210)"]},{"kind":"WRITE","substeps":["$30","TO __stage02_output","BY HASH($30)"]}],"writeRatioAvg":0.014381434874979572},{"readMsMax":"123","computeMsMax":"1425","inputStages":["0"],"waitMsAvg":"3","id":"4","endMs":"1570993196849","waitMsMax":"9","startMs":"1570993195964","waitRatioMax":0.0014708285667592745,"readRatioAvg":0.0052296126818107535,"parallelInputs":"184","recordsRead":"281940267","computeRatioAvg":0.16816473279947705,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"137","computeMsAvg":"1029","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02238927929400229,"readMsAvg":"32","waitRatioAvg":0.0004902761889197581,"completedParallelInputs":"184","computeRatioMax":0.23288118973688512,"name":"S04: Join+","shuffleOutputBytes":"1430864911","recordsWritten":"53727349","readRatioMax":0.020101323745710085,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_item_sk, $42:ss_store_sk, $43:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$50","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $160 := $151, $161 := $150","$110 := SUM($152)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $50"]},{"kind":"WRITE","substeps":["$161, $160, $110","TO __stage04_output","BY HASH($160, $161)"]}],"writeRatioAvg":0.003431933322438307},{"readMsMax":"103","computeMsMax":"1343","inputStages":["2"],"waitMsAvg":"4","id":"5","endMs":"1570993197075","waitMsMax":"10","startMs":"1570993196041","waitRatioMax":0.0016342539630658604,"readRatioAvg":0.005066187285504167,"parallelInputs":"184","recordsRead":"281940267","computeRatioAvg":0.1616277169472136,"writeMsAvg":"41","status":"COMPLETE","writeMsMax":"276","computeMsAvg":"989","shuffleOutputBytesSpilled":"0","writeRatioMax":0.045105409380617745,"readMsAvg":"31","waitRatioAvg":0.0006537015852263442,"completedParallelInputs":"184","computeRatioMax":0.21948030723974504,"name":"S05: Join+","shuffleOutputBytes":"1430864911","recordsWritten":"53727349","readRatioMax":0.01683281581957836,"steps":[{"kind":"READ","substeps":["$20:ss_sold_date_sk, $21:ss_item_sk, $22:ss_store_sk, $23:ss_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$30","FROM __stage02_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $130 := $121, $131 := $120","$80 := SUM($122)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $30"]},{"kind":"WRITE","substeps":["$131, $130, $80","TO __stage05_output","BY HASH($130, $131)"]}],"writeRatioAvg":0.006700441248570028},{"readMsMax":"0","computeMsMax":"5620","inputStages":["4"],"waitMsAvg":"6","id":"6","endMs":"1570993199741","waitMsMax":"8","startMs":"1570993196878","waitRatioMax":0.0013074031704526884,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"53727349","computeRatioAvg":0.7427684262134335,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"26","computeMsAvg":"4545","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004249060303971237,"readMsAvg":"0","waitRatioAvg":0.0009805523778395162,"completedParallelInputs":"18","computeRatioMax":0.9184507272430136,"name":"S06: Aggregate","shuffleOutputBytes":"94392","recordsWritten":"3636","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$161, $160, $110","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $170","$90 := SHARD_AVG($100)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $170 := $160, $171 := $161","$100 := SUM($110)"]},{"kind":"WRITE","substeps":["$180, $90","TO __stage06_output","BY HASH($180)"]}],"writeRatioAvg":0.0013074031704526884},{"readMsMax":"0","computeMsMax":"2925","inputStages":["5"],"waitMsAvg":"1","id":"7","endMs":"1570993198559","waitMsMax":"1","startMs":"1570993197114","waitRatioMax":0.00016342539630658605,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2984898","computeRatioAvg":0.4780192841967642,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"2925","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004739336492890996,"readMsAvg":"0","waitRatioAvg":0.00016342539630658605,"completedParallelInputs":"1","computeRatioMax":0.4780192841967642,"name":"S07: Repartition","shuffleOutputBytes":"79502070","recordsWritten":"2984898","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage05_output"]}],"writeRatioAvg":0.004739336492890996},{"readMsMax":"49","computeMsMax":"726","waitMsAvg":"1","id":"8","endMs":"1570993202352","waitMsMax":"1","startMs":"1570993199778","waitRatioMax":0.00016342539630658605,"readRatioAvg":0.008007844419022716,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.11864683771858146,"writeMsAvg":"561","status":"COMPLETE","writeMsMax":"561","computeMsAvg":"726","shuffleOutputBytesSpilled":"0","writeRatioMax":0.09168164732799478,"readMsAvg":"49","waitRatioAvg":0.00016342539630658605,"completedParallelInputs":"1","computeRatioMax":0.11864683771858146,"name":"S08: Input","shuffleOutputBytes":"31245202","recordsWritten":"204000","readRatioMax":0.008007844419022716,"steps":[{"kind":"READ","substeps":["$1:i_item_sk, $2:i_item_desc, $3:i_current_price, $4:i_wholesale_cost, $5:i_brand","FROM item"]},{"kind":"WRITE","substeps":["$1, $2, $3, $4, $5","TO __stage08_output","BY HASH($1)"]}],"writeRatioAvg":0.09168164732799478},{"readMsMax":"59","computeMsMax":"7","waitMsAvg":"1","id":"9","endMs":"1570993199865","waitMsMax":"1","startMs":"1570993199792","waitRatioMax":0.00016342539630658605,"readRatioAvg":0.009642098382088576,"parallelInputs":"1","recordsRead":"402","computeRatioAvg":0.0011439777741461023,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"3","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0004902761889197581,"readMsAvg":"59","waitRatioAvg":0.00016342539630658605,"completedParallelInputs":"1","computeRatioMax":0.0011439777741461023,"name":"S09: Input","shuffleOutputBytes":"7181","recordsWritten":"402","readRatioMax":0.009642098382088576,"steps":[{"kind":"READ","substeps":["$10:s_store_sk, $11:s_store_name","FROM store"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage09_output","BY HASH($10)"]}],"writeRatioAvg":0.0004902761889197581},{"readMsMax":"0","computeMsMax":"13","inputStages":["6"],"waitMsAvg":"2","id":"10","endMs":"1570993199880","waitMsMax":"2","startMs":"1570993199809","waitRatioMax":0.0003268507926131721,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"3636","computeRatioAvg":0.0021245301519856184,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0016342539630658604,"readMsAvg":"0","waitRatioAvg":0.0003268507926131721,"completedParallelInputs":"1","computeRatioMax":0.0021245301519856184,"name":"S0A: Aggregate","shuffleOutputBytes":"3618","recordsWritten":"201","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$180, $90","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $180","$70 := ROOT_AVG($90)"]},{"kind":"WRITE","substeps":["$70, $190","TO __stage0A_output","BY HASH($190)"]}],"writeRatioAvg":0.0016342539630658604},{"readMsMax":"0","computeMsMax":"10","inputStages":["10"],"waitMsAvg":"1","id":"12","endMs":"1570993200001","waitMsMax":"4","startMs":"1570993199890","waitRatioMax":0.0006537015852263442,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"201","computeRatioAvg":0.0008171269815329302,"writeMsAvg":"39","status":"COMPLETE","writeMsMax":"58","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009478672985781991,"readMsAvg":"0","waitRatioAvg":0.00016342539630658605,"completedParallelInputs":"100","computeRatioMax":0.0016342539630658604,"name":"S0C: Coalesce","shuffleOutputBytes":"3618","recordsWritten":"201","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0A_output"]}],"writeRatioAvg":0.006373590455956856},{"readMsMax":"0","computeMsMax":"6119","inputStages":["7","5","8","9","12"],"waitMsAvg":"1","id":"14","endMs":"1570993206561","waitMsMax":"3","startMs":"1570993203005","waitRatioMax":0.0004902761889197581,"readRatioAvg":0,"parallelInputs":"27","recordsRead":"59251630","computeRatioAvg":0.5817944108514463,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"14","computeMsAvg":"3560","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0022879555482922045,"readMsAvg":"0","waitRatioAvg":0.00016342539630658605,"completedParallelInputs":"27","computeRatioMax":1,"name":"S0E: Join+","shuffleOutputBytes":"409050","recordsWritten":"2700","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$131, $130, $80","FROM __stage05_output"]},{"kind":"READ","substeps":["$70, $190","FROM __stage0C_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage09_output"]},{"kind":"READ","substeps":["$1, $2, $3, $4, $5","FROM __stage08_output"]},{"kind":"SORT","substeps":["$220 ASC, $222 ASC","LIMIT 100"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $210 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $201 = $10"]},{"kind":"FILTER","substeps":["less_or_equal($202, multiply(0.1, $203))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $140 = $190"]},{"kind":"AGGREGATE","substeps":["GROUP BY $140 := $130, $141 := $131","$60 := SUM($80)"]},{"kind":"WRITE","substeps":["$230, $231, $232, $233, $234, $235","TO __stage0E_output"]}],"writeRatioAvg":0.0009805523778395162},{"readMsMax":"0","computeMsMax":"10","inputStages":["14"],"waitMsAvg":"1","id":"15","endMs":"1570993206583","waitMsMax":"1","startMs":"1570993203090","waitRatioMax":0.00016342539630658605,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2700","computeRatioAvg":0.0016342539630658604,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0008171269815329302,"readMsAvg":"0","waitRatioAvg":0.00016342539630658605,"completedParallelInputs":"1","computeRatioMax":0.0016342539630658604,"name":"S0F: Output","shuffleOutputBytes":"6363","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$230, $231, $232, $233, $234, $235","FROM __stage0E_output"]},{"kind":"SORT","substeps":["$234 ASC, $230 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$240, $241, $242, $243, $244, $245","TO __stage0F_output"]}],"writeRatioAvg":0.0008171269815329302}],"estimatedBytesProcessed":"8746019145","timeline":[{"totalSlotMs":"60177","activeUnits":"368","completedUnits":"2","elapsedMs":"662","pendingUnits":"368"},{"totalSlotMs":"369699","activeUnits":"22","completedUnits":"370","elapsedMs":"1737","pendingUnits":"19"},{"totalSlotMs":"436423","activeUnits":"16","completedUnits":"385","elapsedMs":"3917","pendingUnits":"4"},{"totalSlotMs":"463208","activeUnits":"26","completedUnits":"501","elapsedMs":"4966","pendingUnits":"18"},{"totalSlotMs":"528122","activeUnits":"27","completedUnits":"492","elapsedMs":"7378","pendingUnits":"28"},{"totalSlotMs":"541798","activeUnits":"18","completedUnits":"502","elapsedMs":"7929","pendingUnits":"18"},{"totalSlotMs":"601681","activeUnits":"17","completedUnits":"513","elapsedMs":"10354","pendingUnits":"7"},{"totalSlotMs":"606397","activeUnits":"0","completedUnits":"520","elapsedMs":"11538","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"8746172416","totalPartitionsProcessed":"0","totalBytesProcessed":"8746019145","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"}]},"endTime":"1570993207223"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query65_1570993194"},"etag":"WqrMtFbgnYFnFb9u04V8XQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query65_1570993194?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonfb39ea686a665af79f31115333defd019b8e1b97","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query65\nSELECT s_store_name, \n i_item_desc, \n sc.revenue, \n i_current_price, \n i_wholesale_cost, \n i_brand \nFROM store, \n item, \n (SELECT ss_store_sk, \n Avg(revenue) AS ave \n FROM (SELECT ss_store_sk, \n ss_item_sk, \n Sum(ss_sales_price) AS revenue \n FROM store_sales, \n date_dim \n WHERE ss_sold_date_sk = d_date_sk \n AND d_month_seq BETWEEN 1199 AND 1199 + 11 \n GROUP BY ss_store_sk, \n ss_item_sk) sa \n GROUP BY ss_store_sk) sb, \n (SELECT ss_store_sk, \n ss_item_sk, \n Sum(ss_sales_price) AS revenue \n FROM store_sales, \n date_dim \n WHERE ss_sold_date_sk = d_date_sk \n AND d_month_seq BETWEEN 1199 AND 1199 + 11 \n GROUP BY ss_store_sk, \n ss_item_sk) sc \nWHERE sb.ss_store_sk = sc.ss_store_sk \n AND sc.revenue <= 0.1 benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results scale_2.zip warmup sb.ave \n AND s_store_sk = sc.ss_store_sk \n AND i_item_sk = sc.ss_item_sk \nORDER BY s_store_name, \n i_item_desc\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query65_1570993194","user_email":"nithish.sankaranarayanan@ulb.be"}
