{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"108159","creationTime":"1570972202962","totalBytesProcessed":"1588379809","startTime":"1570972203080","query":{"totalSlotMs":"108159","queryPlan":[{"readMsMax":"12","computeMsMax":"24","waitMsAvg":"16","id":"0","endMs":"1570972203429","waitMsMax":"16","startMs":"1570972203319","waitRatioMax":0.0067425200168563,"readRatioAvg":0.0050568900126422255,"parallelInputs":"1","recordsRead":"86400","computeRatioAvg":0.010113780025284451,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"24","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00969237252423093,"readMsAvg":"12","waitRatioAvg":0.0067425200168563,"completedParallelInputs":"1","computeRatioMax":0.010113780025284451,"name":"S00: Input","shuffleOutputBytes":"680400","recordsWritten":"25200","readRatioMax":0.0050568900126422255,"steps":[{"kind":"READ","substeps":["$1:t_time_sk, $2:t_hour, $3:t_minute, $4:t_meal_time","FROM time_dim","WHERE or(equal($4, 'breakfast'), equal($4, 'dinner'))"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.00969237252423093},{"readMsMax":"10","computeMsMax":"12","waitMsAvg":"9","id":"1","endMs":"1570972203448","waitMsMax":"9","startMs":"1570972203366","waitRatioMax":0.0037926675094816687,"readRatioAvg":0.004214075010535188,"parallelInputs":"1","recordsRead":"102000","computeRatioAvg":0.0050568900126422255,"writeMsAvg":"59","status":"COMPLETE","writeMsMax":"59","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.024863042562157607,"readMsAvg":"10","waitRatioAvg":0.0037926675094816687,"completedParallelInputs":"1","computeRatioMax":0.0050568900126422255,"name":"S01: Input","shuffleOutputBytes":"73255","recordsWritten":"1874","readRatioMax":0.004214075010535188,"steps":[{"kind":"READ","substeps":["$10:i_item_sk, $11:i_brand_id, $12:i_brand, $13:i_manager_id","FROM item","WHERE equal($13, 1)"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.024863042562157607},{"readMsMax":"10","computeMsMax":"8","waitMsAvg":"32","id":"2","endMs":"1570972255305","waitMsMax":"32","startMs":"1570972203407","waitRatioMax":0.0134850400337126,"readRatioAvg":0.004214075010535188,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.00337126000842815,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00337126000842815,"readMsAvg":"10","waitRatioAvg":0.0134850400337126,"completedParallelInputs":"1","computeRatioMax":0.00337126000842815,"name":"S02: Input","shuffleOutputBytes":"270","recordsWritten":"30","readRatioMax":0.004214075010535188,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_year, $72:d_moy","FROM date_dim","WHERE and(equal($72, 11), equal($71, 2001))"]},{"kind":"WRITE","substeps":["$70","TO __stage02_output","BY HASH($70)"]}],"writeRatioAvg":0.00337126000842815},{"readMsMax":"10","computeMsMax":"6","waitMsAvg":"28","id":"4","endMs":"1570972203634","waitMsMax":"28","startMs":"1570972203443","waitRatioMax":0.011799410029498525,"readRatioAvg":0.004214075010535188,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0025284450063211127,"writeMsAvg":"170","status":"COMPLETE","writeMsMax":"170","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.07163927517909818,"readMsAvg":"10","waitRatioAvg":0.011799410029498525,"completedParallelInputs":"1","computeRatioMax":0.0025284450063211127,"name":"S04: Input","shuffleOutputBytes":"270","recordsWritten":"30","readRatioMax":0.004214075010535188,"steps":[{"kind":"READ","substeps":["$60:d_date_sk, $61:d_year, $62:d_moy","FROM date_dim","WHERE and(equal($62, 11), equal($61, 2001))"]},{"kind":"WRITE","substeps":["$60","TO __stage04_output","BY HASH($60)"]}],"writeRatioAvg":0.07163927517909818},{"readMsMax":"16","computeMsMax":"10","waitMsAvg":"17","id":"6","endMs":"1570972203563","waitMsMax":"17","startMs":"1570972203467","waitRatioMax":0.007163927517909819,"readRatioAvg":0.0067425200168563,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.004214075010535188,"writeMsAvg":"53","status":"COMPLETE","writeMsMax":"53","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.022334597555836493,"readMsAvg":"16","waitRatioAvg":0.007163927517909819,"completedParallelInputs":"1","computeRatioMax":0.004214075010535188,"name":"S06: Input","shuffleOutputBytes":"270","recordsWritten":"30","readRatioMax":0.0067425200168563,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year, $52:d_moy","FROM date_dim","WHERE and(equal($52, 11), equal($51, 2001))"]},{"kind":"WRITE","substeps":["$50","TO __stage06_output","BY HASH($50)"]}],"writeRatioAvg":0.022334597555836493},{"readMsMax":"238","computeMsMax":"2373","inputStages":["0","2","4","6","1"],"waitMsAvg":"5","id":"8","endMs":"1570972256789","waitMsMax":"7","startMs":"1570972255333","waitRatioMax":0.0029498525073746312,"readRatioAvg":0.021491782553729456,"parallelInputs":"22","recordsRead":"50996753","computeRatioAvg":0.6034555415086389,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"13","computeMsAvg":"1432","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005478297513695744,"readMsAvg":"51","waitRatioAvg":0.002107037505267594,"completedParallelInputs":"22","computeRatioMax":1,"name":"S08: Join+","shuffleOutputBytes":"619038","recordsWritten":"10827","readRatioMax":0.10029498525073746,"steps":[{"kind":"READ","substeps":["$20:ws_sold_date_sk, $21:ws_sold_time_sk, $22:ws_item_sk, $23:ws_ext_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$50","FROM __stage06_output"]},{"kind":"READ","substeps":["$30:cs_sold_date_sk, $31:cs_sold_time_sk, $32:cs_item_sk, $33:cs_ext_sales_price","FROM catalog_sales"]},{"kind":"READ","substeps":["$60","FROM __stage04_output"]},{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_sold_time_sk, $42:ss_item_sk, $43:ss_ext_sales_price","FROM store_sales"]},{"kind":"READ","substeps":["$70","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage01_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $181, $191 := $180, $192 := $183, $193 := $184","$90 := SUM($182)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $173 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $101 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $30 = $60"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $70"]},{"kind":"WRITE","substeps":["$192, $193, $191, $190, $90","TO __stage08_output","BY HASH($190, $191, $192, $193)"]}],"writeRatioAvg":0.0025284450063211127},{"readMsMax":"0","computeMsMax":"18","inputStages":["8"],"waitMsAvg":"1","id":"9","endMs":"1570972256895","waitMsMax":"2","startMs":"1570972256841","waitRatioMax":0.0008428150021070375,"readRatioAvg":0,"parallelInputs":"2","recordsRead":"10827","computeRatioAvg":0.007163927517909819,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"17","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009270965023177412,"readMsAvg":"0","waitRatioAvg":0.00042140750105351877,"completedParallelInputs":"2","computeRatioMax":0.007585335018963337,"name":"S09: Aggregate","shuffleOutputBytes":"563993","recordsWritten":"9869","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$192, $193, $191, $190, $90","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $200 := $190, $201 := $191, $202 := $192, $203 := $193","$80 := SUM($90)"]},{"kind":"WRITE","substeps":["$202, $203, $201, $200, $80","TO __stage09_output"]}],"writeRatioAvg":0.008849557522123894},{"readMsMax":"0","computeMsMax":"56","inputStages":["9"],"waitMsAvg":"115","id":"10","endMs":"1570972257132","waitMsMax":"115","startMs":"1570972257014","waitRatioMax":0.04846186262115466,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"9869","computeRatioAvg":0.02359882005899705,"writeMsAvg":"80","status":"COMPLETE","writeMsMax":"80","computeMsAvg":"56","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0337126000842815,"readMsAvg":"0","waitRatioAvg":0.04846186262115466,"completedParallelInputs":"1","computeRatioMax":0.02359882005899705,"name":"S0A: Output","shuffleOutputBytes":"494990","recordsWritten":"9869","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$202, $203, $201, $200, $80","FROM __stage09_output"]},{"kind":"SORT","substeps":["$80 DESC, $201 ASC"]},{"kind":"WRITE","substeps":["$210, $211, $212, $213, $214","TO __stage0A_output"]}],"writeRatioAvg":0.0337126000842815}],"estimatedBytesProcessed":"1588379809","timeline":[{"totalSlotMs":"2863","activeUnits":"11","completedUnits":"4","elapsedMs":"740","pendingUnits":"11"},{"totalSlotMs":"54629","activeUnits":"4","completedUnits":"14","elapsedMs":"3781","pendingUnits":"1"},{"totalSlotMs":"104127","activeUnits":"22","completedUnits":"20","elapsedMs":"53338","pendingUnits":"7"},{"totalSlotMs":"108159","activeUnits":"0","completedUnits":"30","elapsedMs":"54721","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"1588592640","totalPartitionsProcessed":"0","totalBytesProcessed":"1588379809","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"time_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570972257840"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query71_1570972201"},"etag":"OhmlATVClSIcUk03X1mEVg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query71_1570972201?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon971549b7d321ee6730e7f628fcb19f786cd7c9e9","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query71\nSELECT i_brand_id brand_id, \n i_brand brand, \n t_hour, \n t_minute, \n Sum(ext_price) ext_price \nFROM item, \n (SELECT ws_ext_sales_price AS ext_price, \n ws_sold_date_sk AS sold_date_sk, \n ws_item_sk AS sold_item_sk, \n ws_sold_time_sk AS time_sk \n FROM web_sales, \n date_dim \n WHERE d_date_sk = ws_sold_date_sk \n AND d_moy = 11 \n AND d_year = 2001 \n UNION ALL \n SELECT cs_ext_sales_price AS ext_price, \n cs_sold_date_sk AS sold_date_sk, \n cs_item_sk AS sold_item_sk, \n cs_sold_time_sk AS time_sk \n FROM catalog_sales, \n date_dim \n WHERE d_date_sk = cs_sold_date_sk \n AND d_moy = 11 \n AND d_year = 2001 \n UNION ALL \n SELECT ss_ext_sales_price AS ext_price, \n ss_sold_date_sk AS sold_date_sk, \n ss_item_sk AS sold_item_sk, \n ss_sold_time_sk AS time_sk \n FROM store_sales, \n date_dim \n WHERE d_date_sk = ss_sold_date_sk \n AND d_moy = 11 \n AND d_year = 2001) AS tmp, \n time_dim \nWHERE sold_item_sk = i_item_sk \n AND i_manager_id = 1 \n AND time_sk = t_time_sk \n AND ( t_meal_time = 'breakfast' \n OR t_meal_time = 'dinner' ) \nGROUP BY i_brand, \n i_brand_id, \n t_hour, \n t_minute \nORDER BY ext_price DESC, \n i_brand_id; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query71_1570972201","user_email":"nithish.sankaranarayanan@ulb.be"}
