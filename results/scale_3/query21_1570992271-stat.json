{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"143585","creationTime":"1570992273162","totalBytesProcessed":"12627213680","startTime":"1570992273273","query":{"totalSlotMs":"143585","queryPlan":[{"readMsMax":"13","computeMsMax":"22","waitMsAvg":"2","id":"0","endMs":"1570992273523","waitMsMax":"2","startMs":"1570992273439","waitRatioMax":0.0004982561036372695,"readRatioAvg":0.0032386646736422523,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.005480817140009965,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"22","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0017438963627304435,"readMsAvg":"13","waitRatioAvg":0.0004982561036372695,"completedParallelInputs":"1","computeRatioMax":0.005480817140009965,"name":"S00: Input","shuffleOutputBytes":"1488","recordsWritten":"62","readRatioMax":0.0032386646736422523,"steps":[{"kind":"READ","substeps":["$1:d_date_sk, $2:d_date","FROM date_dim","WHERE between(CAST($2 AS DATE), 11060, 11121)"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.0017438963627304435},{"readMsMax":"14","computeMsMax":"28","waitMsAvg":"12","id":"1","endMs":"1570992273539","waitMsMax":"12","startMs":"1570992273474","waitRatioMax":0.0029895366218236174,"readRatioAvg":0.003487792725460887,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.006975585450921774,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"28","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004733432984554061,"readMsAvg":"14","waitRatioAvg":0.0029895366218236174,"completedParallelInputs":"1","computeRatioMax":0.006975585450921774,"name":"S01: Input","shuffleOutputBytes":"383490","recordsWritten":"12783","readRatioMax":0.003487792725460887,"steps":[{"kind":"READ","substeps":["$30:i_item_sk, $31:i_item_id, $32:i_current_price","FROM item","WHERE between($32, 0.99, 1.49)"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage01_output","BY HASH($30)"]}],"writeRatioAvg":0.004733432984554061},{"readMsMax":"33","computeMsMax":"5","waitMsAvg":"36","id":"2","endMs":"1570992273580","waitMsMax":"36","startMs":"1570992273517","waitRatioMax":0.008968609865470852,"readRatioAvg":0.008221225710014948,"parallelInputs":"1","recordsRead":"15","computeRatioAvg":0.001245640259093174,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0014947683109118087,"readMsAvg":"33","waitRatioAvg":0.008968609865470852,"completedParallelInputs":"1","computeRatioMax":0.001245640259093174,"name":"S02: Input","shuffleOutputBytes":"440","recordsWritten":"15","readRatioMax":0.008221225710014948,"steps":[{"kind":"READ","substeps":["$20:w_warehouse_sk, $21:w_warehouse_name","FROM warehouse"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.0014947683109118087},{"readMsMax":"231","computeMsMax":"4014","inputStages":["0","1","2"],"waitMsAvg":"2","id":"4","endMs":"1570992277913","waitMsMax":"3","startMs":"1570992273684","waitRatioMax":0.0007473841554559044,"readRatioAvg":0.03811659192825112,"parallelInputs":"40","recordsRead":"399844400","computeRatioAvg":0.841803687095167,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"70","computeMsAvg":"3379","shuffleOutputBytesSpilled":"0","writeRatioMax":0.017438963627304436,"readMsAvg":"153","waitRatioAvg":0.0004982561036372695,"completedParallelInputs":"40","computeRatioMax":1,"name":"S04: Join+","shuffleOutputBytes":"45615710","recordsWritten":"773517","readRatioMax":0.05754857997010463,"steps":[{"kind":"READ","substeps":["$10:inv_date_sk, $11:inv_item_sk, $12:inv_warehouse_sk, $13:inv_quantity_on_hand","FROM inventory"]},{"kind":"READ","substeps":["$20, $21","FROM __stage02_output"]},{"kind":"READ","substeps":["$30, $31","FROM __stage01_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $100 := $91, $101 := $92","$50 := SUM($61)","$51 := SUM($60)"]},{"kind":"COMPUTE","substeps":["$60 := case_no_value(greater_or_equal(CAST($93 AS DATE), 11090), $90, 0)","$61 := case_no_value(less(CAST($93 AS DATE), 11090), $90, 0)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $80 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $71 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $12 = $20"]},{"kind":"WRITE","substeps":["$100, $101, $50, $51","TO __stage04_output","BY HASH($100, $101)"]}],"writeRatioAvg":0.0017438963627304435},{"readMsMax":"0","computeMsMax":"265","inputStages":["4"],"waitMsAvg":"1","id":"5","endMs":"1570992278333","waitMsMax":"2","startMs":"1570992278182","waitRatioMax":0.0004982561036372695,"readRatioAvg":0,"parallelInputs":"4","recordsRead":"773517","computeRatioAvg":0.05480817140009965,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"220","shuffleOutputBytesSpilled":"0","writeRatioMax":0.000996512207274539,"readMsAvg":"0","waitRatioAvg":0.00024912805181863477,"completedParallelInputs":"4","computeRatioMax":0.06601893373193822,"name":"S05: Sort+","shuffleOutputBytes":"21600","recordsWritten":"400","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$100, $101, $50, $51","FROM __stage04_output"]},{"kind":"SORT","substeps":["$110 ASC, $111 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["between(case_no_value(greater($40, 0), divide(CAST($41 AS DOUBLE), CAST($40 AS DOUBLE)), NULL), 0.66666666666666663, 1.5)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $110 := $100, $111 := $101","$40 := SUM($50)","$41 := SUM($51)"]},{"kind":"WRITE","substeps":["$120, $121, $122, $123","TO __stage05_output"]}],"writeRatioAvg":0.0007473841554559044},{"readMsMax":"0","computeMsMax":"7","inputStages":["5"],"waitMsAvg":"2","id":"6","endMs":"1570992278353","waitMsMax":"2","startMs":"1570992278260","waitRatioMax":0.0004982561036372695,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"400","computeRatioAvg":0.0017438963627304435,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0014947683109118087,"readMsAvg":"0","waitRatioAvg":0.0004982561036372695,"completedParallelInputs":"1","computeRatioMax":0.0017438963627304435,"name":"S06: Output","shuffleOutputBytes":"5400","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$120, $121, $122, $123","FROM __stage05_output"]},{"kind":"SORT","substeps":["$120 ASC, $121 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$130, $131, $132, $133","TO __stage06_output"]}],"writeRatioAvg":0.0014947683109118087}],"estimatedBytesProcessed":"12627213680","timeline":[{"totalSlotMs":"3807","activeUnits":"40","completedUnits":"3","elapsedMs":"668","pendingUnits":"40"},{"totalSlotMs":"137324","activeUnits":"9","completedUnits":"42","elapsedMs":"3062","pendingUnits":"1"},{"totalSlotMs":"143585","activeUnits":"2","completedUnits":"48","elapsedMs":"5272","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"12628000768","totalPartitionsProcessed":"0","totalBytesProcessed":"12627213680","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"inventory","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"warehouse","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_100"}]},"endTime":"1570992278583"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query21_1570992271"},"etag":"WdUwhktHFo/9EP9ztc77hQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query21_1570992271?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon20a97497be5a4b3f3fdca0f5fcf6b9b675a8cd16","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query21\nSELECT\n benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results scale_2.zip warmup \nFROM ( \n SELECT w_warehouse_name , \n i_item_id , \n Sum( \n CASE \n WHEN ( \n Cast(d_date AS DATE) < Cast ('2000-05-13' AS DATE)) THEN inv_quantity_on_hand \n ELSE 0 \n END) AS inv_before , \n Sum( \n CASE \n WHEN ( \n Cast(d_date AS DATE) >= Cast ('2000-05-13' AS DATE)) THEN inv_quantity_on_hand \n ELSE 0 \n END) AS inv_after \n FROM inventory , \n warehouse , \n item , \n date_dim \n WHERE i_current_price BETWEEN 0.99 AND 1.49 \n AND i_item_sk = inv_item_sk \n AND inv_warehouse_sk = w_warehouse_sk \n AND inv_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN (Cast ('2000-04-13' AS DATE)) AND ( \n cast ('2000-06-13' AS date)) \n GROUP BY w_warehouse_name, \n i_item_id) x \nWHERE ( \n CASE \n WHEN inv_before > 0 THEN inv_after / inv_before \n ELSE NULL \n END) BETWEEN 2.0/3.0 AND 3.0/2.0 \nORDER BY w_warehouse_name , \n i_item_id \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query21_1570992271","user_email":"nithish.sankaranarayanan@ulb.be"}
