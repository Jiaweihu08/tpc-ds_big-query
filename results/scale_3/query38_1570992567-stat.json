{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"1797845","creationTime":"1570992569652","totalBytesProcessed":"7775774924","startTime":"1570992569848","query":{"totalSlotMs":"1797845","queryPlan":[{"readMsMax":"46","computeMsMax":"2840","waitMsAvg":"1","id":"0","endMs":"1570992571581","waitMsMax":"1","startMs":"1570992570029","waitRatioMax":0.00015453562046051616,"readRatioAvg":0.007108638541183743,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.4388811621078659,"writeMsAvg":"80","status":"COMPLETE","writeMsMax":"80","computeMsAvg":"2840","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012362849636841292,"readMsAvg":"46","waitRatioAvg":0.00015453562046051616,"completedParallelInputs":"1","computeRatioMax":0.4388811621078659,"name":"S00: Input","shuffleOutputBytes":"60541144","recordsWritten":"2000000","readRatioMax":0.007108638541183743,"steps":[{"kind":"READ","substeps":["$20:c_customer_sk, $21:c_first_name, $22:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$20, $21, $22","TO __stage00_output","BY HASH($20)"]}],"writeRatioAvg":0.012362849636841292},{"readMsMax":"13","computeMsMax":"8","waitMsAvg":"26","id":"1","endMs":"1570992570148","waitMsMax":"26","startMs":"1570992570071","waitRatioMax":0.00401792613197342,"readRatioAvg":0.00200896306598671,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0012362849636841293,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001081749343223613,"readMsAvg":"13","waitRatioAvg":0.00401792613197342,"completedParallelInputs":"1","computeRatioMax":0.0012362849636841293,"name":"S01: Input","shuffleOutputBytes":"8760","recordsWritten":"365","readRatioMax":0.00200896306598671,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_date, $82:d_month_seq","FROM date_dim","WHERE between($82, 1188, 1199)"]},{"kind":"WRITE","substeps":["$80, $81","TO __stage01_output","BY HASH($80)"]}],"writeRatioAvg":0.001081749343223613},{"readMsMax":"26","computeMsMax":"2612","waitMsAvg":"53","id":"3","endMs":"1570992571541","waitMsMax":"53","startMs":"1570992570129","waitRatioMax":0.008190387884407357,"readRatioAvg":0.00401792613197342,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.40364704064286816,"writeMsAvg":"167","status":"COMPLETE","writeMsMax":"167","computeMsAvg":"2612","shuffleOutputBytesSpilled":"0","writeRatioMax":0.025807448616906196,"readMsAvg":"26","waitRatioAvg":0.008190387884407357,"completedParallelInputs":"1","computeRatioMax":0.40364704064286816,"name":"S03: Input","shuffleOutputBytes":"60541144","recordsWritten":"2000000","readRatioMax":0.00401792613197342,"steps":[{"kind":"READ","substeps":["$10:c_customer_sk, $11:c_first_name, $12:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage03_output","BY HASH($10)"]}],"writeRatioAvg":0.025807448616906196},{"readMsMax":"19","computeMsMax":"10","waitMsAvg":"47","id":"4","endMs":"1570992570430","waitMsMax":"47","startMs":"1570992570143","waitRatioMax":0.007263174161644259,"readRatioAvg":0.0029361767887498068,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0015453562046051615,"writeMsAvg":"253","status":"COMPLETE","writeMsMax":"253","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03909751197651059,"readMsAvg":"19","waitRatioAvg":0.007263174161644259,"completedParallelInputs":"1","computeRatioMax":0.0015453562046051615,"name":"S04: Input","shuffleOutputBytes":"8760","recordsWritten":"365","readRatioMax":0.0029361767887498068,"steps":[{"kind":"READ","substeps":["$70:d_date_sk, $71:d_date, $72:d_month_seq","FROM date_dim","WHERE between($72, 1188, 1199)"]},{"kind":"WRITE","substeps":["$70, $71","TO __stage04_output","BY HASH($70)"]}],"writeRatioAvg":0.03909751197651059},{"readMsMax":"26","computeMsMax":"2788","waitMsAvg":"15","id":"6","endMs":"1570992571804","waitMsMax":"15","startMs":"1570992570148","waitRatioMax":0.0023180343069077423,"readRatioAvg":0.00401792613197342,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.430845309843919,"writeMsAvg":"170","status":"COMPLETE","writeMsMax":"170","computeMsAvg":"2788","shuffleOutputBytesSpilled":"0","writeRatioMax":0.026271055478287744,"readMsAvg":"26","waitRatioAvg":0.0023180343069077423,"completedParallelInputs":"1","computeRatioMax":0.430845309843919,"name":"S06: Input","shuffleOutputBytes":"60541144","recordsWritten":"2000000","readRatioMax":0.00401792613197342,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_first_name, $3:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$1, $2, $3","TO __stage06_output","BY HASH($1)"]}],"writeRatioAvg":0.026271055478287744},{"readMsMax":"9","computeMsMax":"9","waitMsAvg":"12","id":"7","endMs":"1570992570299","waitMsMax":"12","startMs":"1570992570248","waitRatioMax":0.0018544274455261937,"readRatioAvg":0.0013908205841446453,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0013908205841446453,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003090712409210323,"readMsAvg":"9","waitRatioAvg":0.0018544274455261937,"completedParallelInputs":"1","computeRatioMax":0.0013908205841446453,"name":"S07: Input","shuffleOutputBytes":"8760","recordsWritten":"365","readRatioMax":0.0013908205841446453,"steps":[{"kind":"READ","substeps":["$60:d_date_sk, $61:d_date, $62:d_month_seq","FROM date_dim","WHERE between($62, 1188, 1199)"]},{"kind":"WRITE","substeps":["$60, $61","TO __stage07_output","BY HASH($60)"]}],"writeRatioAvg":0.003090712409210323},{"readMsMax":"0","computeMsMax":"37","inputStages":["3"],"waitMsAvg":"1","id":"12","endMs":"1570992572719","waitMsMax":"3","startMs":"1570992571890","waitRatioMax":0.0004636068613815484,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2000000","computeRatioAvg":0.0037088548910523874,"writeMsAvg":"164","status":"COMPLETE","writeMsMax":"253","computeMsAvg":"24","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03909751197651059,"readMsAvg":"0","waitRatioAvg":0.00015453562046051616,"completedParallelInputs":"100","computeRatioMax":0.005717817957039097,"name":"S0C: Coalesce","shuffleOutputBytes":"60541144","recordsWritten":"2000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage03_output"]}],"writeRatioAvg":0.02534384175552465},{"readMsMax":"80","computeMsMax":"3264","inputStages":["12","4"],"waitMsAvg":"9","id":"13","endMs":"1570992575792","waitMsMax":"13","startMs":"1570992572011","waitRatioMax":0.00200896306598671,"readRatioAvg":0.003245248029670839,"parallelInputs":"184","recordsRead":"649940083","computeRatioAvg":0.3588317107093185,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"364","computeMsAvg":"2322","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05625096584762788,"readMsAvg":"21","waitRatioAvg":0.0013908205841446453,"completedParallelInputs":"184","computeRatioMax":0.5044042651831248,"name":"S0D: Join+","shuffleOutputBytes":"169707583","recordsWritten":"4658284","readRatioMax":0.012362849636841292,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_customer_sk","FROM store_sales"]},{"kind":"READ","substeps":["$70, $71","FROM __stage04_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage0C_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $130 := $122, $131 := $121, $132 := $120"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $110 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $70"]},{"kind":"WRITE","substeps":["$131, $130, $132","TO __stage0D_output","BY HASH($130, $131, $132)"]}],"writeRatioAvg":0.0037088548910523874},{"readMsMax":"0","computeMsMax":"33","inputStages":["0"],"waitMsAvg":"12","id":"14","endMs":"1570992572758","waitMsMax":"14","startMs":"1570992572011","waitRatioMax":0.002163498686447226,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2000000","computeRatioAvg":0.0037088548910523874,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"154","computeMsAvg":"24","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02379848555091949,"readMsAvg":"0","waitRatioAvg":0.0018544274455261937,"completedParallelInputs":"100","computeRatioMax":0.005099675475197033,"name":"S0E: Coalesce","shuffleOutputBytes":"60541144","recordsWritten":"2000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage00_output"]}],"writeRatioAvg":0.0029361767887498068},{"readMsMax":"30","computeMsMax":"3267","inputStages":["14","1"],"waitMsAvg":"5","id":"15","endMs":"1570992574543","waitMsMax":"8","startMs":"1570992572029","waitRatioMax":0.0012362849636841293,"readRatioAvg":0.0024725699273682586,"parallelInputs":"141","recordsRead":"202061916","computeRatioAvg":0.09921186833565136,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"44","computeMsAvg":"642","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006799567300262711,"readMsAvg":"16","waitRatioAvg":0.0007726781023025807,"completedParallelInputs":"141","computeRatioMax":0.5048678720445062,"name":"S0F: Join+","shuffleOutputBytes":"110912439","recordsWritten":"3025490","readRatioMax":0.004636068613815485,"steps":[{"kind":"READ","substeps":["$50:cs_sold_date_sk, $51:cs_bill_customer_sk","FROM catalog_sales"]},{"kind":"READ","substeps":["$80, $81","FROM __stage01_output"]},{"kind":"READ","substeps":["$20, $21, $22","FROM __stage0E_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $170 := $162, $171 := $161, $172 := $160"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $150 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $50 = $80"]},{"kind":"WRITE","substeps":["$171, $170, $172","TO __stage0F_output","BY HASH($170, $171, $172)"]}],"writeRatioAvg":0.0013908205841446453},{"readMsMax":"0","computeMsMax":"32","inputStages":["6"],"waitMsAvg":"7","id":"16","endMs":"1570992572804","waitMsMax":"8","startMs":"1570992572032","waitRatioMax":0.0012362849636841293,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2000000","computeRatioAvg":0.0038633905115129036,"writeMsAvg":"49","status":"COMPLETE","writeMsMax":"173","computeMsAvg":"25","shuffleOutputBytesSpilled":"0","writeRatioMax":0.026734662339669295,"readMsAvg":"0","waitRatioAvg":0.001081749343223613,"completedParallelInputs":"100","computeRatioMax":0.004945139854736517,"name":"S10: Coalesce","shuffleOutputBytes":"60541144","recordsWritten":"2000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage06_output"]}],"writeRatioAvg":0.007572245402565291},{"readMsMax":"82","computeMsMax":"2576","inputStages":["16","7"],"waitMsAvg":"1","id":"17","endMs":"1570992574296","waitMsMax":"5","startMs":"1570992572063","waitRatioMax":0.0007726781023025807,"readRatioAvg":0.0023180343069077423,"parallelInputs":"92","recordsRead":"254507655","computeRatioAvg":0.3262246947921496,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"2111","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0044815329933549685,"readMsAvg":"15","waitRatioAvg":0.00015453562046051616,"completedParallelInputs":"92","computeRatioMax":0.3980837583062896,"name":"S11: Join+","shuffleOutputBytes":"42529684","recordsWritten":"1169282","readRatioMax":0.012671920877762324,"steps":[{"kind":"READ","substeps":["$30:ws_sold_date_sk, $31:ws_bill_customer_sk","FROM web_sales"]},{"kind":"READ","substeps":["$60, $61","FROM __stage07_output"]},{"kind":"READ","substeps":["$1, $2, $3","FROM __stage10_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $220 := $212, $221 := $211, $222 := $210"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $200 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $30 = $60"]},{"kind":"WRITE","substeps":["$221, $220, $222","TO __stage11_output","BY HASH($220, $221, $222)"]}],"writeRatioAvg":0.003090712409210323},{"readMsMax":"0","computeMsMax":"396","inputStages":["17"],"waitMsAvg":"1","id":"18","endMs":"1570992576085","waitMsMax":"1","startMs":"1570992575832","waitRatioMax":0.00015453562046051616,"readRatioAvg":0,"parallelInputs":"9","recordsRead":"1169282","computeRatioAvg":0.056096430227167364,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"30","computeMsAvg":"363","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004636068613815485,"readMsAvg":"0","waitRatioAvg":0.00015453562046051616,"completedParallelInputs":"9","computeRatioMax":0.061196105702364396,"name":"S12: Aggregate","shuffleOutputBytes":"40682300","recordsWritten":"1100320","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$221, $220, $222","FROM __stage11_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $220, $231 := $221, $232 := $222"]},{"kind":"WRITE","substeps":["$230, $231, $232","TO __stage12_output","BY HASH($230, $231, $232)"]}],"writeRatioAvg":0.00401792613197342},{"readMsMax":"0","computeMsMax":"627","inputStages":["15"],"waitMsAvg":"1","id":"19","endMs":"1570992576220","waitMsMax":"1","startMs":"1570992575855","waitRatioMax":0.00015453562046051616,"readRatioAvg":0,"parallelInputs":"14","recordsRead":"3025490","computeRatioAvg":0.0823674857054551,"writeMsAvg":"28","status":"COMPLETE","writeMsMax":"31","computeMsAvg":"533","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004790604234276001,"readMsAvg":"0","waitRatioAvg":0.00015453562046051616,"completedParallelInputs":"14","computeRatioMax":0.09689383402874363,"name":"S13: Aggregate","shuffleOutputBytes":"108250700","recordsWritten":"2927935","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$171, $170, $172","FROM __stage0F_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $180 := $170, $181 := $171, $182 := $172"]},{"kind":"WRITE","substeps":["$180, $181, $182","TO __stage13_output","BY HASH($180, $181, $182)"]}],"writeRatioAvg":0.004326997372894452},{"readMsMax":"0","computeMsMax":"41","inputStages":["19"],"waitMsAvg":"1","id":"21","endMs":"1570992576898","waitMsMax":"5","startMs":"1570992576224","waitRatioMax":0.0007726781023025807,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2927935","computeRatioAvg":0.004945139854736517,"writeMsAvg":"40","status":"COMPLETE","writeMsMax":"115","computeMsAvg":"32","shuffleOutputBytesSpilled":"0","writeRatioMax":0.017771596352959357,"readMsAvg":"0","waitRatioAvg":0.00015453562046051616,"completedParallelInputs":"100","computeRatioMax":0.006335960438881162,"name":"S15: Coalesce","shuffleOutputBytes":"108250700","recordsWritten":"2927935","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage13_output"]}],"writeRatioAvg":0.006181424818420646},{"readMsMax":"0","computeMsMax":"6471","inputStages":["13","21"],"waitMsAvg":"2","id":"22","endMs":"1570992580935","waitMsMax":"3","startMs":"1570992576248","waitRatioMax":0.0004636068613815484,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"57361114","computeRatioAvg":0.7318806985010045,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"4736","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004172461752433936,"readMsAvg":"0","waitRatioAvg":0.0003090712409210323,"completedParallelInputs":"18","computeRatioMax":1,"name":"S16: Join+","shuffleOutputBytes":"6571988","recordsWritten":"178055","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$131, $130, $132","FROM __stage0D_output"]},{"kind":"READ","substeps":["$180, $181, $182","FROM __stage15_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $140 = $180, $141 = $181, $142 = $182"]},{"kind":"AGGREGATE","substeps":["GROUP BY $140 := $130, $141 := $131, $142 := $132"]},{"kind":"WRITE","substeps":["$190, $191, $192","TO __stage16_output","BY HASH($191, $190, $192)"]}],"writeRatioAvg":0.003245248029670839},{"readMsMax":"0","computeMsMax":"21","inputStages":["18","22"],"waitMsAvg":"3","id":"23","endMs":"1570992581097","waitMsMax":"5","startMs":"1570992580973","waitRatioMax":0.0007726781023025807,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1278375","computeRatioAvg":0.002163498686447226,"writeMsAvg":"38","status":"COMPLETE","writeMsMax":"51","computeMsAvg":"14","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007881316643486324,"readMsAvg":"0","waitRatioAvg":0.0004636068613815484,"completedParallelInputs":"100","computeRatioMax":0.003245248029670839,"name":"S17: Join+","shuffleOutputBytes":"900","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$190, $191, $192","FROM __stage16_output"]},{"kind":"READ","substeps":["$230, $231, $232","FROM __stage12_output"]},{"kind":"AGGREGATE","substeps":["$100 := COUNT_STAR()"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH EACH ON $191 = $230, $190 = $231, $192 = $232"]},{"kind":"WRITE","substeps":["$100","TO __stage17_output"]}],"writeRatioAvg":0.0058723535774996135},{"readMsMax":"0","computeMsMax":"5","inputStages":["23"],"waitMsAvg":"1","id":"24","endMs":"1570992581200","waitMsMax":"1","startMs":"1570992581011","waitRatioMax":0.00015453562046051616,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0007726781023025807,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0009272137227630969,"readMsAvg":"0","waitRatioAvg":0.00015453562046051616,"completedParallelInputs":"1","computeRatioMax":0.0007726781023025807,"name":"S18: Output","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$100","FROM __stage17_output"]},{"kind":"LIMIT","substeps":["100"]},{"kind":"AGGREGATE","substeps":["$90 := SUM_OF_COUNTS($100)"]},{"kind":"WRITE","substeps":["$90","TO __stage18_output"]}],"writeRatioAvg":0.0009272137227630969}],"estimatedBytesProcessed":"7775774924","timeline":[{"totalSlotMs":"54744","activeUnits":"232","completedUnits":"199","elapsedMs":"684","pendingUnits":"224"},{"totalSlotMs":"317754","activeUnits":"625","completedUnits":"6","elapsedMs":"2204","pendingUnits":"717"},{"totalSlotMs":"787019","activeUnits":"500","completedUnits":"418","elapsedMs":"3222","pendingUnits":"305"},{"totalSlotMs":"1400392","activeUnits":"236","completedUnits":"539","elapsedMs":"4712","pendingUnits":"184"},{"totalSlotMs":"1620980","activeUnits":"62","completedUnits":"722","elapsedMs":"5824","pendingUnits":"1"},{"totalSlotMs":"1675544","activeUnits":"118","completedUnits":"840","elapsedMs":"6975","pendingUnits":"24"},{"totalSlotMs":"1688415","activeUnits":"18","completedUnits":"846","elapsedMs":"7476","pendingUnits":"18"},{"totalSlotMs":"1778705","activeUnits":"15","completedUnits":"855","elapsedMs":"10262","pendingUnits":"9"},{"totalSlotMs":"1797845","activeUnits":"2","completedUnits":"965","elapsedMs":"11582","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"7776239616","totalPartitionsProcessed":"0","totalBytesProcessed":"7775774924","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_100"}]},"endTime":"1570992581467"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query38_1570992567"},"etag":"FDAhrqMUgQI16EqcZ9zvtA==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query38_1570992567?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonf7ebf47900571161f3001f3971f3eac05f312d0e","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query38\nWITH g1 AS (\n SELECT DISTINCT c_last_name, \n c_first_name, \n d_date \n FROM store_sales, \n date_dim, \n customer \n WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk \n AND store_sales.ss_customer_sk = customer.c_customer_sk \n AND d_month_seq BETWEEN 1188 AND 1188 + 11 \n), g2 AS (\n SELECT DISTINCT c_last_name, \n c_first_name, \n d_date \n FROM catalog_sales, \n date_dim, \n customer \n WHERE catalog_sales.cs_sold_date_sk = date_dim.d_date_sk \n AND catalog_sales.cs_bill_customer_sk = customer.c_customer_sk \n AND d_month_seq BETWEEN 1188 AND 1188 + 11 \n), g3 AS (\n SELECT DISTINCT c_last_name, \n c_first_name, \n d_date \n FROM web_sales, \n date_dim, \n customer \n WHERE web_sales.ws_sold_date_sk = date_dim.d_date_sk \n AND web_sales.ws_bill_customer_sk = customer.c_customer_sk \n AND d_month_seq BETWEEN 1188 AND 1188 + 11\n)\nSELECT Count(*) \nFROM g1 \nJOIN g2 ON g1.c_last_name = g2.c_last_name AND g1.c_first_name = g2.c_first_name AND g1.d_date = g2.d_date\nJOIN g3 ON g1.c_last_name = g3.c_last_name AND g1.c_first_name = g3.c_first_name AND g1.d_date = g3.d_date\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query38_1570992567","user_email":"nithish.sankaranarayanan@ulb.be"}
