{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"360880","creationTime":"1570993439623","totalBytesProcessed":"17001023972","startTime":"1570993439795","query":{"totalSlotMs":"360880","queryPlan":[{"readMsMax":"21","computeMsMax":"11","waitMsAvg":"1","id":"0","endMs":"1570993440294","waitMsMax":"1","startMs":"1570993440028","waitRatioMax":8.090614886731392e-05,"readRatioAvg":0.0016990291262135922,"parallelInputs":"1","recordsRead":"2040","computeRatioAvg":0.0008899676375404531,"writeMsAvg":"72","status":"COMPLETE","writeMsMax":"72","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005825242718446602,"readMsAvg":"21","waitRatioAvg":8.090614886731392e-05,"completedParallelInputs":"1","computeRatioMax":0.0008899676375404531,"name":"S00: Input","shuffleOutputBytes":"18360","recordsWritten":"2040","readRatioMax":0.0016990291262135922,"steps":[{"kind":"READ","substeps":["$50:wp_web_page_sk","FROM web_page"]},{"kind":"WRITE","substeps":["$50","TO __stage00_output","BY HASH($50)"]}],"writeRatioAvg":0.005825242718446602},{"readMsMax":"11","computeMsMax":"23","waitMsAvg":"3","id":"1","endMs":"1570993440430","waitMsMax":"3","startMs":"1570993440105","waitRatioMax":0.00024271844660194174,"readRatioAvg":0.0008899676375404531,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.00186084142394822,"writeMsAvg":"96","status":"COMPLETE","writeMsMax":"96","computeMsAvg":"23","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007766990291262136,"readMsAvg":"11","waitRatioAvg":0.00024271844660194174,"completedParallelInputs":"1","computeRatioMax":0.00186084142394822,"name":"S01: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.0008899676375404531,"steps":[{"kind":"READ","substeps":["$150:d_date_sk, $151:d_date","FROM date_dim","WHERE between(CAST($151 AS DATE), 11550, 11580)"]},{"kind":"WRITE","substeps":["$150","TO __stage01_output","BY HASH($150)"]}],"writeRatioAvg":0.007766990291262136},{"readMsMax":"10","computeMsMax":"7","waitMsAvg":"1","id":"3","endMs":"1570993440401","waitMsMax":"1","startMs":"1570993440327","waitRatioMax":8.090614886731392e-05,"readRatioAvg":0.0008090614886731392,"parallelInputs":"1","recordsRead":"2040","computeRatioAvg":0.0005663430420711974,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0005663430420711974,"readMsAvg":"10","waitRatioAvg":8.090614886731392e-05,"completedParallelInputs":"1","computeRatioMax":0.0005663430420711974,"name":"S03: Input","shuffleOutputBytes":"18360","recordsWritten":"2040","readRatioMax":0.0008090614886731392,"steps":[{"kind":"READ","substeps":["$40:wp_web_page_sk","FROM web_page"]},{"kind":"WRITE","substeps":["$40","TO __stage03_output","BY HASH($40)"]}],"writeRatioAvg":0.0005663430420711974},{"readMsMax":"9","computeMsMax":"16","waitMsAvg":"1","id":"4","endMs":"1570993440386","waitMsMax":"1","startMs":"1570993440346","waitRatioMax":8.090614886731392e-05,"readRatioAvg":0.0007281553398058253,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0012944983818770227,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"16","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0004854368932038835,"readMsAvg":"9","waitRatioAvg":8.090614886731392e-05,"completedParallelInputs":"1","computeRatioMax":0.0012944983818770227,"name":"S04: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.0007281553398058253,"steps":[{"kind":"READ","substeps":["$140:d_date_sk, $141:d_date","FROM date_dim","WHERE between(CAST($141 AS DATE), 11550, 11580)"]},{"kind":"WRITE","substeps":["$140","TO __stage04_output","BY HASH($140)"]}],"writeRatioAvg":0.0004854368932038835},{"readMsMax":"14","computeMsMax":"18","waitMsAvg":"1","id":"6","endMs":"1570993440608","waitMsMax":"1","startMs":"1570993440557","waitRatioMax":8.090614886731392e-05,"readRatioAvg":0.0011326860841423948,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0014563106796116505,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0005663430420711974,"readMsAvg":"14","waitRatioAvg":8.090614886731392e-05,"completedParallelInputs":"1","computeRatioMax":0.0014563106796116505,"name":"S06: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.0011326860841423948,"steps":[{"kind":"READ","substeps":["$90:d_date_sk, $91:d_date","FROM date_dim","WHERE between(CAST($91 AS DATE), 11550, 11580)"]},{"kind":"WRITE","substeps":["$90","TO __stage06_output","BY HASH($90)"]}],"writeRatioAvg":0.0005663430420711974},{"readMsMax":"9","computeMsMax":"18","waitMsAvg":"1","id":"8","endMs":"1570993440811","waitMsMax":"1","startMs":"1570993440587","waitRatioMax":8.090614886731392e-05,"readRatioAvg":0.0007281553398058253,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0014563106796116505,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00186084142394822,"readMsAvg":"9","waitRatioAvg":8.090614886731392e-05,"completedParallelInputs":"1","computeRatioMax":0.0014563106796116505,"name":"S08: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.0007281553398058253,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_date","FROM date_dim","WHERE between(CAST($81 AS DATE), 11550, 11580)"]},{"kind":"WRITE","substeps":["$80","TO __stage08_output","BY HASH($80)"]}],"writeRatioAvg":0.00186084142394822},{"readMsMax":"32","computeMsMax":"7","waitMsAvg":"1","id":"10","endMs":"1570993440735","waitMsMax":"1","startMs":"1570993440620","waitRatioMax":8.090614886731392e-05,"readRatioAvg":0.0025889967637540453,"parallelInputs":"1","recordsRead":"402","computeRatioAvg":0.0005663430420711974,"writeMsAvg":"61","status":"COMPLETE","writeMsMax":"61","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004935275080906149,"readMsAvg":"32","waitRatioAvg":8.090614886731392e-05,"completedParallelInputs":"1","computeRatioMax":0.0005663430420711974,"name":"S0A: Input","shuffleOutputBytes":"3618","recordsWritten":"402","readRatioMax":0.0025889967637540453,"steps":[{"kind":"READ","substeps":["$10:s_store_sk","FROM store"]},{"kind":"WRITE","substeps":["$10","TO __stage0A_output","BY HASH($10)"]}],"writeRatioAvg":0.004935275080906149},{"readMsMax":"7","computeMsMax":"18","waitMsAvg":"1","id":"11","endMs":"1570993440782","waitMsMax":"1","startMs":"1570993440701","waitRatioMax":8.090614886731392e-05,"readRatioAvg":0.0005663430420711974,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0014563106796116505,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007281553398058253,"readMsAvg":"7","waitRatioAvg":8.090614886731392e-05,"completedParallelInputs":"1","computeRatioMax":0.0014563106796116505,"name":"S0B: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.0005663430420711974,"steps":[{"kind":"READ","substeps":["$130:d_date_sk, $131:d_date","FROM date_dim","WHERE between(CAST($131 AS DATE), 11550, 11580)"]},{"kind":"WRITE","substeps":["$130","TO __stage0B_output","BY HASH($130)"]}],"writeRatioAvg":0.0007281553398058253},{"readMsMax":"10","computeMsMax":"6","waitMsAvg":"1","id":"13","endMs":"1570993440803","waitMsMax":"1","startMs":"1570993440731","waitRatioMax":8.090614886731392e-05,"readRatioAvg":0.0008090614886731392,"parallelInputs":"1","recordsRead":"402","computeRatioAvg":0.0004854368932038835,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007281553398058253,"readMsAvg":"10","waitRatioAvg":8.090614886731392e-05,"completedParallelInputs":"1","computeRatioMax":0.0004854368932038835,"name":"S0D: Input","shuffleOutputBytes":"3618","recordsWritten":"402","readRatioMax":0.0008090614886731392,"steps":[{"kind":"READ","substeps":["$1:s_store_sk","FROM store"]},{"kind":"WRITE","substeps":["$1","TO __stage0D_output","BY HASH($1)"]}],"writeRatioAvg":0.0007281553398058253},{"readMsMax":"13","computeMsMax":"19","waitMsAvg":"1","id":"14","endMs":"1570993440808","waitMsMax":"1","startMs":"1570993440747","waitRatioMax":8.090614886731392e-05,"readRatioAvg":0.001051779935275081,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0015372168284789644,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"19","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0006472491909385113,"readMsAvg":"13","waitRatioAvg":8.090614886731392e-05,"completedParallelInputs":"1","computeRatioMax":0.0015372168284789644,"name":"S0E: Input","shuffleOutputBytes":"279","recordsWritten":"31","readRatioMax":0.001051779935275081,"steps":[{"kind":"READ","substeps":["$120:d_date_sk, $121:d_date","FROM date_dim","WHERE between(CAST($121 AS DATE), 11550, 11580)"]},{"kind":"WRITE","substeps":["$120","TO __stage0E_output","BY HASH($120)"]}],"writeRatioAvg":0.0006472491909385113},{"readMsMax":"116","computeMsMax":"309","inputStages":["3","4"],"waitMsAvg":"2","id":"17","endMs":"1570993443808","waitMsMax":"4","startMs":"1570993440898","waitRatioMax":0.00032362459546925567,"readRatioAvg":0.002912621359223301,"parallelInputs":"92","recordsRead":"70664607","computeRatioAvg":0.017233009708737864,"writeMsAvg":"38","status":"COMPLETE","writeMsMax":"2705","computeMsAvg":"213","shuffleOutputBytesSpilled":"0","writeRatioMax":0.21885113268608414,"readMsAvg":"36","waitRatioAvg":0.00016181229773462783,"completedParallelInputs":"92","computeRatioMax":0.025,"name":"S11: Join+","shuffleOutputBytes":"2533680","recordsWritten":"93840","readRatioMax":0.009385113268608414,"steps":[{"kind":"READ","substeps":["$100:ws_sold_date_sk, $101:ws_web_page_sk, $102:ws_ext_sales_price, $103:ws_net_profit","FROM web_sales"]},{"kind":"READ","substeps":["$140","FROM __stage04_output"]},{"kind":"READ","substeps":["$40","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $520 := $512","$320 := SUM($510)","$321 := SUM($511)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $500 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $100 = $140"]},{"kind":"WRITE","substeps":["$520, $320, $321","TO __stage11_output","BY HASH($520)"]}],"writeRatioAvg":0.0030744336569579287},{"readMsMax":"39","computeMsMax":"1001","inputStages":["0","1"],"waitMsAvg":"1","id":"18","endMs":"1570993441700","waitMsMax":"1","startMs":"1570993440919","waitRatioMax":8.090614886731392e-05,"readRatioAvg":0.0028317152103559872,"parallelInputs":"3","recordsRead":"7054651","computeRatioAvg":0.0790453074433657,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"977","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0004854368932038835,"readMsAvg":"35","waitRatioAvg":8.090614886731392e-05,"completedParallelInputs":"3","computeRatioMax":0.08098705501618123,"name":"S12: Join+","shuffleOutputBytes":"110160","recordsWritten":"4080","readRatioMax":0.0031553398058252425,"steps":[{"kind":"READ","substeps":["$110:wr_returned_date_sk, $111:wr_web_page_sk, $112:wr_return_amt, $113:wr_net_loss","FROM web_returns"]},{"kind":"READ","substeps":["$150","FROM __stage01_output"]},{"kind":"READ","substeps":["$50","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $560 := $552","$330 := SUM($550)","$331 := SUM($551)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $540 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $110 = $150"]},{"kind":"WRITE","substeps":["$560, $330, $331","TO __stage12_output","BY HASH($560)"]}],"writeRatioAvg":0.00032362459546925567},{"readMsMax":"102","computeMsMax":"1022","inputStages":["6"],"waitMsAvg":"1","id":"19","endMs":"1570993441541","waitMsMax":"1","startMs":"1570993440935","waitRatioMax":8.090614886731392e-05,"readRatioAvg":0.004288025889967638,"parallelInputs":"6","recordsRead":"14398782","computeRatioAvg":0.07330097087378641,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"906","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0006472491909385113,"readMsAvg":"53","waitRatioAvg":8.090614886731392e-05,"completedParallelInputs":"6","computeRatioMax":0.08268608414239483,"name":"S13: Join+","shuffleOutputBytes":"3354","recordsWritten":"126","readRatioMax":0.00825242718446602,"steps":[{"kind":"READ","substeps":["$30:cr_returned_date_sk, $31:cr_call_center_sk, $32:cr_return_amount, $33:cr_net_loss","FROM catalog_returns"]},{"kind":"READ","substeps":["$90","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $470 := $460","$310 := SUM($461)","$311 := SUM($462)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $30 = $90"]},{"kind":"WRITE","substeps":["$470, $310, $311","TO __stage13_output","BY HASH($470)"]}],"writeRatioAvg":0.0004045307443365696},{"readMsMax":"135","computeMsMax":"1675","inputStages":["10","11"],"waitMsAvg":"1","id":"20","endMs":"1570993457267","waitMsMax":"2","startMs":"1570993440961","waitRatioMax":0.00016181229773462783,"readRatioAvg":0.0036407766990291263,"parallelInputs":"9","recordsRead":"28195226","computeRatioAvg":0.11229773462783171,"writeMsAvg":"1377","status":"COMPLETE","writeMsMax":"12360","computeMsAvg":"1388","shuffleOutputBytesSpilled":"0","writeRatioMax":1,"readMsAvg":"45","waitRatioAvg":8.090614886731392e-05,"completedParallelInputs":"9","computeRatioMax":0.13551779935275082,"name":"S14: Join+","shuffleOutputBytes":"48843","recordsWritten":"1809","readRatioMax":0.010922330097087379,"steps":[{"kind":"READ","substeps":["$70:sr_returned_date_sk, $71:sr_store_sk, $72:sr_return_amt, $73:sr_net_loss","FROM store_returns"]},{"kind":"READ","substeps":["$130","FROM __stage0B_output"]},{"kind":"READ","substeps":["$10","FROM __stage0A_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $400 := $392","$290 := SUM($390)","$291 := SUM($391)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $380 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $70 = $130"]},{"kind":"WRITE","substeps":["$400, $290, $291","TO __stage14_output","BY HASH($400)"]}],"writeRatioAvg":0.11140776699029126},{"readMsMax":"162","computeMsMax":"589","inputStages":["13","14"],"waitMsAvg":"2","id":"21","endMs":"1570993441573","waitMsMax":"5","startMs":"1570993440990","waitRatioMax":0.0004045307443365696,"readRatioAvg":0.0025080906148867315,"parallelInputs":"184","recordsRead":"281952595","computeRatioAvg":0.03511326860841424,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"140","computeMsAvg":"434","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011326860841423949,"readMsAvg":"31","waitRatioAvg":0.00016181229773462783,"completedParallelInputs":"184","computeRatioMax":0.0476537216828479,"name":"S15: Join+","shuffleOutputBytes":"998568","recordsWritten":"36984","readRatioMax":0.013106796116504855,"steps":[{"kind":"READ","substeps":["$60:ss_sold_date_sk, $61:ss_store_sk, $62:ss_ext_sales_price, $63:ss_net_profit","FROM store_sales"]},{"kind":"READ","substeps":["$120","FROM __stage0E_output"]},{"kind":"READ","substeps":["$1","FROM __stage0D_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $360 := $352","$280 := SUM($350)","$281 := SUM($351)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $340 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $60 = $120"]},{"kind":"WRITE","substeps":["$360, $280, $281","TO __stage15_output","BY HASH($360)"]}],"writeRatioAvg":0.0008090614886731392},{"readMsMax":"62","computeMsMax":"358","inputStages":["8"],"waitMsAvg":"2","id":"22","endMs":"1570993441419","waitMsMax":"5","startMs":"1570993441072","waitRatioMax":0.0004045307443365696,"readRatioAvg":0.002184466019417476,"parallelInputs":"141","recordsRead":"144014822","computeRatioAvg":0.0191747572815534,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"71","computeMsAvg":"237","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005744336569579288,"readMsAvg":"27","waitRatioAvg":0.00016181229773462783,"completedParallelInputs":"141","computeRatioMax":0.02896440129449838,"name":"S16: Join+","shuffleOutputBytes":"1696","recordsWritten":"64","readRatioMax":0.005016181229773463,"steps":[{"kind":"READ","substeps":["$20:cs_sold_date_sk, $21:cs_call_center_sk, $22:cs_ext_sales_price, $23:cs_net_profit","FROM catalog_sales"]},{"kind":"READ","substeps":["$80","FROM __stage08_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $440 := $430","$300 := SUM($431)","$301 := SUM($432)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $80"]},{"kind":"WRITE","substeps":["$440, $300, $301","TO __stage16_output","BY HASH($440)"]}],"writeRatioAvg":0.00024271844660194174},{"readMsMax":"0","computeMsMax":"8","inputStages":["18"],"waitMsAvg":"1","id":"23","endMs":"1570993458956","waitMsMax":"1","startMs":"1570993458885","waitRatioMax":8.090614886731392e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"4080","computeRatioAvg":0.0006472491909385113,"writeMsAvg":"49","status":"COMPLETE","writeMsMax":"49","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003964401294498382,"readMsAvg":"0","waitRatioAvg":8.090614886731392e-05,"completedParallelInputs":"1","computeRatioMax":0.0006472491909385113,"name":"S17: Aggregate","shuffleOutputBytes":"36720","recordsWritten":"1360","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$560, $330, $331","FROM __stage12_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $570 := $560","$270 := SUM($330)","$271 := SUM($331)"]},{"kind":"WRITE","substeps":["$270, $271, $570","TO __stage17_output","BY HASH($570)"]}],"writeRatioAvg":0.003964401294498382},{"readMsMax":"0","computeMsMax":"5","inputStages":["19"],"waitMsAvg":"1","id":"24","endMs":"1570993458968","waitMsMax":"1","startMs":"1570993458920","waitRatioMax":8.090614886731392e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"126","computeRatioAvg":0.0004045307443365696,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0005663430420711974,"readMsAvg":"0","waitRatioAvg":8.090614886731392e-05,"completedParallelInputs":"1","computeRatioMax":0.0004045307443365696,"name":"S18: Aggregate","shuffleOutputBytes":"378","recordsWritten":"21","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$470, $310, $311","FROM __stage13_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $480 := $470","$250 := SUM($310)","$251 := SUM($311)"]},{"kind":"WRITE","substeps":["$250, $251","TO __stage18_output"]}],"writeRatioAvg":0.0005663430420711974},{"readMsMax":"0","computeMsMax":"12","inputStages":["22"],"waitMsAvg":"2","id":"25","endMs":"1570993459101","waitMsMax":"2","startMs":"1570993458936","waitRatioMax":0.00016181229773462783,"readRatioAvg":0,"parallelInputs":"14","recordsRead":"64","computeRatioAvg":0.0006472491909385113,"writeMsAvg":"97","status":"COMPLETE","writeMsMax":"119","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009627831715210356,"readMsAvg":"0","waitRatioAvg":0.00016181229773462783,"completedParallelInputs":"14","computeRatioMax":0.000970873786407767,"name":"S19: Aggregate","shuffleOutputBytes":"424","recordsWritten":"16","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$440, $300, $301","FROM __stage16_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $450 := $440","$240 := SUM($300)","$241 := SUM($301)"]},{"kind":"WRITE","substeps":["$240, $241, $450","TO __stage19_output"]}],"writeRatioAvg":0.00784789644012945},{"readMsMax":"0","computeMsMax":"5","inputStages":["20"],"waitMsAvg":"1","id":"26","endMs":"1570993459132","waitMsMax":"1","startMs":"1570993458954","waitRatioMax":8.090614886731392e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1809","computeRatioAvg":0.0004045307443365696,"writeMsAvg":"165","status":"COMPLETE","writeMsMax":"165","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.013349514563106795,"readMsAvg":"0","waitRatioAvg":8.090614886731392e-05,"completedParallelInputs":"1","computeRatioMax":0.0004045307443365696,"name":"S1A: Aggregate","shuffleOutputBytes":"5427","recordsWritten":"201","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$400, $290, $291","FROM __stage14_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $410 := $400","$230 := SUM($290)","$231 := SUM($291)"]},{"kind":"WRITE","substeps":["$230, $231, $410","TO __stage1A_output","BY HASH($410)"]}],"writeRatioAvg":0.013349514563106795},{"readMsMax":"0","computeMsMax":"7","inputStages":["23"],"waitMsAvg":"1","id":"27","endMs":"1570993459209","waitMsMax":"3","startMs":"1570993458971","waitRatioMax":0.00024271844660194174,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1360","computeRatioAvg":0.00032362459546925567,"writeMsAvg":"177","status":"COMPLETE","writeMsMax":"219","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01771844660194175,"readMsAvg":"0","waitRatioAvg":8.090614886731392e-05,"completedParallelInputs":"100","computeRatioMax":0.0005663430420711974,"name":"S1B: Coalesce","shuffleOutputBytes":"36720","recordsWritten":"1360","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage17_output"]}],"writeRatioAvg":0.014320388349514563},{"readMsMax":"0","computeMsMax":"10","inputStages":["25"],"waitMsAvg":"2","id":"28","endMs":"1570993459342","waitMsMax":"3","startMs":"1570993459114","waitRatioMax":0.00024271844660194174,"readRatioAvg":0,"parallelInputs":"40","recordsRead":"16","computeRatioAvg":0.0004045307443365696,"writeMsAvg":"169","status":"COMPLETE","writeMsMax":"196","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.015857605177993526,"readMsAvg":"0","waitRatioAvg":0.00016181229773462783,"completedParallelInputs":"40","computeRatioMax":0.0008090614886731392,"name":"S1C: Coalesce","shuffleOutputBytes":"424","recordsWritten":"16","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage19_output"]}],"writeRatioAvg":0.013673139158576052},{"readMsMax":"0","computeMsMax":"10","inputStages":["26"],"waitMsAvg":"2","id":"29","endMs":"1570993459408","waitMsMax":"4","startMs":"1570993459153","waitRatioMax":0.00032362459546925567,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"201","computeRatioAvg":0.0004854368932038835,"writeMsAvg":"37","status":"COMPLETE","writeMsMax":"57","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004611650485436893,"readMsAvg":"0","waitRatioAvg":0.00016181229773462783,"completedParallelInputs":"100","computeRatioMax":0.0008090614886731392,"name":"S1D: Coalesce","shuffleOutputBytes":"5427","recordsWritten":"201","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage1A_output"]}],"writeRatioAvg":0.002993527508090615},{"readMsMax":"0","computeMsMax":"21","inputStages":["21","24","17","27","28","29"],"waitMsAvg":"4","id":"30","endMs":"1570993459457","waitMsMax":"6","startMs":"1570993459184","waitRatioMax":0.0004854368932038835,"readRatioAvg":0,"parallelInputs":"67","recordsRead":"146975","computeRatioAvg":0.0008090614886731392,"writeMsAvg":"47","status":"COMPLETE","writeMsMax":"107","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008656957928802589,"readMsAvg":"0","waitRatioAvg":0.00032362459546925567,"completedParallelInputs":"67","computeRatioMax":0.0016990291262135922,"name":"S1E: Join+","shuffleOutputBytes":"78990","recordsWritten":"1493","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$360, $280, $281","FROM __stage15_output"]},{"kind":"READ","substeps":["$230, $231, $410","FROM __stage1D_output"]},{"kind":"READ","substeps":["$240, $241, $450","FROM __stage1C_output"]},{"kind":"READ","substeps":["$250, $251","FROM __stage18_output"]},{"kind":"READ","substeps":["$520, $320, $321","FROM __stage11_output"]},{"kind":"READ","substeps":["$270, $271, $570","FROM __stage1B_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $590 := $180, $591 := $181","$170 := SUM($182)","$171 := SUM($183)","$172 := SUM($184)"]},{"kind":"COMPUTE","substeps":["$190 := 'store channel'","$191 := coalesce($423, 0)","$192 := subtract($422, coalesce($424, 0))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $370 = $410"]},{"kind":"AGGREGATE","substeps":["GROUP BY $370 := $360","$220 := SUM($280)","$221 := SUM($281)"]},{"kind":"COMPUTE","substeps":["$200 := 'catalog channel'","$201 := subtract($492, $494)"]},{"kind":"JOIN","substeps":["CROSS EACH WITH EACH "]},{"kind":"COMPUTE","substeps":["$210 := 'web channel'","$211 := coalesce($583, 0)","$212 := subtract($582, coalesce($584, 0))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $530 = $570"]},{"kind":"AGGREGATE","substeps":["GROUP BY $530 := $520","$260 := SUM($320)","$261 := SUM($321)"]},{"kind":"WRITE","substeps":["$170, $171, $172, $590, $591","TO __stage1E_output","BY HASH($590, $591)"]}],"writeRatioAvg":0.003802588996763754},{"readMsMax":"0","computeMsMax":"7","inputStages":["30"],"waitMsAvg":"2","id":"31","endMs":"1570993459744","waitMsMax":"2","startMs":"1570993459461","waitRatioMax":0.00016181229773462783,"readRatioAvg":0,"parallelInputs":"4","recordsRead":"1493","computeRatioAvg":0.0004854368932038835,"writeMsAvg":"78","status":"COMPLETE","writeMsMax":"82","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006634304207119741,"readMsAvg":"0","waitRatioAvg":0.00016181229773462783,"completedParallelInputs":"4","computeRatioMax":0.0005663430420711974,"name":"S1F: Sort+","shuffleOutputBytes":"21258","recordsWritten":"400","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$170, $171, $172, $590, $591","FROM __stage1E_output"]},{"kind":"SORT","substeps":["$600 ASC, $601 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $600 := $590, $601 := $591","$160 := SUM($170)","$161 := SUM($171)","$162 := SUM($172)"]},{"kind":"WRITE","substeps":["$610, $611, $612, $613, $614","TO __stage1F_output"]}],"writeRatioAvg":0.006310679611650485},{"readMsMax":"0","computeMsMax":"9","inputStages":["31"],"waitMsAvg":"2","id":"32","endMs":"1570993460959","waitMsMax":"2","startMs":"1570993459492","waitRatioMax":0.00016181229773462783,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"400","computeRatioAvg":0.0007281553398058253,"writeMsAvg":"1205","status":"COMPLETE","writeMsMax":"1205","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.09749190938511326,"readMsAvg":"0","waitRatioAvg":0.00016181229773462783,"completedParallelInputs":"1","computeRatioMax":0.0007281553398058253,"name":"S20: Output","shuffleOutputBytes":"5424","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$610, $611, $612, $613, $614","FROM __stage1F_output"]},{"kind":"SORT","substeps":["$613 ASC, $614 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$620, $621, $622, $623, $624","TO __stage20_output"]}],"writeRatioAvg":0.09749190938511326}],"estimatedBytesProcessed":"17001023972","timeline":[{"totalSlotMs":"4172","activeUnits":"95","completedUnits":"4","elapsedMs":"734","pendingUnits":"96"},{"totalSlotMs":"248704","activeUnits":"277","completedUnits":"433","elapsedMs":"1764","pendingUnits":"12"},{"totalSlotMs":"257111","activeUnits":"8","completedUnits":"439","elapsedMs":"2281","pendingUnits":"6"},{"totalSlotMs":"277496","activeUnits":"5","completedUnits":"444","elapsedMs":"5050","pendingUnits":"1"},{"totalSlotMs":"286150","activeUnits":"3","completedUnits":"444","elapsedMs":"8823","pendingUnits":"1"},{"totalSlotMs":"309755","activeUnits":"0","completedUnits":"445","elapsedMs":"17974","pendingUnits":"0"},{"totalSlotMs":"359925","activeUnits":"54","completedUnits":"773","elapsedMs":"20099","pendingUnits":"1"},{"totalSlotMs":"360880","activeUnits":"1","completedUnits":"774","elapsedMs":"21433","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"17001611264","totalPartitionsProcessed":"0","totalBytesProcessed":"17001023972","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"web_returns","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_page","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_100"}]},"endTime":"1570993461255"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query77_1570993438"},"etag":"d4IGHQ8xZt+94eIYTsMqDQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query77_1570993438?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonc5246121f5a37a9949be5eaa11f61afe9747c0e4","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"\n-- query77\nWITH ss AS \n( \n SELECT s_store_sk, \n Sum(ss_ext_sales_price) AS sales, \n Sum(ss_net_profit) AS profit \n FROM store_sales, \n date_dim, \n store \n WHERE ss_sold_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN Cast('2001-08-16' AS DATE) AND ( \n Cast('2001-09-15' AS DATE)) \n AND ss_store_sk = s_store_sk \n GROUP BY s_store_sk) , sr AS \n( \n SELECT s_store_sk, \n sum(sr_return_amt) AS returns1, \n sum(sr_net_loss) AS profit_loss \n FROM store_returns, \n date_dim, \n store \n WHERE sr_returned_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2001-08-16' AS date) AND ( \n Cast('2001-09-15' AS DATE)) \n AND sr_store_sk = s_store_sk \n GROUP BY s_store_sk), cs AS \n( \n SELECT cs_call_center_sk, \n sum(cs_ext_sales_price) AS sales, \n sum(cs_net_profit) AS profit \n FROM catalog_sales, \n date_dim \n WHERE cs_sold_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2001-08-16' AS date) AND ( \n Cast('2001-09-15' AS DATE)) \n GROUP BY cs_call_center_sk ), cr AS \n( \n SELECT cr_call_center_sk, \n sum(cr_return_amount) AS returns1, \n sum(cr_net_loss) AS profit_loss \n FROM catalog_returns, \n date_dim \n WHERE cr_returned_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2001-08-16' AS date) AND ( \n Cast('2001-09-15' AS DATE)) \n GROUP BY cr_call_center_sk ), ws AS \n( \n SELECT wp_web_page_sk, \n sum(ws_ext_sales_price) AS sales, \n sum(ws_net_profit) AS profit \n FROM web_sales, \n date_dim, \n web_page \n WHERE ws_sold_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2001-08-16' AS date) AND ( \n Cast('2001-09-15' AS DATE)) \n AND ws_web_page_sk = wp_web_page_sk \n GROUP BY wp_web_page_sk), wr AS \n( \n SELECT wp_web_page_sk, \n sum(wr_return_amt) AS returns1, \n sum(wr_net_loss) AS profit_loss \n FROM web_returns, \n date_dim, \n web_page \n WHERE wr_returned_date_sk = d_date_sk \n AND Cast(d_date AS DATE) BETWEEN cast('2001-08-16' AS date) AND ( \n Cast('2001-09-15' AS DATE)) \n AND wr_web_page_sk = wp_web_page_sk \n GROUP BY wp_web_page_sk) \nSELECT\n channel , \n id , \n sum(sales) AS sales , \n sum(returns1) AS returns1 , \n sum(profit) AS profit \nFROM ( \n SELECT 'store channel' AS channel , \n ss.s_store_sk AS id , \n sales , \n COALESCE(returns1, 0) AS returns1 , \n (profit - COALESCE(profit_loss,0)) AS profit \n FROM ss \n LEFT JOIN sr \n ON ss.s_store_sk = sr.s_store_sk \n UNION ALL \n SELECT 'catalog channel' AS channel , \n cs_call_center_sk AS id , \n sales , \n returns1 , \n (profit - profit_loss) AS profit \n FROM cs , \n cr \n UNION ALL \n SELECT 'web channel' AS channel , \n ws.wp_web_page_sk AS id , \n sales , \n COALESCE(returns1, 0) returns1 , \n (profit - COALESCE(profit_loss,0)) AS profit \n FROM ws \n LEFT JOIN wr \n ON ws.wp_web_page_sk = wr.wp_web_page_sk ) x \nGROUP BY channel, id\nORDER BY channel , \n id \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query77_1570993438","user_email":"nithish.sankaranarayanan@ulb.be"}
