{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"96287","creationTime":"1570971743153","totalBytesProcessed":"90143817","startTime":"1570971743322","query":{"totalSlotMs":"96287","queryPlan":[{"readMsMax":"13","computeMsMax":"8","waitMsAvg":"16","id":"1","endMs":"1570971743821","waitMsMax":"16","startMs":"1570971743604","waitRatioMax":0.024132730015082957,"readRatioAvg":0.0196078431372549,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.012066365007541479,"writeMsAvg":"193","status":"COMPLETE","writeMsMax":"193","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.2911010558069382,"readMsAvg":"13","waitRatioAvg":0.024132730015082957,"completedParallelInputs":"1","computeRatioMax":0.012066365007541479,"name":"S01: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.0196078431372549,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_year","FROM date_dim","WHERE equal($81, 2000)"]},{"kind":"WRITE","substeps":["$80","TO __stage01_output","BY HASH($80)"]}],"writeRatioAvg":0.2911010558069382},{"readMsMax":"9","computeMsMax":"153","waitMsAvg":"28","id":"3","endMs":"1570971744071","waitMsMax":"28","startMs":"1570971743741","waitRatioMax":0.042232277526395176,"readRatioAvg":0.013574660633484163,"parallelInputs":"1","recordsRead":"250000","computeRatioAvg":0.23076923076923078,"writeMsAvg":"88","status":"COMPLETE","writeMsMax":"88","computeMsAvg":"153","shuffleOutputBytesSpilled":"0","writeRatioMax":0.13273001508295626,"readMsAvg":"9","waitRatioAvg":0.042232277526395176,"completedParallelInputs":"1","computeRatioMax":0.23076923076923078,"name":"S03: Input","shuffleOutputBytes":"3955444","recordsWritten":"250000","readRatioMax":0.013574660633484163,"steps":[{"kind":"READ","substeps":["$30:ca_address_sk, $31:ca_state","FROM customer_address"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage03_output","BY HASH($30)"]}],"writeRatioAvg":0.13273001508295626},{"readMsMax":"9","computeMsMax":"7","waitMsAvg":"46","id":"4","endMs":"1570971743984","waitMsMax":"46","startMs":"1570971743782","waitRatioMax":0.0693815987933635,"readRatioAvg":0.013574660633484163,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.010558069381598794,"writeMsAvg":"180","status":"COMPLETE","writeMsMax":"180","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.27149321266968324,"readMsAvg":"9","waitRatioAvg":0.0693815987933635,"completedParallelInputs":"1","computeRatioMax":0.010558069381598794,"name":"S04: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.013574660633484163,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year","FROM date_dim","WHERE equal($51, 2000)"]},{"kind":"WRITE","substeps":["$50","TO __stage04_output","BY HASH($50)"]}],"writeRatioAvg":0.27149321266968324},{"readMsMax":"31","computeMsMax":"414","inputStages":["1"],"waitMsAvg":"1","id":"6","endMs":"1570971744173","waitMsMax":"1","startMs":"1570971743884","waitRatioMax":0.0015082956259426848,"readRatioAvg":0.04675716440422323,"parallelInputs":"1","recordsRead":"720568","computeRatioAvg":0.6244343891402715,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"414","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03469079939668175,"readMsAvg":"31","waitRatioAvg":0.0015082956259426848,"completedParallelInputs":"1","computeRatioMax":0.6244343891402715,"name":"S06: Join","shuffleOutputBytes":"3609193","recordsWritten":"134635","readRatioMax":0.04675716440422323,"steps":[{"kind":"READ","substeps":["$70:wr_returned_date_sk, $71:wr_returning_customer_sk, $72:wr_returning_addr_sk, $73:wr_return_amt","FROM web_returns"]},{"kind":"READ","substeps":["$80","FROM __stage01_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $70 = $80"]},{"kind":"WRITE","substeps":["$230, $231, $232","TO __stage06_output","BY HASH($231)"]}],"writeRatioAvg":0.03469079939668175},{"readMsMax":"30","computeMsMax":"663","inputStages":["3","4"],"waitMsAvg":"3","id":"8","endMs":"1570971744635","waitMsMax":"3","startMs":"1570971744238","waitRatioMax":0.004524886877828055,"readRatioAvg":0.04524886877828054,"parallelInputs":"1","recordsRead":"970568","computeRatioAvg":1,"writeMsAvg":"22","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"663","shuffleOutputBytesSpilled":"0","writeRatioMax":0.033182503770739065,"readMsAvg":"30","waitRatioAvg":0.004524886877828055,"completedParallelInputs":"1","computeRatioMax":1,"name":"S08: Join+","shuffleOutputBytes":"3276218","recordsWritten":"132270","readRatioMax":0.04524886877828054,"steps":[{"kind":"READ","substeps":["$40:wr_returned_date_sk, $41:wr_returning_customer_sk, $42:wr_returning_addr_sk, $43:wr_return_amt","FROM web_returns"]},{"kind":"READ","substeps":["$50","FROM __stage04_output"]},{"kind":"READ","substeps":["$30, $31","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $180, $191 := $182","$120 := SUM($181)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $171 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $40 = $50"]},{"kind":"WRITE","substeps":["$191, $190, $120","TO __stage08_output","BY HASH($190, $191)"]}],"writeRatioAvg":0.033182503770739065},{"readMsMax":"0","computeMsMax":"12","inputStages":["6"],"waitMsAvg":"2","id":"9","endMs":"1570971745175","waitMsMax":"6","startMs":"1570971744245","waitRatioMax":0.00904977375565611,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"134635","computeRatioAvg":0.010558069381598794,"writeMsAvg":"181","status":"COMPLETE","writeMsMax":"220","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.33182503770739064,"readMsAvg":"0","waitRatioAvg":0.0030165912518853697,"completedParallelInputs":"100","computeRatioMax":0.01809954751131222,"name":"S09: Coalesce","shuffleOutputBytes":"3609193","recordsWritten":"134635","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage06_output"]}],"writeRatioAvg":0.2730015082956259},{"readMsMax":"20","computeMsMax":"531","inputStages":["9"],"waitMsAvg":"1","id":"10","endMs":"1570971745703","waitMsMax":"1","startMs":"1570971744279","waitRatioMax":0.0015082956259426848,"readRatioAvg":0.030165912518853696,"parallelInputs":"1","recordsRead":"384635","computeRatioAvg":0.8009049773755657,"writeMsAvg":"91","status":"COMPLETE","writeMsMax":"91","computeMsAvg":"531","shuffleOutputBytesSpilled":"0","writeRatioMax":0.13725490196078433,"readMsAvg":"20","waitRatioAvg":0.0015082956259426848,"completedParallelInputs":"1","computeRatioMax":0.8009049773755657,"name":"S0A: Join+","shuffleOutputBytes":"3276218","recordsWritten":"132270","readRatioMax":0.030165912518853696,"steps":[{"kind":"READ","substeps":["$60:ca_address_sk, $61:ca_state","FROM customer_address"]},{"kind":"READ","substeps":["$230, $231, $232","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $250 := $240, $251 := $242","$140 := SUM($241)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $60 = $231"]},{"kind":"WRITE","substeps":["$251, $250, $140","TO __stage0A_output","BY HASH($250, $251)"]}],"writeRatioAvg":0.13725490196078433},{"readMsMax":"0","computeMsMax":"110","inputStages":["10"],"waitMsAvg":"1","id":"11","endMs":"1570971746035","waitMsMax":"1","startMs":"1570971745960","waitRatioMax":0.0015082956259426848,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"132270","computeRatioAvg":0.16591251885369532,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"110","shuffleOutputBytesSpilled":"0","writeRatioMax":0.006033182503770739,"readMsAvg":"0","waitRatioAvg":0.0015082956259426848,"completedParallelInputs":"1","computeRatioMax":0.16591251885369532,"name":"S0B: Aggregate","shuffleOutputBytes":"1241","recordsWritten":"52","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$251, $250, $140","FROM __stage0A_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $270 := $261","$110 := SHARD_AVG($130)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $260 := $250, $261 := $251","$130 := SUM($140)"]},{"kind":"WRITE","substeps":["$270, $110","TO __stage0B_output","BY HASH($270)"]}],"writeRatioAvg":0.006033182503770739},{"readMsMax":"0","computeMsMax":"4","inputStages":["11"],"waitMsAvg":"1","id":"12","endMs":"1570971746112","waitMsMax":"1","startMs":"1570971746059","waitRatioMax":0.0015082956259426848,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"52","computeRatioAvg":0.006033182503770739,"writeMsAvg":"11","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.016591251885369532,"readMsAvg":"0","waitRatioAvg":0.0015082956259426848,"completedParallelInputs":"1","computeRatioMax":0.006033182503770739,"name":"S0C: Aggregate","shuffleOutputBytes":"816","recordsWritten":"51","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$270, $110","FROM __stage0B_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $280 := $270","$90 := ROOT_AVG($110)"]},{"kind":"WRITE","substeps":["$90, $280","TO __stage0C_output","BY HASH($280)"]}],"writeRatioAvg":0.016591251885369532},{"readMsMax":"11","computeMsMax":"18","waitMsAvg":"1","id":"14","endMs":"1570971746318","waitMsMax":"1","startMs":"1570971746102","waitRatioMax":0.0015082956259426848,"readRatioAvg":0.016591251885369532,"parallelInputs":"1","recordsRead":"250000","computeRatioAvg":0.027149321266968326,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"24","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03619909502262444,"readMsAvg":"11","waitRatioAvg":0.0015082956259426848,"completedParallelInputs":"1","computeRatioMax":0.027149321266968326,"name":"S0E: Input","shuffleOutputBytes":"64350","recordsWritten":"7150","readRatioMax":0.016591251885369532,"steps":[{"kind":"READ","substeps":["$20:ca_address_sk, $21:ca_state","FROM customer_address","WHERE equal($21, 'IN')"]},{"kind":"WRITE","substeps":["$20","TO __stage0E_output","BY HASH($20)"]}],"writeRatioAvg":0.03619909502262444},{"readMsMax":"181","computeMsMax":"610","inputStages":["14"],"waitMsAvg":"1","id":"16","endMs":"1570971746884","waitMsMax":"1","startMs":"1570971746381","waitRatioMax":0.0015082956259426848,"readRatioAvg":0.2730015082956259,"parallelInputs":"1","recordsRead":"507150","computeRatioAvg":0.9200603318250377,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"610","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007541478129713424,"readMsAvg":"181","waitRatioAvg":0.0015082956259426848,"completedParallelInputs":"1","computeRatioMax":0.9200603318250377,"name":"S10: Join","shuffleOutputBytes":"2128783","recordsWritten":"14342","readRatioMax":0.2730015082956259,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_customer_id, $3:c_current_addr_sk, $4:c_salutation, $5:c_first_name, $6:c_last_name, $7:c_preferred_cust_flag, $8:c_birth_day, $9:c_birth_month, $10:c_birth_year, $11:c_birth_country, $12:c_login, $13:c_email_address, $14:c_last_review_date","FROM customer"]},{"kind":"READ","substeps":["$20","FROM __stage0E_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $3 = $20"]},{"kind":"WRITE","substeps":["$150, $151, $152, $153, $154, $155, $156, $157, $158, $159, $160, $161, $162","TO __stage10_output","BY HASH($150)"]}],"writeRatioAvg":0.007541478129713424},{"readMsMax":"0","computeMsMax":"10","inputStages":["16"],"waitMsAvg":"2","id":"17","endMs":"1570971747065","waitMsMax":"12","startMs":"1570971746940","waitRatioMax":0.01809954751131222,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"14342","computeRatioAvg":0.007541478129713424,"writeMsAvg":"42","status":"COMPLETE","writeMsMax":"70","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.10558069381598793,"readMsAvg":"0","waitRatioAvg":0.0030165912518853697,"completedParallelInputs":"100","computeRatioMax":0.015082956259426848,"name":"S11: Coalesce","shuffleOutputBytes":"2128783","recordsWritten":"14342","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage10_output"]}],"writeRatioAvg":0.06334841628959276},{"readMsMax":"0","computeMsMax":"9","inputStages":["12"],"waitMsAvg":"11","id":"18","endMs":"1570971747213","waitMsMax":"15","startMs":"1570971746941","waitRatioMax":0.02262443438914027,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"51","computeRatioAvg":0.007541478129713424,"writeMsAvg":"43","status":"COMPLETE","writeMsMax":"61","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.09200603318250378,"readMsAvg":"0","waitRatioAvg":0.016591251885369532,"completedParallelInputs":"100","computeRatioMax":0.013574660633484163,"name":"S12: Coalesce","shuffleOutputBytes":"816","recordsWritten":"51","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0C_output"]}],"writeRatioAvg":0.06485671191553545},{"readMsMax":"0","computeMsMax":"206","inputStages":["8","18","17"],"waitMsAvg":"33","id":"19","endMs":"1570971747273","waitMsMax":"33","startMs":"1570971746973","waitRatioMax":0.049773755656108594,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"146663","computeRatioAvg":0.31070889894419307,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"206","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007541478129713424,"readMsAvg":"0","waitRatioAvg":0.049773755656108594,"completedParallelInputs":"1","computeRatioMax":0.31070889894419307,"name":"S13: Join+","shuffleOutputBytes":"14674","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$191, $190, $120","FROM __stage08_output"]},{"kind":"READ","substeps":["$150, $151, $152, $153, $154, $155, $156, $157, $158, $159, $160, $161, $162","FROM __stage11_output"]},{"kind":"READ","substeps":["$90, $280","FROM __stage12_output"]},{"kind":"SORT","substeps":["$290 ASC, $291 ASC, $292 ASC, $293 ASC, $294 ASC, $295 ASC, $296 ASC, $297 ASC, $298 ASC, $299 ASC, $300 ASC, $301 ASC, $302 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["greater($302, multiply($303, 1.2))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $222 = $280"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $200 = $150"]},{"kind":"AGGREGATE","substeps":["GROUP BY $200 := $190, $201 := $191","$100 := SUM($120)"]},{"kind":"WRITE","substeps":["$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $322","TO __stage13_output"]}],"writeRatioAvg":0.007541478129713424},{"readMsMax":"0","computeMsMax":"5","inputStages":["19"],"waitMsAvg":"5","id":"20","endMs":"1570971747360","waitMsMax":"5","startMs":"1570971746974","waitRatioMax":0.007541478129713424,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.007541478129713424,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.007541478129713424,"readMsAvg":"0","waitRatioAvg":0.007541478129713424,"completedParallelInputs":"1","computeRatioMax":0.007541478129713424,"name":"S14: Output","shuffleOutputBytes":"14674","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$310, $311, $312, $313, $314, $315, $316, $317, $318, $319, $320, $321, $322","FROM __stage13_output"]},{"kind":"SORT","substeps":["$310 ASC, $311 ASC, $312 ASC, $313 ASC, $314 ASC, $315 ASC, $316 ASC, $317 ASC, $318 ASC, $319 ASC, $320 ASC, $321 ASC, $322 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$330, $331, $332, $333, $334, $335, $336, $337, $338, $339, $340, $341, $342","TO __stage14_output"]}],"writeRatioAvg":0.007541478129713424}],"estimatedBytesProcessed":"90143817","timeline":[{"totalSlotMs":"397","activeUnits":"4","completedUnits":"2","elapsedMs":"759","pendingUnits":"4"},{"totalSlotMs":"58665","activeUnits":"99","completedUnits":"76","elapsedMs":"1753","pendingUnits":"30"},{"totalSlotMs":"68829","activeUnits":"2","completedUnits":"108","elapsedMs":"2804","pendingUnits":"3"},{"totalSlotMs":"96287","activeUnits":"2","completedUnits":"312","elapsedMs":"4254","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"90177536","totalPartitionsProcessed":"0","totalBytesProcessed":"90143817","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"web_returns","datasetId":"scale_10"}]},"endTime":"1570971747607"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query30_1570971742"},"etag":"PpiWmenqDv7ZaCZm7dRthg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query30_1570971742?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon0833bc9fbe1912c7ec84d4b320949f33182384fc","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query30\nWITH customer_total_return \n AS (SELECT wr_returning_customer_sk AS ctr_customer_sk, \n ca_state AS ctr_state, \n Sum(wr_return_amt) AS ctr_total_return \n FROM web_returns, \n date_dim, \n customer_address \n WHERE wr_returned_date_sk = d_date_sk \n AND d_year = 2000 \n AND wr_returning_addr_sk = ca_address_sk \n GROUP BY wr_returning_customer_sk, \n ca_state) \nSELECT c_customer_id, \n c_salutation, \n c_first_name, \n c_last_name, \n c_preferred_cust_flag, \n c_birth_day, \n c_birth_month, \n c_birth_year, \n c_birth_country, \n c_login, \n c_email_address, \n c_last_review_date, \n ctr_total_return \nFROM customer_total_return ctr1, \n customer_address, \n customer \nWHERE ctr1.ctr_total_return > (SELECT Avg(ctr_total_return) benchmark.sh bootstrap.sh data_gen.sh load_data.sh query Readme.md results warmup 1.2 \n FROM customer_total_return ctr2 \n WHERE ctr1.ctr_state = ctr2.ctr_state) \n AND ca_address_sk = c_current_addr_sk \n AND ca_state = 'IN' \n AND ctr1.ctr_customer_sk = c_customer_sk \nORDER BY c_customer_id, \n c_salutation, \n c_first_name, \n c_last_name, \n c_preferred_cust_flag, \n c_birth_day, \n c_birth_month, \n c_birth_year, \n c_birth_country, \n c_login, \n c_email_address, \n c_last_review_date, \n ctr_total_return\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query30_1570971742","user_email":"nithish.sankaranarayanan@ulb.be"}
