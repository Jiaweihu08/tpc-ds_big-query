{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"1952347","creationTime":"1570993781797","totalBytesProcessed":"4015575343","startTime":"1570993783086","query":{"totalSlotMs":"1952347","queryPlan":[{"readMsMax":"36","computeMsMax":"1397","waitMsAvg":"6","id":"0","endMs":"1570993784274","waitMsMax":"12","startMs":"1570993783355","waitRatioMax":0.0019411193788417987,"readRatioAvg":0.0046910384988676805,"parallelInputs":"3","recordsRead":"7048438","computeRatioAvg":0.21336137172436104,"writeMsAvg":"173","status":"COMPLETE","writeMsMax":"192","computeMsAvg":"1319","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03105791006146878,"readMsAvg":"29","waitRatioAvg":0.0009705596894208993,"completedParallelInputs":"3","computeRatioMax":0.22597864768683273,"name":"S00: Input","shuffleOutputBytes":"63435942","recordsWritten":"7048438","readRatioMax":0.005823358136525397,"steps":[{"kind":"READ","substeps":["$1:wr_order_number","FROM web_returns"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.027984471044969265},{"readMsMax":"68","computeMsMax":"723","waitMsAvg":"505","id":"1","endMs":"1570993784410","waitMsMax":"559","startMs":"1570993783412","waitRatioMax":0.09042381106438047,"readRatioAvg":0.003396958912973148,"parallelInputs":"92","recordsRead":"70474075","computeRatioAvg":0.09899708832093174,"writeMsAvg":"47","status":"COMPLETE","writeMsMax":"194","computeMsAvg":"612","shuffleOutputBytesSpilled":"0","writeRatioMax":0.031381429957942415,"readMsAvg":"21","waitRatioAvg":0.08168877385959236,"completedParallelInputs":"92","computeRatioMax":0.11695244257521838,"name":"S01: Input","shuffleOutputBytes":"1268392662","recordsWritten":"70474075","readRatioMax":0.010999676480103526,"steps":[{"kind":"READ","substeps":["$50:ws_warehouse_sk, $51:ws_order_number","FROM web_sales"]},{"kind":"WRITE","substeps":["$50, $51","TO __stage01_output","BY HASH($51)"]}],"writeRatioAvg":0.007602717567130378},{"readMsMax":"91","computeMsMax":"720","waitMsAvg":"521","id":"2","endMs":"1570993784557","waitMsMax":"551","startMs":"1570993783423","waitRatioMax":0.08912973147848592,"readRatioAvg":0.0029116790682626984,"parallelInputs":"92","recordsRead":"70474075","computeRatioAvg":0.10029116790682627,"writeMsAvg":"59","status":"COMPLETE","writeMsMax":"337","computeMsAvg":"620","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05451310255580718,"readMsAvg":"18","waitRatioAvg":0.08427693303138142,"completedParallelInputs":"92","computeRatioMax":0.11646716273050793,"name":"S02: Input","shuffleOutputBytes":"1268392662","recordsWritten":"70474075","readRatioMax":0.014720155289550308,"steps":[{"kind":"READ","substeps":["$40:ws_warehouse_sk, $41:ws_order_number","FROM web_sales"]},{"kind":"WRITE","substeps":["$40, $41","TO __stage02_output","BY HASH($41)"]}],"writeRatioAvg":0.009543836945972177},{"readMsMax":"40","computeMsMax":"711","waitMsAvg":"513","id":"3","endMs":"1570993784418","waitMsMax":"546","startMs":"1570993783431","waitRatioMax":0.08832093173730185,"readRatioAvg":0.0030734390164995147,"parallelInputs":"92","recordsRead":"70474075","computeRatioAvg":0.09980588806211582,"writeMsAvg":"45","status":"COMPLETE","writeMsMax":"91","computeMsAvg":"617","shuffleOutputBytesSpilled":"0","writeRatioMax":0.014720155289550308,"readMsAvg":"19","waitRatioAvg":0.08298285344548689,"completedParallelInputs":"92","computeRatioMax":0.11501132319637658,"name":"S03: Input","shuffleOutputBytes":"1268392662","recordsWritten":"70474075","readRatioMax":0.006470397929472662,"steps":[{"kind":"READ","substeps":["$30:ws_warehouse_sk, $31:ws_order_number","FROM web_sales"]},{"kind":"WRITE","substeps":["$30, $31","TO __stage03_output","BY HASH($31)"]}],"writeRatioAvg":0.007279197670656746},{"readMsMax":"48","computeMsMax":"797","waitMsAvg":"489","id":"4","endMs":"1570993784409","waitMsMax":"523","startMs":"1570993783437","waitRatioMax":0.08460045292785506,"readRatioAvg":0.0029116790682626984,"parallelInputs":"92","recordsRead":"70474075","computeRatioAvg":0.09980588806211582,"writeMsAvg":"44","status":"COMPLETE","writeMsMax":"130","computeMsAvg":"617","shuffleOutputBytesSpilled":"0","writeRatioMax":0.021028793270786154,"readMsAvg":"18","waitRatioAvg":0.0791006146878033,"completedParallelInputs":"92","computeRatioMax":0.1289226787447428,"name":"S04: Input","shuffleOutputBytes":"1268392662","recordsWritten":"70474075","readRatioMax":0.007764477515367195,"steps":[{"kind":"READ","substeps":["$20:ws_warehouse_sk, $21:ws_order_number","FROM web_sales"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage04_output","BY HASH($21)"]}],"writeRatioAvg":0.0071174377224199285},{"readMsMax":"6","computeMsMax":"5","waitMsAvg":"25","id":"5","endMs":"1570993783569","waitMsMax":"25","startMs":"1570993783518","waitRatioMax":0.004043998705920414,"readRatioAvg":0.0009705596894208993,"parallelInputs":"1","recordsRead":"24","computeRatioAvg":0.0008087997411840828,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003396958912973148,"readMsAvg":"6","waitRatioAvg":0.004043998705920414,"completedParallelInputs":"1","computeRatioMax":0.0008087997411840828,"name":"S05: Input","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.0009705596894208993,"steps":[{"kind":"READ","substeps":["$10:web_site_sk, $11:web_company_name","FROM web_site","WHERE equal($11, 'pri')"]},{"kind":"WRITE","substeps":["$10","TO __stage05_output","BY HASH($10)"]}],"writeRatioAvg":0.003396958912973148},{"readMsMax":"18","computeMsMax":"27","waitMsAvg":"17","id":"6","endMs":"1570993783586","waitMsMax":"17","startMs":"1570993783527","waitRatioMax":0.0027499191200258816,"readRatioAvg":0.0029116790682626984,"parallelInputs":"1","recordsRead":"1000000","computeRatioAvg":0.004367518602394047,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"27","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0030734390164995147,"readMsAvg":"18","waitRatioAvg":0.0027499191200258816,"completedParallelInputs":"1","computeRatioMax":0.004367518602394047,"name":"S06: Input","shuffleOutputBytes":"257634","recordsWritten":"28626","readRatioMax":0.0029116790682626984,"steps":[{"kind":"READ","substeps":["$70:ca_address_sk, $71:ca_state","FROM customer_address","WHERE equal($71, 'IN')"]},{"kind":"WRITE","substeps":["$70","TO __stage06_output","BY HASH($70)"]}],"writeRatioAvg":0.0030734390164995147},{"readMsMax":"17","computeMsMax":"22","waitMsAvg":"14","id":"7","endMs":"1570993783630","waitMsMax":"14","startMs":"1570993783538","waitRatioMax":0.002264639275315432,"readRatioAvg":0.0027499191200258816,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0035587188612099642,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"22","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0014558395341313492,"readMsAvg":"17","waitRatioAvg":0.002264639275315432,"completedParallelInputs":"1","computeRatioMax":0.0035587188612099642,"name":"S07: Input","shuffleOutputBytes":"558","recordsWritten":"62","readRatioMax":0.0027499191200258816,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_date","FROM date_dim","WHERE between(CAST($81 AS DATE), 11048, 11109)"]},{"kind":"WRITE","substeps":["$80","TO __stage07_output","BY HASH($80)"]}],"writeRatioAvg":0.0014558395341313492},{"readMsMax":"0","computeMsMax":"7","inputStages":["6"],"waitMsAvg":"271","id":"9","endMs":"1570993783954","waitMsMax":"289","startMs":"1570993783790","waitRatioMax":0.04674862504043999,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"28626","computeRatioAvg":0.00048527984471044967,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"3","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0027499191200258816,"readMsAvg":"0","waitRatioAvg":0.04383694597217729,"completedParallelInputs":"100","computeRatioMax":0.001132319637657716,"name":"S09: Coalesce","shuffleOutputBytes":"257634","recordsWritten":"28626","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage06_output"]}],"writeRatioAvg":0.0006470397929472663},{"readMsMax":"0","computeMsMax":"5854","inputStages":["3","4"],"waitMsAvg":"2","id":"10","endMs":"1570993789063","waitMsMax":"3","startMs":"1570993784444","waitRatioMax":0.00048527984471044967,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"140948150","computeRatioAvg":0.7976383047557425,"writeMsAvg":"458","status":"COMPLETE","writeMsMax":"2267","computeMsAvg":"4931","shuffleOutputBytesSpilled":"0","writeRatioMax":0.3667098026528631,"readMsAvg":"0","waitRatioAvg":0.00032351989647363315,"completedParallelInputs":"100","computeRatioMax":0.9469427369783242,"name":"S0A: Join+","shuffleOutputBytes":"6837723270","recordsWritten":"759747030","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$20, $21","FROM __stage04_output"]},{"kind":"READ","substeps":["$30, $31","FROM __stage03_output"]},{"kind":"FILTER","substeps":["not_equal($240, $242)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH EACH ON $21 = $31"]},{"kind":"WRITE","substeps":["$241","TO __stage0A_output","BY HASH($241)"]}],"writeRatioAvg":0.07408605629246198},{"readMsMax":"0","computeMsMax":"5865","inputStages":["1","2"],"waitMsAvg":"1","id":"11","endMs":"1570993790486","waitMsMax":"4","startMs":"1570993784656","waitRatioMax":0.0006470397929472663,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"140948150","computeRatioAvg":0.8078291814946619,"writeMsAvg":"700","status":"COMPLETE","writeMsMax":"2339","computeMsAvg":"4994","shuffleOutputBytesSpilled":"0","writeRatioMax":0.37835651892591393,"readMsAvg":"0","waitRatioAvg":0.00016175994823681658,"completedParallelInputs":"100","computeRatioMax":0.9487220964089291,"name":"S0B: Join+","shuffleOutputBytes":"6837723270","recordsWritten":"759747030","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$40, $41","FROM __stage02_output"]},{"kind":"READ","substeps":["$50, $51","FROM __stage01_output"]},{"kind":"FILTER","substeps":["not_equal($260, $262)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH EACH ON $41 = $51"]},{"kind":"WRITE","substeps":["$261","TO __stage0B_output","BY HASH($261)"]}],"writeRatioAvg":0.11323196376577159},{"readMsMax":"141","computeMsMax":"696","inputStages":["5","9","7"],"waitMsAvg":"3","id":"12","endMs":"1570993785481","waitMsMax":"9","startMs":"1570993784751","waitRatioMax":0.0014558395341313492,"readRatioAvg":0.009058557101261728,"parallelInputs":"92","recordsRead":"73113463","computeRatioAvg":0.0742478162406988,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"37","computeMsAvg":"459","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005985118084762213,"readMsAvg":"56","waitRatioAvg":0.00048527984471044967,"completedParallelInputs":"92","computeRatioMax":0.11258492397282432,"name":"S0C: Join","shuffleOutputBytes":"105840","recordsWritten":"3920","readRatioMax":0.022808152701391134,"steps":[{"kind":"READ","substeps":["$60:ws_ship_date_sk, $61:ws_ship_addr_sk, $62:ws_web_site_sk, $63:ws_order_number, $64:ws_ext_ship_cost, $65:ws_net_profit","FROM web_sales"]},{"kind":"READ","substeps":["$80","FROM __stage07_output"]},{"kind":"READ","substeps":["$70","FROM __stage09_output"]},{"kind":"READ","substeps":["$10","FROM __stage05_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $220 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $210 = $70"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $60 = $80"]},{"kind":"WRITE","substeps":["$230, $231, $232","TO __stage0C_output","BY HASH($230)"]}],"writeRatioAvg":0.0012940795858945326},{"readMsMax":"0","computeMsMax":"6182","inputStages":["11","0"],"waitMsAvg":"3","id":"13","endMs":"1570993794643","waitMsMax":"4","startMs":"1570993790841","waitRatioMax":0.0006470397929472663,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"766795468","computeRatioAvg":0.8605629246198642,"writeMsAvg":"570","status":"COMPLETE","writeMsMax":"766","computeMsAvg":"5320","shuffleOutputBytesSpilled":"0","writeRatioMax":0.12390812034940149,"readMsAvg":"0","waitRatioAvg":0.00048527984471044967,"completedParallelInputs":"100","computeRatioMax":1,"name":"S0D: Join","shuffleOutputBytes":"8963044128","recordsWritten":"995893792","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$1","FROM __stage00_output"]},{"kind":"READ","substeps":["$261","FROM __stage0B_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH EACH ON $1 = $261"]},{"kind":"WRITE","substeps":["$270","TO __stage0D_output","BY HASH($270)"]}],"writeRatioAvg":0.09220317049498544},{"readMsMax":"0","computeMsMax":"1167","inputStages":["10","12"],"waitMsAvg":"3","id":"14","endMs":"1570993792265","waitMsMax":"6","startMs":"1570993791424","waitRatioMax":0.0009705596894208993,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"759750950","computeRatioAvg":0.14898091232610805,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"77","computeMsAvg":"921","shuffleOutputBytesSpilled":"0","writeRatioMax":0.012455516014234875,"readMsAvg":"0","waitRatioAvg":0.00048527984471044967,"completedParallelInputs":"100","computeRatioMax":0.18877385959236492,"name":"S0E: Join","shuffleOutputBytes":"105840","recordsWritten":"3920","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$230, $231, $232","FROM __stage0C_output"]},{"kind":"READ","substeps":["$241","FROM __stage0A_output"]},{"kind":"JOIN","substeps":["SEMI HASH JOIN EACH WITH EACH ON $230 = $241"]},{"kind":"WRITE","substeps":["$250, $251, $252","TO __stage0E_output","BY HASH($250)"]}],"writeRatioAvg":0.0014558395341313492},{"readMsMax":"0","computeMsMax":"1471","inputStages":["13","14"],"waitMsAvg":"1","id":"15","endMs":"1570993795574","waitMsMax":"3","startMs":"1570993794693","waitRatioMax":0.00048527984471044967,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"995897712","computeRatioAvg":0.18537690067939178,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"1146","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003720478809446781,"readMsAvg":"0","waitRatioAvg":0.00016175994823681658,"completedParallelInputs":"100","computeRatioMax":0.23794888385635718,"name":"S0F: Join+","shuffleOutputBytes":"49660","recordsWritten":"2443","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$250, $251, $252","FROM __stage0E_output"]},{"kind":"READ","substeps":["$270","FROM __stage0D_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $290 := $200, $291 := $180","$170 := SUM($182)","$171 := SUM($181)"]},{"kind":"COMPUTE","substeps":["$180 := if(equal($200, 1), $280, NULL)","$181 := if(equal($200, 0), $282, NULL)","$182 := if(equal($200, 0), $281, NULL)"]},{"kind":"COMPUTE","substeps":["$190 := ARRAY<...>"]},{"kind":"JOIN","substeps":["SEMI HASH JOIN EACH WITH EACH ON $250 = $270"]},{"kind":"WRITE","substeps":["$170, $171, $291, $290","TO __stage0F_output","BY HASH($290, $291)"]}],"writeRatioAvg":0.0012940795858945326},{"readMsMax":"0","computeMsMax":"10","inputStages":["15"],"waitMsAvg":"1","id":"16","endMs":"1570993795704","waitMsMax":"6","startMs":"1570993795623","waitRatioMax":0.0009705596894208993,"readRatioAvg":0,"parallelInputs":"46","recordsRead":"2443","computeRatioAvg":0.001132319637657716,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"31","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005014558395341313,"readMsAvg":"0","waitRatioAvg":0.00016175994823681658,"completedParallelInputs":"46","computeRatioMax":0.0016175994823681655,"name":"S10: Aggregate+","shuffleOutputBytes":"956","recordsWritten":"47","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$170, $171, $291, $290","FROM __stage0F_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $310 := $300","$140 := COUNT($152)","$141 := ANY_VALUE($151)","$142 := ANY_VALUE($150)"]},{"kind":"COMPUTE","substeps":["$150 := if(equal($300, 0), $161, NULL)","$151 := if(equal($300, 0), $160, NULL)","$152 := if(equal($300, 1), $301, NULL)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $300 := $290, $301 := $291","$160 := SUM($170)","$161 := SUM($171)"]},{"kind":"WRITE","substeps":["$140, $141, $142, $310","TO __stage10_output","BY HASH($310)"]}],"writeRatioAvg":0.0038822387576835974},{"readMsMax":"0","computeMsMax":"5","inputStages":["16"],"waitMsAvg":"2","id":"17","endMs":"1570993795800","waitMsMax":"2","startMs":"1570993795712","waitRatioMax":0.00032351989647363315,"readRatioAvg":0,"parallelInputs":"4","recordsRead":"47","computeRatioAvg":0.0006470397929472663,"writeMsAvg":"32","status":"COMPLETE","writeMsMax":"34","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005499838240051763,"readMsAvg":"0","waitRatioAvg":0.00032351989647363315,"completedParallelInputs":"4","computeRatioMax":0.0008087997411840828,"name":"S11: Aggregate+","shuffleOutputBytes":"36","recordsWritten":"4","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$140, $141, $142, $310","FROM __stage10_output"]},{"kind":"AGGREGATE","substeps":["$110 := ANY_VALUE($122)","$111 := ANY_VALUE($121)","$112 := ANY_VALUE($120)"]},{"kind":"COMPUTE","substeps":["$120 := if(equal($320, 0), $132, NULL)","$121 := if(equal($320, 0), $131, NULL)","$122 := if(equal($320, 1), $130, NULL)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $320 := $310","$130 := SUM_OF_COUNTS($140)","$131 := ANY_VALUE($141)","$132 := ANY_VALUE($142)"]},{"kind":"WRITE","substeps":["$110, $111, $112","TO __stage11_output"]}],"writeRatioAvg":0.00517631834357813},{"readMsMax":"0","computeMsMax":"4","inputStages":["17"],"waitMsAvg":"1","id":"18","endMs":"1570993795816","waitMsMax":"1","startMs":"1570993795733","waitRatioMax":0.00016175994823681658,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"4","computeRatioAvg":0.0006470397929472663,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"4","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001132319637657716,"readMsAvg":"0","waitRatioAvg":0.00016175994823681658,"completedParallelInputs":"1","computeRatioMax":0.0006470397929472663,"name":"S12: Output","shuffleOutputBytes":"27","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110, $111, $112","FROM __stage11_output"]},{"kind":"SORT","substeps":["$90 ASC","LIMIT 100"]},{"kind":"COMPUTE","substeps":["$90 := if(is_null($100), 0, $100)"]},{"kind":"AGGREGATE","substeps":["$100 := ANY_VALUE($110)","$101 := ANY_VALUE($111)","$102 := ANY_VALUE($112)"]},{"kind":"WRITE","substeps":["$330, $331, $332","TO __stage12_output"]}],"writeRatioAvg":0.001132319637657716}],"estimatedBytesProcessed":"4015575343","timeline":[{"totalSlotMs":"6731","activeUnits":"23","completedUnits":"12","elapsedMs":"771","pendingUnits":"462"},{"totalSlotMs":"269201","activeUnits":"292","completedUnits":"474","elapsedMs":"1776","pendingUnits":"292"},{"totalSlotMs":"490684","activeUnits":"200","completedUnits":"566","elapsedMs":"2399","pendingUnits":"200"},{"totalSlotMs":"1185810","activeUnits":"159","completedUnits":"677","elapsedMs":"4603","pendingUnits":"89"},{"totalSlotMs":"1271819","activeUnits":"23","completedUnits":"763","elapsedMs":"5655","pendingUnits":"3"},{"totalSlotMs":"1275780","activeUnits":"2","completedUnits":"765","elapsedMs":"6228","pendingUnits":"1"},{"totalSlotMs":"1464001","activeUnits":"171","completedUnits":"795","elapsedMs":"8842","pendingUnits":"171"},{"totalSlotMs":"1577298","activeUnits":"100","completedUnits":"866","elapsedMs":"9344","pendingUnits":"100"},{"totalSlotMs":"1820854","activeUnits":"69","completedUnits":"947","elapsedMs":"11148","pendingUnits":"19"},{"totalSlotMs":"1951899","activeUnits":"100","completedUnits":"1111","elapsedMs":"12619","pendingUnits":"1"},{"totalSlotMs":"1952347","activeUnits":"2","completedUnits":"1117","elapsedMs":"12928","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"4016046080","totalPartitionsProcessed":"0","totalBytesProcessed":"4015575343","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_returns","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_site","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_100"}]},"endTime":"1570993796049"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query95_1570993780"},"etag":"dpT+sRoaLjjLqWFBvMqydQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query95_1570993780?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon618a7866717f6af1af37bb5eeb8e3b0dc2f07b76","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query95\nWITH ws_wh AS \n( \n SELECT ws1.ws_order_number, \n ws1.ws_warehouse_sk wh1, \n ws2.ws_warehouse_sk wh2 \n FROM web_sales ws1, \n web_sales ws2 \n WHERE ws1.ws_order_number = ws2.ws_order_number \n AND ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) \nSELECT \n Count(DISTINCT ws_order_number) AS order_count, \n Sum(ws_ext_ship_cost) AS total_shipping_cost, \n Sum(ws_net_profit) AS total_net_profit\nFROM web_sales ws1 , \n date_dim , \n customer_address , \n web_site \nWHERE Cast(d_date AS DATE) BETWEEN Cast('2000-4-01' AS DATE) AND ( \n Cast('2000-6-01' AS DATE)) \nAND ws1.ws_ship_date_sk = d_date_sk \nAND ws1.ws_ship_addr_sk = ca_address_sk \nAND ca_state = 'IN' \nAND ws1.ws_web_site_sk = web_site_sk \nAND web_company_name = 'pri' \nAND ws1.ws_order_number IN \n ( \n SELECT ws_order_number \n FROM ws_wh) \nAND ws1.ws_order_number IN \n ( \n SELECT wr_order_number \n FROM web_returns, \n ws_wh \n WHERE wr_order_number = ws_wh.ws_order_number) \nORDER BY count(DISTINCT ws_order_number) \nLIMIT 100; \n\n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query95_1570993780","user_email":"nithish.sankaranarayanan@ulb.be"}
