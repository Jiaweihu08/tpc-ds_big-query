{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"244166","creationTime":"1570992282986","totalBytesProcessed":"12633867530","startTime":"1570992283106","query":{"totalSlotMs":"244166","queryPlan":[{"readMsMax":"17","computeMsMax":"9","waitMsAvg":"1","id":"0","endMs":"1570992283405","waitMsMax":"1","startMs":"1570992283335","waitRatioMax":0.00010879025239338555,"readRatioAvg":0.0018494342906875544,"parallelInputs":"1","recordsRead":"15","computeRatioAvg":0.0009791122715404699,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"16","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0017406440382941688,"readMsAvg":"17","waitRatioAvg":0.00010879025239338555,"completedParallelInputs":"1","computeRatioMax":0.0009791122715404699,"name":"S00: Input","shuffleOutputBytes":"135","recordsWritten":"15","readRatioMax":0.0018494342906875544,"steps":[{"kind":"READ","substeps":["$1:w_warehouse_sk","FROM warehouse"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.0017406440382941688},{"readMsMax":"77","computeMsMax":"213","waitMsAvg":"24","id":"1","endMs":"1570992283749","waitMsMax":"24","startMs":"1570992283375","waitRatioMax":0.0026109660574412533,"readRatioAvg":0.008376849434290687,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.023172323759791124,"writeMsAvg":"15","status":"COMPLETE","writeMsMax":"15","computeMsAvg":"213","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0016318537859007832,"readMsAvg":"77","waitRatioAvg":0.0026109660574412533,"completedParallelInputs":"1","computeRatioMax":0.023172323759791124,"name":"S01: Input","shuffleOutputBytes":"16525648","recordsWritten":"204000","readRatioMax":0.008376849434290687,"steps":[{"kind":"READ","substeps":["$10:i_item_sk, $11:i_brand, $12:i_class, $13:i_category, $14:i_product_name","FROM item"]},{"kind":"WRITE","substeps":["$10, $11, $12, $13, $14","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.0016318537859007832},{"readMsMax":"93","computeMsMax":"11","waitMsAvg":"37","id":"2","endMs":"1570992283539","waitMsMax":"37","startMs":"1570992283406","waitRatioMax":0.004025239338555265,"readRatioAvg":0.010117493472584857,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.001196692776327241,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007615317667536989,"readMsAvg":"93","waitRatioAvg":0.004025239338555265,"completedParallelInputs":"1","computeRatioMax":0.001196692776327241,"name":"S02: Input","shuffleOutputBytes":"3285","recordsWritten":"365","readRatioMax":0.010117493472584857,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_month_seq","FROM date_dim","WHERE between($31, 1205, 1216)"]},{"kind":"WRITE","substeps":["$30","TO __stage02_output","BY HASH($30)"]}],"writeRatioAvg":0.0007615317667536989},{"readMsMax":"77","computeMsMax":"9192","inputStages":["0","1","2"],"waitMsAvg":"3","id":"5","endMs":"1570992288882","waitMsMax":"5","startMs":"1570992283973","waitRatioMax":0.0005439512619669277,"readRatioAvg":0.0045691906005221935,"parallelInputs":"40","recordsRead":"407505200","computeRatioAvg":0.8306135770234987,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"32","computeMsAvg":"7635","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0034812880765883376,"readMsAvg":"42","waitRatioAvg":0.00032637075718015666,"completedParallelInputs":"40","computeRatioMax":1,"name":"S05: Join+","shuffleOutputBytes":"479113194","recordsWritten":"5434212","readRatioMax":0.008376849434290687,"steps":[{"kind":"READ","substeps":["$20:inv_date_sk, $21:inv_item_sk, $22:inv_warehouse_sk, $23:inv_quantity_on_hand","FROM inventory"]},{"kind":"READ","substeps":["$30","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11, $12, $13, $14","FROM __stage01_output"]},{"kind":"READ","substeps":["$1","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $90 := $83, $91 := $80, $92 := $81, $93 := $82","$50 := SHARD_AVG($84)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $70 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $60 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $20 = $30"]},{"kind":"WRITE","substeps":["$91, $92, $93, $90, $50","TO __stage05_output","BY HASH($90, $91, $92, $93)"]}],"writeRatioAvg":0.0019582245430809398},{"readMsMax":"0","computeMsMax":"2747","inputStages":["5"],"waitMsAvg":"4","id":"6","endMs":"1570992293514","waitMsMax":"5","startMs":"1570992288481","waitRatioMax":0.0005439512619669277,"readRatioAvg":0,"parallelInputs":"2","recordsRead":"2441270","computeRatioAvg":0.26631853785900783,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"27","computeMsAvg":"2448","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00293733681462141,"readMsAvg":"0","waitRatioAvg":0.0004351610095735422,"completedParallelInputs":"2","computeRatioMax":0.29884682332463014,"name":"S06: Repartition","shuffleOutputBytes":"215240710","recordsWritten":"2441270","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage05_output"]}],"writeRatioAvg":0.002502175805047868},{"readMsMax":"0","computeMsMax":"2835","inputStages":["6","5"],"waitMsAvg":"1","id":"7","endMs":"1570992296494","waitMsMax":"2","startMs":"1570992294858","waitRatioMax":0.0002175805047867711,"readRatioAvg":0,"parallelInputs":"22","recordsRead":"5434212","computeRatioAvg":0.040905134899912966,"writeMsAvg":"2","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"376","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0006527415143603133,"readMsAvg":"0","waitRatioAvg":0.00010879025239338555,"completedParallelInputs":"22","computeRatioMax":0.30842036553524804,"name":"S07: Sort+","shuffleOutputBytes":"178453","recordsWritten":"2200","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$91, $92, $93, $90, $50","FROM __stage05_output"]},{"kind":"SORT","substeps":["$40 ASC, $100 ASC, $101 ASC, $102 ASC, $103 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $100 := $90, $101 := $91, $102 := $92, $103 := $93","$40 := ROOT_AVG($50)"]},{"kind":"WRITE","substeps":["$110, $111, $112, $113, $114","TO __stage07_output"]}],"writeRatioAvg":0.0002175805047867711},{"readMsMax":"0","computeMsMax":"8","inputStages":["7"],"waitMsAvg":"5","id":"8","endMs":"1570992296518","waitMsMax":"5","startMs":"1570992294935","waitRatioMax":0.0005439512619669277,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2200","computeRatioAvg":0.0008703220191470844,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007615317667536989,"readMsAvg":"0","waitRatioAvg":0.0005439512619669277,"completedParallelInputs":"1","computeRatioMax":0.0008703220191470844,"name":"S08: Output","shuffleOutputBytes":"8149","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110, $111, $112, $113, $114","FROM __stage07_output"]},{"kind":"SORT","substeps":["$114 ASC, $113 ASC, $110 ASC, $111 ASC, $112 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$120, $121, $122, $123, $124","TO __stage08_output"]}],"writeRatioAvg":0.0007615317667536989}],"estimatedBytesProcessed":"12633867530","timeline":[{"totalSlotMs":"4123","activeUnits":"0","completedUnits":"3","elapsedMs":"730","pendingUnits":"40"},{"totalSlotMs":"16639","activeUnits":"40","completedUnits":"3","elapsedMs":"1369","pendingUnits":"40"},{"totalSlotMs":"206113","activeUnits":"32","completedUnits":"32","elapsedMs":"5276","pendingUnits":"11"},{"totalSlotMs":"214831","activeUnits":"2","completedUnits":"43","elapsedMs":"5810","pendingUnits":"2"},{"totalSlotMs":"219896","activeUnits":"1","completedUnits":"44","elapsedMs":"7039","pendingUnits":"1"},{"totalSlotMs":"225378","activeUnits":"0","completedUnits":"45","elapsedMs":"10909","pendingUnits":"0"},{"totalSlotMs":"231157","activeUnits":"7","completedUnits":"65","elapsedMs":"12253","pendingUnits":"3"},{"totalSlotMs":"244166","activeUnits":"0","completedUnits":"68","elapsedMs":"13876","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"12634292224","totalPartitionsProcessed":"0","totalBytesProcessed":"12633867530","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"inventory","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"warehouse","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_100"}]},"endTime":"1570992297003"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query22_1570992281"},"etag":"nUXq+l88RUHZOfV07B9L9g==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query22_1570992281?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonf2a5df269990c51ea0aedf2f00d4a465a0e298fb","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query22\nSELECT i_product_name, \n i_brand, \n i_class, \n i_category, \n Avg(inv_quantity_on_hand) qoh \nFROM inventory, \n date_dim, \n item, \n warehouse \nWHERE inv_date_sk = d_date_sk \n AND inv_item_sk = i_item_sk \n AND inv_warehouse_sk = w_warehouse_sk \n AND d_month_seq BETWEEN 1205 AND 1205 + 11 \nGROUP BY i_product_name, i_brand, i_class, i_category \nORDER BY qoh, \n i_product_name, \n i_brand, \n i_class, \n i_category\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query22_1570992281","user_email":"nithish.sankaranarayanan@ulb.be"}
