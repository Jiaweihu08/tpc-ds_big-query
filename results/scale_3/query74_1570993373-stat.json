{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"1433423","creationTime":"1570993374943","totalBytesProcessed":"8235405480","startTime":"1570993375152","query":{"totalSlotMs":"1433423","queryPlan":[{"readMsMax":"13","computeMsMax":"10","waitMsAvg":"1","id":"0","endMs":"1570993375404","waitMsMax":"1","startMs":"1570993375348","waitRatioMax":0.00012695188523549576,"readRatioAvg":0.0016503745080614447,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0012695188523549575,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0024120858194744193,"readMsAvg":"13","waitRatioAvg":0.00012695188523549576,"completedParallelInputs":"1","computeRatioMax":0.0012695188523549575,"name":"S00: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0016503745080614447,"steps":[{"kind":"READ","substeps":["$110:d_date_sk, $111:d_year","FROM date_dim","WHERE and(in($111, 1999, 2000), equal($111, 1999))"]},{"kind":"WRITE","substeps":["$110, $111","TO __stage00_output","BY HASH($110)"]}],"writeRatioAvg":0.0024120858194744193},{"readMsMax":"131","computeMsMax":"2453","waitMsAvg":"53","id":"1","endMs":"1570993378555","waitMsMax":"58","startMs":"1570993375392","waitRatioMax":0.007363209343658753,"readRatioAvg":0.005205027294655325,"parallelInputs":"184","recordsRead":"281872923","computeRatioAvg":0.19525199949219246,"writeMsAvg":"72","status":"COMPLETE","writeMsMax":"2309","computeMsAvg":"1538","shuffleOutputBytesSpilled":"0","writeRatioMax":0.2931319030087597,"readMsAvg":"41","waitRatioAvg":0.006728449917481274,"completedParallelInputs":"184","computeRatioMax":0.3114129744826711,"name":"S01: Input","shuffleOutputBytes":"7166497218","recordsWritten":"269184774","readRatioMax":0.016630696965849942,"steps":[{"kind":"READ","substeps":["$100:ss_sold_date_sk, $101:ss_customer_sk, $102:ss_net_paid","FROM store_sales"]},{"kind":"WRITE","substeps":["$100, $101, $102","TO __stage01_output","BY HASH($101)"]}],"writeRatioAvg":0.009140535736955694},{"readMsMax":"54","computeMsMax":"3408","waitMsAvg":"23","id":"2","endMs":"1570993377247","waitMsMax":"23","startMs":"1570993375405","waitRatioMax":0.0029198933604164022,"readRatioAvg":0.00685540180271677,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.4326520248825695,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"20","computeMsAvg":"3408","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002539037704709915,"readMsAvg":"54","waitRatioAvg":0.0029198933604164022,"completedParallelInputs":"1","computeRatioMax":0.4326520248825695,"name":"S02: Input","shuffleOutputBytes":"102541144","recordsWritten":"2000000","readRatioMax":0.00685540180271677,"steps":[{"kind":"READ","substeps":["$90:c_customer_sk, $91:c_customer_id, $92:c_first_name, $93:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$90, $91, $92, $93","TO __stage02_output","BY HASH($90)"]}],"writeRatioAvg":0.002539037704709915},{"readMsMax":"16","computeMsMax":"10","waitMsAvg":"10","id":"3","endMs":"1570993375513","waitMsMax":"10","startMs":"1570993375407","waitRatioMax":0.0012695188523549575,"readRatioAvg":0.002031230163767932,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0012695188523549575,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0036816046718293766,"readMsAvg":"16","waitRatioAvg":0.0012695188523549575,"completedParallelInputs":"1","computeRatioMax":0.0012695188523549575,"name":"S03: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.002031230163767932,"steps":[{"kind":"READ","substeps":["$80:d_date_sk, $81:d_year","FROM date_dim","WHERE and(in($81, 1999, 2000), equal($81, 1999))"]},{"kind":"WRITE","substeps":["$80, $81","TO __stage03_output","BY HASH($80)"]}],"writeRatioAvg":0.0036816046718293766},{"readMsMax":"119","computeMsMax":"981","waitMsAvg":"31","id":"4","endMs":"1570993376183","waitMsMax":"35","startMs":"1570993375454","waitRatioMax":0.004443315983242351,"readRatioAvg":0.004062460327535864,"parallelInputs":"92","recordsRead":"70474075","computeRatioAvg":0.10079979687698362,"writeMsAvg":"50","status":"COMPLETE","writeMsMax":"205","computeMsAvg":"794","shuffleOutputBytesSpilled":"0","writeRatioMax":0.026025136473276627,"readMsAvg":"32","waitRatioAvg":0.003935508442300368,"completedParallelInputs":"92","computeRatioMax":0.12453979941602132,"name":"S04: Input","shuffleOutputBytes":"1902183901","recordsWritten":"70456495","readRatioMax":0.015107274343023993,"steps":[{"kind":"READ","substeps":["$70:ws_sold_date_sk, $71:ws_bill_customer_sk, $72:ws_net_paid","FROM web_sales"]},{"kind":"WRITE","substeps":["$70, $71, $72","TO __stage04_output","BY HASH($71)"]}],"writeRatioAvg":0.006347594261774787},{"readMsMax":"25","computeMsMax":"3396","waitMsAvg":"4","id":"5","endMs":"1570993376999","waitMsMax":"4","startMs":"1570993375455","waitRatioMax":0.000507807540941983,"readRatioAvg":0.0031737971308873937,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.43112860225974353,"writeMsAvg":"13","status":"COMPLETE","writeMsMax":"13","computeMsAvg":"3396","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0016503745080614447,"readMsAvg":"25","waitRatioAvg":0.000507807540941983,"completedParallelInputs":"1","computeRatioMax":0.43112860225974353,"name":"S05: Input","shuffleOutputBytes":"102541144","recordsWritten":"2000000","readRatioMax":0.0031737971308873937,"steps":[{"kind":"READ","substeps":["$60:c_customer_sk, $61:c_customer_id, $62:c_first_name, $63:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$60, $61, $62, $63","TO __stage05_output","BY HASH($60)"]}],"writeRatioAvg":0.0016503745080614447},{"readMsMax":"11","computeMsMax":"8","waitMsAvg":"1","id":"6","endMs":"1570993375569","waitMsMax":"1","startMs":"1570993375484","waitRatioMax":0.00012695188523549576,"readRatioAvg":0.0013964707375904533,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.001015615081883966,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002158182049003428,"readMsAvg":"11","waitRatioAvg":0.00012695188523549576,"completedParallelInputs":"1","computeRatioMax":0.001015615081883966,"name":"S06: Input","shuffleOutputBytes":"6588","recordsWritten":"366","readRatioMax":0.0013964707375904533,"steps":[{"kind":"READ","substeps":["$50:d_date_sk, $51:d_year","FROM date_dim","WHERE and(in($51, 1999, 2000), equal($51, 2000))"]},{"kind":"WRITE","substeps":["$50, $51","TO __stage06_output","BY HASH($50)"]}],"writeRatioAvg":0.002158182049003428},{"readMsMax":"166","computeMsMax":"1878","waitMsAvg":"5","id":"7","endMs":"1570993376961","waitMsMax":"11","startMs":"1570993375503","waitRatioMax":0.0013964707375904533,"readRatioAvg":0.0046972197537133425,"parallelInputs":"184","recordsRead":"281872923","computeRatioAvg":0.1939824806398375,"writeMsAvg":"31","status":"COMPLETE","writeMsMax":"483","computeMsAvg":"1528","shuffleOutputBytesSpilled":"0","writeRatioMax":0.061317760568744446,"readMsAvg":"37","waitRatioAvg":0.0006347594261774788,"completedParallelInputs":"184","computeRatioMax":0.23841564047226102,"name":"S07: Input","shuffleOutputBytes":"7166497218","recordsWritten":"269184774","readRatioMax":0.021074012949092294,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_customer_sk, $42:ss_net_paid","FROM store_sales"]},{"kind":"WRITE","substeps":["$40, $41, $42","TO __stage07_output","BY HASH($41)"]}],"writeRatioAvg":0.003935508442300368},{"readMsMax":"26","computeMsMax":"2807","waitMsAvg":"47","id":"8","endMs":"1570993377069","waitMsMax":"47","startMs":"1570993375569","waitRatioMax":0.0059667386060683,"readRatioAvg":0.0033007490161228894,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.3563539418560366,"writeMsAvg":"14","status":"COMPLETE","writeMsMax":"14","computeMsAvg":"2807","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0017773263932969405,"readMsAvg":"26","waitRatioAvg":0.0059667386060683,"completedParallelInputs":"1","computeRatioMax":0.3563539418560366,"name":"S08: Input","shuffleOutputBytes":"102541144","recordsWritten":"2000000","readRatioMax":0.0033007490161228894,"steps":[{"kind":"READ","substeps":["$30:c_customer_sk, $31:c_customer_id, $32:c_first_name, $33:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$30, $31, $32, $33","TO __stage08_output","BY HASH($30)"]}],"writeRatioAvg":0.0017773263932969405},{"readMsMax":"12","computeMsMax":"9","waitMsAvg":"34","id":"9","endMs":"1570993375734","waitMsMax":"34","startMs":"1570993375576","waitRatioMax":0.004316364098006856,"readRatioAvg":0.001523422622825949,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0011425669671194618,"writeMsAvg":"88","status":"COMPLETE","writeMsMax":"88","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011171765900723626,"readMsAvg":"12","waitRatioAvg":0.004316364098006856,"completedParallelInputs":"1","computeRatioMax":0.0011425669671194618,"name":"S09: Input","shuffleOutputBytes":"6588","recordsWritten":"366","readRatioMax":0.001523422622825949,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_year","FROM date_dim","WHERE and(in($21, 1999, 2000), equal($21, 2000))"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage09_output","BY HASH($20)"]}],"writeRatioAvg":0.011171765900723626},{"readMsMax":"72","computeMsMax":"1065","waitMsAvg":"21","id":"10","endMs":"1570993376210","waitMsMax":"28","startMs":"1570993375576","waitRatioMax":0.003554652786593881,"readRatioAvg":0.0036816046718293766,"parallelInputs":"92","recordsRead":"70474075","computeRatioAvg":0.10295797892598706,"writeMsAvg":"43","status":"COMPLETE","writeMsMax":"229","computeMsAvg":"811","shuffleOutputBytesSpilled":"0","writeRatioMax":0.029071981718928525,"readMsAvg":"29","waitRatioAvg":0.002665989589945411,"completedParallelInputs":"92","computeRatioMax":0.13520375777580296,"name":"S0A: Input","shuffleOutputBytes":"1902183901","recordsWritten":"70456495","readRatioMax":0.009140535736955694,"steps":[{"kind":"READ","substeps":["$10:ws_sold_date_sk, $11:ws_bill_customer_sk, $12:ws_net_paid","FROM web_sales"]},{"kind":"WRITE","substeps":["$10, $11, $12","TO __stage0A_output","BY HASH($11)"]}],"writeRatioAvg":0.005458931065126317},{"readMsMax":"30","computeMsMax":"3095","waitMsAvg":"4","id":"11","endMs":"1570993377260","waitMsMax":"4","startMs":"1570993375600","waitRatioMax":0.000507807540941983,"readRatioAvg":0.0038085565570648724,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.3929160848038593,"writeMsAvg":"26","status":"COMPLETE","writeMsMax":"26","computeMsAvg":"3095","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0033007490161228894,"readMsAvg":"30","waitRatioAvg":0.000507807540941983,"completedParallelInputs":"1","computeRatioMax":0.3929160848038593,"name":"S0B: Input","shuffleOutputBytes":"102541144","recordsWritten":"2000000","readRatioMax":0.0038085565570648724,"steps":[{"kind":"READ","substeps":["$1:c_customer_sk, $2:c_customer_id, $3:c_first_name, $4:c_last_name","FROM customer"]},{"kind":"WRITE","substeps":["$1, $2, $3, $4","TO __stage0B_output","BY HASH($1)"]}],"writeRatioAvg":0.0033007490161228894},{"readMsMax":"0","computeMsMax":"838","inputStages":["3","4","5"],"waitMsAvg":"12","id":"12","endMs":"1570993377871","waitMsMax":"14","startMs":"1570993377042","waitRatioMax":0.0017773263932969405,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"72492995","computeRatioAvg":0.07325123778088105,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"30","computeMsAvg":"577","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0038085565570648724,"readMsAvg":"0","waitRatioAvg":0.001523422622825949,"completedParallelInputs":"100","computeRatioMax":0.10638567982734544,"name":"S0C: Join+","shuffleOutputBytes":"53587849","recordsWritten":"889105","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$60, $61, $62, $63","FROM __stage05_output"]},{"kind":"READ","substeps":["$70, $71, $72","FROM __stage04_output"]},{"kind":"READ","substeps":["$80, $81","FROM __stage03_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $310 := $300, $311 := $301, $312 := $302, $313 := $304","$180 := SUM($303)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $293 = $80"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH EACH ON $60 = $71"]},{"kind":"WRITE","substeps":["$310, $311, $312, $313, $180","TO __stage0C_output","BY HASH($310, $311, $312, $313)"]}],"writeRatioAvg":0.002539037704709915},{"readMsMax":"0","computeMsMax":"2711","inputStages":["6","7","8"],"waitMsAvg":"3","id":"13","endMs":"1570993378810","waitMsMax":"5","startMs":"1570993377180","waitRatioMax":0.0006347594261774788,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"271221374","computeRatioAvg":0.28614954932080744,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"22","computeMsAvg":"2254","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0027929414751809065,"readMsAvg":"0","waitRatioAvg":0.00038085565570648725,"completedParallelInputs":"100","computeRatioMax":0.34416656087342895,"name":"S0D: Join+","shuffleOutputBytes":"109216142","recordsWritten":"1812101","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$30, $31, $32, $33","FROM __stage08_output"]},{"kind":"READ","substeps":["$40, $41, $42","FROM __stage07_output"]},{"kind":"READ","substeps":["$50, $51","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $260 := $250, $261 := $251, $262 := $252, $263 := $254","$170 := SUM($253)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $243 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH EACH ON $30 = $41"]},{"kind":"WRITE","substeps":["$260, $261, $262, $263, $170","TO __stage0D_output","BY HASH($260, $261, $262, $263)"]}],"writeRatioAvg":0.0008886631966484702},{"readMsMax":"0","computeMsMax":"708","inputStages":["9","10","11"],"waitMsAvg":"16","id":"14","endMs":"1570993377945","waitMsMax":"18","startMs":"1570993377313","waitRatioMax":0.0022851339342389236,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"72493095","computeRatioAvg":0.07375904532182304,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"69","computeMsAvg":"581","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008759680081249206,"readMsAvg":"0","waitRatioAvg":0.002031230163767932,"completedParallelInputs":"100","computeRatioMax":0.089881934746731,"name":"S0E: Join+","shuffleOutputBytes":"53827538","recordsWritten":"893074","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$1, $2, $3, $4","FROM __stage0B_output"]},{"kind":"READ","substeps":["$10, $11, $12","FROM __stage0A_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage09_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $360 := $350, $361 := $351, $362 := $352, $363 := $354","$150 := SUM($353)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $343 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH EACH ON $1 = $11"]},{"kind":"WRITE","substeps":["$360, $361, $362, $363, $150","TO __stage0E_output","BY HASH($360, $361, $362, $363)"]}],"writeRatioAvg":0.002665989589945411},{"readMsMax":"0","computeMsMax":"2867","inputStages":["0","1","2"],"waitMsAvg":"104","id":"15","endMs":"1570993380401","waitMsMax":"113","startMs":"1570993378705","waitRatioMax":0.01434556303161102,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"271221274","computeRatioAvg":0.2890694426812238,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"162","computeMsAvg":"2277","shuffleOutputBytesSpilled":"0","writeRatioMax":0.020566205408150313,"readMsAvg":"0","waitRatioAvg":0.013202996064491558,"completedParallelInputs":"100","computeRatioMax":0.3639710549701663,"name":"S0F: Join+","shuffleOutputBytes":"109095944","recordsWritten":"1810046","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$90, $91, $92, $93","FROM __stage02_output"]},{"kind":"READ","substeps":["$100, $101, $102","FROM __stage01_output"]},{"kind":"READ","substeps":["$110, $111","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $220 := $210, $221 := $211, $222 := $212, $223 := $214","$190 := SUM($213)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $203 = $110"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH EACH ON $90 = $101"]},{"kind":"WRITE","substeps":["$220, $221, $222, $223, $190","TO __stage0F_output","BY HASH($220, $221, $222, $223)"]}],"writeRatioAvg":0.0012695188523549575},{"readMsMax":"0","computeMsMax":"289","inputStages":["14"],"waitMsAvg":"47","id":"16","endMs":"1570993380718","waitMsMax":"51","startMs":"1570993380527","waitRatioMax":0.006474546147010283,"readRatioAvg":0,"parallelInputs":"9","recordsRead":"893074","computeRatioAvg":0.032118826964580426,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"25","computeMsAvg":"253","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0031737971308873937,"readMsAvg":"0","waitRatioAvg":0.0059667386060683,"completedParallelInputs":"9","computeRatioMax":0.036689094833058274,"name":"S10: Aggregate","shuffleOutputBytes":"26792220","recordsWritten":"893074","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$360, $361, $362, $363, $150","FROM __stage0E_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $370 := $360, $371 := $361, $372 := $362, $373 := $363","$120 := SUM($150)"]},{"kind":"WRITE","substeps":["$120, $370","TO __stage10_output","BY HASH($370)"]}],"writeRatioAvg":0.0029198933604164022},{"readMsMax":"0","computeMsMax":"291","inputStages":["12"],"waitMsAvg":"99","id":"17","endMs":"1570993380802","waitMsMax":"104","startMs":"1570993380596","waitRatioMax":0.013202996064491558,"readRatioAvg":0,"parallelInputs":"9","recordsRead":"889105","computeRatioAvg":0.03161101942363844,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"26","computeMsAvg":"249","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0033007490161228894,"readMsAvg":"0","waitRatioAvg":0.012568236638314079,"completedParallelInputs":"9","computeRatioMax":0.03694299860352926,"name":"S11: Aggregate+","shuffleOutputBytes":"26673150","recordsWritten":"889105","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$310, $311, $312, $313, $180","FROM __stage0C_output"]},{"kind":"FILTER","substeps":["greater($140, 0)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $320 := $310, $321 := $311, $322 := $312, $323 := $313","$140 := SUM($180)"]},{"kind":"WRITE","substeps":["$140, $320","TO __stage11_output","BY HASH($320)"]}],"writeRatioAvg":0.0029198933604164022},{"readMsMax":"0","computeMsMax":"310","inputStages":["15"],"waitMsAvg":"131","id":"19","endMs":"1570993380902","waitMsMax":"142","startMs":"1570993380607","waitRatioMax":0.018027167703440396,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"1810046","computeRatioAvg":0.033261393931699884,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"28","computeMsAvg":"262","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003554652786593881,"readMsAvg":"0","waitRatioAvg":0.016630696965849942,"completedParallelInputs":"18","computeRatioMax":0.03935508442300368,"name":"S13: Aggregate+","shuffleOutputBytes":"54301380","recordsWritten":"1810046","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$220, $221, $222, $223, $190","FROM __stage0F_output"]},{"kind":"FILTER","substeps":["greater($160, 0)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $220, $231 := $221, $232 := $222, $233 := $223","$160 := SUM($190)"]},{"kind":"WRITE","substeps":["$160, $230","TO __stage13_output","BY HASH($230)"]}],"writeRatioAvg":0.001523422622825949},{"readMsMax":"0","computeMsMax":"26","inputStages":["19"],"waitMsAvg":"19","id":"20","endMs":"1570993381396","waitMsMax":"29","startMs":"1570993380925","waitRatioMax":0.0036816046718293766,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1810046","computeRatioAvg":0.0022851339342389236,"writeMsAvg":"179","status":"COMPLETE","writeMsMax":"367","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04659134188142694,"readMsAvg":"0","waitRatioAvg":0.0024120858194744193,"completedParallelInputs":"100","computeRatioMax":0.0033007490161228894,"name":"S14: Coalesce","shuffleOutputBytes":"54301380","recordsWritten":"1810046","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage13_output"]}],"writeRatioAvg":0.022724387457153737},{"readMsMax":"0","computeMsMax":"16","inputStages":["17"],"waitMsAvg":"29","id":"21","endMs":"1570993381328","waitMsMax":"31","startMs":"1570993380929","waitRatioMax":0.003935508442300368,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"889105","computeRatioAvg":0.0013964707375904533,"writeMsAvg":"146","status":"COMPLETE","writeMsMax":"202","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.025644280817570142,"readMsAvg":"0","waitRatioAvg":0.0036816046718293766,"completedParallelInputs":"100","computeRatioMax":0.002031230163767932,"name":"S15: Coalesce","shuffleOutputBytes":"26673150","recordsWritten":"889105","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage11_output"]}],"writeRatioAvg":0.018534975244382378},{"readMsMax":"0","computeMsMax":"18","inputStages":["16"],"waitMsAvg":"31","id":"22","endMs":"1570993381220","waitMsMax":"33","startMs":"1570993380928","waitRatioMax":0.0041894122127713596,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"893074","computeRatioAvg":0.0013964707375904533,"writeMsAvg":"100","status":"COMPLETE","writeMsMax":"204","computeMsAvg":"11","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02589818458804113,"readMsAvg":"0","waitRatioAvg":0.003935508442300368,"completedParallelInputs":"100","computeRatioMax":0.0022851339342389236,"name":"S16: Coalesce","shuffleOutputBytes":"26792220","recordsWritten":"893074","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage10_output"]}],"writeRatioAvg":0.012695188523549575},{"readMsMax":"0","computeMsMax":"7877","inputStages":["13","22","21","20"],"waitMsAvg":"33","id":"23","endMs":"1570993403183","waitMsMax":"34","startMs":"1570993380945","waitRatioMax":0.004316364098006856,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"66472151","computeRatioAvg":0.8168084296051796,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"6434","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007617113114129745,"readMsAvg":"0","waitRatioAvg":0.0041894122127713596,"completedParallelInputs":"18","computeRatioMax":1,"name":"S17: Join+","shuffleOutputBytes":"76055","recordsWritten":"1800","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$260, $261, $262, $263, $170","FROM __stage0D_output"]},{"kind":"READ","substeps":["$160, $230","FROM __stage14_output"]},{"kind":"READ","substeps":["$140, $320","FROM __stage15_output"]},{"kind":"READ","substeps":["$120, $370","FROM __stage16_output"]},{"kind":"SORT","substeps":["$380 ASC, $381 ASC, $382 ASC","LIMIT 100"]},{"kind":"FILTER","substeps":["greater(case_no_value(greater($384, 0), divide($386, $384), NULL), case_no_value(greater($385, 0), divide($383, $385), NULL))"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $333 = $370"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $280 = $320"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $270 = $230"]},{"kind":"AGGREGATE","substeps":["GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263","$130 := SUM($170)"]},{"kind":"WRITE","substeps":["$390, $391, $392","TO __stage17_output"]}],"writeRatioAvg":0.0006347594261774788},{"readMsMax":"0","computeMsMax":"10","inputStages":["23"],"waitMsAvg":"5","id":"24","endMs":"1570993403243","waitMsMax":"5","startMs":"1570993381003","waitRatioMax":0.0006347594261774788,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1800","computeRatioAvg":0.0012695188523549575,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007617113114129745,"readMsAvg":"0","waitRatioAvg":0.0006347594261774788,"completedParallelInputs":"1","computeRatioMax":0.0012695188523549575,"name":"S18: Output","shuffleOutputBytes":"4179","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$390, $391, $392","FROM __stage17_output"]},{"kind":"SORT","substeps":["$390 ASC, $391 ASC, $392 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$400, $401, $402","TO __stage18_output"]}],"writeRatioAvg":0.0007617113114129745}],"estimatedBytesProcessed":"8235405480","timeline":[{"totalSlotMs":"103355","activeUnits":"555","completedUnits":"7","elapsedMs":"698","pendingUnits":"553"},{"totalSlotMs":"603540","activeUnits":"116","completedUnits":"551","elapsedMs":"1706","pendingUnits":"9"},{"totalSlotMs":"841007","activeUnits":"224","completedUnits":"759","elapsedMs":"2821","pendingUnits":"101"},{"totalSlotMs":"1031800","activeUnits":"100","completedUnits":"860","elapsedMs":"4069","pendingUnits":"100"},{"totalSlotMs":"1218579","activeUnits":"100","completedUnits":"957","elapsedMs":"5134","pendingUnits":"3"},{"totalSlotMs":"1287008","activeUnits":"91","completedUnits":"1247","elapsedMs":"6173","pendingUnits":"68"},{"totalSlotMs":"1304139","activeUnits":"19","completedUnits":"1296","elapsedMs":"6668","pendingUnits":"19"},{"totalSlotMs":"1388733","activeUnits":"10","completedUnits":"1309","elapsedMs":"10866","pendingUnits":"6"},{"totalSlotMs":"1396916","activeUnits":"5","completedUnits":"1310","elapsedMs":"13707","pendingUnits":"5"},{"totalSlotMs":"1425638","activeUnits":"7","completedUnits":"1311","elapsedMs":"26737","pendingUnits":"4"},{"totalSlotMs":"1433423","activeUnits":"0","completedUnits":"1315","elapsedMs":"28240","pendingUnits":"0"},{"totalSlotMs":"1433423","activeUnits":"0","completedUnits":"1315","elapsedMs":"29484","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"8235515904","totalPartitionsProcessed":"0","totalBytesProcessed":"8235405480","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_100"}]},"endTime":"1570993404677"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query74_1570993373"},"etag":"xGN/AXTjl7Ul5Q0uqERrAg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query74_1570993373?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon24d2c44d8260b75ed4449ad7c89c495ee008ab6c","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query74\nWITH year_total \n AS (SELECT c_customer_id customer_id, \n c_first_name customer_first_name, \n c_last_name customer_last_name, \n d_year AS year1, \n Sum(ss_net_paid) year_total, \n 's' sale_type \n FROM customer, \n store_sales, \n date_dim \n WHERE c_customer_sk = ss_customer_sk \n AND ss_sold_date_sk = d_date_sk \n AND d_year IN ( 1999, 1999 + 1 ) \n GROUP BY c_customer_id, \n c_first_name, \n c_last_name, \n d_year \n UNION ALL \n SELECT c_customer_id customer_id, \n c_first_name customer_first_name, \n c_last_name customer_last_name, \n d_year AS year1, \n Sum(ws_net_paid) year_total, \n 'w' sale_type \n FROM customer, \n web_sales, \n date_dim \n WHERE c_customer_sk = ws_bill_customer_sk \n AND ws_sold_date_sk = d_date_sk \n AND d_year IN ( 1999, 1999 + 1 ) \n GROUP BY c_customer_id, \n c_first_name, \n c_last_name, \n d_year) \nSELECT t_s_secyear.customer_id, \n t_s_secyear.customer_first_name, \n t_s_secyear.customer_last_name \nFROM year_total t_s_firstyear, \n year_total t_s_secyear, \n year_total t_w_firstyear, \n year_total t_w_secyear \nWHERE t_s_secyear.customer_id = t_s_firstyear.customer_id \n AND t_s_firstyear.customer_id = t_w_secyear.customer_id \n AND t_s_firstyear.customer_id = t_w_firstyear.customer_id \n AND t_s_firstyear.sale_type = 's' \n AND t_w_firstyear.sale_type = 'w' \n AND t_s_secyear.sale_type = 's' \n AND t_w_secyear.sale_type = 'w' \n AND t_s_firstyear.year1 = 1999 \n AND t_s_secyear.year1 = 1999 + 1 \n AND t_w_firstyear.year1 = 1999 \n AND t_w_secyear.year1 = 1999 + 1 \n AND t_s_firstyear.year_total > 0 \n AND t_w_firstyear.year_total > 0 \n AND CASE \n WHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / \n t_w_firstyear.year_total \n ELSE NULL \n END > CASE \n WHEN t_s_firstyear.year_total > 0 THEN \n t_s_secyear.year_total / \n t_s_firstyear.year_total \n ELSE NULL \n END \nORDER BY 1, \n 2, \n 3\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query74_1570993373","user_email":"nithish.sankaranarayanan@ulb.be"}
