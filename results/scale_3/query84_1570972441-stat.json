{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"58769","creationTime":"1570972442357","totalBytesProcessed":"70782354","startTime":"1570972442463","query":{"totalSlotMs":"58769","queryPlan":[{"readMsMax":"163","computeMsMax":"1442","waitMsAvg":"1","id":"0","endMs":"1570972443580","waitMsMax":"1","startMs":"1570972442633","waitRatioMax":0.0006872852233676976,"readRatioAvg":0.11202749140893471,"parallelInputs":"1","recordsRead":"2878330","computeRatioAvg":0.99106529209622,"writeMsAvg":"148","status":"COMPLETE","writeMsMax":"148","computeMsAvg":"1442","shuffleOutputBytesSpilled":"0","writeRatioMax":0.10171821305841924,"readMsAvg":"163","waitRatioAvg":0.0006872852233676976,"completedParallelInputs":"1","computeRatioMax":0.99106529209622,"name":"S00: Input","shuffleOutputBytes":"24994764","recordsWritten":"2777196","readRatioMax":0.11202749140893471,"steps":[{"kind":"READ","substeps":["$1:sr_cdemo_sk","FROM store_returns"]},{"kind":"WRITE","substeps":["$1","TO __stage00_output","BY HASH($1)"]}],"writeRatioAvg":0.10171821305841924},{"readMsMax":"45","computeMsMax":"7","waitMsAvg":"27","id":"1","endMs":"1570972442736","waitMsMax":"27","startMs":"1570972442677","waitRatioMax":0.018556701030927835,"readRatioAvg":0.030927835051546393,"parallelInputs":"1","recordsRead":"20","computeRatioAvg":0.004810996563573883,"writeMsAvg":"3","status":"COMPLETE","writeMsMax":"3","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002061855670103093,"readMsAvg":"45","waitRatioAvg":0.018556701030927835,"completedParallelInputs":"1","computeRatioMax":0.004810996563573883,"name":"S01: Input","shuffleOutputBytes":"36","recordsWritten":"4","readRatioMax":0.030927835051546393,"steps":[{"kind":"READ","substeps":["$20:ib_income_band_sk, $21:ib_lower_bound, $22:ib_upper_bound","FROM income_band","WHERE and(greater_or_equal($21, 54986), less_or_equal($22, 104986))"]},{"kind":"WRITE","substeps":["$20","TO __stage01_output","BY HASH($20)"]}],"writeRatioAvg":0.002061855670103093},{"readMsMax":"25","computeMsMax":"12","waitMsAvg":"55","id":"2","endMs":"1570972442774","waitMsMax":"55","startMs":"1570972442720","waitRatioMax":0.037800687285223365,"readRatioAvg":0.01718213058419244,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.008247422680412371,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"12","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004123711340206186,"readMsAvg":"25","waitRatioAvg":0.037800687285223365,"completedParallelInputs":"1","computeRatioMax":0.008247422680412371,"name":"S02: Input","shuffleOutputBytes":"129600","recordsWritten":"7200","readRatioMax":0.01718213058419244,"steps":[{"kind":"READ","substeps":["$10:hd_demo_sk, $11:hd_income_band_sk","FROM household_demographics"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage02_output","BY HASH($10)"]}],"writeRatioAvg":0.004123711340206186},{"readMsMax":"17","computeMsMax":"14","waitMsAvg":"61","id":"4","endMs":"1570972442816","waitMsMax":"61","startMs":"1570972442765","waitRatioMax":0.04192439862542955,"readRatioAvg":0.01168384879725086,"parallelInputs":"1","recordsRead":"250000","computeRatioAvg":0.009621993127147767,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"7","computeMsAvg":"14","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004810996563573883,"readMsAvg":"17","waitRatioAvg":0.04192439862542955,"completedParallelInputs":"1","computeRatioMax":0.009621993127147767,"name":"S04: Input","shuffleOutputBytes":"18495","recordsWritten":"2055","readRatioMax":0.01168384879725086,"steps":[{"kind":"READ","substeps":["$50:ca_address_sk, $51:ca_city","FROM customer_address","WHERE equal($51, 'Green Acres')"]},{"kind":"WRITE","substeps":["$50","TO __stage04_output","BY HASH($50)"]}],"writeRatioAvg":0.004810996563573883},{"readMsMax":"45","computeMsMax":"292","inputStages":["4"],"waitMsAvg":"1","id":"6","endMs":"1570972443113","waitMsMax":"1","startMs":"1570972442907","waitRatioMax":0.0006872852233676976,"readRatioAvg":0.030927835051546393,"parallelInputs":"1","recordsRead":"502055","computeRatioAvg":0.2006872852233677,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"292","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0027491408934707906,"readMsAvg":"45","waitRatioAvg":0.0006872852233676976,"completedParallelInputs":"1","computeRatioMax":0.2006872852233677,"name":"S06: Join","shuffleOutputBytes":"242282","recordsWritten":"4005","readRatioMax":0.030927835051546393,"steps":[{"kind":"READ","substeps":["$40:c_customer_id, $41:c_current_cdemo_sk, $42:c_current_hdemo_sk, $43:c_current_addr_sk, $44:c_first_name, $45:c_last_name","FROM customer"]},{"kind":"READ","substeps":["$50","FROM __stage04_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $43 = $50"]},{"kind":"WRITE","substeps":["$70, $71, $72, $73, $74","TO __stage06_output","BY HASH($71)"]}],"writeRatioAvg":0.0027491408934707906},{"readMsMax":"0","computeMsMax":"11","inputStages":["6"],"waitMsAvg":"3","id":"7","endMs":"1570972443379","waitMsMax":"7","startMs":"1570972443154","waitRatioMax":0.004810996563573883,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"4005","computeRatioAvg":0.003436426116838488,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01443298969072165,"readMsAvg":"0","waitRatioAvg":0.002061855670103093,"completedParallelInputs":"100","computeRatioMax":0.007560137457044674,"name":"S07: Coalesce","shuffleOutputBytes":"242282","recordsWritten":"4005","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage06_output"]}],"writeRatioAvg":0.010996563573883162},{"readMsMax":"0","computeMsMax":"25","inputStages":["0"],"waitMsAvg":"1","id":"9","endMs":"1570972444051","waitMsMax":"4","startMs":"1570972443759","waitRatioMax":0.0027491408934707906,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2777196","computeRatioAvg":0.012371134020618556,"writeMsAvg":"92","status":"COMPLETE","writeMsMax":"121","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0831615120274914,"readMsAvg":"0","waitRatioAvg":0.0006872852233676976,"completedParallelInputs":"100","computeRatioMax":0.01718213058419244,"name":"S09: Coalesce","shuffleOutputBytes":"24994764","recordsWritten":"2777196","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage00_output"]}],"writeRatioAvg":0.06323024054982818},{"readMsMax":"17","computeMsMax":"1455","inputStages":["9","1","2","7"],"waitMsAvg":"5","id":"10","endMs":"1570972444753","waitMsMax":"5","startMs":"1570972443764","waitRatioMax":0.003436426116838488,"readRatioAvg":0.01168384879725086,"parallelInputs":"1","recordsRead":"4709205","computeRatioAvg":1,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"1455","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003436426116838488,"readMsAvg":"17","waitRatioAvg":0.003436426116838488,"completedParallelInputs":"1","computeRatioMax":1,"name":"S0A: Join+","shuffleOutputBytes":"4034","recordsWritten":"100","readRatioMax":0.01168384879725086,"steps":[{"kind":"READ","substeps":["$30:cd_demo_sk","FROM customer_demographics"]},{"kind":"READ","substeps":["$70, $71, $72, $73, $74","FROM __stage07_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage02_output"]},{"kind":"READ","substeps":["$20","FROM __stage01_output"]},{"kind":"READ","substeps":["$1","FROM __stage09_output"]},{"kind":"COMPUTE","substeps":["$60 := concat($122, concat(', ', $121))"]},{"kind":"SORT","substeps":["$110 ASC","LIMIT 100"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $100 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $94 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $81 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $30 = $71"]},{"kind":"WRITE","substeps":["$120, $60","TO __stage0A_output"]}],"writeRatioAvg":0.003436426116838488},{"readMsMax":"0","computeMsMax":"5","inputStages":["10"],"waitMsAvg":"1","id":"11","endMs":"1570972444918","waitMsMax":"1","startMs":"1570972443864","waitRatioMax":0.0006872852233676976,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.003436426116838488,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004123711340206186,"readMsAvg":"0","waitRatioAvg":0.0006872852233676976,"completedParallelInputs":"1","computeRatioMax":0.003436426116838488,"name":"S0B: Output","shuffleOutputBytes":"4034","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$120, $60","FROM __stage0A_output"]},{"kind":"SORT","substeps":["$120 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$130, $131","TO __stage0B_output"]}],"writeRatioAvg":0.004123711340206186}],"estimatedBytesProcessed":"70782354","timeline":[{"totalSlotMs":"1152","activeUnits":"2","completedUnits":"4","elapsedMs":"671","pendingUnits":"2"},{"totalSlotMs":"55543","activeUnits":"2","completedUnits":"205","elapsedMs":"1797","pendingUnits":"2"},{"totalSlotMs":"58769","activeUnits":"2","completedUnits":"207","elapsedMs":"2757","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"71303168","totalPartitionsProcessed":"0","totalBytesProcessed":"70782354","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"income_band","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"customer_demographics","datasetId":"scale_10"}]},"endTime":"1570972445240"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query84_1570972441"},"etag":"reicKh5/5QejZi8IQjkEOw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query84_1570972441?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon4c54a8c7d63179078c7e51100f629abeb7514de2","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query84\nSELECT c_customer_id AS customer_id, \n Concat(c_last_name, Concat(', ', c_first_name)) AS customername \nFROM customer, \n customer_address, \n customer_demographics, \n household_demographics, \n income_band, \n store_returns \nWHERE ca_city = 'Green Acres' \n AND c_current_addr_sk = ca_address_sk \n AND ib_lower_bound >= 54986 \n AND ib_upper_bound <= 54986 + 50000 \n AND ib_income_band_sk = hd_income_band_sk \n AND cd_demo_sk = c_current_cdemo_sk \n AND hd_demo_sk = c_current_hdemo_sk \n AND sr_cdemo_sk = cd_demo_sk \nORDER BY c_customer_id\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query84_1570972441","user_email":"nithish.sankaranarayanan@ulb.be"}
