{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"547736","creationTime":"1570992587135","totalBytesProcessed":"12622206316","startTime":"1570992587279","query":{"totalSlotMs":"547736","queryPlan":[{"readMsMax":"13","computeMsMax":"9","waitMsAvg":"1","id":"0","endMs":"1570992587503","waitMsMax":"1","startMs":"1570992587411","waitRatioMax":0.00013114754098360657,"readRatioAvg":0.0017049180327868853,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.001180327868852459,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"21","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002754098360655738,"readMsAvg":"13","waitRatioAvg":0.00013114754098360657,"completedParallelInputs":"1","computeRatioMax":0.001180327868852459,"name":"S00: Input","shuffleOutputBytes":"504","recordsWritten":"28","readRatioMax":0.0017049180327868853,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $32:d_moy, $31:d_year","FROM date_dim","WHERE and(equal($31, 2002), equal($32, 2))"]},{"kind":"WRITE","substeps":["$30, $32","TO __stage00_output","BY HASH($30)"]}],"writeRatioAvg":0.002754098360655738},{"readMsMax":"20","computeMsMax":"7","waitMsAvg":"10","id":"1","endMs":"1570992587530","waitMsMax":"10","startMs":"1570992587443","waitRatioMax":0.0013114754098360656,"readRatioAvg":0.002622950819672131,"parallelInputs":"1","recordsRead":"15","computeRatioAvg":0.0009180327868852459,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0007868852459016393,"readMsAvg":"20","waitRatioAvg":0.0013114754098360656,"completedParallelInputs":"1","computeRatioMax":0.0009180327868852459,"name":"S01: Input","shuffleOutputBytes":"440","recordsWritten":"15","readRatioMax":0.002622950819672131,"steps":[{"kind":"READ","substeps":["$20:w_warehouse_sk, $21:w_warehouse_name","FROM warehouse"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage01_output","BY HASH($20)"]}],"writeRatioAvg":0.0007868852459016393},{"readMsMax":"10","computeMsMax":"103","waitMsAvg":"37","id":"2","endMs":"1570992587592","waitMsMax":"37","startMs":"1570992587486","waitRatioMax":0.004852459016393443,"readRatioAvg":0.0013114754098360656,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.013508196721311476,"writeMsAvg":"37","status":"COMPLETE","writeMsMax":"37","computeMsAvg":"103","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004852459016393443,"readMsAvg":"10","waitRatioAvg":0.004852459016393443,"completedParallelInputs":"1","computeRatioMax":0.013508196721311476,"name":"S02: Input","shuffleOutputBytes":"1836000","recordsWritten":"204000","readRatioMax":0.0013114754098360656,"steps":[{"kind":"READ","substeps":["$70:i_item_sk","FROM item"]},{"kind":"WRITE","substeps":["$70","TO __stage02_output","BY HASH($70)"]}],"writeRatioAvg":0.004852459016393443},{"readMsMax":"15","computeMsMax":"10","waitMsAvg":"46","id":"4","endMs":"1570992587725","waitMsMax":"46","startMs":"1570992587531","waitRatioMax":0.006032786885245902,"readRatioAvg":0.0019672131147540984,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0013114754098360656,"writeMsAvg":"23","status":"COMPLETE","writeMsMax":"23","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003016393442622951,"readMsAvg":"15","waitRatioAvg":0.006032786885245902,"completedParallelInputs":"1","computeRatioMax":0.0013114754098360656,"name":"S04: Input","shuffleOutputBytes":"558","recordsWritten":"31","readRatioMax":0.0019672131147540984,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $12:d_moy, $11:d_year","FROM date_dim","WHERE and(equal($11, 2002), equal($12, 1))"]},{"kind":"WRITE","substeps":["$10, $12","TO __stage04_output","BY HASH($10)"]}],"writeRatioAvg":0.003016393442622951},{"readMsMax":"8","computeMsMax":"6","waitMsAvg":"24","id":"5","endMs":"1570992587735","waitMsMax":"24","startMs":"1570992587529","waitRatioMax":0.003147540983606557,"readRatioAvg":0.0010491803278688525,"parallelInputs":"1","recordsRead":"15","computeRatioAvg":0.0007868852459016393,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"29","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00380327868852459,"readMsAvg":"8","waitRatioAvg":0.003147540983606557,"completedParallelInputs":"1","computeRatioMax":0.0007868852459016393,"name":"S05: Input","shuffleOutputBytes":"440","recordsWritten":"15","readRatioMax":0.0010491803278688525,"steps":[{"kind":"READ","substeps":["$1:w_warehouse_sk, $2:w_warehouse_name","FROM warehouse"]},{"kind":"WRITE","substeps":["$1, $2","TO __stage05_output","BY HASH($1)"]}],"writeRatioAvg":0.00380327868852459},{"readMsMax":"7","computeMsMax":"116","waitMsAvg":"3","id":"6","endMs":"1570992587758","waitMsMax":"3","startMs":"1570992587530","waitRatioMax":0.00039344262295081965,"readRatioAvg":0.0009180327868852459,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.01521311475409836,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"116","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0022295081967213114,"readMsAvg":"7","waitRatioAvg":0.00039344262295081965,"completedParallelInputs":"1","computeRatioMax":0.01521311475409836,"name":"S06: Input","shuffleOutputBytes":"1836000","recordsWritten":"204000","readRatioMax":0.0009180327868852459,"steps":[{"kind":"READ","substeps":["$50:i_item_sk","FROM item"]},{"kind":"WRITE","substeps":["$50","TO __stage06_output","BY HASH($50)"]}],"writeRatioAvg":0.0022295081967213114},{"readMsMax":"52","computeMsMax":"7377","inputStages":["0","1","2"],"waitMsAvg":"1","id":"8","endMs":"1570992591794","waitMsMax":"3","startMs":"1570992587661","waitRatioMax":0.00039344262295081965,"readRatioAvg":0.003934426229508197,"parallelInputs":"40","recordsRead":"407491720","computeRatioAvg":0.7836065573770492,"writeMsAvg":"27","status":"COMPLETE","writeMsMax":"162","computeMsAvg":"5975","shuffleOutputBytesSpilled":"0","writeRatioMax":0.021245901639344263,"readMsAvg":"30","waitRatioAvg":0.00013114754098360657,"completedParallelInputs":"40","computeRatioMax":0.9674754098360656,"name":"S08: Join+","shuffleOutputBytes":"509614382","recordsWritten":"5894683","readRatioMax":0.006819672131147541,"steps":[{"kind":"READ","substeps":["$60:inv_date_sk, $61:inv_item_sk, $62:inv_warehouse_sk, $63:inv_quantity_on_hand","FROM inventory"]},{"kind":"READ","substeps":["$70","FROM __stage02_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage01_output"]},{"kind":"READ","substeps":["$30, $32","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $260 := $251, $261 := $250, $262 := $253, $263 := $254","$130 := VAR_POP($150)","$131 := SHARD_AVG($252)"]},{"kind":"COMPUTE","substeps":["$150 := CAST($252 AS DOUBLE)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $230 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $221 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $61 = $70"]},{"kind":"WRITE","substeps":["$261, $260, $263, $262, $130, $131","TO __stage08_output","BY HASH($260, $261, $262, $263)"]}],"writeRatioAvg":0.003540983606557377},{"readMsMax":"75","computeMsMax":"7625","inputStages":["4","5","6"],"waitMsAvg":"2","id":"9","endMs":"1570992591932","waitMsMax":"4","startMs":"1570992587818","waitRatioMax":0.0005245901639344263,"readRatioAvg":0.00419672131147541,"parallelInputs":"40","recordsRead":"407491840","computeRatioAvg":0.7628852459016393,"writeMsAvg":"16","status":"COMPLETE","writeMsMax":"123","computeMsAvg":"5817","shuffleOutputBytesSpilled":"0","writeRatioMax":0.016131147540983607,"readMsAvg":"32","waitRatioAvg":0.00026229508196721314,"completedParallelInputs":"40","computeRatioMax":1,"name":"S09: Join+","shuffleOutputBytes":"629254983","recordsWritten":"7276240","readRatioMax":0.009836065573770493,"steps":[{"kind":"READ","substeps":["$40:inv_date_sk, $41:inv_item_sk, $42:inv_warehouse_sk, $43:inv_quantity_on_hand","FROM inventory"]},{"kind":"READ","substeps":["$50","FROM __stage06_output"]},{"kind":"READ","substeps":["$1, $2","FROM __stage05_output"]},{"kind":"READ","substeps":["$10, $12","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $200 := $191, $201 := $190, $202 := $193, $203 := $194","$120 := VAR_POP($140)","$121 := SHARD_AVG($192)"]},{"kind":"COMPUTE","substeps":["$140 := CAST($192 AS DOUBLE)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $170 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $161 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $41 = $50"]},{"kind":"WRITE","substeps":["$201, $200, $203, $202, $120, $121","TO __stage09_output","BY HASH($200, $201, $202, $203)"]}],"writeRatioAvg":0.002098360655737705},{"readMsMax":"0","computeMsMax":"1633","inputStages":["9"],"waitMsAvg":"1","id":"10","endMs":"1570992592340","waitMsMax":"1","startMs":"1570992591064","waitRatioMax":0.00013114754098360657,"readRatioAvg":0,"parallelInputs":"2","recordsRead":"2418980","computeRatioAvg":0.21101639344262296,"writeMsAvg":"201","status":"COMPLETE","writeMsMax":"394","computeMsAvg":"1609","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05167213114754098,"readMsAvg":"0","waitRatioAvg":0.00013114754098360657,"completedParallelInputs":"2","computeRatioMax":0.2141639344262295,"name":"S0A: Repartition","shuffleOutputBytes":"209698465","recordsWritten":"2418980","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage09_output"]}],"writeRatioAvg":0.026360655737704918},{"readMsMax":"0","computeMsMax":"1667","inputStages":["8"],"waitMsAvg":"1","id":"11","endMs":"1570992592029","waitMsMax":"1","startMs":"1570992591137","waitRatioMax":0.00013114754098360657,"readRatioAvg":0,"parallelInputs":"2","recordsRead":"2354002","computeRatioAvg":0.21560655737704917,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"15","computeMsAvg":"1644","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0019672131147540984,"readMsAvg":"0","waitRatioAvg":0.00013114754098360657,"completedParallelInputs":"2","computeRatioMax":0.21862295081967212,"name":"S0B: Repartition","shuffleOutputBytes":"203864786","recordsWritten":"2354002","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage08_output"]}],"writeRatioAvg":0.0013114754098360656},{"readMsMax":"0","computeMsMax":"2027","inputStages":["10","9"],"waitMsAvg":"1","id":"12","endMs":"1570992592409","waitMsMax":"1","startMs":"1570992591287","waitRatioMax":0.00013114754098360657,"readRatioAvg":0,"parallelInputs":"2","recordsRead":"2858627","computeRatioAvg":0.2586229508196721,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"11","computeMsAvg":"1972","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001442622950819672,"readMsAvg":"0","waitRatioAvg":0.00013114754098360657,"completedParallelInputs":"2","computeRatioMax":0.2658360655737705,"name":"S0C: Repartition","shuffleOutputBytes":"247675022","recordsWritten":"2858627","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0A_output"]}],"writeRatioAvg":0.0013114754098360656},{"readMsMax":"0","computeMsMax":"2343","inputStages":["11","8"],"waitMsAvg":"1","id":"13","endMs":"1570992592588","waitMsMax":"1","startMs":"1570992591331","waitRatioMax":0.00013114754098360657,"readRatioAvg":0,"parallelInputs":"2","recordsRead":"2612997","computeRatioAvg":0.260327868852459,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"1985","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002360655737704918,"readMsAvg":"0","waitRatioAvg":0.00013114754098360657,"completedParallelInputs":"2","computeRatioMax":0.30727868852459017,"name":"S0D: Repartition","shuffleOutputBytes":"226015951","recordsWritten":"2612997","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0B_output"]}],"writeRatioAvg":0.002360655737704918},{"readMsMax":"0","computeMsMax":"411","inputStages":["13","8"],"waitMsAvg":"1","id":"14","endMs":"1570992592990","waitMsMax":"2","startMs":"1570992592622","waitRatioMax":0.00026229508196721314,"readRatioAvg":0,"parallelInputs":"40","recordsRead":"5894683","computeRatioAvg":0.04065573770491803,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"310","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0024918032786885244,"readMsAvg":"0","waitRatioAvg":0.00013114754098360657,"completedParallelInputs":"40","computeRatioMax":0.053901639344262293,"name":"S0E: Aggregate+","shuffleOutputBytes":"4788765","recordsWritten":"106417","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$261, $260, $263, $262, $130, $131","FROM __stage08_output"]},{"kind":"COMPUTE","substeps":["$90 := case_with_value($111, 0, NULL, divide($110, $111))"]},{"kind":"FILTER","substeps":["greater(case_with_value($111, 0, 0, divide($110, $111)), 1)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $270 := $260, $271 := $261, $272 := $262, $273 := $263","$110 := ROOT_STDDEV_SAMP($130)","$111 := ROOT_AVG($131)"]},{"kind":"WRITE","substeps":["$90, $111, $271, $272, $273","TO __stage0E_output","BY HASH($272, $271)"]}],"writeRatioAvg":0.0009180327868852459},{"readMsMax":"0","computeMsMax":"10","inputStages":["14"],"waitMsAvg":"3","id":"16","endMs":"1570992593309","waitMsMax":"8","startMs":"1570992593007","waitRatioMax":0.0010491803278688525,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"106417","computeRatioAvg":0.0006557377049180328,"writeMsAvg":"172","status":"COMPLETE","writeMsMax":"212","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02780327868852459,"readMsAvg":"0","waitRatioAvg":0.00039344262295081965,"completedParallelInputs":"100","computeRatioMax":0.0013114754098360656,"name":"S10: Coalesce","shuffleOutputBytes":"4788765","recordsWritten":"106417","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0E_output"]}],"writeRatioAvg":0.022557377049180326},{"readMsMax":"0","computeMsMax":"600","inputStages":["12","9","16"],"waitMsAvg":"3","id":"17","endMs":"1570992593755","waitMsMax":"5","startMs":"1570992593089","waitRatioMax":0.0006557377049180328,"readRatioAvg":0,"parallelInputs":"40","recordsRead":"11532920","computeRatioAvg":0.06137704918032787,"writeMsAvg":"13","status":"COMPLETE","writeMsMax":"169","computeMsAvg":"468","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02216393442622951,"readMsAvg":"0","waitRatioAvg":0.00039344262295081965,"completedParallelInputs":"40","computeRatioMax":0.07868852459016394,"name":"S11: Join+","shuffleOutputBytes":"466920","recordsWritten":"5188","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$201, $200, $203, $202, $120, $121","FROM __stage09_output"]},{"kind":"READ","substeps":["$90, $111, $271, $272, $273","FROM __stage10_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $212 = $272, $211 = $271"]},{"kind":"COMPUTE","substeps":["$80 := case_with_value($101, 0, NULL, divide($100, $101))"]},{"kind":"FILTER","substeps":["greater(case_with_value($101, 0, 0, divide($100, $101)), 1)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $210 := $200, $211 := $201, $212 := $202, $213 := $203","$100 := ROOT_STDDEV_SAMP($120)","$101 := ROOT_AVG($121)"]},{"kind":"WRITE","substeps":["$280, $281, $285, $286, $282, $287, $283, $288, $284, $289","TO __stage11_output"]}],"writeRatioAvg":0.0017049180327868853},{"readMsMax":"0","computeMsMax":"23","inputStages":["17"],"waitMsAvg":"1","id":"18","endMs":"1570992593831","waitMsMax":"1","startMs":"1570992593758","waitRatioMax":0.00013114754098360657,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"5188","computeRatioAvg":0.003016393442622951,"writeMsAvg":"41","status":"COMPLETE","writeMsMax":"41","computeMsAvg":"23","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005377049180327869,"readMsAvg":"0","waitRatioAvg":0.00013114754098360657,"completedParallelInputs":"1","computeRatioMax":0.003016393442622951,"name":"S12: Output","shuffleOutputBytes":"466920","recordsWritten":"5188","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$280, $281, $285, $286, $282, $287, $283, $288, $284, $289","FROM __stage11_output"]},{"kind":"SORT","substeps":["$280 ASC, $282 ASC, $281 ASC, $284 ASC, $283 ASC, $286 ASC, $289 ASC, $288 ASC"]},{"kind":"WRITE","substeps":["$290, $291, $292, $293, $294, $295, $296, $297, $298, $299","TO __stage12_output"]}],"writeRatioAvg":0.005377049180327869}],"estimatedBytesProcessed":"12622206316","timeline":[{"totalSlotMs":"9677","activeUnits":"80","completedUnits":"6","elapsedMs":"633","pendingUnits":"80"},{"totalSlotMs":"119264","activeUnits":"81","completedUnits":"6","elapsedMs":"1545","pendingUnits":"80"},{"totalSlotMs":"415699","activeUnits":"74","completedUnits":"45","elapsedMs":"3682","pendingUnits":"41"},{"totalSlotMs":"465441","activeUnits":"24","completedUnits":"86","elapsedMs":"4688","pendingUnits":"8"},{"totalSlotMs":"503657","activeUnits":"140","completedUnits":"134","elapsedMs":"5818","pendingUnits":"140"},{"totalSlotMs":"547736","activeUnits":"2","completedUnits":"275","elapsedMs":"6840","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"12622757888","totalPartitionsProcessed":"0","totalBytesProcessed":"12622206316","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"inventory","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"warehouse","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_100"}]},"endTime":"1570992594164"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query39_1570992584"},"etag":"1pSsiOTdf/NNnrIuF95fKw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query39_1570992584?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon94f7dc0f357f26693cfc5dfd227ee2f5623a134b","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query39\nWITH inv \n AS (SELECT w_warehouse_name, \n w_warehouse_sk, \n i_item_sk, \n d_moy, \n stdev, \n mean, \n CASE mean \n WHEN 0 THEN NULL \n ELSE stdev / mean \n END cov \n FROM (SELECT w_warehouse_name, \n w_warehouse_sk, \n i_item_sk, \n d_moy, \n Stddev_samp(inv_quantity_on_hand) stdev, \n Avg(inv_quantity_on_hand) mean \n FROM inventory, \n item, \n warehouse, \n date_dim \n WHERE inv_item_sk = i_item_sk \n AND inv_warehouse_sk = w_warehouse_sk \n AND inv_date_sk = d_date_sk \n AND d_year = 2002 \n GROUP BY w_warehouse_name, \n w_warehouse_sk, \n i_item_sk, \n d_moy) foo \n WHERE CASE mean \n WHEN 0 THEN 0 \n ELSE stdev / mean \n END > 1) \nSELECT inv1.w_warehouse_sk, \n inv1.i_item_sk, \n inv1.d_moy, \n inv1.mean, \n inv1.cov, \n inv2.w_warehouse_sk AS w_warehouse_sk_2, \n inv2.i_item_sk AS i_item_sk_2, \n inv2.d_moy AS d_moy_2, \n inv2.mean AS mean_2, \n inv2.cov AS cov_2 \nFROM inv inv1, \n inv inv2 \nWHERE inv1.i_item_sk = inv2.i_item_sk \n AND inv1.w_warehouse_sk = inv2.w_warehouse_sk \n AND inv1.d_moy = 1 \n AND inv2.d_moy = 1 + 1 \nORDER BY inv1.w_warehouse_sk, \n inv1.i_item_sk, \n inv1.d_moy, \n inv1.mean, \n inv1.cov, \n inv2.d_moy, \n inv2.mean, \n inv2.cov; "},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query39_1570992584","user_email":"nithish.sankaranarayanan@ulb.be"}
