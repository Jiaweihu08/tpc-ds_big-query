{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"161426","creationTime":"1570971926685","totalBytesProcessed":"1213220104","startTime":"1570971926841","query":{"totalSlotMs":"161426","queryPlan":[{"readMsMax":"11","computeMsMax":"9","waitMsAvg":"36","id":"0","endMs":"1570971927282","waitMsMax":"36","startMs":"1570971927100","waitRatioMax":0.004726270185112249,"readRatioAvg":0.0014441381121176316,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0011815675462780622,"writeMsAvg":"8","status":"COMPLETE","writeMsMax":"8","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0010502822633582775,"readMsAvg":"11","waitRatioAvg":0.004726270185112249,"completedParallelInputs":"1","computeRatioMax":0.0011815675462780622,"name":"S00: Input","shuffleOutputBytes":"270","recordsWritten":"30","readRatioMax":0.0014441381121176316,"steps":[{"kind":"READ","substeps":["$10:d_date_sk, $11:d_year, $12:d_moy","FROM date_dim","WHERE and(equal($11, 2002), equal($12, 9))"]},{"kind":"WRITE","substeps":["$10","TO __stage00_output","BY HASH($10)"]}],"writeRatioAvg":0.0010502822633582775},{"readMsMax":"10","computeMsMax":"45","waitMsAvg":"41","id":"1","endMs":"1570971927255","waitMsMax":"41","startMs":"1570971927120","waitRatioMax":0.005382696599711172,"readRatioAvg":0.0013128528291978469,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.005907837731390311,"writeMsAvg":"84","status":"COMPLETE","writeMsMax":"84","computeMsAvg":"45","shuffleOutputBytesSpilled":"0","writeRatioMax":0.011027963765261915,"readMsAvg":"10","waitRatioAvg":0.005382696599711172,"completedParallelInputs":"1","computeRatioMax":0.005907837731390311,"name":"S01: Input","shuffleOutputBytes":"657441","recordsWritten":"73049","readRatioMax":0.0013128528291978469,"steps":[{"kind":"READ","substeps":["$1:d_date_sk","FROM date_dim"]},{"kind":"WRITE","substeps":["$1","TO __stage01_output","BY HASH($1)"]}],"writeRatioAvg":0.011027963765261915},{"readMsMax":"34","computeMsMax":"6","waitMsAvg":"35","id":"2","endMs":"1570971927298","waitMsMax":"35","startMs":"1570971927129","waitRatioMax":0.004594984902192464,"readRatioAvg":0.00446369961927268,"parallelInputs":"1","recordsRead":"102","computeRatioAvg":0.0007877116975187081,"writeMsAvg":"72","status":"COMPLETE","writeMsMax":"72","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009452540370224497,"readMsAvg":"34","waitRatioAvg":0.004594984902192464,"completedParallelInputs":"1","computeRatioMax":0.0007877116975187081,"name":"S02: Input","shuffleOutputBytes":"12358","recordsWritten":"102","readRatioMax":0.00446369961927268,"steps":[{"kind":"READ","substeps":["$20:s_store_sk, $21:s_store_name, $22:s_company_id, $23:s_street_number, $24:s_street_name, $25:s_street_type, $26:s_suite_number, $27:s_city, $28:s_county, $29:s_state, $30:s_zip","FROM store"]},{"kind":"WRITE","substeps":["$20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.009452540370224497},{"readMsMax":"45","computeMsMax":"4672","waitMsAvg":"36","id":"3","endMs":"1570971929706","waitMsMax":"36","startMs":"1570971927148","waitRatioMax":0.004726270185112249,"readRatioAvg":0.005907837731390311,"parallelInputs":"1","recordsRead":"2878330","computeRatioAvg":0.6133648418012341,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"19","computeMsAvg":"4672","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0024944203754759093,"readMsAvg":"45","waitRatioAvg":0.004726270185112249,"completedParallelInputs":"1","computeRatioMax":0.6133648418012341,"name":"S03: Input","shuffleOutputBytes":"99566252","recordsWritten":"2776885","readRatioMax":0.005907837731390311,"steps":[{"kind":"READ","substeps":["$50:sr_returned_date_sk, $51:sr_item_sk, $52:sr_customer_sk, $53:sr_ticket_number","FROM store_returns"]},{"kind":"WRITE","substeps":["$50, $51, $52, $53","TO __stage03_output","BY HASH($53, $51, $52)"]}],"writeRatioAvg":0.0024944203754759093},{"readMsMax":"0","computeMsMax":"38","inputStages":["3"],"waitMsAvg":"6","id":"5","endMs":"1570971930624","waitMsMax":"14","startMs":"1570971929795","waitRatioMax":0.0018379939608769856,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2776885","computeRatioAvg":0.003807273204673756,"writeMsAvg":"150","status":"COMPLETE","writeMsMax":"312","computeMsAvg":"29","shuffleOutputBytesSpilled":"0","writeRatioMax":0.04096100827097282,"readMsAvg":"0","waitRatioAvg":0.0007877116975187081,"completedParallelInputs":"100","computeRatioMax":0.0049888407509518186,"name":"S05: Coalesce","shuffleOutputBytes":"99566252","recordsWritten":"2776885","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage03_output"]}],"writeRatioAvg":0.019692792437967704},{"readMsMax":"46","computeMsMax":"7617","inputStages":["0","1","2","5"],"waitMsAvg":"2","id":"6","endMs":"1570971934208","waitMsMax":"3","startMs":"1570971929893","waitRatioMax":0.00039385584875935406,"readRatioAvg":0.004726270185112249,"parallelInputs":"10","recordsRead":"57302772","computeRatioAvg":0.8856505185768675,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"9","computeMsAvg":"6746","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0011815675462780622,"readMsAvg":"36","waitRatioAvg":0.0002625705658395694,"completedParallelInputs":"10","computeRatioMax":1,"name":"S06: Join+","shuffleOutputBytes":"80270","recordsWritten":"510","readRatioMax":0.006039123014310096,"steps":[{"kind":"READ","substeps":["$40:ss_sold_date_sk, $41:ss_item_sk, $42:ss_customer_sk, $43:ss_store_sk, $44:ss_ticket_number","FROM store_sales"]},{"kind":"READ","substeps":["$50, $51, $52, $53","FROM __stage05_output"]},{"kind":"READ","substeps":["$20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30","FROM __stage02_output"]},{"kind":"READ","substeps":["$1","FROM __stage01_output"]},{"kind":"READ","substeps":["$10","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $160 := $140, $161 := $141, $162 := $142, $163 := $143, $164 := $144, $165 := $145, $166 := $146, $167 := $147, $168 := $148, $169 := $149","$70 := SUM($84)","$71 := SUM($83)","$72 := SUM($82)","$73 := SUM($81)","$74 := SUM($80)"]},{"kind":"COMPUTE","substeps":["$80 := case_no_value(greater(subtract($151, $150), 120), 1, 0)","$81 := case_no_value(and(greater(subtract($151, $150), 90), less_or_equal(subtract($151, $150), 120)), 1, 0)","$82 := case_no_value(and(greater(subtract($151, $150), 60), less_or_equal(subtract($151, $150), 90)), 1, 0)","$83 := case_no_value(and(greater(subtract($151, $150), 30), less_or_equal(subtract($151, $150), 60)), 1, 0)","$84 := case_no_value(less_or_equal(subtract($151, $150), 30), 1, 0)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $131 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $100 = $1"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $91 = $20"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $44 = $53, $41 = $51, $42 = $52"]},{"kind":"WRITE","substeps":["$160, $161, $162, $163, $164, $165, $166, $167, $168, $169, $70, $71, $72, $73, $74","TO __stage06_output","BY HASH($160, $161, $162, $163, $164, $165, $166, $167, $168, $169)"]}],"writeRatioAvg":0.0006564264145989234},{"readMsMax":"0","computeMsMax":"6","inputStages":["6"],"waitMsAvg":"2","id":"7","endMs":"1570971934487","waitMsMax":"2","startMs":"1570971934319","waitRatioMax":0.0002625705658395694,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"510","computeRatioAvg":0.0007877116975187081,"writeMsAvg":"145","status":"COMPLETE","writeMsMax":"145","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01903636602336878,"readMsAvg":"0","waitRatioAvg":0.0002625705658395694,"completedParallelInputs":"1","computeRatioMax":0.0007877116975187081,"name":"S07: Sort+","shuffleOutputBytes":"8027","recordsWritten":"51","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$160, $161, $162, $163, $164, $165, $166, $167, $168, $169, $70, $71, $72, $73, $74","FROM __stage06_output"]},{"kind":"SORT","substeps":["$170 ASC, $171 ASC, $172 ASC, $173 ASC, $174 ASC, $175 ASC, $176 ASC, $177 ASC, $178 ASC, $179 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $170 := $160, $171 := $161, $172 := $162, $173 := $163, $174 := $164, $175 := $165, $176 := $166, $177 := $167, $178 := $168, $179 := $169","$60 := SUM($70)","$61 := SUM($71)","$62 := SUM($72)","$63 := SUM($73)","$64 := SUM($74)"]},{"kind":"WRITE","substeps":["$180, $181, $182, $183, $184, $185, $186, $187, $188, $189, $190, $191, $192, $193, $194","TO __stage07_output"]}],"writeRatioAvg":0.01903636602336878},{"readMsMax":"0","computeMsMax":"7","inputStages":["7"],"waitMsAvg":"20","id":"8","endMs":"1570971934573","waitMsMax":"20","startMs":"1570971934379","waitRatioMax":0.0026257056583956937,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"51","computeRatioAvg":0.0009189969804384928,"writeMsAvg":"12","status":"COMPLETE","writeMsMax":"12","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0015754233950374162,"readMsAvg":"0","waitRatioAvg":0.0026257056583956937,"completedParallelInputs":"1","computeRatioMax":0.0009189969804384928,"name":"S08: Output","shuffleOutputBytes":"8027","recordsWritten":"51","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$180, $181, $182, $183, $184, $185, $186, $187, $188, $189, $190, $191, $192, $193, $194","FROM __stage07_output"]},{"kind":"SORT","substeps":["$180 ASC, $181 ASC, $182 ASC, $183 ASC, $184 ASC, $185 ASC, $186 ASC, $187 ASC, $188 ASC, $189 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$200, $201, $202, $203, $204, $205, $206, $207, $208, $209, $210, $211, $212, $213, $214","TO __stage08_output"]}],"writeRatioAvg":0.0015754233950374162}],"estimatedBytesProcessed":"1213220104","timeline":[{"totalSlotMs":"3013","activeUnits":"11","completedUnits":"3","elapsedMs":"759","pendingUnits":"11"},{"totalSlotMs":"99815","activeUnits":"107","completedUnits":"100","elapsedMs":"3776","pendingUnits":"14"},{"totalSlotMs":"109051","activeUnits":"10","completedUnits":"104","elapsedMs":"4278","pendingUnits":"10"},{"totalSlotMs":"161426","activeUnits":"2","completedUnits":"116","elapsedMs":"7942","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"1214251008","totalPartitionsProcessed":"0","totalBytesProcessed":"1213220104","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_returns","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570971934817"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query50_1570971925"},"etag":"0WQ6MaxouQXyIGlDLxfbdQ==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query50_1570971925?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon3a997373353c995f4402940de4af5cdb49480a80","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query50\nSELECT s_store_name, \n s_company_id, \n s_street_number, \n s_street_name, \n s_street_type, \n s_suite_number, \n s_city, \n s_county, \n s_state, \n s_zip, \n Sum(CASE \n WHEN ( sr_returned_date_sk - ss_sold_date_sk <= 30 ) THEN 1 \n ELSE 0 \n END) AS days_30, \n Sum(CASE \n WHEN ( sr_returned_date_sk - ss_sold_date_sk > 30 ) \n AND ( sr_returned_date_sk - ss_sold_date_sk <= 60 ) \n THEN 1 \n ELSE 0 \n END) AS days_31_60, \n Sum(CASE \n WHEN ( sr_returned_date_sk - ss_sold_date_sk > 60 ) \n AND ( sr_returned_date_sk - ss_sold_date_sk <= 90 ) \n THEN 1 \n ELSE 0 \n END) AS days_61_90, \n Sum(CASE \n WHEN ( sr_returned_date_sk - ss_sold_date_sk > 90 ) \n AND ( sr_returned_date_sk - ss_sold_date_sk <= 120 ) \n THEN 1 \n ELSE 0 \n END) AS days_91_120, \n Sum(CASE \n WHEN ( sr_returned_date_sk - ss_sold_date_sk > 120 ) THEN 1 \n ELSE 0 \n END) AS days_over_120 \nFROM store_sales, \n store_returns, \n store, \n date_dim d1, \n date_dim d2 \nWHERE d2.d_year = 2002 \n AND d2.d_moy = 9 \n AND ss_ticket_number = sr_ticket_number \n AND ss_item_sk = sr_item_sk \n AND ss_sold_date_sk = d1.d_date_sk \n AND sr_returned_date_sk = d2.d_date_sk \n AND ss_customer_sk = sr_customer_sk \n AND ss_store_sk = s_store_sk \nGROUP BY s_store_name, \n s_company_id, \n s_street_number, \n s_street_name, \n s_street_type, \n s_suite_number, \n s_city, \n s_county, \n s_state, \n s_zip \nORDER BY s_store_name, \n s_company_id, \n s_street_number, \n s_street_name, \n s_street_type, \n s_suite_number, \n s_city, \n s_county, \n s_state, \n s_zip\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query50_1570971925","user_email":"nithish.sankaranarayanan@ulb.be"}
