{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"76691","creationTime":"1570972576166","totalBytesProcessed":"1016071120","startTime":"1570972576282","query":{"totalSlotMs":"76691","queryPlan":[{"readMsMax":"15","computeMsMax":"10","waitMsAvg":"1","id":"0","endMs":"1570972576612","waitMsMax":"1","startMs":"1570972576416","waitRatioMax":0.0001461133839859731,"readRatioAvg":0.0021917007597895967,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.0014611338398597311,"writeMsAvg":"17","status":"COMPLETE","writeMsMax":"17","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002483927527761543,"readMsAvg":"15","waitRatioAvg":0.0001461133839859731,"completedParallelInputs":"1","computeRatioMax":0.0014611338398597311,"name":"S00: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.0021917007597895967,"steps":[{"kind":"READ","substeps":["$30:d_date_sk, $31:d_month_seq","FROM date_dim","WHERE between($31, 1196, 1207)"]},{"kind":"WRITE","substeps":["$30","TO __stage00_output","BY HASH($30)"]}],"writeRatioAvg":0.002483927527761543},{"readMsMax":"11","computeMsMax":"9","waitMsAvg":"21","id":"2","endMs":"1570972576652","waitMsMax":"21","startMs":"1570972576468","waitRatioMax":0.0030683810637054353,"readRatioAvg":0.0016072472238457044,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.001315020455873758,"writeMsAvg":"147","status":"COMPLETE","writeMsMax":"147","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.021478667445938047,"readMsAvg":"11","waitRatioAvg":0.0030683810637054353,"completedParallelInputs":"1","computeRatioMax":0.001315020455873758,"name":"S02: Input","shuffleOutputBytes":"3294","recordsWritten":"366","readRatioMax":0.0016072472238457044,"steps":[{"kind":"READ","substeps":["$20:d_date_sk, $21:d_month_seq","FROM date_dim","WHERE between($21, 1196, 1207)"]},{"kind":"WRITE","substeps":["$20","TO __stage02_output","BY HASH($20)"]}],"writeRatioAvg":0.021478667445938047},{"readMsMax":"51","computeMsMax":"1520","inputStages":["0"],"waitMsAvg":"6","id":"4","endMs":"1570972577592","waitMsMax":"7","startMs":"1570972576652","waitRatioMax":0.0010227936879018118,"readRatioAvg":0.004967855055523086,"parallelInputs":"8","recordsRead":"14400251","computeRatioAvg":0.1918468731735827,"writeMsAvg":"19","status":"COMPLETE","writeMsMax":"35","computeMsAvg":"1313","shuffleOutputBytesSpilled":"0","writeRatioMax":0.005113968439509059,"readMsAvg":"34","waitRatioAvg":0.0008766803039158387,"completedParallelInputs":"8","computeRatioMax":0.22209234365867914,"name":"S04: Join+","shuffleOutputBytes":"51517038","recordsWritten":"2865251","readRatioMax":0.007451782583284629,"steps":[{"kind":"READ","substeps":["$10:cs_sold_date_sk, $11:cs_bill_customer_sk, $12:cs_item_sk","FROM catalog_sales"]},{"kind":"READ","substeps":["$30","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $110 := $100, $111 := $101"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $10 = $30"]},{"kind":"WRITE","substeps":["$110, $111","TO __stage04_output","BY HASH($110, $111)"]}],"writeRatioAvg":0.002776154295733489},{"readMsMax":"39","computeMsMax":"2925","inputStages":["2"],"waitMsAvg":"1","id":"5","endMs":"1570972578350","waitMsMax":"2","startMs":"1570972576682","waitRatioMax":0.0002922267679719462,"readRatioAvg":0.00423728813559322,"parallelInputs":"10","recordsRead":"28805772","computeRatioAvg":0.36922852133255407,"writeMsAvg":"33","status":"COMPLETE","writeMsMax":"53","computeMsAvg":"2527","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0077440093512565755,"readMsAvg":"29","waitRatioAvg":0.0001461133839859731,"completedParallelInputs":"10","computeRatioMax":0.42738164815897134,"name":"S05: Join+","shuffleOutputBytes":"98326230","recordsWritten":"5514727","readRatioMax":0.0056984219754529514,"steps":[{"kind":"READ","substeps":["$1:ss_sold_date_sk, $2:ss_item_sk, $3:ss_customer_sk","FROM store_sales"]},{"kind":"READ","substeps":["$20","FROM __stage02_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $80 := $71, $81 := $70"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $20"]},{"kind":"WRITE","substeps":["$81, $80","TO __stage05_output","BY HASH($80, $81)"]}],"writeRatioAvg":0.004821741671537112},{"readMsMax":"0","computeMsMax":"4459","inputStages":["5"],"waitMsAvg":"1","id":"6","endMs":"1570972580465","waitMsMax":"1","startMs":"1570972578145","waitRatioMax":0.0001461133839859731,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"4881753","computeRatioAvg":0.6515195791934542,"writeMsAvg":"253","status":"COMPLETE","writeMsMax":"253","computeMsAvg":"4459","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0369666861484512,"readMsAvg":"0","waitRatioAvg":0.0001461133839859731,"completedParallelInputs":"1","computeRatioMax":0.6515195791934542,"name":"S06: Repartition","shuffleOutputBytes":"86982882","recordsWritten":"4881753","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage05_output"]}],"writeRatioAvg":0.0369666861484512},{"readMsMax":"0","computeMsMax":"6844","inputStages":["4"],"waitMsAvg":"1","id":"7","endMs":"1570972584501","waitMsMax":"1","startMs":"1570972580690","waitRatioMax":0.0001461133839859731,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"2865251","computeRatioAvg":1,"writeMsAvg":"122","status":"COMPLETE","writeMsMax":"122","computeMsAvg":"6844","shuffleOutputBytesSpilled":"0","writeRatioMax":0.01782583284628872,"readMsAvg":"0","waitRatioAvg":0.0001461133839859731,"completedParallelInputs":"1","computeRatioMax":1,"name":"S07: Aggregate","shuffleOutputBytes":"51512860","recordsWritten":"2864866","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110, $111","FROM __stage04_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $120 := $110, $121 := $111"]},{"kind":"WRITE","substeps":["$120, $121","TO __stage07_output","BY HASH($120, $121)"]}],"writeRatioAvg":0.01782583284628872},{"readMsMax":"0","computeMsMax":"1458","inputStages":["6","5"],"waitMsAvg":"1","id":"8","endMs":"1570972581637","waitMsMax":"1","startMs":"1570972580719","waitRatioMax":0.0001461133839859731,"readRatioAvg":0,"parallelInputs":"10","recordsRead":"5514727","computeRatioAvg":0.1722676797194623,"writeMsAvg":"56","status":"COMPLETE","writeMsMax":"100","computeMsAvg":"1179","shuffleOutputBytesSpilled":"0","writeRatioMax":0.014611338398597311,"readMsAvg":"0","waitRatioAvg":0.0001461133839859731,"completedParallelInputs":"10","computeRatioMax":0.2130333138515488,"name":"S08: Aggregate","shuffleOutputBytes":"97706822","recordsWritten":"5452927","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$81, $80","FROM __stage05_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $90 := $80, $91 := $81"]},{"kind":"WRITE","substeps":["$90, $91","TO __stage08_output","BY HASH($90, $91)"]}],"writeRatioAvg":0.008182349503214495},{"readMsMax":"0","computeMsMax":"104","inputStages":["7","8"],"waitMsAvg":"2","id":"9","endMs":"1570972584866","waitMsMax":"4","startMs":"1570972584592","waitRatioMax":0.0005844535359438924,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"8317793","computeRatioAvg":0.011542957334891876,"writeMsAvg":"104","status":"COMPLETE","writeMsMax":"150","computeMsAvg":"79","shuffleOutputBytesSpilled":"0","writeRatioMax":0.021917007597895968,"readMsAvg":"0","waitRatioAvg":0.0002922267679719462,"completedParallelInputs":"100","computeRatioMax":0.015195791934541203,"name":"S09: Join+","shuffleOutputBytes":"2700","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$90, $91","FROM __stage08_output"]},{"kind":"READ","substeps":["$120, $121","FROM __stage07_output"]},{"kind":"AGGREGATE","substeps":["$50 := SUM($62)","$51 := SUM($61)","$52 := SUM($60)"]},{"kind":"COMPUTE","substeps":["$60 := case_no_value(and(not(is_null($130)), not(is_null($131))), 1, 0)","$61 := case_no_value(and(is_null($130), not(is_null($131))), 1, 0)","$62 := case_no_value(and(not(is_null($130)), is_null($131)), 1, 0)"]},{"kind":"JOIN","substeps":["FULL OUTER HASH JOIN EACH WITH EACH ON $90 = $120, $91 = $121"]},{"kind":"WRITE","substeps":["$50, $51, $52","TO __stage09_output"]}],"writeRatioAvg":0.015195791934541203},{"readMsMax":"0","computeMsMax":"5","inputStages":["9"],"waitMsAvg":"2","id":"10","endMs":"1570972584884","waitMsMax":"2","startMs":"1570972584693","waitRatioMax":0.0002922267679719462,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0007305669199298656,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0008766803039158387,"readMsAvg":"0","waitRatioAvg":0.0002922267679719462,"completedParallelInputs":"1","computeRatioMax":0.0007305669199298656,"name":"S0A: Output","shuffleOutputBytes":"25","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$50, $51, $52","FROM __stage09_output"]},{"kind":"LIMIT","substeps":["100"]},{"kind":"AGGREGATE","substeps":["$40 := SUM($50)","$41 := SUM($51)","$42 := SUM($52)"]},{"kind":"WRITE","substeps":["$40, $41, $42","TO __stage0A_output"]}],"writeRatioAvg":0.0008766803039158387}],"estimatedBytesProcessed":"1016071120","timeline":[{"totalSlotMs":"1735","activeUnits":"18","completedUnits":"2","elapsedMs":"634","pendingUnits":"18"},{"totalSlotMs":"33794","activeUnits":"8","completedUnits":"20","elapsedMs":"2080","pendingUnits":"1"},{"totalSlotMs":"49206","activeUnits":"11","completedUnits":"31","elapsedMs":"5466","pendingUnits":"1"},{"totalSlotMs":"76691","activeUnits":"1","completedUnits":"133","elapsedMs":"8783","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"1017118720","totalPartitionsProcessed":"0","totalBytesProcessed":"1016071120","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_10"},{"projectId":"tpc-ds-2019","tableId":"store_sales","datasetId":"scale_10"}]},"endTime":"1570972585087"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query97_1570972574"},"etag":"7pLZZ2eiT+T6vWOvztf+Nw==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query97_1570972574?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_10"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon2d1b0140dc2877d18684cfd5f019e796ac891ac4","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"\n-- query97\nWITH ssci \n AS (SELECT ss_customer_sk customer_sk, \n ss_item_sk item_sk \n FROM store_sales, \n date_dim \n WHERE ss_sold_date_sk = d_date_sk \n AND d_month_seq BETWEEN 1196 AND 1196 + 11 \n GROUP BY ss_customer_sk, \n ss_item_sk), \n csci \n AS (SELECT cs_bill_customer_sk customer_sk, \n cs_item_sk item_sk \n FROM catalog_sales, \n date_dim \n WHERE cs_sold_date_sk = d_date_sk \n AND d_month_seq BETWEEN 1196 AND 1196 + 11 \n GROUP BY cs_bill_customer_sk, \n cs_item_sk) \nSELECT Sum(CASE \n WHEN ssci.customer_sk IS NOT NULL \n AND csci.customer_sk IS NULL THEN 1 \n ELSE 0 \n END) store_only, \n Sum(CASE \n WHEN ssci.customer_sk IS NULL \n AND csci.customer_sk IS NOT NULL THEN 1 \n ELSE 0 \n END) catalog_only, \n Sum(CASE \n WHEN ssci.customer_sk IS NOT NULL \n AND csci.customer_sk IS NOT NULL THEN 1 \n ELSE 0 \n END) store_and_catalog \nFROM ssci \n FULL OUTER JOIN csci \n ON ( ssci.customer_sk = csci.customer_sk \n AND ssci.item_sk = csci.item_sk )\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query97_1570972574","user_email":"nithish.sankaranarayanan@ulb.be"}
