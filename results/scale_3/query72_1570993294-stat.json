{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"4818382","creationTime":"1570993296036","totalBytesProcessed":"22076773586","startTime":"1570993296179","query":{"totalSlotMs":"4818382","queryPlan":[{"readMsMax":"31","computeMsMax":"2386","waitMsAvg":"21","id":"0","endMs":"1570993298011","waitMsMax":"73","startMs":"1570993296371","waitRatioMax":0.002781906177356046,"readRatioAvg":0.000990815898784345,"parallelInputs":"6","recordsRead":"14398596","computeRatioAvg":0.07629282420639458,"writeMsAvg":"176","status":"COMPLETE","writeMsMax":"549","computeMsAvg":"2002","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02092145878586944,"readMsAvg":"26","waitRatioAvg":0.0008002743797873557,"completedParallelInputs":"6","computeRatioMax":0.09092641286536336,"name":"S00: Input","shuffleOutputBytes":"259174728","recordsWritten":"14398596","readRatioMax":0.0011813574177813346,"steps":[{"kind":"READ","substeps":["$20:cr_item_sk, $21:cr_order_number","FROM catalog_returns"]},{"kind":"WRITE","substeps":["$20, $21","TO __stage00_output","BY HASH($20, $21)"]}],"writeRatioAvg":0.006707061468694028},{"readMsMax":"34","computeMsMax":"7","waitMsAvg":"8","id":"1","endMs":"1570993296549","waitMsMax":"8","startMs":"1570993296399","waitRatioMax":0.00030486643039518313,"readRatioAvg":0.0012956823291795283,"parallelInputs":"1","recordsRead":"1000","computeRatioAvg":0.0002667581265957852,"writeMsAvg":"55","status":"COMPLETE","writeMsMax":"55","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.002095956708966884,"readMsAvg":"34","waitRatioAvg":0.00030486643039518313,"completedParallelInputs":"1","computeRatioMax":0.0002667581265957852,"name":"S01: Input","shuffleOutputBytes":"9000","recordsWritten":"1000","readRatioMax":0.0012956823291795283,"steps":[{"kind":"READ","substeps":["$30:p_promo_sk","FROM promotion"]},{"kind":"WRITE","substeps":["$30","TO __stage01_output","BY HASH($30)"]}],"writeRatioAvg":0.002095956708966884},{"readMsMax":"15","computeMsMax":"8","waitMsAvg":"15","id":"2","endMs":"1570993296679","waitMsMax":"15","startMs":"1570993296485","waitRatioMax":0.0005716245569909683,"readRatioAvg":0.0005716245569909683,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.00030486643039518313,"writeMsAvg":"31","status":"COMPLETE","writeMsMax":"31","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0011813574177813346,"readMsAvg":"15","waitRatioAvg":0.0005716245569909683,"completedParallelInputs":"1","computeRatioMax":0.00030486643039518313,"name":"S02: Input","shuffleOutputBytes":"6570","recordsWritten":"365","readRatioMax":0.0005716245569909683,"steps":[{"kind":"READ","substeps":["$40:d_date_sk, $41:d_week_seq, $42:d_year","FROM date_dim","WHERE equal($42, 2002)"]},{"kind":"WRITE","substeps":["$40, $41","TO __stage02_output","BY HASH($40)"]}],"writeRatioAvg":0.0011813574177813346},{"readMsMax":"35","computeMsMax":"9","waitMsAvg":"12","id":"3","endMs":"1570993296668","waitMsMax":"12","startMs":"1570993296527","waitRatioMax":0.00045729964559277465,"readRatioAvg":0.001333790632978926,"parallelInputs":"1","recordsRead":"7200","computeRatioAvg":0.000342974734194581,"writeMsAvg":"50","status":"COMPLETE","writeMsMax":"50","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0019054151899698943,"readMsAvg":"35","waitRatioAvg":0.00045729964559277465,"completedParallelInputs":"1","computeRatioMax":0.000342974734194581,"name":"S03: Input","shuffleOutputBytes":"10800","recordsWritten":"1200","readRatioMax":0.001333790632978926,"steps":[{"kind":"READ","substeps":["$50:hd_demo_sk, $51:hd_buy_potential","FROM household_demographics","WHERE equal($51, '501-1000')"]},{"kind":"WRITE","substeps":["$50","TO __stage03_output","BY HASH($50)"]}],"writeRatioAvg":0.0019054151899698943},{"readMsMax":"109","computeMsMax":"240","waitMsAvg":"14","id":"4","endMs":"1570993296819","waitMsMax":"14","startMs":"1570993296550","waitRatioMax":0.0005335162531915704,"readRatioAvg":0.0041538051141343695,"parallelInputs":"1","recordsRead":"1920800","computeRatioAvg":0.009145992911855493,"writeMsAvg":"42","status":"COMPLETE","writeMsMax":"42","computeMsAvg":"240","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0016005487595747113,"readMsAvg":"109","waitRatioAvg":0.0005335162531915704,"completedParallelInputs":"1","computeRatioMax":0.009145992911855493,"name":"S04: Input","shuffleOutputBytes":"3457440","recordsWritten":"384160","readRatioMax":0.0041538051141343695,"steps":[{"kind":"READ","substeps":["$60:cd_demo_sk, $61:cd_marital_status","FROM customer_demographics","WHERE equal($61, 'M')"]},{"kind":"WRITE","substeps":["$60","TO __stage04_output","BY HASH($60)"]}],"writeRatioAvg":0.0016005487595747113},{"readMsMax":"46","computeMsMax":"15266","waitMsAvg":"20","id":"5","endMs":"1570993305657","waitMsMax":"22","startMs":"1570993296615","waitRatioMax":0.0008383826835867535,"readRatioAvg":0.0012956823291795283,"parallelInputs":"40","recordsRead":"399330000","computeRatioAvg":0.4604245265043253,"writeMsAvg":"72","status":"COMPLETE","writeMsMax":"711","computeMsAvg":"12082","shuffleOutputBytesSpilled":"0","writeRatioMax":0.027095004001371898,"readMsAvg":"34","waitRatioAvg":0.0007621660759879578,"completedParallelInputs":"40","computeRatioMax":0.5817613658016082,"name":"S05: Input","shuffleOutputBytes":"14216140760","recordsWritten":"399330000","readRatioMax":0.0017529819747723028,"steps":[{"kind":"READ","substeps":["$80:inv_date_sk, $81:inv_item_sk, $82:inv_warehouse_sk, $83:inv_quantity_on_hand","FROM inventory"]},{"kind":"WRITE","substeps":["$80, $81, $82, $83","TO __stage05_output","BY HASH($81, $80, $82)"]}],"writeRatioAvg":0.002743797873556648},{"readMsMax":"247","computeMsMax":"2685","waitMsAvg":"6","id":"6","endMs":"1570993319074","waitMsMax":"8","startMs":"1570993296616","waitRatioMax":0.00030486643039518313,"readRatioAvg":0.0032392058229488204,"parallelInputs":"141","recordsRead":"144010451","computeRatioAvg":0.08410502648527114,"writeMsAvg":"192","status":"COMPLETE","writeMsMax":"21186","computeMsAvg":"2207","shuffleOutputBytesSpilled":"0","writeRatioMax":0.8073625242940436,"readMsAvg":"85","waitRatioAvg":0.00022864982279638732,"completedParallelInputs":"141","computeRatioMax":0.10232079570138333,"name":"S06: Input","shuffleOutputBytes":"10285178264","recordsWritten":"142929616","readRatioMax":0.009412751038451279,"steps":[{"kind":"READ","substeps":["$70:cs_sold_date_sk, $71:cs_bill_cdemo_sk, $72:cs_bill_hdemo_sk, $73:cs_warehouse_sk, $74:cs_item_sk, $75:cs_promo_sk, $76:cs_order_number, $77:cs_quantity","FROM catalog_sales"]},{"kind":"WRITE","substeps":["$70, $71, $72, $73, $74, $75, $76, $77","TO __stage06_output","BY HASH($74, $70, $73)"]}],"writeRatioAvg":0.007316794329484394},{"readMsMax":"0","computeMsMax":"11","inputStages":["4"],"waitMsAvg":"2","id":"7","endMs":"1570993297092","waitMsMax":"3","startMs":"1570993296834","waitRatioMax":0.00011432491139819366,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"384160","computeRatioAvg":0.0002667581265957852,"writeMsAvg":"20","status":"COMPLETE","writeMsMax":"35","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.001333790632978926,"readMsAvg":"0","waitRatioAvg":7.621660759879578e-05,"completedParallelInputs":"100","computeRatioMax":0.00041919134179337677,"name":"S07: Coalesce","shuffleOutputBytes":"3457440","recordsWritten":"384160","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage04_output"]}],"writeRatioAvg":0.0007621660759879578},{"readMsMax":"0","computeMsMax":"2975","inputStages":["6"],"waitMsAvg":"2","id":"8","endMs":"1570993320874","waitMsMax":"4","startMs":"1570993300511","waitRatioMax":0.00015243321519759157,"readRatioAvg":0,"parallelInputs":"26","recordsRead":"36815775","computeRatioAvg":0.0993102397012309,"writeMsAvg":"79","status":"COMPLETE","writeMsMax":"446","computeMsAvg":"2606","shuffleOutputBytesSpilled":"0","writeRatioMax":0.016996303494531458,"readMsAvg":"0","waitRatioAvg":7.621660759879578e-05,"completedParallelInputs":"26","computeRatioMax":0.11337220380320871,"name":"S08: Repartition","shuffleOutputBytes":"2649274320","recordsWritten":"36815775","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage06_output"]}],"writeRatioAvg":0.0030105560001524334},{"readMsMax":"0","computeMsMax":"3627","inputStages":["5"],"waitMsAvg":"1","id":"9","endMs":"1570993302754","waitMsMax":"4","startMs":"1570993300511","waitRatioMax":0.00015243321519759157,"readRatioAvg":0,"parallelInputs":"26","recordsRead":"57738947","computeRatioAvg":0.09961510613162608,"writeMsAvg":"69","status":"COMPLETE","writeMsMax":"590","computeMsAvg":"2614","shuffleOutputBytesSpilled":"0","writeRatioMax":0.022483899241644754,"readMsAvg":"0","waitRatioAvg":3.810830379939789e-05,"completedParallelInputs":"26","computeRatioMax":0.13821881788041615,"name":"S09: Repartition","shuffleOutputBytes":"2078602092","recordsWritten":"57738947","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage05_output"]}],"writeRatioAvg":0.0026294729621584544},{"readMsMax":"0","computeMsMax":"3058","inputStages":["8","6"],"waitMsAvg":"1","id":"10","endMs":"1570993321149","waitMsMax":"2","startMs":"1570993300854","waitRatioMax":7.621660759879578e-05,"readRatioAvg":0,"parallelInputs":"26","recordsRead":"37140582","computeRatioAvg":0.10129187149879959,"writeMsAvg":"42","status":"COMPLETE","writeMsMax":"520","computeMsAvg":"2658","shuffleOutputBytesSpilled":"0","writeRatioMax":0.019816317975686903,"readMsAvg":"0","waitRatioAvg":3.810830379939789e-05,"completedParallelInputs":"26","computeRatioMax":0.11653519301855875,"name":"S0A: Repartition","shuffleOutputBytes":"2672629200","recordsWritten":"37140582","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage08_output"]}],"writeRatioAvg":0.0016005487595747113},{"readMsMax":"0","computeMsMax":"3895","inputStages":["9","5"],"waitMsAvg":"2","id":"11","endMs":"1570993328765","waitMsMax":"4","startMs":"1570993300858","waitRatioMax":0.00015243321519759157,"readRatioAvg":0,"parallelInputs":"26","recordsRead":"75568633","computeRatioAvg":0.13059715712053657,"writeMsAvg":"1067","status":"COMPLETE","writeMsMax":"26241","computeMsAvg":"3427","shuffleOutputBytesSpilled":"0","writeRatioMax":1,"readMsAvg":"0","waitRatioAvg":7.621660759879578e-05,"completedParallelInputs":"26","computeRatioMax":0.14843184329865478,"name":"S0B: Repartition","shuffleOutputBytes":"2720470788","recordsWritten":"75568633","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage09_output"]}],"writeRatioAvg":0.04066156015395755},{"readMsMax":"0","computeMsMax":"2899","inputStages":["10","6"],"waitMsAvg":"1","id":"12","endMs":"1570993320923","waitMsMax":"2","startMs":"1570993301255","waitRatioMax":7.621660759879578e-05,"readRatioAvg":0,"parallelInputs":"26","recordsRead":"37125011","computeRatioAvg":0.09824320719484776,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"96","computeMsAvg":"2578","shuffleOutputBytesSpilled":"0","writeRatioMax":0.003658397164742197,"readMsAvg":"0","waitRatioAvg":3.810830379939789e-05,"completedParallelInputs":"26","computeRatioMax":0.11047597271445447,"name":"S0C: Repartition","shuffleOutputBytes":"2671506864","recordsWritten":"37125011","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0A_output"]}],"writeRatioAvg":0.0009145992911855493},{"readMsMax":"0","computeMsMax":"3926","inputStages":["11","5"],"waitMsAvg":"1","id":"13","endMs":"1570993330124","waitMsMax":"2","startMs":"1570993301256","waitRatioMax":7.621660759879578e-05,"readRatioAvg":0,"parallelInputs":"26","recordsRead":"81328181","computeRatioAvg":0.13433177089287757,"writeMsAvg":"40","status":"COMPLETE","writeMsMax":"235","computeMsAvg":"3525","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008955451392858504,"readMsAvg":"0","waitRatioAvg":3.810830379939789e-05,"completedParallelInputs":"26","computeRatioMax":0.1496132007164361,"name":"S0D: Repartition","shuffleOutputBytes":"2927566980","recordsWritten":"81328181","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0B_output"]}],"writeRatioAvg":0.0015243321519759156},{"readMsMax":"0","computeMsMax":"2919","inputStages":["12","6"],"waitMsAvg":"2","id":"14","endMs":"1570993321259","waitMsMax":"2","startMs":"1570993302463","waitRatioMax":7.621660759879578e-05,"readRatioAvg":0,"parallelInputs":"22","recordsRead":"31426543","computeRatioAvg":0.10030105560001525,"writeMsAvg":"24","status":"COMPLETE","writeMsMax":"82","computeMsAvg":"2632","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0031248809115506267,"readMsAvg":"0","waitRatioAvg":7.621660759879578e-05,"completedParallelInputs":"22","computeRatioMax":0.11123813879044243,"name":"S0E: Repartition","shuffleOutputBytes":"2261442328","recordsWritten":"31426543","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0C_output"]}],"writeRatioAvg":0.0009145992911855493},{"readMsMax":"0","computeMsMax":"4481","inputStages":["13","5"],"waitMsAvg":"2","id":"15","endMs":"1570993330040","waitMsMax":"3","startMs":"1570993302465","waitRatioMax":0.00011432491139819366,"readRatioAvg":0,"parallelInputs":"22","recordsRead":"76211370","computeRatioAvg":0.15281429823558554,"writeMsAvg":"29","status":"COMPLETE","writeMsMax":"106","computeMsAvg":"4010","shuffleOutputBytesSpilled":"0","writeRatioMax":0.004039480202736177,"readMsAvg":"0","waitRatioAvg":7.621660759879578e-05,"completedParallelInputs":"22","computeRatioMax":0.17076330932510195,"name":"S0F: Repartition","shuffleOutputBytes":"2737944176","recordsWritten":"76211370","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage0D_output"]}],"writeRatioAvg":0.0011051408101825388},{"readMsMax":"0","computeMsMax":"1129","inputStages":["14","15","2","5","3","1","7","6"],"waitMsAvg":"215","id":"16","endMs":"1570993345771","waitMsMax":"392","startMs":"1570993330158","waitRatioMax":0.014938455089363973,"readRatioAvg":0,"parallelInputs":"1000","recordsRead":"928981616","computeRatioAvg":0.02724743721656949,"writeMsAvg":"25","status":"COMPLETE","writeMsMax":"15079","computeMsAvg":"715","shuffleOutputBytesSpilled":"0","writeRatioMax":0.5746351129911208,"readMsAvg":"0","waitRatioAvg":0.008193285316870545,"completedParallelInputs":"1000","computeRatioMax":0.04302427498952022,"name":"S10: Join+","shuffleOutputBytes":"291735","recordsWritten":"6483","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$70, $71, $72, $73, $74, $75, $76, $77","FROM __stage06_output"]},{"kind":"READ","substeps":["$80, $81, $82, $83","FROM __stage05_output"]},{"kind":"READ","substeps":["$60","FROM __stage07_output"]},{"kind":"READ","substeps":["$50","FROM __stage03_output"]},{"kind":"READ","substeps":["$40, $41","FROM __stage02_output"]},{"kind":"READ","substeps":["$30","FROM __stage01_output"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $162 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $150 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $141 = $50"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $121 = $60"]},{"kind":"FILTER","substeps":["less($128, $127)"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH EACH ON $74 = $81, $70 = $80, $73 = $82"]},{"kind":"WRITE","substeps":["$170, $171, $172, $173, $174","TO __stage10_output","BY HASH($172, $173)"]}],"writeRatioAvg":0.0009527075949849472},{"readMsMax":"0","computeMsMax":"159","inputStages":["0","16"],"waitMsAvg":"2","id":"17","endMs":"1570993347230","waitMsMax":"10","startMs":"1570993347019","waitRatioMax":0.0003810830379939789,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"14405079","computeRatioAvg":0.0043062383293319614,"writeMsAvg":"7","status":"COMPLETE","writeMsMax":"28","computeMsAvg":"113","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0010670325063831408,"readMsAvg":"0","waitRatioAvg":7.621660759879578e-05,"completedParallelInputs":"100","computeRatioMax":0.006059220304104264,"name":"S11: Join+","shuffleOutputBytes":"350082","recordsWritten":"6483","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$170, $171, $172, $173, $174","FROM __stage10_output"]},{"kind":"READ","substeps":["$20, $21","FROM __stage00_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $190 := $183, $191 := $182, $192 := $181","$100 := SUM($111)","$101 := SUM($110)","$102 := COUNT_STAR()"]},{"kind":"COMPUTE","substeps":["$110 := case_no_value(not(is_null($180)), 1, 0)","$111 := case_no_value(is_null($180), 1, 0)"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH EACH ON $172 = $20, $173 = $21"]},{"kind":"WRITE","substeps":["$192, $191, $190, $100, $101, $102","TO __stage11_output","BY HASH($190, $191, $192)"]}],"writeRatioAvg":0.0002667581265957852},{"readMsMax":"85","computeMsMax":"8","waitMsAvg":"1","id":"19","endMs":"1570993347656","waitMsMax":"1","startMs":"1570993347311","waitRatioMax":3.810830379939789e-05,"readRatioAvg":0.0032392058229488204,"parallelInputs":"1","recordsRead":"15","computeRatioAvg":0.00030486643039518313,"writeMsAvg":"235","status":"COMPLETE","writeMsMax":"235","computeMsAvg":"8","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008955451392858504,"readMsAvg":"85","waitRatioAvg":3.810830379939789e-05,"completedParallelInputs":"1","computeRatioMax":0.00030486643039518313,"name":"S13: Input","shuffleOutputBytes":"440","recordsWritten":"15","readRatioMax":0.0032392058229488204,"steps":[{"kind":"READ","substeps":["$10:w_warehouse_sk, $11:w_warehouse_name","FROM warehouse"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage13_output","BY HASH($10)"]}],"writeRatioAvg":0.008955451392858504},{"readMsMax":"0","computeMsMax":"11","inputStages":["17","19"],"waitMsAvg":"1","id":"21","endMs":"1570993347883","waitMsMax":"2","startMs":"1570993347757","waitRatioMax":7.621660759879578e-05,"readRatioAvg":0,"parallelInputs":"18","recordsRead":"6753","computeRatioAvg":0.000342974734194581,"writeMsAvg":"9","status":"COMPLETE","writeMsMax":"18","computeMsAvg":"9","shuffleOutputBytesSpilled":"0","writeRatioMax":0.000685949468389162,"readMsAvg":"0","waitRatioAvg":3.810830379939789e-05,"completedParallelInputs":"18","computeRatioMax":0.00041919134179337677,"name":"S15: Join+","shuffleOutputBytes":"422998","recordsWritten":"6479","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$192, $191, $190, $100, $101, $102","FROM __stage11_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage13_output"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $201 = $10"]},{"kind":"AGGREGATE","substeps":["GROUP BY $200 := $190, $201 := $191, $202 := $192","$90 := SUM($100)","$91 := SUM($101)","$92 := SUM_OF_COUNTS($102)"]},{"kind":"WRITE","substeps":["$210, $211, $212, $213, $214, $215","TO __stage15_output","BY HASH($211)"]}],"writeRatioAvg":0.000342974734194581},{"readMsMax":"0","computeMsMax":"9","inputStages":["21"],"waitMsAvg":"1","id":"22","endMs":"1570993348124","waitMsMax":"4","startMs":"1570993348019","waitRatioMax":0.00015243321519759157,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"6479","computeRatioAvg":0.00019054151899698945,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"31","computeMsAvg":"5","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0011813574177813346,"readMsAvg":"0","waitRatioAvg":3.810830379939789e-05,"completedParallelInputs":"100","computeRatioMax":0.000342974734194581,"name":"S16: Coalesce","shuffleOutputBytes":"422998","recordsWritten":"6479","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage15_output"]}],"writeRatioAvg":0.000685949468389162},{"readMsMax":"26","computeMsMax":"105","inputStages":["22"],"waitMsAvg":"3","id":"23","endMs":"1570993348226","waitMsMax":"3","startMs":"1570993348023","waitRatioMax":0.00011432491139819366,"readRatioAvg":0.000990815898784345,"parallelInputs":"1","recordsRead":"210479","computeRatioAvg":0.004001371898936778,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"105","shuffleOutputBytesSpilled":"0","writeRatioMax":0.00015243321519759157,"readMsAvg":"26","waitRatioAvg":0.00011432491139819366,"completedParallelInputs":"1","computeRatioMax":0.004001371898936778,"name":"S17: Join+","shuffleOutputBytes":"14332","recordsWritten":"100","readRatioMax":0.000990815898784345,"steps":[{"kind":"READ","substeps":["$1:i_item_sk, $2:i_item_desc","FROM item"]},{"kind":"READ","substeps":["$210, $211, $212, $213, $214, $215","FROM __stage16_output"]},{"kind":"SORT","substeps":["$224 DESC, $225 ASC, $220 ASC, $221 ASC","LIMIT 100"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $1 = $211"]},{"kind":"WRITE","substeps":["$230, $231, $232, $233, $234, $235","TO __stage17_output"]}],"writeRatioAvg":0.00015243321519759157},{"readMsMax":"0","computeMsMax":"7","inputStages":["23"],"waitMsAvg":"1","id":"24","endMs":"1570993348248","waitMsMax":"1","startMs":"1570993348043","waitRatioMax":3.810830379939789e-05,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.0002667581265957852,"writeMsAvg":"10","status":"COMPLETE","writeMsMax":"10","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0003810830379939789,"readMsAvg":"0","waitRatioAvg":3.810830379939789e-05,"completedParallelInputs":"1","computeRatioMax":0.0002667581265957852,"name":"S18: Output","shuffleOutputBytes":"14332","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$230, $231, $232, $233, $234, $235","FROM __stage17_output"]},{"kind":"SORT","substeps":["$235 DESC, $230 ASC, $231 ASC, $232 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$240, $241, $242, $243, $244, $245","TO __stage18_output"]}],"writeRatioAvg":0.0003810830379939789}],"estimatedBytesProcessed":"22076773586","timeline":[{"totalSlotMs":"16889","activeUnits":"287","completedUnits":"4","elapsedMs":"693","pendingUnits":"287"},{"totalSlotMs":"409126","activeUnits":"185","completedUnits":"240","elapsedMs":"1907","pendingUnits":"51"},{"totalSlotMs":"450868","activeUnits":"44","completedUnits":"249","elapsedMs":"2414","pendingUnits":"42"},{"totalSlotMs":"536072","activeUnits":"43","completedUnits":"250","elapsedMs":"3620","pendingUnits":"41"},{"totalSlotMs":"816523","activeUnits":"192","completedUnits":"257","elapsedMs":"5454","pendingUnits":"190"},{"totalSlotMs":"1149697","activeUnits":"176","completedUnits":"318","elapsedMs":"6545","pendingUnits":"173"},{"totalSlotMs":"1357753","activeUnits":"167","completedUnits":"338","elapsedMs":"7588","pendingUnits":"153"},{"totalSlotMs":"1570133","activeUnits":"156","completedUnits":"340","elapsedMs":"9025","pendingUnits":"151"},{"totalSlotMs":"1699697","activeUnits":"154","completedUnits":"341","elapsedMs":"9981","pendingUnits":"150"},{"totalSlotMs":"3518895","activeUnits":"138","completedUnits":"386","elapsedMs":"23913","pendingUnits":"105"},{"totalSlotMs":"3608638","activeUnits":"90","completedUnits":"439","elapsedMs":"24964","pendingUnits":"52"},{"totalSlotMs":"3632340","activeUnits":"51","completedUnits":"442","elapsedMs":"25471","pendingUnits":"49"},{"totalSlotMs":"3987569","activeUnits":"32","completedUnits":"473","elapsedMs":"33180","pendingUnits":"18"},{"totalSlotMs":"4021966","activeUnits":"595","completedUnits":"491","elapsedMs":"34234","pendingUnits":"1000"},{"totalSlotMs":"4758557","activeUnits":"413","completedUnits":"1488","elapsedMs":"35239","pendingUnits":"3"},{"totalSlotMs":"4760798","activeUnits":"6","completedUnits":"1489","elapsedMs":"35841","pendingUnits":"2"},{"totalSlotMs":"4773206","activeUnits":"3","completedUnits":"1490","elapsedMs":"38363","pendingUnits":"1"},{"totalSlotMs":"4795374","activeUnits":"0","completedUnits":"1491","elapsedMs":"50094","pendingUnits":"0"},{"totalSlotMs":"4818382","activeUnits":"101","completedUnits":"1712","elapsedMs":"52292","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"22077767680","totalPartitionsProcessed":"0","totalBytesProcessed":"22076773586","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"household_demographics","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"inventory","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"warehouse","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_returns","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"catalog_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer_demographics","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"promotion","datasetId":"scale_100"}]},"endTime":"1570993348490"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query72_1570993294"},"etag":"Hgxq0tcdJfZKFJoNhn0+3Q==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query72_1570993294?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anon758d3e6ebc5d5bdf24ab1997504cedd4e04fdf76","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query72\nWITH top_items AS (\n SELECT cs_item_sk, \n cs_warehouse_sk, \n d1.d_week_seq, \n Sum(CASE \n WHEN p_promo_sk IS NULL THEN 1 \n ELSE 0 \n END) no_promo, \n Sum(CASE \n WHEN p_promo_sk IS NOT NULL THEN 1 \n ELSE 0 \n END) promo, \n Count(*) total_cnt \n FROM catalog_sales \n JOIN inventory \n ON ( cs_item_sk = inv_item_sk and cs_sold_date_sk = inv_date_sk and cs_warehouse_sk = inv_warehouse_sk ) \n JOIN customer_demographics \n ON ( cs_bill_cdemo_sk = cd_demo_sk ) \n JOIN household_demographics \n ON ( cs_bill_hdemo_sk = hd_demo_sk ) \n JOIN date_dim d1 \n ON ( cs_sold_date_sk = d1.d_date_sk ) \n LEFT OUTER JOIN promotion \n ON ( cs_promo_sk = p_promo_sk ) \n LEFT OUTER JOIN catalog_returns \n ON ( cr_item_sk = cs_item_sk \n AND cr_order_number = cs_order_number ) \n WHERE inv_quantity_on_hand < cs_quantity \n AND hd_buy_potential = '501-1000' \n AND d1.d_year = 2002 \n AND cd_marital_status = 'M' \n GROUP BY 1, 2, 3\n)\nSELECT i_item_desc, \n w_warehouse_name, \n d_week_seq,\n no_promo,\n promo,\n total_cnt\nFROM top_items \nJOIN warehouse \n ON ( w_warehouse_sk = cs_warehouse_sk ) \nJOIN item \n ON ( i_item_sk = cs_item_sk ) \nORDER BY total_cnt DESC, \n 1, 2, 3\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query72_1570993294","user_email":"nithish.sankaranarayanan@ulb.be"}
