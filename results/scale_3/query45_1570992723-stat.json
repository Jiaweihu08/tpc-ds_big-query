{"status":{"state":"DONE"},"kind":"bigquery#job","statistics":{"totalSlotMs":"546160","creationTime":"1570992725506","totalBytesProcessed":"2312475252","startTime":"1570992725659","query":{"totalSlotMs":"546160","queryPlan":[{"readMsMax":"22","computeMsMax":"36","waitMsAvg":"1","id":"0","endMs":"1570992726056","waitMsMax":"1","startMs":"1570992726001","waitRatioMax":0.0002799552071668533,"readRatioAvg":0.006159014557670772,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.010078387458006719,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"36","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0016797312430011197,"readMsAvg":"22","waitRatioAvg":0.0002799552071668533,"completedParallelInputs":"1","computeRatioMax":0.010078387458006719,"name":"S00: Input","shuffleOutputBytes":"300","recordsWritten":"10","readRatioMax":0.006159014557670772,"steps":[{"kind":"READ","substeps":["$21:i_item_id, $20:i_item_sk","FROM item","WHERE in($20, 2, 3, 5, 7, 11, 13, 17, 19, 23, 29)"]},{"kind":"COMPUTE","substeps":["$160 := 1"]},{"kind":"WRITE","substeps":["$21, $160","TO __stage00_output","BY HASH($21)"]}],"writeRatioAvg":0.0016797312430011197},{"readMsMax":"21","computeMsMax":"157","waitMsAvg":"25","id":"1","endMs":"1570992726413","waitMsMax":"25","startMs":"1570992726044","waitRatioMax":0.006998880179171333,"readRatioAvg":0.005879059350503919,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.043952967525195966,"writeMsAvg":"208","status":"COMPLETE","writeMsMax":"208","computeMsAvg":"157","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05823068309070549,"readMsAvg":"21","waitRatioAvg":0.006998880179171333,"completedParallelInputs":"1","computeRatioMax":0.043952967525195966,"name":"S01: Input","shuffleOutputBytes":"6120000","recordsWritten":"204000","readRatioMax":0.005879059350503919,"steps":[{"kind":"READ","substeps":["$10:i_item_sk, $11:i_item_id","FROM item"]},{"kind":"WRITE","substeps":["$10, $11","TO __stage01_output","BY HASH($10)"]}],"writeRatioAvg":0.05823068309070549},{"readMsMax":"11","computeMsMax":"10","waitMsAvg":"19","id":"2","endMs":"1570992726268","waitMsMax":"19","startMs":"1570992726057","waitRatioMax":0.005319148936170213,"readRatioAvg":0.003079507278835386,"parallelInputs":"1","recordsRead":"73049","computeRatioAvg":0.002799552071668533,"writeMsAvg":"187","status":"COMPLETE","writeMsMax":"187","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.05235162374020157,"readMsAvg":"11","waitRatioAvg":0.005319148936170213,"completedParallelInputs":"1","computeRatioMax":0.002799552071668533,"name":"S02: Input","shuffleOutputBytes":"819","recordsWritten":"91","readRatioMax":0.003079507278835386,"steps":[{"kind":"READ","substeps":["$40:d_date_sk, $41:d_year, $42:d_qoy","FROM date_dim","WHERE and(equal($42, 1), equal($41, 2000))"]},{"kind":"WRITE","substeps":["$40","TO __stage02_output","BY HASH($40)"]}],"writeRatioAvg":0.05235162374020157},{"readMsMax":"17","computeMsMax":"981","waitMsAvg":"31","id":"3","endMs":"1570992726678","waitMsMax":"31","startMs":"1570992726087","waitRatioMax":0.008678611422172453,"readRatioAvg":0.004759238521836506,"parallelInputs":"1","recordsRead":"1000000","computeRatioAvg":0.2746360582306831,"writeMsAvg":"62","status":"COMPLETE","writeMsMax":"62","computeMsAvg":"981","shuffleOutputBytesSpilled":"0","writeRatioMax":0.017357222844344905,"readMsAvg":"17","waitRatioAvg":0.008678611422172453,"completedParallelInputs":"1","computeRatioMax":0.2746360582306831,"name":"S03: Input","shuffleOutputBytes":"25549784","recordsWritten":"1000000","readRatioMax":0.004759238521836506,"steps":[{"kind":"READ","substeps":["$30:ca_address_sk, $31:ca_state, $32:ca_zip","FROM customer_address"]},{"kind":"WRITE","substeps":["$30, $31, $32","TO __stage03_output","BY HASH($30)"]}],"writeRatioAvg":0.017357222844344905},{"readMsMax":"38","computeMsMax":"1813","waitMsAvg":"1","id":"4","endMs":"1570992727218","waitMsMax":"1","startMs":"1570992726165","waitRatioMax":0.0002799552071668533,"readRatioAvg":0.010638297872340425,"parallelInputs":"1","recordsRead":"2000000","computeRatioAvg":0.5075587905935051,"writeMsAvg":"91","status":"COMPLETE","writeMsMax":"91","computeMsAvg":"1813","shuffleOutputBytesSpilled":"0","writeRatioMax":0.02547592385218365,"readMsAvg":"38","waitRatioAvg":0.0002799552071668533,"completedParallelInputs":"1","computeRatioMax":0.5075587905935051,"name":"S04: Input","shuffleOutputBytes":"36000000","recordsWritten":"2000000","readRatioMax":0.010638297872340425,"steps":[{"kind":"READ","substeps":["$60:c_customer_sk, $61:c_current_addr_sk","FROM customer"]},{"kind":"WRITE","substeps":["$60, $61","TO __stage04_output","BY HASH($60)"]}],"writeRatioAvg":0.02547592385218365},{"readMsMax":"15","computeMsMax":"35","waitMsAvg":"0","id":"6","endMs":"1570992726247","waitMsMax":"0","startMs":"1570992726196","waitRatioMax":0,"readRatioAvg":0.0041993281075028,"parallelInputs":"1","recordsRead":"204000","computeRatioAvg":0.009798432250839866,"writeMsAvg":"5","status":"COMPLETE","writeMsMax":"5","computeMsAvg":"35","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0013997760358342665,"readMsAvg":"15","waitRatioAvg":0,"completedParallelInputs":"1","computeRatioMax":0.009798432250839866,"name":"S06: Input","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0.0041993281075028,"steps":[{"kind":"READ","substeps":["$2:i_item_id, $1:i_item_sk","FROM item","WHERE in($1, 2, 3, 5, 7, 11, 13, 17, 19, 23, 29)"]},{"kind":"AGGREGATE","substeps":["$110 := SUM($130)"]},{"kind":"COMPUTE","substeps":["$130 := if(is_null($2), 1, 0)"]},{"kind":"WRITE","substeps":["$110","TO __stage06_output"]}],"writeRatioAvg":0.0013997760358342665},{"readMsMax":"0","computeMsMax":"2","inputStages":["6"],"waitMsAvg":"0","id":"7","endMs":"1570992726268","waitMsMax":"0","startMs":"1570992726193","waitRatioMax":0,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"1","computeRatioAvg":0.0005599104143337066,"writeMsAvg":"4","status":"COMPLETE","writeMsMax":"4","computeMsAvg":"2","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0011198208286674132,"readMsAvg":"0","waitRatioAvg":0,"completedParallelInputs":"1","computeRatioMax":0.0005599104143337066,"name":"S07: Aggregate","shuffleOutputBytes":"9","recordsWritten":"1","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$110","FROM __stage06_output"]},{"kind":"AGGREGATE","substeps":["$90 := SUM($110)"]},{"kind":"WRITE","substeps":["$90","TO __stage07_output"]}],"writeRatioAvg":0.0011198208286674132},{"readMsMax":"0","computeMsMax":"28","inputStages":["4"],"waitMsAvg":"2","id":"8","endMs":"1570992728061","waitMsMax":"7","startMs":"1570992727270","waitRatioMax":0.001959686450167973,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"2000000","computeRatioAvg":0.005039193729003359,"writeMsAvg":"62","status":"COMPLETE","writeMsMax":"126","computeMsAvg":"18","shuffleOutputBytesSpilled":"0","writeRatioMax":0.03527435610302351,"readMsAvg":"0","waitRatioAvg":0.0005599104143337066,"completedParallelInputs":"100","computeRatioMax":0.007838745800671893,"name":"S08: Coalesce","shuffleOutputBytes":"36000000","recordsWritten":"2000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage04_output"]}],"writeRatioAvg":0.017357222844344905},{"readMsMax":"0","computeMsMax":"17","inputStages":["3"],"waitMsAvg":"6","id":"9","endMs":"1570992728088","waitMsMax":"9","startMs":"1570992727271","waitRatioMax":0.0025195968645016797,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"1000000","computeRatioAvg":0.003639417693169093,"writeMsAvg":"66","status":"COMPLETE","writeMsMax":"271","computeMsAvg":"13","shuffleOutputBytesSpilled":"0","writeRatioMax":0.07586786114221725,"readMsAvg":"0","waitRatioAvg":0.0016797312430011197,"completedParallelInputs":"100","computeRatioMax":0.004759238521836506,"name":"S09: Coalesce","shuffleOutputBytes":"25549784","recordsWritten":"1000000","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage03_output"]}],"writeRatioAvg":0.018477043673012318},{"readMsMax":"0","computeMsMax":"13","inputStages":["0"],"waitMsAvg":"9","id":"10","endMs":"1570992727561","waitMsMax":"39","startMs":"1570992727273","waitRatioMax":0.010918253079507279,"readRatioAvg":0,"parallelInputs":"100","recordsRead":"10","computeRatioAvg":0.0016797312430011197,"writeMsAvg":"44","status":"COMPLETE","writeMsMax":"71","computeMsAvg":"6","shuffleOutputBytesSpilled":"0","writeRatioMax":0.019876819708846586,"readMsAvg":"0","waitRatioAvg":0.0025195968645016797,"completedParallelInputs":"100","computeRatioMax":0.003639417693169093,"name":"S0A: Coalesce","shuffleOutputBytes":"300","recordsWritten":"10","readRatioMax":0,"steps":[{"kind":"READ","substeps":["FROM __stage00_output"]}],"writeRatioAvg":0.012318029115341545},{"readMsMax":"109","computeMsMax":"3572","inputStages":["10","1","2","9","8"],"waitMsAvg":"1","id":"11","endMs":"1570992731716","waitMsMax":"3","startMs":"1570992727337","waitRatioMax":0.0008398656215005599,"readRatioAvg":0.009238521836506159,"parallelInputs":"92","recordsRead":"365251367","computeRatioAvg":0.8009518477043673,"writeMsAvg":"21","status":"COMPLETE","writeMsMax":"32","computeMsAvg":"2861","shuffleOutputBytesSpilled":"0","writeRatioMax":0.008958566629339306,"readMsAvg":"33","waitRatioAvg":0.0002799552071668533,"completedParallelInputs":"92","computeRatioMax":1,"name":"S0B: Join+","shuffleOutputBytes":"182097458","recordsWritten":"2168654","readRatioMax":0.03051511758118701,"steps":[{"kind":"READ","substeps":["$50:ws_sold_date_sk, $51:ws_item_sk, $52:ws_bill_customer_sk, $53:ws_sales_price","FROM web_sales"]},{"kind":"READ","substeps":["$60, $61","FROM __stage08_output"]},{"kind":"READ","substeps":["$30, $31, $32","FROM __stage09_output"]},{"kind":"READ","substeps":["$40","FROM __stage02_output"]},{"kind":"READ","substeps":["$10, $11","FROM __stage01_output"]},{"kind":"READ","substeps":["$21, $160","FROM __stage0A_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $230 := $224","$120 := ANY_VALUE($140)","$121 := ANY_VALUE($220)","$122 := ANY_VALUE($221)","$123 := ANY_VALUE($222)","$124 := ANY_VALUE($223)"]},{"kind":"COMPUTE","substeps":["$140 := not(is_null($225))"]},{"kind":"JOIN","substeps":["LEFT OUTER HASH JOIN EACH WITH ALL ON $213 = $21"]},{"kind":"COMPUTE","substeps":["$150 := UNIQUE_ROW_ID()"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $202 = $10"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $180 = $40"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $173 = $30"]},{"kind":"JOIN","substeps":["INNER HASH JOIN EACH WITH ALL ON $52 = $60"]},{"kind":"WRITE","substeps":["$120, $121, $122, $123, $124, $230","TO __stage0B_output","BY HASH($230)"]}],"writeRatioAvg":0.005879059350503919},{"readMsMax":"0","computeMsMax":"776","inputStages":["7","11"],"waitMsAvg":"1","id":"12","endMs":"1570992732336","waitMsMax":"1","startMs":"1570992731870","waitRatioMax":0.0002799552071668533,"readRatioAvg":0,"parallelInputs":"9","recordsRead":"2168663","computeRatioAvg":0.17777155655095184,"writeMsAvg":"18","status":"COMPLETE","writeMsMax":"34","computeMsAvg":"635","shuffleOutputBytesSpilled":"0","writeRatioMax":0.009518477043673012,"readMsAvg":"0","waitRatioAvg":0.0002799552071668533,"completedParallelInputs":"9","computeRatioMax":0.21724524076147816,"name":"S0C: Aggregate+","shuffleOutputBytes":"5448","recordsWritten":"213","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$90","FROM __stage07_output"]},{"kind":"READ","substeps":["$120, $121, $122, $123, $124, $230","FROM __stage0B_output"]},{"kind":"AGGREGATE","substeps":["GROUP BY $250 := $103, $251 := $102","$80 := SUM($104)"]},{"kind":"FILTER","substeps":["or(in(substr($103, 1, 5), '85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792'), ...)"]},{"kind":"AGGREGATE","substeps":["GROUP BY $240 := $230","$100 := ANY_VALUE($120)","$101 := ANY_VALUE($121)","$102 := ANY_VALUE($122)","$103 := ANY_VALUE($123)","$104 := ANY_VALUE($124)"]},{"kind":"WRITE","substeps":["$80, $251, $250","TO __stage0C_output","BY HASH($250, $251)"]}],"writeRatioAvg":0.005039193729003359},{"readMsMax":"0","computeMsMax":"7","inputStages":["12"],"waitMsAvg":"1","id":"13","endMs":"1570992732700","waitMsMax":"1","startMs":"1570992732339","waitRatioMax":0.0002799552071668533,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"213","computeRatioAvg":0.001959686450167973,"writeMsAvg":"198","status":"COMPLETE","writeMsMax":"198","computeMsAvg":"7","shuffleOutputBytesSpilled":"0","writeRatioMax":0.055431131019036954,"readMsAvg":"0","waitRatioAvg":0.0002799552071668533,"completedParallelInputs":"1","computeRatioMax":0.001959686450167973,"name":"S0D: Sort+","shuffleOutputBytes":"2552","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$80, $251, $250","FROM __stage0C_output"]},{"kind":"SORT","substeps":["$260 ASC, $261 ASC","LIMIT 100"]},{"kind":"AGGREGATE","substeps":["GROUP BY $260 := $250, $261 := $251","$70 := SUM($80)"]},{"kind":"WRITE","substeps":["$270, $271, $272","TO __stage0D_output"]}],"writeRatioAvg":0.055431131019036954},{"readMsMax":"0","computeMsMax":"10","inputStages":["13"],"waitMsAvg":"1","id":"14","endMs":"1570992732740","waitMsMax":"1","startMs":"1570992732449","waitRatioMax":0.0002799552071668533,"readRatioAvg":0,"parallelInputs":"1","recordsRead":"100","computeRatioAvg":0.002799552071668533,"writeMsAvg":"6","status":"COMPLETE","writeMsMax":"6","computeMsAvg":"10","shuffleOutputBytesSpilled":"0","writeRatioMax":0.0016797312430011197,"readMsAvg":"0","waitRatioAvg":0.0002799552071668533,"completedParallelInputs":"1","computeRatioMax":0.002799552071668533,"name":"S0E: Output","shuffleOutputBytes":"2552","recordsWritten":"100","readRatioMax":0,"steps":[{"kind":"READ","substeps":["$270, $271, $272","FROM __stage0D_output"]},{"kind":"SORT","substeps":["$272 ASC, $271 ASC","LIMIT 100"]},{"kind":"WRITE","substeps":["$280, $281, $282","TO __stage0E_output"]}],"writeRatioAvg":0.0016797312430011197}],"estimatedBytesProcessed":"2312475252","timeline":[{"totalSlotMs":"12349","activeUnits":"94","completedUnits":"5","elapsedMs":"843","pendingUnits":"94"},{"totalSlotMs":"170140","activeUnits":"239","completedUnits":"160","elapsedMs":"2052","pendingUnits":"239"},{"totalSlotMs":"290817","activeUnits":"92","completedUnits":"307","elapsedMs":"2576","pendingUnits":"92"},{"totalSlotMs":"535140","activeUnits":"29","completedUnits":"397","elapsedMs":"4547","pendingUnits":"2"},{"totalSlotMs":"541970","activeUnits":"6","completedUnits":"402","elapsedMs":"6562","pendingUnits":"6"},{"totalSlotMs":"546160","activeUnits":"0","completedUnits":"410","elapsedMs":"7281","pendingUnits":"0"}],"statementType":"SELECT","totalBytesBilled":"2313158656","totalPartitionsProcessed":"0","totalBytesProcessed":"2312475252","cacheHit":false,"billingTier":1,"referencedTables":[{"projectId":"tpc-ds-2019","tableId":"customer_address","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"date_dim","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"item","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"web_sales","datasetId":"scale_100"},{"projectId":"tpc-ds-2019","tableId":"customer","datasetId":"scale_100"}]},"endTime":"1570992732963"},"jobReference":{"projectId":"tpc-ds-2019","location":"US","jobId":"query45_1570992723"},"etag":"lev1b5sJqsvU7VFdhj9rmg==","selfLink":"https://bigquery.googleapis.com/bigquery/v2/projects/tpc-ds-2019/jobs/query45_1570992723?location=US","configuration":{"query":{"maximumBillingTier":10,"defaultDataset":{"projectId":"tpc-ds-2019","datasetId":"scale_100"},"useLegacySql":false,"destinationTable":{"projectId":"tpc-ds-2019","tableId":"anonfba423aa907fa976a7737bcf91dfc301eefb92fa","datasetId":"_0ca6f7c7da88564ba26827da43395a8255e28ecd"},"priority":"INTERACTIVE","writeDisposition":"WRITE_TRUNCATE","createDisposition":"CREATE_IF_NEEDED","query":"-- query45\nSELECT ca_zip, \n ca_state, \n Sum(ws_sales_price) \nFROM web_sales, \n customer, \n customer_address, \n date_dim, \n item \nWHERE ws_bill_customer_sk = c_customer_sk \n AND c_current_addr_sk = ca_address_sk \n AND ws_item_sk = i_item_sk \n AND ( Substr(ca_zip, 1, 5) IN ( '85669', '86197', '88274', '83405', \n '86475', '85392', '85460', '80348', \n '81792' ) \n OR i_item_id IN (SELECT i_item_id \n FROM item \n WHERE i_item_sk IN ( 2, 3, 5, 7, \n 11, 13, 17, 19, \n 23, 29 )) ) \n AND ws_sold_date_sk = d_date_sk \n AND d_qoy = 1 \n AND d_year = 2000 \nGROUP BY ca_zip, \n ca_state \nORDER BY ca_zip, \n ca_state\nLIMIT 100; \n"},"jobType":"QUERY"},"id":"tpc-ds-2019:US.query45_1570992723","user_email":"nithish.sankaranarayanan@ulb.be"}
